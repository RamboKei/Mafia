var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);i.prototype=e.prototype,t.prototype=new i},BaseDisplayObjectContainer=function(t){function e(){var e=t.call(this)||this;return e.bindData=null,e._touchTapHelper=null,e._touchHelper=null,e}return __extends(e,t),e.prototype.addTouchTap=function(t,e,i){null==this._touchTapHelper&&(this._touchTapHelper=TouchHelper.addTouchTap(this,t,e,i))},e.prototype.removeTouchTap=function(){this._touchTapHelper&&(this._touchTapHelper.removeTouchTap(),this._touchTapHelper=null)},e.prototype.addTouch=function(t,e,i,a){this._touchHelper||(this._touchHelper=TouchHelper.addTouch(this,t,e,i,a))},e.prototype.removeTouch=function(){this._touchHelper&&(this._touchHelper.removeTouch(),this._touchHelper=null)},e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.stopAllActions=function(){egret.Tween.removeTweens(this)},e.prototype.setVisible=function(t){this.visible=t},e.prototype.setScale=function(t){this.scaleX=this.scaleY=t},e.prototype.getClassName=function(){return egret.getQualifiedClassName(this)},e.prototype.dispose=function(){this.stopAllActions(),this.removeTouchTap(),this.removeTouch(),App.DisplayUtil.destory(this),this.bindData=null,this.parent&&(this.parent instanceof ScrollView?this.parent.dispose():this.parent.removeChild(this))},e}(egret.DisplayObjectContainer);__reflect(BaseDisplayObjectContainer.prototype,"BaseDisplayObjectContainer",["base.Iinteractive","base.Ibase"]);var BaseLoadDisplayObjectContiner=function(t){function e(){var e=t.call(this)||this;return e._isLoaded=!1,e._groupName=void 0,e._isShow=!1,e._isInit=!1,e._requestTypeList=[],e._isRequesed=!1,e}return __extends(e,t),e.prototype.show=function(t){if(!this.isShow()){var e=this.getRequestData();e?this.request(e.requestType,e.requestData):this._isRequesed=!0,this.showLoadingMask(),this._isShow=!0,this.loadRes()}},e.prototype.getRequestData=function(){return null},e.prototype.request=function(t,e){if(t){this._curRequestData={requestType:t,requestData:e};var i=NetManager.getMessageName(t);this._requestTypeList.indexOf(i)<0&&(App.MessageHelper.addEventListener(i,this.receiveEvent,this),this._requestTypeList.push(t)),NetManager.request(t,e)}},e.prototype.receiveEvent=function(t){var e=this._curRequestData;return e&&t.type==NetManager.getMessageName(e.requestType)&&t.data&&0==t.data.ret?void(0==this._isRequesed&&(App.CommonUtil.showTip(LanguageManager.getlocal("requestLoadErrorTip")),this.hideLoadingMask(),this.hide())):(this.receiveData(t.data),void(e&&t.type==NetManager.getMessageName(e.requestType)&&0==this._isRequesed&&(this._isRequesed=!0,this.isLoaded&&this._isRequesed&&this.preInit())))},e.prototype.removeAllRequestEvents=function(){var t=this._requestTypeList.length;if(t>0)for(var e=t-1;e>=0;e--)this.removeRequestEvent(this._requestTypeList[e])},e.prototype.removeRequestEvent=function(t){var e=this._requestTypeList.indexOf(t);e>-1&&(App.MessageHelper.removeEventListener(NetManager.getMessageName(t),this.receiveEvent,this),this._requestTypeList.splice(e,1))},e.prototype.receiveData=function(t){},e.prototype.isShow=function(){return this._isShow},e.prototype.isInit=function(){return this._isInit},e.prototype.hide=function(){this.isShow()&&this.dispose()},e.prototype.loadRes=function(){var t=this.getResourceList();0==this._isLoaded&&t&&t.length>0?this._groupName=ResourceManager.loadResources(t,null,this.delayLoadComplete,null,this,this.resGroupLoadError):this.delayLoadComplete()},e.prototype.isShowLoadingMask=function(){return!0},e.prototype.showLoadingMask=function(){this.isShowLoadingMask()&&(e._loadingWait?e._loadingWait.showMask():e._loadingWait=NetLoadingWait.showMask(100))},e.prototype.hideLoadingMask=function(){this.isShowLoadingMask()&&e._loadingWait&&e._loadingWait.hideMask()},e.prototype.resGroupLoadError=function(){App.CommonUtil.showTip(LanguageManager.getlocal("resLoadErrorTip")),this.hideLoadingMask(),this.hide()},e.prototype.delayLoadComplete=function(){this.isShow()&&egret.callLater(this.loadComplete,this)},e.prototype.loadComplete=function(){this.isShow()&&(this._isLoaded=!0,this.isLoaded&&this._isRequesed&&this.preInit())},e.prototype.preInit=function(){this.isLoaded&&this._isRequesed&&(this._isInit=!0,this.init(),this.getParent()&&this.getParent().addChild(this),this.hideLoadingMask())},e.prototype.hideScene=function(){return!0},Object.defineProperty(e.prototype,"isLoaded",{get:function(){return this._isLoaded},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.removeAllRequestEvents(),this._isLoaded&&(this._groupName&&(ResourceManager.destroyRes(this._groupName),this._groupName=void 0),this._isLoaded=!1),this._isShow=!1,this._isInit=!1,this._isRequesed=!1,this._curRequestData=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(BaseLoadDisplayObjectContiner.prototype,"BaseLoadDisplayObjectContiner");var ScrollListItem=function(t){function e(){var e=t.call(this)||this;return e._index=0/0,e.__data=null,e}return __extends(e,t),e.prototype.init=function(t,e){this._index=t,this.__data=e,this.initItem(t,e),this.initBg()},e.prototype.initBg=function(){var t=BaseBitmap.create("public_alphabg");this.getBounds();t.width=this.width+this.getSpaceX(),t.height=this.height+this.getSpaceY(),this.addChildAt(t,0)},e.prototype.initItem=function(t,e){},e.prototype.getSpaceX=function(){return 5},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){this.__data=null,this._index=0/0,t.prototype.dispose.call(this)},e.create=function(t,i,a){var n=egret.getQualifiedClassName(t);null==e.scrollListItemPool[n]&&(e.scrollListItemPool[n]=[]);var o=e.scrollListItemPool[n].pop();return o||(e.isCanNew=!0,o=new t,e.isCanNew=!1),o.init(i,a),o},e.release=function(t){if(t){t.dispose(),t.setPosition(0,0),t.setScale(1),t.rotation=0,t.alpha=1,t.width=0/0,t.height=0/0,t.mask=null,t.scrollRect=null,t.filters=null;var i=egret.getQualifiedClassName(t);null==e.scrollListItemPool[i]&&(e.scrollListItemPool[i]=[]);var a=e.scrollListItemPool[i];a.indexOf(t)<0&&a.push(t)}},e.scrollListItemPool={},e.isCanNew=!1,e}(BaseDisplayObjectContainer);__reflect(ScrollListItem.prototype,"ScrollListItem");var BaseClass=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(egret.HashObject);__reflect(BaseClass.prototype,"BaseClass",["base.Ibase"]);var BaseView=function(t){function e(){var e=t.call(this)||this;return e.tabViewData={},e._selectedTabIndex=0,e._lastSelectedTabIndex=null,e._needStopEffectList=[],e}return __extends(e,t),e.prototype.init=function(){this.initMask(),this.initBg(),this.initTitle(),this.initContainer(),this.initCloseBtn(),this.initViewBg(),this.initTabbarGroup(),this.initView();var t=this.getTabbarTextArr();t&&t.length>0&&this.changeTab(),this.checkGuide&&this.checkGuide instanceof Function&&this.checkGuide(),this.playBg(),Api.rookieVoApi.showRookieView()},e.prototype.playBg=function(){if(this.isShow()){var t=this.getSoundBgName();if(RES.hasRes(t)){SoundManager.playBg(t);var i=this.getClassName(),a=e._recodeSoundBgList.indexOf(i);0>a?e._recodeSoundBgList.push(i):e._recodeSoundBgList=e._recodeSoundBgList.concat(e._recodeSoundBgList.splice(a,1))}}},e.prototype.stopBg=function(){if(this.isShow()){var t=this.getSoundBgName();if(RES.hasRes(t)){SoundManager.stopBgByName(t);var i=this.getClassName(),a=e._recodeSoundBgList.indexOf(i);if(a>-1&&e._recodeSoundBgList.splice(a,1),e._recodeSoundBgList.length>0){var n=ViewController.getInstance().getView(e._recodeSoundBgList[e._recodeSoundBgList.length-1]);n.playBg()}else SceneController.getInstance().playBg()}}},e.prototype.getSoundBgName=function(){var t=this.getClassName().toLowerCase();return t=t.substring(0,t.indexOf("view")),"music_"+t},e.prototype.getResourceList=function(){var t=[];return t},e.prototype.initViewBg=function(){},e.prototype.getTitleButtomY=function(){var t=0;return this.tabbarGroup?t=this.tabbarGroup.y+this.tabbarGroup.height:this.titleBg?t=this.titleBg.y+this.titleBg.height:this.titleTF&&(t=this.titleTF.y+this.titleTF.height),t},e.prototype.getTabbarTextArr=function(){return[]},e.prototype.getTabbarName=function(){return ButtonConst.BTN_TAB},e.prototype.initTabbarGroup=function(){var t=this.getTabbarTextArr();if(t&&t.length>0){this.tabbarGroup=ComponentManager.getTabBarGroup(this.getTabbarName(),t,this.clickTabbarHandler,this);this.addChild(this.tabbarGroup),this.setTabBarPosition(),this.container.y=this.getTitleButtomY(),this.tabbarGroup.selectedIndex=this._selectedTabIndex}},e.prototype.setTabBarPosition=function(){if(this.tabbarGroup){var t=0,e=0;egret.is(this,"PopupView")?(t=this.viewBg.x+30,e=this.viewBg.y+60):(t=15,e=this.titleBg?this.titleBg.y+this.titleBg.height+8:100),e+=this.getTabbarGroupY(),this.tabbarGroup.setPosition(t,e)}},e.prototype.getTabbarGroupY=function(){return 0},e.prototype.clickTabbarHandler=function(t){App.LogUtil.log("index: "+t.index);var e=Number(t.index);return 0==this.checkTabCondition(e)?void(this.tabbarGroup.selectedIndex=this.selectedTabIndex):(this.lastSelectedTabIndex=this.selectedTabIndex,this.selectedTabIndex=e,void this.changeTab())},e.prototype.checkTabCondition=function(t){return!0},e.prototype.changeTab=function(){var t=egret.getDefinitionByName(this.getClassName()+"Tab"+(this.selectedTabIndex+1));if(t){var e=this.tabViewData[this.selectedTabIndex];if(e)this.addChild(e),e.refreshWhenSwitchBack();else{var i=new t;i.setPosition(this.container.x,this.container.y+this.getTabbarGroupY()),this.tabViewData[this.selectedTabIndex]=i,this.addChild(i)}null!=this.lastSelectedTabIndex&&this.tabViewData[this.lastSelectedTabIndex]&&this.removeChild(this.tabViewData[this.lastSelectedTabIndex])}},e.prototype.getSelectedTab=function(){return this.tabViewData&&this.tabViewData[this.selectedTabIndex]?this.tabViewData[this.selectedTabIndex]:null},e.prototype.checkSelectedTab=function(t){return t==this.selectedTabIndex?!0:!1},e.prototype.addRedPoint=function(t){this.tabbarGroup&&this.tabbarGroup.addRedPoint(t)},e.prototype.removeRedPoint=function(t){this.tabbarGroup&&this.tabbarGroup.removeRedPoint(t)},e.prototype.getBgName=function(){return this.getClassName().toLowerCase()+"bg"},e.prototype.getTitleBgName=function(){return this.getClassName().toLowerCase()+"titlebg"},e.prototype.getCloseBtnName=function(){return this.getClassName().toLowerCase()+"closebtn"},e.prototype.initBg=function(){var t=this.getBgName();t&&("public_rule_bg"==t?this.viewBg=App.CommonUtil.getContainerByLeftHalfRes(t):this.viewBg=BaseBitmap.create(t),"commonview_bg1"==t&&this.viewBg instanceof BaseBitmap&&(this.viewBg.fillMode=egret.BitmapFillMode.REPEAT),this.isTouchMaskClose()&&(this.viewBg.touchEnabled=!0),this.addChild(this.viewBg),"popupview_bg1"==t?this.viewBg.width=this.getShowWidth():"public_rule_bg"==t||(this.viewBg.width=GameConfig.stageWidth,this.viewBg.height=GameConfig.stageHeigth))},e.prototype.isTouchMaskClose=function(){return!1},e.prototype.initMask=function(){this.isShowMask()&&(this._maskBmp=BaseBitmap.create("public_9_viewmask"),this._maskBmp.width=GameConfig.stageWidth,this._maskBmp.height=GameConfig.stageHeigth,this._maskBmp.touchEnabled=!0,this.addChild(this._maskBmp),this.isTouchMaskClose()&&this._maskBmp.addTouchTap(this.hide,this))},e.prototype.addChildToContainer=function(t){t&&this.container.addChild(t)},e.prototype.removeChildFromContainer=function(t){t&&this.container.removeChild(t)},e.prototype.show=function(i){this.isShow()||(Api.rookieVoApi.hiddenRookieView(),e._showLogList.length>20&&e._showLogList.shift(),App.LogUtil.log("showLog:"+this.getClassName()),e._showLogList.push(this.getClassName()),this.param=i,i&&i.tab&&(this.selectedTabIndex=Number(i.tab.indexOf("-")?i.tab.split("-")[0]:i.tab)),t.prototype.show.call(this))},e.prototype.closeHandler=function(){this.hide()},e.prototype.hide=function(){this.isShow()&&(t.prototype.hide.call(this),SoundManager.resumeBg())},e.prototype.initTitle=function(){var t=this.getTitleBgName();if(t){var e=this.getBgName();this.titleBg=BaseBitmap.create(t),this.titleBg.name="titleBg",this.titleBg.x=GameConfig.stageWidth/2-this.titleBg.width/2,this.addChild(this.titleBg),"popupview_bg1"==e?this.titleBg.y=this.viewBg.y-this.titleBg.height/2:"public_rule_bg"==e?this.titleBg.y=this.viewBg.y-this.titleBg.height:this.titleBg.y=0}this.getTitleStr()&&(this.titleTF=new BaseTextField,this.titleTF.text=LanguageManager.getlocal(this.getTitleStr(),this.getTitleParams()),this.titleTF.x=this.width/2-this.titleTF.width/2,this.titleTF.setColor(TextFieldConst.COLOR_BLACK),this.addChild(this.titleTF),this.titleBg?this.titleTF.y=this.titleBg.y+this.titleBg.height/2-this.titleTF.height/2+21:this.titleTF.y=10)},e.prototype.initContainer=function(){this.container=new BaseDisplayObjectContainer;var t=this.getChildIndex(this.getChildByName("titleBg"));this.addChildAt(this.container,t),"commonview_titlebg"==this.getTitleBgName()&&this.titleBg?(this.container.x=0,this.container.y=this.titleBg.height+15+this.getContainerY()):this.container.y=this.getContainerY()},e.prototype.initCloseBtn=function(){this.getCloseBtnName()&&(this.closeBtn=ComponentManager.getButton(this.getCloseBtnName(),"",this.closeHandler,this),this.addChild(this.closeBtn),"popupview_bg1"==this.getBgName()||"public_rule_bg"==this.getBgName()?(this.closeBtn.x=App.DeviceUtil.isWXgame()?20:this.viewBg.width-this.closeBtn.width+20,this.closeBtn.y=this.viewBg.y-20):(this.closeBtn.x=App.DeviceUtil.isWXgame()?20:GameConfig.stageWidth-this.closeBtn.width,this.closeBtn.y=0))},e.prototype.preInit=function(){t.prototype.preInit.call(this)},Object.defineProperty(e.prototype,"selectedTabIndex",{get:function(){return this._selectedTabIndex},set:function(t){isNaN(t)||(this._selectedTabIndex=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastSelectedTabIndex",{get:function(){return this._lastSelectedTabIndex},set:function(t){isNaN(t)||(this._lastSelectedTabIndex=t)},enumerable:!0,configurable:!0}),e.prototype.getTitleStr=function(){return App.StringUtil.firstCharToLower(this.getClassName())+"Title"},e.prototype.getTitleParams=function(){return null},e.prototype.getParent=function(){return LayerManager.panelLayer},e.prototype.getShowWidth=function(){return 570},e.prototype.getShowHeight=function(){return 0},e.prototype.getContainerY=function(){return"popupview_bg1"==this.getBgName()?51:0},e.prototype.isShowMask=function(){return!0},e.prototype.playEffect=function(t,e){e&&this._needStopEffectList.indexOf(t)<0&&this._needStopEffectList.push(t),SoundManager.playEffect(t)},e.prototype.dispose=function(){if(this.stopBg(),this._needStopEffectList&&this._needStopEffectList.length>0)for(var e=this._needStopEffectList.length,i=e-1;i>=0;i--)SoundManager.stopEffect(this._needStopEffectList.pop());if(this.tabbarGroup&&(this.removeChild(this.tabbarGroup),this.tabbarGroup.dispose(),this.tabbarGroup=null),this.tabViewData){for(var a in this.tabViewData){var n=this.tabViewData[a];n&&(this.contains(n)?this.removeChild(n):this.container.contains(n)&&this.removeChildFromContainer(n),n.dispose(),n=null)}this.tabViewData={}}this._maskBmp=null,this.viewBg=null,this.titleBg=null,this.titleTF=null,this.closeBtn=null,this.container=null,this._selectedTabIndex=0,this._lastSelectedTabIndex=null,t.prototype.dispose.call(this)},e._recodeSoundBgList=[],e._showLogList=[],e}(BaseLoadDisplayObjectContiner);__reflect(BaseView.prototype,"BaseView");var ViewTab=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){},e.prototype.refreshWhenSwitchBack=function(){},e.prototype.getViewTitleButtomY=function(){var t=this.getClassName();t=this.getClassName().substring(0,t.indexOf("Tab"));var e=ViewController.getInstance().getView(t);return e.getTitleButtomY()},e.prototype.getParent=function(){return null},e.prototype.getResourceList=function(){return[]},e}(BaseLoadDisplayObjectContiner);__reflect(ViewTab.prototype,"ViewTab");var BaseVo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(BaseClass);__reflect(BaseVo.prototype,"BaseVo");var ServantSelectedScrollItem=function(t){function e(){var e=t.call(this)||this;return e._selectedIndex=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){this._selectedIndex=t;var i=e;this._servantInfoVo=i;var a=BaseBitmap.create("public_9_bg1");a.width=500,a.height=107,this.addChild(a),this.initServantIcon(i),this.initServantInfo();var n=ComponentManager.getButton(this.getBtnResName(),this.getBtnLocalName(),this.clickBtnHandler,this);n.setColor(TextFieldConst.COLOR_BLACK),n.x=a.width-n.width-10,n.y=a.height/2-n.height/2,this.addChild(n)},e.prototype.initServantIcon=function(t){var e=100,i=BaseLoadBitmap.create(t.qualityBoxImgPath);i.x=10,i.y=10,this.addChild(i),i.scaleX=e/194,i.scaleY=e/192;var a=BaseLoadBitmap.create(t.halfImgPath);a.x=i.x+5,a.y=i.y+5,this.addChild(a),a.scaleX=(e-10)/180,a.scaleY=(e-10)/177},e.prototype.initServantInfo=function(){var t=ComponentManager.getTextField(this._servantInfoVo.servantName,TextFieldConst.FONTSIZE_CONTENT_SMALL);t.setColor(TextFieldConst.COLOR_WHITE),t.x=120,t.y=15,this.addChild(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("servant_infoLv")+this._servantInfoVo.level,TextFieldConst.FONTSIZE_CONTENT_SMALL);e.setColor(TextFieldConst.COLOR_WHITE),e.x=120,e.y=45,this.addChild(e),this._attrTF=ComponentManager.getTextField(this.getAttrStr(),TextFieldConst.FONTSIZE_CONTENT_SMALL),this._attrTF.setColor(TextFieldConst.COLOR_WHITE),this._attrTF.x=120,this._attrTF.y=75,this.addChild(this._attrTF)},e.prototype.getAttrStr=function(){var t="servant_infoAttr",e=ServantSelectedPopupView.USE_TYOE_ITEMID;return t=1020==e||1021==e?LanguageManager.getlocal("servant_bookAttr",[String(this._servantInfoVo.abilityExp)]):1029==e||1030==e?LanguageManager.getlocal("servant_skillAttr",[String(this._servantInfoVo.skillExp)]):LanguageManager.getlocal("servant_infoAttr")+this._servantInfoVo.total},e.prototype.getBtnResName=function(){return ButtonConst.BTN_NORMAL_YELLOW},e.prototype.getBtnLocalName=function(){return"useBtn"},e.prototype.clickBtnHandler=function(t){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_SELECTED_SERVANT,{index:this._selectedIndex,id:this._servantInfoVo.servantId})},e.prototype.update=function(){this._servantInfoVo=Api.servantVoApi.getServantObj(this._servantInfoVo.servantId),this._attrTF.text=this.getAttrStr()},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._attrTF=null,this._selectedIndex=null,this._servantInfoVo=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ServantSelectedScrollItem.prototype,"ServantSelectedScrollItem");var BaseController=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(BaseClass);__reflect(BaseController.prototype,"BaseController");var CommonView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(i){this.isShow()||(e._showloadingCount++,App.LogUtil.log("commonview.showCount:",e._showloadingCount),t.prototype.show.call(this,i))},e.prototype.hide=function(){if(this.isShow()){if(this.isInit()||this.removeLoadingCount(),e._showloadingCount>0){var i=this.getClassName(),a=e._waitHideList[i];if(null==a)return a={hide:this.hide,hideThisObj:this},e._waitHideList[i]=a,void App.LogUtil.log(i,"等待关闭")}t.prototype.hide.call(this);var n=e.showedViewNameList.indexOf(this.getClassName());n>-1&&e.showedViewNameList.splice(n,1),e.showedViewNameList.length<1&&SceneController.getInstance().showScene()}},e.prototype.preInit=function(){t.prototype.preInit.call(this);var i=this.getClassName();e.showedViewNameList.length<1&&"RookieView"!=i&&SceneController.getInstance().hideScene();var a=e.showedViewNameList.indexOf(i);0>a&&e.showedViewNameList.push(i)},e.prototype.initBg=function(){var t=this.getBgName();t&&(this.viewBg=BaseBitmap.create(t),"commonview_bg1"==t&&this.viewBg instanceof BaseBitmap&&(this.viewBg.fillMode=egret.BitmapFillMode.REPEAT),this.isTouchMaskClose()&&(this.viewBg.touchEnabled=!0),this.addChild(this.viewBg),this.viewBg.width=GameConfig.stageWidth,this.viewBg.height=GameConfig.stageHeigth)},e.prototype.removeLoadingCount=function(){if(e._showloadingCount--,App.LogUtil.log("commonview.hideCount:",e._showloadingCount),0==e._showloadingCount)for(var t in e._waitHideList){var i=e._waitHideList[t];i&&(i.hide.call(i.hideThisObj),i.hide=null,i.hideThisObj=null,delete e._waitHideList[t],App.LogUtil.log(this.getClassName()+"初始化完成,关闭界面"+t))}},e.prototype.init=function(){this.removeLoadingCount(),t.prototype.init.call(this),this.initRuleBtn()},e.prototype.initTitle=function(){if(t.prototype.initTitle.call(this),this.titleBg){var e=BaseBitmap.create("commonview_titlebgshadow");e.width=this.titleBg.width,e.setPosition(0,this.titleBg.y+this.titleBg.height),this.addChild(e)}},e.prototype.initViewBg=function(){t.prototype.initViewBg.call(this)},e.prototype.initRuleBtn=function(){this.getRuleInfo()&&(this._ruleBtn=ComponentManager.getButton("btn_rule","",this.clickRuleBtnHandler,this),this._ruleBtn.x=12+(App.DeviceUtil.isWXgame()?80:0),this._ruleBtn.y=22,this.addChild(this._ruleBtn))},e.prototype.clickRuleBtnHandler=function(t){ViewController.getInstance().openView(ViewConst.POPUP.RULEINFOPOPUPVIEW,LanguageManager.getlocal(this.getRuleInfo()))},e.prototype.getResourceList=function(){var e=this.getTitleBgName(),i=t.prototype.getResourceList.call(this).concat([this.getBgName(),e,this.getCloseBtnName()]);e&&RES.hasRes(e+"shadow")&&(i[i.length]=e+"shadow");var a=this.getClassName().toLowerCase();return RES.hasRes(a)&&(i[i.length]=a),i},e.prototype.getBgName=function(){return"commonview_bg1"},e.prototype.getTitleBgName=function(){return"commonview_titlebg"},e.prototype.getCloseBtnName=function(){return ButtonConst.COMMON_CLOSE_1},e.prototype.getRuleInfo=function(){var t=this.getClassName().toLowerCase().replace("view","")+"RuleInfo";return LanguageManager.checkHasKey(t)?t:""},e.prototype.getRuleBtnName=function(){return"btn_rule"},e.prototype.dispose=function(){this._ruleBtn&&(this.removeChild(this._ruleBtn),this._ruleBtn.dispose(),this._ruleBtn=null),t.prototype.dispose.call(this)},e.showedViewNameList=[],e._waitHideList={},e._showloadingCount=0,e}(BaseView);__reflect(CommonView.prototype,"CommonView");var CommonViewTab=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(ViewTab);__reflect(CommonViewTab.prototype,"CommonViewTab");var BaseVoApi=function(t){function e(){var e=t.call(this)||this;return e._dataVoList=[],e}return __extends(e,t),e.prototype.formatData=function(t){if(null==this._vo){var e=this.getClassName(),i=e.substring(0,e.length-3),a=egret.getDefinitionByName(i);this._vo=new a,this[App.StringUtil.firstCharToLower(i)]=this._vo}this._vo.initData(t)},e.prototype.getModeName=function(){return this.getClassName().replace("VoApi","").toLowerCase()},e.prototype.getClassName=function(){return egret.getQualifiedClassName(this)},e.prototype.checkNpcMessage=function(){return!1},e.prototype.dispose=function(){this._vo&&(this._vo.dispose(),this._vo=null)},e}(BaseClass);__reflect(BaseVoApi.prototype,"BaseVoApi");var PopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.initButton(),this.resetBgSize()},e.prototype.show=function(e){this.isShow()||(e&&(this.param=e),t.prototype.show.call(this,e))},e.prototype.getResourceList=function(){var e=t.prototype.getResourceList.call(this).concat([this.getBgName(),this.getTitleBgName(),this.getCloseBtnName()]),i=this.getClassName().toLowerCase();return RES.hasRes(i)&&(e[e.length]=i),e},e.prototype.initBg=function(){var t=this.getBgName();t&&("public_rule_bg"==t?this.viewBg=App.CommonUtil.getContainerByLeftHalfRes(t):this.viewBg=BaseBitmap.create(t),this.isTouchMaskClose()&&(this.viewBg.touchEnabled=!0),this.addChild(this.viewBg),"popupview_bg1"==t&&(this.viewBg.width=this.getShowWidth()))},e.prototype.initButton=function(){this.getConfirmBtnStr()&&(this._confirmBtn=ComponentManager.getButton(this.getConfirmBtnName(),this.getConfirmBtnStr(),this.clickConfirmHandler,this),this._confirmBtn.x=this.getShowWidth()/2-this._confirmBtn.width/2,this._confirmBtn.y=this.container.height-this._confirmBtn.height-10,this.addChildToContainer(this._confirmBtn))},e.prototype.resetBgSize=function(){if(this.viewBg){if(0==this.getShowHeight()){if("public_rule_bg"!=this.getBgName()){var t=this.getContainerRealHeight(),e=t.maxH,i=Math.max(t.startY,0);this.container.height+i>e&&(this.container.height=e-i),this.container.y+this.container.height+i+this.getBgExtraHeight()+13<=900?this.viewBg.height<=this.container.y+this.container.height+i+this.getBgExtraHeight()+13&&(this.viewBg.height=this.container.y+this.container.height+i+this.getBgExtraHeight()+13):this.viewBg.height=900}}else this.viewBg.height=this.getShowHeight();if(this.viewBg.x=GameConfig.stageWidth/2-this.viewBg.width/2,this.viewBg.y=GameConfig.stageHeigth/2-this.viewBg.height/2,this.container.x=this.viewBg.x,this.container.y=this.viewBg.y+this.getContainerY(),this._confirmBtn&&(0==this.getShowHeight()?this._confirmBtn.y=this.container.height+10:this._confirmBtn.y=this.viewBg.height-this.getContainerY()-this._confirmBtn.height-25),this.titleBg&&(this.titleBg.x=this.viewBg.x+this.viewBg.width/2-this.titleBg.width/2,"public_rule_bg"==this.getBgName()?this.titleBg.y=this.viewBg.y+5:this.titleBg.y=this.viewBg.y+20),this.titleTF&&(this.titleTF.size=TextFieldConst.FONTSIZE_TITLE_COMMON,this.titleTF.x=this.viewBg.x+this.viewBg.width/2-this.titleTF.width/2,this.titleTF.y=this.viewBg.y+15),this.closeBtn&&("public_rule_bg"!=this.getBgName()?(this.closeBtn.y=this.viewBg.y-40,this.closeBtn.x=this.viewBg.x+this.viewBg.width-this.closeBtn.width+40):(this.closeBtn.y=this.viewBg.y-18,this.closeBtn.x=this.viewBg.x+this.viewBg.width-this.closeBtn.width+37)),this.tabViewData)for(var a in this.tabViewData){var n=this.tabViewData[a];n.setPosition(this.container.x,this.container.y)}this.setTabBarPosition()}},e.prototype.getContainerRealHeight=function(){for(var t=0,e=Number.MAX_VALUE,i=0;i<this.container.numChildren;i++){var a=this.container.getChildAt(i);a&&a.y+a.height*a.scaleY>t&&(t=a.y+a.height*a.scaleY),a.y<e&&(e=a.y)}return{maxH:t,startY:e}},e.prototype.setConfirmBtnPosition=function(t,e){this._confirmBtn&&(t&&(this._confirmBtn.x=t),e&&(this._confirmBtn.y=e))},e.prototype.setConfirmBtnVisible=function(t){this._confirmBtn&&(this._confirmBtn.visible=t)},e.prototype.getBgExtraHeight=function(){return 40},e.prototype.clickConfirmHandler=function(t){App.LogUtil.log("clickConfirmHandler"),this.hide()},e.prototype.getBgName=function(){return"popupview_bg1"},e.prototype.getTitleBgName=function(){return null},e.prototype.getCloseBtnName=function(){return ButtonConst.POPUP_CLOSE_BTN_1},e.prototype.getConfirmBtnName=function(){return ButtonConst.BTN_TAB},e.prototype.getConfirmBtnStr=function(){return""},e.prototype.dispose=function(){this._confirmBtn&&(this.removeChildFromContainer(this._confirmBtn),this._confirmBtn.dispose(),this._confirmBtn=null),this.param=null,t.prototype.dispose.call(this)},e}(BaseView);__reflect(PopupView.prototype,"PopupView");var AcBaseVo=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"aidAndCode",{get:function(){return this.aid+"-"+this.code},enumerable:!0,configurable:!0}),e.prototype.initData=function(t){for(var e in t)this[e]=t[e]},Object.defineProperty(e.prototype,"config",{get:function(){return Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"acTime",{get:function(){return App.DateUtil.getOpenLocalTime(this.st,this.et,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"acTimeAndHour",{get:function(){var t=this.et;return this.config&&this.config.extraTime&&(t=this.et-86400*this.config.extraTime),App.DateUtil.getOpenLocalTime(this.st,t,!0)},enumerable:!0,configurable:!0}),e.prototype.getAcLocalTime=function(t,e){return e?LanguageManager.getlocal("acLocalTime",["<font color="+e+">"+(t?this.acTimeAndHour:this.acTime)+"</font>"]):LanguageManager.getlocal("acLocalTime",[t?this.acTimeAndHour:this.acTime])},Object.defineProperty(e.prototype,"acCountDown",{get:function(){return App.DateUtil.getFormatBySecond(this.et-GameData.serverTime,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"acLocalCountDown",{get:function(){return LanguageManager.getlocal("acLocalCountDown",[this.acCountDown])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isStart",{get:function(){return this.st<=GameData.serverTime&&this.et>GameData.serverTime?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.getShowNum=function(t){if(void 0===t&&(t=0),"7"==this.atype||1==t){var e=App.DateUtil.getWeeTs(this.et),i=App.DateUtil.getWeeTs(this.st),a=Math.ceil((e-i)/86400);return this.et==e?a:a+1}},e.prototype.dispose=function(){},e}(BaseVo);__reflect(AcBaseVo.prototype,"AcBaseVo");var BaseSound=function(){function t(){this._cache={},this._loadingCache=new Array,TimerManager.doTimer(6e4,0,this.dealSoundTimer,this)}return t.prototype.dealSoundTimer=function(){for(var t=egret.getTimer(),e=Object.keys(this._cache),i=0,a=e.length;a>i;i++){var n=e[i];this.checkCanClear(n)&&t-this._cache[n]>=SoundManager.CLEAR_TIME&&(delete this._cache[n],RES.destroyRes(n))}},t.prototype.getSound=function(t){var e=ResourceManager.getRes(t);if(e)this._cache[t]&&(this._cache[t]=egret.getTimer());else{if(-1!=this._loadingCache.indexOf(t))return null;this._loadingCache.push(t),RES.getResAsync(t,this.onResourceLoadComplete,this)}return e},t.prototype.onResourceLoadComplete=function(t,e){var i=this._loadingCache.indexOf(e);-1!=i&&(this._loadingCache.splice(i,1),this._cache[e]=egret.getTimer(),this.loadedPlay(e))},t.prototype.loadedPlay=function(t){},t.prototype.checkCanClear=function(t){return!0},t}();__reflect(BaseSound.prototype,"BaseSound");var ButtonConst;!function(t){t.BTN_BIG_YELLOW="btn_big_yellow",t.BTN_NORMAL_YELLOW="btn_normal_yellow",t.BTN_SMALL_YELLOW="btn_small_yellow",t.BTN_BIG_RED="btn_big_red",t.BTN_NORMAL_RED="btn_normal_red",t.BTN_SMALL_RED="btn_small_red",t.BTN_BIG_BLUE="btn_big_blue",t.BTN_NORMAL_BLUE="btn_normal_blue",t.BTN_SMALL_BLUE="btn_small_blue",t.BTN_RECHARGE="btn_recharge",t.BTN_TAB="btn_tab",t.COMMON_CLOSE_1="commonview_closebtn1",t.POPUP_CLOSE_BTN_1="popupview_closebtn1",t.BATTLE_START_BTN_1="boss_start_war"}(ButtonConst||(ButtonConst={}));var ProgressBarConst;!function(t){t.IMAGE_PROGRESS1="loginbg_progress1",t.IMAGE_PROGRESS1_Bg="loginbg_progress1_bg",t.IMAGE_PROGRESS_EXP="exp_progress_bar",t.IMAGE_PROGRESS_EXP_Bg="exp_progress_bg"}(ProgressBarConst||(ProgressBarConst={}));var TextFieldConst;!function(t){t.FONTSIZE_TITLE_BIG=32,t.FONTSIZE_TITLE_COMMON=26,t.FONTSIZE_TITLE_SMALL=24,t.FONTSIZE_CONTENT_COMMON=22,t.FONTSIZE_CONTENT_SMALL=20,t.FONTSIZE_BUTTON_COMMON=24,t.COLOR_BLACK=2565927,t.COLOR_LIGHT_YELLOW=16577460,t.COLOR_WHITE=16775144,t.COLOR_BROWN=4071183,t.COLOR_LIGHT_RED=13735022,t.COLOR_WARN_YELLOW=16702264,t.COLOR_WARN_YELLOW2=11042304,t.COLOR_WARN_RED=13505813,t.COLOR_WARN_RED2=12265472,t.COLOR_WARN_RED3=16727100,t.COLOR_WARN_GREEN=2222905,t.COLOR_WARN_GREEN2=4102912,t.COLOR_QUALITY_GRAY=14671839,t.COLOR_QUALITY_WHITE=14671839,t.COLOR_QUALITY_GREEN=6679389,t.COLOR_QUALITY_BLUE=6594298,t.COLOR_QUALITY_PURPLE=13266170,t.COLOR_QUALITY_ORANGE=16756570,t.COLOR_QUALITY_RED=13505813,t.COLOR_QUALITY_YELLOW=16702264,t.ALIGH_LEFT=egret.HorizontalAlign.LEFT,t.ALIGH_RIGHT=egret.HorizontalAlign.RIGHT,t.ALIGH_CENTER=egret.HorizontalAlign.CENTER,t.ALIGH_BOTTOM=egret.VerticalAlign.BOTTOM,t.ALIGH_TOP=egret.VerticalAlign.TOP,t.ALIGH_MIDDLE=egret.VerticalAlign.MIDDLE,t.FONTNAME_BOSS_SCORE="socre_fnt",t.FONTNAME_ITEMTIP="tip_fnt"
}(TextFieldConst||(TextFieldConst={}));var AcBaseVoApi=function(t){function e(){var e=t.call(this)||this;return e._acVoList={},e._newAcVoList={},e._activeUnlockMap={},e}return __extends(e,t),e.prototype.formatData=function(t,e){var i=[];if(t.info){var a=t.info;for(var n in a){var o=n.split("-"),s=o[0],r=o[1],l=this._acVoList[s],h=this._newAcVoList[s];if(null==this._acVoList[s]&&(l={},this._acVoList[s]=l),null==l[r]){var d=App.StringUtil.firstCharToUper(s),g=egret.getDefinitionByName("Ac"+d+"Vo");if(g){var c=new g;c.initData(a[n]),l[r]=c,null==this._newAcVoList[s]&&(h={},this._newAcVoList[s]=h),h[r]=c}}else l[r].initData(a[n]);l[r]&&!l[r].config&&i.push(n)}}return i&&i.length>0?(NetManager.request(NetRequestConst.REQUEST_ACTIVITY_GETACTIVECFG,{activeArr:i}),!1):!0},e.prototype.setActiveUnlock=function(t){this._activeUnlockMap["needActive_"+t]=t},e.prototype.checkActiveIsUnlock=function(t){return this._activeUnlockMap["needActive_"+t]?!0:!1},e.prototype.checkShowRedDotByAid=function(t,e){if(e){var i=this.getActivityVoByAidAndCode(t,e);if(i&&i.isStart&&1==i.isShowRedDot)return!0}else{var a=this._acVoList[t];if(a)for(var n in a){var i=a[n];if(i&&i.isStart&&1==i.isShowRedDot)return!0}}return!1},e.prototype.checkActivityStartByAid=function(t,e){var i=!1;if(e){var a=this.getActivityVoByAidAndCode(t,e);i=a?a.isStart:!1}else{var n=this.getActivityVoListByAid(t);if(n)for(var o=n.length,s=0;o>s;s++)if(n[s]&&n[s].isStart){i=!0;break}}return i},e.prototype.getRanActives=function(){var t=[];for(var e in this._acVoList){var i=this._acVoList[e];if(i)for(var a in i){var n=i[a];n&&n.isStart&&"rankActive"==e&&"11"!=n.atype&&t.push(n)}}return t},e.prototype.getAllActivityIcons=function(){var t=[],e={};for(var i in this._newAcVoList){var a=Config.IconorderCfg.getIconNameByName(i),n=Config.IconorderCfg.checkHasChildCfgNameByName(i);if(a||n){if(this.checkActivityStartByAid(i))if(n){var o=this._acVoList[i];if(o)for(var s in o){var r=o[s];if(r&&r.isStart&&r.atype){var l=Config.IconorderCfg.getIconCfgByAidAndType(i,r.atype);l?l.icon?e[l.icon]||(t.push(this.createActivityicon(l.icon,null,r.atype)),e[l.icon]=l.icon):r.atype?t.push(this.createActivityicon(i,Number(s),Number(r.atype))):t.push(this.createActivityicon(i,Number(s))):a&&(e[a]||(t.push(this.createActivityicon(a,null)),e[a]=a))}else a&&(e[a]||(t.push(this.createActivityicon(a,null)),e[a]=a))}}else a&&(e[a]||(t.push(this.createActivityicon(a,null)),e[a]=a))}else{var o=this._acVoList[i];if(o)for(var s in o){var r=o[s];if(r&&r.isStart){i.toLowerCase();r.atype?t.push(this.createActivityicon(i,Number(s),Number(r.atype))):t.push(this.createActivityicon(i,Number(s)))}}}}return this._newAcVoList={},t.sort(function(t,e){var i=Config.IconorderCfg.getIconSortIdByCfgName(t.name),a=Config.IconorderCfg.getIconSortIdByCfgName(e.name);return i-a}),t},e.prototype.createActivityicon=function(t,e,i){var a=i,n=e;i||(i=e);var o=!1;o="recharge"==t||"firstrecharge"==t||"discount"==t?!0:Config.IconorderCfg.getisFlickByName(t,a);var s=Config.IconorderCfg.getIconBgByAidAndType(t,a),r=t.toLowerCase(),l=e?"ac_"+r+"-"+i+"_icon":"ac_"+r+"_icon",h=e?"ac_"+r+"-"+i+"_name":"ac_"+r+"_name",d=App.CommonUtil.createMainUIIcon(l,h,o,s);return d.name=n?t+"-"+n:t,d.bindData={aid:t,code:e},d.addTouchTap(function(t,e,i,a){if(!Api.rookieVoApi.isGuiding){var n="Ac"+App.StringUtil.firstCharToUper(e)+"View";"crossServerAtkRace"==e&&(n=ViewConst.COMMON.ATKRACECROSSSUMMARYVIEW),"rankActive"==e&&11!=Number(a)&&egret.getDefinitionByName(n.replace("Ac",""))&&(n=App.StringUtil.firstCharToUper(n.replace("Ac",""))),ViewController.getInstance().openView(n,i)}},this,[t,e,a]),d},e.prototype.getActivityVoListByAid=function(t){var e=this._acVoList[t],i=[];if(e)for(var a in e)i.push(e[a]);return i},e.prototype.getActivityVoByAidAndCode=function(t,e){var i=this._acVoList[t];if(!i)return null;t.indexOf("-")>-1&&(e||(e=t.split("-")[1]),t=t.split("-")[0]);var a;if(e)a=i[e];else for(var n in i)a=i[n];return a},e.prototype.checkIsHasNewAc=function(){return Object.keys(this._newAcVoList).length>0},e.prototype.dispose=function(){this._acVoList={},this._newAcVoList={},t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(AcBaseVoApi.prototype,"AcBaseVoApi");var BaseItemCfg=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initData=function(t){if(t)for(var e in t)this[e]=t[e]},e.prototype.dispose=function(){},e}(BaseClass);__reflect(BaseItemCfg.prototype,"BaseItemCfg");var BaseBitmap=function(t){function e(i){var a=t.call(this,i)||this;if(a.bindData=null,a._touchTapHelper=null,a._touchHelper=null,!e.isCanNew&&"BaseBitmap"==a.getClassName()){var n="请使用BaseBitmap.create创建";throw App.LogUtil.error(n),new Error(n)}return a}return __extends(e,t),e.prototype.addTouchTap=function(t,e,i){null==this._touchTapHelper&&(this.touchEnabled=!0,this._touchTapHelper=TouchHelper.addTouchTap(this,t,e,i))},e.prototype.removeTouchTap=function(){this._touchTapHelper&&(this._touchTapHelper.removeTouchTap(),this._touchTapHelper=null)},Object.defineProperty(e.prototype,"width",{get:function(){return egret.superGetter(e,this,"width")},set:function(t){this.texture&&this.texture.scale9Grid&&t<this.texture.textureWidth&&(t=this.texture.textureWidth),egret.superSetter(e,this,"width",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return egret.superGetter(e,this,"height")},set:function(t){this.texture&&this.texture.scale9Grid&&t<this.texture.textureHeight&&(t=this.texture.textureHeight),egret.superSetter(e,this,"height",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale9Grid",{get:function(){return egret.superGetter(e,this,"scale9Grid")},set:function(t){egret.superSetter(e,this,"scale9Grid",t)},enumerable:!0,configurable:!0}),e.prototype.addTouch=function(t,e,i,a){this._touchHelper||(this._touchHelper=TouchHelper.addTouch(this,t,e,i,a))},e.prototype.removeTouch=function(){this._touchHelper&&(this._touchHelper.removeTouch(),this._touchHelper=null)},e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.stopAllActions=function(){egret.Tween.removeTweens(this)},e.prototype.setVisible=function(t){this.visible=t},e.prototype.setScale=function(t){this.scaleX=this.scaleY=t},e.prototype.getClassName=function(){return egret.getQualifiedClassName(this)},e.prototype.dispose=function(){this.stopAllActions(),this.removeTouchTap(),this.removeTouch(),this.bindData=null,this.parent&&this.parent.removeChild(this)},e.create=function(t){var i=e.baseBitmapPool.pop(),a=void 0;return a="string"==typeof t?ResourceManager.getRes(t):t,i?egret.is(a,"egret.Texture")&&(i.texture=a):(e.isCanNew=!0,i=new e(a),e.isCanNew=!1),i},e.release=function(t){if(t){if(t instanceof BaseLoadBitmap)return void BaseLoadBitmap.release(t);t.dispose(),t.texture&&(t.texture=null),egret.Tween.removeTweens(t),t.setPosition(0,0),t.setScale(1),t.rotation=0,t.alpha=1,t.width=0/0,t.height=0/0,t.mask=null,t.scrollRect=null,t.filters=null,t.anchorOffsetX=0,t.anchorOffsetY=0,t.visible=!0,t.name=null,t.touchEnabled=!1,t.skewX=t.skewY=0,t.blendMode=egret.BlendMode.NORMAL,e.baseBitmapPool.indexOf(t)<0&&e.baseBitmapPool.push(t)}},e.baseBitmapPool=[],e.isCanNew=!1,e}(egret.Bitmap);__reflect(BaseBitmap.prototype,"BaseBitmap",["base.Iinteractive","base.Ibase"]);var BaseScene=function(t){function e(){var e=t.call(this)||this;return e._npcList=[],e.posCfg={},e.shadowCfg={},e.namePosCfg={},e.npcMessageCfg={},e.guideNeedTouchCfg={},e._isCfgInit=!1,e}return __extends(e,t),e.prototype.initCfg=function(){if(0==this._isCfgInit){var t=App.StringUtil.firstCharToLower(this.getClassName()),e=Config.SceneCfg.getSceneCfgBySceneName(t);this._isCfgInit=!0,e&&(e.posCfg&&(this.posCfg=e.posCfg),e.shadowCfg&&(this.shadowCfg=e.shadowCfg),e.namePosCfg&&(this.namePosCfg=e.namePosCfg),e.npcMessageCfg&&(this.npcMessageCfg=e.npcMessageCfg),e.guideNeedTouchCfg&&(this.guideNeedTouchCfg=e.guideNeedTouchCfg))}},e.prototype.init=function(){this.initCfg(),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_REFRESH_MODE,this.refreshMode,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_CHECKNPC_SHOW,this.checkGuideNpc,this);var t=egret.getQualifiedClassName(this);if(t=t.toLowerCase(),this._sceneLayer||(this._sceneLayer=new BaseDisplayObjectContainer),!this._mapLayer){var e=t+"_"+PlatformManager.getAppid();if(Number(ServerCfg.selectServer.zid)>900&&Number(ServerCfg.selectServer.zid)<1e3&&RES.hasRes(e)){var i=egret.Rectangle.create();i.setTo(0,0,640,1136),this._mapLayer=BaseLoadBitmap.create(e,i),NetLoading.show();var a=egret.setTimeout(function(){NetLoading.hide(),a>-1&&(egret.clearTimeout(a),a=-1)},this,1e3)}else this._mapLayer=BaseBitmap.create(t);this._sceneLayer.addChild(this._mapLayer)}this._effectLayer||(this._effectLayer=new BaseDisplayObjectContainer,this._sceneLayer.addChild(this._effectLayer)),this.setLayerPosition(),this.addChild(this._sceneLayer),this.initNPC(),this.refreshAfterShow()},e.prototype.playBg=function(){var t=this.getSoundBgName();RES.hasRes(t)&&SoundManager.playBg(t)},e.prototype.getSoundBgName=function(){var t=this.getClassName().toLowerCase();return t=t.substring(0,t.indexOf("scene")),"music_"+t},e.prototype.refreshMode=function(t){var e=t.data;if(e==MessageConst.MESSAGE_MODEL_USERINFO)this.checkNpcStatus();else{if(this.posCfg)for(var i in this.posCfg)e.indexOf(i)>-1&&(e=i);this.checkNpcShow(e)}},e.prototype.checkShowNpcMessage=function(t){var e=t;e=this.formatModelToCheck(e);this._sceneLayer.getChildByName(e),this._sceneLayer.getChildByName(e+"name");if(Api[e+"VoApi"]&&Api[e+"VoApi"].isShowNpc){var i=Api[e+"VoApi"].isShowNpc();if(!i)return}if(Api[t+"VoApi"]&&Api[t+"VoApi"].checkNpcMessage){var a=Api[t+"VoApi"].checkNpcMessage();if(a?this.showNpcMessage(t):this.hideNpcMessage(t),"manage"==t&&Api[t+"VoApi"].checkAffairNpcMessage){var n=Api[t+"VoApi"].checkAffairNpcMessage(),o="affair";n?this.showNpcMessage(o):this.hideNpcMessage(o)}}},e.prototype.showNpcMessage=function(t){var e=this;if(this._sceneLayer&&!this.getNpcMessage(t)){var i=this._sceneLayer.getChildByName(t);if(i&&i.isLoaded()&&i.visible&&null==this.getNpcMessage(t)&&this.checkHasView(t)){var a=this.createNpcMessage(t),n=function(){egret.Tween.get(a).to({alpha:.5},1e3).to({alpha:1},1e3).call(n,e)};n()}}},e.prototype.getNpcMessageName=function(t){return t+"tipMessage"},e.prototype.getNpcMessage=function(t){return this._sceneLayer.getChildByName(this.getNpcMessageName(t))},e.prototype.createNpcMessage=function(t){var e=egret.Rectangle.create();e.setTo(0,0,59,133);var i=BaseLoadBitmap.create("scenenamebg",e);i.name=this.getNpcMessageName(t);var a=this._sceneLayer.getChildByName(t+"name");i.setPosition(a.x+(a.width-i.width*i.scaleX)/2,a.y+(a.height-i.height*i.scaleY)/2),this._sceneLayer.addChildAt(i,this._sceneLayer.getChildIndex(a));var n=BaseBitmap.create("public_dot2");return n.name=t+"dot",n.setPosition(a.x+a.width-n.width+5,a.y-10),this._sceneLayer.addChild(n),i},e.prototype.hideNpcMessage=function(t){if(this._sceneLayer){var e=this.getNpcMessageName(t),i=this._sceneLayer.getChildByName(e);i&&BaseLoadBitmap.release(i);var a=this._sceneLayer.getChildByName(t+"dot");a&&BaseBitmap.release(a)}},e.prototype.initNPC=function(){var t=this,e=function(){if(Api.switchVoApi.checkOpenShenhe()&&("rank"==a||"alliance"==a||"dailyboss"==a||"conquest"==a||"trade"==a))return"continue";if(i.shadowCfg[a]){var e=i.shadowCfg[a],n=e.x,o=e.y,s=void 0;s=BaseLoadBitmap.create(i.getNpcName(a)+"_shadow"),s.name=a+"_shadow",s.setPosition(i._mapLayer.x+n,i._mapLayer.y+o),i._sceneLayer.addChild(s)}var r=i.posCfg[a],l=r.x,h=r.y,d=r.scale,g=r.alpha,c=(r.close,r.dragonBones);c&&(c=null),i._npcList.push(a);var p=void 0;c?(l+=c.x,h+=c.y,p=App.DragonBonesUtil.getLoadDragonBones(a)):p=BaseLoadBitmap.create(i.getNpcName(a)),p.name=a,p.x=i._mapLayer.x+l,p.y=i._mapLayer.y+h,isNaN(g)||(p.alpha=g),d&&(p.scaleX=p.scaleY=d),i._sceneLayer.addChild(p);var _=a+"name";if(i.namePosCfg[_]){var u=i.namePosCfg[_],C=u.x,f=u.y,m=u.scale;i._npcList.push(_);var T=void 0,y=egret.Rectangle.create();y.setTo(0,0,35,96);var v=i.getNpcName(_);if(Api.switchVoApi["checkOpenNew"+App.StringUtil.firstCharToUper(a)]){var A=Api.switchVoApi["checkOpenNew"+App.StringUtil.firstCharToUper(a)]();A&&RES.hasRes(v+"_2")&&(v+="_2")}T=BaseLoadBitmap.create(v,y,{callback:i.checkNpcShow,callbackThisObj:i,callbackParams:[a]}),T.name=_,T.setPosition(i._mapLayer.x+C,i._mapLayer.y+f),m&&T.setScale(m),i._sceneLayer.addChild(T);var w=!0;if(Api[a+"VoApi"]&&Api[a+"VoApi"].isShowNpc&&(w=Api[a+"VoApi"].isShowNpc()),i.isNpcNameMove()&&w&&i.checkHasView(a)){var x=T.y,I=function(){egret.Tween.get(T).to({y:x+5},1e3).to({y:x-5},1e3).call(I,t)};I()}}i.checkNpcShow(a)},i=this;for(var a in this.posCfg)e();this._sceneLayer.touchEnabled=!0;this._sceneLayer.addTouch(this.onNPCTouchHandler,this,null,!0)},e.prototype.formatModelToCheck=function(t){return(t==MessageConst.MESSAGE_MODEL_USERINFO||t==MessageConst.MESSAGE_MODEL_WIFESKIN)&&(t="wife"),t},e.prototype.checkGuideNpc=function(t){var e=t.data;this.checkNpcShow(e.key)},e.prototype.checkNpcShow=function(t){var e,i=this;e="string"==typeof t?t:t.data,e=this.formatModelToCheck(e);var a=this._sceneLayer.getChildByName(e),n=this._sceneLayer.getChildByName(e+"name");if(null!=n){if(Api[e+"VoApi"]&&Api[e+"VoApi"].isShowNpc){var o=Api[e+"VoApi"].isShowNpc(),s=this._sceneLayer.getChildByName(e+"_shadow");if(this.posCfg[e]&&null!=this.posCfg[e].alpha)if(o){if(this.isNpcNameMove()&&null!=n.filters){var r=n.y,l=function(){egret.Tween.get(n).to({y:r+5},1e3).to({y:r-5},1e3).call(l,i)};l()}App.DisplayUtil.changeToNormal(n)}else App.DisplayUtil.changeToGray(n);else a&&(a.visible=o),n&&(n.visible=o),s&&(s.visible=o)}else this.checkHasView(e)||n&&App.DisplayUtil.changeToGray(n);a&&a.visible&&a.isLoaded()&&this.checkShowNpcMessage(e)}},e.prototype.isNpcNameMove=function(){return!1},e.prototype.checkNpcStatus=function(){for(var t in this.posCfg)this.checkNpcShow(t)},e.prototype.getNpcName=function(t){var e=this.getClassName().toLowerCase();return e.substr(0,e.indexOf("scene"))+"npc"+t},e.prototype.onNPCTouchHandler=function(t){if(t.type==egret.TouchEvent.TOUCH_BEGIN||t.type==egret.TouchEvent.TOUCH_CANCEL||t.type==egret.TouchEvent.TOUCH_END){if(t.type==egret.TouchEvent.TOUCH_BEGIN){var e=null;for(var i in this._npcList){var a=this._sceneLayer.getChildByName(this._npcList[i]),n=(this._sceneLayer.globalToLocal(t.stageX,t.stageY),-9999);a.hitTestPoint(Math.floor(t.localX),Math.floor(t.localY),!0)&&a.y>n&&(n=a.y,e=this._npcList[i])}if(e){if(e.indexOf("name")>-1&&(e=e.substring(0,e.indexOf("name"))),this._clickNpc=this._sceneLayer.getChildByName(e),this._clickNpc&&0==this._clickNpc.visible)return void(this._clickNpc=null);if(Api.rookieVoApi.isInGuiding)this.guideNeedTouchCfg[e]||(this._clickNpc=null);else if(Api.rookieVoApi.isGuiding){var o=Api.rookieVoApi.curGuideKey;o&&o!=e&&(this._clickNpc=null)}}}if(t.type==egret.TouchEvent.TOUCH_BEGIN?this._clickNpc&&(this.posCfg[this._clickNpc.name].touchDown===!1||(this._clickNpc.alpha=.3)):t.type==egret.TouchEvent.TOUCH_CANCEL&&this._clickNpc&&(this.posCfg[this._clickNpc.name].touchDown===!1||(this._clickNpc.alpha=0),this._clickNpc=null),t.type==egret.TouchEvent.TOUCH_END&&this._clickNpc){this._clickNpc&&(this.posCfg[this._clickNpc.name].touchDown===!1||(this._clickNpc.alpha=0));var e=this._clickNpc.name;if(e){if(Api[e+"VoApi"]&&Api[e+"VoApi"].isShowNpc){var s=Api[e+"VoApi"].isShowNpc();if(0==s&&this.posCfg[e]&&null!=this.posCfg[e].alpha){this._clickNpc=null;var r=Api[e+"VoApi"].getLockedString?Api[e+"VoApi"].getLockedString():LanguageManager.getlocal("sysWaitOpen");return void App.CommonUtil.showTip(r?r:LanguageManager.getlocal("sysWaitOpen"))}}if(Api[e+"VoApi"]&&Api[e+"VoApi"].openMainView)Api[e+"VoApi"].openMainView();else{var l=App.StringUtil.firstCharToUper(e)+"View";this.checkHasView(e)?ViewController.getInstance().openView(l):App.CommonUtil.showTip(LanguageManager.getlocal("sysWaitOpen"))}}this._clickNpc=null}}},e.prototype.checkHasView=function(t){var e=App.StringUtil.firstCharToUper(t)+"View";return egret.hasDefinition(e)},e.prototype.setLayerPosition=function(){this._mapLayer.setPosition(0,GameConfig.stageHeigth-this._mapLayer.height),this.setFly()},e.prototype.setFly=function(){},e.prototype.tick=function(){if(this.posCfg)for(var t in this.posCfg)this.checkShowNpcMessage(t)},e.prototype.getResourceList=function(){var t=egret.getQualifiedClassName(this);t=t.toLowerCase();var e=[t];return e},e.prototype.getParent=function(){return LayerManager.bgLayer},e.prototype.show=function(){Api.rookieVoApi.hiddenRookieView(),this.isShow()?(this.parent||this.getParent().addChild(this),this.refreshAfterShow()):t.prototype.show.call(this)},e.prototype.hide=function(e){e?t.prototype.hide.call(this):this.parent&&this.parent.removeChild(this)},e.prototype.resGroupLoadError=function(){t.prototype.hideLoadingMask.call(this),t.prototype.hide.call(this)},e.prototype.refreshAfterShow=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_HIDE_LAST_SCENE),this.playBg(),(!ViewController.getInstance().checkHasShowedView()||Api.rookieVoApi.isInGuiding)&&(this.posCfg&&this.posCfg[Api.rookieVoApi.curGuideKey]&&Api.rookieVoApi.checkWaitingGuide(),Api.rookieVoApi.showRookieView())},e.prototype.dispose=function(){this._npcList.length=0,this._sceneLayer&&(this._sceneLayer.dispose(),this._sceneLayer=null),this._mapLayer=null,this._clickNpc=null,this._isCfgInit=!1,App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_REFRESH_MODE,this.refreshMode,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_CHECKNPC_SHOW,this.checkGuideNpc,this),t.prototype.dispose.call(this)},e}(BaseLoadDisplayObjectContiner);__reflect(BaseScene.prototype,"BaseScene");var BaseButton=function(t){function e(){var e=t.call(this)||this;return e._textStr="",e._font=null,e._fontSize=TextFieldConst.FONTSIZE_BUTTON_COMMON,e._type1Scale=.9,e._noDownImgType=0,e._textIconSp=null,e._statusIconSp=null,e}return __extends(e,t),e.prototype.init=function(t,e,i,a,n,o,s){this._buttonName=t,this._textStr=e,this._callback=i,this._handler=a,this._fontSize=o,this._param=n,isNaN(s)?this._noDownImgType=0:this._noDownImgType=s,this.touchEnabled=!0,this.addTouch(this.eventHandler,this),this._buttonImage=BaseBitmap.create(t),this._buttonImage.x=0,this._buttonImage.y=0,this.addChild(this._buttonImage),this._textLb=new BaseTextField,this._font&&(this._textLb.fontFamily=this._font),this._fontSize&&(this._textLb.size=this._fontSize),this.addChild(this._textLb),this.updateButtonImage(),this.setText(this._textStr)},e.prototype.isEnable=function(){return this._enable},e.prototype.callbackHanler=function(t){t&&(this._param=t),this._callback&&this._callback.apply(this._handler,this._param)},e.prototype.getCallbackFunc=function(){return this._callback},e.prototype.setText=function(t,e){if(void 0===e&&(e=!0),this._textLb&&(this._textStr=t,t&&(e?this._textLb.setString(LanguageManager.getlocal(t)):this._textLb.setString(t)),this._buttonImage)){this._textLb.width>this._buttonImage.width&&(this._textLb.width=this._buttonImage.width);var i=this._buttonImage.x+this._buttonImage.width/2-this._textLb.width/2,a=this._buttonImage.y+this._buttonImage.height/2-this._textLb.height/2+this.getTextOffY();this._textLb.setPosition(i,a)}},e.prototype.setParams=function(t){this._param=t},e.prototype.setColor=function(t){this._textLb.textColor=t},e.prototype.setEnable=function(t){this._enable=t,this.touchEnabled=t,t?App.DisplayUtil.changeToNormal(this._buttonImage):App.DisplayUtil.changeToGray(this._buttonImage)},e.prototype.updateButtonImage=function(t){if(void 0===t&&(t=e.BTN_STATE1),this._buttonImage){var i="";switch(t){case e.BTN_STATE1:i=this._buttonName;break;case e.BTN_STATE2:i=this._buttonName+"_down";break;case e.BTN_STATE3:i=this._buttonName+"disabled"}var a=ResourceManager.getRes(i),n=!1;null==a&&(a=ResourceManager.getRes(this._buttonName)),RES.hasRes(this._buttonName+"_down")||(n=!0),this._buttonImage.texture!=a&&(this._buttonImage.texture=a,this.width=this._buttonImage.width,this.height=this._buttonImage.height),this._textLb&&(this._textIconSp||(this._textLb.x=.5+this._buttonImage.width/2-this._textLb.width/2,this._textLb.y=.5+this._buttonImage.height/2-this._textLb.height/2+this.getTextOffY())),n&&this.checkNoDownImageState()}},e.prototype.addTextIcon=function(t,e){if(void 0===e&&(e=0),this._textIconSp=BaseBitmap.create(t),this._textIconSp){var i=33;this._textIconSp.scaleX=i/this._textIconSp.width,this._textIconSp.scaleY=i/this._textIconSp.height;var a=i+this._textLb.width;this._textIconSp.x=(this.width-a)/2,this._textIconSp.y=(this.height-i)/2,1==e?this._textLb.x=this._textIconSp.x+i+10:this._textLb.x=this._textIconSp.x+i,this.addChild(this._textIconSp)}},e.prototype.removeTextIcon=function(){this.removeChild(this._textIconSp),this._textIconSp=null},e.prototype.showStatusIcon=function(t){if(void 0===t&&(t=""),null==this._statusIconSp){if(""==t)return;this._statusIconSp=BaseBitmap.create(t),this._statusIconSp.x=this.width-this._statusIconSp.width,this._statusIconSp.y=0,this.addChild(this._statusIconSp)}else this._statusIconSp.visible=!0},e.prototype.removeStatusIcon=function(){this._statusIconSp&&(this._statusIconSp.visible=!1)},e.prototype.eventHandler=function(t){if(0!=this._enable)switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._isBegin=!0,this.updateButtonImage(e.BTN_STATE2),SoundManager.playEffect(SoundConst.EFFECT_CLICK);break;case egret.TouchEvent.TOUCH_END:this._isBegin&&(this._isBegin=!1,this.updateButtonImage(e.BTN_STATE1),this.callbackHanler());break;case egret.TouchEvent.TOUCH_CANCEL:this._isBegin=!1,this.updateButtonImage(e.BTN_STATE1)}},e.prototype.checkNoDownImageState=function(){0==this._noDownImgType?this.scaleState():1==this._noDownImgType&&this.alphaState()},e.prototype.alphaState=function(){1==this._noDownImgType&&(1==this._isBegin?this.alpha=.8:this.alpha=1)},e.prototype.scaleState=function(){if(0==this._noDownImgType){var t=this.scaleX,e=this.scaleY;1==this._isBegin?(this.scaleX*=this._type1Scale,this.scaleY*=this._type1Scale):(this.scaleX/=this._type1Scale,this.scaleY/=this._type1Scale),this.x+=(this.width*t-this.width*this.scaleX)/2,this.y+=(this.height*e-this.height*this.scaleY)/2}},e.prototype.setScale=function(t){this.scaleX=this.scaleY=t},e.prototype.leaveStageHandler=function(t){this._isBegin&&(this._isBegin=!1,this.updateButtonImage(e.BTN_STATE1))},e.prototype.isBegin=function(){return this._isBegin},e.prototype.setBigin=function(t){this._isBegin=t},e.prototype.getTextOffY=function(){var t=0;return t},e.prototype.dispose=function(){this._buttonImage&&(this._buttonImage=null),this._textLb&&(this._textLb=null),this._textIconSp&&(this._textIconSp=null),this._buttonName=null,this._enable=null,this._callback=null,this._handler=null,this._textStr=null,this._font=null,this._fontSize=null,this._isChangeRes=null,this._noDownImgType=0,this._statusIconSp=null,t.prototype.dispose.call(this)},e.BTN_STATE1=1,e.BTN_STATE2=2,e.BTN_STATE3=3,e}(BaseDisplayObjectContainer);__reflect(BaseButton.prototype,"BaseButton");var BaseViewController=function(t){function e(){var e=t.call(this)||this;return e._viewList=new Object,e._isTickStarted=!1,e}return __extends(e,t),e.prototype.openView=function(t,e){if(t){var i=t.replace("View","");if(i=App.StringUtil.firstCharToLower(i),Api[i+"VoApi"]&&Api[i+"VoApi"].getOpenViewMessage){var a=Api[i+"VoApi"].getOpenViewMessage();if(a)return App.CommonUtil.showTip(a)}var n=this.getViewNameAndParam(t),o=n.viewName,s=n.viewParam,r=void 0;if(this._viewList.hasOwnProperty(o))r=this._viewList[o];else{var l=egret.getDefinitionByName(o);if(!l)return void App.LogUtil.show("缺少"+o);r=new l,this._viewList[o]=r}var h=void 0;s&&(h={tab:s}),e&&(h?h.data=e:h={data:e}),r.show(h),r.tick&&0==this._isTickStarted&&(TickManager.addTick(this.tick,this),this._isTickStarted=!0)}},e.prototype.tick=function(){if(this._viewList)for(var t in this._viewList){var e=this._viewList[t];e&&e.isInit()&&e.tick&&e.tick()}},e.prototype.viewHided=function(t){},e.prototype.checkAndStopTick=function(t){},e.prototype.hideView=function(t){var e=this.getViewNameAndParam(t).viewName,i=void 0;this._viewList.hasOwnProperty(e)&&(i=this._viewList[e],i.hide())},e.prototype.getView=function(t){var e=this.getViewNameAndParam(t).viewName,i=void 0;return this._viewList.hasOwnProperty(e)&&(i=this._viewList[e]),i},e.prototype.getViewNameAndParam=function(t){var e=t.split("|"),i=e[0],a=e[1];return{viewName:i,viewParam:a}},e.prototype.hideAllView=function(){if(this._viewList)for(var t in this._viewList){var e=this._viewList[t];e&&e.isShow()&&(0==LoginManager.isCreateScene&&e instanceof LoginView||(e.hide.length>0?e.hide.call(e,!0):e.hide()))}},e.prototype.checkHasShowedView=function(){if(this._viewList)for(var t in this._viewList){var e=this._viewList[t];if(e&&e.isShow())return!0}return!1},e.prototype.dispose=function(){if(this._viewList)for(var t in this._viewList){var e=this._viewList[t];e&&e.hide(),delete this._viewList[t]}},e}(BaseController);__reflect(BaseViewController.prototype,"BaseViewController");var ProgressBar=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(t,e,i,a){this._barWidth=i,this._barHeight=a,this._progressBarBgResName=e,this.progressBarResName=t,this.initUI()},e.prototype.initUI=function(){this._progressBarBg=BaseBitmap.create(this._progressBarBgResName),this.addChild(this._progressBarBg),this.progressBar=BaseBitmap.create(this.progressBarResName),this.checkScale9Rect(),this.progressBar.x=this._progressBarBg.x+.5*(this._progressBarBg.width-this.progressBar.width),this.progressBar.y=this._progressBarBg.y+.5*(this._progressBarBg.height-this.progressBar.height),this.addChild(this.progressBar),this._textLb=ComponentManager.getTextField("0/0",TextFieldConst.FONTSIZE_CONTENT_SMALL),this._textLb.width=this._barWidth-20,this._textLb.textAlign=egret.HorizontalAlign.CENTER,this._textLb.verticalAlign=egret.VerticalAlign.MIDDLE,this._textLb.setPosition(.5*(this._progressBarBg.width-this._textLb.width),.5*(this._progressBarBg.height-this._textLb.height)),this.addChild(this._textLb),this._textLb.text="",RES.hasRes(this.progressBarResName+"_light")&&(this.progressBarLight=BaseBitmap.create(this.progressBarResName+"_light"),this.progressBarLight.setPosition(this.progressBar.x-this.progressBarLight.width/2,this.progressBar.y+(this.progressBar.height-this.progressBarLight.height)/2),this.addChild(this.progressBarLight))},e.prototype.checkScale9Rect=function(){var t=this._progressBarBg.width-this.progressBar.width,e=this._progressBarBg.height-this.progressBar.height;0>t&&(t=4),0>e&&(e=4),this._barWidth<this._progressBarBg.width&&(this._barWidth=this._progressBarBg.width),this._barHeight<this._progressBarBg.height&&(this._barHeight=this._progressBarBg.height),this._barWidth||(this._barWidth=this._progressBarBg.width),this._barHeight||(this._barHeight=this._progressBarBg.height),this._progressBarBg.width=this._barWidth,this._progressBarBg.height=this._progressBarBg.height,this.progressBar.width=this._barWidth-t,this.progressBar.height=this._barHeight-e},e.prototype.setPercentage=function(t,e,i){this.percents=t,null==this._mask?this._mask=new egret.Rectangle(0,0,this.progressBar.width*t,this.progressBar.height):this._mask.setTo(0,0,this.progressBar.width*t,this.progressBar.height),this.progressBar.mask=this._mask,this.progressBarLight&&(this.progressBarLight.x=this.progressBar.x+this._mask.width-this.progressBarLight.width/2),this._textLb&&(null!=e&&this.setText(e),i&&this.setTextColor(i))},e.prototype.getBgWidth=function(){return this._progressBarBg?this._progressBarBg.width:0},e.prototype.getBgHeight=function(){return this._progressBarBg?this._progressBarBg.height:0},Object.defineProperty(e.prototype,"percent",{get:function(){return this.percents},set:function(t){this.setPercentage(t)},enumerable:!0,configurable:!0}),e.prototype.getPercent=function(){return this.percents},e.prototype.setTextSize=function(t){null!=t&&this._textLb&&(this._textLb.size=t,""==this._textLb.text?(this._textLb.text="0/0",this._textLb.setPosition(.5*(this._progressBarBg.width-this._textLb.width),.5*(this._progressBarBg.height-this._textLb.height)),this._textLb.text=""):this._textLb.setPosition(.5*(this._progressBarBg.width-this._textLb.width),.5*(this._progressBarBg.height-this._textLb.height)))},e.prototype.setText=function(t){if(null!=t&&this._textLb)try{this._textLb.text=t,this._textLb.x=.5*(this._progressBarBg.width-this._textLb.width)}catch(e){App.LogUtil.log(e)}},e.prototype.setTextColor=function(t){t&&this._textLb&&(this._textLb.textColor=t)},e.prototype.tweenTo=function(t,e,i,a,n){if(i){var o=this;egret.Tween.get(this).to({percent:1},(1-this.percent)*e).call(function(i){egret.Tween.removeTweens(o),o.tweenNext(e,t,i,a,n)},this,[i-1])}else{var s=t-this.percent;0>s&&(s=0),egret.Tween.get(this).to({percent:t},s*e).call(function(){a&&a.apply(n)},this)}},e.prototype.tweenNext=function(t,e,i,a,n){var o=this;egret.Tween.removeTweens(this),this._tweenTo=null,this._tweenTo||(this._tweenTo=egret.Tween.get(this)),this.percent=0,i>0?this._tweenTo.to({percent:1},t).call(this.tweenNext,this,[t,e,i-1,a,n]):this._tweenTo.to({percent:e},t*e).call(function(){egret.Tween.removeTweens(o),o._tweenTo=null,a&&a.apply(n)},this)},e.prototype.dispose=function(){BaseBitmap.release(this._progressBarBg),this._progressBarBg=null,BaseBitmap.release(this.progressBar),this.progressBar=null,this.progressBarResName=null,this._progressBarBgResName=null,this._barWidth=null,this._barHeight=null,this._textLb.dispose(),this._textLb=null,this.percents=null,this._mask=null,this._tweenTo=null,this.progressBarLight=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(ProgressBar.prototype,"ProgressBar");var AcCommonView=function(t){function e(){var e=t.call(this)||this;return e.aid=App.StringUtil.firstCharToLower(e.getClassName().replace("Ac","").replace("View","")),e}return __extends(e,t),Object.defineProperty(e.prototype,"code",{get:function(){return this.param.data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"acVo",{get:function(){return Api.acVoApi.getActivityVoByAidAndCode(this.aid,this.code)},enumerable:!0,configurable:!0}),e.prototype.getTitleStr=function(){return"ac"+App.StringUtil.firstCharToUper(this.acVo.aidAndCode)+"_Title"},e.prototype.getTitleParams=function(){return null},e}(CommonView);__reflect(AcCommonView.prototype,"AcCommonView");var BaseBattleView=function(t){function e(){var e=t.call(this)||this;return e._topProgress=null,e._topMaxValue=0,e._topCurValue=0,e._topProgressType=1,e._bottomProgress=null,e._bottomMaxValue=0,e._bottomCurValue=0,e._upHero=null,e._upPositon=null,e._downHero=null,e._downPositon=null,e._isMoving=!1,e._heroArray=[],e._damage=0,e._area=0,e._isCrit=!1,e._damageText=null,e._beAttackClip=null,e._heroMask=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([this.getHitAnimSources(),"damage_fnt","atkrace_crit_bg","atkrace_crit_text","enermycrit_circle","enermycrit_light","critenermyflash1","critenermyflash2","critenermyflash3","critenermyspeed1","critenermyspeed2","critenermyspeed3","critenermyspeed4","critenermyspeed5","mycrit_circle","mycrit_light","critmyflash1","critmyflash2","critmyflash3","critmyspeed1","critmyspeed2","critmyspeed3","critmyspeed4","critmyspeed5"])},e.prototype.getHitAnimSources=function(){return"battle_attack_anim"},e.prototype.getHitAnimInfo=function(){return["atk_anim_",7]},e.prototype.getBgName=function(){return this.getClassName().toLowerCase().replace("view","")+"_bg"},e.prototype.init=function(){t.prototype.init.call(this),this.container.y=this.getTitleButtomY(),this._beAttackClip=ComponentManager.getCustomMovieClip(this.getHitAnimInfo()[0],this.getHitAnimInfo()[1],70),this._beAttackClip.setEndCallBack(this.clipEndCallback,this)},e.prototype.initBg=function(){var t=this.getBgName();if(t){var e=egret.Rectangle.create();e.setTo(0,0,640,1136),this.viewBg=BaseLoadBitmap.create(t,e),this.viewBg.setPosition(0,(GameConfig.stageHeigth-this.viewBg.height)/2),this.addChild(this.viewBg)
}},e.prototype.setTopProgress=function(t,e,i,a){if(void 0===a&&(a=1),0>t&&(t=0),e&&(this._topMaxValue=Math.ceil(e)),null==this._topProgress&&(this._topProgress=ComponentManager.getProgressBar("progress8","progress7_bg",i?i:GameConfig.stageWidth),this._topProgress.setPosition((GameConfig.stageWidth-this._topProgress.width)/2,0),this.addChildToContainer(this._topProgress),e||(this._topMaxValue=t),a&&(this._topProgressType=a)),this._topCurValue=t,1==this._topProgressType)this._topCurValue=Math.ceil(100*this._topCurValue)/100,this._topProgress.setText(this._topCurValue.toString()+"/"+this._topMaxValue);else{var n=Math.ceil(1e4*this._topCurValue/this._topMaxValue),o=(n/100).toString()+"%";this._topProgress.setText(o)}this._topProgress.setPercentage(this._topCurValue/this._topMaxValue)},e.prototype.setBottomProgress=function(t,e){0>t&&(t=0),null==this._bottomProgress&&(this._bottomProgress=ComponentManager.getProgressBar("progress8","progress7_bg",GameConfig.stageWidth),this._bottomProgress.y=GameConfig.stageHeigth-this._bottomProgress.height,this.addChildToContainer(this._bottomProgress),e?this._bottomMaxValue=e:this._bottomMaxValue=t),this._bottomCurValue=t,this._bottomCurValue=Math.ceil(100*this._bottomCurValue)/100,this._bottomProgress.setText(this._bottomCurValue.toString()+"/"+this._bottomMaxValue),this._bottomProgress.setPercentage(this._bottomCurValue/this._bottomMaxValue)},e.prototype.setUpHero=function(t,e,i){this._upHero&&(this._upHero.dispose(),this._upHero=null),this._upHero=new BattleHero,this._upHero.init(t,e,i,0),this._upHero.setPosition(GameConfig.stageWidth/2-this._upHero.width/2,60),this._upPositon=egret.Point.create(this._upHero.x,this._upHero.y),this.addChildToContainer(this._upHero)},e.prototype.setDownHero=function(t,e,i){this._downHero&&(this._downHero.dispose(),this._downHero=null),this._downHero=new BattleHero,this._downHero.init(t,e,i,1),this._downHero.setPosition(GameConfig.stageWidth/2-this._upHero.width/2,GameConfig.stageHeigth-this._downHero.height-60-this.getTitleButtomY()),this._downPositon=egret.Point.create(this._downHero.x,this._downHero.y),this.addChildToContainer(this._downHero)},e.prototype.attackHandle=function(t,e,i){var a=this;if(1!=this._isMoving){this._isMoving=!0,this._heroArray.length=0,this._damage=e,this._area=t;var n,o,s,r=.75;1==t?(this._heroArray=[this._downHero,this._upHero],n=50,o=this._upHero.y+100,s=n*(this._downHero.x-this._upHero.x)/(this._downHero.y-this._upHero.y)):(this._heroArray=[this._upHero,this._downHero],n=-50,o=this._downHero.y-100+this._downHero.height*(1-r),s=n*(this._downHero.x-this._upHero.x)/(this._downHero.y-this._upHero.y)),this.container.getChildIndex(this._heroArray[0])<this.container.getChildIndex(this._heroArray[1])&&this.container.swapChildren(this._heroArray[0],this._heroArray[1]);var l=0;1==i?(l=1530,this._isCrit=!0,this.showCritAnim(t)):this._isCrit=!1;var h=60,d=260,g=egret.Point.create(this._heroArray[1].x+(1-r)*this._heroArray[0].width/2,o),c=1.06;egret.Point.create(this._heroArray[0].x-(c-1)*this._heroArray[0].width/2,this._heroArray[0].y-(c-1)*this._heroArray[0].height/2);egret.Tween.get(this._heroArray[0]).wait(l).call(function(){a._isCrit&&egret.Tween.get(a._heroArray[0].tmpMap).to({alpha:1},300).call(function(){a._heroArray[0].tmpMap.alpha=0,egret.Tween.removeTweens(a._heroArray[0].tmpMap)},a)},this).to({x:this._heroArray[0].x+(1==t?20:-20),y:this._heroArray[0].y+(1==t?20:-20)},300).call(function(){a._isCrit&&a._heroArray[0].setMaskOffSet()},this).to({x:g.x,y:g.y,scaleX:r,scaleY:r},h).call(function(){egret.Tween.get(a._heroArray[0]).to({scaleX:1,scaleY:1},400)},this).to({x:this._heroArray[0].x,y:this._heroArray[0].y},d).call(function(){a._isCrit&&a._heroArray[0].resetMaskOffSet()},this),this._isCrit,TimerManager.doTimer(l+300+h,1,this.showBeAttackAnim,this)}},e.prototype.playHitEffcet=function(){SoundManager.playEffect(SoundConst.EFFECT_BATTLE_HIT)},e.prototype.resetTopProgressAfterDamage=function(){this.setTopProgress(this._topCurValue-this._damage)},e.prototype.showBeAttackAnim=function(){if(0!=this._heroArray.length){var t,e=this._heroArray[1];1==this._area?(t=-30,this.resetTopProgressAfterDamage()):(t=30,this.setBottomProgress(this._bottomCurValue-this._damage)),egret.Tween.get(e).to({y:e.y+t},100).to({y:e.y},120);var i=BaseBitmap.create(this.getHitAnimInfo()[0]+"1");this._beAttackClip.setPosition(this._heroArray[1].x+this._heroArray[1].width/2-i.width/2,e.y+e.height/2-i.height/2),this.addChildToContainer(this._beAttackClip),this._beAttackClip.goToAndPlay(0),this._beAttackClip.playWithTime(1);var a;a=this._isCrit?"crit_fnt":"damage_fnt",this._damageText=ComponentManager.getBitmapText("-"+Math.floor(this._damage).toString(),a),this._damageText.setPosition(this._heroArray[1].x+this._heroArray[1].width/2-this._damageText.width/2,e.y+e.height/2-50),this.addChildToContainer(this._damageText),egret.Tween.get(this._damageText).to({y:this._damageText.y+3*t},300).to({y:this._damageText.y+6*t,alpha:.1},600).call(this.playEnd,this),this.playHitEffcet()}},e.prototype.clipEndCallback=function(){this._beAttackClip&&this.removeChildFromContainer(this._beAttackClip)},e.prototype.showCritAnim=function(t){var e=this,i=1==t?"my":"enermy",a=1==t?this._downHero:this._upHero,n=new BaseShape;n.graphics.beginFill(0,.7),n.graphics.drawRect(0,0,GameConfig.stageWidth,GameConfig.stageHeigth),n.graphics.endFill(),this.container.addChildAt(n,0),n.alpha=0,egret.Tween.get(n).to({alpha:.7},130).call(function(){var t=ComponentManager.getCustomMovieClip("crit"+i+"flash",3,60);t.scaleX=t.scaleY=2,t.x=a.x+a.width/2-320,t.y=a.y+a.height/2-180,e.addChildToContainer(t),t.setEndCallBack(function(){e.container.removeChild(t),t.dispose(),t=null},e),t.playWithTime(1)},this).wait(2500).to({alpha:0},170).call(function(){egret.Tween.get(n),e.container.removeChild(n),n.dispose(),n=null},this);var o=ComponentManager.getCustomMovieClip("crit"+i+"speed",5,100),s=(GameConfig.stageWidth-640)/2,r=a.y-(361.6-a.height)/2;o.x=s,o.y=r,o.scaleX=2,o.scaleY=.15,o.alpha=0;var l=this.container.getChildIndex(a);this.container.addChildAt(o,l-1),o.playWithTime(-1),egret.Tween.get(o).wait(200).to({scaleY:1.6,alpha:1},130).call(function(){for(var n=[{x:1==t?a.x+a.width/2:a.x-30,y:o.y+50,moveX:10,moveY:15,scale:.5},{x:1==t?a.x+a.width/2+40:a.x-60,y:o.y+53,moveX:-15,moveY:-20,scale:.7},{x:1==t?a.x-234:a.x+a.width+80,y:o.y+100,moveX:-30,moveY:0,scale:1}],s=function(t){var n=BaseBitmap.create(i+"crit_circle");n.scaleX=n.scaleY=t.scale,n.alpha=.7;var o=e.container.getChildIndex(a);n.x=t.x,n.y=t.y,e.container.addChildAt(n,o-1),egret.Tween.get(n).to({x:n.x+t.moveX,y:n.y+t.moveY},1e3).to({scaleY:.01,y:n.y+n.height*(t.scale-.01)/2,alpha:0},130).call(function(){egret.Tween.removeTweens(n),e.container.removeChild(n),BaseBitmap.release(n),n=null},e)},r=0,l=n;r<l.length;r++){var h=l[r];s(h)}for(var d=[{x:-100,y:a.y+50,moveX:30},{x:GameConfig.stageWidth-480+140,y:a.y+160,moveX:30},{x:-50,y:a.y+270,moveX:30}],g=function(n){var o=BaseBitmap.create(i+"crit_light"),s=e.container.getChildIndex(a);o.scaleX=2.5,o.x=1==t?n.x:GameConfig.stageWidth-n.x-2.5*o.width,o.y=n.y,e.container.addChildAt(o,s+1),egret.Tween.get(o).to({x:o.x+n.moveX},1e3).to({scaleY:.01,y:o.y+.99*o.height/2,alpha:0},130).call(function(){egret.Tween.removeTweens(o),e.container.removeChild(o),BaseBitmap.release(o),o=null},e)},c=0,p=d;c<p.length;c++){var h=p[c];g(h)}},this).wait(1e3).to({scaleY:.01,x:s,y:r+224.87,alpha:0},130).call(function(){egret.Tween.removeTweens(o),e.container.removeChild(o),o.dispose(),o=null},this);var h=BaseBitmap.create("atkrace_crit_text");h.alpha=0,h.scaleX=h.scaleY=4;var d=1==t?80:a.x+a.width,g=a.y+a.height/2-52.5;h.x=d-205.5,h.y=g-112.5,this.addChildToContainer(h),egret.Tween.get(h).to({alpha:.33},260).to({alpha:1,scaleX:1.25,scaleY:1.25,x:d-17.125,y:g-9.375},130).to({scaleX:1.35,scaleY:1.35,x:d-137*(1.35-1)/2,y:g-75*(1.35-1)/2},60).wait(880).to({x:1==t?0-1.35*137:GameConfig.stageWidth,alpha:0},200).call(function(){egret.Tween.removeTweens(h),e.container.removeChild(h),BaseBitmap.release(h),h=null},this);var c=BaseBitmap.create("atkrace_crit_bg"),p=this.container.getChildIndex(h);c.x=d-137*(1.35-1)/2-(258-1.35*137)/2,c.y=g-75*(1.35-1)/2- -10.625,c.alpha=0,this.container.addChildAt(c,p-1),egret.Tween.get(c).wait(400).to({alpha:1},130).wait(800).to({x:1==t?-258:GameConfig.stageWidth,alpha:0},200).call(function(){egret.Tween.removeTweens(c),e.container.removeChild(c),BaseBitmap.release(c),c=null},this),egret.Tween.get(a.tmpMap).wait(260).to({alpha:1},10).wait(60).to({alpha:0},200).call(function(){egret.Tween.removeTweens(a.tmpMap)},this)},e.prototype.playEnd=function(){this.removeChildFromContainer(this._damageText),this._damageText=null,this._isMoving=!1,egret.Tween.removeTweens(this._upHero),egret.Tween.removeTweens(this._downHero),this._upHero.setScale(1),this._downHero.setScale(1),this._upHero.setPosition(this._upPositon.x,this._upPositon.y),this._downHero.setPosition(this._downPositon.x,this._downPositon.y),this.atkEndCallback()},e.prototype.atkEndCallback=function(){},e.prototype.initView=function(){},e.prototype.dispose=function(){this._topProgress=null,this._bottomProgress=null,this._topMaxValue=0,this._bottomMaxValue=0,this._topCurValue=0,this._bottomCurValue=0,this._upHero=null,this._downHero=null,this._isMoving=!1,this._heroArray.length=0,this._damage=0,this._damageText=null,this._area=0,this._beAttackClip&&this._beAttackClip.dispose(),this._beAttackClip=null,this._isCrit=!1,this._upPositon=null,this._downPositon=null,this._topProgressType=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(BaseBattleView.prototype,"BaseBattleView");var BattleView=function(t){function e(){var e=t.call(this)||this;return e._leftSoldiers=[],e._rightSoldiers=[],e._curLost=[0,0],e._meetPointTab=[],e._preLineNum=8,e._maxLineNum=5,e._unitNunberTab=[3e4,5e5,25e4],e._totalNum=[],e._totalOldNum=[],e._lostNum=[],e._showCount=[],e._lostSoldier=[],e._averageNum=[],e._lostOrder=[],e._curOrder=0,e._battleInfoTab=[],e._isLuanzPlay=!1,e._shakeStTime=0,e._isShakeing=!1,e._callbackF=null,e._obj=null,e._lastDeathTime=0,e._deathRate=0,e._rewards=null,e._skipBtn=void 0,e}return __extends(e,t),e.prototype.getBgName=function(){return null},e.prototype.resetConfig=function(){},e.prototype.battleBgName=function(){return"battlebg"},e.prototype.init=function(){t.prototype.init.call(this),this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f),this._battleBg=new BaseDisplayObjectContainer,this.addChildAt(this._battleBg,1);var e=BaseBitmap.create(this.battleBgName());e.scaleX=(e.width+30)/e.width,e.scaleY=(e.height+30)/e.height,e.x=-10,e.y=-10,this._battleBg.addChild(e),GameConfig.stageHeigth<1060&&(this._battleBg.y-=1060-GameConfig.stageHeigth),this.resetConfig(),this.calculateSoldierNumber(),this.initRightSoldiers(),this.initLeftSoldiers(),this.calculateMeetPoint(),this._gameBtn=BaseBitmap.create(ButtonConst.BATTLE_START_BTN_1),this._gameBtn.addTouchTap(this.btnClick,this),this._gameBtn.setPosition(GameConfig.stageWidth/2,GameConfig.stageHeigth/2+20),this.addChild(this._gameBtn),this._gameBtn.anchorOffsetX=this._gameBtn.width/2,this._gameBtn.anchorOffsetY=this._gameBtn.height/2,this.btnAnim()},e.prototype.subclassInit=function(){},e.prototype.btnAnim=function(){this._gameBtn&&egret.Tween.get(this._gameBtn).to({scaleX:.9,scaleY:.9},600).to({scaleX:1,scaleY:1},600).call(this.btnAnim,this)},e.prototype.clipAnim=function(){this._luanziClip&&egret.Tween.get(this._luanziClip).to({scaleX:2.5,scaleY:2.5},500).to({scaleX:2,scaleY:2},500).call(this.clipAnim,this)},e.prototype.btnClick=function(){},e.prototype.initLeftSoldiers=function(){for(var t=this.getSoldierKinds(),e=Math.floor((this._showCount[0]-1)/this._preLineNum),i=1;i<=this._showCount[0];i++){var a=(i-1)%this._preLineNum+1,n=Math.floor((i-1)/this._preLineNum),o=new Soldier;if(o.init(t[i-1]),this._leftSoldiers.push(o),o.speed=150+App.MathUtil.getRandom(0,50),o.area=SoldierArea.LEFT,o.myIndex=i,n==e){var s=this._preLineNum-(this._showCount[0]-this._preLineNum*n);a=Math.floor(s/2)+a}o.endlong=n+1,o.lineNumber=a,o.x=15-50*n-10*(a-1),o.y=GameConfig.stageHeigth/2-60+45*(a-1),o.standBy()}for(var r=e+1;r>=1;r--)for(var l in this._leftSoldiers){var h=this._leftSoldiers[l];h.endlong==r&&this._battleBg.addChild(h)}},e.prototype.initRightSoldiers=function(){for(var t=Math.floor((this._showCount[1]-1)/this._preLineNum),e=1;e<=this._showCount[1];e++){var i=(e-1)%this._preLineNum+1,a=Math.floor((e-1)/this._preLineNum),n=new Soldier;if(n.init("npc1"),this._rightSoldiers.push(n),n.speed=100+App.MathUtil.getRandom(0,50),n.myIndex=e,a==t){var o=this._preLineNum-(this._showCount[1]-this._preLineNum*a);i=Math.floor(o/2)+i}n.lineNumber=i,n.endlong=a+1,n.area=SoldierArea.RIGHT,n.x=310+50*a+10*(i-1),n.y=GameConfig.stageHeigth/2-60+45*(i-1),n.standBy(),this.addChild(n)}for(var s=t+1;s>=1;s--)for(var r in this._rightSoldiers){var l=this._rightSoldiers[r];l.endlong==s&&this._battleBg.addChild(l)}},e.prototype.calculateMeetPoint=function(){for(var t=0;t<this._preLineNum;t++){var e=this.getSoldierWithLineNumber(t+1,0),i=this.getSoldierWithLineNumber(t+1,1);if(e&&i){var a=App.MathUtil.getDistance(egret.Point.create(e.x,e.y),egret.Point.create(i.x,i.y)),n=a/(e.speed+i.speed)*e.speed,o=n,s=0;this._meetPointTab.push(egret.Point.create(e.x+o,e.y+s))}else this._meetPointTab.push(egret.Point.create(GameConfig.stageWidth/2,GameConfig.stageHeigth/2-60+45*t))}},e.prototype.getSoldierWithLineNumber=function(t,e){for(var i=null,a=0;a<this._preLineNum;a++)if(0==e){if(this._leftSoldiers[a]&&this._leftSoldiers[a].lineNumber==t){i=this._leftSoldiers[a];break}}else if(1==e&&this._rightSoldiers[a]&&this._rightSoldiers[a].lineNumber==t){i=this._rightSoldiers[a];break}return i},e.prototype.gameBegin=function(){for(var t in this._leftSoldiers){var e=this._leftSoldiers[t];this.gotoFight(e)}for(var t in this._rightSoldiers){var e=this._rightSoldiers[t];this.gotoFight(e)}},e.prototype.getBeattacker=function(t,e){return t==SoldierArea.LEFT?this._rightSoldiers[e-1]:this._leftSoldiers[e-1]},e.prototype.gotoFight=function(t){var e=this.getTagetEnemy(t);if(0==e)return void t.standBy();var i=this.getBeattacker(t.area,e);if(t.lineNumber=i.lineNumber,t.targetIndex=e,i.attackerTab.push(t.myIndex),t.lineNumber==t.curMeetIndex)return void t.attack(this.attackCallBack,this);t.curMeetIndex=0;var a=this._meetPointTab[t.lineNumber-1],n=egret.Point.create(a.x,a.y);t.x>n.x?n.x+=App.MathUtil.getRandom(30,45):n.x-=App.MathUtil.getRandom(30,45),n.y+=App.MathUtil.getRandom(0,30)-15,t.run(n,this.attackCallBack,this)},e.prototype.getTagetEnemy=function(t){var e,i=0;if(t.area==SoldierArea.LEFT)for(var a in this._rightSoldiers){var n=this._rightSoldiers[a];if(n.myStatus!=SoldierStatus.GODIE){if(n.lineNumber==t.lineNumber){i=n.myIndex;break}var o=App.MathUtil.getDistance(egret.Point.create(t.x,t.y),egret.Point.create(n.x,n.y));(!e||e>o)&&(e=o,i=n.myIndex)}}else for(var a in this._leftSoldiers){var n=this._leftSoldiers[a];if(n.myStatus!=SoldierStatus.GODIE){if(n.lineNumber==t.lineNumber){i=n.myIndex;break}var o=App.MathUtil.getDistance(egret.Point.create(t.x,t.y),egret.Point.create(n.x,n.y));(!e||e>o)&&(e=o,i=n.myIndex)}}return i},e.prototype.attackCallBack=function(t){if(0==this._isLuanzPlay&&this.showLuanziClip(),this._lastDeathTime>egret.getTimer())t.attack(this.attackCallBack,this),SoundManager.playEffect(SoundConst.EFFECT_BATTLE_ATTACK2);else{var e=this.getBeattacker(t.area,t.targetIndex);0==this._curOrder&&(this._curOrder=this._lostOrder[0],this._lostOrder.splice(0,1)),e.area==SoldierArea.LEFT&&this._curOrder<0?(this._curOrder++,this.killedTarget(t),SoundManager.playEffect(SoundConst.EFFECT_BATTLE_ATTACK1)):e.area==SoldierArea.RIGHT&&this._curOrder>0?(this._curOrder--,this.killedTarget(t),SoundManager.playEffect(SoundConst.EFFECT_BATTLE_ATTACK1)):(t.attack(this.attackCallBack,this),SoundManager.playEffect(SoundConst.EFFECT_BATTLE_ATTACK2),this.checkEnd())}},e.prototype.killedTarget=function(t){var e=this.getBeattacker(t.area,t.targetIndex);this._curLost[e.area]++,e.goDie();for(var i in e.attackerTab){var a=e.attackerTab[i],n=this.getBeattacker(e.area,a);n.myStatus!=SoldierStatus.GODIE&&this.gotoFight(n)}var o=this._totalNum[e.area]-this._curLost[e.area]*this._averageNum[e.area];0>o&&(o=0),this._battleInfoTab[e.area].curNumber=o,this.checkEnd()},e.prototype.checkEnd=function(){return this._curLost[0]==this._lostSoldier[0]&&this._curLost[1]==this._lostSoldier[1]?void TimerManager.doTimer(300,1,this.gameEnd,this):void 0},e.prototype.calculateSoldierNumber=function(){for(var t=this._preLineNum*this._maxLineNum,e=0;1>=e;e++)0==e&&this._totalOldNum[0]<=0?(this._showCount[e]=0,this._averageNum[e]=0):(this._showCount[e]=3+Math.ceil(this._totalNum[e]/this._unitNunberTab[0])-1,this._showCount[e]=this._showCount[e]>t?t:this._showCount[e],this._averageNum[e]=Math.ceil(this._totalNum[e]/this._showCount[e]))},e.prototype.calculateLostSoldierNumber=function(){for(var t=0;1>=t;t++)this._totalNum[t]<=this._lostNum[t]?this._lostSoldier[t]=this._showCount[t]:this._lostSoldier[t]=Math.floor(this._lostNum[t]/this._averageNum[t])},e.prototype.getSoldierKinds=function(){var t=2,e=0,i=this._totalNum[0]+2*this._unitNunberTab[0];i>=this._unitNunberTab[1]*(this._showCount[0]-1)+this._unitNunberTab[2]?(t=3,e=Math.floor((i-this._unitNunberTab[1]*this._showCount[0])/this._unitNunberTab[2])):i>=this._unitNunberTab[0]*(this._showCount[0]-1)+this._unitNunberTab[1]&&(t=2,e=Math.floor((i-this._unitNunberTab[0]*this._showCount[0])/this._unitNunberTab[1]));for(var a=[],n=1;n<=this._showCount[0];n++){var o;o=e>=n?t-1:t,o=1,a.push("hero"+o)}return a},e.prototype.calculateLostTab=function(){for(var t=10,e=[],i=0;1>=i;i++)e[i]=Math.ceil(this._lostSoldier[i]/t);for(var a=[],n=this._lostSoldier[0],o=this._lostSoldier[1];n>0;){var s=n>=e[0]?e[0]:n;s*=-1,a.push(s),n+=s}for(;o>0;){var s=o>=e[1]?e[1]:o;this._lostOrder.push(s),o-=s}var r=a.length-1;if(a.length>0)for(var i=0;i<a.length;i++){var l=a[i];if(this._isAttackWin){var h=App.MathUtil.getRandom(0,this._lostOrder.length-1);this._lostOrder.splice(h,0,l)}else{var h=App.MathUtil.getRandom(0,this._lostOrder.length);r==i?this._lostOrder.push(l):this._lostOrder.splice(h,0,l)}}},e.prototype.skipBattle=function(){},e.prototype.gameEnd=function(t){void 0===t&&(t=!1),this._skipBtn&&(this._skipBtn.visible=!1);for(var e in this._leftSoldiers){var i=this._leftSoldiers[e];i.myStatus!=SoldierStatus.GODIE&&i.standBy()}for(var e in this._rightSoldiers){var i=this._rightSoldiers[e];i.myStatus!=SoldierStatus.GODIE&&i.standBy()}this._battleInfoTab[0].curNumber=Api.playerVoApi.getSoldier(),this._battleInfoTab[1].curNumber=this._totalNum[1]-this._lostNum[1],this.closeBtn&&this.closeBtn.setEnable(!0),this.hiddenLuanziClip(),SoundManager.stopEffect(SoundConst.EFFECT_BATTLE),1==t?this.showResultView():TimerManager.doTimer(500,1,this.showResultView,this)},e.prototype.showResultView=function(){},e.prototype.endCallBack=function(){},e.prototype.showLuanziClip=function(){if(!this._luanziClip){var t=BaseBitmap.create("luanz_1");this._luanziClip=ComponentManager.getCustomMovieClip("luanz_",14,100),this._luanziClip.setPosition(GameConfig.stageWidth/2,GameConfig.stageHeigth/2+t.height/2+50),this._luanziClip.anchorOffsetX=t.width/2,this._luanziClip.anchorOffsetY=t.height/2,BaseBitmap.release(t),this._luanziClip.setScale(2)}this.addChild(this._luanziClip),this._luanziClip.playWithTime(0),this._isLuanzPlay=!0,this._luanziClip.alpha=.9,this.clipAnim(),egret.startTick(this.shakeScreen,this)},e.prototype.disappear=function(){this._luanziClip&&(this._luanziClip.stop(),egret.Tween.removeTweens(this._luanziClip),this.removeChild(this._luanziClip),this._luanziClip=null),this._isLuanzPlay=!1},e.prototype.hiddenLuanziClip=function(){if(this._luanziClip){egret.stopTick(this.shakeScreen,this),egret.Tween.removeTweens(this._luanziClip);for(var t=[],e=13;16>=e;e++)t.push("luanz_"+e);this._luanziClip.stop(),this._luanziClip.goToAndPlay(0),this._luanziClip.frameImages=t,this._luanziClip.playFrameRate=150,this._luanziClip.playWithTime(1),egret.Tween.get(this._luanziClip).to({alpha:0,scale:4},800).call(this.disappear,this)}},e.prototype.shakeScreen=function(t){var e=100;return t<this._shakeStTime?1==this._isShakeing&&t-this._shakeStTime>e/5&&(this._battleBg.x=-10,this._battleBg.y=-10,this._isShakeing=!1):(this._shakeStTime=t+100,this._isShakeing=!0,this._battleBg.x=-5-App.MathUtil.getRandom(0,10),this._battleBg.y=-5-App.MathUtil.getRandom(0,10)),!1},e.prototype.initView=function(){},e.prototype.resetGameAfterWin=function(){},e.prototype.hide=function(e){(1!=Api.rookieVoApi.isInGuiding||null!=e)&&(this._obj&&this._callbackF&&this._callbackF.apply(this._obj),t.prototype.hide.call(this),Api.rookieVoApi.checkNextStep())},e.prototype.dispose=function(){egret.stopTick(this.shakeScreen,this),TimerManager.remove(this.gameEnd,this),TimerManager.remove(this.showResultView,this);for(var e in this._leftSoldiers){var i=this._leftSoldiers[e];egret.Tween.removeTweens(i),i.dispose()}for(var a in this._rightSoldiers){var n=this._rightSoldiers[a];egret.Tween.removeTweens(n),n.dispose()}this._leftSoldiers.length=0,this._rightSoldiers.length=0,this._curLost.length=0,this._curLost=[0,0],this._meetPointTab.length=0,this._showCount.length=0,egret.Tween.removeTweens(this._gameBtn),this._gameBtn.dispose(),this._gameBtn=null,this._averageNum.length=0,this._lostOrder.length=0,this._totalOldNum.length=0,this._totalNum.length=0,this._luanziClip&&(this._luanziClip.stop(),egret.Tween.removeTweens(this._luanziClip),this._luanziClip.dispose()),this._luanziClip=null,this._isLuanzPlay=!1,this._shakeStTime=0,this._isShakeing=!1,this._battleBg=null,this._curOrder=0;for(var o in this._battleInfoTab){var s=this._battleInfoTab[o];s.dispose()}this._battleInfoTab.length=0,this._callbackF=null,this._obj=null,this._isAttackWin=null,this._lastDeathTime=0,this._deathRate=0,this._rewards=null,this._skipBtn&&this._skipBtn.dispose(),this._skipBtn=void 0,t.prototype.dispose.call(this)},e}(CommonView);__reflect(BattleView.prototype,"BattleView");var BattleWin=function(t){function e(){var e=t.call(this)||this;return e._awardArray=[],e._callbackF=null,e._obj=null,e._type=1,e._winBg=null,e}return __extends(e,t),e.prototype.getResourceList=function(){var e=t.prototype.getResourceList.call(this);return 2==this.param.data.type&&(e=["atkrace_win1","atkrace_win2","atkrace_win3","atkrace_win4","recharge_fnt"]),e.concat(["battle_win_word","battle_win_light","fire_flake_json","fire_flake"])},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getBgName=function(){return"public_9_bg8"},e.prototype.initView=function(){this.addTouchTap(this.touchTap,this,null),this.param.data&&(this.param.data.award?this._awardArray=GameData.formatRewardItem(this.param.data.award):this.param.data.rewards&&(this._awardArray=GameData.formatRewardItem(this.param.data.rewards))),this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f),this.param.data&&this.param.data.type&&(this._type=this.param.data.type),this._winBg=BaseBitmap.create("public_rule_bg"),this._winBg.setPosition(GameConfig.stageWidth/2-this._winBg.width,GameConfig.stageHeigth/2-this._winBg.height/2),this.addChildToContainer(this._winBg);var t=BaseBitmap.create("public_rule_bg");t.scaleX=-1,t.setPosition(GameConfig.stageWidth/2+t.width-1,GameConfig.stageHeigth/2-t.height/2),this.addChildToContainer(t);var e=BaseBitmap.create("public_9_bg1");e.width=500,e.height=122,e.setPosition(GameConfig.stageWidth/2-e.width/2,GameConfig.stageHeigth/2-e.height/2+2-20),this.addChildToContainer(e);for(var i=0;i<this._awardArray.length;i++){var a=this._awardArray[i],n=GameData.getItemIcon(a);n.setPosition(GameConfig.stageWidth/2+19+138*(this._awardArray.length/2-i-1),e.y+e.height/2-n.height/2),this.addChildToContainer(n)}if(this.getIsCountDown()){var o=BaseBitmap.create("promotion_officerbg1");o.setPosition(GameConfig.stageWidth/2-o.width/2+20,e.y+e.height+5+10),this.addChildToContainer(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("countDownNext"),TextFieldConst.FONTSIZE_CONTENT_SMALL);s.setPosition(o.x+o.width/2-s.width/2+10,o.y+o.height/2-s.height/2),this.addChildToContainer(s),this._countDownLb=ComponentManager.getTextField("0",TextFieldConst.FONTSIZE_TITLE_BIG),this._countDownLb.setPosition(o.x+o.width/2-s.width/2-20,o.y+o.height/2-this._countDownLb.height/2),this._countDownLb.setColor(TextFieldConst.COLOR_LIGHT_RED),this.addChildToContainer(this._countDownLb),this._countDownLb.text="1",this._countDownTime=1}if(2==this._type){var r=ComponentManager.getTextField(LanguageManager.getlocal("atkraceScore"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);r.setPosition(GameConfig.stageWidth/2+30-r.width,e.y+20),this.addChildToContainer(r);var l=ComponentManager.getTextField("+2",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN);l.setPosition(GameConfig.stageWidth/2+30+10,r.y),this.addChildToContainer(l);var h=ComponentManager.getTextField(LanguageManager.getlocal("atkRace_bookExp"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);h.setPosition(GameConfig.stageWidth/2+30-h.width,r.y+36),this.addChildToContainer(h);var d=ComponentManager.getTextField("+2",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN);d.setPosition(GameConfig.stageWidth/2+30+10,h.y),this.addChildToContainer(d);var g=ComponentManager.getTextField("+1",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN);g.setPosition(GameConfig.stageWidth/2+30,d.y+36),this.addChildToContainer(g);var c=BaseBitmap.create("atkrace_morale");c.setPosition(GameConfig.stageWidth/2+30-c.width,g.y+g.height/2-c.height/2),this.addChildToContainer(c);var p=BaseBitmap.create("atkrace_win1");p.setPosition(158,this._winBg.y+this._winBg.height-10),this.addChild(p);var _=this.param.data.num+1,u=ComponentManager.getBitmapText(_.toString(),"recharge_fnt");u.setPosition(p.x+p.width+7,p.y+p.height/2-u.height/2),this.addChild(u);var C=BaseBitmap.create("atkrace_win2");if(C.setPosition(u.x+u.width+7,p.y),this.addChild(C),_%3!=0){var f=BaseBitmap.create("atkrace_win3");f.setPosition(130,p.y+p.height+20),this.addChild(f);var m=3-_%3,T=ComponentManager.getBitmapText(m.toString(),"recharge_fnt");T.setPosition(f.x+f.width+7,f.y+f.height/2-T.height/2),this.addChild(T);var y=BaseBitmap.create("atkrace_win4");y.setPosition(T.x+T.width+7,f.y),this.addChild(y)}}if(3==this._type){var v=GameConfig.config.prisonbaseCfg.getPrestige,A=ComponentManager.getTextField(LanguageManager.getlocal("renown"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_YELLOW);A.setPosition(200,e.y+e.height+10),this.addChildToContainer(A);var w=ComponentManager.getTextField("+"+v,TextFieldConst.FONTSIZE_CONTENT_COMMON);w.setPosition(A.x+A.width,A.y),this.addChildToContainer(w);var x=ComponentManager.getTextField(LanguageManager.getlocal("renown_limited"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_YELLOW);x.setPosition(330,A.y),this.addChildToContainer(x);var I=ComponentManager.getTextField("+"+v,TextFieldConst.FONTSIZE_CONTENT_COMMON);I.setPosition(x.x+x.width,A.y),this.addChildToContainer(I);var o=BaseBitmap.create("promotion_officerbg1");o.setPosition(GameConfig.stageWidth/2-o.width/2+20,e.y+e.height+35),this.addChildToContainer(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("countDownNext"),TextFieldConst.FONTSIZE_CONTENT_SMALL);s.setPosition(o.x+o.width/2-s.width/2+10,o.y+o.height/2-s.height/2),this.addChildToContainer(s),this._countDownLb=ComponentManager.getTextField("0",TextFieldConst.FONTSIZE_TITLE_BIG),this._countDownLb.setPosition(o.x+o.width/2-s.width/2-20,o.y+o.height/2-this._countDownLb.height/2),this._countDownLb.setColor(TextFieldConst.COLOR_LIGHT_RED),this.addChildToContainer(this._countDownLb),this._countDownLb.text="1",this._countDownTime=1}if(1==this._type){var L=ComponentManager.getTextField(LanguageManager.getlocal("clickToClose"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);L.textAlign=egret.HorizontalAlign.CENTER,L.setPosition((GameConfig.stageWidth-L.width)/2,this._winBg.y+this._winBg.height),this.addChildToContainer(L)}this.container.anchorOffsetX=GameConfig.stageWidth/2,this.container.anchorOffsetY=GameConfig.stageHeigth/2,this.container.setPosition(GameConfig.stageWidth/2,GameConfig.stageHeigth/2),this.container.scaleX=.1,this.container.scaleY=1,egret.Tween.get(this.container).to({scaleX:1,scaleY:1},120).call(this.showWordAnim,this).wait(80).call(this.showAnim,this),SoundManager.playEffect(SoundConst.EFFECT_BATTLE_WIN)},e.prototype.getIsCountDown=function(){return 1!=Api.rookieVoApi.isInGuiding&&1==this._type},e.prototype.showWordAnim=function(){var t=BaseBitmap.create("public_rule_bg"),e=BaseBitmap.create("battle_win_light");e.scaleY=.5,e.setPosition(GameConfig.stageWidth/2-e.width/2*e.scaleX,GameConfig.stageHeigth/2-t.height/2-5),this.addChildToContainer(e),this._fire_lizi=App.ParticleUtil.getParticle("fire_flake"),this._fire_lizi.y=GameConfig.stageHeigth/2-365,this.addChildToContainer(this._fire_lizi);var i=BaseBitmap.create("battle_win_word"),a=2.5,n=.9,o=egret.Point.create(GameConfig.stageWidth/2-i.width/2*a,GameConfig.stageHeigth/2-t.height/2*a-35+30),s=egret.Point.create(GameConfig.stageWidth/2-i.width/2*n,GameConfig.stageHeigth/2-t.height/2*n-35),r=egret.Point.create(GameConfig.stageWidth/2-i.width/2,GameConfig.stageHeigth/2-t.height/2-35);i.setScale(a),i.setPosition(o.x,o.y),this.addChildToContainer(i),egret.Tween.get(i).to({x:s.x,y:s.y,scaleX:n,scaleY:n},120).to({x:r.x,y:r.y,scaleX:1,scaleY:1},50),e.alpha=0,egret.Tween.get(e).wait(100).to({alpha:1},100).wait(90).to({alpha:0},10)},e.prototype.showAnim=function(){this._fire_lizi.start();var t=this;egret.Tween.get(this._fire_lizi,{loop:!1}).wait(500).to({alpha:0},200).call(function(){this._fire_lizi&&(t.removeChildFromContainer(this._fire_lizi),this._fire_lizi.dispose(),this._fire_lizi=null)})},e.prototype.tick=function(){this._countDownTime>0?(this._countDownTime--,this._countDownLb.text=this._countDownTime.toPrecision()):0==this._countDownTime&&this.touchTap()},e.prototype.touchTap=function(){if(this._countDownTime=-1,this._obj&&this._callbackF&&this._callbackF.apply(this._obj),Api.rookieVoApi.isInGuiding&&Api.rookieVoApi.checkWaitingGuide(),3==this._type){var t=this.param.data.cid,e=ChallengeCfg.getChallengeCfgById(t);e.unlockPrison&&(App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_FUNCTION_TXT),ViewController.getInstance().openView(ViewConst.POPUP.CATCHPRISONPUPUPVIEW,{unlockPrison:e.unlockPrison,showBoss:e.showBoss})),3280==t&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_FUNCTION_TXT)}this.hide()},e.prototype.dispose=function(){this._awardArray.length=0,this._callbackF=null,this._obj=null,this._countDownLb=null,this._countDownTime=-1,this._fire_lizi=null,this._type=1,this._winBg=null,t.prototype.dispose.call(this)},e}(BaseView);__reflect(BattleWin.prototype,"BattleWin");var BossSelectedScrollItem=function(t){function e(){var e=t.call(this)||this;return e._selectedIndex2=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){this._selectedIndex2=t,this._servantInfo=e;var i=BaseBitmap.create("public_9_bg1");i.width=500,i.height=120,this.addChild(i);var a=Api.servantVoApi.getServantObj(this._servantInfo[0]);this.initServantIcon(a),this.initServantInfo(),this.checkUseBtn(i)},e.prototype.checkUseBtn=function(t){if(1==this._servantInfo[1]){var e=ComponentManager.getButton(this.getBtnResName(),this.getBtnLocalName(),this.confirmRecoveryHandler,this);e.setColor(TextFieldConst.COLOR_BLACK),e.x=t.width-e.width-10,e.y=t.height/2-e.height/2,this.addChild(e),this._useBtn=e}else if(2==this._servantInfo[1]){var i=BaseBitmap.create("boss_gotowar");i.setPosition(375,23),this.addChild(i)}else{var e=ComponentManager.getButton(this.getBtnResName(),this.getBtnLocalName(),this.clickBtnHandler,this);
e.setColor(TextFieldConst.COLOR_BLACK),e.x=t.width-e.width-10,e.y=t.height/2-e.height/2,this.addChild(e),this._useBtn=e}},e.prototype.confirmRecoveryHandler=function(){var t=Config.DailybossCfg.needItem,e=Api.itemVoApi.getItemNumInfoVoById(Number(t)),i=1,a=e,n=Config.ItemCfg.getItemCfgById(Number(t)),o=LanguageManager.getlocal("useItemMsg",[n.name+"x"+i,LanguageManager.getlocal("dailybossRecoveryBattleNumDesc")]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{confirmCallback:this.recoveryHandler,handler:this,icon:n.icon,iconBg:n.iconBg,num:a,useNum:i,msg:o,id:t})},e.prototype.receiveData=function(t){var e=t.data;if(e.ret){if(this._useBtn){var i=this._useBtn,a=i.x,n=i.y;this._useBtn.dispose();var o=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"gotowar",this.clickBtnHandler,this);o.setPosition(a,n),this.addChild(o),this._useBtn=o}App.CommonUtil.showTip(LanguageManager.getlocal("dailybossRecoveryBattleSuccessDesc"))}},e.prototype.recoveryHandler=function(){App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_CHALLENGE_RECOVER,this.receiveData,this),NetManager.request(NetRequestConst.REQUEST_CHALLENGE_RECOVER,{servantId:this._servantInfo[0]})},e.prototype.getBtnResName=function(){return 1==this._servantInfo[1]?ButtonConst.BTN_NORMAL_RED:ButtonConst.BTN_NORMAL_YELLOW},e.prototype.getBtnLocalName=function(){return 1==this._servantInfo[1]?"manageRecoveryBtn":"gotowar"},e.prototype.clickBtnHandler=function(t){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_SELECTED_SERVANT,{key:this._servantInfo[0]})},e.prototype.initServantInfo=function(){var t=Api.servantVoApi.getServantObj(this._servantInfo[0]),e=ComponentManager.getTextField(t.servantName,TextFieldConst.FONTSIZE_CONTENT_SMALL);e.setColor(TextFieldConst.COLOR_WHITE),e.x=120,e.y=15,this.addChild(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("servant_infoLv")+t.level,TextFieldConst.FONTSIZE_CONTENT_SMALL);i.setColor(TextFieldConst.COLOR_WHITE),i.x=120,i.y=45,this.addChild(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("fightForce")+":"+this._servantInfo[2],TextFieldConst.FONTSIZE_CONTENT_SMALL);a.setColor(TextFieldConst.COLOR_WHITE),a.x=120,a.y=75,this.addChild(a)},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_CHALLENGE_RECOVER,this.receiveData,this),this._selectedIndex2=null,this._servantInfo=null,this._useBtn=null,t.prototype.dispose.call(this)},e}(ServantSelectedScrollItem);__reflect(BossSelectedScrollItem.prototype,"BossSelectedScrollItem");var PalaceView=function(t){function e(){var e=t.call(this)||this;return e._posList=[],e._touchCancel=!1,e._hitKey="",e._shadowList=[],e}return __extends(e,t),e.prototype.initView=function(){this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer),this.initPosCfg();var t=BaseBitmap.create(this.getBgRes());this._nodeContainer.addChild(t),this._bg=t,this._bg.y=GameConfig.stageHeigth-this._bg.height-this.container.y+20,this._bg.addTouch(this.onBgTouchHandler,this,null,!0);var e=GameConfig.config.buildingCfg,i=Object.keys(e);i.sort(function(t,e){return Number(t)-Number(e)});for(var a=this.getStartIdx(),n=0;n<this._posList.length;n++){var o=this._posList[n],s=i[n+a],r=e[s];if(Api.palaceVoApi.isShowBuildingFlag(s)){var l=BaseBitmap.create("palace_building_flag"+o.flagId);l.x=this._bg.x+o.x,l.y=this._bg.y+o.y,this._nodeContainer.addChild(l)}var h=BaseBitmap.create("palace_shadow"+o.shadowId);h.x=this._bg.x+o.x,h.y=this._bg.y+o.y,h.setScale(4),h.alpha=.5,h.visible=!1,this._nodeContainer.addChild(h),h.name=s,this._shadowList.push(h);var d=BaseLoadBitmap.create("palace_build_"+s);0==r.unlock&&App.DisplayUtil.changeToGray(d),d.width=35,d.height=96,d.setScale(1.2),d.x=this._bg.x+o.x+o.width,d.y=this._bg.y+o.y-20,this._nodeContainer.addChild(d)}this.initBottomView()},e.prototype.initBottomView=function(){var t=ComponentManager.getButton(this.getCorssBtnPath(),"",this.crossBtnHandler,this);t.x=10,t.y=10,this._nodeContainer.addChild(t)},e.prototype.getStartIdx=function(){return 7},e.prototype.getCorssBtnPath=function(){return"palacve_goBtn"},e.prototype.initPosCfg=function(){this._posList=[{x:208,y:297,width:237,heigh:127,shadowId:1,flagId:1},{x:46,y:529,width:128,heigh:77,shadowId:2,flagId:1},{x:256,y:543,width:128,heigh:77,shadowId:2,flagId:1},{x:459,y:532,width:128,heigh:77,shadowId:2,flagId:1},{x:46,y:690,width:128,heigh:77,shadowId:2,flagId:1},{x:256,y:667,width:128,heigh:77,shadowId:2,flagId:1},{x:470,y:690,width:128,heigh:77,shadowId:2,flagId:1},{x:43,y:821,width:128,heigh:77,shadowId:2,flagId:1},{x:256,y:787,width:128,heigh:77,shadowId:2,flagId:1},{x:475,y:821,width:128,heigh:77,shadowId:2,flagId:1},{x:19,y:955,width:128,heigh:77,shadowId:4,flagId:3},{x:233,y:975,width:193,heigh:145,shadowId:3,flagId:2},{x:469,y:960,width:128,heigh:77,shadowId:5,flagId:4}]},e.prototype.getBgRes=function(){return"palace_bg2"},e.prototype.crossBtnHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.PALACECROSSVIEW),this.hide()},e.prototype.onBgTouchHandler=function(t){if(t.type==egret.TouchEvent.TOUCH_BEGIN){var e=new egret.Point(Math.floor(t.localX),Math.floor(t.localY));this._hitKey="";for(var i=0;i<this._posList.length;i++){var a=this._posList[i];if(a.x<=e.x&&e.x<=a.x+a.width&&a.y<=e.y&&e.y<=a.y+a.heigh){this._curTouchShadow=this._shadowList[i];var n=this._curTouchShadow.name;this._curTouchShadow.visible=!0;var o=GameConfig.config.buildingCfg[n];o&&0==o.unlock?App.CommonUtil.showTip(LanguageManager.getlocal("palace_buildingNotOpen")):this._hitKey=this._curTouchShadow.name;break}}}t.type==egret.TouchEvent.TOUCH_CANCEL&&(this._touchCancel=!0,this._hitKey="",this._curTouchShadow&&(this._curTouchShadow.visible=!1),this._curTouchShadow=null),t.type==egret.TouchEvent.TOUCH_END&&(this._touchCancel||""==this._hitKey||this.doHitProcess(this._hitKey),this._touchCancel=!1,this._hitKey="",this._curTouchShadow&&(this._curTouchShadow.visible=!1),this._curTouchShadow=null)},e.prototype.doHitProcess=function(t){var e=GameConfig.config.buildingCfg[t],i=e.title,a=t;if(1==Object.keys(i).length){var n=i[0],o=Config.TitleCfg.getTitleCfgById(n);if(0==o.unlock)return void App.CommonUtil.showTip(LanguageManager.getlocal("palace_titleNotOpen"));ViewController.getInstance().openView(ViewConst.COMMON.PALACEHOUSEVIEW,{titleId:n,buildingId:a})}else ViewController.getInstance().openView(ViewConst.COMMON.PALACEHOUSEGROUPVIEW,{buildingId:a})},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["palace_bg2","palace_bg3","palace_hisBtn1","palace_hisBtn1_down","palace_hisBtn2","palace_hisBtn2_down","palace_hisBtn3","palace_hisBtn3_down","palacve_goBtn","palacve_goBtn_down","palacve_backBtn","palacve_backBtn_down","palace_shadow1","palace_shadow2","palace_shadow3","palace_shadow4","palace_shadow5","palace_building_flag1","palace_building_flag2","palace_building_flag3","palace_building_flag4"])},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_PALACE_GETPALACEINFO,requestData:{}}},e.prototype.dispose=function(){this._bg.removeTouch(),this._posList=[],this._bg=null,this._touchCancel=null,this._hitKey="",this._shadowList=[],this._curTouchShadow=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(PalaceView.prototype,"PalaceView");var ConfirmPopupView=function(t){function e(){var e=t.call(this)||this;return e._bgHeight=0,e._callback=null,e}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=520,t.height=150,t.x=this.viewBg.x+this.viewBg.width/2-t.width/2,t.y=9,this.addChildToContainer(t),this._bgHeight=t.height;var e=this.param.data.msg,i=ComponentManager.getTextField(e,TextFieldConst.FONTSIZE_CONTENT_COMMON);i.width=480,i.setColor(TextFieldConst.COLOR_BLACK),i.textAlign=TextFieldConst.ALIGH_CENTER,i.x=this.viewBg.x+this.viewBg.width/2-i.width/2,i.y=t.y+t.height/2-i.height/2,i.lineSpacing=10,this.addChildToContainer(i);var a=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"confirmBtn",this.clickConHandler,this);if(a.setColor(TextFieldConst.COLOR_BLACK),a.x=this.getShowWidth()/2-a.width/2,a.y=t.y+t.height+20,this.addChildToContainer(a),this.param.data.needCancel){var n=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"cancelBtn",this.clickCancelHandler,this);n.setColor(TextFieldConst.COLOR_BLACK),n.x=80,n.y=t.y+t.height+20,this.addChildToContainer(n),a.x=330}},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this)},e.prototype.isTouchMaskClose=function(){return this.param&&this.param.data&&this.param.data.touchMaskClose?!0:!1},e.prototype.clickConHandler=function(t){var e=this.param;this.hide(),e.data.callback&&e.data.callback.apply(e.data.handler,null)},e.prototype.clickCancelHandler=function(t){this.hide()},e.prototype.getTitleStr=function(){return this.param.data.title},e.prototype.getCloseBtnName=function(){return null},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.dispose=function(){this._callback=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(ConfirmPopupView.prototype,"ConfirmPopupView");var ScrollView=function(t){function e(e){var i=t.call(this,e)||this;return i.content=void 0,i._touchTapHelper=null,i._touchHelper=null,i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.removeFromStageHandler,i),i}return __extends(e,t),e.prototype.removeFromStageHandler=function(t){egret.ScrollTween.removeTweens(this)},e.prototype.setContent=function(e){t.prototype.setContent.call(this,e),this.content=e},e.prototype.removeContent=function(){egret.ScrollTween.removeTweens(this),t.prototype.removeContent.call(this);var e=this.content;return this.content=null,e},e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.addTouchTap=function(t,e,i){if(null==this._touchTapHelper){var a=function(i){for(var a=[],n=1;n<arguments.length;n++)a[n-1]=arguments[n];if(i.type==egret.TouchEvent.TOUCH_END&&t){var o=[i];a&&a.length>0&&o.concat(a),t.apply(e,o)}};this._touchTapHelper=TouchHelper.addTouch(this.content,a,this,i)}},e.prototype.removeTouchTap=function(){this._touchTapHelper&&(this._touchTapHelper.removeTouch(),this._touchTapHelper=null)},e.prototype.addTouch=function(t,e,i){this._touchHelper||(this._touchHelper=TouchHelper.addTouch(this.content,t,e,i))},e.prototype.removeTouch=function(){this._touchHelper&&(this._touchHelper.removeTouch(),this._touchHelper=null)},e.prototype.dispose=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStageHandler,this);try{this._removeEvents(),this._onTouchEnd(null)}catch(t){}if(egret.ScrollTween.removeTweens(this),this.numChildren>0){var e=this.removeContent();e instanceof egret.DisplayObjectContainer&&App.DisplayUtil.destory(e)}this._content=null},e}(egret.ScrollView);__reflect(ScrollView.prototype,"ScrollView",["base.Ibase"]);var PopupViewTab=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(ViewTab);__reflect(PopupViewTab.prototype,"PopupViewTab");var RankPopupListItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getValueStr=function(){var t="";return this._data&&(null!=this._data.value&&(t=this._data.value),null!=this._data.time&&(t=App.DateUtil.getFormatBySecond(this._data.time,6))),t},e.prototype.initItem=function(t,e){this._data=e,this.height=52,this._nodeContainer=new BaseDisplayObjectContainer,this.addChild(this._nodeContainer);var i,a=16;if(t>2)i=ComponentManager.getTextField("",20,TextFieldConst.COLOR_BROWN),i.text=String(t+1),i.x=60-i.width/2,i.y=a,this._nodeContainer.addChild(i);else{var n=BaseLoadBitmap.create("rank_"+String(t+1));n.width=51,n.height=47,n.x=60-n.width/2,n.y=3,this.addChild(n)}var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);o.text=e?e.name:"",o.x=220-o.width/2,o.y=a,this._nodeContainer.addChild(o);var s=ComponentManager.getTextField(this.getValueStr(),o.size,TextFieldConst.COLOR_BROWN);s.textAlign=egret.HorizontalAlign.CENTER,s.width=200,s.x=510-s.width,s.y=a,this._nodeContainer.addChild(s),e.uid==Api.playerVoApi.getPlayerID()&&(i&&(i.textColor=TextFieldConst.COLOR_WARN_YELLOW),o.textColor=TextFieldConst.COLOR_WARN_YELLOW,s.textColor=TextFieldConst.COLOR_WARN_YELLOW);var r=BaseLoadBitmap.create("rank_line");r.width=500,r.height=2,r.x=5,r.y=50,this._nodeContainer.addChild(r)},e}(ScrollListItem);__reflect(RankPopupListItem.prototype,"RankPopupListItem");var RankPopupView=function(t){function e(){var e=t.call(this)||this;return e.tabList={},e._scrollListBgRect=egret.Rectangle.create(),e._scrollListBgRect.setTo(0,0,520,600),e}return __extends(e,t),e.prototype.initView=function(){this.initListBg()},e.prototype.changeTab=function(){if(this.tabList[this._selectedTabIndex]){var t=this.tabList[this._selectedTabIndex];t&&this.addChildToContainer(t)}else{var e=egret.Rectangle.create();e.setTo(0,0,this._scrollListBgRect.width-10,this._scrollListBgRect.height-70);var t=ComponentManager.getScrollList(this.getListItemClass(),this.getScrollDataList(),e);this.addChildToContainer(t),t.setPosition(this._scrollListBgRect.x+5,this._scrollListBgRect.y+50),t.setEmptyTip(LanguageManager.getlocal("acPunishNoData")),this.tabList[this._selectedTabIndex]=t}this._curShowTab&&(this._curShowTab.parent&&this._curShowTab.parent.removeChild(this._curShowTab),this._curShowTab=null),this._curShowTab=this.tabList[this._selectedTabIndex],this._title3Txt&&(this._title3Txt.text=this.getTitleValueStr()),this.buttomContainer&&(App.DisplayUtil.destory(this.buttomContainer),this.initButtomInfo())},e.prototype.initListBg=function(){var t=BaseBitmap.create("public_9_bg32");t.width=this._scrollListBgRect.width,t.height=this._scrollListBgRect.height,t.x=this.viewBg.width/2-t.width/2,t.y=58,this._scrollListBgRect.x=t.x,this._scrollListBgRect.y=t.y,this.addChildToContainer(t);var e=BaseBitmap.create("public_9_bg33");e.width=t.width,e.height=40,e.x=t.x,e.y=t.y,this.addChildToContainer(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("acRankPop_title1"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);i.x=e.x+40,i.y=e.y+8,this.addChildToContainer(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("acRankPop_title2"),i.size,TextFieldConst.COLOR_LIGHT_YELLOW);a.x=e.x+175,a.y=i.y,this.addChildToContainer(a);var n=ComponentManager.getTextField(this.getTitleValueStr(),i.size,TextFieldConst.COLOR_LIGHT_YELLOW);n.textAlign=egret.HorizontalAlign.CENTER,n.width=200,n.x=e.x+e.width-n.width,n.y=i.y,this.addChildToContainer(n),this._title3Txt=n;var o=BaseBitmap.create("public_9_bg1");o.name="buttomBg",o.width=t.width,o.height=100,o.setPosition(t.x,t.y+t.height+9),this.addChildToContainer(o),this.buttomContainer||(this.buttomContainer=new BaseDisplayObjectContainer,this.buttomContainer.width=o.width,this.buttomContainer.height=o.height,this.buttomContainer.setPosition(o.x,o.y),this.addChildToContainer(this.buttomContainer))},e.prototype.getTitleValueStr=function(){return LanguageManager.getlocal("pointNumber")},e.prototype.getScrollDataList=function(){return[]},e.prototype.getListItemClass=function(){return RankPopupListItem},e.prototype.initButtomInfo=function(){},e.prototype.getTitleStr=function(){return"dinnerRankPopupViewTitle"},e.prototype.dispose=function(){this._title3Txt=null,this.buttomContainer=null,this._curShowTab=null,this.tabList={},t.prototype.dispose.call(this)},e}(PopupView);__reflect(RankPopupView.prototype,"RankPopupView");var ScorePopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this.initMessage(),this._leftScoreTxt=ComponentManager.getTextField(LanguageManager.getlocal("dailybossCanUseScoreNumDesc",[this.getOwnScoreNum().toString()]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK),this._leftScoreTxt.setPosition(this.viewBg.x+(this.viewBg.width-this._leftScoreTxt.width)/2,10),this.addChildToContainer(this._leftScoreTxt);var t=BaseBitmap.create("public_9_bg4");t.width=540,t.height=637,t.setPosition(15,this._leftScoreTxt.y+this._leftScoreTxt.height+10),this.addChildToContainer(t);var e=egret.Rectangle.create();e.setTo(0,0,530,625),this._scrollList=ComponentManager.getScrollList(this.getListItemClass(),this.getScoreDataList(),e),this._scrollList.setPosition(t.x+5,t.y+5+3),this._scrollList.setEmptyTip(LanguageManager.getlocal("acPunishNoData")),this.addChildToContainer(this._scrollList)},e.prototype.initMessage=function(){},e.prototype.refresh=function(t){var e=t?t.data:null;e.data.data&&e.data.data.rewards&&App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(e.data.data.rewards)),this._leftScoreTxt&&(this._leftScoreTxt.text=LanguageManager.getlocal("dailybossCanUseScoreNumDesc",[this.getOwnScoreNum().toString()]))},e.prototype.getListItemClass=function(){return ScorePopupListItem},e.prototype.getScoreDataList=function(){return[]},e.prototype.getTitleStr=function(){return"dinnerExchangePopupViewTitle"},e.prototype.getOwnScoreNum=function(){return 0},e.prototype.getBgExtraHeight=function(){return 30},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(PopupView);__reflect(ScorePopupView.prototype,"ScorePopupView");var ScorePopupListItem=function(t){function e(){var e=t.call(this)||this;return e._needTxt=null,e._canNumTxt=null,e._idx=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addNetMessage(this.getRequestType(),this.refresh,this),this._data=e,this._idx=t;var i=BaseBitmap.create("public_9_probiginnerbg");i.width=530,i.height=120,this.addChild(i);var a=e.iconContainer;a.setPosition(10,i.y+(i.height-a.height)/2),this.addChild(a);var n=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_YELLOW);n.setPosition(a.x+a.width+10,a.y+10),this.addChild(n);var o=this.needScore();o||(o=0),this._needTxt=ComponentManager.getTextField(LanguageManager.getlocal("dailybossScoreShopNeedDesc",[o.toString()]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW),this._needTxt.setPosition(n.x,n.y+n.height+10),this.addChild(this._needTxt),this._canNumTxt=ComponentManager.getTextField(LanguageManager.getlocal("dailybossScoreShopExchangeNumDesc",[this.canExchangeNum().toString()]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW),this._canNumTxt.setPosition(this._needTxt.x,this._needTxt.y+this._needTxt.height+10),this.addChild(this._canNumTxt);var s=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"exchange",this.exchangeHandler,this);s.setPosition(i.x+i.width-s.width-20,i.y+(i.height-s.height)/2),this.addChild(s)},e.prototype.needScore=function(){return 0},e.prototype.canExchangeNum=function(){return this._data.limit?this._data.limit:1},e.prototype.getOwnScoreNum=function(){return Api.dailybossVoApi.getScore()},e.prototype.exchangeHandler=function(){return this.getOwnScoreNum()<this.needScore()?void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishShopTip2")):this.canExchangeNum()<=0?void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishShopTip1")):void NetManager.request(this.getRequestType(),{itemKey:this._data.id})},e.prototype.refresh=function(){var t=this.needScore();t||(t=0),this._needTxt.text=LanguageManager.getlocal("dailybossScoreShopNeedDesc",[t.toString()]),this._canNumTxt.text=LanguageManager.getlocal("dailybossScoreShopExchangeNumDesc",[this.canExchangeNum().toString()])},e.prototype.getRequestType=function(){return"重写getRequestType方法，返回cmd"},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(this.getRequestType(),this.refresh,this),this._needTxt=null,this._canNumTxt=null,this._idx=0,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ScorePopupListItem.prototype,"ScorePopupListItem");var DialogueGetBaseView=function(t){function e(){var e=t.call(this)||this;return e._curDescLength=0,e._isDescOver=!1,e}return __extends(e,t),e.prototype.initTitle=function(){},e.prototype.initView=function(){},Object.defineProperty(e.prototype,"targetType",{get:function(){return this._targetType},set:function(t){this._targetType=t},enumerable:!0,configurable:!0}),e.prototype.startView=function(){var t=Api.switchVoApi.checkOpenTalkDialog();t?this.checkHasDialogue():this.doNextStep()},e.prototype.initCallbackFunc=function(t){this._nextFunc=t},e.prototype.checkHasDialogue=function(){"1"==this._targetType?this._personCfg=Config.ServantCfg.getServantItemById(this._personId):"2"==this._targetType&&(this._personCfg=Config.WifeCfg.getWifeCfgById(this._personId)),this._dialogueIds=this._personCfg.dialogIds,null==this._dialogueIds?this.doNextStep():this.checkDialogueLength()},e.prototype.checkDialogueLength=function(){0==this._dialogueIds.length?this.doNextStep():(this._dialogNode&&null!=this._dialogNode||this.createDialogView(),this.refreshData())},e.prototype.createDialogView=function(){this._dialogNode=new BaseDisplayObjectContainer,this._dialogNode.height=GameConfig.stageHeigth,this._dialogNode.width=GameConfig.stageWidth,this.addChildToContainer(this._dialogNode),this._dialogBlackBgImg=BaseBitmap.create("public_9_black"),this._dialogBlackBgImg.height=this._dialogNode.height,this._dialogBlackBgImg.width=this._dialogNode.width,this._dialogNode.addChild(this._dialogBlackBgImg),this._dialogSceneBgImg=BaseBitmap.create(""),this._dialogNode.addChild(this._dialogSceneBgImg),this._mainImgNode=new BaseDisplayObjectContainer,this._mainImgNode.height=this._dialogNode.height,this._mainImgNode.width=this._dialogNode.width,this._dialogNode.addChild(this._mainImgNode),this._dialogDetailBgImg=BaseBitmap.create("public_9_wordbg"),this._dialogDetailBgImg.height=170,this._dialogDetailBgImg.y=this._dialogNode.height-this._dialogDetailBgImg.height,this._dialogNode.addChild(this._dialogDetailBgImg),this._nameBg=BaseBitmap.create("guideNameBg"),this._nameBg.x=25,this._nameBg.y=this._dialogDetailBgImg.y-50,this._dialogNode.addChild(this._nameBg),this._nameText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON),this._nameText.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,this._nameText.x=this._nameBg.x+this._nameBg.width/2-this._nameText.width/2,this._nameText.y=this._dialogDetailBgImg.y-42,this._dialogNode.addChild(this._nameText),this._continueText=ComponentManager.getTextField(LanguageManager.getlocal("clickContinue"),20),this._continueText.x=this._dialogNode.width-this._continueText.width-50,this._continueText.y=this._dialogNode.height-this._continueText.height-20,this._continueText.textColor=TextFieldConst.COLOR_WARN_GREEN,this._dialogNode.addChild(this._continueText),this.textAnim(this._continueText),this._descText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL),this._descText.width=GameConfig.stageWidth-60,this._descText.lineSpacing=8,this._descText.setPosition(30,this._dialogDetailBgImg.y+38),this._dialogNode.addChild(this._descText)},e.prototype.refreshData=function(){var t=this._dialogueIds.shift();this._curDialogueItemCfg=Config.DialogueCfg.getDialogueItemById(t),this._curDialogueItemCfg.targetType=this.targetType,this._curDialogueItemCfg.targetId=this._personId,this._descContent=this._curDialogueItemCfg.dialogStr,this._isDescOver=!1,this._curDescLength=0,this._dialogSceneBgImg.texture=ResourceManager.getRes(this._curDialogueItemCfg.bgName);var e=this._curDialogueItemCfg.nameStr;null==e?(this._nameBg.visible=!1,this._nameText.text=""):(this._nameBg.visible=!0,this._nameText.text=e,this._nameText.x=this._nameBg.x+this._nameBg.width/2-this._nameText.width/2);var i=this._curDialogueItemCfg.icon;switch(i){case"0":null!=this._personImg&&(this._personImg.visible=!1),null!=this._myImg&&(this._myImg.visible=!1);break;case"1":null!=this._personImg&&(this._personImg.visible=!1),this._myImg&&null!=this._myImg||(this._myImg=Api.playerVoApi.getMyPortrait(),this._myImg.x=this._dialogNode.width/2-this._myImg.width/2,this._myImg.y=this._dialogNode.height-this._dialogDetailBgImg.height-467,this._mainImgNode.addChild(this._myImg)),this._myImg.visible=!0;break;case"2":null!=this._myImg&&(this._myImg.visible=!1),this._personImg&&null!=this._personImg||(this._personImg=BaseLoadBitmap.create(this._curDialogueItemCfg.fullIconStr),"1"==this._targetType?(this._personImg.width=405,this._personImg.height=467):"2"==this._targetType&&(this._personImg.width=448,this._personImg.height=588),this._personImg.x=this._dialogNode.width/2-this._personImg.width/2,this._personImg.y=this._dialogNode.height-this._dialogDetailBgImg.height-this._personImg.height,this._mainImgNode.addChild(this._personImg)),this._personImg.visible=!0}egret.Tween.get(this).wait(0).call(this.textShootAnim,this),this.addTouchTap(this.clickPage,this)},e.prototype.textShootAnim=function(){this._isDescOver||(this._curDescLength+=1,this._curDescLength>this._descContent.length?(this._isDescOver=!0,this._descText.text=this._descContent):(this._descText.text=this._descContent.substr(0,this._curDescLength),egret.Tween.get(this._descText).wait(100).call(this.textShootAnim,this)))},e.prototype.textAnim=function(t){egret.Tween.removeTweens(t);var e=t.x,i=t.y,a=t.x-.1*t.width,n=t.y-.1*t.height;egret.Tween.get(t).to({scaleX:1.2,scaleY:1.2,x:a,y:n},600).to({scaleX:1,scaleY:1,x:e,y:i},600).to({scaleX:1.2,scaleY:1.2,x:a,y:n},600).to({scaleX:1,scaleY:1,x:e,y:i},600).call(this.textAnim,this,[t])},e.prototype.clickPage=function(){this._isDescOver?this.checkDialogueLength():(this._isDescOver=!0,this._descText.text=this._descContent)},e.prototype.doNextStep=function(){this.removeTouchTap(),null!=this._dialogNode&&(this._dialogNode.visible=!1),null!=this._nextFunc&&this._nextFunc.call(this)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["guideNameBg","searchbg1","homescene"])},e.prototype.releaseFunc=function(){this._dialogNode=null,this._dialogBlackBgImg=null,this._dialogSceneBgImg=null,this._dialogDetailBgImg=null,this._continueText=null,this._nameBg=null,this._nameText=null,this._descText=null,this._mainImgNode=null,this._personId=null,this._personCfg=null,this._dialogueIds=null,this._personImg=null,this._myImg=null,this._curDialogueItemCfg=null,this._descContent=null,this._curDescLength=0,this._isDescOver=!1,this._nextFunc=null,this._targetType=null},e.prototype.dispose=function(){this.releaseFunc(),t.prototype.dispose.call(this)},e}(BaseView);__reflect(DialogueGetBaseView.prototype,"DialogueGetBaseView");var WelfareViewTab=function(t){function e(){var e=t.call(this)||this;return e.isWanbaBoo=!1,e}return __extends(e,t),e.prototype.init=function(){this.isWanbaBoo=Api.switchVoApi.checknewRecharge();var t=BaseBitmap.create(this.getResPreName()+"_bg"),e=Api.arrivalVoApi.getTotalSignDay();if(6>=e&&"signin"==this.getResPreName())t=BaseBitmap.create(this.getResPreName()+"2_bg"),2>=e&&(t=BaseBitmap.create(this.getResPreName()+"3_bg"));else if("yearcard"==this.getResPreName()&&Api.acVoApi.getActivityVoByAidAndCode("discount","2")&&Api.acVoApi.getActivityVoByAidAndCode("discount","2").isStart){var i=this.getResPreName()+"_discount_bg";t=BaseBitmap.create(i)}else if(this.isWanbaBoo&&"firstrecharge"==this.getResPreName()){var i="firstrecharge2_bg";t=BaseBitmap.create(i)}var a=t;this.addChild(a),this.bottomBg=BaseBitmap.create("common_9_bg"),this.bottomBg.y=a.height,this.bottomBg.height=GameConfig.stageHeigth-89-a.height,this.addChild(this.bottomBg)},e.prototype.getParent=function(){return null},e.prototype.getResourceList=function(){var t=this.getResPreName(),e=[];e.push(t+"_btn"),"yearcard"==t&&Api.acVoApi.getActivityVoByAidAndCode("discount","2")&&Api.acVoApi.getActivityVoByAidAndCode("discount","2").isStart?e.push(t+"_discount_bg"):e.push(t+"_bg");var i=t+"_desc",a=t+"_icon";return RES.hasRes(i)&&e.push(i),RES.hasRes(a)&&e.push(a),e},e.prototype.getResPreName=function(){var t=egret.getQualifiedClassName(this),e=t.substring(11,t.length);return e.toLowerCase()},e.prototype.dispose=function(){this.bottomBg&&(this.removeChild(this.bottomBg),this.bottomBg.dispose(),this.bottomBg=null),t.prototype.dispose.call(this)},e}(BaseLoadDisplayObjectContiner);__reflect(WelfareViewTab.prototype,"WelfareViewTab");var ShopViewTab1=function(t){function e(){var e=t.call(this)||this;return e._index=0,e._shopid=0,e._currVipNum=0,e.initView(),App.MessageHelper.addEventListener(NetManager.getMessageName(NetPushConst.PUSH_PAY),e.receivePushData,e),e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_SHOP_NEXTDAY,this.refreshUI2,this);var t=Config.ShopnewCfg.getNewShopArr();this._shopInfoVoList=t;var e=egret.Rectangle.create();e.setTo(0,0,600,GameConfig.stageHeigth-420),this._scrollList=ComponentManager.getScrollList(ShopScrollItem,this._shopInfoVoList,e),this.addChild(this._scrollList),this._scrollList.setPosition(20,70),this._currVipNum=Api.playerVoApi.getPlayerVipLevel()},e.prototype.receivePushData=function(t){var e=t.data;e.data.cmd==NetPushConst.PUSH_PAY&&this._currVipNum!=Api.playerVoApi.getPlayerVipLevel()&&(this._currVipNum=Api.playerVoApi.getPlayerVipLevel(),this._scrollList.refreshData(this._shopInfoVoList))},e.prototype.refreshUI2=function(){this._scrollList&&this._scrollList.refreshData(this._shopInfoVoList)},e.prototype.getSheepType=function(){return 1},e.prototype.dispose=function(){this._scrollList=null,this._shopInfoVoList=null,this._index=0,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_SHOP_NEXTDAY,this.refreshUI2,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetPushConst.PUSH_PAY),this.receivePushData,this),t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(ShopViewTab1.prototype,"ShopViewTab1");var AcSpringCelebrateViewTab1=function(t){function e(){var e=t.call(this)||this;return e._scrollList=null,e._rechargeArr=null,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_RESFESH_SPRING_TAB,this.update,this);var t=BaseBitmap.create("public_9_bg43");t.width=625,t.height=GameConfig.stageHeigth-410,t.x=5,t.y=-220,this.addChild(t);var e=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE),i=e.getArr("recharge"),a=this.updataArr(i);this._rechargeArr=a;var n=new egret.Rectangle(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-430),o=ComponentManager.getScrollList(Celebration1ScrollItem,a,n);o.setPosition(20,-210),this.addChild(o),this._scrollList=o},e.prototype.updataArr=function(t){void 0===t&&(t=[]);for(var e=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE),i=t,a=[],n=[],o=0;o<i.length;o++){var s=Number(i[o].key);0==e.getReceiveType(s)?a.push(i[o]):n.push(i[o])}return i=[],i=n.concat(a)},e.prototype.update=function(){if(this._scrollList){var t=this.updataArr(this._rechargeArr);this._scrollList.refreshData(t),this._scrollList.setPosition(20,-210)}},e.prototype.getSheepType=function(){return 1},e.prototype.dispose=function(){this._scrollList=null,this._rechargeArr=null,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_RESFESH_SPRING_TAB,this.update,this),t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(AcSpringCelebrateViewTab1.prototype,"AcSpringCelebrateViewTab1");var BaseShape=function(t){function e(){var e=t.call(this)||this;return e.bindData=null,e._touchTapHelper=null,e._touchHelper=null,e}return __extends(e,t),e.prototype.addTouchTap=function(t,e,i){null==this._touchTapHelper&&(this._touchTapHelper=TouchHelper.addTouchTap(this,t,e,i))},e.prototype.removeTouchTap=function(){this._touchTapHelper&&(this._touchTapHelper.removeTouchTap(),this._touchTapHelper=null)},e.prototype.addTouch=function(t,e,i,a){this._touchHelper||(this._touchHelper=TouchHelper.addTouch(this,t,e,i,a))},e.prototype.removeTouch=function(){this._touchHelper&&(this._touchHelper.removeTouch(),this._touchHelper=null)},e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.stopAllActions=function(){egret.Tween.removeTweens(this)
},e.prototype.setVisible=function(t){this.visible=t},e.prototype.setScale=function(t){this.scaleX=this.scaleY=t},e.prototype.dispose=function(){this.stopAllActions(),this.removeTouchTap(),this.removeTouch(),this.bindData=null},e}(egret.Shape);__reflect(BaseShape.prototype,"BaseShape");var BaseTextField=function(t){function e(){var e=t.call(this)||this;return e.bindData=null,e._touchTapHelper=null,e}return __extends(e,t),e.prototype.addTouchTap=function(t,e,i){null==this._touchTapHelper&&(this._touchTapHelper=TouchHelper.addTouchTap(this,t,e,i))},e.prototype.removeTouchTap=function(){this._touchTapHelper&&(this._touchTapHelper.removeTouchTap(),this._touchTapHelper=null)},e.prototype.removeStageHandler=function(t){this.dispose()},e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.setColor=function(t){this.textColor=t},e.prototype.setVisible=function(t){this.visible=t},e.prototype.setString=function(t){this.text=t},e.prototype.stopAllActions=function(){egret.Tween.removeTweens(this)},e.prototype.setScale=function(t){this.scaleX=this.scaleY=t},Object.defineProperty(e.prototype,"text",{get:function(){return egret.superGetter(e,this,"text")},set:function(t){t=String(t);var i=new RegExp("\\s","g"),a=t.replace(i,"");if(t&&a.indexOf("<")>-1&&a.indexOf(">")>-1)try{this.textFlow=(new egret.HtmlTextParser).parser(t)}catch(n){egret.superSetter(e,this,"text",t)}else egret.superSetter(e,this,"text",t)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.parent&&this.parent.removeChild(this),this.stopAllActions(),this.removeTouchTap(),this.bindData=null},e}(egret.TextField);__reflect(BaseTextField.prototype,"BaseTextField",["base.Iinteractive","base.Ibase"]);var App;!function(t){}(App||(App={}));var NetLoading;!function(t){function e(){if(h>0)return h++,!1;if(null==d){d=new BaseDisplayObjectContainer;var t=new egret.Shape;t.graphics.beginFill(TextFieldConst.COLOR_BLACK,.3),t.graphics.drawRect(0,0,GameConfig.stageWidth,GameConfig.stageHeigth),t.graphics.endFill(),t.touchEnabled=!0,d.addChild(t);var e=ResourceManager.getRes("loading_circle");if(e)r=BaseBitmap.create("loading_circle");else{var i=egret.Rectangle.create();i.setTo(0,0,101,101),r=BaseLoadBitmap.create("loading_circle",i)}r.x=GameConfig.stageWidth/2,r.y=GameConfig.stageHeigth/2,r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,d.addChild(r)}return LayerManager.maskLayer.contains(d)||LayerManager.maskLayer.addChild(d),n(),h++,!0}function i(){h=0,a()}function a(){var t=!0;return h>1?(h--,t=!1):(d&&LayerManager.maskLayer.contains(d)&&(o(),LayerManager.maskLayer.removeChild(d)),h=0,t=!0),t}function n(){null==l?(l=egret.Tween.get(r,{loop:!0}),l.to({rotation:360},1500)):egret.Tween.resumeTweens(d)}function o(){l&&egret.Tween.pauseTweens(d)}function s(){l&&(egret.Tween.removeTweens(d),l=null),r&&(r=null),d&&(d.dispose(),d=null),h=0}var r,l,h=0,d=null;t.show=e,t.hideForChangeAccount=i,t.hide=a,t.startAnimat=n,t.pauseAnimat=o,t.dispose=s}(NetLoading||(NetLoading={}));var NetLoadingWait;!function(t){function e(t){var e=new i;return e.showMask(t),e}t.showMask=e;var i=function(){function t(){this.waitShowLoadingTime=500,this.waitTimeOut=-1,this.isLoadingShowed=!1}return t.prototype.showMask=function(t){var e=this;this.waitMask||(this.waitMask=BaseBitmap.create("public_alphabg"),this.waitMask.width=GameConfig.stageWidth,this.waitMask.height=GameConfig.stageHeigth,this.waitMask.touchEnabled=!0),LayerManager.maskLayer.contains(this.waitMask)||(LayerManager.maskLayer.addChild(this.waitMask),this.waitTimeOut<0&&(this.waitShowLoadingTime=t?t:this.waitShowLoadingTime,this.waitTimeOut=egret.setTimeout(function(){NetLoading.show(),e.isLoadingShowed=!0,egret.clearTimeout(e.waitTimeOut),e.waitTimeOut=-1},this,this.waitShowLoadingTime)))},t.prototype.hideMask=function(){this.waitMask&&LayerManager.maskLayer.contains(this.waitMask)&&LayerManager.maskLayer.removeChild(this.waitMask),this.waitTimeOut>-1&&(egret.clearTimeout(this.waitTimeOut),this.waitTimeOut=-1),this.isLoadingShowed&&(NetLoading.hide(),this.isLoadingShowed=!1)},t.prototype.dispose=function(){this.hideMask(),this.waitMask&&(this.waitMask.dispose(),BaseBitmap.release(this.waitMask),this.waitMask=null)},t}();t.LoadingWait=i,__reflect(i.prototype,"NetLoadingWait.LoadingWait")}(NetLoadingWait||(NetLoadingWait={}));var ClientSocket=function(t){function e(){var i=t.call(this)||this;return i.connected=!1,i._connectState=SocketStateEnum.STATE_INIT,i._operaClose=!1,i._isCloseAndTryConnect=!1,e._newIndex++,i._name="ClientSocket"+e._newIndex,App.LogUtil.showTxt(i._name),i._clientSocket=new RSDKWebSocket(i._name),window[i._name]=i,i.setWebSocketCallback(),i}return __extends(e,t),e.prototype.connect=function(t,e){App.LogUtil.showTxt("clientsocket连接"+t+e+"name="+this._name),this._operaClose=!1,this._host=t,this._port=e,this._clientSocket.connectWebSocket(this._name,"ws://"+t+":"+e)},e.prototype.isConnected=function(){return this.connected},e.prototype.isNoConnect=function(){return this._connectState==SocketStateEnum.STATE_NOCONNECT},e.prototype.send=function(t){App.LogUtil.showTxt("send::name="+this._name),this._clientSocket.sendWebSocketMessage(this._name,App.StringUtil.toString(t))},e.prototype.disconnectWebSocket=function(){this._clientSocket.disconnectWebSocket(this._name)},e.prototype.setWebSocketCallback=function(){this._clientSocket.setWebSocketCallback(this._name,this.callback.bind(this))},e.prototype.callback=function(t,e){if(App.LogUtil.showTxt("clientsocket回调"+t+"::"+e),t)switch(t){case RSDKCode.RET_WEBSOCKET_CONNECT_SUCCEED:this._isCloseAndTryConnect=!1,this.connected=!0,this._connectState=SocketStateEnum.STATE_CONNECTED,this.dispatchEvent(egret.Event.create(egret.Event,SocketStateConst.SOCKET_CONNECTED));break;case RSDKCode.RET_WEBSOCKET_CONNECT_FAIL:this.connected=!1,this._connectState=SocketStateEnum.STATE_INIT;break;case RSDKCode.RET_WEBSOCKET_CONNECT_DIS:this.connected=!1,this._connectState=SocketStateEnum.STATE_INIT,this._operaClose&&this._isCloseAndTryConnect&&this.resetAndReconnect();break;case RSDKCode.RET_WEBSOCKET_RECEIVE_MSG_SUCCEED:var i=void 0;try{i=JSON.parse(e)}catch(a){i=JSON.parse(e)}var n=egret.Event.create(egret.Event,SocketStateConst.SOCKET_DATA);n.data=i,this.dispatchEvent(n);break;case RSDKCode.RET_WEBSOCKET_CONNECT_TIMEOUT:case RSDKCode.RET_WEBSOCKET_ERROR:this._isCloseAndTryConnect=!1,this.connected=!1,this._connectState=SocketStateEnum.STATE_NOCONNECT,this.dispatchEvent(egret.Event.create(egret.Event,SocketStateConst.SOCKET_NOCONNECT))}},e.prototype.resetAndReconnect=function(t){void 0===t&&(t=!1),this.connect(this._host,this._port)},e.prototype.close=function(t){this._isCloseAndTryConnect=Boolean(t),this._operaClose=!0,this.disconnectWebSocket()},e.prototype.dispose=function(){this._operaClose=!1,this._isCloseAndTryConnect=!1},e._newIndex=0,e}(egret.EventDispatcher);__reflect(ClientSocket.prototype,"ClientSocket");var Http=function(t){function e(){var e=t.call(this)||this;return e._httpRequest=void 0,e._isRequesting=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){this._httpRequest=new egret.HttpRequest,this._httpRequest.addEventListener(egret.Event.COMPLETE,this.onRequestComplete,this),this._httpRequest.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onRequestIOError,this),this._httpRequest.addEventListener(egret.ProgressEvent.PROGRESS,this.onRequestProgress,this)},e.prototype.request=function(t,i,a,n,o,s,r){if(void 0===r&&(r=egret.HttpResponseType.TEXT),this._callbackData={successCallback:n,errorCallback:o,callbackTarget:s},this._isRequesting=!0,this._httpRequest.responseType=r,t&&t.indexOf("http")<0&&(t=e.getProtocol()+t),a==egret.HttpMethod.POST)console.log("http send post"),this._httpRequest.open(t,a),this._httpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this._httpRequest.send(App.StringUtil.toString(i));else{console.log("http send get");var l="";for(var h in i)l+=""==l?"?"+h+"="+App.StringUtil.toString(i[h]):"&"+h+"="+App.StringUtil.toString(i[h]);t+=l,this._httpRequest.open(t,a),this._httpRequest.send()}},e.prototype.onRequestComplete=function(t){if(console.log("http complete"),this._isRequesting=!1,this._callbackData.successCallback){var e=this._callbackData;this._callbackData=null,e.successCallback.call(e.callbackTarget,this._httpRequest.response)}},e.prototype.onRequestProgress=function(t){},e.prototype.onRequestIOError=function(t){if(console.log("http error"),this._isRequesting=!1,this._callbackData.errorCallback){var e=this._callbackData;this._callbackData=null,e.errorCallback.call(e.callbackTarget)}},e.prototype.isRequesting=function(){return this._isRequesting},e.prototype.encode=function(t){var e="";for(var i in t)e+=i+"="+t[i]+"&";return e.length>1?""+e.substring(0,e.length-1):e},e.getProtocol=function(){return App.DeviceUtil.IsHtml5()||App.DeviceUtil.isRuntime2()?document.location.protocol:App.DeviceUtil.isWXgame()?"https:":""},e.prototype.abort=function(){this._httpRequest&&this._httpRequest.abort()},e.prototype.dispose=function(){this._httpRequest&&(this._httpRequest.abort(),this._httpRequest.removeEventListener(egret.Event.COMPLETE,this.onRequestComplete,this),this._httpRequest.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onRequestIOError,this),this._httpRequest.removeEventListener(egret.ProgressEvent.PROGRESS,this.onRequestProgress,this),this._httpRequest=null)},e}(BaseClass);__reflect(Http.prototype,"Http");var JsonMsg=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.send=function(t,e){var i=this.encode(e);i&&(t.type=egret.WebSocket.TYPE_STRING,t.writeUTF(i))},e.prototype.receive=function(t){var e=t.readUTF();return this.decode(e)},e.prototype.encode=function(t){var e=App.StringUtil.toString(t);return e},e.prototype.decode=function(t){var e=JSON.parse(t);return e},e.prototype.dispose=function(){},e}(BaseClass);__reflect(JsonMsg.prototype,"JsonMsg");var Socket=function(t){function e(){var e=t.call(this)||this;return e._socket=void 0,e._connectState=SocketStateEnum.STATE_INIT,e._host=void 0,e._port=void 0,e._reconnectCount=0,e._maxReconnectCount=10,e._operaClose=!1,e._isCloseAndTryConnect=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.initSocket(),this._dataMsg=new JsonMsg,this._connectState=SocketStateEnum.STATE_INIT},e.prototype.initSocket=function(){this._socket=new egret.WebSocket,this._socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveData,this),this._socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)},e.prototype.connect=function(t,e){if(App.DeviceUtil.IsHtml5()&&!window.WebSocket)return void App.LogUtil.log("不支持WebSocket");if(this._operaClose=!1,this._host=t,this._port=e,this._dataMsg instanceof egret.ByteArray&&(this._socket.type=egret.WebSocket.TYPE_BINARY),App.LogUtil.log("socket开始连接: "+this._host+":"+this._port),this._connectState==SocketStateEnum.STATE_RECONNECTING||(this._connectState=SocketStateEnum.STATE_CONNECTING),NetManager.checkHttps()){var i=1e3;1e4==Number(this._port)?i=1100:2002==Number(this._port)&&(i=100),this._socket.connectByUrl("wss://"+this._host+":"+String(Number(this._port)+i))}else this._socket.connect(this._host,this._port)},e.prototype.close=function(t){App.LogUtil.log("close"),this._socket&&(this._isCloseAndTryConnect=Boolean(t),this._operaClose=!0,this._socket.close())},e.prototype.reconnect=function(){this._reconnectCount++,this._reconnectCount<this._maxReconnectCount?(App.LogUtil.log("socket开始重连"+this._reconnectCount),this._connectState=SocketStateEnum.STATE_RECONNECTING,this.connect(this._host,this._port)):(App.LogUtil.log("socket次数"+this._reconnectCount,"不再重连"),this._connectState=SocketStateEnum.STATE_NOCONNECT,this.dispatchEvent(egret.Event.create(egret.Event,SocketStateConst.SOCKET_NOCONNECT)),this._isCloseAndTryConnect=!1)},e.prototype.onSocketOpen=function(t){App.LogUtil.log("socket连接成功"),this._isCloseAndTryConnect=!1,this._reconnectCount=0,this._connectState==SocketStateEnum.STATE_RECONNECTING?(this._connectState=SocketStateEnum.STATE_RECONNECTED,this.dispatchEvent(egret.Event.create(egret.Event,SocketStateConst.SOCKET_RECONNECTED))):(this._connectState=SocketStateEnum.STATE_CONNECTED,this.dispatchEvent(egret.Event.create(egret.Event,SocketStateConst.SOCKET_CONNECTED)))},e.prototype.onReceiveData=function(t){App.LogUtil.log("socket接收");var e=this._dataMsg.receive(this._socket),i=egret.Event.create(egret.Event,SocketStateConst.SOCKET_DATA);i.data=e,this.dispatchEvent(i)},e.prototype.onSocketClose=function(t){if(this._operaClose){if(App.LogUtil.log("主动操作关闭socket"),this._connectState=SocketStateEnum.STATE_INIT,!this._isCloseAndTryConnect)return;this._reconnectCount=0}App.LogUtil.log("socket关闭，开始检测重连"),this.resetAndReconnect()},e.prototype.onSocketError=function(t){App.LogUtil.log("socket错误，开始检测重连"),this.resetAndReconnect()},e.prototype.resetAndReconnect=function(t){void 0===t&&(t=!1),t&&(this._reconnectCount=0),this.resetSocket(),this.reconnect(),this._reconnectCount<this._maxReconnectCount&&this.dispatchEvent(egret.Event.create(egret.Event,SocketStateConst.SOCKET_START_RECONNECT))},e.prototype.send=function(t){t||(t={}),this._dataMsg.send(this._socket,t)},e.prototype.isConnected=function(){return this._socket.connected},e.prototype.isReConnecting=function(){return this._connectState==SocketStateEnum.STATE_RECONNECTING},e.prototype.isNoConnect=function(){return this._connectState==SocketStateEnum.STATE_NOCONNECT},e.prototype.resetSocket=function(){this._socket&&(this._socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveData,this),this._socket.removeEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.removeEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)),this.initSocket()},e.prototype.dispose=function(){this._socket&&(this._socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveData,this),this._socket.removeEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.removeEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)),this._dataMsg=null,this._connectState=null,this._host=null,this._port=null,this._socket=null,this._operaClose=!1,this._isCloseAndTryConnect=!1},e}(egret.EventDispatcher);__reflect(Socket.prototype,"Socket");var CheckBox=function(t){function e(){var e=t.call(this)||this;return e._isSelected=!1,e}return __extends(e,t),e.prototype.init=function(t){this._selectBox=BaseBitmap.create("public_select"),this._selectBox.addTouchTap(this.selectHandler,this),this.addChild(this._selectBox),t&&(this._txt=ComponentManager.getTextField(t,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_YELLOW),this._txt.setPosition(this._selectBox.x+this._selectBox.width+5,this._selectBox.y+(this._selectBox.height-this._txt.height)/2),this.addChild(this._txt))},e.prototype.selectHandler=function(){this.isSelected=!this.isSelected,SoundManager.playEffect(SoundConst.EFFECT_CLICK)},Object.defineProperty(e.prototype,"isSelected",{get:function(){return this._isSelected},set:function(t){this._isSelected=t,this._selectBox.texture=ResourceManager.getRes(this._isSelected?"public_select_down":"public_select")},enumerable:!0,configurable:!0}),e.prototype.checkSelected=function(){return this.isSelected},e.prototype.setSelected=function(t){this.isSelected=Boolean(t)},e.prototype.dispose=function(){this._isSelected=!1,this._selectBox=null,this._txt=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(CheckBox.prototype,"CheckBox");var SoundBg=function(t){function e(){var e=t.call(this)||this;return e._volume=1,e._currBg="",e}return __extends(e,t),e.prototype.stop=function(){this._currSoundChannel&&this._currSoundChannel.stop(),this._currSoundChannel=null,this._currSound=null,this._currBg=""},e.prototype.resume=function(){this._currSoundChannel&&(this._currSoundChannel.volume=this._volume)},e.prototype.pause=function(){this._currSoundChannel&&(this._currSoundChannel.volume=0)},e.prototype.play=function(t){if(this._currBg!=t){this.stop(),this._currBg=t;var e=this.getSound(t);e&&(e.type=egret.Sound.MUSIC,this.playSound(e))}},e.prototype.playSound=function(t){this._currSound=t,this._currSoundChannel=this._currSound.play(0,0),this._currSoundChannel.volume=this._volume},e.prototype.setVolume=function(t){this._volume=t,this._currSoundChannel&&(this._currSoundChannel.volume=this._volume)},e.prototype.loadedPlay=function(t){this._currBg==t&&this.playSound(ResourceManager.getRes(t))},e.prototype.checkCanClear=function(t){return this._currBg!=t},e}(BaseSound);__reflect(SoundBg.prototype,"SoundBg");var SoundEffects=function(t){function e(){var e=t.call(this)||this;return e._volume=1,e._channelList={},e._effectLength={},e}return __extends(e,t),e.prototype.play=function(t){var e=this.getSound(t);if(e){e.type=egret.Sound.EFFECT,this._effectLength[t]||(this._effectLength[t]=e.length),null==this._channelList[t]&&(this._channelList[t]={});var i=this.playSound(e);i&&(i.effectName=t,this._channelList[t][i.hashCode]=i)}},e.prototype.stop=function(t){var e=this._channelList[t];if(e)for(var i in e){var a=e[i];a&&(this._effectLength[t]||(this._effectLength[t]=0),a.position<this._effectLength[t]&&a.stop()),a.removeEventListener(egret.Event.SOUND_COMPLETE,this.removeSoundChannel,this),delete this._channelList[t][i]}},e.prototype.playSound=function(t){try{var e=t.play(0,1);return e.addEventListener(egret.Event.SOUND_COMPLETE,this.removeSoundChannel,this),e.volume=this._volume,e}catch(i){}},e.prototype.removeSoundChannel=function(t){var e=t.target;if(e){e.removeEventListener(egret.Event.SOUND_COMPLETE,this.removeSoundChannel,this);var i=e.effectName;i&&this._channelList[i]&&delete this._channelList[i][e.hashCode]}},e.prototype.setVolume=function(t){this._volume=t},e.prototype.loadedPlay=function(t){var e=ResourceManager.getRes(t);if(e){e.type=egret.Sound.EFFECT,this._effectLength[t]||(this._effectLength[t]=e.length),null==this._channelList[t]&&(this._channelList[t]={});var i=this.playSound(e);i&&(i.effectName=t,this._channelList[t][i.hashCode]=i)}},e}(BaseSound);__reflect(SoundEffects.prototype,"SoundEffects");var Base64=function(){function t(){throw new Error("Base64 class is static container only")}return t.encode=function(e){var i=new egret.ByteArray;return i.writeUTFBytes(e),t.encodeByteArray(i)},t.encodeByteArray=function(e){var i,a="",n=new Array(4);for(e.position=0;e.bytesAvailable>0;){i=new Array;for(var o=0;3>o&&e.bytesAvailable>0;o++)i[o]=e.readUnsignedByte();n[0]=(252&i[0])>>2,n[1]=(3&i[0])<<4|i[1]>>4,n[2]=(15&i[1])<<2|i[2]>>6,n[3]=63&i[2];for(var s=i.length;3>s;s++)n[s+1]=64;for(var r=0;r<n.length;r++)a+=t.BASE64_CHARS.charAt(n[r])}return a},t.decode=function(e){var i=t.decodeToByteArray(e);return i.readUTFBytes(i.length)},t.decodeToByteArray=function(e){for(var i=new egret.ByteArray,a=new Array(4),n=new Array(3),o=0;o<e.length;o+=4){for(var s=0;4>s&&o+s<e.length;s++)a[s]=t.BASE64_CHARS.indexOf(e.charAt(o+s));n[0]=(a[0]<<2)+((48&a[1])>>4),n[1]=((15&a[1])<<4)+((60&a[2])>>2),n[2]=((3&a[2])<<6)+a[3];for(var r=0;r<n.length&&64!=a[r+1];r++)i.writeByte(n[r])}return i.position=0,i},t.BASE64_CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t.version="1.0.0",t}();__reflect(Base64.prototype,"Base64");var App;!function(t){var e;!function(e){function i(t,e){void 0===e&&(e=1);var i="";switch(e){case 1:i=a(t);break;case 2:i=o(t);break;case 3:i=n(t);break;case 4:i=s(t);break;case 5:i=r(t);break;case 6:i=l(t);break;case 7:i=h(t);break;case 8:i=d(t);break;case 9:i=g(t);case 10:i=c(t)}return i}function a(t){void 0===t&&(t=0);var e,i=Math.floor(t/3600);e=0==i?"00":10>i?"0"+i:""+i;var a,n,o=Math.floor((t-3600*i)/60),s=Math.floor((t-3600*i)%60);return a=0==o?"00":10>o?"0"+o:""+o,n=0==s?"00":10>s?"0"+s:""+s,e+":"+a+":"+n}function n(t){void 0===t&&(t=0);var e,i,a=Math.floor(t/3600),n=Math.floor((t-3600*a)/60),o=Math.floor((t-3600*a)%60);return e=0==n?"00":10>n?"0"+n:""+n,i=0==o?"00":10>o?"0"+o:""+o,a+":"+e+":"+i}function o(t){var e,i,a=new Date(1e3*t),n=a.getFullYear(),o=a.getMonth()+1,s=a.getDate(),r=a.getHours(),l=a.getMinutes(),h=a.getSeconds();return e=0==l?"00":10>l?"0"+l:""+l,i=0==h?"00":10>h?"0"+h:""+h,n+"-"+o+"-"+s+" "+r+":"+e+":"+i}function s(t){var e=Math.floor(t/3600);return e>0?e>24?LanguageManager.getlocal("chat_time1",[String(Math.floor(e/24))]):LanguageManager.getlocal("chat_time2",[String(e)]):Math.floor(t/60)>0?LanguageManager.getlocal("chat_time3",[String(Math.floor(t/60))]):LanguageManager.getlocal("chat_time4")}function r(t){var e=86400,i=3600,a=60,n=Math.floor(t/e),o=Math.floor(t%e/i),s=Math.floor((t-o*i)/a),r=Math.floor((t-o*i)%a),l="",h="",d="",g="";return t>0?0==n?(l="",0==o?(h="",0==s?(d="",g=0==r?"":10>r?"0"+r+"秒":""+r+"秒"):(d=""+s+"分",g=0==r?"":10>r?"0"+r+"秒":""+r+"秒",d+g)):(h=o+"小时",0==s?(d="",g=0==r?"":10>r?"0"+r+"秒":""+r+"秒"):(d=10>s?"0"+s+"分":""+s+"分",h+d))):(l=n+"天",h=0==o?"":10>o?"0"+o+"小时":""+o+"小时",l+h):""}function l(t){var e=new Date(1e3*t),i=e.getFullYear(),a=e.getMonth()+1,n=e.getDate();return i+LanguageManager.getlocal("yearTitle")+a+LanguageManager.getlocal("monthTitle")+n+LanguageManager.getlocal("dayTitle")}function h(t){var e=new Date(1e3*t),i=e.getMonth()+1,a=e.getDate();return i+LanguageManager.getlocal("monthTitle")+a+LanguageManager.getlocal("dayTitle")}function d(t){var e="";if(t>=86400){var i=86400,a=Math.floor(t/i);e=e+a+LanguageManager.getlocal("date_day"),t%=i}if(t>=3600){var n=3600,o=Math.floor(t/n);e=e+o+LanguageManager.getlocal("date_hour2"),t%=n}if(t>=60){var s=Math.floor(t/60);e=e+s+LanguageManager.getlocal("date_minute"),t%=60}return e=10>t?e+"0"+t+LanguageManager.getlocal("date_second"):e+t+LanguageManager.getlocal("date_second")}function g(t){var e,i,a=new Date(1e3*t),n=(a.getFullYear(),a.getMonth()+1),o=a.getDate(),s=a.getHours(),r=a.getMinutes(),l=a.getSeconds();return e=0==r?"00":10>r?"0"+r:""+r,i=0==l?"00":10>l?"0"+l:""+l,n+"."+o+" "+s+":"+e}function c(t){var e=new Date(1e3*t),i=e.getMonth()+1,a=e.getDate(),n=e.getHours();return i+LanguageManager.getlocal("monthTitle")+a+LanguageManager.getlocal("dayTitle")+n+LanguageManager.getlocal("date_hour")}function p(t){return t-(t+3600*GameData.timeZone)%86400}function _(t){return GameData.serverTime-(p(t)+86400)<0}function u(t){var i=e.hourSeconds*e.dayHours,a=GameData.timeZone*e.hourSeconds,n=(t+a)%i;return n}function C(e,i,a){var n=a?10:7;return t.DateUtil.getFormatBySecond(e,n)+"-"+t.DateUtil.getFormatBySecond(i,n)}e.hourSeconds=3600,e.dayHours=24;e.getFormatBySecond=i,e.getWeeTs=p,e.checkIsToday=_,e.getLeftDaySecondByTime=u,e.getOpenLocalTime=C}(e=t.DateUtil||(t.DateUtil={}))}(App||(App={}));var App;!function(t){var e=function(){function t(){}return t.IsHtml5=function(){return!this.isWXgame()&&egret.Capabilities.runtimeType==egret.RuntimeType.WEB},t.IsNative=function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE},t.isWXgame=function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WXGAME},t.isRuntime2=function(){return egret.Capabilities.runtimeType==egret.RuntimeType.RUNTIME2},t.IsMobile=function(){return egret.Capabilities.isMobile},t.isAndroid=function(){return"Android"==egret.Capabilities.os},t.isIOS=function(){return"iOS"==egret.Capabilities.os},t.CheckWebglRenderMode=function(){return"webgl"==egret.Capabilities.renderMode},t.getOSCurrentLanguage=function(){return"cn"},t.wanbaIsDownloadApp=!1,t}();t.DeviceUtil=e,__reflect(e.prototype,"App.DeviceUtil")}(App||(App={}));var App;!function(t){var e=function(){function t(){}return t.changeToGray=function(t){if(null==this.grayFilter){var e=[.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0];this.grayFilter=new egret.ColorMatrixFilter(e)}t.filters=[this.grayFilter]},t.changeToNormal=function(t){t.filters=null},t.addFactorFunc=function(t){Object.defineProperty(t.prototype,"factor",{get:function(){return 0},set:function(t){this.x=(1-t)*(1-t)*this.tweenMoveList[0].x+2*t*(1-t)*this.tweenMoveList[1].x+t*t*this.tweenMoveList[2].x,this.y=(1-t)*(1-t)*this.tweenMoveList[0].y+2*t*(1-t)*this.tweenMoveList[1].y+t*t*this.tweenMoveList[2].y},enumerable:!0,configurable:!0})},t.destory=function(e){if(e.cacheAsBitmap&&(e.cacheAsBitmap=!1),egret.Tween.removeTweens(e),e instanceof ScrollView)e.dispose();else for(;e.numChildren>0;){var i=e.removeChildAt(0);i.cacheAsBitmap&&(i.cacheAsBitmap=!1),egret.Tween.removeTweens(i),i.texture&&(i.texture=null),i.bitmapData&&(i.bitmapData=null),i instanceof BaseLoadBitmap?BaseLoadBitmap.release(i):i instanceof BaseBitmap?BaseBitmap.release(i):i instanceof particle.GravityParticleSystem&&i.stop(!0),i.dispose?i.dispose():i instanceof egret.DisplayObjectContainer&&t.destory(i)}},t.grayFilter=null,t}();t.DisplayUtil=e,__reflect(e.prototype,"App.DisplayUtil")}(App||(App={}));var App;!function(t){var e;!function(t){function e(t){var e=RES.getRes(t+"_ske"),i=RES.getRes(t+"_tex_json"),a=RES.getRes(t+"_tex_png"),n=dragonBones.EgretFactory.factory;n.getDragonBonesData(t)||n.parseDragonBonesData(e),n.getTextureAtlasData(t)||n.parseTextureAtlasData(i,a);var o=n.buildArmatureDisplay(t);return o}function i(t){var e=dragonBones.EgretFactory.factory;e.removeDragonBonesData(t),e.removeTextureAtlasData(t)}function a(t){return new BaseLoadDragonBones(t)}function n(){var t=dragonBones.EgretFactory.factory;t&&t.clear()}t.getDragonBones=e,t.removeDragonBones=i,t.getLoadDragonBones=a,t.clear=n}(e=t.DragonBonesUtil||(t.DragonBonesUtil={}))}(App||(App={}));var App;!function(t){var e=function(){function e(){}return e.log=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if(GameData.isLocal()||GameData.isTest()||"log"==egret.getOption("ccshowlog")){var a=e.formatLogParams(t),n=a.firstParam,o=a.otherParams;console.log(n,o)}},e.show=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.warn=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if(GameData.isLocal()){var a=e.formatLogParams(t),n=a.firstParam,o=a.otherParams;egret.warn.call(egret,n,o)}},e.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.alert=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if("alert"==egret.getOption("testck")){var a=e.formatLogParams(t),n=a.firstParam,o=a.otherParams;alert(n+" "+o)}},e.showTxt=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var a=e.formatLogParams(t),n=a.firstParam,o=a.otherParams;e._txt?e._txt.appendText(n+" "+o):(e._txt=ComponentManager.getTextField(n+" "+o,15),GameConfig.stage.addChild(e._txt))},e.formatLogParams=function(e){var i={firstParam:void 0,otherParams:""};if(e&&e.length>0)for(var a="",n=0;n<e.length;n++){var o=void 0,s=e[n];o=t.StringUtil.toString(s),0==n?i.firstParam=o:(a+=a?" "+o:o,i.otherParams=a)}return i},e}();t.LogUtil=e,__reflect(e.prototype,"App.LogUtil")}(App||(App={}));var App;!function(t){var e=function(){function e(){}return e.formatNumberByComma=function(e){var i="";e=Math.floor(e);var a=e.toString().length,n=e.toString(),o=Math.ceil(a/3)-1;if(t.LogUtil.log("commaNum = "+o),0>o&&(o=0),o>0)for(var s="",r=1;o+1>=r;r++){var l=a-3*r,h=a-3*(r-1);r==o+1?(l=0,s=n.substring(l,h)):s=","+n.substring(l,h),i=s+i}else i=n;return i},e.formatNumber=function(t){var e="";t=Math.floor(t);var i=t.toString().length,a=t.toString(),n=0;return i>3&&6>=i?(n=t/1e3,e=n.toFixed(3-Math.floor(n).toString().length)+"K"):i>6&&9>=i?(n=t/1e6,e=n.toFixed(3-Math.floor(n).toString().length)+"M"):i>9&&12>=i?(n=t/1e9,e=n.toFixed(3-Math.floor(n).toString().length)+"G"):i>12?(n=t/1e9,e=n.toFixed(3-Math.floor(n).toString().length)+"G"):e=a,e},e.getDistance=function(t,e){return egret.Point.distance(t,e)},e.getRandom=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=100),t+Math.floor(Math.random()*(e-t))},e.getAngleByRadian=function(t){return 180*t/Math.PI},e.getRadianByAngle=function(t){return t*Math.PI/180},e.checkEqual=function(t,e){return 0==isNaN(t)&&0==isNaN(t)?t==e:!0},e}();t.MathUtil=e,__reflect(e.prototype,"App.MathUtil")}(App||(App={}));var App;!function(t){var e=function(){function t(){}return t.addEventListener=function(t,e,i){this.eventDisptcher.addEventListener(t,e,i)},t.once=function(t,e,i){this.eventDisptcher.once(t,e,i)},t.removeEventListener=function(t,e,i){this.eventDisptcher.removeEventListener(t,e,i)},t.addNetMessage=function(t,e,i){this.eventDisptcher.addEventListener(NetManager.getMessageName(t),e,i)},t.removeNetMessage=function(t,e,i){this.eventDisptcher.removeEventListener(NetManager.getMessageName(t),e,i)},t.dispatchNetMessage=function(e,i){t.dispatchEvent(NetManager.getMessageName(e),i)},t.dispatchEvent=function(t,e){this.eventDisptcher.dispatchEvent(new egret.Event(t,!1,!1,e))},t.hasEventListener=function(t){return this.eventDisptcher.hasEventListener(t)},t.eventDisptcher=new egret.EventDispatcher,t}();t.MessageHelper=e,__reflect(e.prototype,"App.MessageHelper")}(App||(App={}));var App;!function(t){var e;!function(t){function e(t,e){var i=ResourceManager.getRes(t),a=null;a=RES.hasRes(t+"_json")?ResourceManager.getRes(t+"_json"):ResourceManager.getRes(e);var n=new particle.GravityParticleSystem(i,a);return n}t.getParticle=e}(e=t.ParticleUtil||(t.ParticleUtil={}))}(App||(App={}));var App;!function(t){var e=function(){function e(){}return e.initGroup=function(){0==e._isGroupInit&&(RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,e.onGroupLoadProgress,e),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,e.onGroupLoadComplete,e),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,e.onGroupLoadError,e),e._isGroupInit=!0)},e.loadGroup=function(t,i,a,n,o){e.initGroup(),e._groupList[t]=[i,a,n,o],RES.loadGroup(t)},e.onGroupLoadProgress=function(t){var i=t.groupName;if(e._groupList[i]){var a=e._groupList[i][1],n=e._groupList[i][2];a&&a.call(n,t)}},e.onGroupLoadComplete=function(t){var i=t.groupName;if(e._groupList[i]){var a=e._groupList[i][0],n=e._groupList[i][2];a&&a.call(n),e._groupList[i]=null,delete e._groupList[i]}},e.onGroupLoadError=function(t){console.log("res loaderror",t.groupName);var i=t.groupName;if(e._groupList[i]){var a=e._groupList[i][2],n=e._groupList[i][3];n&&n.call(a),e._groupList[i]=null,delete e._groupList[i]}},e.createGroup=function(t){void 0===t&&(t=[]);var i="loadGroup"+e._groupIndex++;return RES.createGroup(i,t,!0),i},e.initItemLoad=function(){0==e._isItemLoadInit&&(e._isItemLoadInit=!0,RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,e.onItemLoadError,e))},e.loadItem=function(t,i,a){e.initItemLoad(),RES.getResAsync(t,i,a)},e.loadItemByUrl=function(t,i,a,n){e.initItemLoad(),RES.getResByUrl(t,i,a,n)},e.onItemLoadError=function(e){e.resItem.name.indexOf("gameconfig_")>-1&&!GameConfig.isLoaded&&GameConfig.loadConfig(),t.LogUtil.show("缺资源or断网",e.resItem.name)},e.loadResource=function(i,a,n,o,s,r){void 0===i&&(i=[]),void 0===a&&(a=[]);for(var l=a?i.concat(a):i,h=[],d=l.length-1;d>=0;d--){var g=l[d],c=!1;if(RES.config&&RES.config.config&&RES.config.config.groups?RES.config.config.groups[g]&&(c=!0):RES.getGroupByName(g)&&(c=!0),!g||0==RES.hasRes(g)&&!c)t.LogUtil.warn("资源配置缺少",g,"跳过加载此文件"),l.splice(d,1);else if(g.indexOf("btn")>-1){var p=g+"_down";RES.hasRes(p)&&l.indexOf(p)<0&&h.push(p)}else if(g.indexOf("progress")>-1){var _=g+"_bg";RES.hasRes(_)&&l.indexOf(_)<0&&h.push(_)}else if(g.indexOf("shield")>-1){var u="shield_"+GameData.getCountry();RES.hasRes(u)&&(l[d]=u)}}l=l.concat(h);var C=e.createGroup(l);return e.loadGroup(C,n,o,s,r),C},e.loadSingleScript=function(t){var e=document.createElement("script");e.async=!1,e.src=t,e.addEventListener("load",function i(){e.parentNode.removeChild(e),e.removeEventListener("load",i,!1)},!1),document.body.appendChild(e)},e._groupList={},e._isGroupInit=!1,e._groupIndex=0,e._isItemLoadInit=!1,e}();t.ResourceUtil=e,__reflect(e.prototype,"App.ResourceUtil")
}(App||(App={}));var App;!function(t){var e=function(){function t(){}return t.dump=function(t){for(var e="",i="",a=0;a<t.length;a++){a%16==0&&(e+=("0000"+a.toString(16)).substring(-4,4)+" "),a%8==0&&(e+=" ");var n=t[a];e+=("0"+n.toString(16)).substring(-2,2)+" ",((a+1)%16==0||a==t.length-1)&&(e+=" |"+i+"|\n",i="")}return e},t.toString=function(t){var e=void 0;if("object"==typeof t)try{e=JSON.stringify(t)}catch(i){}else e=String(t);return e},t.changeIntToText=function(t){void 0===t&&(t=0);var e="";return e+=t>=1e12?(t/1e12).toFixed(3)+LanguageManager.getlocal("coinformat_4"):t>=1e11?(t/1e8).toFixed(2)+LanguageManager.getlocal("coinformat_1"):t>=1e10?(t/1e8).toFixed(2)+LanguageManager.getlocal("coinformat_1"):t>=1e8?(t/1e8).toFixed(3)+LanguageManager.getlocal("coinformat_1"):0>t?"0":t.toFixed(0)},t.splitString=function(t,e){var i=null;return null!=t&&null!=e&&(i=t.split(e)),i},t.formatIntToString=function(t){void 0===t&&(t=0);var e=t.toString().length,i=t.toString();return e>3&&6>=e?(t=parseFloat((t/1e3).toFixed(3-e%3)),i=6==e?t.toString().substring(0,3):t.toString().substring(0,4),i+="K"):e>6&&9>=e?(t=parseFloat((t/1e6).toFixed(3-e%3)),i=9==e?t.toString().substring(0,3):t.toString().substring(0,4),i+="M"):e>9&&(t=parseFloat((t/1e9).toFixed(3-e%3)),i=t.toString().substring(0,4),i+="G"),i},t.checkCharacter=function(t){var e=new RegExp("/[|%|'|%|.|,|:|;|*|?|~|`|!|@|#|$|%%|%|^|&|+|=|)|(|<|{|}| |%|]|%|[|/|\"|]/");return e.test(t)},t.checkChar=function(t){if(""==t.trim())return!0;if(-1!=t.indexOf("     "))return!0;var e=new RegExp("/s+/g|<","g");return e.test(t)},t.replaceString=function(t,e,i){var a=new RegExp(e,"g"),n=t.replace(a,i);return n},t.removeFirstChar=function(t){return"string"!=typeof t&&(t=t.toString()),t.substring(1)},t.formatLocalLanuageValue=function(t,e){if(e)for(var i=0;i<e.length;i++)for(var a=e[i],n="{"+(i+1)+"}";t.indexOf(n)>-1;)t=t.replace(n,a);return t},t.firstCharToLower=function(t){var e=t.substr(0,1),i=t.substr(1,t.length-1);return e.toLowerCase()+i},t.firstCharToUper=function(t){var e=t.substr(0,1),i=t.substr(1,t.length-1);return e.toUpperCase()+i},t.userNameCheck=function(t){var e=new RegExp("^[A-Za-z0-9一-龥豈-鶴가-힣]+$");return e.test(t)?!0:!1},t.numberCheck=function(t){var e=new RegExp("^[0-9]+$");return e.test(t)?!0:!1},t.formatStringColor=function(t,e){return"<font color="+String(e)+">"+t+"</font>"},t}();t.StringUtil=e,__reflect(e.prototype,"App.StringUtil")}(App||(App={}));var App;!function(t){var e=function(){function t(){}return t.play=function(t,e){var i=document.body,a=document.createElement("video");a.id="__VIDEO__PLAYER__ZZT_",a.style.position="absolute",a.style.width="100%",a.style.top="0",a.style.height="100%",a.style.left="0",a.style.textAlign="center",a.autoplay=!0,a.controls=!0,a.volume=SoundManager.getSoundSwitch()?1:0,a.onended=function(){a.parentNode.removeChild(a),e()},a.src=t,i.appendChild(a)},t}();t.VideoUtil=e,__reflect(e.prototype,"App.VideoUtil")}(App||(App={}));var GameData;!function(t){function e(e){e.statisticsId&&(t.statisticsId=Number(e.statisticsId)),e.pid&&(t.platId=e.pid)}function i(){return 1==PlatformManager.checkIsTWBSp()?"tw":1==PlatformManager.checkIsKRSp()?"kr":"cn"}function a(){return"0"}function n(){var e=!1;if(App.DeviceUtil.IsHtml5()||App.DeviceUtil.isRuntime2())for(var i=window.location.href,a=0;a<t.localCfg.length;a++){var n=t.localCfg[a];if(i.indexOf(n)>-1){e=!0;break}}else App.DeviceUtil.isWXgame()&&(e=!0);return e}function o(){var e=!1;if(App.DeviceUtil.IsHtml5())for(var i=window.location.href,a=0;a<t.testCfg.length;a++){var n=t.testCfg[a];if(i.indexOf(n)>-1){e=!0;break}}return e}function s(t){var e=new Array;if(t)for(var i=t.split("|"),a=0;a<i.length;a++){var n=new RewardItemVo;n.initData(i[a]),(Api.switchVoApi.checkOpenPrestige()||17!=n.type)&&e.push(n)}return e}function r(t){var e="";if(t)for(var i=t.split("|"),a=0;a<i.length;a++){var n=new RewardItemVo;n.initData(i[a]),e=""==e?n.message:e+" "+n.message}return e}function l(e,i,a){void 0===a&&(a=!1);var n=new BaseDisplayObjectContainer,o=BaseBitmap.create(e.iconBg);n.addChild(o),n.width=o.width,n.height=o.height;var s=BaseLoadBitmap.create(e.icon),r=e.icon.substr(0,13);if("servant_half_"==r&&s.setScale(100/180),10==e.type&&(o.texture=ResourceManager.getRes("itembg_7"),s.setScale(.5)),12==e.type&&(o.texture=ResourceManager.getRes("itembg_7"),s.setScale(.5)),16==e.type&&(o.texture=ResourceManager.getRes("itembg_7"),s.setScale(.5)),n.addChild(s),n.bindData=e,s.setPosition(4,3),12==e.type&&(s.x=0),e instanceof RewardItemVo&&e.num)if(15==e.type||14==e.type||16==e.type){var l=BaseBitmap.create("public_itemtipbg2");l.width=100,l.scaleY=22/l.height,l.setPosition(n.width/2-l.width/2,n.height-22),n.addChild(l);var h=LanguageManager.getlocal("itemName_"+e.type)+e.num;e.id>10&&(h=e.num.toString(),l.visible=!1);var d=ComponentManager.getTextField(h,TextFieldConst.FONTSIZE_CONTENT_SMALL);d.name="numLb",d.setPosition(o.width/2-d.width/2,o.height-3-d.height),n.addChild(d),e.id>10&&d.setPosition(o.width-3-d.width,o.height-3-d.height)}else{var d=ComponentManager.getTextField(e.num.toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL);d.name="numLb",d.setPosition(o.width-3-d.width,o.height-3-d.height),n.addChild(d)}if(i&&o.addTouchTap(function(t,e){ViewController.getInstance().openView(ViewConst.POPUP.ITEMINFOPOPUPVIEW,e)},t,[e instanceof RewardItemVo?e:e.id]),a){var g=1/.74,c=ComponentManager.getCustomMovieClip("itemeffect",10,100);c.x=s.x+50-198*g/2,c.y=s.y+52-197*g/2,n.addChild(c),c.scaleX=c.scaleY=g,c.playWithTime(-1)}return n}function h(e,i,a){void 0===a&&(a=!1);for(var n=new Array,o=t.formatRewardItem(e),s=0;s<o.length;s++){var r=t.getItemIcon(o[s],i,a);n.push(r)}return n}function d(t,e){return t?s(t+"_"+e+"_0")[0]:null}function g(t,e,i,a){return t?h(t+"_"+e+"_"+String(a?a:0),i)[0]:null}function c(e,i){var a=new BaseDisplayObjectContainer,n=BaseBitmap.create(i);a.addChild(n),n.name="iconBg";var o=BaseLoadBitmap.create(e,null,{callback:function(t){if(t){var e=t.getChildByName("iconBg"),i=t.getChildByName("icon");e&&i&&i.setPosition((e.width-i.width)/2,(e.height-i.height)/2)}},callbackThisObj:t,callbackParams:[a]});return a.addChild(o),o.name="icon",a}function p(){t.limitVipLv=null,t.closeSource=0/0,t.customerServiceData=null}t.curZoneID=1,t.curOldZoneID=null,t.tmpUserPassword="",t.statisticsId=0,t.curArea="CN-15001",t.client_ip="127.0.0.1",t.platId="",t.userId=null,t.access_token="0",t.logints=0,t.localCfg=["192.168","localhost","127.0.0.1","local-test-82.raygame3.com"],t.testCfg=["gt_test"],t.pauseSync=!1,t.lastAutoSyncTime=0,t.serverClientTimeDt=0,t.announcementData={},t.wbrewards=null,t.wanbaEvenyNumReport=3,t.kkkIsBindIos="0",t.chatlevel=4,t.nameLength=10,t.customerServiceData=null,t.formatGameInfo=e,t.getCountry=i,t.getCurPlatName=a,t.isLocal=n,t.isTest=o,t.formatRewardItem=s,t.getRewardsStr=r,t.getItemIcon=l,t.getRewardItemIcons=h,t.getRewardItemVoByIdAndType=d,t.getRewardItemIconByIdAndType=g,t.getIconContainer=c,t.dispose=p}(GameData||(GameData={}));var ResBar=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(t,e,i){"number"!=typeof t&&(t=ItemEnums[t]),this._type=t,this._bg=BaseBitmap.create("public_9_resbg"),this.addChild(this._bg);var a=BaseBitmap.create("public_icon"+this._type);if(this.addChild(a),this._numTxt=ComponentManager.getTextField(String(this.getResNum()),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this._numTxt.setPosition(50,this._bg.y+(this._bg.height-this._numTxt.height)/2),2==this._type){var n=Api.playerVoApi.getPlayerGoldStr();this._numTxt.text=n}if(1==this._type){var n=Api.playerVoApi.getPlayerGemStr();this._numTxt.text=n}this.addChild(this._numTxt),i&&(this._bg.width=i),e&&App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.refresh,this)},e.prototype.getResNum=function(){return Api.playerVoApi.getValueByResType(this._type)},e.prototype.refresh=function(){this._numTxt&&(this._numTxt.text=String(this.getResNum()))},e.prototype.setResNum=function(t){},e.prototype.dispose=function(){this._bg=null,this._numTxt=null,App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.refresh,this),t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(ResBar.prototype,"ResBar");var CircleProgressBar=function(t){function e(){var e=t.call(this)||this;return e._percentage=0,e}return __extends(e,t),e.prototype.init=function(t){this._bitmap=BaseBitmap.create(t),this.addChild(this._bitmap),this._shape=new egret.Shape,this._shape.x=this.width/2,this._shape.y=this.height/2,this.addChild(this._shape),this._bitmap.mask=this._shape,this._shape.rotation=90},e.prototype.setPercentage=function(t){this._shape.graphics.clear();var e=360*t/100;0>=e||(e>360&&(e=360),this._shape.graphics.beginFill(65535,1),this._shape.graphics.moveTo(this._bitmap.width/2,this._bitmap.height/2),this._shape.graphics.lineTo(this._bitmap.width,0),this._shape.graphics.drawArc(0,0,this._bitmap.width/2,0,e*Math.PI/180),this._shape.graphics.lineTo(0,0),this._shape.graphics.endFill())},e.prototype.dispose=function(){this._shape&&(this._shape=null),this._percentage=0,this._bitmap=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(CircleProgressBar.prototype,"CircleProgressBar");var LocalStorageConst;!function(t){t.LOCAL_USER_NAME="local_user_name",t.LOCAL_PASSWORD="local_password",t.LOCAL_CHALLENGE_STORY="local_challenge_story",t.LOCAL_SOUND_SWITCH="local_sound_switch",t.LOCAL_IMACY_RULE="local_imacy_rule"}(LocalStorageConst||(LocalStorageConst={}));var MessageConst;!function(t){t.MESSAGE_GAMECONFIG_LOADED="message_gameconfig_loaded",t.MESSAGE_SELECTED_SERVANT="message_selected_servant",t.MESSAGE_NOTICE_RESCHANGE_REFRESH_UI="message_notice_refresh_mainui",t.MESSAGE_NOTICE_HIDE_LAST_SCENE="message_notice_hide_last_scene",t.MESSAGE_NOTICE_MAINTASK_REFRESH_UI="message_notice_maintask_refresh_mainui",t.MESSAGE_NOTICE_ROOKIE_NEXT_STEP="message_notice_rookie_next_step",t.MESSAGE_NOTICR_REFRESH_RANKITEM="message_notice_refresh_rankitem",t.MESSAGE_NOTICR_ITEM_COMPOUND="message_notice_item_compound",t.MESSAGE_NOTICE_CHAT_COME="message_notice_chat_come",t.MESSAGE_NOTICE_SHOP_BUY="message_notice_shop_buy",t.MESSAGE_NOTICE_SHOW_LAMP="message_notice_show_lamp",t.MESSAGE_NOTICE_ADULT_CLICKMARRY="message_notice_adult_clickmarry",t.MESSAGE_NOTICE_MAIL_DETAIL="message_notice_mail_detail",t.MESSAGE_NOTICE_MAIL_REFRESH="message_notice_mail_refresh",t.MESSAGE_NOTICE_ADULT_REFUSEMARRY="message_notice_adult_refusemarry",t.MESSAGE_NOTICE_ADULT_CHOOSECHILD="message_notice_adult_choosechild",t.MESSAGE_NOTICE_ADULT_CHILDMARRY="message_notice_adult_childmarry",t.MESSAGE_NOTICE_ADULT_REFRESHCHILDMARRY="message_notice_adult_refreshchildmarry",t.MESSAGE_NOTICE_ADULT_REFRESHADULTVIEW="message_notice_adult_refreshadultview",t.MESSAGE_NOTICE_REFRESHSIGN_AFTER_EDIT="message_notice_refreshsign_after_edit",t.MESSAGE_NOTICE_SELECT_SERVERLIST="message_notice_select_serverlist",t.MESSAGE_NOTICE_WELFARE_SIGNIN="message_notice_welfare_signin",t.MESSAGE_NOTICE_ACH_GETREWARD="message_notice_ach_getreward",t.MESSAGE_NOTICE_ACH_GETDETAILREWARD="message_notice_ach_getdetailreward",t.MESSAGE_NOTICE_ACH_REFRESHLIST="message_notice_ach_refreshlist",t.MESSAGE_NOTICE_ACTIVITY_LIMITEDREWARD="message_notice_activity_limitedreward",t.MESSAGE_NOTICE_DINNER="message_notice_dinner",t.MESSAGE_MODEL_USERINFO="userinfo",t.MESSAGE_MODEL_ITEM="item",t.MESSAGE_MODEL_SERVANT="servant",t.MESSAGE_MODEL_WIFE="wife",t.MESSAGE_MODEL_WIFESKIN="wifeskin",t.MESSAGE_MODEL_CHILD="child",t.MESSAGE_MODEL_ADULT="adult",t.MESSAGE_MODEL_SHOP="shop",t.MESSAGE_MODEL_CHALLENGE="challenge",t.MESSAGE_MODEL_SEARCH="search",t.MESSAGE_MODEL_MANAGE="manage",t.MESSAGE_MODEL_MAINTASK="maintask",t.MESSAGE_MODEL_DAILYTASK="dailytask",t.MESSAGE_MODEL_ACHIEVEMENT="achievement",t.MESSAGE_MODEL_ARRIVAL="arrival",t.MESSAGE_MODEL_OTHERINFO="otherinfo",t.MESSAGE_MODEL_SWITCH="switch",t.MESSAGE_MODEL_MYMAIL="mymail",t.MESSAGE_MODEL_DINNER="dinner",t.MESSAGE_MODEL_ACTIVITY="activity",t.MESSAGE_MODEL_PAYMENT="payment",t.MESSAGE_MODEL_ALLIANCE="alliance",t.MESSAGE_REFRESH_MODE="message_mode_refresh",t.MESSAGE_MODEL_PRESTIGE="prestige",t.MESSAGE_PLAT_LOGIN_SUCCESS="message_plat_login_success",t.MESSAGE_NOTICE_WIFE_GIVE="message_notice_wife_give",t.MESSAGE_NOTICE_WIFE_SKILLUPD="message_notice_wife_skillupd",t.MESSAGE_REFRESH_SERVANT_ITEMLIST="message_refresh_servant_itemlist",t.MESSAGE_REFRSH_SERVANT_ITEM_USE="message_refresh_servant_itemUse",t.MESSAGE_NOTICE_PUNISH_BUYITEM="message_notice_punish_buyitem",t.MESSAGE_NOTICE_PUNISH_EXITEM="message_notice_punish_exitem",t.MESSAGE_REFRESH_ITEMVIEWTAB2="message_refresh_itemviewtab2",t.MESSAGE_ALLIANCE_APPLYALLIANCE="message_alliance_applyalliance",t.MESSAGE_ALLIANCE_CANCELAPPLYALLIANCE="message_alliance_cancelapplyalliance",t.MESSAGE_ALLIANCE_REFUSEAPPLY="message_alliance_refuseapply",t.MESSAGE_ALLIANCE_AGREEAPPLY="message_alliance_agreeapply",t.MESSAGE_RESET_ATKRACE="message_reset_atkrace",t.MESSAGE_RESET_ATKRACECROSS="message_reset_atkracecross",t.MESSAGE_ATKRACECROSS_FIGHTEND="message_atkracecross_fightend",t.MESSAGE_ALLIANCE_TRANSFER="message_alliance_transfer",t.MESSAGE_ALLIANCE_EXITALLIANCE="message_alliance_exitalliance",t.MESSAGE_ALLIANCE_BEJOIN="message_alliance_bejoin",t.MESSAGE_MESSAGE_ALLIANCE_BEKICK="message_alliance_bekick",t.MESSAGE_STUDYATK_FINISH="message_studyatk_finish",t.MESSAGE_ALLIANCE_DISBAND="message_alliance_disband",t.MESSAGE_NOTICE_ALLIANCE_BUILD="message_notice_alliance_build",t.MESSAGE_NOTICE_ALLIANCE_BOSSITEM="message_notice_alliance_bossitem",t.MESSAGE_NOTICE_LOGOUT="message_notice_logout",t.MESSAGE_NOTICE_CHANGE_IMG="message_notice_change_img",t.MESSAGE_NOTICE_RSDK_INIT_SUCCESS="message_notice_rsdk_init_success",t.MESSAGE_NOTICE_RESFESH_DAILYTASK_AFTER_SYNC="message_notice_refresh_dailytask_afrer_sync",t.MESSAGE_NOTICE_GUIDE_NEXT="message_notice_guide_next",t.MESSAGE_NOTICE_GUIDE_SHOWHAND="message_notice_guide_showhand",t.MESSAGE_RECHARFGE_RE="message_recharfge_re",t.MESSAGE_CLOSE_BLACKPANEL="message_close_blackPanel",t.MESSAGE_CHILD_GUIDE="message_child_guide",t.MESSAGE_DINNER_GUIDE="message_dinner_guide",t.MESSAGE_REFRESH_TRADE_AFTER_FIGHT="message_refresh_trade_after_fight",t.MESSAGE_WANBA_SHARE_SUCCESS="message_wanba_share_success",t.MESSAGE_NOTICE_TWLOGIN="message_notice_twlogin",t.MESSAGE_NOTICE_BIND="message_notice_bind",t.MESSAGE_NOTICE_REFRESH_SPECIAL_AVATAR="message_notice_refresh_special_avatar",t.MESSAGE_IOS_BINDPHONE="message_ios_bindphone",t.MESSAGE_NOTICE_LOGINBG_LOAD_COMPLETE="message_notice_loginbg_load_complete",t.MESSAGE_RECHARFGE_BOX_TIMEOUT="message_recharfge_box_timeout",t.MESSAGE_REFRESH_RECHARGE_VIEW="message_refresh_recharge_view",t.MESSAGE_REFRESH_YEARCARD_VIEW="message_refresh_yearcard_view",t.MESSAGE_REFRESH_FUNCTION_TXT="message_refresh_function_txt",t.MESSAGE_REFRESH_SKIN_HEADBG="message_refresh_skin_headbg",t.MESSAGE_CLOSE_POPUPVIEW="message_close_popupview",t.MESSAGE_CANCEBLOCK="message_canceblock",t.MESSAGE_WIFE_LOVECOM="message_wife_lovecom",t.MESSAGE_WISHTRER_NEXTDAY="message_wishtree_nextday",t.MESSAGE_SHOP_NEXTDAY="message_shop_nextday",t.MESSAGE_CHECKNPC_SHOW="message_checknpc_show",t.MESSAGE_ACCARNIVAL_CHANGE_CHARGE="message_accarnival_change_charge",t.MESSAGE_ACCARNIVAL_CHANGE_COST="message_accarnival_change_cost",t.MESSAGE_ACWIFECOME_VOCHANGE="message_acwifecome_vochange",t.MESSAGE_DAILYCHARGE_REFRESH_V="message_dailycharge_refresh_v",t.MESSAGE_MAYDAY_FRESH_ITEM="message_mayday_fresh_item",t.MESSAGE_MAYDAY_FRESHTURNTABLE="message_mayday_freshturntable",t.MESSAGE_REALNAME="message_realname",t.MESSAGE_NOTICE_RESFESH_NEWYEAR_ITEM="message_notice_refresh_newyear_item",t.MESSAGE_RESFESH_NEWYEAR_LIST="message_refresh_newyear_list",t.MESSAGE_RESFESH_SPRING_ITEM="message_refresh_spring_item",t.RESFESH_SPRING_TAB="refresh_spring_tab",t.MESSAGE_RESFESH_SPRING_TAB="message_refresh_spring_TAB",t.MESSAGE_RESFESH_NEWYEAR_REDHOT="message_refresh_newyear_redhot"}(MessageConst||(MessageConst={}));var NetPushConst;!function(t){t.PUSH_PAY="push.pay"}(NetPushConst||(NetPushConst={}));var NetRequestConst;!function(t){t.REQUEST_CLIENT_CHAT="request_client_chat",t.REQUEST_USER_LOGIIN="user.login",t.HTTP_GETACCESS_TOKEN="getToken",t.REQUEST_USER_SYNC="user.sync",t.REQUEST_UPGRADE_SERVANT="servant.upgrade",t.REQUEST_UPGRADE_SERVANT_TEN="servant.upgradeten",t.REQUEST_WIFE_CALL="wife.call",t.REQUEST_WIFE_RECOVERENERGY="wife.recoverenergy",t.REQUEST_WIFE_LOVE="wife.love",t.REQUEST_WIFE_AWARD="wife.award",t.REQUEST_WIFE_UPGRADESKILL="wife.upgradeskill",t.REQUEST_USE_ITEM="item.use",t.REQUEST_ITEM_TITLE="item.title",t.REQUEST_SHOP_BUY_ITEM="shop.buyitem",t.REQUEST_SHOP_GETSHOPCFG="shop.getshopcfg",t.REQUEST_ACTIVITY_EXCHANGEFOURPEOPLE="activity.exchangefourpeople",t.REQUEST_PRISON_PUNISH="prison.punish",t.REQUEST_SHOP_FIRSTCHARGEREWARD="shop.firstchargereward",t.REQUEST_SEARCH_PLAY="search.play",t.REQUEST_SEARCH_PILL="search.pill",t.REQUEST_CHALLENGE_ATTACK="challenge.attack",t.REQUEST_CHALLENGE_RECOVER="challenge.recover",t.REQUEST_CHALLENGE_AUTOATTACK="challenge.autoattack",t.REQUEST_CHILD_ADDPOSNUM="child.addposnum",t.REQUEST_CHILD_RENAME="child.rename",t.REQUEST_CHILD_TRAIN="child.train",t.REQUEST_CHILD_AUTOTRAIN="child.autotrain",t.REQUEST_CHILD_AUTORECOVER="child.autorecover",t.REQUEST_CHILD_RECOVER="child.recover",t.REQUEST_CHILD_EXAMINATION="child.examination",t.REQUEST_MANAGE_DEALAFFAIR="manage.dealaffair",t.REQUEST_MANAGE_ADDAFFAIR="manage.addaffair",t.REQUEST_MANAGE_DEALFINANCE="manage.dealfinance",t.REQUEST_MANAGE_BATCHDEALFINANCE="manage.batchdealfinance",t.REQUEST_MANAGE_ADDFINANCE="manage.addfinance",t.REQUEST_TASK_GETMAINTASK="task.getmaintask",t.REQUEST_TASK_GETDAILYTASK="task.getdailytask",t.REQUEST_TASK_GETLIVENESS="task.getliveness",t.REQUEST_MANAGE_AUTOFINANCE="manage.autofinance",t.REQUEST_MANAGE_GETAUTOANDFINANCE="manage.getautoandfinance",t.REQUEST_USER_UPGRADE="user.upgrade",t.REQUEST_USER_CHECKNAME="user.checkname",t.REQUEST_USER_CHANGENAME="user.changename",t.REQUEST_USER_CREATEUSER="user.createuser",t.REQUEST_CHAT_ENCRYPT="chat.encrypt",t.REQUEST_RANK_INDEX="rank.index",t.REQUEST_RANK_VISIT="rank.visit",t.REQUEST_RANK_USERSHOT="rank.usershot",t.REQUEST_RADULT_PROPOSE="adult.propose",t.REQUEST_RADULT_PROPOSEALL="adult.proposeall",t.REQUEST_RADULT_GETPROPOSEE="adult.getpropose",t.REQUEST_RADULT_GETALLPROPOSE="adult.getallpropose",t.REQUEST_RADULT_AGREEPROPOSE="adult.agreepropose",t.REQUEST_RADULT_CANCELPROPOSE="adult.cancelpropose",t.REQUEST_RADULT_REFUSEPROPOSE="adult.refusepropose",t.REQUEST_RADULT_GETADULTINFO="adult.getadultinfo",t.REQUEST_DAILYTASK_GET="task.getdailytask",t.REQUEST_DAILYLIVENESS_GET="task.getliveness",t.REQUEST_DAILYTASK_GETLIVENESS="task.getliveness",t.REQUEST_MAIL_GET_MYMAILLIST="mail.getmymaillist",t.REQUEST_MAIL_GET_DETAIL="mail.getdetail",t.REQUEST_MAIL_GET_REWARDS="mail.getrewardsbymail",t.REQUEST_PALACE_GETPALACEINFO="palace.getpalaceinfo",t.REQUEST_PALACE_GETSALARY="palace.getsalary",t.REQUEST_PALACE_SIGN="palace.sign",t.REQUEST_DINNER_GETDINNER="dinner.getdinner",t.REQUEST_DINNER_GETDINNERDETAIL="dinner.getdinnerdetail",t.REQUEST_DINNER_JOINDINNER="dinner.joindinner",t.REQUEST_DINNER_CREATDINNER="dinner.createdinner",t.REQUEST_DINNER_CANVIEWDINNER="dinner.canviewdinner",t.REQUEST_DINNER_FEFRESHITEM="dinner.refreshitem",t.REQUEST_DINNER_SHOPITEM="dinner.shopitem",t.REQUEST_DINNER_SCOREDINNER="dinner.scoretoitem",t.REQUEST_DINNER_HISTORY="dinner.history",t.REQUEST_DINNER_TOP="dinner.top",t.REQUEST_DINNER_SHAREDINNER="dinner.sharedinner",t.REQUEST_DINNER_USEITEM="dinner.useitem",t.REQUEST_USER_ARRIVAL="user.arrival",t.REQUEST_ACTIVITY_GETACTIVECFG="activity.getactivecfg",t.REQUEST_ACHIEVEMENT_GETREWARDS="achievement.getrewards",t.REQUEST_PAY_RROCCESSPAYMENT="pay.processpayment",t.REQUEST_ACTIVITY_GETRANKACTIVE="activity.getrankactive",t.REQUEST_RECHARGE_GETDAILYREWARD="activity.getdailychargereward",t.REQUEST_RECHARGE_GETTOTALDAILYREWARD="activity.gettotaldayrechargereward",t.REQUEST_RECHARGE_GETTOTALREWARD="activity.gettotalrechargereward",t.REQUEST_ACTIVITY_GETCARNIVALCHARGE="activity.getcarnivalcharge",t.REQUEST_ACTIVITY_GETCARNIVALCOST="activity.getcarnivalcost",t.REQUEST_ACTIVITY_GETWIFECOMEREWARD="activity.getwifecomereward",t.REQUEST_ACTIVITY_GETLIMITEDREWARD="activity.getlimitedreward",t.REQUEST_VIP_VIPWELFARE="shop.vipwelfare",t.REQUEST_USER_EXCHANGECARD="user.exchangecard",t.REQUEST_SERVANT_UPABILITY="servant.upability",t.REQUEST_SERVANT_UPSKILL="servant.upskill",t.REQUEST_ACTIVITY_GETPUNISHACTIVE="activity.getpunishactive",t.ACTIVITY_BUYVIPSHOP="activity.buyvipshop",t.ACTIVITY_GETSPRINGITEMA="activity.getspringitema",t.ACTIVITY_GETSPRINGITEMB="activity.getspringitemb",t.ACTIVITY_GETSPRINGITEMC="activity.getspringitemc",t.ACTIVITY_GETSPRINGITEMD="activity.getspringitemd",t.REQUEST_ACTIVITY_BUYPUNISHITEM="activity.buypunishitem",t.REQUEST_ACTIVITY_USEPUNISHITEM="activity.usepunishitem",t.REQUEST_ACTIVITY_BUYPUNISHSHOP="activity.buypunishshop",t.REQUEST_ACTIVITY_GETPUNISHREWARD="activity.getpunishreward",t.REQUEST_ACTIVITY_GETNEWYEARREWARD="activity.getnewyearreward",t.REQUEST_ACTIVITY_BUYNEWYEARGIFT="activity.buynewyeargift",t.REQUEST_OTHERINFO_GETUNLOCKLISTREWARD="otherinfo.getunlocklistreward",t.REQUEST_OTHERINFO_GETCERTIFICATION="otherinfo.getcertification",t.REQUEST_SERVANT_UPAURA="servant.upaura",t.REQUEST_SERVANT_CHANGE="servant.change",t.REQUEST_SEARCH_SET="search.set",t.REQUEST_SEARCH_BUY="search.buy",t.REQUEST_ATKRACE_INDEX="atkrace.index",t.REQUEST_ATKRACE_ATTRBUY="atkrace.attrbuy",t.REQUEST_ATKRACE_FIGHT="atkrace.fight",t.REQUEST_ATKRACE_REVENGE="atkrace.revenge",t.REQUEST_ATKRACE_KILL="atkrace.kill",t.REQUEST_ATKRACE_CHALLENGE="atkrace.challenge",t.REQUEST_ATKRACE_RANDREWARD="atkrace.randreward",t.REQUEST_ATKRACE_GETINFO="atkrace.getinfo",t.REQUEST_ATKRACE_LIST="atkrace.list",t.REQUEST_ATKRACE_RANK="atkrace.rank",t.REQUEST_ATKRACE_HANDLE="atkrace.handle",t.REQUEST_ATKRACE_ATTRBUYLIST="atkrace.attrlist",t.REQUEST_ATKRACE_GETMODEL="atkrace.getmodel",t.REQUEST_ATKRACE_USEEXTRA="atkrace.useextra",t.REQUEST_ATKRACE_REFRESH="atkrace.refresh",t.REQUEST_ATKRACECROSS_INDEX="atkraceg.index",t.REQUEST_ATKRACECROSS_ATTRBUY="atkraceg.attrbuy",t.REQUEST_ATKRACECROSS_FIGHT="atkraceg.fight",t.REQUEST_ATKRACECROSS_REVENGE="atkraceg.revenge",t.REQUEST_ATKRACECROSS_KILL="atkraceg.kill",t.REQUEST_ATKRACECROSS_CHALLENGE="atkraceg.challenge",t.REQUEST_ATKRACECROSS_RANDREWARD="atkraceg.randreward",t.REQUEST_ATKRACECROSS_GETINFO="atkraceg.getinfo",t.REQUEST_ATKRACECROSS_LIST="atkraceg.list",t.REQUEST_ATKRACECROSS_RANK="atkraceg.rank",t.REQUEST_ATKRACECROSS_HANDLE="atkraceg.handle",t.REQUEST_ATKRACECROSS_ATTRBUYLIST="atkraceg.attrlist",t.REQUEST_ATKRACECROSS_GETMODEL="atkraceg.getmodel",t.REQUEST_ATKRACECROSS_USEEXTRA="atkraceg.useextra",t.REQUEST_ATKRACECROSS_REFRESH="atkraceg.refresh",t.REQUEST_ATKRACECROSS_GETACTIVITYATK="atkraceg.getactivityatk",t.REQUEST_ITEM_GETCOMPOSE="item.getcompose",t.REQUEST_ITEM_GETMODEL="item.getmodel",t.REQUEST_ITEM_DOCOMPOSE="item.docompose",t.REQUEST_ALLIANCE_INITALLIANCE="alliance.initalliance",t.REQUEST_ALLIANCE_CREATEALLIANCE="alliance.createalliance",t.REQUEST_ALLIANCE_JOINRANDALLIANCE="alliance.joinrandalliance",t.REQUEST_ALLIANCE_FINDALLIANCE="alliance.findalliance",t.REQUEST_ALLIANCE_GETALLIANCELIST="alliance.getalliancelist",t.REQUEST_ALLIANCE_APPLYALLIANCE="alliance.applyalliance",t.REQUEST_ALLIANCE_CANCELAPPLY="alliance.cancelapply",t.REQUEST_ALLIANCE_ACCEPT="alliance.accept",t.REQUEST_ALLIANCE_REFUSEAPPLY="alliance.refuseapply",t.REQUEST_ALLIANCE_REFUSEALLAPPLY="alliance.refuseallapply",t.REQUEST_ALLIANCE_RENAME="alliance.rename",t.REQUEST_ALLIANCE_MODINFO="alliance.modinfo",t.REQUEST_ALLIANCE_SETSWITCH="alliance.setswitch",t.REQUEST_ALLIANCE_EXITALLIANCE="alliance.exitalliance",t.REQUEST_ALLIANCE_GETALLIANCEAPPLY="alliance.getallianceapply",t.REQUEST_ALLIANCE_GETMEMBER="alliance.getmember",t.REQUEST_ALLIANCE_SETPOS="alliance.setpos",t.REQUEST_ALLIANCE_GETDETAILS="alliance.getdetails",t.REQUEST_ALLIANCE_TRANSFER="alliance.transfer",t.REQUEST_ALLIANCE_KICKALLIANCE="alliance.kickalliance",t.REQUEST_ALLIANCE_DISBAND="alliance.disband",t.REQUEST_ALLIANCE_DONATE="alliance.donate",t.REQUEST_ALLIANCE_SHOPBUY="alliance.shopbuy",t.REQUEST_ALLIANCE_ATTACK="alliance.attack",t.REQUEST_ALLIANCE_OPENBOSS="alliance.openboss",t.REQUEST_ALLIANCE_RECOVER="alliance.recover",t.REQUEST_ALLIANCE_GETBOSSLOG="alliance.getbosslog",t.REQUEST_ALLIANCE_GETBOSSRANK="alliance.getbossrank",t.REQUEST_BOOKROOM_STUDY="bookroom.study",t.REQUEST_BOOKROOM_FINISH="bookroom.finish",t.REQUEST_BOOKROOM_BUY="bookroom.buy",t.REQUEST_STUDYATK_INDEX="studyatk.index",t.REQUEST_STUDYATK_CREATE="studyatk.create",t.REQUEST_STUDYATK_JOIN="studyatk.join",t.REQUEST_STUDYATK_GOAWAY="studyatk.goaway",t.REQUEST_STUDYATK_GETATKDETAIL="studyatk.getatkdetail",t.REQUEST_STUDYATK_GETATK="studyatk.getatk",t.REQUEST_STUDYATK_UPGRADE="studyatk.upgrade",t.REQUEST_DAILYBOSS_GET="dailyboss.get",t.REQUEST_DAILYBOSS_BUY="dailyboss.buy",t.REQUEST_DAILYBOSS_GETRANK="dailyboss.getrank",t.REQUEST_DAILYBOSS_GETDETAILS="dailyboss.getdetails",t.REQUEST_DAILYBOSS_ATTACK="dailyboss.attack",t.REQUEST_DAILYBOSS_RECOVER="dailyboss.recover",t.REQUEST_DAILYBOSS_GETATTACKRANK="dailyboss.getattackrank",t.REQUEST_OTHERINFO_GETWBSENDREWARD="otherinfo.getwbsendreward",t.REQUEST_OTHERINFO_GETWBDAILYSHAREREWARD="otherinfo.getwbdailysharereward",t.REQUEST_OTHERINFO_GETBINDREWARD="otherinfo.getbindreward",t.REQUEST_OTHERINFO_GETAUTHOR3KREWARD="otherinfo.getauthor3kreward",t.REQUEST_USER_CHANGEPIC="user.changepic",t.REQUEST_USER_STEPGUILD="user.stepguild",t.REQUEST_CONQUEST_INDEX="conquest.index",t.REQUEST_CONQUEST_FIGHT="conquest.fight",t.REQUEST_CONQUEST_RANK="conquest.rank",t.REQUEST_CONQUEST_BATCHFIGHT="conquest.batchfight",t.REQUEST_TRADE_INDEX="trade.index",t.REQUEST_TRADE_FIGHT="trade.fight",t.REQUEST_TRADE_RANK="trade.rank",t.REQUEST_TRADE_BATCHFIGHT="trade.batchfight",t.REQUEST_OTHERINFO_GETCANDYREWARD="otherinfo.getcandyreward",t.REQUEST_OTHERINFO_GETFKFOCUSREWARD="otherinfo.getfkfocusreward",t.REQUEST_OTHERINFO_FKSHARE="otherinfo.fkshare",t.REQUEST_OTHERINFO_GETFKSHAREREWARD="otherinfo.getfksharereward",t.REQUEST_OTHERINFO_GETWBSCOREREWARD="otherinfo.getwbscorereward",t.REQUEST_USER_NEWERGUILD="user.newerguild",t.REQUEST_OTHER_RECORDSERVANTSORT="otherinfo.recordservantsort",t.REQUEST_OTHER_ACTIVITY_USETAILOR="activity.usetailor",t.REQUEST_OTHER_ACTIVITY_USETENTAILOR="activity.usetentailor",t.REQUEST_OTHER_ACTIVITY_EXCHANGE_SKIN="activity.exchangeskin",t.REQUEST_WIFE_EQUIP="wife.equip",t.REQUEST_WIFE_READSKINRED="wife.readskinred",t.REQUEST_ATKRACEG_WINZIDREWARD="atkraceg.winzidreward",t.REQUEST_INVITE_GETINVITEREWARD="invite.getinvitereward",t.REQUEST_INVITE_GETPOWERREWARD="invite.getpowerreward",t.REQUEST_INVITE_GETRECHARGEREWARD="invite.getrechargereward",t.REQUEST_INVITE_GETINFO="invite.getinfo",t.REQUEST_CHAT_LIST="chat.list",t.REQUEST_CHAT_BLOCK="chat.block",t.REQUEST_CHAT_UNBLOCK="chat.unblock",t.REQUEST_ACTIVITY_EXCHANGEWIFE="activity.exchangewife",t.REQUEST_USER_GETKFMSG="user.getkfmsg",t.REQUEST_USER_GETKFCARDMSG="user.getkfcardmsg",t.REQUEST_PALACE_GETCROSSPALACE="palace.getcrosspalace",t.REQUEST_PALACE_GETPALACERANK="palace.getpalacerank",t.REQUEST_PRESTIGE_INDEX="prestige.index",t.REQUEST_OTHERINFO_SETCOVER="otherinfo.setcover",t.REQUEST_OTHERINFO_GETCOVERREWARD="otherinfo.getcoverreward",t.REQUEST_OTHERINFO_GETGTFBREWARD="otherinfo.getgtfbreward",t.REQUEST_ACTIVITY_GETMAYDAYITEMA="activity.getmaydayitema",t.REQUEST_ACTIVITY_GETMAYDAYITEMB="activity.getmaydayitemb",t.REQUEST_ACTIVITY_GETMAYDAYITEMC="activity.getmaydayitemc",t.REQUEST_ACTIVITY_GETMAYDAYRANK="activity.getmaydayrank",t.REQUEST_ACTIVITY_GETMAYDAYLOTTERY="activity.getmaydaylottery",t.REQUEST_REQUEST_INDEX="practice.index",t.REQUEST_REQUEST_UPGRADE="practice.upgrade",t.REQUEST_REQUEST_UNLOCK="practice.unlock",t.REQUEST_REQUEST_COLLECT="practice.collect",t.REQUEST_WIFESTATUS_CONFER="wifestatus.confer",t.REQUEST_WIFESTATUS_AUTOCONFER="wifestatus.autoconfer",t.REQUEST_ACTIVITY_CROSSIMACY_PRANK="imacy.prank",t.REQUEST_ACTIVITY_CROSSIMACY_ZRANK="imacy.zrank",t.REQUEST_ACTIVITY_CROSSIMACY_AWARD="imacy.winzidreward",t.REQUEST_REQUEST_BUY="practice.buy"}(NetRequestConst||(NetRequestConst={}));var CollectEffect=function(t){function e(){var e=t.call(this)||this;return e._bitmapList=[],e._maxNum=20,e._numCount=0,e}return __extends(e,t),e.prototype.start=function(t,e,i,a,n,o){this._startPoint=e,this._endPoint=i,this._numCount=0,this._callback=a,this._callbackThisObj=n,this._callbackParams=o,App.DisplayUtil.addFactorFunc(BaseBitmap);for(var s=0;s<this._maxNum;s++){var r=BaseBitmap.create(t);r.alpha=0;var l=Math.max(0,Math.min(e.x,i.x)-100),h=Math.min(GameConfig.stageWidth,Math.max(e.x,i.x)+100),d=l+Math.random()*(h-l),g=Math.random()>.5?1:-1,c=e.y+g*Math.random()*30;r.setPosition(d,c),r.tweenMoveList=[egret.Point.create(r.x,r.y),egret.Point.create(i.x,r.y),egret.Point.create(i.x,i.y)],egret.Tween.get(r).to({alpha:1},300+200*Math.random()).call(this.startMove,this),GameConfig.stage.addChild(r),this._bitmapList.push(r)}},e.prototype.startMove=function(){var t=this;if(this._numCount++,this._numCount==this._maxNum)for(var e=this._bitmapList.length,i=e-1;i>=0;i--)egret.Tween.removeTweens(this._bitmapList[i]),egret.Tween.get(this._bitmapList[i]).wait(10+300*Math.random()).to({factor:1},600).call(function(e){e.dispose(),e.tweenMoveList=void 0,BaseBitmap.release(e),t._bitmapList.splice(i,1),t._numCount--,0==t._numCount&&(t._callback&&t._callback.apply(t._callbackThisObj,t._callbackParams),t._callback=null,t._callbackThisObj=null,t._callbackParams=null)}.bind(this,this._bitmapList[i]))},e.prototype.dispose=function(){},e}(BaseClass);__reflect(CollectEffect.prototype,"CollectEffect");var RewardItemConst;!function(t){t.TYPE_GEM=1,t.TYPE_GOLD=2,t.TYPE_FOOD=3,t.TYPE_SOLDIER=4,t.TYPE_EXP=5,t.TYPE_ITEM=6,t.TYPE_SERVANT_ATTR=7,t.TYPE_SERVANT=8,t.TYPE_INTIMACY=9,t.TYPE_LIVENESS=10,t.TYPE_TITLE=11}(RewardItemConst||(RewardItemConst={}));var SceneConst;!function(t){t.SCENE_HOME="HomeScene",t.SCENE_CITY="CityScene"}(SceneConst||(SceneConst={}));var SoundConst;!function(t){t.MUSIC_HOME="music_home",t.MUSIC_CHALLENGE="music_challenge",t.MUSIC_ROOKIE_STORY="music_rookie_story",t.MUSIC_LOGIN="music_login",t.MUSIC_PALACE="music_palace",t.EFFECT_CLICK="effect_click",t.EFFECT_DROP="effect_drop",t.EFFECT_FLYUP="effect_flyup",t.EFFECT_WEIWU="effect_weiwu",t.EFFECT_BATTLE_ATTACK1="effect_battle_attack1",t.EFFECT_BATTLE_ATTACK2="effect_battle_attack2",t.EFFECT_BATTLE_FAIL="effect_battle_fail",t.EFFECT_BATTLE_WIN="effect_battle_win",t.EFFECT_BATTLE_START="effect_battle_start",t.EFFECT_BATTLE="effect_battle",t.EFFECT_BATTLE_HIT="effect_battle_hit",t.EFFECT_DAILYBOSS_FIRE="effect_dailyboss_fire",t.EFFECT_DAILYBOSS_HIT="effect_dailyboss_hit",t.EFFECT_WIFE="effect_wife",t.EFFECT_WIFE_LOVE="effect_wife_love",t.EFFECT_SHOWTIP="effect_showtip",t.EFFECT_UPD="effect_upd",t.EFFECT_MANAGE="effect_manage",t.EFFECT_GETCHILD="effect_getchild",t.EFFECT_DAUGHTER_3AGE="effect_daughter_3age",t.EFFECT_DAUGHTER_8AGE="effect_daughter_8age",t.EFFECT_SON_3AGE="effect_son_3age",t.EFFECT_SON_8AGE="effect_son_8age",t.EFFECT_PRISON_HIT="effect_prison_hit"}(SoundConst||(SoundConst={}));var ComponentManager;!function(t){function e(t,e,i,a,n,o){var s=TextFieldConst.FONTSIZE_BUTTON_COMMON,r=TextFieldConst.COLOR_WHITE;switch(t){case ButtonConst.BTN_SMALL_BLUE:case ButtonConst.BTN_SMALL_YELLOW:case ButtonConst.BTN_SMALL_RED:s=TextFieldConst.FONTSIZE_CONTENT_COMMON;break;default:s=TextFieldConst.FONTSIZE_BUTTON_COMMON}r=0;var l=new BaseButton;return l.init(t,e,i,a,n,s,o),l.setColor(r),l}function i(t,e,i,a,n){var o=TextFieldConst.COLOR_BLACK,s=TextFieldConst.COLOR_BLACK,r=new TabBarGroup;return r.init(t,e,i,a,n),r.setColor(o,s),r}function a(t,e,i){var a=new ProgressBar;return a.init(t,e,i),a}function n(t,e,i){var a=new CustomMovieClip,n=[];if(t&&e){for(var o=1;e>=o;o++)n.push(t+o);
a.frameImages=n}return a.playFrameRate=i,a}function o(t,e){var i=new ScrollView;return i.setContent(t),i.width=e.width,i.height=e.height,i.x=e.x,i.y=e.y,i}function s(t,e,i){var a=new BaseTextField;return a.text=t,a.size=e,i&&a.setColor(i),a}function r(t,e,i){var a=new ScrollList;return a.init(t,e,i),a}function l(t,e,i,a,n,o,s){void 0===s&&(s=1);var r=new DragProgressBar;return r.init(t,e),r.setDragPercent(s,i,s),r.setCallBack(a,n,o),r}function h(t,e){var i=new BaseBitmapText;return i.font=ResourceManager.getRes(e),i.text=t,i}function d(t){var e=new CircleProgressBar;return e.init(t),e}function g(t){var e=new CheckBox;return e.init(t),e}function c(t,e,i){var a=new ResBar;return a.init(t,e,i),a}function p(t,e,i,a,n,o,s,r){var l=new BaseDisplayObjectContainer,h=new BaseTextField;l.addChild(h),h.name="textField",h.textColor=t,h.size=e;var d=BaseBitmap.create(n);return d.width=i,d.height=a,l.addChild(d),h.type=egret.TextFieldType.INPUT,h.size=e,h.width=i-10,h.x=d.x+d.width/2-h.width/2,h.y=d.y+d.height/2-e/2,l.addChild(h),r&&""!=r?h.bindData=!0:h.bindData=!1,o&&(r&&""!=r?h.text=r:(h.text=o,h.textColor=s),h.addEventListener(egret.FocusEvent.FOCUS_IN,function(e){0==h.bindData&&(h.text="",h.textColor=t)},null),h.addEventListener(egret.FocusEvent.FOCUS_OUT,function(t){""==h.text?(h.bindData=!1,h.text=o,h.textColor=s):h.bindData=!0},null)),l}t.getButton=e,t.getTabBarGroup=i,t.getProgressBar=a,t.getCustomMovieClip=n,t.getScrollView=o,t.getTextField=s,t.getScrollList=r,t.getDragProgressBar=l,t.getBitmapText=h,t.getCircleProgressBar=d,t.getCheckBox=g,t.getResBar=c,t.getInputTextField=p}(ComponentManager||(ComponentManager={}));var ViewConst;!function(t){var e;!function(t){t.PLAYERVIEW="PlayerView",t.ITEMVIEW_TAB1="ItemView",t.ITEMVIEW_TAB2="ItemView|1",t.ITEMVIEW_TAB3="ItemView|2",t.WIFEVIEW_TAB1="WifeView|1",t.WIFEVIEW_TAB2="WifeView|2",t.WIFEUNLOCKVIEW="WifeUnLockView",t.WIFESTATUSVIEW="WifestatusView",t.MANAGEVIEW="ManageView",t.CHALLENGEVIEW="ChallengeView",t.SERVANTVIEW="ServantView",t.SERVANTINFOVIEW="ServantInfoView",t.PROMOTIONVIEW="PromotionView",t.PROMOTIONSUCCESSVIEW="PromotionSuccessView",t.AFFAIRVIEW="AffairView",t.WIFEOPTVIEW="WifeOptView",t.CHILDVIEW="ChildView",t.GUIDECREATEUSERVIEW="GuideCreateUserView",t.RANKVIEW="RankView",t.CHATVIEW="ChatView",t.CHATVIEWTAB1="ChatView|1",t.ADULTVIEW="AdultView",t.SHOPVIEW_TAB1="ShopView",t.SHOPVIEW_TAB2="ShopView|1",t.SHOPVIEW_TAB3="ShopView|2",t.ADULTMARRYVIEW="AdultMarryView",t.DAILYTASKVIEW="DailyTaskView",t.VIPVIEW="VipView",t.WELFAREVIEWFIRSTRECHARGE="WelfareView|FirstRecharge",t.WELFAREVIEWOFFICIALWECHAT="WelfareView|OfficialWeChat",t.WELFAREVIEWSIGNIN="WelfareView|Signin",t.WELFAREVIEWREALNAME="WelfareView|Realname",t.WELFAREVIEWFUNCTIONPREVIEW="WelfareView|FunctionPreview",t.WELFAREVIEWQGROUP="WelfareView|Qgroup",t.WELFAREVIEWREBATE="WelfareView|Rebate",t.ACFOURPEOPLEVIEW="AcFourPeopleView",t.ACSPRINGCELEBRATE="AcSpringCelebrateView",t.ACSPRINGCELEBRATE_TAB1="AcSpringCelebrateView|1",t.ACSPRINGCELEBRATE_TAB2="AcSpringCelebrateView|2",t.ACSPRINGCELEBRATE_TAB3="AcSpringCelebrateView|3",t.ACSPRINGCELEBRATE_TAB4="AcSpringCelebrateView|4",t.RECHARGEVIPVIEW="RechargeVipView",t.RECHARGEVIPVIEWTAB2="RechargeVipView|1",t.WELFAREVIEWMONTHCARD="WelfareView|MonthCard",t.WELFAREVIEWYEARCARD="WelfareView|YearCard",t.WELFAREVIEWGODBLESS="WelfareView|GodBless",t.WELFAREVIEWRECHARGEBOX="WelfareView|RechargeBox",t.ACHIEVEMENTVIEW="AchievementView",t.GAMEANNOUNCEMENtVIEW="GameAnnouncementView",t.THANKSGIVINGVIEW="ThanksgivingView",t.PRISONVIEW="PrisonView",t.ACRANKACTIVEVIEW="AcRankActiveView",t.DINNERDETAILVIEW="DinnerDetailView",t.DINNERREWARDVIEW="DinnerRewardView",t.ACRECHARGEVIEW="AcRechargeView",t.ACVIPSHOPVIEW="AcVipShopView",t.ACNEWYEARVIEW="AcNewYearView",t.ACNEWYEARVIEW_TAB1="AcNewYearView|1",t.ACNEWYEARVIEW_TAB2="AcNewYearView|2",t.ACPUNISHVIEW="AcPunishView",t.ATKRACEVIEW="AtkraceView",t.ATKRACEARRESTVIEW="AtkraceArrestView",t.ATKRACEVISITVIEW="AtkraceVisitView",t.ATKRACECROSSVISITVIEW="AtkraceCrossVisitView",t.ATKRACERANKLISTVIEW="AtkraceRankListView",t.ALLIANCEVIEW="AllianceView",t.ALLIANCECREATEVIEW="AllianceCreateView",t.BOOKROOMVIEW="BookroomView",t.STUDYATKDETAILVIEW="StudyatkDetailView",t.STUDYBATTLEVIEW="StudyatkBattleView",t.STUDYATKVIEW="StudyatkView",t.CONQUESTVIEW="ConquestView",t.TRADEVIEW="TradeView",t.TRADERANKLISTVIEW="TradeRankListView",t.ATKRACECROSSSUMMARYVIEW="AtkracecrossSummaryView",t.ATKRACECROSSVIEW="AtkracecrossView",t.ATKRACECROSSCHALLENGEVIEW="AtkraceCrossChallengeView",t.ATKRACECROSSRANKLISTVIEW="AtkraceCrossRankListView",t.ATKRACECROSSARRESTVIEW="AtkracecrossArrestView",t.ATKRACECROSSACTIVITYREWARDVIEW="AtkracecrossActivityRewardView",t.TRADEFIGHTVIEW="TradeFightView",t.TRADEINFOPOPUPVIEW="TradeInfoPopupView",t.ACTAILOREXCHANGEVIEW="AcTailorExchangeView",t.CHATBLOCKVIEW="ChatblockView",t.ACWISHTREEEXCHANGEVIEW="AcWishTreeExchangeView",t.SEARCHVIEW="SearchView",t.PRESTIGEVIEW="PrestigeView",t.PALACEHOUSEVIEW="PalaceHouseView",t.PALACECROSSVIEW="PalaceCrossView",t.PALACEVIEW="PalaceView",t.PALACEHOUSEGROUPVIEW="PalaceHouseGroupView",t.PRACTICEVIEW="PracticeView",t.PRACTICEABILITYVIEW="PracticeAbilityView",t.ACCROSSSERVERINTIMACYENTERVIEW="AcCrossServerIntimacyEnterView"}(e=t.COMMON||(t.COMMON={}));var i;!function(t){t.SHAREPOPUPVIEW="SharePopupView",t.COMMONREWARDPOPUPVIEW="CommonRewardPopupView",t.ITEMINFOPOPUPVIEW="ItemInfoPopupView",t.ITEMUSEPOPUPVIEW="ItemUsePopupView",t.ITEMJUMPPOPUPVIEW="ItemJumpPopupView",t.RULEINFOPOPUPVIEW="RuleInfoPopupView",t.SERVANTATTRDETAILPOPUPVIEW="ServantAttrDetailPopupView",t.AUTORESPOPUPVIEW="AutoResPopupView",t.SERVANTSELECTEDPOPUPVIEW="ServantSelectedPopupView",t.ACVIPSHOPPOPUPVIEW="AcVipShopPopupView",t.ATKRACECHALLENGEVIEW="AtkraceChallengeView",t.ATKRACECROSSCHALLENGEVIEW="AtkraceCrossChallengeView",t.ITEMUSECONSTPOPUPVIEW="ItemUseConstPopupView",t.COSTGEMBUYITEMPOPUPVIEW="CostGemBuyItemPopupView",t.SEARCHBUILDPOPUPVIEW="SearchBuildPopupView",t.SEARCHRESULTPOPUPVIEW="SearchResultPopupView",t.MainTASKPOPUPVIEW="MainTaskPopupView",t.NAMEPOPUPVIEW="NamePopupView",t.USERNAMEPOPUPVIEW="UserNamePopupView",t.RANKUSERINGOPOPUPVIEW="RankUserinfoPopupView",t.ADULTCHOOSETYPEVIEW="AdultChooseTypeView",t.ADULTMARRYREQUESTVIEW="AdultMarryRequestView",t.ADULTCHOOSECHILDVIEW="AdultChooseChildView",t.DAILYTASK_REWARDPREVIEWPOPUPVIEW="DailyTaskRewardPreviewPopuiView",t.ACNEWYEARPOPUPVIEW="AcNewYearPopupView",t.MAILPOPUPVIEW="MailPopupView",t.MAILDETAILPOPUPVIEW="MailDetailPopupView",t.HOLDDINNERPOPUPVIEW="HoldDinnerPopupView",t.DINNERFINDPOPUPVIEW="DinnerFindPopupView",t.DINNEREXCHANGEPOPUPVIEW="DinnerExchangePopupView",t.DINNERRANKPOPUPVIEW="DinnerRankPopupView",t.DINNERTYPEPOPUPVIEW="DinnerTypePopupView",t.DINNERMESSAGEPOPUPVIEW="DinnerMessagePopupView",t.DINNERMSGPOPUPVIEW="DinnerMsgPopupView",t.DINNERSHAREPOPUPVIEW="DinnerSharePopupView",t.PALACEHISTORYPOPUPVIEW="PalaceHistoryPopupView",t.PALACEEDITSIGNPOPUPVIEW="PalaceEditSignPopupView",t.SERVERLISTPOPUPVIEW="ServerListPopupView",t.ACRANKLISTPOPUPVIEW="AcRankListPopupView",t.ACHIEVEMENTDETAILPOPUPVIEW="AchievementDetailPopupView",t.ACLIMITEDREWARDDETAILPOPUPVIEW="AcLimitedRewardDetailPopupView",t.SettingPopopView="SettingPopopView",t.SETTINGCONTACTPOPUPVIEW="SettingContactPopupView",t.SettingCDKPopupView="SettingCDKPopupView",t.ERRORPOPUPVIEW="ErrorPopupView",t.SERVANTBOOKLEVELUPPOPUPVIEW="ServantBookLevelupPopupView",t.WIFEGIVEPOPUPVIEW="WifeGivePopupView",t.SEARCHLUCKPOPUPVIEW="SearchLuckPopupView",t.WIFESKILLPOPUPVIEW="WifeSkillPopupView",t.WIFESKINVIEW="WifeskinView",t.PRISONDETAILSPOPUPVIEW="PrisonDetailsPopupView",t.PRISONPOPVIEW="PrisonPopView",t.ACPUNISHBUYITEMPOPUPVIEW="AcPunishBuyItemPopupView",t.ACPUNISHRANKREWARDPOPUPVIEW="AcPunishRankRewardPopupView",t.SERVANTADVANCEPOPUPVIEW="ServantAdvancePopupView",t.ACPUNISHRANKPOPUPVIEW="AcPunishRankPopupView",t.ACPUNISHEXPOPUPVIEW="AcPunishExPopupView",t.BOOKROOMSERVANTSELECTPOPUPVIEW="BookroomServantSelectPopupView",t.CONFIRMPOPUPVIEW="ConfirmPopupView",t.OFFLINEVIEW="OfflineView",t.COMPOSEPOPUPVIEW="ComposePopupView",t.ALLIANCECREATEPOPUPVIEW="AllianceCreatePopupView",t.ALLIANCEBOSSATTACKEDPOPUPVIEW="AllianceBossAttackedPopupView",t.ATKRACEAGREEPOPUPVIEW="AtkraceAgreePopupDialog",t.ATKRACECROSSAGREEPOPUPDIALOG="AtkracecrossAgreePopupDialog",t.ATKRACEBUYPOPUPVIEW="AtkraceBuyPopupView",t.ATKRACECROSSBUYPOPUPVIEW="AtkracecrossBuyPopupView",t.STUDYATKFINDPOPUPVIEW="StudyatkFindPopupView",t.STUDYATKCREATEPOPUPVIEW="StudyatkCreatePopupView",t.STUDYATKBOOKPOPUPVIEW="StudyatkBookPopupView",t.STUDYATKFAILEDPOPUPVIEW="StudyatkFailedPopupView",t.ATKRACEREWARDPOPUPVIEW="AtkraceRewardPopupView",t.ATKRACECROSSREWARDPOPUPVIEW="AtkracecrossRewardPopupView",t.ATKRACECROSSDETAILPOPUPVIEW="AtkracecrossDetailPopupView",t.ALLIANCERANKPOPUPVIEW="AllianceRankPopupView",t.ALLIANCEMANAGEPOPUPVIEW="AllianceManagePopupView",t.ALLIANCEAPPLYPOPUPVIEW="AllianceApplyPopupView",t.DAILYBOSSSCROEPOPUPVIEW="DailybossScroePopupView",t.DAILYBOSSRANKPOPUPVIEW="DailybossRankPopupView",t.DAILYBOSSATTACKEDPOPUPVIEW="DailybossAttackedPopupView",t.DAILYBOSSDAMAGERANKPOPUPVIEW="DailybossDamageRankPopupView",t.ALLIANCEMEMBERPOPUPVIEW="AllianceMemberPopupView",t.ALLIANCEFINDPOPUPVIEW="AllianceFindPopupView",t.ALLIANCEINFOPOPUPVIEW="AllianceInfoPopupView",t.ALLIANCESETPOPOPUPVIEW="AllianceSetPoPopupView",t.ALLIANCESHOWINFOPOPUPVIEW="AllianceShowInfoPopupView",t.ALLIANCETURNPOPUPVIEW="AllianceTurnPopupView",t.ALLIANCETIMEPOPUPVIEW="AllianceTimePopupView",t.DAILYBOSSTYPE1BATTLERESULTPOPUPVIEW="DailybossType1BattleResultPopupView",t.DAILYBOSSRANKREWARDPOPUPVIEW="DailybossRankRewardPopupView",t.ALLIANCEPSWDPOPUPVIEW="AlliancePswdPopupView",t.ALLIANCEBUILDPOPUPVIEW="AllianceBuildPopupView",t.ALLIANCEEXPOPUPVIEW="AllianceExPopupView",t.ALLIANCEBOSSPOPUPVIEW="AllianceBossPopupView",t.ALLIANCEBOSSOPENPOPUPVIEW="AllianceBossOpenPopupView",t.ALLIANCEBOSSRANKOPUPVIEW="AllianceBossRankPopupView",t.CATCHPRISONPUPUPVIEW="CatchPrisonPopupView",t.DAILYBOSSLASTATTACKPOPUPVIEW="DailybossLastAttackPopupView",t.NETERRORPOPUPVIEW="NetErrorPopupView",t.WEIDUANUPGRADEPOPUPVIEW="WeiduanUpgradePopupView",t.GETGIFTPOPUPVIEW="GetGiftPopupView",t.BUYGIFTPOPUPVIEW="BuyGiftPopupView",t.CONQUESTRANKPOPUPVIEW="ConquestRankPopupView",t.CONQUESTBATCHPOPUPVIEW="ConquestBatchPopupView",t.CONQUESTWINPOPUPVIEW="ConquestWinPopupView",t.CONQUESTINFOPOPUPVIEW="ConquestInfoPopupView",t.TRADEONEKEYPOPUPVIEW="TradeOneKeyPopupView",t.CANDYGETPOPUPVIEW="CandyGetPopupView",t.ATTENTIONPOPUPVIEW="AttentionPopupView",t.CHALLENGEAUTOPOPUPVIEW="ChallengeAutoPopupView",t.CHALLENGEAUTOREWARDSPOPUOVIEW="ChallengeAutoRewardsPopupView",t.ACTAILORREWARDPOPUPVIEW="AcTailorRewardPopupView",t.SETPASSWORDPOPUPVIEW="SetPasswordPopupView",t.DOWNLOADPACKAGEPOPUPVIEW="DownloadPackagePopupView",t.DOWNLOADVIEW="DownloadView",t.PRESTIGEINFOPOPUPVIEW="PrestigeInfoPopupView",t.PRESTIGELOFPOPUPVIEW="PrestigeLogPopupView",t.PRESTIGEITEMPOPUPVIEW="PrestigeItemPopupView",t.PRACTICEABILITYDETAILSPOPUPVIEW="PracticeAbilityDetailsPopupView",t.ACTMAYDAYRANKPOPUPVIEW="AcMayDayRankPopupView",t.ACMAYDAYREWARDPOPUPVIEW="AcMayDayRewardPopupView",t.REAlNAMEPOPUPVIEW="RealnamePopupView",t.WIFESTATUSPOPUPVIEW="WifestatusPopupView",t.WIFESTATUSWIFEPOPUPVIEW="WifestatusWifePopupView",t.ACCROSSSERVERINTIMACYREWARDVIEW="AcCrossServerIntimacyRewardView",t.ACCROSSSERVERINTIMACYRANKLISTVIEW="AcCrossServerIntimacyRankListView",t.ACCROSSSERVERDETAILPOPUPVIEW="AcCrossServerDetailPopupView",t.WIFEORSERVANTINFOPOPUPVIEW="WifeORServantInfoPopupView",t.PRACTICEBATCHBUYPOPUPVIEW="PracticeBatchBuyPopupView"}(i=t.POPUP||(t.POPUP={}));var a;!function(t){t.LOGINVIEW="LoginView",t.BATTLEWIN="BattleWin",t.PROMPTVIEW="PromptView",t.WIFEGETCHILDVIEW="WifeGetChildView",t.WIFELOVEANIVIEW="WifeLoveAniView",t.WIFEGETVIEW="WifeGetView",t.CHALLENGESTORY="ChallengeStory",t.ROOKIEVIEW="RookieView",t.SERVANTGETVIEW="ServantGetView",t.RANKWORSHIPVIEW="RankWorshipView",t.CHILDUPDVIEW="ChildUpdView",t.ADULTMARRYSUCCESSVIEW="AdultMarrySuccessView",t.DINNEROPENEDVIEW="DinnerOpenedView",t.DINNERFINISHVIEW="DinnerFinishView",t.GOTODINNEREDVIEW="GotoDinnerView",t.ACPUNISHREPORTVIEW="AcPunishReportView",t.SERVANTADVANCEVIEW="ServantAdvanceView",t.STUDYATKSUCCESSVIEW="StudyatkSuccessView",t.STUDYATKBOOLLVUPSUCCESSVIEW="StudyAtkBookLvupSuccessView",t.WIFECALLBATCHSUCCESSVIEW="WifeCallBatchSuccessView",t.STUDYATKBATTLERESULEVIEW="StudyatkBattleResultView",t.ALLIANCECREATEANIVIEW="AllianceCreateAniView",t.ITEMUSESUCCESSVIEW="ItemUseSuccessView",t.KRAGREEMENTVIEW="KRAgreementView",t.PRACTICEGETVIEW="PracticeGetView"}(a=t.BASE||(t.BASE={}));var n;!function(t){t.ATKRACEBATTLEVIEW="AtkraceBattleView",t.ATKRACECROSSBATTLEVIEW="AtkracecrossBattleView",t.BOSSBATTLEVIEW="BossBattleView",t.DAILYBOSSBATTLEVIEW="DailybossBattleView",t.ALLIANCEBOSSBATTLEVIEW="AllianceBossBattleView",t.BATTLEVIEW="BattleView",t.FIGHTVIEW="FightView",t.CONQUESTFIGHTVIEW="ConquestFightView"}(n=t.BATTLE||(t.BATTLE={}))}(ViewConst||(ViewConst={}));var ItemEnums;!function(t){t[t.gem=1]="gem",t[t.gold=2]="gold",t[t.food=3]="food",t[t.soldier=4]="soldier",t[t.exp=5]="exp",t[t.item=6]="item"}(ItemEnums||(ItemEnums={}));var SceneController=function(t){function e(){var e=t.call(this)||this;return e._curScene=void 0,e._lastScene=void 0,e._sceneList=new Object,e._isTicking=!1,App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_HIDE_LAST_SCENE,e.hideLastScene,e),e}return __extends(e,t),e.prototype.playBg=function(){var t=this._sceneList[this._curScene];t&&t.playBg&&t.playBg()},e.prototype.go=function(t){if(this._curScene!=t){this._lastScene=this._curScene;var e=void 0;if(this._sceneList.hasOwnProperty(t))e=this._sceneList[t];else{var i=egret.getDefinitionByName(t);e=new i,this._sceneList[t]=e}this._curScene=t,e.show(),this._isTicking||(this._isTicking=!0,TickManager.addTick(this.tick,this))}},e.prototype.tick=function(){if(this._sceneList)for(var t in this._sceneList){var e=this._sceneList[t];e&&e.isShow()&&e.isInit()&&e.parent&&e.tick&&e.tick()}},e.prototype.hideLastScene=function(){if(this._lastScene&&this._sceneList.hasOwnProperty(this._lastScene)){var t=this._sceneList[this._lastScene];t&&t.hide()}},e.prototype.jump=function(){this._curScene==SceneConst.SCENE_HOME?this.goCity():this.goHome()},e.prototype.goHome=function(){this.go(SceneConst.SCENE_HOME)},e.prototype.goCity=function(){this.go(SceneConst.SCENE_CITY)},e.prototype.hideScene=function(){if(this._curScene&&this._sceneList&&this._sceneList[this._curScene]){var t=this._sceneList[this._curScene];t.isShow()&&t.hide()}},e.prototype.showScene=function(){if(this._curScene&&this._sceneList&&this._sceneList[this._curScene]){var t=this._sceneList[this._curScene];t&&t.show()}},e.prototype.hideAllScene=function(t){if(this._sceneList)for(var e in this._sceneList){var i=this._sceneList[e];i&&i.isShow()&&i.hide(t)}this._curScene=null},e.prototype.dispose=function(){this.hideAllScene(!0),TickManager.removeTick(this.tick,this),this._isTicking=!1},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e._instance=void 0,e}(BaseController);__reflect(SceneController.prototype,"SceneController");var ViewController=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return void 0==e._instance&&(e._instance=new e),e._instance},e}(BaseViewController);__reflect(ViewController.prototype,"ViewController");var LampRoll=function(t){function e(){var e=t.call(this)||this;return e._lampBg=null,e._lampInfo=null,e._rollingType=0,e._lampText=null,e._rollInfo=null,e._isRolling=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_SHOW_LAMP,this.checkShowLamp,this),this._lampBg=BaseBitmap.create("mainui_chatbg"),this._lampBg.width=GameConfig.stageWidth,this._lampBg.height=30,this.addChild(this._lampBg),this._lampBg.alpha=0,this.checkShowLamp()},e.prototype.checkShowLamp=function(){this._rollInfo=Api.lampVoApi.getShowLampInfo(),0==this._rollingType?this._rollInfo&&(this._rollingType=1,egret.Tween.get(this._lampBg).to({alpha:1},1e3).call(this.startRolling,this)):1==this._rollingType?this._rollInfo?0==this._isRolling&&this.startRolling():(this._rollingType=2,egret.Tween.get(this._lampBg).to({alpha:0},1e3).call(this.hiddenLamp,this)):2==this._rollingType&&this._rollInfo&&(this._lampBg.alpha=1,this.startRolling())},e.prototype.startRolling=function(){if(null==this._lampInfo){this._lampInfo=new BaseDisplayObjectContainer,this.addChild(this._lampInfo);var t=BaseBitmap.create("public_chatnoticeicon");t.setScale(30/t.width),this._lampInfo.addChild(t),this._lampText=ComponentManager.getTextField("0",TextFieldConst.FONTSIZE_CONTENT_SMALL),this._lampText.setPosition(60,this._lampBg.height/2-this._lampText.height/2),this._lampInfo.addChild(this._lampText)}this._isRolling=!0,egret.Tween.removeTweens(this._lampInfo),this._lampText.text=this.getRollingText(),this._lampInfo.x=GameConfig.stageWidth;var e=this._lampText.width+100+GameConfig.stageWidth,i=e/100*1e3;egret.Tween.get(this._lampInfo).to({x:-this._lampText.width-100},i).call(this.rollingEnd,this)},e.prototype.rollingEnd=function(){this._isRolling=!1,this.checkShowLamp()},e.prototype.getRollingText=function(){var t="";return this._rollInfo&&(1==this._rollInfo.dtype?t=LanguageManager.getlocal("lampInfoType1",[this._rollInfo.name,LanguageManager.getlocal("wifeName_"+this._rollInfo.need)]):2==this._rollInfo.dtype?t=LanguageManager.getlocal("lampInfoType2",[this._rollInfo.name,LanguageManager.getlocal("servant_name"+this._rollInfo.need)]):3==this._rollInfo.dtype?t=LanguageManager.getlocal("lampInfoType3",[this._rollInfo.name,this._rollInfo.need]):4==this._rollInfo.dtype?t=LanguageManager.getlocal("lampInfoType4",[this._rollInfo.name,this._rollInfo.need]):5==this._rollInfo.dtype?t=LanguageManager.getlocal("lampInfoType5",[this._rollInfo.name,LanguageManager.getlocal("officialTitle"+this._rollInfo.need)]):100==this._rollInfo.dtype&&(t=this._rollInfo.msg)),t},e.prototype.hiddenLamp=function(){this._lampInfo&&2==this._rollingType&&(this._rollingType=0,this.removeChild(this._lampInfo),this._lampInfo=null)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_SHOW_LAMP,this.checkShowLamp,this),egret.Tween.removeTweens(this._lampBg),this._lampBg=null,this._lampInfo=null,this._rollingType=0,this._lampText=null,this._rollInfo=null,this._isRolling=!1,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(LampRoll.prototype,"LampRoll");var MainUI=function(t){function e(){var e=t.call(this)||this;return e._topContiner=void 0,e._bottomContiner=void 0,e._isAtHome=!0,e._mailRedDotSp=null,e._achRedDotSp=null,e._functionPreviewBg=null,e._functionAni=null,e._activityIconList=[],e._iconNameList={},e._signName=null,e._functionIcon=null,e._lastL=0,e.bottomBtnCfg=[{id:1,btnName:"servant",btnIconImg:"mainui_bottomimg1",isOPen:!0},{id:2,btnName:"item",btnIconImg:"mainui_bottomimg2",isOPen:!0},{id:3,btnName:"dailytask",btnIconImg:"mainui_bottomimg3",isOPen:!0},{id:4,btnName:"achieve",btnIconImg:"mainui_bottomimg4",isOPen:!0},{id:5,btnName:"shop",btnIconImg:"mainui_bottomimg5",isOPen:!0},{id:6,btnName:"welfare",btnIconImg:"mainui_bottomimg6",isOPen:!1},{id:7,btnName:"challenge",btnIconImg:"mainui_bottomimg9",isOPen:!1},{id:8,btnName:"manage",btnIconImg:"mainui_bottomimg10",isOPen:!1}],e}return __extends(e,t),e.prototype.init=function(){this.initTop(),this.initButtom(),this.checkMailState(),Api.switchVoApi.checkAutoLoadDefaultRes()&&App.LoginResLoader.autoLoadNextResItem()},e.prototype.initTop=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_TASK_GETMAINTASK),this.doRefreshTaskInfo,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_RESFESH_DAILYTASK_AFTER_SYNC,this.doRefreshTaskInfo,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_RESCHANGE_REFRESH_UI,this.doRefreshTaskInfo,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_CHAT_COME,this.doRefreshChat,this),App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_ALLIANCE_EXITALLIANCE,this.doQuickAlliance,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_MESSAGE_ALLIANCE_BEKICK,this.doQuickAlliance,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_ACHIEVEMENT,this.checkAchPoint,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_ACTIVITY,this.checkActivityIconState,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_REFRESH_MODE,this.checkRedPointByModel,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_OTHERINFO,this.checkWanBaIcon,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_DINNER_GUIDE,this.doDinnerGuide,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_OTHERINFO_GETUNLOCKLISTREWARD),this.refreshText,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_REFRESH_FUNCTION_TXT,this.checkIsRefresh,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USER_UPGRADE),this.refreshText,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_OTHERINFO,this.initCoverIcon,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_OTHERINFO,this.initBindIcon,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_REALNAME,this.createRealnameRedHot,this),this._topContiner=new BaseDisplayObjectContainer,this.addChild(this._topContiner),this._isAtHome=!0;var t=new MainUINewTop({showName:!0});this._topContiner.addChild(t),this._iconContainer=new BaseDisplayObjectContainer,this._iconContainer.y=113,this._topContiner.addChild(this._iconContainer),this._lampRoll=new LampRoll,this._lampRoll.y=106,this._topContiner.addChild(this._lampRoll),Config.AcCfg.isGetAll?this.initIconsAndCheckStatus():App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_ACTIVITY_GETACTIVECFG,this.initIconsAndCheckStatus,this),TickManager.addTick(this.tick,this),this.tick()},e.prototype.checkAllRedPoint=function(){for(var t in this.bottomBtnCfg)this.checkRedPointByModel(this.bottomBtnCfg[t].btnName)},e.prototype.checkRedPointByModel=function(t){var e=t instanceof egret.Event?t.data:t,i=this._bottomContiner.getChildByName(e);if(i&&Api[e+"VoApi"]&&Api[e+"VoApi"].checkRedPoint){var a=Api[e+"VoApi"].checkRedPoint();a?App.CommonUtil.addRedDotToBDOC(i):App.CommonUtil.removeRedDotFromBDOC(i)}(e==MessageConst.MESSAGE_MODEL_SHOP||e==MessageConst.MESSAGE_MODEL_USERINFO)&&(this.checkVipState(),this.checkThanksg())},e.prototype.checkAchPoint=function(){if(Api.achievementVoApi.getAchGetNum()>0)if(null==this._achRedDotSp&&this._bottomContiner.getChildByName("achieve")){this._achRedDotSp=BaseBitmap.create("public_dot2");var t=this._bottomContiner.getChildByName("achieve");this._achRedDotSp.x=t.x+t.width-this._achRedDotSp.width,this._achRedDotSp.y=t.y+2,this._bottomContiner.addChild(this._achRedDotSp)}else this._achRedDotSp&&(this._achRedDotSp.visible=!0);else this._achRedDotSp&&(this._achRedDotSp.visible=!1)},e.prototype.tick=function(){if(!Api.switchVoApi.checkClosePay()){this.check12BoxIcon(),Api.acVoApi.checkIsHasNewAc()&&this.showNewActivityIcons();var t=this._activityIconList.length;if(t>0){for(var e=!1,i=t-1;i>=0;i--){var a=this._activityIconList[i],n=a.name,o=n.split("-"),s=o[0],r=o[1];Api.acVoApi.getActivityVoByAidAndCode(s,r)&&(Api.acVoApi.checkActivityStartByAid(s,r)||(a.dispose(),this._activityIconList.splice(i,1),delete this._iconNameList[a.name],e=!0)),this.setIconTime(a)}(e||this._lastL!=t)&&(this.sortIcons(),this.setIconsPos())}this._lastL=this._activityIconList.length}},e.prototype.setIconTime=function(t){if("newcharge_func"==t.name){var e=Api.shopVoApi.getPayInfo1Time(),i=App.DateUtil.getFormatBySecond(e,1);if(t.getChildByName("time"))t.getChildByName("time").text=i;else{var a=BaseBitmap.create("public_9_bg15");a.width=160,a.x=-5,a.y=32,a.setScale(.5),t.addChild(a);var n=ComponentManager.getTextField(i,18,TextFieldConst.COLOR_WARN_GREEN);n.x=2,n.y=34,n.name="time",t.addChild(n)}}},e.prototype.check12BoxIcon=function(){var t=Api.shopVoApi.getPayFlag();if(t>0&&Api.switchVoApi.checkOpenNewCharge()){var e=Config.RechargeCfg.getRechargeItemCfgByKey("g9");if(e){var i=Api.shopVoApi.getPayInfoById2("g9");Api.shopVoApi.getPayInfoById2("g10");i&&i.st+e.lastTime>GameData.serverTime?this.createMainUIIcon("newcharge"):this.removeMainUIIcon("newcharge")}else this.removeMainUIIcon("newcharge")}else this.removeMainUIIcon("newcharge")},e.prototype.initIconsAndCheckStatus=function(){Api.switchVoApi.checkClosePay()||(this.initIcons(),this.setPosAndCheckState())},e.prototype.initIcons=function(){this.initVipIcon(),this.initRebateIcon(),this.initRealnameIcon(),App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_ACTIVITY_GETACTIVECFG,this.initIconsAndCheckStatus,this);for(var t=Api.acVoApi.getAllActivityIcons(),e=t.length,i=0;e>i;i++){var a=t[i];this._iconNameList[a.name.split("_")[0]]=a,this._iconContainer.addChild(a),this._activityIconList.push(a)}this.initFuliIcons(),this.checkWanBaIcon(),this.initCardIcons(),this.check12BoxIcon(),this.checkCandyIcon(),this.initAndCheckAttentionIcon(),this.initDownloadIcon(),this.initInviteIcon(),this.initZhubowanghongIcon(),this.initCoverIcon(),this.initBindIcon()},e.prototype.setPosAndCheckState=function(){this.sortIcons(),this.setIconsPos(),this.checkActivityIconState()},e.prototype.sortIcons=function(){this._activityIconList.sort(function(t,e){var i=t.name;i&&(i.indexOf("_")>-1&&(i=i.split("_")[0]),i.indexOf("-")>-1&&(i=i.split("-")[0]));var a=e.name;a&&(a.indexOf("_")>-1&&(a=a.split("_")[0]),a.indexOf("-")>-1&&(a=a.split("-")[0]));var n=Config.IconorderCfg.getIconSortIdByCfgName(i),o=Config.IconorderCfg.getIconSortIdByCfgName(a);return n-o})},e.prototype.showNewActivityIcons=function(){for(var t=Api.acVoApi.getAllActivityIcons(),e=t.length,i=0;e>i;i++){var a=t[i];this._iconNameList[a.name.split("_")[0]]=a,this._iconContainer.addChild(a),this._activityIconList.push(a)}this.sortIcons()},e.prototype.checkRankActiveIcon=function(){if(Api.acVoApi.getRanActives().length>0){this.createMainUIIcon("rankActive")}else this.removeMainUIIcon("rankActive")},e.prototype.initAndCheckAttentionIcon=function(){if(PlatformManager.checkAttention())if(!PlatformManager.checkIsFkylcSp()||PlatformManager.checkIs4399Sp()||Api.otherInfoVoApi.getFkFocusInfo())this.removeMainUIIcon("attention");else{var t=this.createMainUIIcon("attention");Api.otherInfoVoApi.getFkFocusInfo()?App.CommonUtil.removeRedDotFromBDOC(t):App.CommonUtil.addRedDotToBDOC(t)}else var t=this.createMainUIIcon("attention")},e.prototype.initVipIcon=function(){Api.switchVoApi.checkClosePay()||this.createMainUIIcon("rechargeVip")},e.prototype.initRebateIcon=function(){Api.switchVoApi.checkOpenRechargeRebate()&&this.createMainUIIcon("rebate")},e.prototype.initRealnameIcon=function(){var t=this;Api.switchVoApi.checkOpenCertification()&&!Api.otherInfoVoApi.certification()&&RSDKHelper.checkRealname(function(e){e&&t.createMainUIIcon("realname")})},e.prototype.initCardIcons=function(){if(!Api.switchVoApi.checkClosePay()&&!Api.switchVoApi.checkTWShenhe()&&!PlatformManager.checkIsShenHeYiWan()){var t=Api.shopVoApi.ifBuyMonthCard(),e=Api.shopVoApi.ifBuyYearCard();t||this.createMainUIIcon("monthcard"),t&&!e&&this.createMainUIIcon("yearcard")}},e.prototype.initSignIcons=function(){this.checkSignIcons(),this.cheackSignRedDot()},e.prototype.checkSignIcons=function(){var t=Api.arrivalVoApi.getTotalSignDay();if(!(t>=8))if(7>=t){var e=Api.arrivalVoApi.checkFlagByIndex(2),i=Api.arrivalVoApi.checkFlagByIndex(3),a=Api.arrivalVoApi.checkFlagByIndex(7);if(2>=t&&1!=e)return this.createMainUIIcon("sign2"),void(this._signName="sign2");if(3>=t&&1!=i)return this.removeMainUIIcon("sign2"),this.createMainUIIcon("sign3"),void(this._signName="sign3");if(7>=t&&1!=a)return this.removeMainUIIcon("sign3"),this.createMainUIIcon("sign7"),void(this._signName="sign7");this.removeMainUIIcon("sign7")}else this.removeMainUIIcon("sign7")},e.prototype.cheackSignRedDot=function(){var t=this.getTopBtnByName(this._signName);if(t){var e=Api.arrivalVoApi.isShowRedDot;e?App.CommonUtil.addRedDotToBDOC(t):App.CommonUtil.removeRedDotFromBDOC(t)}},e.prototype.checkCardIcon=function(){var t=Api.shopVoApi.ifBuyMonthCard(),e=Api.shopVoApi.ifBuyYearCard();t&&this.removeMainUIIcon("monthcard"),e&&this.removeMainUIIcon("yearcard")},e.prototype.checkWanBaIcon=function(){if(Api.otherInfoVoApi.checkShowWanbaDesktopIcon()){var t=this.createMainUIIcon("desktop");App.CommonUtil.addRedDotToBDOC(t)}else this.removeMainUIIcon("desktop");if(Api.otherInfoVoApi.checkShowWanbaShareIcon()&&0==Api.switchVoApi.checkTWShenhe()){var t=this.createMainUIIcon("share");PlatformManager.checkIsFkylcSp()&&(Api.otherInfoVoApi.getFkIsshowRed()?App.CommonUtil.addRedDotToBDOC(t):App.CommonUtil.removeRedDotFromBDOC(t))}else this.removeMainUIIcon("share");this.initAndCheckAttentionIcon(),this.checkRealnameIcon2()},e.prototype.createRealnameRedHot=function(){var t=this.getTopBtnByName("realname");App.CommonUtil.addRedDotToBDOC(t),this.checkRealnameIcon2()},e.prototype.checkRealnameIcon2=function(){var t=this.getTopBtnByName("realname");t&&Api.otherInfoVoApi.certification()&&App.CommonUtil.removeRedDotFromBDOC(t)},e.prototype.checkCandyIcon=function(){Api.otherInfoVoApi.getCandyGetInfo()&&PlatformManager.getCandyFlag()&&this.createMainUIIcon("candyget")},e.prototype.initDownloadIcon=function(){(PlatformManager.checkIsTWBSp()&&"pc"===Api.gameinfoVoApi.getDownType()||PlatformManager.checkIsWanbaSp()&&App.DeviceUtil.isAndroid()&&PlatformManager.getIsWanbaSQ()&&"nwd"===Api.gameinfoVoApi.getDownType())&&this.createMainUIIcon("download")},e.prototype.initInviteIcon=function(){Api.switchVoApi.checkOpenInvite()&&this.createMainUIIcon("invite")},e.prototype.initZhubowanghongIcon=function(){PlatformManager.checkIsTWBSp()&&1e3*GameData.serverTime<new Date("2018/04/14").getTime()&&null===Api.wifeVoApi.getWifeInfoVoById(212)&&this.createMainUIIcon("zhubowanghong")},e.prototype.initCoverIcon=function(){PlatformManager.checkIsWanbaSp()&&Api.switchVoApi.checkOpenCover()&&2!==Api.otherInfoVoApi.getCoverState()?this.createMainUIIcon("cover"):this.removeMainUIIcon("cover")},e.prototype.initBindIcon=function(){Api.switchVoApi.checkOpenFbBind()&&1!=Api.otherInfoVoApi.getFBBindFlag()&&PlatformManager.checkIsTWBSp()&&PlatformManager.checkIsWeiduan()&&(-1!==App.CommonUtil.compareVersion("3.0",PlatformManager.getAppVersion())&&App.DeviceUtil.isIOS()||-1!==App.CommonUtil.compareVersion("1.6",PlatformManager.getAppVersion())&&App.DeviceUtil.isAndroid())?this.createMainUIIcon("bind"):this.removeMainUIIcon("bind")},e.prototype.initFuliIcons=function(){App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_SHOP,this.checkWelfareState,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_ARRIVAL,this.checkWelfareState,this),App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_OTHERINFO_GETUNLOCKLISTREWARD,this.checkWelfareState,this),Api.switchVoApi.checkClosePay()||(this.createMainUIIcon("welfare"),this.checkFirstRechargeIcon(),this.checkWelfareState(),this.checkVipState(),this.initSignIcons(),this.checkThanksg())},e.prototype.checkThanksg=function(){this.createMainUIIcon("thanksgiving");var t=this.getTopBtnByName("thanksgiving"),e=Api.rechargeVoApi.checkFirstRecharge(),i=Api.switchVoApi.checknewRecharge();t&&(i&&0==e&&1==Api.shopVoApi.getfourRateCharge()?this.createMainUIIcon("thanksgiving"):this.removeMainUIIcon("thanksgiving"))},e.prototype.checkVipState=function(){var t=this.getTopBtnByName("rechargeVip");if(t){var e=Api.vipVoApi.checkRedPoint();e?App.CommonUtil.addRedDotToBDOC(t):App.CommonUtil.removeRedDotFromBDOC(t)}},e.prototype.createMainUIIcon=function(t){if(this._iconNameList[t])return this._iconNameList[t];var e=!1;e="welfare"==t||"rechargeVip"==t||"firstrecharge"==t||"monthcard"==t||"yearcard"==t||"sign2"==t||"sign3"==t||"sign7"==t||"rebate"==t||"realname"==t?!0:Config.IconorderCfg.getisFlickByName(t);
var i=App.CommonUtil.createMainUIIcon(t.toLowerCase()+"_icon",t.toLowerCase()+"_icon_name",e);return i.name=t+"_func",this._iconNameList[t]=i,i.addTouchTap(function(){if(!Api.rookieVoApi.isGuiding){var e=App.StringUtil.firstCharToUper(t)+"View",i=App.StringUtil.firstCharToUper(t)+"PopupView";0==egret.hasDefinition(e)&&egret.hasDefinition(i)&&(e=i),"rechargeVip"==t?e+="|1":"firstrecharge"==t?e=ViewConst.COMMON.WELFAREVIEWFIRSTRECHARGE:"monthcard"==t?e=ViewConst.COMMON.WELFAREVIEWMONTHCARD:"yearcard"==t?e=ViewConst.COMMON.WELFAREVIEWYEARCARD:"candyget"==t?e=ViewConst.POPUP.CANDYGETPOPUPVIEW:"newcharge"==t?e=ViewConst.COMMON.WELFAREVIEWRECHARGEBOX:"sign2"==t||"sign3"==t||"sign7"==t?e=ViewConst.COMMON.WELFAREVIEWSIGNIN:"rebate"==t&&(e=ViewConst.COMMON.WELFAREVIEWREBATE),ViewController.getInstance().openView(e)}},this),this._activityIconList.push(i),this._iconContainer.addChild(i),Api.switchVoApi.checkClosePay()&&(i.visible=!1),this.sortIcons(),i},e.prototype.removeMainUIIcon=function(t){for(var e=this._activityIconList.length,i=e-1;i>=0;i--)if(this._activityIconList[i].name&&this._activityIconList[i].name.split("_")[0]==t){this._activityIconList[i].dispose(),this._activityIconList.splice(i,1),this.setIconsPos();break}this._iconNameList[t]&&delete this._iconNameList[t]},e.prototype.setIconsPos=function(){if(1!=Api.switchVoApi.checkTWShenhe())for(var t=this._activityIconList.length,e=0;t>e;e++){var i=this._activityIconList[e];i.setPosition(30+(i.width+30)*(e%6)+i.width/2,Math.floor(e/6)*(i.height+10)+i.height/2)}},e.prototype.doRefreshTaskInfo=function(){if(null!=Api.mainTaskVoApi.getCurMainTaskId())if(this._taskTxt.text=Api.mainTaskVoApi.getCurTaskNameAndDescTxt()[0],Api.mainTaskVoApi.isCurTaskReach()?(this._taskTxt.textColor=TextFieldConst.COLOR_QUALITY_GREEN,this._missionIcon.texture=ResourceManager.getRes("mainui_missionIcon2"),this._missionIcon.x=25):(this._missionIcon.texture=ResourceManager.getRes("mainui_missionIcon1"),this._missionIcon.x=35,this._taskTxt.textColor=TextFieldConst.COLOR_QUALITY_WHITE),this._missionIcon.texture==ResourceManager.getRes("mainui_missionIcon2")){if(!this._taskContainer.getChildByName("taskeffect")){var t=ComponentManager.getCustomMovieClip("taskeffect_",8,100);if(t.x=5,t.y=-221,t.name="taskeffect",this._taskContainer.addChildAt(t,1),t.playWithTime(0),Number(Api.mainTaskVoApi.getCurMainTaskId())<=10){var e=BaseBitmap.create("studyatk_arrow");e.rotation=90,e.x=300,e.y=-225,e.name="taskeffect2",this._bottomContiner.addChild(e),egret.Tween.get(e,{loop:!0}).to({x:350,scaleX:1,scaleY:1},500).to({x:300,scaleX:1,scaleY:1},500)}}}else this._taskContainer.getChildByName("taskeffect")&&(this._taskContainer.removeChild(this._taskContainer.getChildByName("taskeffect")),this._bottomContiner.removeChild(this._bottomContiner.getChildByName("taskeffect2")));else{this._taskContainer.visible=!0;var i=Api.dailytaskVoApi.getTaskIdForMainTaskUI();this._taskTxt.text=LanguageManager.getlocal("dailyTaskName"+i);var a=Api.dailytaskVoApi.getTaskStatusByTaskId(i);if(2==a)return this._taskContainer.visible=!1,void(this._settingAndMailContainer.y=70);if(1==a?(this._taskTxt.textColor=TextFieldConst.COLOR_QUALITY_GREEN,this._missionIcon.texture=ResourceManager.getRes("mainui_missionIcon2"),this._missionIcon.x=25):(this._missionIcon.texture=ResourceManager.getRes("mainui_missionIcon1"),this._missionIcon.x=35,this._taskTxt.textColor=TextFieldConst.COLOR_QUALITY_WHITE),this._missionIcon.texture==ResourceManager.getRes("mainui_missionIcon2")){if(!this._taskContainer.getChildByName("taskeffect")){var t=ComponentManager.getCustomMovieClip("taskeffect_",8,100);if(t.x=5,t.y=-221,t.name="taskeffect",this._taskContainer.addChildAt(t,1),t.playWithTime(0),Number(Api.mainTaskVoApi.getCurMainTaskId())<=10){var e=BaseBitmap.create("studyatk_arrow");e.rotation=90,e.x=300,e.y=-225,e.name="taskeffect2",this._bottomContiner.addChild(e),egret.Tween.get(e,{loop:!0}).to({x:390,scaleX:1,scaleY:1},500).to({x:300,scaleX:1,scaleY:1},500)}}}else this._taskContainer.getChildByName("taskeffect")&&(this._taskContainer.removeChild(this._taskContainer.getChildByName("taskeffect")),this._bottomContiner.removeChild(this._bottomContiner.getChildByName("taskeffect2")))}},e.prototype.doRefreshChat=function(){if(this._chatTxt){this._chatTxt.text=Api.chatVoApi.getLastMessage();var t=ComponentManager.getTextField(Api.chatVoApi.getLastMessage(),TextFieldConst.FONTSIZE_CONTENT_SMALL);t.width>=480?this._chatTxtPoint.visible=!0:this._chatTxtPoint.visible=!1}},e.prototype.doQuickAlliance=function(){NetManager.chatServerLogout(null,null),Api.chatVoApi.refreshLastMessage(),this.doRefreshChat()},e.prototype.initButtom=function(){this._bottomContiner=new BaseDisplayObjectContainer,this._bottomContiner.setPosition(0,GameConfig.stageHeigth-this._bottomContiner.height),this.addChild(this._bottomContiner);var t=BaseBitmap.create(ResourceManager.getRes("mainui_bottombg"));t.x=0,t.y=-t.height,this._bottomContiner.addChild(t);var e=BaseBitmap.create(ResourceManager.getRes("mainui_btn3"));e.addTouchTap(this.goOutBtnClickHandler,this),e.anchorOffsetY=e.height/2,e.anchorOffsetX=e.width/2,e.x=10+e.width/2,e.y=t.y+t.height/2-2,this._bottomContiner.addChild(e),this._goOutBtn=e,egret.Tween.get(e,{loop:!0}).to({scaleX:.9,scaleY:.9},1e3).to({scaleX:1,scaleY:1},1e3);for(var i=95,a=0,n=0;n<this.bottomBtnCfg.length;n++){var o=this.bottomBtnCfg[n];if(o.isOPen){var s=ComponentManager.getButton(o.btnIconImg,"",this.bottomBtnClickHandler,this,[o]);s.x=168+i*a,s.y=-s.height-15,s.name=o.btnName,this._bottomContiner.addChild(s),a+=1}}this.checkAchPoint(),this.checkAllRedPoint();var r=BaseBitmap.create(ResourceManager.getRes("mainui_chatbg"));r.width=GameConfig.stageWidth,r.height=35,r.x=0,r.y=t.y-r.height-3,this._bottomContiner.addChild(r),r.touchEnabled=!0,r.addTouchTap(this.chatBgClickHandler,this);var l=BaseBitmap.create(ResourceManager.getRes("mainui_chatIcon"));l.anchorOffsetX=l.width/2,l.anchorOffsetY=l.height/2,l.x=l.width/2+10,l.y=r.y+r.height/2,this._bottomContiner.addChild(l),egret.Tween.get(l,{loop:!0}).to({scaleX:.8,scaleY:.8},1e3).to({scaleX:1,scaleY:1},1e3);var h=Api.chatVoApi.getLastMessage();if(h||(h="1"),this._chatTxt=ComponentManager.getTextField(h,TextFieldConst.FONTSIZE_CONTENT_SMALL),this._chatTxt.x=l.x+20,this._chatTxt.y=l.y-this._chatTxt.height/2,this._chatTxt.width=480,this._chatTxt.height=50,this._chatTxt.lineSpacing=50,this._bottomContiner.addChild(this._chatTxt),this._chatTxtPoint=ComponentManager.getTextField("...",TextFieldConst.FONTSIZE_CONTENT_SMALL),this._chatTxtPoint.x=522,this._chatTxtPoint.y=l.y-this._chatTxtPoint.height/2-5,this._chatTxtPoint.visible=!1,this._bottomContiner.addChild(this._chatTxtPoint),this.doRefreshChat(),this._taskContainer=new BaseDisplayObjectContainer,this._taskContainer.x=0,this._taskContainer.y=0,this._bottomContiner.addChild(this._taskContainer),!Api.switchVoApi.checkClosePay()){var d=BaseBitmap.create("mainui_functionpreview");d.name="functionPreviewBg",d.x=5,d.y=r.y-r.height-d.height-50,this._bottomContiner.addChild(d),this._functionPreviewBg=d,d.addTouchTap(this.functionClickHandler,this);var g=BaseBitmap.create("mainui_funicon");g.x=18,g.y=d.y+5,this._bottomContiner.addChild(g),this._functionIcon=g;var c=Api.otherInfoVoApi.getFunctionName(),p=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);p.x=d.x+75,p.y=d.y+15,p.text=c,this._functionTxt=p,this._bottomContiner.addChild(p),this.refreshText()}var _=BaseBitmap.create("mainui_taskbg170");_.name="taskBg",_.x=5,_.y=r.y-r.height-_.height+30,this._taskContainer.addChild(_),_.addTouchTap(this.missionBtnClickHandler,this);var u=BaseBitmap.create("mainui_missionIcon1");u.anchorOffsetX=u.width/2,u.anchorOffsetY=u.height/2,u.x=_.x+15+u.width/2,u.y=_.y+_.height/2,this._taskContainer.addChild(u),this._missionIcon=u,egret.Tween.get(this._missionIcon,{loop:!0}).to({scaleX:.8,scaleY:.8},700).to({scaleX:1,scaleY:1},700),this._taskTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL),this._taskTxt.x=u.x+45,this._taskTxt.y=u.y-10,this._taskContainer.addChild(this._taskTxt),this._settingAndMailContainer=new BaseDisplayObjectContainer,this._settingAndMailContainer.x=0,this._settingAndMailContainer.y=0,this._bottomContiner.addChild(this._settingAndMailContainer);var C=ComponentManager.getButton("mainui_bottomimg8","",this.settingBtnClickHandler,this);C.x=_.x+10,C.y=_.y-25-C.height,this._settingAndMailContainer.addChild(C);var f=BaseBitmap.create("mainui_bottombtnbg");f.x=C.x+C.width/2-f.width/2,f.y=C.y,this._settingAndMailContainer.addChildAt(f,0);var m=ComponentManager.getButton("mainui_bottomimg12","",this.mailBtnClickHandler,this);m.x=C.x,m.y=C.y-C.height-20,this._settingAndMailContainer.addChild(m),this._mailButton=m;var T=BaseBitmap.create("mainui_bottombtnbg");T.x=f.x,T.y=m.y,this._settingAndMailContainer.addChildAt(T,0),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_MYMAIL,this.checkMailState,this),this.doRefreshTaskInfo(),this.refreshTaskContainerStatus()},e.prototype.checkIsRefresh=function(){Api.otherInfoVoApi.getFunctionRedhot()&&this.refreshText()},e.prototype.refreshText=function(){if(this._functionTxt){null==Api.otherInfoVoApi.getFunctionName()?(this._bottomContiner.removeChild(this._functionPreviewBg),this._bottomContiner.removeChild(this._functionTxt),this._bottomContiner.removeChild(this._functionIcon),this._functionAni&&(this._bottomContiner.removeChild(this._functionAni),this._functionAni=null)):(this._functionTxt.text=Api.otherInfoVoApi.getFunctionName(),Api.otherInfoVoApi.getFunctionRedhot()?this._functionTxt.textColor=TextFieldConst.COLOR_WARN_GREEN:this._functionTxt.textColor=TextFieldConst.COLOR_WHITE,Api.otherInfoVoApi.getFunctionRedhot()?this._functionAni||(this._functionAni=ComponentManager.getCustomMovieClip("taskeffect_",8,100),this._functionAni.x=5,this._functionAni.y=-303,this._functionAni.name="taskeffect",this._bottomContiner.addChild(this._functionAni),this._functionAni.playWithTime(0)):this._functionAni&&(this._bottomContiner.removeChild(this._functionAni),this._functionAni=null));var t=this.getTopBtnByName("welfare");if(t){var e=Api.shopVoApi.getPayFlag(),i=Api.arrivalVoApi.isShowRedDot,a=Api.otherInfoVoApi.getFunctionRedhot();1==e||1==i||1==a?App.CommonUtil.addRedDotToBDOC(t):App.CommonUtil.removeRedDotFromBDOC(t)}}},e.prototype.refreshTaskContainerStatus=function(){if(this._isAtHome){if(this._iconContainer.visible=!0,this._settingAndMailContainer.visible=!1,1==Api.switchVoApi.checkTWShenhe())for(var t in this._activityIconList){var e=this._activityIconList[t];"welfare_func"==e.name?e.setPosition(30+e.width/2,e.height/2):e.visible=!1}}else this._iconContainer.visible=!1,this._settingAndMailContainer.visible=!0},e.prototype.roleHeadClickHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.PLAYERVIEW)},e.prototype.functionClickHandler=function(){Api.rookieVoApi.isInGuiding||ViewController.getInstance().openView(ViewConst.COMMON.WELFAREVIEWFUNCTIONPREVIEW)},e.prototype.mailBtnClickHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.MAILPOPUPVIEW)},e.prototype.settingBtnClickHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.SettingPopopView,{})},e.prototype.missionBtnClickHandler=function(){return null==Api.mainTaskVoApi.getCurMainTaskId()?void ViewController.getInstance().openView(ViewConst.COMMON.DAILYTASKVIEW):void ViewController.getInstance().openView(ViewConst.POPUP.MainTASKPOPUPVIEW)},e.prototype.chatBgClickHandler=function(){Api.rookieVoApi.isInGuiding||ViewController.getInstance().openView(ViewConst.COMMON.CHATVIEW)},e.prototype.addGoldBtnClickHandler=function(){},e.prototype.doDinnerGuide=function(){this._isAtHome&&this.goOutBtnClickHandler()},e.prototype.goOutBtnClickHandler=function(){this._isAtHome=!this._isAtHome,this._isAtHome?(this._goOutBtn.texture=ResourceManager.getRes("mainui_btn3"),this._functionPreviewBg&&(this._functionPreviewBg.visible=!0,this._functionTxt.visible=!0,this._functionIcon.visible=!0,this._functionAni&&(this._functionAni.visible=!0))):(this._functionPreviewBg&&(this._functionPreviewBg.visible=!1,this._functionTxt.visible=!1,this._functionIcon.visible=!1,this._functionAni&&(this._functionAni.visible=!1)),this._goOutBtn.texture=ResourceManager.getRes("mainui_btn3_1")),this.refreshTaskContainerStatus(),SceneController.getInstance().jump(),Api.rookieVoApi.checkNextStep()},e.prototype.bottomBtnClickHandler=function(t){var e=t.btnName;switch(e){case"servant":ViewController.getInstance().openView(ViewConst.COMMON.SERVANTVIEW);break;case"item":ViewController.getInstance().openView(ViewConst.COMMON.ITEMVIEW_TAB1);break;case"dailytask":ViewController.getInstance().openView(ViewConst.COMMON.DAILYTASKVIEW);break;case"achieve":ViewController.getInstance().openView(ViewConst.COMMON.ACHIEVEMENTVIEW);break;case"shop":ViewController.getInstance().openView(ViewConst.COMMON.SHOPVIEW_TAB1);break;case"welfare":App.LogUtil.log("welfareCkick >>>> ");break;case"challenge":ViewController.getInstance().openView(ViewConst.COMMON.CHALLENGEVIEW);break;case"manage":ViewController.getInstance().openView(ViewConst.COMMON.MANAGEVIEW)}},e.prototype.getResourceList=function(){return["mainui_btn1","mainui_fg","mainui_taskbg170","mainui_bottombg","mainui_missionIcon1","mainui_missionIcon2","mainui_bottomimg1","mainui_bottomimg2","mainui_bottomimg3","mainui_bottomimg4","mainui_bottomimg5","mainui_bottomimg8","mainui_bottomimg12","mainui_bottombtnbg","mainui_chatbg","mainui_chatIcon","mainui_image26","mainui_btn3","mainui_avatarFlower","mainui_headbg","mainui_btn3_1","mainui_iconani","mainui_functionpreview","mainui_funicon","taskeffect","studyatk_arrow"]},e.prototype.getParent=function(){return LayerManager.uiLayer},e.prototype.getTopBtnByName=function(t){for(var e=this._activityIconList.length,i=0;e>i;i++){var a=this._activityIconList[i];if(a&&a.name&&a.name.split("_")[0]==t)return a}return null},e.prototype.checkFirstRechargeIcon=function(){if(2==Api.shopVoApi.getPayFlag())this.removeMainUIIcon("firstrecharge");else{var t=this.createMainUIIcon("firstrecharge");1==Api.shopVoApi.getPayFlag()?App.CommonUtil.addRedDotToBDOC(t):App.CommonUtil.removeRedDotFromBDOC(t)}},e.prototype.checkWelfareState=function(){var t=this.getTopBtnByName("welfare");if(t){var e=Api.shopVoApi.getPayFlag(),i=Api.arrivalVoApi.isShowRedDot,a=Api.otherInfoVoApi.getFunctionRedhot();1==e||1==i||1==a?App.CommonUtil.addRedDotToBDOC(t):App.CommonUtil.removeRedDotFromBDOC(t)}this.checkFirstRechargeIcon(),this.checkCardIcon(),this.initCardIcons(),this.checkSignState()},e.prototype.checkSignState=function(){this.initSignIcons()},e.prototype.checkActivityIconState=function(){for(var t=this._activityIconList.length,e=0;t>e;e++){var i=this._activityIconList[e];if((!i.name||"func"!=i.name.split("_")[1])&&i&&"welfare"!=i.name){var a=i.name,n="",o="";n=a.split("-")[0],o=a.split("-")[1];var s=void 0,r=Config.IconorderCfg.getAidListByCfgName(n);if(r&&r.length>0)for(var l=r,h=0;h<l.length;h++)s||(s=Api.acVoApi.checkShowRedDotByAid(l[h],null));else s=Api.acVoApi.checkShowRedDotByAid(n,o);1==s?App.CommonUtil.addRedDotToBDOC(i):App.CommonUtil.removeRedDotFromBDOC(i)}}},e.prototype.checkMailState=function(){Api.mailVoApi.getUnreadNum()>0?App.CommonUtil.addRedDotToBDOC(this._mailButton):App.CommonUtil.removeRedDotFromBDOC(this._mailButton)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_RESCHANGE_REFRESH_UI,this.doRefreshTaskInfo,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_ACHIEVEMENT,this.checkAchPoint,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_TASK_GETMAINTASK),this.doRefreshTaskInfo,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_RESFESH_DAILYTASK_AFTER_SYNC,this.doRefreshTaskInfo,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_CHAT_COME,this.doRefreshChat,this),App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_ALLIANCE_EXITALLIANCE,this.doQuickAlliance,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_MESSAGE_ALLIANCE_BEKICK,this.doQuickAlliance,this),App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_ACTIVITY_GETACTIVECFG,this.initIconsAndCheckStatus,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_MYMAIL,this.checkMailState,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_SHOP,this.checkWelfareState,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_ARRIVAL,this.checkWelfareState,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_ACTIVITY,this.checkActivityIconState,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_REFRESH_MODE,this.checkRedPointByModel,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_OTHERINFO,this.checkWanBaIcon,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_DINNER_GUIDE,this.doDinnerGuide,this),App.MessageHelper.removeNetMessage(NetManager.getMessageName(NetRequestConst.REQUEST_OTHERINFO_GETUNLOCKLISTREWARD),this.refreshText,this),App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_OTHERINFO_GETUNLOCKLISTREWARD,this.checkWelfareState,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_REFRESH_FUNCTION_TXT,this.checkIsRefresh,this),App.MessageHelper.removeNetMessage(NetManager.getMessageName(NetRequestConst.REQUEST_USER_UPGRADE),this.checkIsRefresh,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_OTHERINFO,this.initCoverIcon,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_OTHERINFO,this.initBindIcon,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_REALNAME,this.createRealnameRedHot,this),TickManager.removeTick(this.tick,this),this._topContiner=null,this._bottomContiner=null,this._settingAndMailContainer=null,this._goOutBtn=null,this._mailButton=null,this._settingButton=null,this._taskContainer=null,this._isAtHome=!1,this._chatTxt=null,this._taskTxt=null,this._lampRoll=null,this._mailRedDotSp=null,this._achRedDotSp=null,this._activityIconList.length=0,this._iconNameList={},this._functionPreviewBg=null,this._signName=null,this._functionIcon=null,this._functionAni=null,this._lastL=0,t.prototype.dispose.call(this)},e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e}(BaseLoadDisplayObjectContiner);__reflect(MainUI.prototype,"MainUI");var MainUINewTop=function(t){function e(e){var i=t.call(this)||this;return i._isShowName=e?e.showName:!1,egret.callLater(i.show,i),i}return __extends(e,t),e.prototype.getResourceList=function(){return["mainui_newheadbg","mainui_newtopbg","office_fnt"]},e.prototype.getParent=function(){return null},e.prototype.show=function(e){t.prototype.show.call(this,e)},e.prototype.init=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_RESCHANGE_REFRESH_UI,this.refresh,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_CHANGE_IMG,this.changeImgNotify,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.refresh,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_REFRESH_SPECIAL_AVATAR,this.changeImgNotify,this);var t=0,e=BaseBitmap.create("mainui_newtopbg");e.touchEnabled=!0,e.y=t,this.addChildAt(e,0),t=e.y+e.height;var i=Api.playerVoApi.getPlayerCircleHead(Api.playerVoApi.getPlayePicId());i.width=112,i.height=135,i.name="headImg",i.setPosition(2,5),this.addChild(i),i.addTouchTap(this.roleHeadClickHandler,this),this._headContiner=i,this.headImg=i.getChildByName("myHead"),this.headBg=i.getChildByName("myBody");var a=22,n=TextFieldConst.COLOR_LIGHT_YELLOW;this._nickNameText=ComponentManager.getTextField(Api.playerVoApi.getPlayerName(),a,n),this._nickNameText.anchorOffsetX=this._nickNameText.width/2,this._nickNameText.setPosition(190,16),this.addChild(this._nickNameText),this._officerText=ComponentManager.getBitmapText(Api.playerVoApi.getPlayerOffice(),"office_fnt"),this._officerText.anchorOffsetX=this._officerText.width/2,this._officerText.setScale(.8),this._officerText.x=45,this._officerText.y=73,this.addChild(this._officerText),this._powerValueText=ComponentManager.getTextField(Api.playerVoApi.getPlayerPowerStr(),a,n),this._powerValueText.setPosition(340,this._nickNameText.y),this.addChild(this._powerValueText),this._gemValueText=ComponentManager.getTextField(Api.playerVoApi.getPlayerGemStr(),a,n),this._gemValueText.setPosition(510,this._nickNameText.y),this.addChild(this._gemValueText),this._goldValueText=ComponentManager.getTextField(Api.playerVoApi.getPlayerGoldStr(),TextFieldConst.FONTSIZE_CONTENT_COMMON,16642792),this._goldValueText.setPosition(160,68),this.addChild(this._goldValueText),this._foodValueText=ComponentManager.getTextField(Api.playerVoApi.getFoodStr(),TextFieldConst.FONTSIZE_CONTENT_COMMON,16642792),this._foodValueText.setPosition(this._powerValueText.x,this._goldValueText.y),this.addChild(this._foodValueText),this._soldierValueText=ComponentManager.getTextField(Api.playerVoApi.getSoldierStr(),TextFieldConst.FONTSIZE_CONTENT_COMMON,16642792),this._soldierValueText.setPosition(this._gemValueText.x,this._goldValueText.y),this.addChild(this._soldierValueText);var o=ComponentManager.getButton("mainui_btn1","",this.addGoldBtnClickHandler,this);o.y=7,o.x=GameConfig.stageWidth-o.width-o.y,this.addChild(o),Api.switchVoApi.checkClosePay()&&(o.visible=!1),this.refreshUpgradeClip()},e.prototype.refreshUpgradeClip=function(){var t=Api.playerVoApi.getPlayerLevel(),e=Config.LevelCfg.getCfgByLevel((t+1).toString());if(e&&Api.playerVoApi.getPlayerExp()>=e.exp){if(!this._upgradeClip){this._upgradeClip=ComponentManager.getCustomMovieClip("mainui_fg",10,100),this._upgradeClip.anchorOffsetX=this._upgradeClip.width/2,this._upgradeClip.anchorOffsetY=this._upgradeClip.height,this._upgradeClip.x=-17,this._upgradeClip.y=-13;var i=this.getChildIndex(this.getChildByName("headImg"));this.addChildAt(this._upgradeClip,i+2),this._upgradeClip.playWithTime(0)}}else this._upgradeClip&&(this._upgradeClip.stop(),this.removeChild(this._upgradeClip),this._upgradeClip=null)},e.prototype.addGoldBtnClickHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.roleHeadClickHandler=function(){PlayerBottomUI.getInstance().show()},e.prototype.refresh=function(){this._gemValueText.text=Api.playerVoApi.getPlayerGemStr(),this._soldierValueText.text=Api.playerVoApi.getSoldierStr(),this._foodValueText.text=Api.playerVoApi.getFoodStr(),this._goldValueText.text=Api.playerVoApi.getPlayerGoldStr(),this._officerText.text=Api.playerVoApi.getPlayerOffice(),this._powerValueText.text=Api.playerVoApi.getPlayerPowerStr(),this._isShowName&&(this._nickNameText.text=Api.playerVoApi.getPlayerName(),this._nickNameText.anchorOffsetX=this._nickNameText.width/2),this.refreshUpgradeClip()},e.prototype.changeImgNotify=function(){var t="user_head"+Api.playerVoApi.getPlayePicId();this.headImg.setload(t);var e=Api.playerVoApi.getVipHeadBg();e&&(this.headBg.texture=ResourceManager.getRes(e))},e.prototype.checkPrestigeRedDot=function(){Api.switchVoApi.checkOpenPrestige()&&(Api.prestigeVoApi.isShowRedDot?App.CommonUtil.addRedDotToBDOC(this._headContiner):App.CommonUtil.removeRedDotFromBDOC(this._headContiner))},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_RESCHANGE_REFRESH_UI,this.refresh,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_CHANGE_IMG,this.changeImgNotify,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.refresh,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_REFRESH_SPECIAL_AVATAR,this.changeImgNotify,this),this.headImg=null,this._nickNameText=null,this._powerValueText=null,this._officerText=null,this._soldierValueText=null,this._foodValueText=null,this._goldValueText=null,this._gemValueText=null,this._isShowName=!1,this._upgradeClip=null,this.headBg=null,this._headContiner=null,t.prototype.dispose.call(this)},e}(BaseLoadDisplayObjectContiner);__reflect(MainUINewTop.prototype,"MainUINewTop");var MainUITop=function(t){function e(e){var i=t.call(this)||this;return i._isShowName=e?e.showName:!1,egret.callLater(i.show,i),i}return __extends(e,t),e.prototype.getResourceList=function(){return["mainui_topinfobg","mainui_topnamebg","mainui_topresbg","mainui_fg"]},e.prototype.getParent=function(){return null},e.prototype.show=function(e){t.prototype.show.call(this,e)},e.prototype.init=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_RESCHANGE_REFRESH_UI,this.refresh,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_CHANGE_IMG,this.changeImgNotify,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.refresh,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_REFRESH_SPECIAL_AVATAR,this.changeImgNotify,this);var t=0,e=!1;if(this._isShowName){e=!0;var i=BaseBitmap.create("mainui_topnamebg");i.touchEnabled=!0,this.addChild(i),t=i.y+i.height-5,this._nickNameText=ComponentManager.getTextField("1",26,TextFieldConst.COLOR_BLACK),this._nickNameText.width=200,this._nickNameText.textAlign=egret.HorizontalAlign.CENTER;var a=App.CommonUtil.getCenterPos(i,this._nickNameText,!1),n=a.x,o=a.y;this._nickNameText.setPosition(n,o-1),this._nickNameText.text=Api.playerVoApi.getPlayerName(),this.addChild(this._nickNameText)}var s=BaseBitmap.create("mainui_topinfobg");s.touchEnabled=!0,s.y=t,this.addChildAt(s,0),t=s.y+s.height;var r=BaseBitmap.create("mainui_headbg");r.setPosition(60,App.CommonUtil.getCenterY(s,r,!1)),r.name="headBg",this.addChild(r);var l=Api.playerVoApi.getPlayerCircleHead(Api.playerVoApi.getPlayePicId());l.width=112,l.height=135,l.setPosition(3,r.y-5),this.addChild(l),l.addTouchTap(this.roleHeadClickHandler,this),this.headImg=l.getChildByName("myHead"),this.headBg=l.getChildByName("myBody"),this._powerValueText=ComponentManager.getTextField(LanguageManager.getlocal("mainui_shili")+Api.playerVoApi.getPlayerPowerStr(),TextFieldConst.FONTSIZE_CONTENT_COMMON,16642792),this._powerValueText.setPosition(l.x+100,r.y+12),this.addChild(this._powerValueText),this._officerText=ComponentManager.getTextField(LanguageManager.getlocal("mainui_officer")+Api.playerVoApi.getPlayerOffice(),this._powerValueText.size,this._powerValueText.textColor),this._officerText.x=this._powerValueText.x,this._officerText.y=this._powerValueText.y+42,this.addChild(this._officerText);for(var h=(C={},C[0]={iconImg:"public_icon2",iconValue:Api.playerVoApi.getPlayerGold()},C[1]={iconImg:"public_icon4",iconValue:Api.playerVoApi.getSoldier()},C[2]={iconImg:"public_icon3",iconValue:Api.playerVoApi.getFood()},C[3]={iconImg:"public_icon1",iconValue:Api.playerVoApi.getPlayerGem()},C),d=0;4>d;d++){var g=BaseBitmap.create("mainui_topresbg");g.setPosition(r.x+r.width+d%2*150,r.y+10+42*Math.floor(d/2)),this.addChild(g),t=g.y+g.height/2;var c=h[d.toString()],p=BaseBitmap.create(c.iconImg);p.setPosition(g.x-p.width/2,g.y+g.height-p.height+5),this.addChild(p);var _=ComponentManager.getTextField(App.StringUtil.changeIntToText(c.iconValue),TextFieldConst.FONTSIZE_CONTENT_SMALL,this._powerValueText.textColor);_.setPosition(p.x+p.width+5,App.CommonUtil.getCenterY(g,_,!1)),this.addChild(_),0==d?this._goldValueText=_:1==d?this._soldierValueText=_:2==d?this._foodValueText=_:3==d&&(this._gemValueText=_)}var u=ComponentManager.getButton("mainui_btn1","",this.addGoldBtnClickHandler,this);u.x=GameConfig.stageWidth-52,u.y=t-u.height/2,this.addChild(u),Api.switchVoApi.checkClosePay()&&(u.visible=!1),this.refreshUpgradeClip();var C},e.prototype.refreshUpgradeClip=function(){var t=Api.playerVoApi.getPlayerLevel(),e=Config.LevelCfg.getCfgByLevel((t+1).toString());if(e&&Api.playerVoApi.getPlayerExp()>=e.exp){if(!this._upgradeClip){this._upgradeClip=ComponentManager.getCustomMovieClip("mainui_fg",10,100),this._upgradeClip.anchorOffsetX=this._upgradeClip.width/2,this._upgradeClip.anchorOffsetY=this._upgradeClip.height,this._upgradeClip.x=-17,this._upgradeClip.y=-13,this._isShowName&&(this._upgradeClip.y=38);var i=this.getChildIndex(this.getChildByName("headBg"));this.addChildAt(this._upgradeClip,i+2),this._upgradeClip.playWithTime(0)}}else this._upgradeClip&&(this._upgradeClip.stop(),this.removeChild(this._upgradeClip),this._upgradeClip=null)},e.prototype.addGoldBtnClickHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.roleHeadClickHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.PLAYERVIEW)},e.prototype.refresh=function(){this._gemValueText.text=Api.playerVoApi.getPlayerGemStr(),this._soldierValueText.text=Api.playerVoApi.getSoldierStr(),this._foodValueText.text=Api.playerVoApi.getFoodStr(),this._goldValueText.text=Api.playerVoApi.getPlayerGoldStr(),this._officerText.text=LanguageManager.getlocal("mainui_officer")+Api.playerVoApi.getPlayerOffice(),this._powerValueText.text=LanguageManager.getlocal("mainui_shili")+Api.playerVoApi.getPlayerPower(),this._isShowName&&(this._nickNameText.text=Api.playerVoApi.getPlayerName(),this._nickNameText.x=this.width/2-this._nickNameText.width/2),this.refreshUpgradeClip()},e.prototype.changeImgNotify=function(){var t="user_head"+Api.playerVoApi.getPlayePicId();this.headImg.setload(t);var e=Api.playerVoApi.getVipHeadBg();e&&(this.headBg.texture=ResourceManager.getRes(e))},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_RESCHANGE_REFRESH_UI,this.refresh,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_CHANGE_IMG,this.changeImgNotify,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.refresh,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_REFRESH_SPECIAL_AVATAR,this.changeImgNotify,this),this.headImg=null,this._nickNameText=null,this._powerValueText=null,this._officerText=null,this._soldierValueText=null,this._foodValueText=null,this._goldValueText=null,this._gemValueText=null,this._isShowName=!1,this._upgradeClip=null,this.headBg=null,t.prototype.dispose.call(this)},e}(BaseLoadDisplayObjectContiner);__reflect(MainUITop.prototype,"MainUITop");var LanguageManager;!function(t){function e(t){var e=r[t];return e?!0:!1}function i(e,i){var a;if(a=Api.switchVoApi.checkOpenNewPrison()&&t.checkHasKey(e+"_laoyiType")?r[e+"_laoyiType"]:Api.switchVoApi.checkCloseText()&&t.checkHasKey(e+"_hexieType")?r[e+"_hexieType"]:r[e],void 0==a)return GameData.isLocal()?"缺少字段:"+e:"**";for(var n=new RegExp("#.*#");-1!=a.search(n);){var o=a.search(n),s=a.substring(o+1),l=s.search("#"),h="",d="";if(o>=1&&(h=a.substring(0,o)),l<a.length&&-1!=l&&(d=a.substring(o+l+2)),-1!=l){var g=a.substring(o+1,o+l+1);a=h+r[g]+d}else a=h+d;if(a.indexOf("#"+e+"#")>-1){console.log("cn配置引用死循环:"+e+"，跳出");break}}return App.StringUtil.formatLocalLanuageValue(a,i)}function a(t,e){App.LogUtil.log("startload cn");var i;i=RES.hasRes(PlatformManager.getSpid())?PlatformManager.getSpid():"cn",ResourceManager.loadItem(i,function(i){App.LogUtil.log("loadcomplete cn"),r=i,t&&t.apply(e)},this)}function n(t){r=t}function o(t){l=t.ret?[]:t.slice()}function s(){var t=null;if(l.length){var e=Math.floor(Math.random()*l.length);t=l[e]}return t}var r=void 0;t.checkHasKey=e,t.getlocal=i,t.loadJson=a,t.setData=n;var l=[];t.setShareText=o,t.getShareDesc=s}(LanguageManager||(LanguageManager={}));var LoginManager;!function(t){function e(){v||(NetLoading.show(),v=!0)}function i(){v&&(NetLoading.hide(),v=!1)}function a(){App.LoginResLoader.isLoginResLoaded?e():(e(),ViewController.getInstance().hideView(ViewConst.BASE.LOGINVIEW)),NetManager.socket.isConnected()?s():(GameData.curZoneID=Number(ServerCfg.selectServer.zid),App.LogUtil.log("loginmanager开始连接游戏socket"),NetManager.socket.connect(ServerCfg.selectServer.ip_server,Number(ServerCfg.selectServer.port_server),s,t)),App.LoginResLoader.loadPublicRes()}function n(){var t=LocalStorageManager.get(LocalStorageConst.LOCAL_USER_NAME);
return PlatformManager.userId?PlatformManager.userId:t}function o(){var t=LocalStorageManager.get(LocalStorageConst.LOCAL_PASSWORD);return t?t:GameData.tmpUserPassword}function s(){App.LogUtil.log("游戏Socket连接成功");var t,e,i;t=PlatformManager.userId,e=GameData.tmpUserPassword;var a=ServerCfg.baseUrl+ServerCfg.serverTokenUrl+"?pm=",n=GameData.curZoneID;null!=GameData.curOldZoneID&&0!=GameData.curOldZoneID&&(n=GameData.curOldZoneID);var o=Date.now().toString(),s="username="+t+"&zoneid="+n+"&newzoneid="+GameData.curZoneID+"&password="+e+"&ts="+o,l=GameData.getCurPlatName(),h=App.DeviceUtil.isIOS()?"IOS":"Android",d=GameData.getCountry();null!=i&&""!=i&&(s=s+"&gaccount="+i),s=s+"&platform="+l+"&device="+h+"&area="+d+"&rayparms=1",App.LogUtil.log("加密前 "+s),s=Base64.encode(s),App.LogUtil.log("截取之前 "+s);var g=s.substr(0,2);App.LogUtil.log("取到的qStr "+g);var c=s.substr(2);App.LogUtil.log("截取后的hStr"+c),App.LogUtil.log("时间戳加密前 "+o);var p=Base64.encode(o);App.LogUtil.log("时间戳加密后 "+p),s=g+p.substr(0,5)+c,App.LogUtil.log("组合之后",s),App.LogUtil.log("组合的各个部分",g,p.substr(0,5),c),a+=s,App.LogUtil.log("getAccessToken:"+a),NetManager.http.post(a,null,r,u,null)}function r(t){var e=NetManager.checkServerData(t),a=e.ret;if(0==a)return i(),App.CommonUtil.showTip(LanguageManager.getlocal("loginFail")),ViewController.getInstance().openView(ViewConst.BASE.LOGINVIEW),void PlatformManager.analyticsLoadEnd();e=e.data,e.access_token&&(GameData.access_token=e.access_token),e.logints&&(GameData.logints=e.logints,GameData.serverTime=e.logints),e.statisticsId&&(GameData.statisticsId=e.statisticsId);var n=e.uid;GameData.userId=n;var o=!1;if(e.hasOwnProperty("gconfig")&&null!=e.gconfig&&e.gconfig.hasOwnProperty("zoneid")&&null!=e.gconfig.zoneid&&typeof e.gconfig.zoneid==typeof{}){var s,r=0;for(s in e.gconfig.zoneid)r++;if(0==r)o=!0;else for(s in e.gconfig.zoneid)if(e.gconfig.zoneid[s]==GameData.curZoneID){o=!0;break}if(1==o&&e.gconfig&&-9999==e.gconfig.status)return;1==o&&e.gconfig&&-9998==e.gconfig.status}(null==e.gconfig||-9999!=e.gconfig.status)&&(null!=e.client_ip&&(GameData.client_ip=e.client_ip),l())}function l(){if(GameConfig.isLoaded){App.MessageHelper.hasEventListener(MessageConst.MESSAGE_GAMECONFIG_LOADED)&&App.MessageHelper.removeEventListener(MessageConst.MESSAGE_GAMECONFIG_LOADED,l,t),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USER_LOGIIN),g,null);var e={plat:PlatformManager.getAppid(),enter:!0},i=PlatformManager.getGiftId();i&&(e.giftid=i),PlatformManager.getCandyFlag()&&(e.candyflag=PlatformManager.getCandyFlag()),PlatformManager.checkIsWanbaSp()&&(e.source=PlatformManager.getFromQZonePet()),PlatformManager.checkUseRSDKSocket()&&(e.clientSocket="1");var a=PlatformManager.getSpName();if(a&&(e.platName=a),PlatformManager.checkIs3KSp()){var n=PlatformManager.getChannelId();n&&(e.channel_id=n),console.log("channelid:"+n)}PlatformManager.checkIsTWBSp()&&(PlatformManager.checkIsTwWeb()?e.downType="pc":e.downType="app"),PlatformManager.checkIsWanbaSp()&&App.DeviceUtil.isAndroid()&&(qqwanbaplugin.checkIsFromMicroEnd()?e.downType="wd":e.downType="nwd"),PlatformManager.inviter_uid&&(e.inviteUid=PlatformManager.inviter_uid,PlatformManager.checkIsFkylcSp()||(e.platUrl=PlatformManager.avatar),e.inviter_pid=PlatformManager.inviter_pid),NetManager.request(NetRequestConst.REQUEST_USER_LOGIIN,e)}else App.MessageHelper.addEventListener(MessageConst.MESSAGE_GAMECONFIG_LOADED,l,t)}function h(){App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_USER_LOGIIN,d,t);var e={},i=PlatformManager.getSpName();if(i&&(e.platName=i),PlatformManager.getCandyFlag()&&(e.candyflag=PlatformManager.getCandyFlag()),PlatformManager.checkIs3KSp()){var a=PlatformManager.getChannelId();a&&(e.channel_id=a)}PlatformManager.checkUseRSDKSocket()&&(e.clientSocket="1"),NetManager.request(NetRequestConst.REQUEST_USER_LOGIIN,e)}function d(e){NetLoading.hide(),App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_USER_LOGIIN,d,t),g(e)}function g(e){if(App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USER_LOGIIN),g,null),PlatformManager.checkIs3kQianYiSp()&&Api.switchVoApi.checkOpen3kQianYi())return i(),void ViewController.getInstance().openView(ViewConst.POPUP.SETPASSWORDPOPUPVIEW);var a=e.data,n=a.ret;a.data;n?(i(),ViewController.getInstance().hideView(ViewConst.BASE.LOGINVIEW),Api.playerVoApi.getPlayerName()||PlatformManager.analyticsRegister(),PlatformManager.analyticsLogin(),t.isLoginSuccess=!0,""==Api.playerVoApi.getPlayerName()?(StatisticsHelper.reportLoadData(15),App.LoginResLoader.setNeedLoadGuideRes(),ViewController.getInstance().openView(ViewConst.COMMON.GUIDECREATEUSERVIEW)):(9999==Api.gameinfoVoApi.getGuideStep()||Api.rookieVoApi.isInGuiding||(PlatformManager.analyticsNewGuide(RookieCfg.getRookieCfg("guideSteps")),NetManager.request(NetRequestConst.REQUEST_USER_NEWERGUILD,{step:9999})),t.waitToCheckLoadGuide&&(t.waitToCheckLoadGuide=!1,App.LoginResLoader.isLoginResLoaded=!0),App.LoginResLoader.isLoginResLoaded&&StatisticsHelper.reportLoadData(15),f()),p()):(i(),NetManager.socket.dispose(),ViewController.getInstance().openView(ViewConst.POPUP.ERRORPOPUPVIEW,{msg:LanguageManager.getlocal("loginFailDesc")}))}function c(){Api.chatVoApi.clearChat(),_()}function p(){ServerCfg.selectServer&&(NetManager.chat.isConnected()||NetManager.chat.connect(ServerCfg.selectServer.ip_chat,Number(ServerCfg.selectServer.port_chat),_,t))}function _(){NetManager.chatServerLogin(null,null)}function u(t){i(),NetManager.socket.dispose(),ViewController.getInstance().openView(ViewConst.POPUP.ERRORPOPUPVIEW,{msg:LanguageManager.getlocal("loginFailDesc"),callback:s})}function C(){console.log("checkAndCreateScene"+App.LoginResLoader.isLoginResLoaded+t.isLoginSuccess+y),App.LoginResLoader.isLoginResLoaded&&t.isLoginSuccess&&y&&(t.isCreateScene||(SceneController.getInstance().goHome(),MainUI.getInstance().show()),LoginLoading.hide(),t.isCreateScene=!0)}function f(){y||(y=!0),y&&C()}function m(){App.LoginResLoader.dispose(),Config.AcCfg.isGetAll=!1,t.waitToCheckLoadGuide=!1,SceneController.getInstance().dispose(),MainUI.getInstance().hide(),ViewController.getInstance().hideAllView(),NetManager.socket.dispose(),NetManager.chat.dispose(),NetManager.http.dispose(),TickManager.stopTick(),App.DragonBonesUtil.clear(),Api.dispose(),GameData.dispose(),StatisticsHelper.clearReportData(),t.isLoginSuccess=!1,NetLoading.hideForChangeAccount();var e=ViewController.getInstance().getView(ViewConst.BASE.LOGINVIEW);e?e.isInit()||e.isShow()||ViewController.getInstance().openView(ViewConst.BASE.LOGINVIEW):ViewController.getInstance().openView(ViewConst.BASE.LOGINVIEW),t.isCreateScene=!1}function T(){PlatformManager.isLogin=!1,GameData.kkkIsBindIos="0",m()}t.isCreateScene=!1;var y=!1,v=!1;t.waitToCheckLoadGuide=!1,t.isLoginSuccess=!1,t.showLoginLoading=e,t.hideLoginLoading=i,t.login=a,t.getLocalUserName=n,t.getUserPassword=o,t.reLoginGame=h,t.reLoginChat=c,t.checkAndCreateScene=C,t.completeGuideForLogin=f,t.changeServer=m,t.changeAccount=T}(LoginManager||(LoginManager={}));var NetManager;!function(t){function e(e,i){p++,i=o(e,i),t.socket.send(i,s,t)}function i(e){var i=e.channel,a=Api.playerVoApi.getPlayerName(),n="",o=e.message,s=(GameData.serverTime,{});s.type="chat",s.channel=i,s.sender=Api.playerVoApi.getPlayerID(),s.sendername=a,s.recivername=n,s.content={message:o,pic:Api.playerVoApi.getPlayePicId(),vip:Api.playerVoApi.getPlayerVipLevel(),title:Api.playerVoApi.getTitleid(),headBg:Api.playerVoApi.getVipHeadBg(),sign:Api.chatVoApi.getChatSign()},s.ts=GameData.serverTime,s.zoneid=GameData.curZoneID,App.LogUtil.log("发送聊天数据",s),t.chat.send(s)}function a(e,i){var a={};a.type="quit",a.uid=Api.playerVoApi.getPlayerID(),a.nickname=Api.playerVoApi.getPlayerName(),a.access_token=GameData.access_token,a.ts=GameData.logints;var n=Api.chatVoApi._lastAllianceId;0!=n&&(a.channel=Number(n)),App.LogUtil.log("登出聊天服务器",a),t.chat.send(a,e,i)}function n(e,i){var a={};a.type="login",a.uid=Api.playerVoApi.getPlayerID()?Api.playerVoApi.getPlayerID():0,a.nickname=Api.playerVoApi.getPlayerName(),a.access_token=GameData.access_token,a.ts=GameData.logints;var n=Api.playerVoApi.getPlayerAllianceId();0!=n&&(a.channel=n);var o=Base64.encode(App.MathUtil.getRandom(10,99)+GameData.logints.toString()),s=o.substr(0,2),r=o.substr(2),l=Base64.encode((2.3*App.MathUtil.getRandom(5,1e6)).toString()),h=s+l.substr(0,5)+r;a.pstr=h,App.LogUtil.log("登陆聊天服务器",a),t.chat.send(a),Api.chatVoApi._lastAllianceId=n}function o(t,e){var i={},a=e?e:{};if(t!=NetRequestConst.REQUEST_CLIENT_CHAT){switch(t){case NetRequestConst.REQUEST_USER_LOGIIN:a.client_ip=GameData.client_ip,a.pid=PlatformManager.userId}i.cmd=t,i.params=a,i.uid=GameData.userId,i.ts=GameData.serverTime,i.logints=GameData.logints,i.rnum=p,i.zoneid=GameData.curZoneID,i.access_token=GameData.access_token}return i}function s(e,i){if(e){e.cmd&&(t.curReceiveCmd=e.cmd);var a=e.data,n=!1;if(e.cmd&&e.cmd==NetRequestConst.REQUEST_USER_LOGIIN){if(LocalStorageManager.set(LocalStorageConst.LOCAL_USER_NAME,PlatformManager.userId),LocalStorageManager.set(LocalStorageConst.LOCAL_PASSWORD,GameData.tmpUserPassword),!i)return GameConfig.switchNewOrOldCfg(null!=a.newCfgFlag,function(){s(e,!0)},t);if(a&&a.notices&&(GameData.announcementData=e.data.notices),a&&null!=a.wbrewards&&(GameData.wbrewards=a.wbrewards),a&&null!=a.wbrewardsFlag&&(GameData.wbrewardsFlag=a.wbrewardsFlag),a&&null!=a.candyflag&&(GameData.candyflag=a.candyflag),a&&null!=a.closeSource&&(GameData.closeSource=a.closeSource),RSDKHelper.isInit&&(PlatformManager.checkIsWanbaSp()||PlatformManager.checkIs4399Sp()||PlatformManager.checkIsAiweiyouSp()||PlatformManager.checkIsFkylcSp())){var o=e.uid;egret.callLater(function(){RSDKHelper.setShareInfo(o)},null,e.uid)}n=!0}a&&a.limitVipLv&&(GameData.limitVipLv=a.limitVipLv,GameData.limitVipLv.sort(function(t,e){return t-e})),a&&null!=a.chatlevel&&(GameData.chatlevel=a.chatlevel),a&&null!=a.gamebarmsg&&PlatformManager.pushMsg(a.gamebarmsg),null!=e.timezone&&(GameData.timeZone=e.timezone);var r=d(e);if(0==r.ret){if(-125==r.data.ret&&ViewController.getInstance().openView(ViewConst.POPUP.OFFLINEVIEW,{title:"itemUseConstPopupViewTitle",msg:LanguageManager.getlocal("accountprompting"),callback:this.refreshHandler,handler:this,needCancel:!1}),-999==r.data.ret){var l=LanguageManager.getlocal("accountLock");return ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"itemUseConstPopupViewTitle",msg:l,callback:this.doDis,handler:this,needCancel:!1}),void NetLoading.hide()}}else{if(Api.formatData(a,e.cmd),a.unlockServant&&!a.unlockWife)if(e.cmd==NetRequestConst.REQUEST_USER_UPGRADE){var h={unlockServant:a.unlockServant};Api.servantVoApi.setWaitShowData(h)}else ViewController.getInstance().openView(ViewConst.BASE.SERVANTGETVIEW,a.unlockServant);if(a.unlockWife&&e.cmd!=NetRequestConst.REQUEST_USER_LOGIIN)if(e.cmd==NetRequestConst.REQUEST_USER_UPGRADE||e.cmd==NetRequestConst.REQUEST_SEARCH_PLAY){var c={unlockWife:a.unlockWife,unlockServant:a.unlockServant};Api.wifeVoApi.setWaitShowWife(c)}else ViewController.getInstance().openView(ViewConst.BASE.WIFEGETVIEW,{wifeIdList:a.unlockWife,servantId:a.unlockServant});n&&0==Config.AcCfg.isGetAll&&t.request(NetRequestConst.REQUEST_ACTIVITY_GETACTIVECFG,{})}e.ts&&(TickManager.startTick(),GameData.serverTime=e.ts,GameData.serverClientTimeDt=e.ts-(new Date).getTime()/1e3);var p=e&&e.cmd?e.cmd:NetRequestConst.REQUEST_CLIENT_CHAT;App.MessageHelper.dispatchEvent(g(p),r)}}function r(){LoginManager.changeAccount()}function l(t){s(t)}function h(t){"chat"==t.type&&Api.formatChatData(t)}function d(t){var e=!0;return t.ret<0&&(e=!1),{data:t,ret:e}}function g(t){return"socket_receivedata_"+t}function c(){if(App.DeviceUtil.IsHtml5()){var t="https:"==document.location.protocol?!0:!1;if(t)return!0}else if(App.DeviceUtil.isWXgame())return!0;return!1}t.curReceiveCmd="";var p=0;t.request=e,t.requestChat=i,t.chatServerLogout=a,t.chatServerLogin=n,t.refreshHandler=r,t.formatPushData=l,t.formatReceiveChat=h,t.checkServerData=d,t.getMessageName=g,t.checkHttps=c}(NetManager||(NetManager={}));var SoundManager=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.init=function(){e.bgOn=!0,e.effectOn=!0,e.bgVolume=.5,e.effectVolume=1,e.bg=new SoundBg,e.bg.setVolume(e.bgVolume),e.effect=new SoundEffects,e.effect.setVolume(e.effectVolume)},e.getSoundSwitch=function(){var t=LocalStorageManager.get(LocalStorageConst.LOCAL_SOUND_SWITCH);TextFieldConst.COLOR_WARN_GREEN;return""==t||"ON"==t?!0:!1},e.playEffect=function(t){e.getSoundSwitch()&&e.effectOn&&(null==e.effectLastTime[t]?(e.effectLastTime[t]=1,e.effect.play(t),e.effectLastTime[t]=egret.getTimer()+App.MathUtil.getRandom()+100):e.effectLastTime[t]<egret.getTimer()&&(e.effect.play(t),e.effectLastTime[t]=egret.getTimer()+App.MathUtil.getRandom()+100))},e.playEffectCallback=function(t){e.effectCountTab[t]-=1},e.playBg=function(t){e.getSoundSwitch()&&(e.currBg=t,e.bgOn&&(e.bg.play(t),egret.MainContext.instance.stage.addEventListener(egret.Event.DEACTIVATE,e.deActivateHandler,this)))},e.resumeBg=function(){if(e.getSoundSwitch())if(App.DeviceUtil.IsHtml5){if(!e.bgOn)return;e.bg.resume(),egret.MainContext.instance.stage.addEventListener(egret.Event.DEACTIVATE,e.deActivateHandler,this)}else e.playBg(e.currBg)},e.pauseBg=function(){App.DeviceUtil.IsHtml5?(e.bg.pause(),egret.MainContext.instance.stage.removeEventListener(egret.Event.DEACTIVATE,e.deActivateHandler,this)):e.stopBg()},e.stopBg=function(){e.bg.stop(),egret.MainContext.instance.stage.removeEventListener(egret.Event.DEACTIVATE,e.deActivateHandler,this)},e.stopBgByName=function(t){e.currBg==t&&e.stopBg()},e.stopEffect=function(t){e.effect&&e.effect.stop(t)},e.setEffectOn=function(t){e.effectOn=t},e.setBgOn=function(t){e.bgOn=t,e.bgOn?e.currBg&&e.playBg(e.currBg):e.stopBg()},e.setBgVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),e.bgVolume=t,e.bg.setVolume(e.bgVolume)},e.getBgVolume=function(){return e.bgVolume},e.setEffectVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),e.effectVolume=t,e.effect.setVolume(e.effectVolume)},e.setBgName=function(t){e.currBg=t},e.deActivateHandler=function(t){e.stopBg(),egret.MainContext.instance.stage.addEventListener(egret.Event.ACTIVATE,e.activateHandler,this)},e.activateHandler=function(t){e.playBg(e.currBg),egret.MainContext.instance.stage.removeEventListener(egret.Event.ACTIVATE,e.activateHandler,this)},e.getEffectVolume=function(){return e.effectVolume},e.prototype.dispose=function(){e.effectLastTime={}},e.CLEAR_TIME=18e4,e.effectInfoTab={effect_battle_attack1:{time:350,maxCount:5,curCount:0},effect_battle_attack2:{time:300,maxCount:5,curCount:0}},e.effectTimeOut=[],e.effectCountTab={},e.effectLastTime={},e}(BaseClass);__reflect(SoundManager.prototype,"SoundManager");var TickManager;!function(t){function e(){s||(s=!0,TimerManager.doTimer(1e3,0,o,t))}function i(){s=!1,TimerManager.remove(o,this)}function a(t,e,i){t&&r.push({callback:t,callbackThisObj:e,callbackParams:i})}function n(t,e){for(var i=r.length,a=i-1;a>=0;a--){var n=r[a];if(n.callback==t&&n.callbackThisObj==e){r.splice(a,1);break}}}function o(){if(GameData.serverTime&&(0==GameData.lastAutoSyncTime&&(GameData.lastAutoSyncTime=GameData.serverTime),0==GameData.pauseSync&&(GameData.serverTime-GameData.lastAutoSyncTime>=60?(GameData.lastAutoSyncTime=GameData.serverTime,0==Api.rookieVoApi.isInGuiding&&NetManager.request(NetRequestConst.REQUEST_USER_SYNC,null)):0==App.DateUtil.checkIsToday(GameData.lastAutoSyncTime)&&0==Api.rookieVoApi.isInGuiding&&(GameData.lastAutoSyncTime=GameData.serverTime,NetManager.request(NetRequestConst.REQUEST_USER_SYNC,null))),GameData.serverTime=Math.floor((new Date).getTime()/1e3+GameData.serverClientTimeDt)),r)for(var t=r.length,e=t-1;e>=0;e--){var i=r[e];i.callback&&i.callback.apply(i.callbackThisObj,i.callbackParams)}}var s=!1,r=[];t.startTick=e,t.stopTick=i,t.addTick=a,t.removeTick=n}(TickManager||(TickManager={}));var TimerManager=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.init=function(){egret.startTick(e.onEnterFrame,this),e._isInit=!0},e.setTimeScale=function(t){e._timeScale=t},e.onEnterFrame=function(t){e._currFrame++,e._currTime=t;for(var i=0;i<e._count;i++){var a=e._handlers[i],n=a.userFrame?e._currFrame:e._currTime;n>=a.exeTime&&(a.method.call(a.methodObj,(e._currTime-a.dealTime)*e._timeScale),a.dealTime=e._currTime,a.exeTime=Math.max(a.exeTime+a.delay,e._currTime+a.delay),a.repeat||(a.repeatCount>1?a.repeatCount--:(a.complateMethod&&a.complateMethod.apply(a.complateMethodObj),e._delHandlers.push(a))))}for(;e._delHandlers.length;){var a=e._delHandlers.pop();e.remove(a.method,a.methodObj)}return!1},e.create=function(t,i,a,n,o,s,r){if(0==e._isInit&&e.init(),!(0>i||0>a||null==n)){e.remove(n,o);var l=TimerHandler.create();l.userFrame=t,l.repeat=0==a,l.repeatCount=a,l.delay=i,l.method=n,l.methodObj=o,l.complateMethod=s,l.complateMethodObj=r,l.exeTime=i+(t?e._currFrame:e._currTime),l.dealTime=e._currTime,e._handlers.push(l),e._count++}},e.doTimer=function(t,i,a,n,o,s){void 0===o&&(o=null),void 0===s&&(s=null),e.create(!1,t,i,a,n,o,s)},e.doFrame=function(t,i,a,n,o,s){void 0===o&&(o=null),void 0===s&&(s=null),e.create(!0,t,i,a,n,o,s)},Object.defineProperty(e,"count",{get:function(){return e._count},enumerable:!0,configurable:!0}),e.remove=function(t,i){for(var a=0;a<e._count;a++){var n=e._handlers[a];if(n.method==t&&n.methodObj==i){e._handlers.splice(a,1),TimerHandler.release(n),e._count--;break}}},e.removeAll=function(t){for(var i=0;i<e._count;i++){var a=e._handlers[i];a.methodObj==t&&(e._handlers.splice(i,1),TimerHandler.release(a),e._count--,i--)}},e.isExists=function(t,i){for(var a=0;a<e._count;a++){var n=e._handlers[a];if(n.method==t&&n.methodObj==i)return!0}return!1},e.prototype.dispose=function(){},e._handlers=new Array,e._delHandlers=new Array,e._currTime=0,e._currFrame=0,e._count=0,e._timeScale=1,e._isInit=!1,e}(BaseClass);__reflect(TimerManager.prototype,"TimerManager");var TimerHandler=function(){function t(){this.delay=0,this.repeatCount=0,this.exeTime=0,this.dealTime=0}return t.create=function(){var e=t.timerHandlerPool.pop();return e||(e=new t),e},t.release=function(e){e.clear(),t.timerHandlerPool.indexOf(e)<0&&t.timerHandlerPool.push(e)},t.prototype.clear=function(){this.method=null,this.methodObj=null,this.complateMethod=null,this.complateMethodObj=null,this.delay=0,this.repeat=!1,this.repeatCount=0,this.userFrame=!1,this.exeTime=0,this.dealTime=0},t.timerHandlerPool=[],t}();__reflect(TimerHandler.prototype,"TimerHandler");var Api=function(){function t(){}return t.init=function(){t.playerVoApi=new PlayerVoApi,t.itemVoApi=new ItemVoApi,t.servantVoApi=new ServantVoApi,t.wifeVoApi=new WifeVoApi,t.childVoApi=new ChildVoApi,t.adultVoApi=new AdultVoApi,t.manageVoApi=new ManageVoApi,t.challengeVoApi=new ChallengeVoApi,t.rookieVoApi=new RookieVoApi,t.searchVoApi=new SearchVoApi,t.mainTaskVoApi=new MainTaskVoApi,t.chatVoApi=new ChatVoApi,t.rankVoApi=new RankVoApi,t.otherInfoVoApi=new OtherInfoVoApi,t.shopVoApi=new ShopVoApi,t.lampVoApi=new LampVoApi,t.switchVoApi=new SwitchVoApi,t.dailytaskVoApi=new DailytaskVoApi,t.mailVoApi=new MailVoApi,t.rechargeVoApi=new RechargeVoApi,t.vipVoApi=new VipVoApi,t.palaceVoApi=new PalaceVoApi,t.dinnerVoApi=new DinnerVoApi,t.achievementVoApi=new AchievementVoApi,t.arrivalVoApi=new ArrivalVoApi,t.acVoApi=new AcVoApi,t.acRankVoApi=new AcRankVoApi,t.gameinfoVoApi=new GameinfoVoApi,t.prisonVoApi=new PrisonVoApi,t.atkraceVoApi=new AtkraceVoApi,t.atkracecrossVoApi=new AtkracecrossVoApi,t.bookroomVoApi=new BookroomVoApi,t.studyatkVoApi=new StudyatkVoApi,t.allianceVoApi=new AllianceVoApi,t.dailybossVoApi=new DailybossVoApi,t.conquestVoApi=new ConquestVoApi,t.tradeVoApi=new TradeVoApi,t.wifeSkinVoApi=new WifeskinVoApi,t.inviteVoApi=new InviteVoApi,t.prestigeVoApi=new PrestigeVoApi,t.practiceVoApi=new PracticeVoApi,t.wifestatusVoApi=new WifestatusVoApi,t.crossImacyVoApi=new CrossImacyVoApi},t.formatData=function(e,i){var a={};if(e.userinfo&&t.playerVoApi.formatData(e.userinfo),e.item&&t.itemVoApi.formatData(e.item),e.servant&&t.servantVoApi.formatData(e.servant),e.wife&&t.wifeVoApi.formatData(e.wife),e.child&&t.childVoApi.formatData(e.child),e.adult&&t.adultVoApi.formatData(e.adult),e.prison&&t.prisonVoApi.formatData(e.prison),e.autoRes&&t.manageVoApi.formatAutoRes(e.autoRes),e.manage&&t.manageVoApi.formatData(e.manage),e.challenge&&t.challengeVoApi.formatData(e.challenge),e.search&&t.searchVoApi.formatData(e.search),e.maintask&&t.mainTaskVoApi.formatData(e.maintask),e.minfo&&t.rankVoApi.formatData(e),e.otherinfo&&t.otherInfoVoApi.formatData(e.otherinfo),e.shop&&t.shopVoApi.formatData(e.shop),e["switch"]&&t.switchVoApi.formatData(e["switch"]),e.dailytask&&t.dailytaskVoApi.formatData(e.dailytask),e.mymail&&t.mailVoApi.formatData(e.mymail),e.palace&&t.palaceVoApi.formatData(e),e.dinner&&t.dinnerVoApi.formatData(e.dinner),e.maildetail&&t.mailVoApi.formatDetailData(e.maildetail),e.achievement&&t.achievementVoApi.formatData(e.achievement),e.arrival&&t.arrivalVoApi.formatData(e.arrival),e.activity&&(a.activity=t.acVoApi.formatData(e.activity,i==NetRequestConst.REQUEST_USER_LOGIIN)),e.acrank&&t.acRankVoApi.formatData(e.acrank),e.lamp&&t.lampVoApi.formatData(e.lamp),e.activecfg&&Config.AcCfg.formatAllCfg(e.activecfg),e.gameinfo&&t.gameinfoVoApi.formatData(e.gameinfo),e.atkrace&&t.atkraceVoApi.formatData(e.atkrace),e.atkracecross&&t.atkracecrossVoApi.formatData(e.atkracecross),e.bookroom&&t.bookroomVoApi.formatData(e.bookroom),e.studyatk&&t.studyatkVoApi.formatData(e),e.dailyBossCfg&&Config.DailybossCfg.formatDataByServer(e.dailyBossCfg),e.dailyboss&&t.dailybossVoApi.formatData(e.dailyboss),e.alliance&&t.allianceVoApi.formatData(e.alliance),e.myalliance&&t.allianceVoApi.formatData2(e.myalliance),e.alliancemember&&t.allianceVoApi.formatData3(e.alliancemember),e.conquest&&t.conquestVoApi.formatData(e.conquest),e.trade&&t.tradeVoApi.formatData(e.trade),e.rechargeCfg&&Config.RechargeCfg.formatData(e.rechargeCfg),e.wifeskin&&t.wifeSkinVoApi.formatData(e.wifeskin),e.invite&&t.inviteVoApi.formatData(e.invite),e.prestige&&t.prestigeVoApi.formatData(e.prestige),e.chatblock&&t.chatVoApi.formatData2(e.chatblock),e.sharetext){var n=JSON.parse(e.sharetext);LanguageManager.setShareText(n)}e.practice&&t.practiceVoApi.formatData(e.practice),e.pnum&&t.practiceVoApi.showPracticeGet(e.pnum),e.wifestatus&&t.wifestatusVoApi.formatData(e.wifestatus);for(var o in e)null!=a[o]&&0==a[o]||("activecfg"==o?(App.MessageHelper.dispatchNetMessage(MessageConst.MESSAGE_REFRESH_MODE,MessageConst.MESSAGE_MODEL_ACTIVITY),App.MessageHelper.dispatchNetMessage(MessageConst.MESSAGE_MODEL_ACTIVITY,MessageConst.MESSAGE_MODEL_ACTIVITY)):("challenge.attack"!=i||"userinfo"!=o&&"challenge"!=o&&"rewards"!=o&&"battleReport"!=o)&&(App.MessageHelper.dispatchNetMessage(MessageConst.MESSAGE_REFRESH_MODE,o),App.MessageHelper.dispatchNetMessage(o,o)))},t.dispose=function(){for(var e in t)t[e]&&t[e]instanceof BaseVoApi&&t[e].dispose()},t.formatChatData=function(e){t.chatVoApi.formatData(e),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_CHAT_COME)},t}();__reflect(Api.prototype,"Api");var CustomMovieClip=function(t){function e(){var e=t.call(this)||this;return e._frameImages=[],e._frameRate=60,e._timeRate=.001,e._playingIndex=0,e._playCount=0,e.isPlaying=!1,e._endFunc=null,e._removeStop=!1,e._autoDispose=!1,e._playFrameTime=0,e._playFrameSpace=100,e}return __extends(e,t),Object.defineProperty(e.prototype,"sheetName",{set:function(t){this._frameImages=RES.configInstance.keyMap[t].subkeys},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameImages",{set:function(t){this._frameImages=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameRate",{set:function(t){this._frameRate=t,this.stop()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playFrameRate",{set:function(t){t&&(this._playFrameSpace=t)},enumerable:!0,configurable:!0}),e.prototype.updateFrame=function(t){return t<this._playFrameTime?!1:(this._playFrameTime=t+this._playFrameSpace,this._playingIndex>=this._frameImages.length&&(this._playingIndex=0,this._playCount--),this._playCount<=0?(this.stop(),this._endFunc&&this._endObj&&this._endFunc.apply(this._endObj,[this]),!1):(this.texture=ResourceManager.getRes(this._frameImages[this._playingIndex]),this.anchorX&&(this.anchorOffsetX=this.texture.textureWidth*this.anchorX),this.anchorY&&(this.anchorOffsetY=this.texture.textureHeight*this.anchorY),this._playingIndex++,!1))},e.prototype.play=function(t){void 0===t&&(t=0),0==this.isPlaying&&(this.isPlaying=!0,this._playCount=0>=t?99999:t,egret.startTick(this.updateFrame,this))},e.prototype.goToAndPlay=function(t){this._playingIndex=0>t?0:t},e.prototype.stop=function(){this.isPlaying=!1,egret.stopTick(this.updateFrame,this)},e.prototype.onAddToStage=function(){this._removeStop&&this.play(this._playCount)},e.prototype.onRemoveFromStage=function(){this.stop(),this._removeStop=!0,this._autoDispose&&this.dispose()},e.prototype.setPosition=function(t,e){var i=!1;null!=t&&("number"==typeof t?this.x!=t&&(this.x=t):(i=!0,(this.x!=t.x||this.y!=t.y)&&(this.x=t.x,this.y=t.y))),0==i&&null!=e&&this.y!=e&&(this.y=e)},e.prototype.setScale=function(t){this.scaleX=t,this.scaleY=t},e.prototype.setEndCallBack=function(t,e){this._endFunc=t,this._endObj=e},Object.defineProperty(e.prototype,"timeRate",{set:function(t){this._timeRate=t,this.stop()},enumerable:!0,configurable:!0}),e.prototype.playWithTime=function(t){0==this.isPlaying&&(this.isPlaying=!0,this._playCount=0>=t?99999:t,egret.startTick(this.updateFrame,this))},e.prototype.dispose=function(){this.stop(),this._frameImages=[],this._frameRate=60,this._timeRate=.001,this._playingIndex=0,this._playCount=0,this.isPlaying=!1,this._endFunc=null,this._endObj=null,this._removeStop=!1,this.texture=null,this._playFrameTime=0,this._playFrameSpace=50,t.prototype.dispose.call(this)},e}(BaseBitmap);__reflect(CustomMovieClip.prototype,"CustomMovieClip");var AcRankVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getAcRankInfoVoByAidAndCode=function(t,e){var i=t+"-"+e,a=this.acRankVo.acRankInfoVoObj;return a&&a[i]?a[i]:null},e.prototype.dispose=function(){this.acRankVo=null,t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(AcRankVoApi.prototype,"AcRankVoApi");var AcTailorApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getFreeTimes=function(){return this.acTailorVo.free},e.prototype.dispose=function(){this.acTailorVo=null,t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(AcTailorApi.prototype,"AcTailorApi");var AcVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(AcBaseVoApi);__reflect(AcVoApi.prototype,"AcVoApi");var AdultVoApi=function(t){function e(){var e=t.call(this)||this;return e.posnum=0,e}return __extends(e,t),e.prototype.checkNpcMessage=function(){return this._marryList.length&&this._marryList.length>0?!0:!1},e.prototype.isShowNpc=function(){return this.getAdultNum()>0||this.getAdultMarryNum()>0?!0:!1},e.prototype.getLockedString=function(){return LanguageManager.getlocal("reachConditionsUnlockDesc")},e.prototype.formatData=function(e){null==this._adultVo&&(this._adultVo=new AdultVo),null==this._adultMarryVo&&(this._adultMarryVo=new AdultMarryVo),this._adultVo.initData(e.info),this._adultMarryVo.initData(e.minfo),this._marryList=e.marry,this._refuseData=e.refuse,t.prototype.formatData.call(this,e)},e.prototype.getChildPosNum=function(){var t=Api.childVoApi.getChildPosNum();return t},e.prototype.getAdultNum=function(){var t=this.getAdultVoList().length;return t},e.prototype.getAdultMarryNum=function(){var t=this.getAdultMarryVoList().length;return t},e.prototype.getAdultVoList=function(){var t=this._adultVo.adultInfoVoObj,e=new Array;for(var i in t)e.push(t[i]);return e.sort(function(t,e){return t.aquality==e.aquality?Number(t.ts)-Number(e.ts):Number(e.aquality)-Number(t.aquality)}),e},e.prototype.getAdultMarryVoList=function(){var t=this._adultMarryVo.adultInfoVoObj,e=new Array;for(var i in t)e.push(t[i]);return e.sort(function(t,e){return Number(e.mts)-Number(t.mts)}),e},e.prototype.getAdultVoListById=function(t,e){for(var i=this.getAdultVoList(),a=new Array,n=0;n<i.length;n++){var o=i[n];o.aquality!=t||o.sex==e||this.getAdultIsInMarry(o.id)||a.push(o)}return a},e.prototype.getAdultVoListByIdByAttr=function(t,e){var i=this.getAdultVoListById(t,e);return i.sort(function(t,e){return Number(e.attrVo.attTotal)-Number(t.attrVo.attTotal)}),i},e.prototype.getAdultInfoVoById=function(t){var e=this._adultVo.adultInfoVoObj;return e&&e[t]?e[t]:null},e.prototype.getAdultMarryInfoVoById=function(t){var e=this._adultMarryVo.adultInfoVoObj;return e&&e[t]?e[t]:null},e.prototype.getAdultIndexVoById=function(t){for(var e=this.getAdultVoList(),i=0;i<e.length;i++)if(t==e[i].id)return i;return 0},e.prototype.getAdultMarryIndexVoById=function(t){for(var e=this.getAdultMarryVoList(),i=0;i<e.length;i++)if(t==e[i].id)return i;return 0},e.prototype.getAdultIsInMarry=function(t){var e=this.getAdultInfoVoById(t),i=0;return e.pro&&e.pro[0]&&(i=e.pro[0]-GameData.serverTime),i>0?!0:!1},e.prototype.getAdultPic=function(t){var e=this.getAdultInfoVoById(t),i="adult_boy";return 2==e.sex&&(i="adult_girl"),i},e.prototype.getAdultWord=function(t){var e=this.getAdultInfoVoById(t),i=GameConfig.config.childCfg[e.quality.toString()],a=e.level/i.lv,n="",o=1;return.4>a?(o=App.MathUtil.getRandom(1,3),n=LanguageManager.getlocal("child_words1_"+o)):(a>=.4||1>a)&&(o=App.MathUtil.getRandom(1,5),n=LanguageManager.getlocal("child_words2_"+o)),n},e.prototype.dispose=function(){this._adultVo=null,this.posnum=0,this._marryList=null,this._refuseData=null,t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(AdultVoApi.prototype,"AdultVoApi");var AllianceVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.formatData=function(e){null==this._allianceVo&&(this._allianceVo=new AllianceVo),this._allianceVo.initData(e),t.prototype.formatData.call(this,e)},e.prototype.formatData2=function(e){null==this._myAllianceVo&&(this._myAllianceVo=new MyAllianceVo),0==e.alliance_chat&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_MESSAGE_ALLIANCE_BEKICK,{}),1==e.alliance_chat&&(App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_ALLIANCE_BEJOIN,{}),Api.chatVoApi.clearChat(),NetManager.chatServerLogin(null,null)),this._myAllianceVo.initData(e),t.prototype.formatData.call(this,e)},e.prototype.formatData3=function(e){null==this._allianceMemberVo&&(this._allianceMemberVo=new AllianceMemberVo),this._allianceMemberVo.initData(e),t.prototype.formatData.call(this,e)},e.prototype.getAllianceVo=function(){return this._allianceVo},e.prototype.getMyAllianceVo=function(){return this._myAllianceVo},e.prototype.getAllianceMemberVo=function(){return this._allianceMemberVo},e.prototype.getAllianceMemberInfoVoList=function(){var t=new Array,e=this._allianceMemberVo.memberInfoVoObj;for(var i in e)t.push(e[i]);return t.sort(function(t,e){return t.po==e.po?e.power-t.power:Number(t.po)-Number(e.po)}),t},e.prototype.getAllianceTurnVoList=function(){var t=new Array,e=this._allianceMemberVo.memberInfoVoObj;for(var i in e){var a=(GameData.serverTime-e[i].logindt)/86400;1!=e[i].po&&3>a&&t.push(e[i])}return t},e.prototype.getAllianceMemberInfoById=function(t){var e=this._allianceMemberVo.memberInfoVoObj;for(var i in e)if(e[i].uid==t)return e[i];return null},e.prototype.getAlliancePo2Num=function(){for(var t=0,e=this.getAllianceMemberInfoVoList(),i=0;i<e.length;i++){var a=e[i];2==a.po&&t++}return t},e.prototype.getAlliancePo3Num=function(){for(var t=0,e=this.getAllianceMemberInfoVoList(),i=0;i<e.length;i++){var a=e[i];3==a.po&&t++}return t},e.prototype.isShowNpc=function(){var t=!1;return t=Api.playerVoApi.getPlayerLevel()>=Config.AlliancebaseCfg.unlock?!0:!1},e.prototype.getLockedString=function(){return LanguageManager.getlocal("reachLvelUnlockDesc",[Api.playerVoApi.getPlayerOfficeByLevel(Config.AlliancebaseCfg.unlock)])
},e.prototype.getIsDonatet=function(){var t=Api.allianceVoApi.getMyAllianceVo();return t.donate.id&&t.donate.et>App.DateUtil.getWeeTs(GameData.serverTime)?!0:!1},e.prototype.getStr=function(t){var e=Config.AlliancebaseCfg.contributeList,i="";if(1==t[0])return i=LanguageManager.getlocal("alliancelogdes"+t[0],[t[3]]);if(2==t[0])return i=LanguageManager.getlocal("alliancelogdes"+t[0],[t[3]]);if(t[3]&&4==t[0]){var a=e[t[3]],n=LanguageManager.getlocal("allianceBuildName"+t[3]);return i=LanguageManager.getlocal("alliancelogdes"+t[0],[n,a.exp+"",a.asset+"",a.contribution+""]),t[4]&&(i=LanguageManager.getlocal("alliancelogdes4_1",[n,a.contribution+""])),i}if(5==t[0]){var o=Config.AlliancebossCfg.getAllianceCfgByLv(t[4]);if(1==t[3]){var s=LanguageManager.getlocal("allianceBoss_monsterName"+t[4]);return i=LanguageManager.getlocal("alliancelogdes"+t[0],[o.needAsset+"",s])}var s=LanguageManager.getlocal("allianceBoss_monsterName"+t[4]);return i=LanguageManager.getlocal("alliancelogdes12",[o.needGem+"",s])}if(6==t[0])return i=LanguageManager.getlocal("alliancelogdes"+t[0],[t[3]]);if(7==t[0]){var o=Config.AlliancebossCfg.getAllianceCfgByLv(t[3]),s=LanguageManager.getlocal("allianceBoss_monsterName"+t[3]),r=GameData.formatRewardItem(t[4]);return i=LanguageManager.getlocal("alliancelogdes"+t[0],[s,o.addExp+"",o.addAsset+"",t[5]+"",r[0]._name+"x"+r[0].num])}if(10==t[0])return i=LanguageManager.getlocal("alliancelogdes"+t[0],[t[3]]);if(11==t[0]){var l=LanguageManager.getlocal("allianceMemberPo"+t[3]);return i=LanguageManager.getlocal("alliancelogdes"+t[0],[t[4],l])}return i=12==t[0]?LanguageManager.getlocal("alliancelogdes15",[t[2],t[3]]):LanguageManager.getlocal("alliancelogdes"+t[0])},e.prototype.getBossStr=function(t){var e=LanguageManager.getlocal("alliancelogdes13",[t.name,t.dps]);return e},e.prototype.openMainView=function(){0==Api.playerVoApi.getPlayerAllianceId()?ViewController.getInstance().openView(ViewConst.COMMON.ALLIANCECREATEVIEW):ViewController.getInstance().openView(ViewConst.COMMON.ALLIANCEVIEW)},e.prototype.getServantInfoValue=function(t){var e=this._myAllianceVo.servant[t];return null==e&&(e=0),e},e.prototype.getBossHp=function(t){var e=0;return this._allianceVo.boss&&this._allianceVo.boss[t]&&(e=this._allianceVo.boss[t]),e},e.prototype.dispose=function(){this._allianceVo=null,this._myAllianceVo=null,t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(AllianceVoApi.prototype,"AllianceVoApi");var ArrivalVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getTotalSignDay=function(){return this.arrivalVo.arrival_count},e.prototype.getSignRewardList=function(){for(var t=[],e=this.getTotalSignDay(),i=10,a=i>=e?1:e-i,n=e+i,o=this.arrivalVo.flag,s=a;n>=s;s++){var r={},l=Number((s-1)%21+1),h=Config.ArrivalCfg.getContentByIndex(l);h=7==s?h+"|"+Config.GameprojectCfg.sign7DayReward:2==s?h+"|"+Config.GameprojectCfg.sign2DayReward:3==s?h+"|"+Config.GameprojectCfg.sign3DayReward:Config.ArrivalCfg.getContentByIndex(l);var d=GameData.formatRewardItem(h);r.index=s,r.rewardList=d,e>s?r.flag=1:s==e?r.flag=o:r.flag=2,t.push(r)}return t},e.prototype.getIndexByCurday=function(){var t=this.getTotalSignDay(),e=10,i=e>=t?t:11;return i},e.prototype.checkFlagByIndex=function(t){var e=this.getTotalSignDay(),i=this.arrivalVo.flag;return e>t?1:t==e?i:2},e.prototype.getFunctionCfgList=function(){var t=[],e=[],i={},a=Api.shopVoApi.getPayFlag();if(i={},i.key="FirstRecharge",i.sortid=999,Api.switchVoApi.checkClosePay()||e.push(i),a>0&&Api.switchVoApi.checkOpenNewCharge()){var n=Config.RechargeCfg.getRechargeItemCfgByKey("g9");if(n){var o=Api.shopVoApi.getPayInfoById2("g9");Api.shopVoApi.getPayInfoById2("g10");o&&o.st+n.lastTime>GameData.serverTime&&(i={},i.key="RechargeBox",i.sortid=10,Api.switchVoApi.checkClosePay()||e.push(i))}}i={},i.key="Signin",i.sortid=11,e.push(i),i={},i.key="MonthCard";var s=Api.shopVoApi.ifBuyMonthCard();0==s?i.sortid=31:i.sortid=311,Api.switchVoApi.checkClosePay()||e.push(i),i={},i.key="YearCard";var r=Api.shopVoApi.ifBuyYearCard();0==r?i.sortid=41:i.sortid=411,Api.switchVoApi.checkClosePay()||e.push(i),i={},i.key="GodBless",i.sortid=51,e.push(i),Api.switchVoApi.checkOpenShenhe()||"h5ios3kwan"==PlatformManager.getSpName()&&(i={},i.key="Realname",i.sortid=500,e.push(i)),Api.switchVoApi.checkOpenRechargeRebate()&&(i={},i.key="Rebate",i.sortid=1e3,e.push(i)),0==Api.switchVoApi.checkOpenShenhe()&&PlatformManager.isSupportBindPhone()&&!Api.otherInfoVoApi.isGetBindingReward()&&(i={},i.key="Binding",i.sortid=611,e.push(i)),i={},i.key="FunctionPreview",i.sortid=999,e.push(i),Api.switchVoApi.checkopenQQqun()&&(i={},i.key="Qgroup",i.sortid=998,e.push(i)),e.sort(function(t,e){return t.sortid>e.sortid?1:0});for(var l=0;l<e.length;l++)t.push(e[l].key);return t},Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){return 0==this.arrivalVo.flag?!0:!1},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(ArrivalVoApi.prototype,"ArrivalVoApi");var AtkraceVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getMyFightInfo=function(){return this.atkraceVo.ainfo},e.prototype.getMyInfo=function(){return this.atkraceVo.info},e.prototype.isShowNpc=function(){return Api.servantVoApi.getServantCountLevel60Plus()>=1&&Api.servantVoApi.getServantCount()>=Config.AtkraceCfg.getUnlock()},e.prototype.getLockedString=function(){return LanguageManager.getlocal("atkraceUnlcok",[Config.AtkraceCfg.getUnlock().toString()])},e.prototype.getPoint=function(){return this.atkraceVo.point},e.prototype.getRewardc=function(){return this.atkraceVo.rewardc},e.prototype.checkNpcMessage=function(){var t=!1;if(this.isShowNpc())if(this.atkraceVo.ainfo&&this.atkraceVo.ainfo.mesid)t=!0;else{var e=Config.AtkraceCfg.getDailyNum(),i=this.atkraceVo.info.num;if(e>i){var a=this.atkraceVo.info.lasttime+Config.AtkraceCfg.getIntervalTime()-GameData.serverTime;0>=a&&(t=!0)}}return t},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(AtkraceVoApi.prototype,"AtkraceVoApi");var AtkracecrossVoApi=function(t){function e(){var e=t.call(this)||this;return e.zonerankinfos=null,e.isCanJoin=!1,e}return __extends(e,t),e.prototype.getMyFightInfo=function(){return this.atkracecrossVo.ainfo},e.prototype.getMyInfo=function(){return this.atkracecrossVo.info},e.prototype.isShowNpc=function(){return Api.servantVoApi.getServantCountLevel60Plus()>=1&&Api.servantVoApi.getServantCount()>=Config.AtkraceCfg.getUnlock()},e.prototype.getLockedString=function(){return LanguageManager.getlocal("atkraceUnlcok",[Config.AtkraceCfg.getUnlock().toString()])},e.prototype.getPoint=function(){return this.atkracecrossVo.point},e.prototype.getRewardc=function(){return this.atkracecrossVo.rewardc},e.prototype.checkNpcMessage=function(){var t=!1;if(this.isShowNpc())if(this.atkracecrossVo.ainfo&&this.atkracecrossVo.ainfo.mesid)t=!0;else{var e=Config.AtkraceCfg.getDailyNum(),i=this.atkracecrossVo.info.num;if(e>i){var a=this.atkracecrossVo.info.lasttime+Config.AtkraceCfg.getIntervalTime()-GameData.serverTime;0>=a&&(t=!0)}}return t},e.prototype.dispose=function(){this.zonerankinfos=null,this.isCanJoin=!1,t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(AtkracecrossVoApi.prototype,"AtkracecrossVoApi");var BookroomVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getSeatNum=function(){return this.bookroomVo.pos_num},e.prototype.getSeatInfoByPosId=function(t){return this.bookroomVo.infoList[String(t)]},e.prototype.isStudying=function(t){for(var e in this.bookroomVo.infoList)if(this.bookroomVo.infoList[e].servantid==t)return!0;return!1},e.prototype.getPosListInStudy=function(){var t=Object.keys(this.bookroomVo.infoList);return t},e.prototype.isBatchenable=function(){for(var t in this.bookroomVo.infoList)if(this.bookroomVo.infoList[t].et<=GameData.serverTime)return!0;return!1},e.prototype.checkNpcMessage=function(){var t=Object.keys(this.getPosListInStudy()).length;return this.isBatchenable()||t<this.getSeatNum()?!0:!1},e}(BaseVoApi);__reflect(BookroomVoApi.prototype,"BookroomVoApi");var ChallengeVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getCurChannelId=function(){return this.challengeVo.cid+1},e.prototype.getCurKilledNum=function(){return this.challengeVo.ksoldier},e.prototype.getServantInfo=function(){return this.challengeVo.info},e.prototype.getServantInfoValue=function(t){var e=this.challengeVo.info[t];return null==e&&(e=0),e},e.prototype.getCurBigChannelId=function(){var t=Math.floor(this.challengeVo.cid/41)+1;return t},e.prototype.getBigChannelIdByCid=function(t){var e;return e=t>=ChallengeCfg.getChallengeTotalPass()?Math.floor(ChallengeCfg.getChallengeTotalPass()/41):Math.floor(t/41)+1},e.prototype.getCurMiddleChannelId=function(){var t=Math.floor(this.challengeVo.cid%41/8)+1;return t},e.prototype.getCurSmallChannelId=function(){var t=this.challengeVo.cid%41%8;return t},e.prototype.getIsBossChannel=function(){var t=!1;return 6==Api.challengeVoApi.getCurMiddleChannelId()&&(t=!0),t},e.prototype.getOpenViewMessage=function(){return this.challengeVo.cid>=ChallengeCfg.getChallengeTotalPass()?LanguageManager.getlocal("challengeAllPassed"):null},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(ChallengeVoApi.prototype,"ChallengeVoApi");var ChatVoApi=function(t){function e(){var e=t.call(this)||this;return e._lastMessage="",e._lastTime=0,e._chatID=0,e._lastAllianceId=0,e}return __extends(e,t),e.prototype.formatData2=function(t){if(null==this.chatblockVo){var e=(this.getClassName(),"ChatblockVo"),i=egret.getDefinitionByName(e);this.chatblockVo=new i,this[App.StringUtil.firstCharToLower(e)]=this.chatblockVo}this.chatblockVo.initData(t)},e.prototype.getChatBlockVo=function(){return this.chatblockVo},e.prototype.getIsBlock=function(t){for(var e=0;e<this.chatblockVo.info.length;e++){var i=this.chatblockVo.info[e];if(i==t)return!0}return!1},e.prototype.getChatList=function(){return this.chatVo?this.chatVo.chatVoObj:[]},e.prototype.getWorldList=function(){return this.chatVo?this.chatVo.worldVoObj:[]},e.prototype.getAllianceList=function(){return this.chatVo?this.chatVo.allianceVoObj:[]},e.prototype.setLastMessage=function(t){this._lastMessage=t},e.prototype.refreshLastMessage=function(){if(0==Api.playerVoApi.getPlayerAllianceId()&&this.chatVo&&this.chatVo.worldVoObj.length>0){var t=this.chatVo.worldVoObj[this.chatVo.worldVoObj.length-1],e=LanguageManager.getlocal("chatWorldTitle"),i=e+"<font color="+TextFieldConst.COLOR_LIGHT_YELLOW+">"+t.sendername+"</font>:"+t.content.message;this._lastMessage=i}},e.prototype.getLastMessage=function(){return this._lastMessage},e.prototype.getChatSign=function(){return this._chatID++,this._chatID.toString()+GameData.serverTime+Api.playerVoApi.getPlayerID().toString()},e.prototype.clearChat=function(){this.chatVo&&(this.chatVo.worldVoObj=[],this.chatVo.chatVoObj=[],this.chatVo.allianceVoObj=[])},e.prototype.dispose=function(){this.chatVo=null,this._lastMessage="",this._lastTime=null,this.chatblockVo=null,t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(ChatVoApi.prototype,"ChatVoApi");var ChildVoApi=function(t){function e(){var e=t.call(this)||this;return e.posnum=0,e}return __extends(e,t),e.prototype.checkNpcMessage=function(){for(var t=this.getChildrenVoList(),e=0;e<t.length;e++){var i=t[e];if(this.getChildrenVigourById(i.id)>0){var a=GameConfig.config.childCfg[i.quality.toString()];if(i.level<a.lv)return!0}}return!1},e.prototype.getChildPosNum=function(){var t=this.childVo.posnum;return t},e.prototype.getChildNum=function(){var t=this.getChildrenVoList().length;return t},e.prototype.getChildrenVoList=function(){var t=this.childVo.childInfoVoObj,e=new Array;for(var i in t)e.push(t[i]);return e.sort(function(t,e){return t.quality==e.quality?Number(t.bts)-Number(e.bts):Number(e.quality)-Number(t.quality)}),e},e.prototype.getChildrenInfoVoById=function(t){var e=this.childVo.childInfoVoObj;return e&&e[t]?e[t]:null},e.prototype.getChildIndexVoById=function(t){for(var e=this.getChildrenVoList(),i=0;i<e.length;i++)if(t==e[i].id)return i;return 0},e.prototype.getChildrenVigourById=function(t){var e=this.childVo.childInfoVoObj,i=0,a=Api.vipVoApi.getCurLevelVipCfg().maxVigour,n=e[t];return i=Math.floor((GameData.serverTime-n.vigour.st)/GameConfig.config.childbaseCfg.needTime),i+n.vigour.num>a?i=a:i+=n.vigour.num,i},e.prototype.getChildrenVigourTimeById=function(t){var e=0,i=Config.ChildbaseCfg.needTime,a=this.childVo.childInfoVoObj,n=a[t],o=n.vigour.st;return o+i>GameData.serverTime&&(e=o+i-GameData.serverTime),e},e.prototype.getChildrenVigourItemCount=function(){for(var t=0,e=this.getChildrenVoList(),i=0;i<e.length;i++)if(this.getChildrenVigourById(e[i].id)<2){var a=GameConfig.config.childCfg[e[i].quality.toString()];e[i].level<a.lv&&t++}return t},e.prototype.getChildrenCanUpdCount=function(){for(var t=0,e=this.getChildrenVoList(),i=0;i<e.length;i++)if(this.getChildrenVigourById(e[i].id)>0){var a=GameConfig.config.childCfg[e[i].quality.toString()];e[i].level<a.lv&&""!=e[i].name&&t++}return t},e.prototype.getAddPosNeedGem=function(){var t=0,e=Api.childVoApi.getChildPosNum(),i=e-Config.ChildbaseCfg.iniPos;return i>=Config.ChildbaseCfg.needGem.length-1&&(i=Config.ChildbaseCfg.needGem.length-1),t=Config.ChildbaseCfg.needGem[i]},e.prototype.getChildPic=function(t){var e=this.getChildrenInfoVoById(t),i=GameConfig.config.childCfg[e.quality.toString()],a=e.level/i.lv,n="child_state_1";return n=.4>a?"child_state_1":a>=.4&&1>a?"child_state_2_"+e.sex:"child_state_3_"+e.sex},e.prototype.getChildWord=function(t){var e=this.getChildrenInfoVoById(t),i=GameConfig.config.childCfg[e.quality.toString()],a=e.level/i.lv,n="",o=1;return.4>a?(o=App.MathUtil.getRandom(1,3),n=LanguageManager.getlocal("child_words1_"+o)):(a>=.4||1>a)&&(o=App.MathUtil.getRandom(1,5),n=LanguageManager.getlocal("child_words2_"+o)),n},e.prototype.isShowNpc=function(){return this.childVo?this.childVo.cnum>0:this.getChildNum()>0?!0:!1},e.prototype.getCnum=function(){return this.childVo.cnum},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(ChildVoApi.prototype,"ChildVoApi");var ConquestVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getConquestVo=function(){return this.conquestVo},e.prototype.isShowNpc=function(){var t=!1,e=3280;return t=Api.challengeVoApi.getCurChannelId()>e?!0:!1},e.prototype.getLockedString=function(){var t=80;return LanguageManager.getlocal("prisonUnlockDesc",[t+""])},e.prototype.dispose=function(){this.conquestVo=null,t.prototype.dispose.call(this)},e.prototype.getBattleResult=function(t,e,i,a){var n=Math.ceil(e-a*(i+1e3)/(t+1e3)),o=Math.ceil(a-e*(t+1e3)/(i+1e3)),s=a*(i+1e3)/(t+1e3),r=!1;n>0?(o=0,r=!0):0==n&&0==o?(n=0,o=1):n=0;var l={success:r,left1:n,left2:o,cost:s};return l},e.prototype.getAttNum=function(t){for(var e=0,i=Api.playerVoApi.getSoldier(),a=t;200>=a;a++){var n=Config.ConquestCfg.getConquestCfgById(a+"");if(!n)break;var o=this.getBattleResult(Api.playerVoApi.getAtk(),i,n.soldierMid/10,n.soldierMid);o.success&&e++,i-=o.cost}return e},e.prototype.getAttCostNum=function(t,e){for(var i=0,a=Api.playerVoApi.getSoldier(),n=t;t+e>n;n++){var o=Config.ConquestCfg.getConquestCfgById(n+"");if(!o)break;var s=this.getBattleResult(Api.playerVoApi.getAtk(),a,o.soldierMid/10,o.soldierMid);s.success&&(i+=s.cost),a-=s.cost}return i},e}(BaseVoApi);__reflect(ConquestVoApi.prototype,"ConquestVoApi");var CrossImacyVoApi=function(t){function e(){var e=t.call(this)||this;return e._zonerankinfos=null,e._prankinfos=null,e._iszonewin=0,e._merank=0,e._mepoint=0,e._countDownTime=0,e}return __extends(e,t),e.prototype.getCountDownTime=function(){return this._countDownTime},e.prototype.setCountDownTime=function(t){this._countDownTime=t},e.prototype.setZoneRankInfo=function(t){this._zonerankinfos=t.atkranks,this._iszonewin=t.iszonewin},e.prototype.setPRankInfo=function(t){this._prankinfos=t.atkranks,this._merank=t.merank,this._mepoint=t.mepoint},Object.defineProperty(e.prototype,"zonerankinfos",{get:function(){return this._zonerankinfos},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"prankinfos",{get:function(){return this._prankinfos},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iszonewin",{get:function(){return this._iszonewin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"merank",{get:function(){return this._merank},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mepoint",{get:function(){return this._mepoint},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._zonerankinfos=null,this._prankinfos=null,this._crossImacyVo=null,t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(CrossImacyVoApi.prototype,"CrossImacyVoApi");var DailybossVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.checkNpcMessage=function(){return 1==this.getStatus()},e.prototype.checkServantcanStatus=function(t){return null!=this.dailybossVo.servant[t]?this.dailybossVo.servant[t]:0},e.prototype.findBestServant=function(t){t||(t=0);var e,i=Api.servantVoApi.getServantInfoIdListWithSort(1);i.sort(function(t,e){var i=Api.servantVoApi.getServantCombatWithId(t),a=Api.servantVoApi.getServantCombatWithId(e);return i-a});for(var a=i.length,n=0;a>n&&(this.checkServantcanStatus(i[n])||(e=i[n],!(Api.servantVoApi.getServantCombatWithId(i[n])>=t)));n++);return e},e.prototype.getScore=function(){return this.dailybossVo?this.dailybossVo.score:0},e.prototype.getShopItemByNum=function(t){return this.dailybossVo&&this.dailybossVo.shop[t]?this.dailybossVo.shop[t]:0},e.prototype.getShopItemNeedScore=function(t){var e=Config.DailybossCfg.getShopItemById(t),i=e.getNeedScoreByNum(Api.dailybossVoApi.getShopItemByNum(t));return i},e.prototype.getBossType=function(){var t=App.DateUtil.getLeftDaySecondByTime(GameData.serverTime),e=Config.DailybossCfg.boss1Time[1]*App.DateUtil.hourSeconds;return t>e?2:1},e.prototype.getStatus=function(){var t=App.DateUtil.getLeftDaySecondByTime(GameData.serverTime);return Config.DailybossCfg.getStatus(t)},e.prototype.getNextStartLeftTime=function(){var t=App.DateUtil.getLeftDaySecondByTime(GameData.serverTime);return Config.DailybossCfg.getNextStartLeftTime(t)},e.prototype.getLeftTime=function(){var t=App.DateUtil.getLeftDaySecondByTime(GameData.serverTime);return Config.DailybossCfg.getLeftTime(t)},e.prototype.getBossLocalTimeStr=function(){return LanguageManager.getlocal("dailybossLocalTimeDesc",[LanguageManager.getlocal("dailybossTimeTitle1"),Config.DailybossCfg.getInTimeStr(1)])+"\n"+LanguageManager.getlocal("dailybossLocalTimeDesc",[LanguageManager.getlocal("dailybossTimeTitle2"),Config.DailybossCfg.getInTimeStr(2)])},e}(BaseVoApi);__reflect(DailybossVoApi.prototype,"DailybossVoApi");var DailytaskVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getTaskFandVByTaskId=function(t){return this.dailytaskVo.dailyTaskList[t]},e.prototype.getTaskStatusByTaskId=function(t){return this.dailytaskVo.dailyTaskList[t]?this.dailytaskVo.dailyTaskList[t].task_f:0},e.prototype.getTaskRewardStatusByRewardId=function(t){return this.dailytaskVo.rewards[t]},e.prototype.getCurLivenessValue=function(){return this.dailytaskVo.liveness},e.prototype.getCurRewards=function(){return this.dailytaskVo.rewards},e.prototype.getTaskIdListAfterSort=function(){var t=Config.DailytaskCfg.getTasksIdList();if(PlatformManager.checkIsShenHeYiWan()||Api.switchVoApi.checkTWShenhe())for(var e=["13","14"],i=0,a=e;i<a.length;i++){var n=a[i],o=t.indexOf(n);o>-1&&t.splice(o,1)}for(var s=[],r=[],l=[],h=0;h<t.length;h++){var d=this.getTaskStatusByTaskId(t[h]);1==d?s.push(t[h]):2==d?l.push(t[h]):r.push(t[h])}return s.concat(r).concat(l)},e.prototype.getTaskIdForMainTaskUI=function(){for(var t=this.getTaskIdListAfterSort(),e=0;"13"==t[e]||"14"==t[e];)e++;return t[e]},e.prototype.checkRedPoint=function(){for(var t in this.dailytaskVo.dailyTaskList)if(1==this.dailytaskVo.dailyTaskList[t].task_f)return!0;return!1},e}(BaseVoApi);__reflect(DailytaskVoApi.prototype,"DailytaskVoApi");var DinnerVoApi=function(t){function e(){var e=t.call(this)||this;return e.lastShareTime=[0,0],e.viewList=[],e}return __extends(e,t),e.prototype.getNum=function(){return this.dinnerVo.num},e.prototype.getPoint=function(){return this.dinnerVo.point},e.prototype.getDtype=function(){return this.dinnerVo.dtype},e.prototype.getIsOpen=function(){return this.dinnerVo.is_open},e.prototype.getEndTime=function(){return this.dinnerVo.end_time},e.prototype.getDayNum=function(){return this.dinnerVo.day_num},e.prototype.getJinfo=function(){return this.dinnerVo.jinfo},e.prototype.getTotalScore=function(){return this.dinnerVo.total_score},e.prototype.getTotalPoint=function(){return this.dinnerVo.total_point},e.prototype.getShopNum=function(){return this.dinnerVo.shop_num},e.prototype.getShopLastTime=function(){return this.dinnerVo.shop_last_time},e.prototype.getShopInfo=function(){return this.dinnerVo.shop_info},e.prototype.getBuyInfo=function(){return this.dinnerVo.buy_info},e.prototype.getLastDay=function(){return this.dinnerVo.lastday},e.prototype.getName=function(){return this.dinnerVo.name},e.prototype.getPic=function(){return this.dinnerVo.pic},e.prototype.getLevel=function(){return this.dinnerVo.level},e.prototype.getTitle=function(){return this.dinnerVo.title},e.prototype.getPhototitle=function(){return this.dinnerVo.phototitle},e.prototype.getListInfo=function(t){return this.viewList.length>t&&this.viewList[t]&&this.viewList[t].uid?this.viewList[t]:null},e.prototype.getListInfoLength=function(){return this.viewList.length},e.prototype.setListInfo=function(t){t&&(this.viewList=t)},e.prototype.getShareTime=function(){return this.dinnerVo.other_info&&this.dinnerVo.other_info.isshare?this.dinnerVo.other_info.isshare:0},e.prototype.isShowNpc=function(){return Api.playerVoApi.getPlayerLevel()>=Config.DinnerCfg.getNeedLv()},e.prototype.getLockedString=function(){return LanguageManager.getlocal("reachLvelUnlockDesc",[Api.playerVoApi.getPlayerOfficeByLevel(Config.DinnerCfg.getNeedLv())])},e.prototype.getNeedItem=function(){return Config.DinnerCfg.getNeedItem()},e.prototype.dispose=function(){this.viewList.length=0,this.lastShareTime=[0,0],t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(DinnerVoApi.prototype,"DinnerVoApi");var GameinfoVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getRegdt=function(){return this.gameinfoVo?this.gameinfoVo.regdt:0},e.prototype.getGuideStep=function(){return this.gameinfoVo?this.gameinfoVo.newerflag:0},e.prototype.getDownType=function(){return this.gameinfoVo&&this.gameinfoVo.info&&this.gameinfoVo.info.downType?this.gameinfoVo.info.downType:""},e}(BaseVoApi);__reflect(GameinfoVoApi.prototype,"GameinfoVoApi");var InviteVoApi=function(t){function e(){var e=t.call(this)||this;return e.sortedByTime=[],e.sortedByPower=[],e.sortedByRecharge=[],e}return __extends(e,t),e.prototype.getFriendNumList=function(){var t=this;console.log("getFriendNumList");var e=[];for(var i in Config.InvitefriendCfg.friendNum)Config.InvitefriendCfg.friendNum.hasOwnProperty(i)&&e.push({cfgId:i,userPid:this.sortedByTime[Config.InvitefriendCfg.friendNum[i].needNum-1]});return this.inviteVo&&e.sort(function(e,i){var a=Config.InvitefriendCfg.friendNum[e.cfgId],n=Config.InvitefriendCfg.friendNum[i.cfgId],o=0,s=0;return o=1===t.inviteVo.rinfo.invite[e.cfgId]?2:t.sortedByTime.length>=a.needNum?0:1,s=1===t.inviteVo.rinfo.invite[i.cfgId]?2:t.sortedByTime.length>=n.needNum?0:1,o!==s?o-s:a.needNum-n.needNum}),console.log("getFriendNumList over"),e},e.prototype.getFriendPowerList=function(){var t=this,e=[];if(this.inviteVo){for(var i in Config.InvitefriendCfg.friendPower)if(Config.InvitefriendCfg.friendPower.hasOwnProperty(i)){for(var a=0,n=0;n<this.sortedByPower.length&&this.inviteVo.info[this.sortedByPower[n]][2]>=Config.InvitefriendCfg.friendPower[i].needPower;n++)a++;e.push({cfgId:i,arriveCount:a})}e.sort(function(e,i){var a=Config.InvitefriendCfg.friendPower[e.cfgId],n=Config.InvitefriendCfg.friendPower[i.cfgId],o=0,s=0;return o=t.inviteVo.rinfo.power[e.cfgId]>=a.limit?2:!t.inviteVo.rinfo.power[e.cfgId]&&e.arriveCount>0||e.arriveCount>t.inviteVo.rinfo.power[e.cfgId]?0:1,s=t.inviteVo.rinfo.power[i.cfgId]>=n.limit?2:!t.inviteVo.rinfo.power[i.cfgId]&&i.arriveCount>0||i.arriveCount>t.inviteVo.rinfo.power[i.cfgId]?0:1,o!==s?o-s:a.needPower-n.needPower})}return e},e.prototype.getFriendRechargeList=function(){var t=this,e=[];if(this.inviteVo){for(var i in Config.InvitefriendCfg.friendRecharge)if(Config.InvitefriendCfg.friendRecharge.hasOwnProperty(i)){for(var a=0,n=0;n<this.sortedByRecharge.length&&this.inviteVo.info[this.sortedByRecharge[n]][3]>=Config.InvitefriendCfg.friendRecharge[i].needRecharge;n++)a++;e.push({cfgId:i,arriveCount:a})}e.sort(function(e,i){var a=Config.InvitefriendCfg.friendRecharge[e.cfgId],n=Config.InvitefriendCfg.friendRecharge[i.cfgId],o=0,s=0;return o=t.inviteVo.rinfo.recharge[e.cfgId]>=a.limit?2:!t.inviteVo.rinfo.recharge[e.cfgId]&&e.arriveCount>0||e.arriveCount>t.inviteVo.rinfo.recharge[e.cfgId]?0:1,s=t.inviteVo.rinfo.recharge[i.cfgId]>=n.limit?2:!t.inviteVo.rinfo.recharge[i.cfgId]&&i.arriveCount>0||i.arriveCount>t.inviteVo.rinfo.recharge[i.cfgId]?0:1,o!==s?o-s:a.needRecharge-n.needRecharge})}return e},e.prototype.processDataOnOpenDialog=function(){var t=this;console.log("processDataOnOpenDialog"),this.inviteVo?(this.sortedByTime=Object.keys(this.inviteVo.info),this.sortedByTime.sort(function(e,i){return t.inviteVo.info[e][6]-t.inviteVo.info[i][6]}),this.sortedByPower=Object.keys(this.inviteVo.info),this.sortedByPower.sort(function(e,i){var a=t.inviteVo.info[e][2],n=t.inviteVo.info[i][2];return a!==n?n-a:t.inviteVo.info[e][6]-t.inviteVo.info[i][6]}),this.sortedByRecharge=Object.keys(this.inviteVo.info),this.sortedByRecharge.sort(function(e,i){var a=t.inviteVo.info[e][3],n=t.inviteVo.info[i][3];return a!==n?n-a:t.inviteVo.info[e][6]-t.inviteVo.info[i][6]})):(this.sortedByTime=[],this.sortedByPower=[],this.sortedByRecharge=[]),console.log("processDataOnOpenDialog over")},e.prototype.getUserNicknameByPid=function(t){return this.inviteVo?String(this.inviteVo.info[t][5]):""},e.prototype.getUserHeadByPid=function(t){return String(this.inviteVo.info[t][4])},e.prototype.getUserServerByPid=function(t){return this.inviteVo?String(this.inviteVo.info[t][1]):"1"},e.prototype.getUserPowerByPid=function(t){return this.inviteVo?String(this.inviteVo.info[t][2]):"0"},e.prototype.getInviteNumGettedReward=function(t){return this.inviteVo?1===this.inviteVo.rinfo.invite[t]:!1},e.prototype.getInvitedNum=function(){return this.sortedByTime.length},e.prototype.getInvitePowerGettedReward=function(t){return this.inviteVo&&this.inviteVo.rinfo.power[t]?this.inviteVo.rinfo.power[t]:0},e.prototype.getInviteRechargeGettedReward=function(t){return this.inviteVo&&this.inviteVo.rinfo.recharge[t]?this.inviteVo.rinfo.recharge[t]:0},e}(BaseVoApi);__reflect(InviteVoApi.prototype,"InviteVoApi");var ItemVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getItemVoListByType=function(t){var e=this.itemVo.itemInfoVoObj,i=new Array;for(var a in e)t==e[a].type&&e[a].num>0&&i.push(e[a]);return i.sort(this.sortA),i},e.prototype.getTitleVoListByType=function(t){var e=this.itemVo.titleInfoVoObj,i=new Array;for(var a in e)t==e[a].type&&("4001"==a?Api.switchVoApi.checkVip1Privilege()&&i.push(e[a]):(-1!=e[a].num||0!=e[a].itemCfg.unlock)&&i.push(e[a]));return i.sort(this.sortA),i},e.prototype.getCurTitleIndex=function(){var t=this.itemVo.titleInfoVoObj,e=0;for(var i in t)if(3==t[i].type){if(Api.playerVoApi.getTitleid()==t[i].id)return e;e++}return null},e.prototype.sortA=function(t,e){return t.sortId-e.sortId},e.prototype.getTitleInfoVoById=function(t){var e=this.itemVo.titleInfoVoObj;return e&&e[t.toString()]?e[t.toString()]:null},e.prototype.getItemInfoVoById=function(t){var e=this.itemVo.itemInfoVoObj;return e&&e[t.toString()]?e[t.toString()]:null},e.prototype.getItemNumInfoVoById=function(t){var e=this.itemVo.itemInfoVoObj;return e&&e[t.toString()]?e[t.toString()].num:0},e.prototype.getItemVoListForServant=function(){var t=this.itemVo.itemInfoVoObj,e=new Array;for(var i in t){var a=t[i].itemCfg;a.target&&2==a.target&&t[i].num>0&&e.push(t[i])}return e.sort(this.sortA),e},e.prototype.getComposeItemList=function(){for(var t=Config.ComposeCfg.getComposeList(this.getComposeVersion()).concat(),e=t.length,i=e-1;i>=0;i--){var a=t[i];a.timeLimit&&this.itemVo.cinfo.et<=GameData.serverTime&&t.splice(i,1)}return t},e.prototype.getComposeVersion=function(){return this.itemVo.cinfo.version},e.prototype.refreshComposeData=function(t){this.itemVo&&this.itemVo.setcinfo(t)},e.prototype.getComposeNumById=function(t){var e=0;return this.itemVo&&this.itemVo.cinfo.info&&null!=this.itemVo.cinfo.info[t]&&(e=Number(this.itemVo.cinfo.info[t])),e},e.prototype.getComposeLimitLeft=function(t){var e=0,i=Config.ComposeCfg.getItemCfgById(t,Api.itemVoApi.getComposeVersion());return i.timeLimit&&(e=this.itemVo.cinfo.et-GameData.serverTime),Math.max(0,e)},e.prototype.checkRedPoint=function(){return this.checkCanCompose()},e.prototype.checkCanCompose=function(){var t=this.getComposeItemList();if(t)for(var e=t.length,i=0;e>i;i++){for(var a=t[i],n=a.needItemCfgList,o=n.length,s=!0,r=0;o>r;r++){var l=n[r].id,h=Api.itemVoApi.getItemNumInfoVoById(l),d=a.getNeedItemNumById(l);d>h&&(s=!1)}if(a.needGem){var h=Api.playerVoApi.getPlayerGem(),d=a.needGem;d>h&&(s=!1)}if(s){if(!a.composeLimit)return!0;if(Api.itemVoApi.getComposeNumById(a.id)<a.composeLimit)return!0}}return!1},e.prototype.checkCanComposeById=function(t){for(var e=Config.ComposeCfg.getItemCfgById(t,this.getComposeVersion()),i=e.needItemCfgList,a=i.length,n=!0,o=0;a>o;o++){var s=i[o].id,r=Api.itemVoApi.getItemNumInfoVoById(s),l=e.getNeedItemNumById(s);l>r&&(n=!1)}if(e.needGem){var r=Api.playerVoApi.getPlayerGem(),l=e.needGem;l>r&&(n=!1)}if(n){if(!e.composeLimit)return!0;if(Api.itemVoApi.getComposeNumById(e.id)<e.composeLimit)return!0}return!1},e.prototype.isStart=function(t){return this.itemVo.sinfo&&this.itemVo.sinfo[t]&&this.itemVo.sinfo[t].st<=GameData.serverTime&&this.itemVo.sinfo[t].et>GameData.serverTime?!0:!1},e.prototype.isEnd=function(t){return this.itemVo.sinfo[t]&&this.itemVo.sinfo[t].et<GameData.serverTime?!0:!1},e.prototype.dispose=function(){this.itemVo=null,t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(ItemVoApi.prototype,"ItemVoApi");var LampVoApi=function(t){function e(){var e=t.call(this)||this;return e._waitingShow=[],e}return __extends(e,t),e.prototype.insertLampInfo=function(t){for(var e in t)this._waitingShow.push(t[e]);this._waitingShow.length>0&&this._waitingShow.sort(function(t,e){return t.sortId-e.sortId})},e.prototype.formatData=function(t){this.insertLampInfo(t),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_SHOW_LAMP)},e.prototype.getShowLampInfo=function(){if(this._waitingShow.length>0){var t=this._waitingShow.shift();return t}return null},e.prototype.dispose=function(){this._waitingShow.length=0,t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(LampVoApi.prototype,"LampVoApi");var MailVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.formatDetailData=function(t){if(t){var e=Number(t.mid),i=this.getMailInfoVoById(e);i&&i.initData(t)}},e.prototype.getMailInfoVoList=function(){var t=this.mailVo.mailInfoVoObj,e=new Array;for(var i in t)e.push(t[i]);return e.sort(this.sortA),e},e.prototype.sortA=function(t,e){return t.isread==e.isread?e.mid-t.mid:t.isread-e.isread},e.prototype.getUnreadNum=function(){return this.mailVo.unread},e.prototype.getMailInfoVoById=function(t){if(this.mailVo){var e=this.mailVo.mailInfoVoObj;if(e&&e[t.toString()])return e[t.toString()]}return null},e.prototype.getTotalNum=function(){return this.mailVo.totalNum
},e.prototype.dispose=function(){this.mailVo=null,t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(MailVoApi.prototype,"MailVoApi");var ManageVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.formatData=function(e){t.prototype.formatData.call(this,e),this._affairVo||(this._affairVo=new AffairVo),this._affairVo.initData(e)},e.prototype.isShowNpc=function(){return Api.rookieVoApi.isInGuiding&&Api.rookieVoApi.guideId<18?!1:!0},e.prototype.formatAutoRes=function(t){this._autoResVo||(this._autoResVo=new AutoResVo),this._autoResVo.initData(t)},e.prototype.resetAutoRes=function(){this._autoResVo&&this._autoResVo.reset()},e.prototype.checkAutoRes=function(){return Api.playerVoApi.getPlayerLevel()>=Config.ManageCfg.needLv||Api.playerVoApi.getPlayerVipLevel()>=Config.ManageCfg.needVip},e.prototype.getAutoGold=function(){return this._autoResVo.gold},e.prototype.getAutoFood=function(){return this._autoResVo.food},e.prototype.getAutoSoldier=function(){return this._autoResVo.soldier},e.prototype.getManageItemsVo=function(){return this.manageVo.itemsVo},e.prototype.isOnekeyManage=function(){if(this.manageVo.itemsVo&&this.manageVo.itemsVo.length>0){var t=this.manageVo.itemsVo.length,e=0;for(e;t>e;e++){if(this.manageVo.itemsVo[e].num>0)return 0;if(0==this.manageVo.itemsVo[0].num&&0==this.manageVo.itemsVo[1].num&&Api.playerVoApi.getFood()<=0)return 1}return 2}},e.prototype.getReapFood=function(){return Math.floor(Api.playerVoApi.getPolitics())},e.prototype.getReapGold=function(){return Math.floor(Api.playerVoApi.getInte())},e.prototype.getReapSoldier=function(){return Math.min(Math.floor(Api.playerVoApi.getCharm()),Api.playerVoApi.getFood()/Config.ManageCfg.needFood)},e.prototype.getNeedFood=function(){return this.getReapSoldier()*Config.ManageCfg.needFood},e.prototype.getManageNeedTime=function(){var t=Api.playerVoApi.getInte()+Api.playerVoApi.getPolitics()+Api.playerVoApi.getCharm();return Config.ManageCfg.getManageNeedTime(t)},e.prototype.getNeedItem=function(){return String(Config.ManageCfg.needItem)},e.prototype.checkAndShowAutoReward=function(t){this._autoResVo&&this._autoResVo.notice&&ViewController.getInstance().openView(ViewConst.POPUP.AUTORESPOPUPVIEW,{type:t})},e.prototype.getAffairST=function(){return this._affairVo.st},e.prototype.getCurAffairOpt=function(){return this._affairVo.opt},e.prototype.getCurAffairNums=function(){if(0==this._affairVo.num){var t=GameData.serverTime,e=Math.floor((t-this.getAffairST())/GameConfig.config.affairCfg.needTime),i=Config.LevelCfg.getCfgByLevel(Api.playerVoApi.getPlayerLevel().toString()).affair;e+=this._affairVo.num,e>i&&(e=i),this._affairVo.num=e}return this._affairVo.num},e.prototype.setCurAffairNums=function(t){this._affairVo.num=t},e.prototype.checkNpcMessage=function(){for(var t=!1,e=Api.manageVoApi.getManageItemsVo(),i=e.length,a=0;i>a;a++)if(e[a].needRefresh){t=!0;break}return t},e.prototype.checkAffairNpcMessage=function(){var t="";return this.getCurAffairNums()>0&&(t=LanguageManager.getlocal("sceneAffairNpcTipMessage")),t},e.prototype.dispose=function(){this._affairVo&&(this._affairVo.dispose(),this._affairVo=null),t.prototype.dispose.call(this),this.manageVo=null},e}(BaseVoApi);__reflect(ManageVoApi.prototype,"ManageVoApi");var OtherInfoVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.isRankVisited=function(t){return 0==t?this.otherInfoVo.power:1==t?this.otherInfoVo.challenge:2==t?this.otherInfoVo.imacy:void 0},e.prototype.getOtherInfo=function(){return this.otherInfoVo},e.prototype.isGetBindingReward=function(){return this.otherInfoVo.info.bindFlag&&1==this.otherInfoVo.info.bindFlag?!0:!1},e.prototype.getPalaceFlag=function(){return this.otherInfoVo.palace_flag},e.prototype.getBanet=function(){return this.otherInfoVo.banet},e.prototype.getCandyGetInfo=function(){return this.otherInfoVo.info.candy},e.prototype.getFkShareInfo=function(){return this.otherInfoVo.info.fkShare},e.prototype.getFkFocusInfo=function(){return this.otherInfoVo.info.fkFocus},e.prototype.getFkIsshowRed=function(){if(!this.otherInfoVo.info.fkShare)return!1;for(var t=Config.GameprojectCfg.rewardFKYLC2,e=Object.keys(t),i=e.length,a=Api.otherInfoVoApi.getFkShareInfo(),n=0;i>n;n++){var o=(t[e[n]],1);if(o=a&&a.n>=Number(e[n])?1==a.get[e[n]]?2:1:3,1==o)return!0}return!1},e.prototype.checkShowWanbaDesktopIcon=function(){return PlatformManager.isSupportDesktopIcon()&&!this.checkWanbaHasSendDesktop()},e.prototype.checkShowWanbaShareIcon=function(){return PlatformManager.isSupportShare()&&!this.checkWanbaDailyHasShared()},e.prototype.checkWanbaHasSendDesktop=function(){return this.otherInfoVo&&this.otherInfoVo.info&&this.otherInfoVo.info.wbsendFlag},e.prototype.checkWanbaDailyHasShared=function(){return this.otherInfoVo&&this.otherInfoVo.info&&this.otherInfoVo.info.wbdailyshareFlag},e.prototype.checkrealnamerewards=function(){return this.otherInfoVo.info.author3k?!1:!0},e.prototype.getServantSortId=function(){var t=this.otherInfoVo.info.sortId;return t?t:1},e.prototype.getUnlockList=function(){if(this.otherInfoVo.info)var t=this.otherInfoVo.info.unlockList;return t},e.prototype.getFunctionName=function(){var t=Api.otherInfoVoApi.getUnlockList(),e=[];e=Config.UnlocklistCfg.getUnlockItemCfgList();for(var i=[],a=[],n=[],o=0;o<e.length;o++)if(t&&1==t[e[o].key]){if(i.push(e[o]),i.length==e.length)return null}else if(Api[e[o].gameName+"VoApi"]&&Api[e[o].gameName+"VoApi"].isShowNpc){var s=Api[e[o].gameName+"VoApi"].isShowNpc();s?a.push(e[o]):n.push(e[o])}i.sort(function(t,e){return t.sortId>e.sortId?1:t.sortId==e.sortId?0:-1}),a.sort(function(t,e){return t.sortId>e.sortId?1:t.sortId==e.sortId?0:-1}),n.sort(function(t,e){return t.sortId>e.sortId?1:t.sortId==e.sortId?0:-1}),e=a.concat(n).concat(i);var r=LanguageManager.getlocal("functionModuleDes"+e[0].sortId);return r},e.prototype.getFunctionRedhot=function(){var t=Config.UnlocklistCfg.getUnlockItemCfgList();if(this.otherInfoVo&&this.otherInfoVo.info&&this.otherInfoVo.info.unlockList){for(var e=this.otherInfoVo.info.unlockList,i=!1,a=0;a<t.length;a++)if(Api[t[a].gameName+"VoApi"]&&Api[t[a].gameName+"VoApi"].isShowNpc){var n=Api[t[a].gameName+"VoApi"].isShowNpc();if(n&&1!=e[t[a].key])return i=!0}return i}return!1},e.prototype.getCoverState=function(){return this.otherInfoVo&&this.otherInfoVo.info&&this.otherInfoVo.info.cover?this.otherInfoVo.info.cover:0},e.prototype.getFBBindFlag=function(){return this.otherInfoVo&&this.otherInfoVo.info&&this.otherInfoVo.info.gtfbbindFlag?this.otherInfoVo.info.gtfbbindFlag:0},e.prototype.certification=function(){return this.otherInfoVo.certification?!0:!1},e.prototype.dispose=function(){this.otherInfoVo=null,t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(OtherInfoVoApi.prototype,"OtherInfoVoApi");var PalaceVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getRoleInfoByTitleId=function(t){return this.palaceVo.palace[t]},e.prototype.getRoleInfoList=function(){return this.palaceVo.palace},e.prototype.updateRoleSign=function(t,e){this.palaceVo.palace[t].sign=e},e.prototype.isInThePalace=function(){for(var t in this.palaceVo.palace){var e=this.palaceVo.palace[t];if(e.uid==Api.playerVoApi.getPlayerID())return t}return!1},e.prototype.checkNpcMessage=function(){return 0==Api.otherInfoVoApi.getOtherInfo().palace_flag},e.prototype.isDataInit=function(){return this.palaceVo&&this.palaceVo.isInit},e.prototype.isCrossOpen=function(){return Api.switchVoApi.isCrossOpen()},e.prototype.openMainView=function(){this.isCrossOpen()?ViewController.getInstance().openView(ViewConst.COMMON.PALACECROSSVIEW):ViewController.getInstance().openView(ViewConst.COMMON.PALACEVIEW)},e.prototype.isShowBuildingFlag=function(t){var e=GameConfig.config.buildingCfg[t],i=e.title;for(var a in i){var n=this.palaceVo.palace[i[a]];if(n&&n.uid)return!0}return!1},e}(BaseVoApi);__reflect(PalaceVoApi.prototype,"PalaceVoApi");var PlayerVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getPlayerMaxVip=function(){return Config.VipCfg.getMaxLevel()},e.prototype.getPlayerID=function(){return this.playerVo.uid},e.prototype.getPlayePicId=function(){return this.playerVo.pic},e.prototype.getPlayerSmallPic=function(){return"smallpic"+this.playerVo.pic},e.prototype.getPlayerBigPic=function(){return"bigpic"+this.playerVo.pic},e.prototype.getPlayerName=function(){return this.playerVo.name},e.prototype.getPlayerLevel=function(){return this.playerVo.level},e.prototype.getPlayerExp=function(){return this.playerVo.exp},e.prototype.getPlayerVipLevel=function(){return this.playerVo.vip},e.prototype.getPlayerNextVipLevel=function(){var t=this.playerVo.vip+1;return t=Math.min(Config.VipCfg.getMaxLevel(),t)},e.prototype.getPlayerVipExp=function(){return this.playerVo.vipexp},e.prototype.getPlayerGem=function(){return this.playerVo.gem},e.prototype.getPlayerGemStr=function(){return App.StringUtil.changeIntToText(this.playerVo.gem)},e.prototype.getPlayerGold=function(){return this.playerVo.gold},e.prototype.getPlayerGoldStr=function(){return App.StringUtil.changeIntToText(this.playerVo.gold)},e.prototype.getPlayerAllianceId=function(){return this.playerVo.mygid},e.prototype.getPlayerAllianceName=function(){return this.playerVo.mygname},e.prototype.getPlayerPower=function(){return this.playerVo.power},e.prototype.getPlayerPowerStr=function(){return App.StringUtil.changeIntToText(this.playerVo.power)},e.prototype.getPlayerBuyGem=function(){return this.playerVo.buyg},e.prototype.getFood=function(){return this.playerVo.food},e.prototype.getFoodStr=function(){return App.StringUtil.changeIntToText(this.playerVo.food)},e.prototype.getPlayerOffice=function(){return this.getPlayerOfficeByLevel(this.playerVo.level)},e.prototype.getPlayerOfficeByLevel=function(t){return LanguageManager.getlocal("officialTitle"+t)},e.prototype.getPlayerPrevOffice=function(){return this.playerVo.level>1?LanguageManager.getlocal("officialTitle"+(this.playerVo.level-1)):LanguageManager.getlocal("officialTitle"+this.playerVo.level)},e.prototype.getSoldier=function(){return this.playerVo.soldier},e.prototype.getSoldierStr=function(){return App.StringUtil.changeIntToText(this.playerVo.soldier)},e.prototype.getCharm=function(){return this.playerVo.charm},e.prototype.getInte=function(){return this.playerVo.inte},e.prototype.getAtk=function(){return this.playerVo.atk},e.prototype.getPolitics=function(){return this.playerVo.politics},e.prototype.getTitleid=function(){return this.playerVo.titleid},e.prototype.getNextLevelExp=function(){var t=Api.playerVoApi.getPlayerLevel();return t<Config.LevelCfg.getMaxLevel()&&t++,Config.LevelCfg.getCfgByLevel(t.toString()).exp},e.prototype.getValueByResType=function(t){"number"!=typeof t&&(t=ItemEnums[t]);var e=0;return 1==t?e=Api.playerVoApi.getPlayerGem():2==t?e=Api.playerVoApi.getPlayerGold():3==t?e=Api.playerVoApi.getFood():4==t?e=Api.playerVoApi.getSoldier():5==t&&(e=Api.playerVoApi.getPlayerExp()),e},e.prototype.getCurLevelPrivilegeTxtStr=function(t){t=t?t:Api.playerVoApi.getPlayerLevel();var e=Config.LevelCfg.getCfgByLevel(t.toString());if(!e)return LanguageManager.getlocal("promotionView_topLV");var i="",a=1;if(e.servant&&(i+=a.toString()+"."+LanguageManager.getlocal("promotion_privilege6")+LanguageManager.getlocal("servant_name"+e.servant)+"\n",a+=1),i+=a++ +"."+LanguageManager.getlocal("promotion_privilege1")+e.gold+"\n"+a++ +"."+LanguageManager.getlocal("promotion_privilege2")+e.food+"\n"+a++ +"."+LanguageManager.getlocal("promotion_privilege3")+e.soldier+"\n"+a++ +"."+LanguageManager.getlocal("promotion_privilege4")+e.affair+"\n"+a++ +"."+LanguageManager.getlocal("promotion_privilege7",[String(e.gem)]),Api.practiceVoApi.isPlayerPracticeEnable()){var n=this.getPlayerLevel(),o=GameConfig.config.practicebaseCfg.level,s=o[n-1];s||(s=o[o.length-1]),i+="\n",i=i+a++ +"."+LanguageManager.getlocal("promotion_privilege8")+s}return i},e.prototype.getPlayerPortrait=function(t,e,i){var a=new BaseDisplayObjectContainer,n=egret.Rectangle.create(),o=function(t){t&&(null==t.loadusernum&&(t.loadusernum=0),t.loadusernum++,t.loadusernum==t.maxNum&&(t.getChildByName("myBody")&&(t.getChildByName("myBody").visible=!0),t.getChildByName("myHead")&&(t.getChildByName("myHead").visible=!0),t.getChildByName("myHair")&&(t.getChildByName("myHair").visible=!0)))},s="user_body";n.setTo(0,0,300,618),t>=1e3&&(s="user_body_full_",n.setTo(0,0,382,618)),a.maxNum=2;var r="user_hair"+e;5>=e&&(r="user_hair7");var l=egret.Rectangle.create();l.setTo(0,0,85,140);var h=BaseLoadBitmap.create(r,l,{callback:o,callbackThisObj:this,callbackParams:[a]});h.visible=!1,h.x=111,h.y=-3,h.name="myHair",a.addChild(h),a.maxNum=3;var d=BaseLoadBitmap.create(s+t,n,{callback:o,callbackThisObj:this,callbackParams:[a]});d.visible=!1,d.name="myBody",a.addChild(d);var g=egret.Rectangle.create();g.setTo(0,0,136,143);var c=BaseLoadBitmap.create("user_head"+e,g,{callback:o,callbackThisObj:this,callbackParams:[a]});return c.visible=!1,c.x=87,c.name="myHead",a.addChild(c),t>=1e3&&(c.x=117,h.x=141),d.y=91,a},e.prototype.getMyPortrait=function(){var t=this.getPlayerLevel();return this.playerVo.titleid>0&&(t=this.playerVo.titleid),this.getPlayerPortrait(t,this.getPlayePicId())},e.prototype.getUserHeadImgPath=function(){return"user_head"+this.getPlayePicId()},e.prototype.getUserHeadImgPathById=function(t){return"user_head"+t},e.prototype.getNo=function(){},e.prototype.getVipHeadBg=function(){var t=Config.TitleCfg.getTitleCfg();for(var e in t){var i=t[e],a=Api.itemVoApi.getTitleInfoVoById(Number(e));if(2==i.isTitle&&2==a.num)return"head_circle_bg_"+e}return null},e.prototype.getVipHeadBgByTitle=function(t){return t&&"0"!=t?"head_circle_bg_"+t:null},e.prototype.getPlayerCircleHead=function(t,e){void 0===e&&(e="-1");var i=new BaseDisplayObjectContainer,a="head_circle_bg";"-1"==e?this.getVipHeadBg()&&(a=this.getVipHeadBg()):e&&this.getVipHeadBgByTitle(e)&&(a=this.getVipHeadBgByTitle(e));var n=BaseBitmap.create(a);n.name="myBody",i.addChild(n),this.getVipHeadBg()&&(n.y=-3);var o=BaseBitmap.create("head_circle_bg2");o.name="myBody2",i.addChild(o);var s=egret.Rectangle.create();s.setTo(0,0,136,143);var r=BaseLoadBitmap.create("user_head"+t,s);return r.x=0,r.y=-10,r.setScale(2/3),r.name="myHead",i.addChild(r),i},e}(BaseVoApi);__reflect(PlayerVoApi.prototype,"PlayerVoApi");var PracticeVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getLevel=function(){return this.practiceVo.level},e.prototype.geAttrValues=function(){return this.practiceVo.attr},e.prototype.geExp=function(){return this.practiceVo.exp},e.prototype.getProgressValue=function(){var t=GameConfig.config.practicebaseCfg.upgradeNeed,e=t[this.practiceVo.level-1];return{v1:this.practiceVo.exp+"/"+e,v2:this.practiceVo.exp/e}},e.prototype.getPracticeTaskInfo=function(t){return this.practiceVo.task[t]},e.prototype.getStorageInfo=function(){return this.practiceVo.storage},e.prototype.isCollectEnable=function(){var t=this.practiceVo.storage.st,e=GameConfig.config.practicebaseCfg.time;return GameData.serverTime-t>=e?!0:!1},e.prototype.getPracticeTaskAccumulation=function(t){var e=Config.PracticeCfg.getPracticeListById(t.id),i=0,a=0,n=0,o=0,s=!1,r=Object.keys(e.conditionList),l=r.length;l==t.stage&&t.stage==l&&2==t.f&&(s=!0);for(var h=0;l>h;h++){var d=r[h],g=Number(d);if(g<=t.stage){var c=e.conditionList[d];2==t.f&&(i+=c.effect),a=i+c.effect,o=c.needNum}}var p=e.conditionList[String(t.stage)],_=(p.conditionType,void 0),u=void 0;return e.servantId&&(_=Api.servantVoApi.getServantObj(e.servantId)),e.wifeId&&(u=Api.wifeVoApi.getWifeInfoVoById(e.wifeId)),n=this._getTaskVoStageV(t),{curV:i,nextV:a,conditionV:n,conditionNeed:o,isComp:s}},e.prototype._getTaskVoStageV=function(t){var e=Config.PracticeCfg.getPracticeListById(t.id),i=e.conditionList[String(t.stage)],a=i.conditionType,n=void 0,o=void 0;e.servantId&&(n=Api.servantVoApi.getServantObj(e.servantId)),e.wifeId&&(o=Api.wifeVoApi.getWifeInfoVoById(e.wifeId));var s=0;if(n)if(1==t.stage)s=1;else switch(a){case 1:s=n.level;break;case 2:s=n.clv}if(o)if(1==t.stage)s=1;else switch(a){case 3:s=o.intimacy;break;case 4:s=o.glamour}return s},e.prototype.isPracticeOPen=function(){return Api.switchVoApi.isPracticeOPen()},e.prototype.isPlayerPracticeEnable=function(){var t=!1;if(!this.isPracticeOPen())return t;var e=GameConfig.config.practicebaseCfg.unlockLv;return Api.switchVoApi.isPracticeOPen()&&Api.playerVoApi.getPlayerLevel()>=e&&(t=!0),t},e.prototype.showPracticeGet=function(t){void 0===t&&(t=0),this.isPlayerPracticeEnable()&&t>0&&ViewController.getInstance().openView(ViewConst.BASE.PRACTICEGETVIEW,{pnum:t})},e.prototype.isPracticeBuildingUnlock=function(){var t=!1;if(!this.isPracticeOPen())return t;var e=GameConfig.config.practicebaseCfg.unlockLv;return Api.playerVoApi.getPlayerLevel()>=e&&(t=!0),t},e.prototype.getbuyNum=function(){return this.practiceVo.info.buynum},e.prototype.getspd=function(){return this.practiceVo.spd},e.prototype.isStoregeFull=function(){var t=GameConfig.config.practicebaseCfg,e=t.storeLimit[Api.playerVoApi.getPlayerLevel()-1],i=this.practiceVo.storage.st,a=GameConfig.config.practicebaseCfg.time,n=Math.floor((GameData.serverTime-i)/a);return n*this.getspd()>=e?!0:!1},e.prototype.isPracticeLvupEnable=function(){var t=this.practiceVo.level,e=GameConfig.config.practicebaseCfg.upgradeNeed[t-1];return this.practiceVo.exp>=e?!0:!1},e.prototype.practiceAttrRedList=function(){var t=(this.practiceVo.attr,this.practiceVo.task,{});for(var e in this.practiceVo.task){var i=this.practiceVo.task[e],a=Config.PracticeCfg.getPracticeListById(i.id),n=a.conditionList[String(i.stage)];a.type;t[e]||this._getTaskVoStageV(i)>=n.needNum&&1==i.f&&(t[e]=1)}return t},e.prototype.isShowRedForPBottom=function(){if(this.isPracticeLvupEnable())return!0;var t=this.practiceAttrRedList();for(var e in t)if(t[e]>0)return!0;return!1},e}(BaseVoApi);__reflect(PracticeVoApi.prototype,"PracticeVoApi");var PrestigeVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getPem=function(){return this.prestigeVo.pem},e.prototype.getInfo=function(){return this.prestigeVo.info},e.prototype.getLog=function(){return this.prestigeVo.log},Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){if(this.prestigeVo.info){var t=this.prestigeVo.info;if(Number(t.pid)<4&&Number(t.v)>=Config.PrestigeCfg.getPrestigeCfgById(Number(t.pid)).prestige)return!0}return!1},enumerable:!0,configurable:!0}),e}(BaseVoApi);__reflect(PrestigeVoApi.prototype,"PrestigeVoApi");var PrisonVoApi=function(t){function e(){var e=t.call(this)||this;return e.currPrison=0,e}return __extends(e,t),e.prototype.getMypre=function(){return this.prisonVo.mypre},e.prototype.getMaxpre=function(){return this.prisonVo.maxpre},e.prototype.getDailypre=function(){return this.prisonVo.dailypre},e.prototype.getPrisonInfo=function(){var t=[];for(var e in this.prisonVo.info)t.push(this.prisonVo.info[e]);return t},e.prototype.getcurrPrisonNumber=function(){var t=[];for(var e in this.prisonVo.info)0!=this.prisonVo.info[e]&&t.push(e);return t.length},e.prototype.getIndexPrisonNum=function(t){void 0===t&&(t=0);for(var e in this.prisonVo.info)if(""+t==e)return this.prisonVo.info[e]},e.prototype.getCurrPrisonId=function(){var t=0;for(var e in this.prisonVo.info)if(0!=this.prisonVo.info[e]){t=Number(e),this.currPrison=t;break}return t},e.prototype.getPrisonTitleStr=function(){return"prisonerIndex"+this.currPrison},e.prototype.getPrisonName=function(){return"prisonerName"+this.currPrison},e.prototype.isShowNpc=function(){var t=!1,e=Config.PrisonCfg.getIndexPrisonItemCfg(1).unlock;return t=Api.challengeVoApi.getCurChannelId()>e?!0:!1},e.prototype.getLockedString=function(){var t=Config.PrisonCfg.getIndexPrisonItemCfg(1).unlock/41;return LanguageManager.getlocal("prisonUnlockDesc",[t+""])},e.prototype.checkNpcMessage=function(){var t=0;return null!=Config.PrisonCfg.getIndexPrisonItemCfg(this.getCurrPrisonId())&&(t=Config.PrisonCfg.getIndexPrisonItemCfg(this.getCurrPrisonId()).cost),this.getcurrPrisonNumber()>=1&&this.prisonVo.mypre>=t&&t>0?!0:!1},e.prototype.dispose=function(){this.currPrison=0,t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(PrisonVoApi.prototype,"PrisonVoApi");var RankVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getRankListByTabIdx=function(t){return 0==t?this.rankVo.pinfoList:1==t?this.rankVo.cinfoList:2==t?this.rankVo.iinfoList:this.rankVo.pinfoList},e.prototype.getcInfoList=function(){return this.rankVo.cinfoList},e.prototype.getiInfoList=function(){return this.rankVo.iinfoList},e.prototype.getpInfoList=function(){return this.rankVo.pinfoList},e.prototype.getcRank=function(){return this.rankVo.crank},e.prototype.getimacy=function(){return this.rankVo.imacy},e.prototype.getcid=function(){return this.rankVo.cid},e.prototype.getprank=function(){return this.rankVo.prank},e.prototype.getirank=function(){return this.rankVo.irank},e.prototype.checkNpcMessage=function(){for(var t=0;3>t;t++){var e=Api.otherInfoVoApi.isRankVisited(t);if(0==e)return!0}return!1},e}(BaseVoApi);__reflect(RankVoApi.prototype,"RankVoApi");var RechargeVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.checkFirstRecharge=function(){return 0==Api.shopVoApi.getPayFlag()},e}(BaseVoApi);__reflect(RechargeVoApi.prototype,"RechargeVoApi");var RookieVoApi=function(t){function e(){var e=t.call(this)||this;return e.isGuiding=!1,e.isInGuiding=!1,e._waitingGuide=[],e.waitingPosY=null,e.curGuideKey=null,e.curIndex=1,e.guideId=1,e}return __extends(e,t),e.prototype.getIsGuiding=function(){return this.isGuiding},e.prototype.insertWaitingGuide=function(t,e){this._waitingGuide.push(t),e&&(this._waitingGuide=[t])},e.prototype.checkWaitingGuide=function(){if(this._waitingGuide.length>0){var t=this._waitingGuide.shift();ViewController.getInstance().openView(ViewConst.BASE.ROOKIEVIEW,t)}},e.prototype.checkNextStep=function(){this.isGuiding&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_ROOKIE_NEXT_STEP)},e.prototype.showRookieView=function(){this.isGuiding&&(ViewController.getInstance().getView(ViewConst.BASE.ROOKIEVIEW).visible=!0)},e.prototype.hiddenRookieView=function(){this.isGuiding&&(ViewController.getInstance().getView(ViewConst.BASE.ROOKIEVIEW).visible=!1)},e.prototype.dispose=function(){this.isGuiding=!1,this.isInGuiding=!1,this._waitingGuide.length=0,this.curStep=null,this.curIndex=1,this.guideId=1,this.waitingPosY=null,this.curGuideKey=null,t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(RookieVoApi.prototype,"RookieVoApi");var SearchVoApi=function(t){function e(){var e=t.call(this)||this;return e.buildInfoList={},e.wifeList={},e}return __extends(e,t),e.prototype.formatData=function(e){t.prototype.formatData.call(this,e)},e.prototype.checkNpcMessage=function(){return this.getSearchNum()>0},e.prototype.getWifeValueById=function(t){var e=this.searchVo.info[t];return e?e.progress:0},e.prototype.getNeedItem=function(){return Config.SearchbaseCfg.needItem},e.prototype.getSearchNum=function(){return this.searchVo.searchNum},e.prototype.getLeftTime=function(){return this.searchVo.leftTime},e.prototype.getSearchNumLocalStr=function(){var t;return t=this.getSearchNum()<1?LanguageManager.getlocal("searchViewLeftNumDesc",[App.DateUtil.getFormatBySecond(this.getLeftTime(),1)]):LanguageManager.getlocal("searchViewLeftNumDesc",[Api.searchVoApi.getSearchNum().toString()+"/"+Api.searchVoApi.getMaxSearchNum().toString()])},e.prototype.getMaxSearchNum=function(){return this.searchVo.maxSearchNum},e.prototype.getPersonListByBuildId=function(t){var e=String(t);if("5"==e&&(this.buildInfoList[e]=null),null==this.buildInfoList[e]){var i=[],a=Config.SearchCfg.getPersonItemCfgListByBuildId(t);for(var n in a){var o=a[n];if(5==t&&o.unlock&&o.unlock.needVip){var s=o.unlock.needVip,r=Api.vipVoApi.getMaxbtnNum();r>=s&&this.getInfoItemList(o,i)}else this.getInfoItemList(o,i)}this.buildInfoList[e]=i}return this.buildInfoList[e]},e.prototype.getInfoItemList=function(t,e){var i=new SearchBuildInfoItemVo;i.initData(t.personId),e.push(i),t.wifeId&&(this.wifeList[t.wifeId]=i)},e.prototype.getCurLuckNum=function(){var t=0;if(this.searchVo){var e=Config.SearchbaseCfg.resAddMax,i=GameData.serverTime,a=Config.SearchbaseCfg.luckNeedTime,n=Math.floor((i-this.searchVo.lucky.st)/a);t=Math.min(Math.max(e,this.searchVo.lucky.num),this.searchVo.lucky.num+n)}return t},e.prototype.getSearchLuckFreeNum=function(){return Config.VipCfg.getVipCfgByLevel(Api.playerVoApi.getPlayerVipLevel()).searchLuckFree-this.getSearchLuckUsedFreeNum()},e.prototype.getSearchLuckUsedFreeNum=function(){return this.searchVo?this.searchVo.lucky.vipfree:0},e.prototype.getMaxLuckNum=function(){return Config.SearchbaseCfg.luckMax},e.prototype.getMaxLuckByType=function(t){return t==this.getDonateTypes()[2]?this.getMaxLuckNum():Config.SearchbaseCfg.resAddMax},e.prototype.getAutosetValue=function(){return this.searchVo?this.searchVo.lucky.autoset:0},e.prototype.getFoodOpen=function(){return this.searchVo?this.searchVo.lucky.foodopen:0},e.prototype.getGoldOpen=function(){return this.searchVo?this.searchVo.lucky.goldopen:0},e.prototype.getDonateTypes=function(){return[ItemEnums[2],ItemEnums[3],ItemEnums[1]]},e.prototype.getDonateCost=function(t){if(t==this.getDonateTypes()[2])return Config.SearchbaseCfg.getGemCostByLuck(this.getCurLuckNum());var e=this.searchVo?this.searchVo.lucky.buynum:0;return(e+1)*Config.SearchbaseCfg.resCost},e.prototype.checkCostEnough=function(t,e){if("food"==t){if(Api.playerVoApi.getFood()<this.getDonateCost(t))return e&&App.CommonUtil.showTip(Config.RewardCfg.getNotEnoughLocalTip(ItemEnums[t])),!1}else if("gold"==t){if(Api.playerVoApi.getPlayerGold()<this.getDonateCost(t))return e&&App.CommonUtil.showTip(Config.RewardCfg.getNotEnoughLocalTip(ItemEnums[t])),!1}else if("gem"==t&&Api.playerVoApi.getPlayerGem()<this.getDonateCost(t))return e&&App.CommonUtil.showTip(Config.RewardCfg.getNotEnoughLocalTip(ItemEnums[t])),!1;return!0},e.prototype.getPersonValueLocalStr=function(t){var e=Config.SearchCfg.getPersonItemCfgByPersonId(t);if(e.wifeId&&e.value){var i=Api.searchVoApi.getWifeValueById(t)/e.value,a="";return.3>=i?a="searchWifeDesc1":i>.3&&.6>=i?a="searchWifeDesc2":i>.6&&1>i?a="searchWifeDesc3":i&&(a="searchWifeDesc4"),LanguageManager.getlocal(a,[e.name])}return""},e.prototype.isShowNpc=function(){return Api.playerVoApi.getPlayerLevel()>=Config.SearchbaseCfg.needLv},e.prototype.getLockedString=function(){return LanguageManager.getlocal("reachLvelUnlockDesc",[Api.playerVoApi.getPlayerOfficeByLevel(Config.SearchbaseCfg.needLv)])},e.prototype.checkOneKey=function(){return Api.playerVoApi.getPlayerVipLevel()>=this.getOneKeyNeedVipLevel()},e.prototype.getOneKeyNeedVipLevel=function(){return Config.SearchbaseCfg.needVip},e.prototype.openMainView=function(){this.isShowNpc()&&ViewController.getInstance().openView(App.StringUtil.firstCharToUper(this.getModeName())+"View")},e}(BaseVoApi);__reflect(SearchVoApi.prototype,"SearchVoApi");var ServantVoApi=function(t){function e(){var e=t.call(this)||this;return e.isShowAtkraceGuide=!1,e.isCheckGuide=!1,e}return __extends(e,t),e.prototype.setWaitShowData=function(t){this.waitShowData=t},e.prototype.getWaitShowData=function(){var t=this.waitShowData;return this.waitShowData=null,t},e.prototype.getServantCount=function(){return Object.keys(this.servantVo.servantInfoVoObj).length},e.prototype.getServantInfoList=function(){return this.servantVo.servantInfoVoObj},e.prototype.getServantObj=function(t){return this.servantVo.servantInfoVoObj[t]},e.prototype.getServantInfoListWithSort=function(t){t=t?t:1;for(var e=this.getServantInfoIdListWithSort(t),i=[],a=0;a<e.length;a++)i.push(this.servantVo.servantInfoVoObj[e[a]]);return i},e.prototype.getServantInfoIdListWithSort=function(t){var e=this,i=this.servantVo.servantInfoVoObj,a=Object.keys(i);return 2==t&&a.sort(function(t,i){var a=e.servantVo.servantInfoVoObj[t],n=e.servantVo.servantInfoVoObj[i];return a.total==n.total?Number(i)-Number(t):Number(n.total)==Number(a.total)?Number(i)-Number(t):Number(n.total)-Number(a.total)}),4==t&&a.sort(function(t,i){var a=e.servantVo.servantInfoVoObj[t],n=e.servantVo.servantInfoVoObj[i],o=a.getTotalBookValue(),s=n.getTotalBookValue();return o==s?Number(i)-Number(t):s==o?Number(i)-Number(t):s-o}),3==t&&a.sort(function(t,i){var a=e.servantVo.servantInfoVoObj[t],n=e.servantVo.servantInfoVoObj[i];return a.level==n.level?Number(i)-Number(t):Number(n.level)==Number(a.level)?Number(i)-Number(t):Number(n.level)-Number(a.level)}),a},e.prototype.getServantInfoIdListByProperty=function(t){var e=this,i=this.servantVo.servantInfoVoObj,a=Object.keys(i);return a.sort(function(i,a){var n,o,s=e.servantVo.servantInfoVoObj[i],r=e.servantVo.servantInfoVoObj[a];switch(t){case 1:n=s.attrVo.forceTotal,o=r.attrVo.forceTotal;break;case 2:n=s.attrVo.brainsTotal,o=r.attrVo.brainsTotal;break;case 3:n=s.attrVo.politicsTotal,o=r.attrVo.politicsTotal;break;case 4:n=s.attrVo.charmTotal,o=r.attrVo.charmTotal}return n==o?Number(Number(a)-Number(i)):Number(o-n)}),a},e.prototype.getServantCombatWithId=function(t){var e=this.servantVo.servantInfoVoObj[t],i=e.attrVo.forceTotal+5e3*e.level*this.getServantForceTotalById(t);return i},e.prototype.getServantForceTotalById=function(t){for(var e=Config.ServantCfg.getServantItemById(t),i=e.ability,a=this.servantVo.servantInfoVoObj[t],n=GameConfig.config.abilityCfg,o=0,s=0;s<i.length;s++){var r=n[String(i[s])];1==r.type&&(o+=r.num*a.ability[s])}return o},e.prototype.getServantStarsNumWithId=function(t){for(var e=GameConfig.config.servantCfg[t],i=e.ability,a=0,n=0;n<i.length;n++){var o=GameConfig.config.abilityCfg[i[n]];a+=o.num}return a},e.prototype.getFullImgPathWithId=function(t){return"servant_full_"+t},e.prototype.getServantCountLevel60Plus=function(){var t=0,e=Config.AtkraceCfg.getServantLv();for(var i in this.servantVo.servantInfoVoObj){var a=this.servantVo.servantInfoVoObj[i];a.level>=e&&t++}return t},e.prototype.getServantCountLevel60PlusList=function(){var t=[],e=Config.AtkraceCfg.getServantLv(),i=this.getServantInfoIdListWithSort(2);for(var a in i){var n=this.servantVo.servantInfoVoObj[i[a]];n.level>=e&&t.push(i[a])}return t},e.prototype.checkRedPoint=function(){if(this.isShowRedForItem())return!0;for(var t in this.servantVo.servantInfoVoObj){var e=this.servantVo.servantInfoVoObj[t];if(e.isShowRedInServantList())return!0}return!1},e.prototype.isShowRedForItem=function(){for(var t=GameConfig.config.servantbaseCfg.attItem,e=0;e<t.length;e++){var i=t[e],a=Api.itemVoApi.getItemInfoVoById(i);if(a&&a.num>0)return!0}return!1},e.prototype.isOwnServantDailyBoss=function(){return this.getServantObj("1051")?!0:!1},e.prototype.dispose=function(){this.isShowAtkraceGuide=!1,this.isCheckGuide=!1,this.waitShowData=null,t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(ServantVoApi.prototype,"ServantVoApi");var ShopVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getVersion=function(){return String(this.shopVo.version)},e.prototype.getst=function(){return this.shopVo.st},e.prototype.getet=function(){return this.shopVo.et},e.prototype.getShopInfoListByType=function(t){var e=new Array,i=this.getVersion();return this.getet()<GameData.serverTime&&(i="0"),e=Config.ShopCfg.getShopItemCfgListByType(t,i)},e.prototype.getShopInfoVoById=function(t){if(this.shopVo){var e=this.shopVo.shopInfoVoObj;if(e&&e[t.toString()])return e[t.toString()]}return null},e.prototype.getShopItemCfgById=function(t){var e=this.getVersion();return Number(e)>0&&this.getet()<GameData.serverTime&&(e="0"),Config.ShopCfg.getShopItemCfgById(t,e)},e.prototype.getCanBuyNumById=function(t){var e=this.getShopItemCfgById(t);if(e.limitNum>0){var i=this.shopVo.shopInfoVoObj;if(i&&i[t.toString()]){var a=e.limitNum-i[t.toString()].buyNum;return 0>a?0:a}}return e.limitNum},e.prototype.getNewShopBuyNumById=function(t){var e=0;return this.shopVo&&this.shopVo.hinfo&&this.shopVo.hinfo[t]&&(e=this.shopVo.hinfo[t]),e
},e.prototype.checkIfNeedRequest=function(){return this.shopVo.lastUpdateTime>0?!0:!1},e.prototype.getPayFlag=function(){return this.shopVo?this.shopVo.payflag:0},e.prototype.getPayInfoById=function(t){return Boolean(this.shopVo&&this.shopVo.pay?this.shopVo.pay[t]:0)},e.prototype.getPayInfoById2=function(t){return this.shopVo.pay[t]},e.prototype.getPayInfo1=function(){return Boolean(this.shopVo&&this.shopVo.pay&&this.shopVo.pay.g9&&this.shopVo.pay.g9.isbuy?this.shopVo.pay.g9.isbuy:0)},e.prototype.getPayInfo2=function(){return Boolean(this.shopVo&&this.shopVo.pay&&this.shopVo.pay.g10&&this.shopVo.pay.g10.isbuy?this.shopVo.pay.g10.isbuy:0)},e.prototype.getPayInfo1Time=function(){var t=Api.shopVoApi.getPayInfoById2("g9"),e=Config.RechargeCfg.getRechargeItemCfgByKey("g9"),i=t.st+e.lastTime-GameData.serverTime;return i},e.prototype.ifBuyYearCard=function(){return this.shopVo.yearcard&&this.shopVo.yearcard.et>GameData.serverTime?!0:!1},e.prototype.ifBuyMonthCard=function(){return this.shopVo.monthcard&&this.shopVo.monthcard.et>GameData.serverTime?!0:!1},e.prototype.getVipRewardInfo=function(t){return this.shopVo?this.shopVo.vipInfo[t]:!1},e.prototype.getMonthcardet=function(){return this.shopVo.monthcard.et},e.prototype.getInterday=function(){return this.shopVo&&this.shopVo.hinfo?0==Object.keys(this.shopVo.hinfo).length?!0:!1:void 0},e.prototype.getfourRateCharge=function(){return null==this.shopVo.fourRateCharge?!0:!1},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(ShopVoApi.prototype,"ShopVoApi");var StudyatkVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getStudyAtkList=function(){return this.studyatkVo.atkList},e.prototype.getStudyAtkInfoByIdx=function(t){return this.studyatkVo.atkList[t]},e.prototype.getStudySkillInfoTotalExp=function(){return this.studyatkVo.skillinfo.total},e.prototype.getStudySkillInfoLv=function(){return this.studyatkVo.skillinfo.level},e.prototype.getStudyatkFinishinfo=function(){return this.studyatkVo.finishinfo},e.prototype.getStudyatkFinishRet=function(){return this.studyatkVo.finishinfo.ret},e.prototype.getJoinId=function(){return this.studyatkVo.join_uid},e.prototype.getNextPkTime=function(t){var e=this.studyatkVo.atkinfo;for(var i in e)if(3==e[i].dtype){var a=e[i].st+GameConfig.config.studyatkbaseCfg.interval;if(e[i].name1==Api.playerVoApi.getPlayerName()&&e[i].name2&&a>=GameData.serverTime)return a}return 0},e.prototype.getNextJoinTime=function(){var t=this.studyatkVo.atkinfo;for(var e in t)if(3==t[e].dtype){var i=t[e].st+GameConfig.config.studyatkbaseCfg.interval;if(t[e].name2==Api.playerVoApi.getPlayerName()&&i>=GameData.serverTime)return i}return 0},e.prototype.isShowNpc=function(){var t=!1;return t=Api.playerVoApi.getPlayerLevel()>=GameConfig.config.studyatkbaseCfg.needLv?!0:!1},e.prototype.getLockedString=function(){return LanguageManager.getlocal("studyatkLvelUnlockDesc",[Api.playerVoApi.getPlayerOfficeByLevel(GameConfig.config.studyatkbaseCfg.needLv)])},e.prototype.openMainView=function(){var t=GameConfig.config.studyatkbaseCfg,e=Api.playerVoApi.getPlayerID(),i=this.studyatkVo.create_time+t.lastTime;this.studyatkVo.join_uid>0&&(i=this.studyatkVo.join_st+t.lastTime,e=this.studyatkVo.join_uid),i>GameData.serverTime?ViewController.getInstance().openView(ViewConst.COMMON.STUDYATKDETAILVIEW,{uid:e}):ViewController.getInstance().openView(ViewConst.COMMON.STUDYATKVIEW)},e.prototype.checkNpcMessage=function(){var t=this.getStudySkillInfoTotalExp(),e=Config.StudyatkCfg.getStudyatkCfgById(Math.min(Config.StudyatkCfg.getMaxLevel(),Number(this.getStudySkillInfoLv())+1));return t<e.needExp?!1:!0},e.prototype.getNextEnterTime=function(){var t=GameConfig.config.studyatkbaseCfg.interval;return this.studyatkVo.goout_time+t},e}(BaseVoApi);__reflect(StudyatkVoApi.prototype,"StudyatkVoApi");var SwitchVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.checkSwitchByName=function(t){return Boolean(this.switchVo&&this.switchVo.switchList[t])},e.prototype.checkAudlt=function(){return this.checkSwitchByName("funAdult")},e.prototype.checkPunishAllianceRank=function(){return this.checkSwitchByName("closePunish")},e.prototype.checkPunishVip=function(){return this.checkSwitchByName("openPunishVip")},e.prototype.checkWifeAni=function(){return this.checkSwitchByName("closeWifeAni")},e.prototype.checkCloseText=function(){return this.checkSwitchByName("closeText")},e.prototype.checkAutoResManage=function(){return this.checkSwitchByName("funAutoResManage")},e.prototype.checkOpenShenhe=function(){return this.checkSwitchByName("openShenhe")},e.prototype.checkTWShenhe=function(){return this.checkSwitchByName("twShenhe")},e.prototype.checkOpenTalkDialog=function(){return this.checkSwitchByName("openTalkDialog")},e.prototype.checkJumpBattle=function(){return this.checkSwitchByName("openJumpBattle")},e.prototype.checkAutoMopup=function(){return this.checkSwitchByName("openAutoMopup")},e.prototype.checkVip1Privilege=function(){return!0},e.prototype.checkOpenNewCharge=function(){return this.checkSwitchByName("openNewCharge")},e.prototype.checkSpecialChargeReward=function(){return this.checkSwitchByName("openSpecialChargeReward")},e.prototype.checkOpenWifeAbTest=function(){return this.checkSwitchByName("openWifeAbTest")},e.prototype.checkOpenNewPrison=function(){return this.checkSwitchByName("openNewPrison")},e.prototype.checkOpenInvite=function(){return this.checkSwitchByName("openInvite")},e.prototype.checknewRecharge=function(){return this.checkSwitchByName("newRecharge")},e.prototype.checkopenQQqun=function(){return this.checkSwitchByName("openQQqun")},e.prototype.checkCloseBone=function(){return this.checkSwitchByName("closeBone")},e.prototype.checkCloseDinnerNewFunc=function(){return this.checkSwitchByName("closeDinnerNewFunc")},e.prototype.checkOpen3kQianYi=function(){return this.checkSwitchByName("open3kqianyi")},e.prototype.checkOpenWifeVideo=function(){return this.checkSwitchByName("openWifeVideo")},e.prototype.isCrossOpen=function(){return this.checkSwitchByName("openCrossPalace")},e.prototype.checkOpenPrestige=function(){return this.checkSwitchByName("openPrestige")},e.prototype.checkClosePay=function(){return PlatformManager.checkIsIOSShenheSp()&&17001213==Number(PlatformManager.getAppid())?!0:!1},e.prototype.checkAutoLoadDefaultRes=function(){return this.checkSwitchByName("autoloadres")},e.prototype.checkOpenCover=function(){return this.checkSwitchByName("openCover")},e.prototype.checkOpenRechargeRebate=function(){return this.checkSwitchByName("openRechargeRebate")},e.prototype.checkOpenCertification=function(){return this.checkSwitchByName("openCertification")},e.prototype.checkOpenFbBind=function(){return this.checkSwitchByName("openFbBind")},e.prototype.isPracticeOPen=function(){return this.checkSwitchByName("openPractice")},e.prototype.checkOpenWifeStatus=function(){return this.checkSwitchByName("openPunishVip")},e}(BaseVoApi);__reflect(SwitchVoApi.prototype,"SwitchVoApi");var MainTaskVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getCurMainTaskId=function(){return this.mainTaskVo.taskId},e.prototype.getCurMainTaskValue=function(){return this.mainTaskVo.value},e.prototype.getCurTaskNameAndDescTxt=function(){var t=this.getCurMainTaskId(),e=Config.MaintaskCfg.getTaskCfgByTaskId(t),i=e.questType,a=[],n=void 0,o=void 0;if(201==i){var s=LanguageManager.getlocal("servant_name"+e.need);n=LanguageManager.getlocal("taskName"+i,[s]),o=LanguageManager.getlocal("taskTxt")+LanguageManager.getlocal("taskDesc"+i,[s,String(e.value)])}else if(105==i)o=LanguageManager.getlocal("taskTxt")+LanguageManager.getlocal("taskDesc"+i,[LanguageManager.getlocal("officialTitle"+e.value)]),n=LanguageManager.getlocal("taskName"+i);else if(202==i)o=LanguageManager.getlocal("taskTxt")+LanguageManager.getlocal("taskDesc"+i,[String(e.need),String(e.value)]),n=LanguageManager.getlocal("taskName"+i);else if(206==i){var r=LanguageManager.getlocal("servant_clvStr"+e.value);o=LanguageManager.getlocal("taskTxt")+LanguageManager.getlocal("taskDesc"+i,[String(e.need),r]),n=LanguageManager.getlocal("taskName"+i)}else if(106==i){var l=Math.floor(e.value/41)+1,h=LanguageManager.getlocal("challengeTitle"+l);o=LanguageManager.getlocal("taskTxt")+LanguageManager.getlocal("taskDesc"+i,[String(e.value)]),n=LanguageManager.getlocal("taskName"+i,[h])}else o=LanguageManager.getlocal("taskTxt")+LanguageManager.getlocal("taskDesc"+i,[String(e.value)]),n=LanguageManager.getlocal("taskName"+i);return a.push(n),a.push(o),a},e.prototype.isCurTaskReach=function(){var t=this.getCurMainTaskId(),e=Config.MaintaskCfg.getTaskCfgByTaskId(t);return this.getCurMainTaskValue()>=e.value?!0:!1},e}(BaseVoApi);__reflect(MainTaskVoApi.prototype,"MainTaskVoApi");var TradeVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getCurrentCid=function(){return this.tradeVo.cid},e.prototype.getCurrentRewards=function(){return this.tradeVo.rewards},e.prototype.getCurrentTradeCfg=function(){return Config.TradeCfg.getMaxTradeIndex()+1==Number(this.getCurrentCid())?null:Config.TradeCfg.getTradeCfgById(this.getCurrentCid())},e.prototype.isBatchEnable=function(){return this.tradeVo.batchFlag>0},e.prototype.getAttNum=function(t){for(var e=0,i=Api.playerVoApi.getPlayerGold(),a=t;200>=a;a++){var n=Config.TradeCfg.getTradeCfgById(a+"");if(!n)break;var o=this.getBattleResult(Api.playerVoApi.getInte(),i,n.tradeInte,n.tradeGold);o.success&&e++,i-=o.cost}return e},e.prototype.getBattleResult=function(t,e,i,a){var n=Math.ceil(e-a*(i+1e3)/(t+1e3)),o=Math.ceil(a-e*(t+1e3)/(i+1e3)),s=Math.floor(a*(i+1e3)/(t+1e3)),r=!1;n>0?(o=0,r=!0):0==n&&0==o?(n=0,o=1):n=0;var l={success:r,left1:n,left2:o,cost:s};return l},e.prototype.getAttCostNum=function(t,e){for(var i=0,a=Api.playerVoApi.getPlayerGold(),n=t;t+e>n;n++){var o=Config.TradeCfg.getTradeCfgById(n+"");if(!o)break;var s=this.getBattleResult(Api.playerVoApi.getInte(),a,o.tradeInte,o.tradeGold);s.success&&(i+=s.cost),a-=s.cost}return i},e.prototype.getLockedString=function(){return LanguageManager.getlocal("reachLvelUnlockDesc",[Api.playerVoApi.getPlayerOfficeByLevel(GameConfig.config.tradebaseCfg.unlock)])},e.prototype.isShowNpc=function(){return Api.playerVoApi.getPlayerLevel()>=GameConfig.config.tradebaseCfg.unlock?!0:!1},e}(BaseVoApi);__reflect(TradeVoApi.prototype,"TradeVoApi");var VipVoApi=function(t){function e(){var e=t.call(this)||this;return e.noRewardArr=[],e}return __extends(e,t),e.prototype.checkMaxVipLevel=function(){return Api.playerVoApi.getPlayerVipLevel()>=Config.VipCfg.getMaxLevel()},e.prototype.getNextVipLvNeedRechargeGemNum=function(){var t=0,e=Api.playerVoApi.getPlayerVipExp(),i=Api.playerVoApi.getPlayerVipLevel()+1;if(i=Math.min(Config.VipCfg.getMaxLevel(),i),Api.acVoApi.getActivityVoByAidAndCode("discount","1")&&Api.acVoApi.getActivityVoByAidAndCode("discount","1").isStart){var a=Config.AcCfg.getCfgByActivityIdAndCode("discount",1).vipList[i];a&&(t=a.needGem-e)}else{var a=Config.VipCfg.getVipCfgByLevel(i);a&&(t=a.needGem-e)}return Math.max(0,t)},e.prototype.getNextVipNeedGemNum=function(){var t=0,e=Api.playerVoApi.getPlayerVipLevel()+1;if(e=Math.min(Config.VipCfg.getMaxLevel(),e),Api.acVoApi.getActivityVoByAidAndCode("discount","1")&&Api.acVoApi.getActivityVoByAidAndCode("discount","1").isStart){var i=Config.AcCfg.getCfgByActivityIdAndCode("discount",1).vipList[e];i&&(t=i.needGem)}else{var i=Config.VipCfg.getVipCfgByLevel(e);i&&(t=i.needGem)}return t},e.prototype.getCurLevelVipCfg=function(){return this.getVipCfgByLevel(Api.playerVoApi.getPlayerVipLevel())},e.prototype.getVipCfgByLevel=function(t){return Config.VipCfg.getVipCfgByLevel(t)},e.prototype.getCanRewardLevelList=function(){for(var t=[],e=Api.playerVoApi.getPlayerVipLevel(),i=0;e>=i;i++){var a=Config.VipCfg.getVipCfgByLevel(i).extraRewardVoList;!Api.shopVoApi.getVipRewardInfo(i)&&a&&a.length>0&&t.push(i)}return t},e.prototype.getShowVipLevel=function(){var t=this.getCanRewardLevelList();return t.length>0?Math.max(0,t[0]):Api.playerVoApi.getPlayerVipLevel()+1},e.prototype.getDailyLuckNum=function(){return this.getCurLevelVipCfg().dailyLuckNum},e.prototype.checkRedPoint=function(){return this.getReddot()},e.prototype.getReddot=function(){for(var t=Api.playerVoApi.getPlayerVipLevel(),e=0;t>=e;e++)if(Api.vipVoApi.getVipCfgByLevel(e).reward){var i=Api.switchVoApi.checkVip1Privilege();if(0==i&&1==e)continue;if(!Api.shopVoApi.getVipRewardInfo(e))return t>=e?!0:!1}},e.prototype.getNoRewardBoo=function(t){return Api.vipVoApi.getVipCfgByLevel(t).reward?!1:!0},e.prototype.getMaxbtnNum=function(){var t=Config.VipCfg.getMaxLevel();if(GameData.limitVipLv&&GameData.limitVipLv.length>0)for(var e=GameData.limitVipLv.length,i=0;e>i;i++)if(Api.playerVoApi.getPlayerVipLevel()<GameData.limitVipLv[i]){t=GameData.limitVipLv[i];break}return t},e}(BaseVoApi);__reflect(VipVoApi.prototype,"VipVoApi");var WifeskinVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getWifeNum=function(){var t=this.wifeskinVo.wifeSkinInfoVoObj;return Object.keys(t).length},e.prototype.getWifeSkinListById=function(t){var e=new Array,i=Config.WifeskinCfg.getWifeCfgList();for(var a in i){var n=i[a];t==n.wifeId&&e.push(n)}return e},e.prototype.isHaveSkin=function(t){var e=Config.WifeskinCfg.getWifeCfgList();for(var i in e){var a=e[i];if(t==a.wifeId)return!0}return!1},e.prototype.getWifeInfoVoList=function(){var t=new Array,e=this.wifeskinVo.wifeSkinInfoVoObj;for(var i in e)t.push(e[i]);return t},e.prototype.isShowNpc=function(){return Api.playerVoApi.getPlayerLevel()>=Config.WifebaseCfg.unlockLv},e.prototype.getWifeskinInfoVoById=function(t){var e=this.wifeskinVo.wifeSkinInfoVoObj;return e&&e[t.toString()]?e[t.toString()]:null},e.prototype.getWifeSkinIndexVoById=function(t){for(var e=Config.WifeskinCfg.getWifeCfgById(t).wifeId,i=this.getWifeSkinListById(e),a=0;a<i.length;a++)if(t==i[a].id)return a;return 0},e.prototype.getSkinRedAll=function(){for(var t=this.getWifeInfoVoList(),e=0;e<t.length;e++){var i=t[e];if(i)for(var a in i.skin)if(1==i.skin[a].red)return!0}return!1},e.prototype.getSkinRed=function(t){var e=Api.wifeSkinVoApi.getWifeskinInfoVoById(t);if(e)for(var i in e.skin)if(1==e.skin[i].red)return!0;return!1},e.prototype.getSkinOneRed=function(t,e){var i=Api.wifeSkinVoApi.getWifeskinInfoVoById(t);return i&&i.skin[e]&&1==i.skin[e].red?!0:!1},e.prototype.isOwnSkinOfSkinId=function(t){var e=Config.WifeskinCfg.getWifeCfgById(t).wifeId;return this.wifeskinVo.wifeSkinInfoVoObj[e]&&this.wifeskinVo.wifeSkinInfoVoObj[e].skin[t]?!0:!1},e.prototype.getLockedString=function(){return LanguageManager.getlocal("reachLvelUnlockDesc",[Api.playerVoApi.getPlayerOfficeByLevel(Config.WifebaseCfg.unlockLv)])},e}(BaseVoApi);__reflect(WifeskinVoApi.prototype,"WifeskinVoApi");var WifeVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.checkNpcMessage=function(){return this.getEnergyNum()>0?!0:!1},e.prototype.setWaitShowWife=function(t){this.waitShowWife=t},e.prototype.getWaitShowWife=function(){var t=this.waitShowWife;return this.waitShowWife=null,t},e.prototype.getWifes=function(){var t=this.wifeVo.wifeInfoVoObj;return Object.keys(t)},e.prototype.getWifeNum=function(){var t=this.wifeVo.wifeInfoVoObj;return Object.keys(t).length},e.prototype.getChildrenNum=function(){var t=0;for(var e in this.wifeVo.wifeInfoVoObj)t+=this.wifeVo.wifeInfoVoObj[e].child;return t},e.prototype.getWifeInfoVoList=function(){var t=new Array,e=this.wifeVo.wifeInfoVoObj;for(var i in e)t.push(e[i]);return t},e.prototype.getUnlockWifeInfoVoList=function(){var t=new Array,e=Config.WifeCfg.getWifeCfgList();for(var i in e)if(null==this.getWifeInfoVoById(Number(i))){var a=e[i];if(a.unlock&&a.unlock.needVip){var n=a.unlock.needVip,o=Api.vipVoApi.getMaxbtnNum();o>=n&&t.push(a)}else t.push(a)}return t.sort(function(t,e){return t.sortId-e.sortId}),t},e.prototype.isShowNpc=function(){return this.getWifeNum()<=0?!1:!0},e.prototype.isHaveBone=function(t){if(PlatformManager.checkIsKRSp()){var e={wife_full_310_ske:1};if(!e[t])return!1}return RES.hasRes(t)&&App.DeviceUtil.CheckWebglRenderMode()&&!Api.switchVoApi.checkCloseBone()?!0:!1},e.prototype.getWifeInfoVoById=function(t){var e=this.wifeVo.wifeInfoVoObj;return e&&e[t.toString()]?e[t.toString()]:null},e.prototype.getWifeIndexVoById=function(t){for(var e=this.getWifeInfoVoList(),i=0;i<e.length;i++)if(t==e[i].id)return i;return 0},e.prototype.getEnergyNum=function(){var t=this.wifeVo.energy_num,e=this.getEnergyMaxNum(),i=GameData.serverTime,a=GameConfig.config.wifebaseCfg.needTime;if(t>=e)t=e;else{var n=Math.floor((i-this.wifeVo.energy_st)/a);t+n>=e?t=e:t+=n}return t},e.prototype.getEnergyMaxNum=function(){var t=GameConfig.config.vipCfg[Api.playerVoApi.getPlayerVipLevel()].maxEnergy;return t},e.prototype.getRecoverEnergyTime=function(){var t=0,e=GameConfig.config.wifebaseCfg.needTime,i=this.wifeVo.energy_st;return i+e>GameData.serverTime&&(t=i+e-GameData.serverTime),t},e.prototype.getLoveNeedGem=function(t){var e=10*t;return e>1e3&&(e=1e3),e},e.prototype.getGiveRed=function(){for(var t=Config.WifebaseCfg.wifeGift,e=1;5>e;e++){var i=e.toString(),a=Api.itemVoApi.getItemNumInfoVoById(Number(t[i].item));if(a>0)return!0}return!1},e.prototype.getSkillRed=function(t){for(var e=Api.wifeVoApi.getWifeInfoVoById(t),i=e.cfg.wifeSkill,a=0;a<i.length;a++){var n=i[a];if(n.condition<=e.intimacy){var o=Config.WifebaseCfg["wifeSkill"+(a+1)][e.skill[a]-1],s=e.exp;if(s>=o)return!0}}return!1},e.prototype.getWifeIcon=function(t){var e=Config.WifeCfg.getWifeCfgById(t),i=e.icon;if(Api.wifeSkinVoApi.isHaveSkin(t)){var a=Api.wifeSkinVoApi.getWifeskinInfoVoById(t);if(a&&""!=a.equip){var n=Config.WifeskinCfg.getWifeCfgById(a.equip);i=n.icon}}return i},e.prototype.getLockedString=function(){return LanguageManager.getlocal("reachLvelUnlockDesc",[Api.playerVoApi.getPlayerOfficeByLevel(Config.WifebaseCfg.unlockLv)])},e}(BaseVoApi);__reflect(WifeVoApi.prototype,"WifeVoApi");var WifestatusVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getWifestatusVo=function(){return this.wifestatusVo},e.prototype.getWifestatusVoList=function(){var t=new Array,e=this.wifestatusVo.info;for(var i in e)t.push(e[i]);return t},e.prototype.getWifestatusLevelById=function(){return"1"},e.prototype.getWifesNumByLevel=function(t){var e=Api.wifestatusVoApi.getWifestatusVo();return e.info[t]&&e.info[t].length?e.info[t].length:0},e.prototype.getNoStatusWife=function(){var t=Api.wifeVoApi.getWifes(),e=Api.wifestatusVoApi.getWifestatusVo();new Array;for(var i in e.info)if(e.info.hasOwnProperty(i))for(var a=e.info[i],n=0;n<t.length;n++)for(var o=0;o<a.length;o++)t[n]==a[o]&&t.splice(n,1);return t},e.prototype.getStatusWifes=function(t){for(var e=new Array,i=Api.wifeVoApi.getWifeInfoVoList(),a=0;a<i.length;a++){var n=i[a];e.push(n.id)}return e},e.prototype.getWifestatusVoById=function(t){var e=this.wifestatusVo.info;return e&&e[t.toString()]?e[t.toString()]:null},e.prototype.getWifeIndexVoById=function(t){for(var e=Config.WifestatusCfg.getWifestatusList(),i=0;i<e.length;i++)if(t==e[i].id)return i;return 0},e.prototype.getGiveRed=function(){for(var t=Config.WifebaseCfg.wifeGift,e=1;5>e;e++){var i=e.toString(),a=Api.itemVoApi.getItemNumInfoVoById(Number(t[i].item));if(a>0)return!0}return!1},e.prototype.getSkillRed=function(t){return!1},e}(BaseVoApi);__reflect(WifestatusVoApi.prototype,"WifestatusVoApi");var Dictionary=function(){function t(){this._keys=[],this._values=[]}return t.prototype.set=function(t,e){var i=this._keys.indexOf(t,0);-1!=i?(this._keys[i]=t,this._values[i]=e):(this._keys.push(t),this._values.push(e))},t.prototype.remove=function(t){var e=this._keys.indexOf(t,0);this._keys.splice(e,1),this._values.splice(e,1)},t.prototype.testLog=function(){App.LogUtil.log("key length ======="+this._keys.length),App.LogUtil.log("_values length ======"+this._values.length);for(var t=0;t<this._keys.length;t++)App.LogUtil.log("key ="+this._keys[t]);for(var t=0;t<this._values.length;t++)App.LogUtil.log("value ="+this._values[t]);App.LogUtil.log("=================end=====================")},t.prototype.length=function(){return this._keys.length},t.prototype.has=function(t){for(var e=this._keys,i=0;i<e.length;++i)if(e[i]==t)return!0;return!1},t.prototype.dispose=function(){this._keys.length=0,this._values.length=0},t.prototype.get=function(t){for(var e=this._keys,i=0;i<e.length;++i)if(e[i]==t)return!0;return!1},t.prototype.getKeys=function(){return this._keys},t.prototype.getValues=function(){return this._values},t}();__reflect(Dictionary.prototype,"Dictionary");var GameConfig;!function(t){function e(){var e=!0;e?ResourceManager.loadItem(s(),i,t):ResourceManager.loadGroup("config",function(){t.isLoaded=!0,App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_GAMECONFIG_LOADED)},i,t)}function i(e){if(e instanceof RES.ResourceEvent){var i=e.resItem.name,a=i.substr(0,i.length-3)+App.StringUtil.firstCharToUper(i.substr(i.length-3)),n=ResourceManager.getRes(i);h[a]=n;var o=App.StringUtil.firstCharToUper(a);Config[o]&&Config[o].formatData&&Config[o].formatData(h[a])}else if("object"==typeof e){for(var i in e){var s=i.substr(0,i.length-3)+App.StringUtil.firstCharToUper(i.substr(i.length-3));h[s]=e[i];var o=App.StringUtil.firstCharToUper(s);Config[o]&&Config[o].formatData&&Config[o].formatData(h[s])}t.isLoaded=!0,App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_GAMECONFIG_LOADED)}}function a(t,e){for(var i in t){var a=i.substr(0,i.length-3)+App.StringUtil.firstCharToUper(i.substr(i.length-3));e?(r.old||(r.old={}),r.old[a]=h[a]):(r["new"]||(r["new"]={}),r["new"][a]=h[a]),h[a]=t[i];var n=App.StringUtil.firstCharToUper(a);Config[n]&&Config[n].formatData&&Config[n].formatData(h[a])}l=e}function n(e){var i=s()+"_new";return RES.hasRes(i)?ResourceManager.loadItem(i,function(i){a(i,!0),t.isNewDiffCfgLoaded=!0,e&&e()},t):void(e&&e())}function o(t,e,i,o){if(l==!t)if(t){if(!r["new"])return n(function(){e.apply(i,o)});if(a(r["new"],!0),e)return e.apply(i,o)}else if(r.old&&(a(r.old,!1),e))return e.apply(i,o);return e.apply(i,o)}function s(){var t;return t=RES.hasRes("gameconfig_"+PlatformManager.getSpid())?"gameconfig_"+PlatformManager.getSpid():"gameconfig_cn"}t.stageWidth=0/0,t.stageHeigth=0/0,t.stage=null,t.isLoaded=!1,t.refreshUIResArr=["gold","food","soldier","gem","level","power","exp"],t.platCfg={},t.serverCfg={},t.rookieCfg={};var r={},l=!1;t.isNewDiffCfgLoaded=!1;var h;!function(t){t.searchbaseCfg={},t.abilityCfg={},t.abilitybaseCfg={},t.challengeCfg={},t.initCfg={},t.interfaceCfg={},t.itemCfg={},t.modelCfg={},t.servantbaseCfg={},t.servantCfg={},t.shopCfg={},t.vipCfg={},t.wifebaseCfg={},t.wifeCfg={},t.affairCfg={},t.childCfg={},t.childbaseCfg={},t.challengestoryCfg={},t.titleCfg={},t.adultCfg={},t.alliancebaseCfg={},t.allianceCfg={},t.bookroomCfg={},t.studyatkbaseCfg={},t.prisonbaseCfg={},t.limitedrewardbaseCfg={},t.conquestCfg={},t.tradebaseCfg={},t.wifeskinCfg={},t.invitefriendCfg={},t.shopnewCfg={},t.buildingCfg={},t.practicebaseCfg={},t.wifestatusCfg={},t.wifestatusbaseCfg={},t.sceneCfg={}}(h=t.config||(t.config={})),t.loadConfig=e,t.switchNewOrOldCfg=o}(GameConfig||(GameConfig={}));var PlatCfg=function(){function t(){}return t.initCfg=function(e,i){var a=PlatformManager.getAppid(),n=PlatformManager.getSpName(),o=PlatformManager.getBigAppid();console.log("sub middle big",a,n,o);var s=function(n){t.loginLogo=n.loginLogo,t.loginBg=n.loginBg;var s="loginbg_"+a;RES.hasRes(s)?t.loginBg=s:(s="loginbg_"+o,RES.hasRes(s)&&(t.loginBg=s)),e.call(i)};""!==a&&RES.hasRes("sub"+a+"_json")?ResourceManager.loadItem("sub"+a+"_json",s,this):""!==n&&RES.hasRes("middle"+n+"_json")?ResourceManager.loadItem("middle"+n+"_json",s,this):""!==o&&RES.hasRes("big"+o+"_json")?ResourceManager.loadItem("big"+o+"_json",s,this):ResourceManager.loadItem("big0_json",s,this)},t}();__reflect(PlatCfg.prototype,"PlatCfg");var RookieCfg;!function(t){function e(t){return i[t]}var i={storyEndId:"26",storyEndId2:"14",storyStartId2:"15",guideStartId:"101",storyMusicStart:"4",storyMusicEnd:"11",guideSteps:64,fogId:"1",shakeId:"4",1:{guideId:4,nextId:"2",descId:1,bgId:9,nameId:"storyNPCName30",clickContinue:!0},2:{guideId:5,nextId:"3",descId:2,bgId:9,clickContinue:!0},3:{guideId:6,nextId:"4",descId:3,bgId:9,clickContinue:!0},4:{guideId:7,nextId:"5",descId:4,bgId:2,clickContinue:!0},5:{guideId:8,nextId:"6",descId:5,bgId:2,clickContinue:!0},6:{guideId:9,nextId:"7",descId:6,bgId:2,personPic:999,nameId:"storyNPCName1",clickContinue:!0},7:{guideId:10,bgId:2,branch:{1:"8",2:"8"},clickContinue:!1,nextId:"8"},8:{guideId:11,nextId:"9",descId:8,bgId:2,clickContinue:!0},9:{guideId:12,nextId:"10",descId:9,bgId:1,personPic:999,nameId:"storyNPCName1",clickContinue:!0},10:{guideId:13,nextId:"11",descId:10,bgId:1,personPic:"wife_full_101",nameId:"wifeName_101",clickContinue:!0},11:{guideId:14,nextId:"12",descId:11,bgId:4,clickContinue:!0},12:{guideId:15,nextId:"13",descId:12,bgId:5,clickContinue:!0},13:{guideId:16,nextId:"14",descId:13,bgId:7,clickContinue:!0},14:{guideId:17,nextId:"14_1",descId:14,bgId:7,clickContinue:!0,isCallback:!0},"14_1":{guideId:18,nextId:"14_2",clickRect:{x:490,y:370,w:130,h:270,fromBottom:670},handPos:{x:535,y:500,fromBottom:558},isScenePos:"homeScene",sceneKey:"wife"},"14_2":{guideId:19,nextId:"14_3",clickRect:{x:170,y:692,w:145,h:40},tipId:"wife_2",tipPos:{x:130,y:460},touchAll:!0},"14_3":{guideId:20,nextId:"14_4",clickRect:{x:330,y:692,w:145,h:40},tipId:"wife_3",tipPos:{x:130,y:460},touchAll:!0},"14_4":{guideId:21,nextId:null,clickRect:{x:420,y:318,w:170,h:70,fromBottom:73},handPos:{x:520,y:500,fromBottom:35,flipXY:!0},tipId:"wife_4",tipPos:{x:130,y:660},waitNext:"14_5"},"14_5":{guideId:22,nextId:"15",clickRect:{x:565,y:12,w:75,h:100},handPos:{x:612,y:52,flip:!0},checkNpc:"manage"},15:{guideId:23,nextId:"16",descId:15,bgId:6,clickContinue:!0},16:{guideId:24,nextId:"17",descId:16,bgId:6,personPic:"servant_full_1001",nameId:"servant_name1001",clickContinue:!0},17:{guideId:25,nextId:"18",descId:17,bgId:6,personPic:1,nameId:"storyNPCName1",clickContinue:!0},18:{guideId:26,nextId:"19",descId:18,bgId:6,personPic:"servant_full_1001",nameId:"servant_name1001",clickContinue:!0},19:{guideId:27,nextId:"20",descId:19,bgId:6,clickContinue:!0},20:{guideId:28,nextId:"21",descId:20,bgId:6,clickContinue:!0},21:{guideId:29,nextId:"22",descId:21,bgId:6,personPic:"servant_full_1002",nameId:"servant_name1002",clickContinue:!0},22:{guideId:30,nextId:"23",descId:22,bgId:6,personPic:"servant_full_1003",nameId:"servant_name1003",clickContinue:!0},23:{guideId:31,nextId:"24",descId:23,bgId:6,personPic:"servant_full_1004",nameId:"servant_name1004",clickContinue:!0},24:{guideId:32,nextId:"25",descId:24,bgId:6,personPic:"servant_full_1005",nameId:"servant_name1005",clickContinue:!0},25:{guideId:33,nextId:"26",descId:25,bgId:6,personPic:1,nameId:"storyNPCName1",clickContinue:!0},26:{guideId:34,nextId:"101",descId:26,bgId:6,clickContinue:!0,waitNext:101},101:{guideId:35,nextId:"102",descId:101,bgId:6,personPic:"servant_full_1001",nameId:"servant_name1001",clickContinue:!0,resEndId:"105"},102:{guideId:36,nextId:"103",clickRect:{x:290,y:370,w:190,h:350,fromBottom:550},handPos:{x:370,y:400,fromBottom:400},isScenePos:"homeScene",sceneKey:"manage"},103:{guideId:37,nextId:"104",clickRect:{x:60,y:423,w:250,h:290,fromBottom:690},handPos:{x:180,y:580,fromBottom:540},tipId:"103",tipPos:{x:160,y:600,fromBottom:340}},104:{guideId:38,nextId:"105",clickRect:{x:360,y:193,w:250,h:290,fromBottom:800},handPos:{x:450,y:355,fromBottom:670},tipId:"104",tipPos:{x:150,y:510,fromBottom:450}},105:{guideId:39,nextId:"106_1",clickRect:{x:355,y:653,w:240,h:320,fromBottom:440},handPos:{x:520,y:810,fromBottom:300},tipId:"105",tipPos:{x:130,y:450,fromBottom:540}},"106_1":{guideId:40,nextId:"106",clickRect:{x:565,y:12,w:75,h:100},handPos:{x:617,y:45,flip:!0}},106:{guideId:41,nextId:"107",descId:106,bgId:6,personPic:"servant_full_1001",nameId:"servant_name1001",clickContinue:!0,resEndId:"109"},107:{guideId:42,nextId:"108",clickRect:{x:165,y:850,w:100,h:100,fromBottom:107},handPos:{x:198,y:880,fromBottom:73}},108:{guideId:43,nextId:"108_1",clickRect:{x:10,y:167,w:200,h:190},handPos:{x:97,y:260}},"108_1":{guideId:44,nextId:"108_2",clickRect:{x:14,y:550,w:420,h:90},tipId:"1081",tipPos:{x:130,y:360},touchAll:!0},"108_2":{guideId:45,nextId:"108_3",clickRect:{x:20,y:795,w:600,h:85},tipId:"1082",tipPos:{x:130,y:600},touchAll:!0,needLocalPos:!0},"108_3":{guideId:46,nextId:"109",clickRect:{x:60,y:490,w:510,h:240,fromCenter:.5},tipId:"1083",tipPos:{x:130,y:320},touchAll:!0,needPush:!0},109:{guideId:47,nextId:null,clickRect:{x:470,y:600,w:165,h:70},handPos:{x:540,y:620},tipId:"109",tipPos:{x:130,y:450},waitNext:111,needPush:!0,showCloseHand:!0},111:{guideId:48,nextId:"112",descId:111,bgId:6,personPic:"servant_full_1001",nameId:"servant_name1001",clickContinue:!0,resEndId:"120"},112:{guideId:49,nextId:"113",clickRect:{x:10,y:850,w:140,h:100,fromBottom:107},handPos:{x:70,y:890,fromBottom:70}},113:{guideId:50,nextId:"114",clickRect:{x:190,y:580,w:220,h:160},handPos:{x:285,y:660}},114:{guideId:51,nextId:"115",clickRect:{x:169,y:645,w:110,h:110,fromCenter:.5},handPos:{x:210,y:695,fromCenter:.5}},115:{guideId:52,nextId:"116",descId:115,bgId:5,clickContinue:!0,resEndId:"120"},116:{guideId:53,nextId:"117",descId:116,bgId:5,clickContinue:!0},117:{guideId:54,nextId:"118",descId:117,bgId:5,personPic:"story_npc_4",nameId:"storyNPCName3",clickContinue:!0},118:{guideId:55,nextId:"119",descId:118,bgId:5,personPic:"story_npc_18",nameId:"storyNPCName2",clickContinue:!0},119:{guideId:56,nextId:"120",descId:119,bgId:5,personPic:1,nameId:"storyNPCName1",clickContinue:!0},120:{guideId:57,nextId:null,clickRect:{x:210,y:390,w:220,h:220,fromCenter:.5},handPos:{x:320,y:500,fromCenter:.5},waitNext:123},123:{guideId:58,nextId:"124",descId:123,bgId:5,clickContinue:!0,resEndId:"128"},124:{guideId:59,nextId:"125",descId:124,bgId:5,personPic:"story_npc_4",nameId:"storyNPCName3",clickContinue:!0},125:{guideId:60,nextId:"126",descId:125,bgId:5,personPic:1,nameId:"storyNPCName1",clickContinue:!0},126:{guideId:61,nextId:"127",clickRect:{x:565,y:12,w:75,h:100},handPos:{x:612,y:52,flip:!0}},127:{guideId:62,nextId:"128",clickRect:{x:10,y:850,w:140,h:100,fromBottom:107},handPos:{x:70,y:890,fromBottom:70}},128:{guideId:64,nextId:null,clickRect:{x:0,y:850,w:170,h:70,fromBottom:222},handPos:{x:73,y:878,fromBottom:199}},child_1:{otherId:"child_1",nextId:"child_2",clickRect:{x:220,y:350,w:130,h:270,fromBottom:640},handPos:{x:270,y:400,fromBottom:508},isScenePos:"homeScene",sceneKey:"child"},child_2:{otherId:"child_2",nextId:"child_3",clickRect:{x:14,y:420,w:420,h:90},tipId:"child_2",tipPos:{x:130,y:600},touchAll:!0},child_3:{otherId:"child_3",nextId:"child_4",clickRect:{x:475,y:470,w:160,h:70},tipId:"child_3",tipPos:{x:130,y:590},touchAll:!0},child_4:{otherId:"child_4",nextId:null,clickRect:{x:170,y:638,w:140,h:40},tipId:"child_4",tipPos:{x:130,y:500},touchAll:!0},adult_1:{otherId:"adult_1",nextId:"adult_2",clickRect:{x:70,y:320,w:130,h:170,fromBottom:690},handPos:{x:110,y:340,fromBottom:618},isScenePos:"homeScene",sceneKey:"adult"},adult_2:{otherId:"adult_2",nextId:"adult_3",clickRect:{x:220,y:698,w:160,h:40},tipId:"adult_2",tipPos:{x:130,y:560},touchAll:!0},adult_3:{otherId:"adult_3",nextId:"adult_4",clickRect:{x:390,y:470,w:175,h:75},tipId:"adult_3",tipPos:{x:130,y:620},touchAll:!0},adult_4:{otherId:"adult_4",nextId:null,clickRect:{x:10,y:230,w:620,h:210},tipId:"adult_4",tipPos:{x:130,y:510},touchAll:!0,needPush:!0},search_1:{otherId:"search_1",nextId:"search_2",clickRect:{x:480,y:300,w:100,h:160},handPos:{x:510,y:370}},search_2:{otherId:"search_2",nextId:"search_3",clickRect:{x:454,y:318,w:160,h:70,fromBottom:95},tipId:"search_2",tipPos:{x:130,y:690},touchAll:!0},search_3:{otherId:"search_3",nextId:null,clickRect:{x:50,y:313,w:540,h:540,fromCenter:.5},tipId:"search_3",tipPos:{x:130,y:220},touchAll:!0,needPush:!0},prison_1:{otherId:"prison_1",nextId:"prison_2",clickRect:{x:240,y:420,w:150,h:150},handPos:{x:310,y:490}},prison_2:{otherId:"prison_2",nextId:"prison_3",clickRect:{x:40,y:270,w:540,h:500},tipId:"prison_2",tipPos:{x:130,y:800},touchAll:!0},prison_3:{otherId:"prison_3",nextId:null,clickRect:{x:113,y:93,w:80,h:80},tipId:"prison_3",tipPos:{x:130,y:240},touchAll:!0},atkrace_1:{otherId:"atkrace_1",nextId:"atkrace_2",clickRect:{x:330,y:350,w:160,h:160},handPos:{x:410,y:410}},atkrace_2:{otherId:"atkrace_2",nextId:"atkrace_3",clickRect:{x:120,y:698,w:400,h:450,fromBottom:530},tipId:"atkrace_2",tipPos:{x:130,y:250},touchAll:!0},atkrace_3:{otherId:"atkrace_3",nextId:"atkrace_4",clickRect:{x:40,y:730,w:560,h:75,fromCenter:.5},tipId:"atkrace_3",tipPos:{x:130,y:620},touchAll:!0,needPush:!0},atkrace_4:{otherId:"atkrace_4",nextId:null,clickRect:{x:10,y:140,w:620,h:210},tipId:"atkrace_4",tipPos:{x:130,y:410},touchAll:!0,needPush:!0},dinner_1:{otherId:"dinner_1",nextId:"dinner_2",clickRect:{x:430,y:530,w:200,h:160},handPos:{x:530,y:610}},dinner_2:{otherId:"dinner_2",nextId:"dinner_3",clickRect:{x:230,y:300,w:180,h:150},tipId:"dinner_2",tipPos:{x:130,y:500},touchAll:!0},dinner_3:{otherId:"dinner_3",nextId:"dinner_4",clickRect:{x:50,y:600,w:540,h:250},tipId:"dinner_3",tipPos:{x:130,y:440},touchAll:!0},dinner_4:{otherId:"dinner_4",nextId:null,clickRect:{x:48,y:115,w:540,h:230,fromCenter:.5},tipId:"dinner_4",tipPos:{x:130,y:460},touchAll:!0,needPush:!0}};
t.getRookieCfg=e}(RookieCfg||(RookieCfg={}));var ServerCfg=function(){function t(){}return t.setLoginServer=function(e){if(t.lastServer.zid!=e)for(var i=t.serverlist.length,a=0;i>a;a++){var n=t.serverlist[a];if(n.zid==e){for(var o in n)t.lastServer[o]=n[o];break}}},t.setSelectServer=function(e){if(t.selectServer.zid!=e){for(var i=t.serverlist.length,a=0;i>a;a++){var n=t.serverlist[a];if(n.zid==e){t.setServerData(n);break}}App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_SELECT_SERVERLIST)}},t.setServerData=function(e){t.selectServer={};for(var i in e)"locals"!=PlatformManager.getSpid()||"ip_server"!=i&&"ip_chat"!=i?t.selectServer[i]=e[i]:t.selectServer[i]=t.getHost()},t.initSvrUrl=function(){var e=t.getHost();this.svrCfgUrl="//"+e+"/tank-global/index.php/",this.baseUrl="//"+e+"/gucenter/"},t.getHost=function(){return App.DeviceUtil.IsHtml5()&&PlatformManager.checkIsLocal()&&egret.getOption("testplat")&&t.allHost[egret.getOption("testplat")]?t.allHost[egret.getOption("testplat")]:t.allHost[PlatformManager.getSpid()]},t.checkServerDebug=function(){var e=!1;if(App.DeviceUtil.IsHtml5()){var i=document.baseURI;i.indexOf("gt_test")>-1&&(e=!0)}else(PlatformManager.checkIsTest()||PlatformManager.checkIsLocal())&&(e=!0);return egret.getOption("testplat")&&t.allHost[egret.getOption("testplat")]&&(e=!1),e},t.checkTestByBaseDiv=function(){if(App.DeviceUtil.IsHtml5()){var t=document.baseURI;if(t.indexOf("gt_test")>-1)return!0}return!1},t.getWxGameResourceUrl=function(){return Http.getProtocol()+"//"+t.getHost()+"/wxgameclient/resource/"},t.allHost={wanba:"5a26626c-0.gz.1251001051.clb.myqcloud.com","3k":"gt-cn-in.raygame3.com",local:"192.168.8.82",locals:"local-test-82.raygame3.com",test:"gt-test.raygame3.com",yyb:"gt-yyb-web01.raygame3.com",tw:"gd-game.heyyogame.com",fkylc:"gt-fkylc-web01.raygame3.com",xly:"gt-xly-web01.raygame3.com",xzy:"gt-xzy-web01.raygame3.com",iosshenhe:"gt-shenhe.raygame3.com",zjlx:"gt-zjly-web01.raygame3.com",ewan:"gt-ewan-web01.raygame3.com","49y":"gt-49y-web01.raygame3.com",sf:"gt-sf-web01.raygame3.com",kr:"gt-kr-web01.mayngames.co.kr",fkcw:"gt-fkcw-web01.raygame3.com",en:"gt-shenhe.raygame3.com",9130:"gt-9130-web01.raygame3.com",wxgame:"gt-wanba-web01.raygame3.com"},t.lastServer={},t.selectServer={},t.baseUrl="//192.168.8.82/gucenter/",t.serverTokenUrl="getaccess_token.php",t.svrCfgUrl="//192.168.8.82/tank-global/index.php/",t}();__reflect(ServerCfg.prototype,"ServerCfg");var ServerItemCfg=function(){function t(){}return t.prototype.initData=function(t){for(var e in t)this[e]=t[e]},t}();__reflect(ServerItemCfg.prototype,"ServerItemCfg");var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=void 0;s.hasOwnProperty(String(e))||(s[String(e)]=new i),a=s[String(e)],a.initData(t[e]),a.id=String(e)}}function a(t){return s[String(t)]}function n(){return s}function o(){return Object.keys(s).length}var s=[];t.formatData=e,t.getAchievementCfgById=a,t.getAchievemenCfgList=n,t.getMaxLength=o}(e=t.AchievementCfg||(t.AchievementCfg={}));var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return LanguageManager.getlocal("achievementName_"+this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"acIcon",{get:function(){return"achievementicon_"+this.icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nameIcon",{get:function(){return"achievementname_"+this.icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShieldWhenShenhe",{get:function(){return Api.switchVoApi.checkOpenShenhe()&&"703"==this.id?!0:!1},enumerable:!0,configurable:!0}),e}(BaseItemCfg);t.AchievementItemCfg=i,__reflect(i.prototype,"Config.AchievementItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(e,i){return t.cfgList[e]?t.cfgList[e][i]:null}function i(e){t.isGetAll=!0;for(var i in e){var a=i.split("-"),n=a[0],o=a[1],s="Config.AcCfg."+App.StringUtil.firstCharToUper(n)+"Cfg",r=egret.getDefinitionByName(s);if(0==t.cfgList.hasOwnProperty(n)&&(t.cfgList[n]={}),r){var l=new r;l.formatData(e[i]),t.cfgList[n][o]=l}else App.LogUtil.log("缺少活动配置解析"+s+"，请参考DailyChargeCfg写法")}}function a(t,e){}t.isGetAll=!1,t.cfgList={},t.getCfgByActivityIdAndCode=e,t.formatAllCfg=i,t.formatCfgById=a}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){this.itemListCfg={}}return t.prototype.formatData=function(t){for(var e in t){var a=void 0;this.itemListCfg.hasOwnProperty(String(e))||(this.itemListCfg[String(e)]=new i),a=this.itemListCfg[String(e)],a.initData(t[e]),a.id=String(e)}},t.prototype.getList=function(){return this.itemListCfg},t.prototype.getRechargeItemById=function(t){return this.itemListCfg[t]},t}();t.CarnivalChargeCfg=e,__reflect(e.prototype,"Config.AcCfg.CarnivalChargeCfg");var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);t.CarnivalChargeItemCfg=i,__reflect(i.prototype,"Config.AcCfg.CarnivalChargeItemCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){this.itemListCfg={}}return t.prototype.formatData=function(t){for(var e in t){var a=void 0;this.itemListCfg.hasOwnProperty(String(e))||(this.itemListCfg[String(e)]=new i),a=this.itemListCfg[String(e)],a.initData(t[e]),a.id=String(e)}},t.prototype.getList=function(){return this.itemListCfg},t.prototype.getRechargeItemById=function(t){return this.itemListCfg[t]},t}();t.CarnivalCostCfg=e,__reflect(e.prototype,"Config.AcCfg.CarnivalCostCfg");var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);t.CarnivalCostItemCfg=i,__reflect(i.prototype,"Config.AcCfg.CarnivalCostItemCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){}return t.prototype.formatData=function(t){this.unlock=t.unlock,this.servantLv=t.servantLv,this.dailyNum=t.dailyNum,this.intervalTime=t.intervalTime,this.fightAdd=t.fightAdd,this.revenge=t.revenge,this.challenge=t.challenge,this.hunt=t.hunt,this.parameter1=t.parameter1,this.parameter3=t.parameter3,this.iniAtt=t.iniAtt,this.juniorAtt=t.juniorAtt,this.mediumAtt=t.mediumAtt,this.seniorAtt=t.seniorAtt,this.winServer=t.winServer,this.loseServer=t.loseServer,this.rankList=t.rankList},t.prototype.getDailyNum=function(){return this.dailyNum},t.prototype.getParameter1=function(){return this.parameter1},t.prototype.getServantLv=function(){return this.servantLv},t.prototype.getIntervalTime=function(){return this.intervalTime},t.prototype.getUnlock=function(){return this.unlock},t.prototype.getInitAtt=function(t){return this.iniAtt[t]},t.prototype.getJuniorAtt=function(t){return this.juniorAtt[t]},t.prototype.getMediumAtt=function(t){return this.mediumAtt[t]},t.prototype.getSeniorAtt=function(t){return this.seniorAtt[t]},t.prototype.getFightAdd=function(){return this.fightAdd},t.prototype.getbeatNum=function(){return this.parameter3},t.prototype.getWinServerRewards=function(){return GameData.getRewardItemIcons(this.winServer,!0,!0)},t.prototype.getLossServerRewards=function(){return GameData.getRewardItemIcons(this.loseServer,!0,!0)},t.prototype.getServerRankRewards=function(){return this.rankList},t}();t.CrossServerAtkRaceCfg=e,__reflect(e.prototype,"Config.AcCfg.CrossServerAtkRaceCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){}return t.prototype.formatData=function(t){this._winServer=t.winServer,this._loseServer=t.loseServer,this._rankList=t.rankList},t.prototype.getWinServerRewards=function(){return GameData.getRewardItemIcons(this._winServer,!0,!0)},t.prototype.getLossServerRewards=function(){return GameData.getRewardItemIcons(this._loseServer,!0,!0)},t.prototype.getServerRankRewards=function(){return this._rankList},t}();t.CrossServerIntimacyCfg=e,__reflect(e.prototype,"Config.AcCfg.CrossServerIntimacyCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){this.itemListCfg={}}return t.prototype.formatData=function(t){for(var e in t){var a=void 0;this.itemListCfg.hasOwnProperty(String(e))||(this.itemListCfg[String(e)]=new i),a=this.itemListCfg[String(e)],a.initData(t[e]),a.id=String(e)}},t.prototype.getList=function(){return this.itemListCfg},t.prototype.getRechargeItemById=function(t){return this.itemListCfg[t]},t}();t.DailyChargeCfg=e,__reflect(e.prototype,"Config.AcCfg.DailyChargeCfg");var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);t.DailyChargeItemCfg=i,__reflect(i.prototype,"Config.AcCfg.DailyChargeItemCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){this.vipList={}}return t.prototype.formatData=function(t){for(var e in t){var a=void 0;this.vipList.hasOwnProperty(String(e))||(this.vipList[String(e)]=new i),a=this.vipList[String(e)],a.initData(t[e]),a.level=Number(e)}},t}();t.DiscountCfg=e,__reflect(e.prototype,"Config.AcCfg.DiscountCfg");var i=function(){function t(){}return t.prototype.initData=function(t){this.needGem=t.needGem},t}();t.DiscountItemCfg=i,__reflect(i.prototype,"Config.AcCfg.DiscountItemCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(e){var i=function(){function t(){this.itemListCfg=[]}return t.prototype.formatData=function(t){for(var e in t){var i=void 0;i=new a,i.needNum=t[e].needNum,i.getServant=t[e].getServant,i.needItem=t[e].needItem,this.itemListCfg.push(i)}},t.prototype.getPeopleList=function(){return this.itemListCfg},t}();e.FourPeopleCfg=i,__reflect(i.prototype,"Config.AcCfg.FourPeopleCfg");var a=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.getServant="",t.needItem="",t.needNum=0,t}return __extends(i,e),Object.defineProperty(i.prototype,"servantIcon",{get:function(){return t.ServantCfg.getServantItemById(this.getServant).fullIcon},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"servantName",{get:function(){return t.ServantCfg.getServantItemById(this.getServant).name},enumerable:!0,configurable:!0}),i}(BaseItemCfg);e.FourPeoPleItemCfg=a,__reflect(a.prototype,"Config.AcCfg.FourPeoPleItemCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){}return t.prototype.formatData=function(t){if(t)for(var e in t)this[e]=t[e]},t}();t.LimitedRewardCfg=e,__reflect(e.prototype,"Config.AcCfg.LimitedRewardCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){this._cost=0,this._discount=0,this._getReward="",this._lotteryNum=[],this._lotteryPool=[],this._rankNeedNum=0,this._rankReward=[],this._recharge=[],this._task=[]}return t.prototype.formatData=function(t){for(var e in t)this["_"+e]=t[e]},Object.defineProperty(t.prototype,"cost",{get:function(){return this._cost},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"discount",{get:function(){return this._discount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getReward",{get:function(){return this._getReward},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lotteryNum",{get:function(){return this._lotteryNum},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lotteryPool",{get:function(){return this._lotteryPool},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rankNeedNum",{get:function(){return this._rankNeedNum},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rankReward",{get:function(){return this._rankReward},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recharge",{get:function(){return this._recharge},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"task",{get:function(){return this._task},enumerable:!0,configurable:!0}),t.prototype.getBoxRewardById=function(t){return this._lotteryNum[t]?this._lotteryNum[t]:null},t.prototype.getChargeRewardById=function(t){return this._recharge[t]?this._recharge[t]:null},t.prototype.getSelectItemIdx=function(t){var e=0;for(var i in this._lotteryPool){var a=this._lotteryPool[i];if(a[0]==t){e=Number(i);break}}return e},t}();t.MayDayCfg=e,__reflect(e.prototype,"Config.AcCfg.MayDayCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){this.itemListCfg={}}return t.prototype.formatData=function(t){for(var e in t){var a=void 0;this.itemListCfg.hasOwnProperty(String(e))||(this.itemListCfg[String(e)]=new i),a=this.itemListCfg[String(e)],a.initData(t[e]),a.id=String(e)}},t.prototype.getRechargeItemById=function(t){return this.itemListCfg[t]},t}();t.NewYearCfg=e,__reflect(e.prototype,"Config.AcCfg.NewYearCfg");var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);t.AcNewYearItemCfg=i,__reflect(i.prototype,"Config.AcCfg.AcNewYearItemCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){}return t.prototype.formatData=function(t){if(t)for(var e in t)this[e]=t[e]},t}();t.PunishCfg=e,__reflect(e.prototype,"Config.AcCfg.PunishCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){this.rankList={},this.isCross=0}return t.prototype.formatData=function(t){for(var e in t)if("rankList"==e)for(var a in t[e]){var n=void 0;this.rankList.hasOwnProperty(String(a))||(this.rankList[String(a)]=new i),n=this.rankList[String(a)],n.initData(t[e][a]),n.id=String(a)}else this[e]=t[e]},t.prototype.getRankList=function(){return this.rankList},t.prototype.getMaxRangValue=function(){var t=Object.keys(this.rankList);return this.rankList[t[t.length-1]].rank[1]},Object.defineProperty(t.prototype,"helpInfo",{get:function(){var t=void 0;return 11==this.type&&(t="acRankActive-"+this.type+"_Desc"),t},enumerable:!0,configurable:!0}),t}();t.RankActiveCfg=e,__reflect(e.prototype,"Config.AcCfg.RankActiveCfg");var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.reward="",e.reward1="",e}return __extends(e,t),Object.defineProperty(e.prototype,"minRank",{get:function(){return this.rank[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxRank",{get:function(){return this.rank[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rewardIcons",{get:function(){return GameData.getRewardItemIcons(this.reward,!0,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reward1Icons",{get:function(){return GameData.getRewardItemIcons(this.reward1,!0,!0)},enumerable:!0,configurable:!0}),e}(BaseItemCfg);t.RankActiveItemCfg=i,__reflect(i.prototype,"Config.AcCfg.RankActiveItemCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=[],i=function(){function t(){this.itemListCfg={},this.itemListCfg2=[]}return t.prototype.formatData=function(t){e=[];for(var i in t)t[i].key=String(i),e.push(t[i]),this.itemListCfg2.push(t[i])},t.prototype.getItemListCfg2=function(){return this.itemListCfg2},t}();t.SpringCelebrateCfg=i,__reflect(i.prototype,"Config.AcCfg.SpringCelebrateCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){}return t.prototype.formatData=function(t){if(t)for(var e in t)this[e]=t[e]},t}();t.TailorCfg=e,__reflect(e.prototype,"Config.AcCfg.TailorCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){this.itemListCfg={}}return t.prototype.formatData=function(t){for(var e in t){var a=void 0;this.itemListCfg.hasOwnProperty(String(e))||(this.itemListCfg[String(e)]=new i),a=this.itemListCfg[String(e)],a.initData(t[e]),a.id=String(e)}},t.prototype.getList=function(){return this.itemListCfg},t.prototype.getRechargeItemById=function(t){return this.itemListCfg[t]},t}();t.TotalDayRechargeCfg=e,__reflect(e.prototype,"Config.AcCfg.TotalDayRechargeCfg");var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);t.TotalDayRechargeItemCfg=i,__reflect(i.prototype,"Config.AcCfg.TotalDayRechargeItemCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){this.itemListCfg={}}return t.prototype.formatData=function(t){for(var e in t){var a=void 0;this.itemListCfg.hasOwnProperty(String(e))||(this.itemListCfg[String(e)]=new i),a=this.itemListCfg[String(e)],a.initData(t[e]),a.id=String(e)}},t.prototype.getList=function(){return this.itemListCfg},t.prototype.getRechargeItemById=function(t){return this.itemListCfg[t]},t}();t.TotalRechargeCfg=e,__reflect(e.prototype,"Config.AcCfg.TotalRechargeCfg");var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);t.TotalRechargeCfgItemCfg=i,__reflect(i.prototype,"Config.AcCfg.TotalRechargeCfgItemCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){this.itemListCfg={}}return t.prototype.formatData=function(t){for(var e in t){var a=void 0;this.itemListCfg.hasOwnProperty(String(e))||(this.itemListCfg[String(e)]=new i),a=this.itemListCfg[String(e)],a.initData(t[e]),a.id=String(e)}},t.prototype.getList=function(t){var e=new Array;for(var i in this.itemListCfg)t==this.itemListCfg[i].sheetType&&e.push(this.itemListCfg[i]);return e},t.prototype.getRechargeItemById=function(t){return this.itemListCfg[t]},t}();t.VipShopCfg=e,__reflect(e.prototype,"Config.AcCfg.VipShopCfg");var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);t.VipShopItemCfg=i,__reflect(i.prototype,"Config.AcCfg.VipShopItemCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){}return t.prototype.formatData=function(t){this.wifeId=t.wifeId,this.exchange=t.exchange,this.need=t.need},t}();t.WifeComeCfg=e,__reflect(e.prototype,"Config.AcCfg.WifeComeCfg")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){var e=function(){function t(){this.cost1="",this.cost2="",this.shopItemList={},this.ownList=[],this.notOwnList=[]}return t.prototype.formatData=function(t){if(t){this.cost1=t.cost1,this.cost2=t.cost2;for(var e in t.shop){var a=this.shopItemList[e];a||(a=new i,this.shopItemList[e]=a),a.initData(t.shop[e]),a.id=e}}},t.prototype.dealList=function(){this.notOwnList=[],this.ownList=[];for(var t in this.shopItemList){var e=this.shopItemList[t];Api.wifeVoApi.getWifeInfoVoById(e.wifeId)?this.ownList.push(e):this.notOwnList.push(e)}},t.prototype.getWishWifeIdList=function(){return this.dealList(),this.notOwnList.concat(this.ownList)},t.prototype.getLastWishTimes=function(){return this.dealList(),this.notOwnList.length},t.prototype.getMaxTimes=function(){return Object.keys(this.shopItemList).length},t.prototype.getWishCfgById=function(t){return this.shopItemList[t]},t}();t.WishTreeCfg=e,__reflect(e.prototype,"Config.AcCfg.WishTreeCfg");var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id="",e.wifeId="",e.needItem="",e.needNum=0,e}return __extends(e,t),e}(BaseItemCfg);t.WishTreeShopItem=i,__reflect(i.prototype,"Config.AcCfg.WishTreeShopItem")}(e=t.AcCfg||(t.AcCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t.adultQuality){var a=void 0;n.hasOwnProperty(String(e))||(n[String(e)]=new i),a=n[String(e)],a.initData(t.adultQuality[e])}this.lastTime=t.lastTime,this.freshGem=t.freshGem}function a(t){return n[String(t)]}var n={};t.formatData=e,t.getItemCfgById=a}(e=t.AdultCfg||(t.AdultCfg={}));var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);t.AdultItemCfg=i,__reflect(i.prototype,"Config.AdultItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(e){for(var i in e)t[i]=e[i]}t.formatData=e}(e=t.AlliancebaseCfg||(t.AlliancebaseCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=void 0;s.hasOwnProperty(String(e))||(s[String(e)]=new i),a=s[String(e)],a.initData(t[e]),a.id=e}}function a(t){return s[String(t)]}function n(){return Object.keys(s)}function o(){return Object.keys(s).length}var s=[];t.formatData=e,t.getAllianceCfgByLv=a,t.getAllainceCfgIdList=n,t.getMaxLength=o}(e=t.AlliancebossCfg||(t.AlliancebossCfg={}));var i=function(t){function e(){var e=t.call(this)||this;return e.bossPic=1,e}return __extends(e,t),e}(BaseItemCfg);t.AllianceBossItemCfg=i,__reflect(i.prototype,"Config.AllianceBossItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=void 0;s.hasOwnProperty(String(e))||(s[String(e)]=new i),a=s[String(e)],a.initData(t[e]),a.level=String(e)}}function a(t){return s[String(t)]}function n(){return s}function o(){return Object.keys(s).length}var s=[];t.formatData=e,t.getAllianceCfgByLv=a,t.getAllainceCfgList=n,t.getMaxLength=o}(e=t.AllianceCfg||(t.AllianceCfg={}));var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(BaseItemCfg);t.AllianceItemCfg=i,__reflect(i.prototype,"Config.AllianceItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=void 0;n.hasOwnProperty(String(e))||(n[String(e)]=new i),a=n[String(e)],a.initData(t[e]),a.id=String(e)}}function a(t){return n[String(t)]}var n={};t.formatData=e,t.getRightCfgById=a}(e=t.AllianceRightCfg||(t.AllianceRightCfg={}));var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);t.AllianceRightItemCfg=i,__reflect(i.prototype,"Config.AllianceRightItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t.rewards)a.hasOwnProperty(String(e))||(a[String(e)]=t.rewards[e])}function i(t){return a.hasOwnProperty(String(t))?a[String(t)]:""}var a={};t.formatData=e,t.getContentByIndex=i}(e=t.ArrivalCfg||(t.ArrivalCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){p=t.unlock,_=t.servantLv,u=t.dailyNum,C=t.intervalTime,f=t.fightAdd,m=t.revenge,T=t.challenge,y=t.hunt,v=t.parameter1,A=t.parameter3,w=t.iniAtt,x=t.juniorAtt,I=t.mediumAtt,L=t.seniorAtt}function i(){return u}function a(){return v}function n(){return _}function o(){return C}function s(){return p}function r(t){return w[t]}function l(t){return x[t]}function h(t){return I[t]}function d(t){return L[t]}function g(){return f}function c(){return A}var p,_,u,C,f,m,T,y,v,A,w,x,I,L;t.formatData=e,t.getDailyNum=i,t.getParameter1=a,t.getServantLv=n,t.getIntervalTime=o,t.getUnlock=s,t.getInitAtt=r,t.getJuniorAtt=l,t.getMediumAtt=h,t.getSeniorAtt=d,t.getFightAdd=g,t.getbeatNum=c}(e=t.AtkraceCfg||(t.AtkraceCfg={}))}(Config||(Config={}));var ChallengeCfg;!function(t){function e(t){return GameConfig.config.challengeCfg&&GameConfig.config.challengeCfg[t.toString()]?GameConfig.config.challengeCfg[t.toString()]:null}function i(){return Object.keys(GameConfig.config.challengeCfg).length}t.getChallengeCfgById=e,t.getChallengeTotalPass=i}(ChallengeCfg||(ChallengeCfg={}));var Config;!function(t){var e;!function(t){function e(t){return GameConfig.config.challengestoryCfg&&GameConfig.config.challengestoryCfg[t]?GameConfig.config.challengestoryCfg[t]:null}t.getChallengestoryCfgById=e}(e=t.ChallengestoryCfg||(t.ChallengestoryCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(e){for(var i in e)t[i]=e[i]}t.formatData=e}(e=t.ChildbaseCfg||(t.ChildbaseCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=void 0;s.hasOwnProperty(String(e))||(s[String(e)]=new i),a=s[String(e)],a.initData(t[e]),a.id=String(e)}}function a(t){return s[String(t)]}function n(){return s}function o(){return Object.keys(s).length}var s=[];t.formatData=e,t.getConquestCfgById=a,t.getConquestCfgList=n,t.getMaxLength=o}(e=t.ConquestCfg||(t.ConquestCfg={}));var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return LanguageManager.getlocal("wifeName_"+this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return"wife_half_"+this.id},enumerable:!0,configurable:!0}),e}(BaseItemCfg);t.ConquestItemCfg=i,__reflect(i.prototype,"Config.ConquestItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){return _[t]}function a(t){return LanguageManager.getlocal("dailybossTitle"+t)}function n(e){var i=t.boss1Time[0]*App.DateUtil.hourSeconds,a=t.boss1Time[1]*App.DateUtil.hourSeconds;return e>=i&&a>=e?!0:!1}function o(e){var i=t.boss2Time[0]*App.DateUtil.hourSeconds,a=t.boss2Time[1]*App.DateUtil.hourSeconds;return e>=i&&a>=e?!0:!1}function s(e){var i=0,a=t.boss1Time[0]*App.DateUtil.hourSeconds,n=t.boss1Time[1]*App.DateUtil.hourSeconds,o=t.boss2Time[0]*App.DateUtil.hourSeconds,s=t.boss2Time[1]*App.DateUtil.hourSeconds;return a>e?i=0:e>=a&&n>=e?i=1:e>n&&(o>e?i=0:e>=o&&s>=e?i=1:e>s&&(i=2)),i}function r(e){return 1==e?t.boss1Time[0]+":00-"+t.boss1Time[1]+":00":t.boss2Time[0]+":00-"+t.boss2Time[1]+":00"}function l(e){var i=s(e),a=t.boss1Time[0]*App.DateUtil.hourSeconds,n=t.boss2Time[0]*App.DateUtil.hourSeconds;return 0==i?a>e?a-e:n-e:0}function h(e){var i=0;if(n(e)){var a=t.boss1Time[1]*App.DateUtil.hourSeconds;i=a-e}else if(o(e)){var a=t.boss2Time[1]*App.DateUtil.hourSeconds;i=a-e}return i}function d(e){for(var a in e)if("shop"==a){var n=e[a];for(var o in n){var s=new i;s.initData(n[o]),s.id=String(o),_[o]=s,t.shopList.push(s)}t.shopList.sort(function(t,e){return Number(t.id)-Number(e.id)})}else"boss1"==a?c=e[a]:"boss2"==a?p=e[a]:t[a]||(t[a]=e[a])}function g(e){for(var i in e)t[i]=e[i]}var c,p,_={};t.shopList=[],t.getShopItemById=e,t.getBossNameByType=a,t.checkInBoss1Time=n,t.checkInBoss2Time=o,t.getStatus=s,t.getInTimeStr=r,t.getNextStartLeftTime=l,t.getLeftTime=h,t.formatData=d,t.formatDataByServer=g}(e=t.DailybossCfg||(t.DailybossCfg={}));var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),Object.defineProperty(i.prototype,"itemCfg",{get:function(){return t.ItemCfg.getItemCfgById(this.content.split("_")[1])},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return this.itemCfg.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"iconContainer",{get:function(){return this.itemCfg.getIconContainer(!0)},enumerable:!0,configurable:!0}),i.prototype.getNeedScoreByNum=function(t){return t||(t=0),t=Math.max(0,Math.min(this.needScore.length-1,t)),this.needScore[t]},i}(BaseItemCfg);t.DailybossShopItemCfg=i,__reflect(i.prototype,"Config.DailybossShopItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=void 0;s.hasOwnProperty(String(e))||(s[String(e)]=new i),a=s[String(e)],a.rate=t[e][0],a.times=t[e][1],a.name=String(e)}}function a(){return n("manage").times}function n(t){return s[t]}function o(){var t=[];for(var e in s)t.push(s[e]);return t}var s={};t.formatData=e,t.getManageTimes=a,t.getDailylucyCfgByName=n,t.getLuckIdList=o}(e=t.DailyluckCfg||(t.DailyluckCfg={}));var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);__reflect(i.prototype,"DailyluckItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t.task){var n=void 0;l.hasOwnProperty(String(e))||(l[String(e)]=new i),n=l[String(e)],n.initData(t.task[e]),n.taskId=String(e)}for(var e in t.rewards){var n=void 0;h.hasOwnProperty(String(e))||(h[String(e)]=new a),n=h[String(e)],n.initData(t.rewards[e]),n.id=String(e)}}function n(t){return l[t]}function o(){if(!Api.switchVoApi.checkOpenShenhe())return Object.keys(l);var t=[];for(var e in l){var i=l[e].openType;"rank"!=i&&"alliance"!=i&&t.push(e)}return t}function s(){return h}function r(t){return h[t]}var l={},h={};t.formatData=e,t.getDailytaskCfgByTaskId=n,t.getTasksIdList=o,t.getDailyRewardsList=s,t.getDailyRewardsCfgByRewardId=r}(e=t.DailytaskCfg||(t.DailytaskCfg={}));var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);__reflect(i.prototype,"DailytaskItemCfg");var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);__reflect(a.prototype,"DailyRewardsItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){C=t.needLv,f=t.goToFeastNum,m=t.shopReTime,y=t.shopItemNum,v=t.shopNeedGem,T=t.shopReset,I=t.needItem;for(var e in t.feast){var o=void 0;A.hasOwnProperty(String(e))||(A[String(e)]=new i),o=A[String(e)],o.initData(t.feast[e]),o.id=String(e)}for(var e in t.goToFeast){var o=void 0;w.hasOwnProperty(String(e))||(w[String(e)]=new a),o=w[String(e)],o.initData(t.goToFeast[e]),o.id=String(e)}for(var e in t.shop){var o=void 0;x.hasOwnProperty(String(e))||(x[String(e)]=new n),o=x[String(e)],o.initData(t.shop[e]),o.id=String(e)}}function o(t){return A[t.toString()]}function s(){return w}function r(t){return w[t.toString()]}function l(t){return x[t]}function h(){return C}function d(){return f}function g(){return m}function c(){return T}function p(){return I}function _(){return y}function u(){return v}var C,f,m,T,y,v,A={},w={},x={},I=null;t.formatData=e,t.getFeastItemCfg=o,t.getFeastItemList=s,t.getGoToFeastItemCfg=r,t.getShopItemCfg=l,t.getNeedLv=h,t.getGoToFeastNum=d,t.getShopReTime=g,t.getShopReset=c,t.getNeedItem=p,t.getShopItemNum=_,t.getShopNeedGem=u}(e=t.DinnerCfg||(t.DinnerCfg={}));var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);__reflect(i.prototype,"DinnerFeastItemCfg");var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);__reflect(a.prototype,"DinnerGoToFeastItemCfg");var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);__reflect(n.prototype,"DinnerShopItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){t.rewards&&(t.rewards.getServant&&(s=Number(t.rewards.getServant)),t.rewards.r&&(r=t.rewards.r),t.needRecharge&&(this.needRecharge=t.needRecharge),t.extraClient&&(this.extraClient=t.extraClient))}function i(){return GameData.formatRewardItem(r)}function a(t){return void 0===t&&(t=null),-1!=this.needRecharge.indexOf(t)?!0:!1}function n(t){return void 0===t&&(t=null),this.needRecharge[t]?!0:!1}function o(){return this.extraClient}var s,r;t.formatData=e,t.getRewardItemVoList=i,t.getneedRecharge=a,t.getextraClient=n,t.getextra=o}(e=t.FirstchargeCfg||(t.FirstchargeCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t)this[e]=t[e]}t.rewardArr=[2,3,7],t.formatData=e}(e=t.GameprojectCfg||(t.GameprojectCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=t[e]?t[e].activeName:"";if(a){var n=void 0;c.hasOwnProperty(a)||(c[a]=new i),n=c[a],n.initData(t[e])}}}function a(t){return c[t]?Number(c[t].sortId):99999}function n(t){if(c[t])return a(t);for(var e in c)if(c[e]&&c[e].icon==t)return a(e);return 99999}function o(t){return c[t]?c[t].icon:void 0}function s(t){for(var e in c){var i=c[e];
if(e&&e.indexOf(".")>-1&&i.aid==t)return!0}return!1}function r(t,e){if(c[t]&&!e)return c[t].isFlick;if(e){if(c[t+"."+e])return c[t+"."+e].isFlick}else for(var i in c)if(c[i]&&c[i].icon==t)return c[i].isFlick;return!1}function l(t){if(g[t])return g[t];var e=[];if(!t)return e;if(c)for(var i in c)c[i]&&c[i].icon==t&&e.indexOf(i)<0&&e.push(i);return g[t]=e,e}function h(t,e){return t=e?t+"."+e:t,c[t]?c[t]:null}function d(t,e){var i=h(t,e);return i?i.iconBg:void 0}var g={},c={};t.formatData=e,t.getIconSortIdByCfgName=n,t.getIconNameByName=o,t.checkHasChildCfgNameByName=s,t.getisFlickByName=r,t.getAidListByCfgName=l,t.getIconCfgByAidAndType=h,t.getIconBgByAidAndType=d}(e=t.IconorderCfg||(t.IconorderCfg={}));var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconBg=0,e.isFlick=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"aid",{get:function(){return this.activeName?this.activeName.split(".")[0]:null},enumerable:!0,configurable:!0}),e}(BaseItemCfg);t.IconOrderItemCfg=i,__reflect(i.prototype,"Config.IconOrderItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t)this[e]=t[e]}t.formatData=e}(e=t.InvitefriendCfg||(t.InvitefriendCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){s.hasOwnProperty(String(l))||(s[String(e)]={}),o.hasOwnProperty(String(l))||(o[String(e)]=[]);var a=o[String(e)],n=s[String(e)],r=t[e];for(var l in r){var h=void 0;n.hasOwnProperty(String(l))||(n[String(l)]=new i),h=n[String(l)],h.initData(r[l]),h.id=String(l),a.push(h)}a.sort(function(t,e){return t.timeLimit?e.timeLimit?Number(t.id)-Number(e.id):-1:e.timeLimit?Number(e.timeLimit):Number(t.id)-Number(e.id)})}}function a(t,e){return s[String(e)][t]}function n(t){return o[String(t)]}var o={},s={};t.formatData=e,t.getItemCfgById=a,t.getComposeList=n}(e=t.ComposeCfg||(t.ComposeCfg={}));var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),Object.defineProperty(i.prototype,"name",{get:function(){return this.itemCfg.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"desc",{get:function(){return this.itemCfg.desc},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"icon",{get:function(){return this.itemCfg.icon},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"itemCfg",{get:function(){return t.ItemCfg.getItemCfgById(this.itemId)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"iconBg",{get:function(){return this.itemCfg.iconBg},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nameTxt",{get:function(){return this.itemCfg.nameTxt},enumerable:!0,configurable:!0}),i.prototype.getDescTxt=function(t){return this.itemCfg.getDescTxt(t)},Object.defineProperty(i.prototype,"needItemCfgList",{get:function(){if(!this._needItemCfgList){var e=[];for(var i in this.needItem)e.push(t.ItemCfg.getItemCfgById(i));e.sort(function(t,e){return Number(t.id)-Number(e.id)}),this._needItemCfgList=e}return this._needItemCfgList},enumerable:!0,configurable:!0}),i.prototype.getNeedItemNumById=function(t){for(var e in this.needItem)if(String(e)==e)return this.needItem[e];return 0},i.prototype.getIconContainer=function(t){return this.itemCfg.getIconContainer(t)},i}(BaseItemCfg);t.ComposeItemCfg=i,__reflect(i.prototype,"Config.ComposeItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=void 0;n.hasOwnProperty(String(e))||(n[String(e)]=new i),a=n[String(e)],a.initData(t[e]),a.id=String(e)}}function a(t){return n[String(t)]}var n={};t.formatData=e,t.getItemCfgById=a}(e=t.ItemCfg||(t.ItemCfg={}));var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return LanguageManager.getlocal("itemName_"+this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"qualityColor",{get:function(){var t=TextFieldConst.COLOR_QUALITY_WHITE;switch(Number(this.quality)){case 1:t=TextFieldConst.COLOR_QUALITY_WHITE;break;case 2:t=TextFieldConst.COLOR_QUALITY_GREEN;break;case 3:t=TextFieldConst.COLOR_QUALITY_BLUE;break;case 4:t=TextFieldConst.COLOR_QUALITY_PURPLE;break;case 5:t=TextFieldConst.COLOR_QUALITY_ORANGE}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return"itemicon"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconBg",{get:function(){return"itembg_"+(this.quality?this.quality:1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"desc",{get:function(){return LanguageManager.getlocal("itemDesc_"+this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropDesc",{get:function(){return LanguageManager.getlocal("itemDropDesc_"+this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nameTxt",{get:function(){var t=ComponentManager.getTextField(this.name,TextFieldConst.FONTSIZE_CONTENT_COMMON,this.qualityColor);return t},enumerable:!0,configurable:!0}),e.prototype.getDescTxt=function(t){var e;e=t?App.StringUtil.formatStringColor(LanguageManager.getlocal("effectTitle"),TextFieldConst.COLOR_LIGHT_YELLOW)+this.desc:this.desc;var i=ComponentManager.getTextField(e,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);return i.lineSpacing=2,i},e.prototype.getIconContainer=function(t){var e=GameData.getIconContainer(this.icon,this.iconBg);if(t){var i=e.getChildByName("iconBg");i.addTouchTap(function(t,e){ViewController.getInstance().openView(ViewConst.POPUP.ITEMINFOPOPUPVIEW,e)},GameData,[this.id])}return e},e}(BaseItemCfg);t.ItemItemCfg=i,__reflect(i.prototype,"Config.ItemItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=void 0;r.hasOwnProperty(String(e))||(r[String(e)]=new i),a=r[String(e)],a.initData(t[e]),a.id=String(e)}}function a(t){return r[String(t)]}function n(){return r}function o(){return Object.keys(r)}function s(){var t=[];for(var e in r){var i=r[e];Number(i.id)<=3005&&1==i.isOnly&&1==i.unlock&&t.push(e)}return t}var r={};t.formatData=e,t.getTitleCfgById=a,t.getTitleCfg=n,t.getTitleIdList=o,t.getIsonlyTitleIdList=s}(e=t.TitleCfg||(t.TitleCfg={}));var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return LanguageManager.getlocal("itemName_"+this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"titleIcon",{get:function(){return"user_title_"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"titleIcon2",{get:function(){return"user_title_"+this.id+"_2"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"titleIcon3",{get:function(){return"user_title_"+this.id+"_3"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return"itemicon"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconBg",{get:function(){return"itembg_"+(this.quality?this.quality:1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"desc",{get:function(){return LanguageManager.getlocal("itemDesc_"+this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropDesc",{get:function(){return LanguageManager.getlocal("itemDropDesc_"+this.id)},enumerable:!0,configurable:!0}),e}(BaseItemCfg);t.TitleItemCfg=i,__reflect(i.prototype,"Config.TitleItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=void 0;n.hasOwnProperty(String(e))||(n[String(e)]=new i),a=n[String(e)],a.initData(t[e])}}function a(t){return n[t]}var n={};t.formatData=e,t.getLampInfoItemCfg=a}(e=t.LampinfoCfg||(t.LampinfoCfg={}));var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);__reflect(i.prototype,"LampinfoItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){o={};for(var e in t){var a=void 0;o.hasOwnProperty(String(e))||(o[String(e)]=new i),a=o[String(e)],a.initData(t[e])}}function a(t){return o[String(t)]}function n(){return Object.keys(o).length}var o={};t.formatData=e,t.getCfgByLevel=a,t.getMaxLevel=n}(e=t.LevelCfg||(t.LevelCfg={}));var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(BaseItemCfg);__reflect(i.prototype,"LevelItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(e){for(var i in e)t[i]=e[i]}function i(t){var e=Math.floor(t/3/1e4*60+60),i=Math.min(e,a);return i}var a;t.formatData=e,t.getManageNeedTime=i}(e=t.ManageCfg||(t.ManageCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=void 0;s.hasOwnProperty(String(e))||(s[String(e)]=new i),a=s[String(e)],a.initData(t[e]),a.id=String(e)}}function a(t){var e=[];for(var i in s)s[i].type==t&&e.push(s[i]);return e.sort(function(t,e){return t.sortId-e.sortId}),e}function n(t){var e=[],i=[],a=[];for(var n in s)if(s[n].type==t){var o=Api.practiceVoApi.getPracticeTaskInfo(n);o&&0==o.f?e.push(s[n]):i.push(s[n])}return e.sort(function(t,e){return t.sortId-e.sortId}),i.sort(function(t,e){return t.sortId-e.sortId}),e.concat(i).concat(a)}function o(t){return s[t]}var s={};t.formatData=e,t.getPracticeListByType=a,t.getPracticeShowListByType=n,t.getPracticeListById=o}(e=t.PracticeCfg||(t.PracticeCfg={}));var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);t.PracticeItemCfg=i,__reflect(i.prototype,"Config.PracticeItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=void 0;n.hasOwnProperty(String(e))||(n[String(e)]=new i),a=n[String(e)],a.initData(t[e]),a.id=String(e)}}function a(t){return n[String(t)]}var n={};t.formatData=e,t.getPrestigeCfgById=a}(e=t.PrestigeCfg||(t.PrestigeCfg={}));var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);t.PrestigeItemCfg=i,__reflect(i.prototype,"Config.PrestigeItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var i=void 0;n.hasOwnProperty(String(e))||(n[String(e)]=new o),i=n[String(e)],i.initData(t[e]),this.prisonItemCfg=i}}function i(){var t=new Array;for(var e in n)t.push(n[e]);return t}function a(t){void 0===t&&(t=0);for(var e in n)if(e==""+t)return n[e];return null}var n={};t.formatData=e,t.getPrisonItemCfgList=i,t.getIndexPrisonItemCfg=a;var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.unlock=0,e.cost=0,e.num=0,e.drop=[],e}return __extends(e,t),e}(BaseItemCfg);t.PrisonItemCfg=o,__reflect(o.prototype,"Config.PrisonCfg.PrisonItemCfg")}(e=t.PrisonCfg||(t.PrisonCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(e){function a(){var t;if(PlatformManager.checkIsWanbaSp())try{var e=window.OPEN_DATA,i=e.platform,a=e.qua.app;t=d.wanba[a+i]}catch(n){}return t}function n(){var e=[],i=[];try{for(var a in c){var n=c[a];if(PlatformManager.checkIsWanbaSp()&&PlatformManager.checkIsUseSDK()){var o=window.OPEN_DATA,s=o.platform,r=(o.qua.app,t.RechargeCfg.wanbaCfg[n.id]["pid"+s]);i.push(r)}else n.orderid?i.push(n.orderid):e.push(n.id)}}catch(l){}return i&&i.length>0?i:e}function o(t){for(var e in t){var a=void 0;c.hasOwnProperty(String(e))||(c[String(e)]=new i),a=c[String(e)],a.initData(t[e]),a.id=String(e)}}function s(){if(null==g){g=[];for(var t in c){var e=c[t];Number(e.gemCost);!PlatformManager.checkIsShenHeYiWan()||"g7"!=t&&"g8"!=t||(e.sortId="g7"==t?9:10),e.sortId&&g.push(e)}g.sort(function(t,e){return t.sortId<e.sortId?1:-1})}return g}function r(t){for(var e in c){var i=c[e];if(i.id==t)return i}return null}function l(){var e=t.RechargeCfg.getRechargeItemCfgByKey("g9"),i="1_1_"+e.gemCost+"|"+e.getReward;return GameData.formatRewardItem(i)}function h(){var e=t.RechargeCfg.getRechargeItemCfgByKey("g10"),i="1_1_"+e.gemCost+"|"+e.getReward;return GameData.formatRewardItem(i)}var d={wanba:{QZ1:"星币",SQ1:"星币",QZ2:"星币",SQ2:"秀币"}};e.getMoneyName=a,e.wanbaCfg={g1:{pid1:21237,pid2:21229},g2:{pid1:21238,pid2:21230},g3:{pid1:21239,pid2:21231},g4:{pid1:21240,pid2:21232},g5:{pid1:21241,pid2:21233},g6:{pid1:21242,pid2:21234},g7:{pid1:21243,pid2:21235},g8:{pid1:21244,pid2:21236},g11:{pid1:25196,pid2:25197},g12:{pid1:25751,pid2:25755},g13:{pid1:25752,pid2:25756},g14:{pid1:25749,pid2:25753},g15:{pid1:25750,pid2:25754}},e.getAllProductid=n;var g,c={};e.formatData=o,e.getNormalRechargeCfg=s,e.getRechargeItemCfgByKey=r,e.rewardList1=l,e.rewardList2=h}(e=t.RechargeCfg||(t.RechargeCfg={}));var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(BaseItemCfg);t.RechargeItemCfg=i,__reflect(i.prototype,"Config.RechargeItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t,e){return LanguageManager.getlocal("itemName_"+a(t,e))}function i(t,e){return"itemicon"+a(t,e)}function a(t,e){"number"!=typeof t&&(t=ItemEnums[t]);var i;return i=Number(t)>0&&Number(t)<6?t:e?e:t,String(i)}function n(t,i){return LanguageManager.getlocal("resNotEnoughDesc",[e(t,i)])}t.getNameByTypeAndId=e,t.getIconByTypeAndId=i,t.getNotEnoughLocalTip=n}(e=t.RewardCfg||(t.RewardCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){a=t}function i(t){return t=App.StringUtil.firstCharToLower(t),a[t]}var a={};t.formatData=e,t.getSceneCfgBySceneName=i}(e=t.SceneCfg||(t.SceneCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(e){for(var i in e)t[i]=e[i]}function i(e){var i=0;if(t.gemCostList)for(var a in t.gemCostList)if(t.gemCostList[a].low<=e&&t.gemCostList[a].up>=e){i=t.gemCostList[a].gemCost;break}return i}t.formatData=e,t.getGemCostByLuck=i}(e=t.SearchbaseCfg||(t.SearchbaseCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(e){for(var i in e)"object"==typeof e[i]?"personList"==i?n(e[i]):"buildList"==i&&o(e[i]):t[i]=e[i]}function n(t){for(var e in t){var a=new i;a.initData(t[e]),a.personId=String(e),d[e]=a}}function o(t){for(var e in t){var i=new a;i.initData(t[e]),g[e]=i}}function s(){var t=Object.keys(d),e=t.length,i=Math.floor(Math.random()*e);return String(t[i])}function r(t){return d[t]}function l(t){var e=null;for(var i in d)if(e=d[i],String(t)==String(e.wifeId))return e;return null}function h(t){var e=[],i=null;for(var a in d)i=d[a],Number(t)==Number(i.build)&&e.push(i);return e}var d={},g={};t.formatData=e,t.getRandromPersonId=s,t.getPersonItemCfgByPersonId=r,t.getPersonItemCfgByWifeId=l,t.getPersonItemCfgListByBuildId=h}(e=t.SearchCfg||(t.SearchCfg={}));var i=function(e){function i(){return e.call(this)||this}return __extends(i,e),Object.defineProperty(i.prototype,"personFullIcon",{get:function(){var e;return e=2==this.type?t.WifeCfg.getWifeCfgById(this.wifeId).body:this.servantId?Api.servantVoApi.getFullImgPathWithId(this.servantId):"searchnpc_full"+this.personId},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fullIconSize",{get:function(){var t;return t=2==this.type?{width:640,height:840}:this.servantId?{width:405,height:467}:{width:405,height:467}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){var t;return t=2==this.type?"wifeName_"+this.wifeId:"searchPersonName"+this.personId,LanguageManager.getlocal(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"shortDesc",{get:function(){return LanguageManager.getlocal("searchPersonshortDesc"+this.personId)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"desc",{get:function(){return LanguageManager.getlocal("searchPersonDesc"+this.personId)},enumerable:!0,configurable:!0}),i}(BaseItemCfg);__reflect(i.prototype,"SearchPersonItemCfg");var a=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(BaseItemCfg);__reflect(a.prototype,"SearchBuildItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t)n.hasOwnProperty(String(e))||(n[String(e)]=new i),n[String(e)].initData(t[e]),n[String(e)].id=String(e)}function a(t){return n[String(t)]}var n={};t.formatData=e,t.getDialogueItemById=a}(e=t.DialogueCfg||(t.DialogueCfg={}));var i=function(e){function i(){return e.call(this)||this}return __extends(i,e),Object.defineProperty(i.prototype,"nameStr",{get:function(){switch(this.icon){case"0":return null;case"1":return LanguageManager.getlocal("dialogueNameYou");case"2":if("1"==this.targetType){var e=t.ServantCfg.getServantItemById(this.targetId);return e.name}if("2"==this.targetType){var i=t.WifeCfg.getWifeCfgById(this.targetId);return i.name}return console.log("DialogueCfg没有设置targetType"),null;default:return null}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fullIconStr",{get:function(){switch(this.icon){case"0":return null;case"1":return"user_body"+Api.playerVoApi.getPlayerLevel();case"2":if("1"==this.targetType){var e=t.ServantCfg.getServantItemById(this.targetId);return e.fullIcon}if("2"==this.targetType){var i=t.WifeCfg.getWifeCfgById(this.targetId);return i.body}return console.log("DialogueCfg没有设置targetType"),null;default:return null}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bgName",{get:function(){return"1"==this.background?"homescene":"2"==this.background?"searchbg1":"homescene"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dialogStr",{get:function(){return LanguageManager.getlocal("substitution"+this.id)},enumerable:!0,configurable:!0}),i}(BaseItemCfg);__reflect(i.prototype,"DialogueItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=void 0;n.hasOwnProperty(String(e))||(n[String(e)]=new i),a=n[String(e)],a.initData(t[e]),a.id=String(e)}}function a(t){return n[String(t)]}var n={};t.formatData=e,t.getServantItemById=a}(e=t.ServantCfg||(t.ServantCfg={}));var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return LanguageManager.getlocal("servant_name"+this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"desc",{get:function(){return LanguageManager.getlocal("servant_Desc"+this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dialogIds",{get:function(){if(this.dialogue){var t=this.dialogue.split("_");return t}return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullIcon",{get:function(){return"servant_full_"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"halfIcon",{get:function(){return"servant_half_"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sound",{get:function(){return"effect_servant_"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropDesc",{get:function(){return LanguageManager.getlocal("servantDropDesc_"+this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"qualityBoxImgPath",{get:function(){var t=GameConfig.config.servantCfg[this.id];return"servant_cardbg_"+t.quality},enumerable:!0,configurable:!0}),e}(BaseItemCfg);__reflect(i.prototype,"ServantItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(){return ResourceManager.getRes("shield_"+GameData.getCountry())}function i(t){var i=e();if(i&&t){if(i.indexOf(t)>-1||i.indexOf(t.replace(/\s/g,""))>-1)return App.CommonUtil.showTip(LanguageManager.getlocal("guideCreateUserError3")),!1;for(var a=i.length,n=0;a>n;n++)if(t.toLowerCase().indexOf(i[n].toLowerCase())>-1)return App.CommonUtil.showTip(LanguageManager.getlocal("guideCreateUserError3")),!1}return!0}function a(t){var i=e();return 0==t.replace(/\s/g,"").length?!0:i&&t&&i.indexOf(t)>-1?(App.CommonUtil.showTip(LanguageManager.getlocal("guideCreateUserError3")),!1):!0}t.getCfg=e,t.checkShield=i,t.checkOnlyShield=a}(e=t.ShieldCfg||(t.ShieldCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){o.hasOwnProperty(String(e))||(o[String(e)]={});var a=t[e];for(var n in a){var s=o[String(e)][n];s||(s=new i,o[String(e)][n]=s),s.initData(a[n]),s.id=Number(n)}}}function a(t,e){return o[e][String(t)]}function n(t,e){var i=new Array,a=e;for(var n in o[a])t==o[a][n].sheetType&&i.push(o[a][n]);return i}t.buyItemCheckVal=1e3;var o={};t.formatData=e,t.getShopItemCfgById=a,t.getShopItemCfgListByType=n}(e=t.ShopCfg||(t.ShopCfg={}));var i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.discount=0,t.preCost=0,t.shopGiftName=0,t}return __extends(i,e),Object.defineProperty(i.prototype,"name",{get:function(){if(this.shopGiftName>0)return LanguageManager.getlocal("shopGiftName"+this.shopGiftName);var t=String(this.id);return 3==this.sheetType&&(t=App.StringUtil.splitString(this.content,"_")[1]),LanguageManager.getlocal("itemName_"+t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"limitType",{get:function(){return this.limit[0]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"limitNum",{get:function(){return this.limit[1]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"limitNumDesc",{get:function(){return LanguageManager.getlocal("shopLimitBuy",[this.limitNum.toString()])},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"contentList",{get:function(){if(3==this.sheetType){var e=this.content,i=Api.acVoApi.getActivityVoListByAid("punish");if(i.length>0)for(var a in i){var n=i[a],o=n.code;if(o>1&&n.isDuringActive&&e.search("_180")){for(var s=t.AcCfg.getCfgByActivityIdAndCode("punish",o).changeReward,r=e.split("|"),l=0;l<r.length;l++){var h=r[l];if(h.search("_180")>0){var d=App.StringUtil.splitString(h,"_");Number(d[1]);s[d[1]]&&(d[1]=s[d[1]]),r[l]=d.join("_")}}e=r.join("|")}}return GameData.formatRewardItem(e)}return GameData.formatRewardItem(this.content)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"needVipDesc",{get:function(){return this.needVip>0?LanguageManager.getlocal("shopVipLimit",[this.needVip.toString()]):""},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"discountDesc",{get:function(){return LanguageManager.getlocal("discountTitle",[10*this.discount+""])},enumerable:!0,configurable:!0}),i}(BaseItemCfg);t.ShopItemCfg=i,__reflect(i.prototype,"Config.ShopItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(e){function i(e){for(var i in e){var a=new t.ShopItemCfg;a=e[i],o.push(a)}}function a(){return o}function n(t){for(var e=0;e<o.length;e++)if(o[e].sortId==t)return o[e]}var o=[];e.formatData=i,e.getNewShopArr=a,e.getnewShopItemCfgById=n}(e=t.ShopnewCfg||(t.ShopnewCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){s={},r=0;for(var e in t){var a=void 0;s.hasOwnProperty(String(e))||(s[String(e)]=new i),a=s[String(e)],a.initData(t[e]),a.id=String(e),r=Math.max(r,Number(e))}}function a(t){return s[t]}function n(){return s}function o(){return r}var s={},r=0;t.formatData=e,t.getStudyatkCfgById=a,t.getStudyatkList=n,t.getMaxLevel=o}(e=t.StudyatkCfg||(t.StudyatkCfg={}));var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);__reflect(i.prototype,"StudyatkItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=void 0;n.hasOwnProperty(String(e))||(n[String(e)]=new i),a=n[String(e)],a.initData(t[e]),a.taskId=String(e)}}function a(t){return n[t]}var n={};t.formatData=e,t.getTaskCfgByTaskId=a}(e=t.MaintaskCfg||(t.MaintaskCfg={}));var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemCfg);__reflect(i.prototype,"MaintaskItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){s=0;for(var e in t){var a=void 0;o.hasOwnProperty(String(e))||(o[String(e)]=new i),a=o[String(e)],a.initData(t[e]),a.tradeId=String(e),s++}}function a(t){return o[t]}function n(){return s}var o={},s=0;t.formatData=e,t.getTradeCfgById=a,t.getMaxTradeIndex=n}(e=t.TradeCfg||(t.TradeCfg={}));var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"tradeName",{get:function(){return LanguageManager.getlocal("tradeName"+this.tradeId)},enumerable:!0,configurable:!0}),e}(BaseItemCfg);t.TradeItemCfg=i,__reflect(i.prototype,"Config.TradeItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var i=void 0;a.hasOwnProperty(String(e))||(a[String(e)]=new n),i=a[String(e)],i.initData(t[e]),i.key=e,this.prisonItemCfg=i}}function i(){var t=new Array;for(var e in a)t.push(a[e]);return t.sort(function(t,e){return t.sortId>e.sortId?1:t.sortId==e.sortId?0:-1}),t}var a={};t.formatData=e,t.getUnlockItemCfgList=i;var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sortId=0,e.gameName=null,e.reward=null,e.key=null,e.butType=!0,e}return __extends(e,t),e}(BaseItemCfg);t.UnlocklistItemCfg=n,__reflect(n.prototype,"Config.UnlocklistCfg.UnlocklistItemCfg")}(e=t.UnlocklistCfg||(t.UnlocklistCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=void 0;l.hasOwnProperty(String(e))||(l[String(e)]=new i),a=l[String(e)],a.initData(t[e]),a.level=Number(e)}}function a(t){return l[String(t)]}function n(t){return r}function o(){if(!s){s=0;for(var t in l){var e=l[t];s<e.level&&(s=e.level)}}return s}var s,r,l={};t.formatData=e,t.getVipCfgByLevel=a,t.getvipLength=n,t.getMaxLevel=o}(e=t.VipCfg||(t.VipCfg={}));var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),Object.defineProperty(i.prototype,"icon",{get:function(){return"vip_icon_"+this.level},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"needGemLocalStr",{get:function(){return Api.acVoApi.getActivityVoByAidAndCode("discount","1")&&Api.acVoApi.getActivityVoByAidAndCode("discount","1").isStart?LanguageManager.getlocal("vipLevel_needGem_Desc_for_discount",[this.needGem.toString(),t.AcCfg.getCfgByActivityIdAndCode("discount",1).vipList[this.level].needGem.toString()]):LanguageManager.getlocal("vipLevel_needGem_Desc",[this.needGem.toString()])},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"birthRatioLocalStr",{get:function(){return LanguageManager.getlocal("vipLevel_birthRatio_Desc",[Math.round(100*this.birthRatio)+"%"])},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxStrengthLocalStr",{get:function(){return LanguageManager.getlocal("vipLevel_maxStrength_Desc",[this.maxStrength.toString()])},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxEnergyLocalStr",{get:function(){return LanguageManager.getlocal("vipLevel_maxEnergy_Desc",[this.maxEnergy.toString()])},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxVigourLocalStr",{get:function(){return LanguageManager.getlocal("vipLevel_maxVigour_Desc",[this.maxVigour.toString()])},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"searchLuckLocalStr",{get:function(){return LanguageManager.getlocal("searchLuck_Desc",[this.searchLuckFree.toString()])},enumerable:!0,configurable:!0}),i.prototype.dailyLuckLocalStr=function(t){return void 0===t&&(t=0),LanguageManager.getlocal("dailyLuck_Desc"+t,[this.dailyLuckNum.toString()])},Object.defineProperty(i.prototype,"localStr",{get:function(){var t="";if(this.needGem&&(t+=this.needGemLocalStr),Api.switchVoApi.checkAutoMopup()&&6==this.level&&(t+="\n"+LanguageManager.getlocal("challengeAutoFightUnlock")),this.birthRatio&&(t+=t?"\n"+this.birthRatioLocalStr:this.birthRatioLocalStr),this.maxStrength&&(t+=t?"\n"+this.maxStrengthLocalStr:this.maxStrengthLocalStr),this.maxEnergy&&(t+=t?"\n"+this.maxEnergyLocalStr:this.maxEnergyLocalStr),this.maxVigour&&(t+=t?"\n"+this.maxVigourLocalStr:this.maxVigourLocalStr),this.searchLuckFree&&(t+=t?"\n"+this.searchLuckLocalStr:this.searchLuckFree),Api.practiceVoApi.isPlayerPracticeEnable()){var e=GameConfig.config.practicebaseCfg.vip[this.level-1];t+="\n"+LanguageManager.getlocal("practice_vipAdd2",[""+e])}if(this.dailyLuckNum)for(var i=1;7>i;i++)t+=t?"\n"+this.dailyLuckLocalStr(i):this.dailyLuckNum;return t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"extraRewardVoList",{get:function(){return this._extraRewardList||this.reward&&(this._extraRewardList=GameData.formatRewardItem(this.reward)),this._extraRewardList},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"searchLuckFreeLocalStr",{get:function(){return LanguageManager.getlocal("searchLuckFreeChangeDesc",[String(this.level),String(this.searchLuckFree)])},enumerable:!0,configurable:!0}),i}(BaseItemCfg);t.VipItemCfg=i,__reflect(i.prototype,"Config.VipItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(e){for(var i in e)t[i]=e[i]}t.formatData=e}(e=t.WifebaseCfg||(t.WifebaseCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=void 0;s.hasOwnProperty(String(e))||(s[String(e)]=new i),a=s[String(e)],a.initData(t[e]),a.id=String(e)}}function a(t){return s[String(t)]}function n(){return s}function o(){return Object.keys(s).length}var s=[];t.formatData=e,t.getWifeCfgById=a,t.getWifeCfgList=n,t.getMaxLength=o}(e=t.WifeCfg||(t.WifeCfg={}));var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return LanguageManager.getlocal("wifeName_"+this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"desc",{get:function(){return LanguageManager.getlocal("wifeDesc_"+this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dialogIds",{get:function(){if(this.dialogue){var t=this.dialogue.split("_");return t}return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"words",{get:function(){var t=App.MathUtil.getRandom(1,4);return LanguageManager.getlocal("wifeWords_"+this.id+"_"+t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wifeunlock",{get:function(){if(this.unlock){if(this.unlock.needPower)return LanguageManager.getlocal("wifeUnlock_2",[this.unlock.needPower]);if(this.unlock.needVip)return LanguageManager.getlocal("wifeUnlock_3",[this.unlock.needVip]);if(this.unlock.needQQ)return LanguageManager.getlocal("wifeUnlock_4");if(this.unlock.needActive)return LanguageManager.getlocal("wifeUnlock_5")}return LanguageManager.getlocal("wifeUnlock_1")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bg",{get:function(){return"wifeview_bg1"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return"wife_half_"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return"211"==this.id&&null===Api.wifeVoApi.getWifeInfoVoById(211)&&0===Api.searchVoApi.getWifeValueById("73")||"212"==this.id&&null===Api.wifeVoApi.getWifeInfoVoById(212)&&0===Api.searchVoApi.getWifeValueById("24")?"wife_full3_"+this.id:"wife_full_"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"body2",{get:function(){return"wife_full2_"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sound",{get:function(){return"effect_wife_"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bone",{get:function(){return"wife_full_"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bone2",{get:function(){return"wife_full2_"+this.id},enumerable:!0,configurable:!0}),e}(BaseItemCfg);t.WifeItemCfg=i,__reflect(i.prototype,"Config.WifeItemCfg")
}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=void 0;s.hasOwnProperty(String(e))||(s[String(e)]=new i),a=s[String(e)],a.initData(t[e]),a.id=String(e)}}function a(t){return s[String(t)]}function n(){var t=new Array;for(var e in s){var i=s[e];t.push(i)}return t}function o(){return Object.keys(s).length}var s={};t.formatData=e,t.getWifeCfgById=a,t.getWifeCfgList=n,t.getMaxLength=o}(e=t.WifeskinCfg||(t.WifeskinCfg={}));var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return LanguageManager.getlocal("skinName"+this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"desc",{get:function(){return LanguageManager.getlocal("skinDesc"+this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"desc2",{get:function(){return LanguageManager.getlocal("skinDesc_"+this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropDesc",{get:function(){return LanguageManager.getlocal("skinDropDesc_"+this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"words",{get:function(){var t=App.MathUtil.getRandom(1,4);return LanguageManager.getlocal("wifeWords_"+this.id+"_"+t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return"wife_skinhalf_"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return"wife_skin_"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"body2",{get:function(){return"wife_skinfull2_"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bone",{get:function(){return"wife_full3_"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bone2",{get:function(){return"wife_full4_"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sound",{get:function(){return"effect_wifeskin_"+this.id},enumerable:!0,configurable:!0}),e}(BaseItemCfg);t.WifeSkinItemCfg=i,__reflect(i.prototype,"Config.WifeSkinItemCfg")}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(e){for(var i in e)t[i]=e[i]}t.formatData=e}(e=t.WifestatusbaseCfg||(t.WifestatusbaseCfg={}))}(Config||(Config={}));var Config;!function(t){var e;!function(t){function e(t){for(var e in t){var a=new i;a.initData(t[e]),a.id=String(e),s.push(a)}s.reverse(),egret.log("123")}function a(t){for(var e=0;e<s.length;e++){var i=s[e];if(i.id==t)return i}return null}function n(){return s}function o(){return Object.keys(s).length}var s=[];t.formatData=e,t.getWifestatusCfgByID=a,t.getWifestatusList=n,t.getMaxLength=o}(e=t.WifestatusCfg||(t.WifestatusCfg={}));var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(BaseItemCfg);t.WifestatusItemCfg=i,__reflect(i.prototype,"Config.WifestatusItemCfg")}(Config||(Config={}));var AchievementInfoVo=function(t){function e(){var e=t.call(this)||this;return e.stage=0,e.v=0,e.f=0,e}return __extends(e,t),e.prototype.initData=function(t){t&&(null!=t.stage&&(this.stage=Number(t.stage)),null!=t.v&&(this.v=Number(t.v)),null!=t.f&&(this.f=Number(t.f)))},Object.defineProperty(e.prototype,"name",{get:function(){return this.cfg.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this.cfg.acIcon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nameIcon",{get:function(){return this.cfg.nameIcon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.AchievementCfg.getAchievementCfgById(this.id.toString())},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.id=null,this.stage=0,this.v=0,this.f=0},e}(BaseVo);__reflect(AchievementInfoVo.prototype,"AchievementInfoVo");var AchievementVo=function(t){function e(){var e=t.call(this)||this;return e.achievementInfoVoObj=null,e}return __extends(e,t),e.prototype.initData=function(t){if(t.info&&(this.achievementInfoVoObj=null,t.info)){null==this.achievementInfoVoObj&&(this.achievementInfoVoObj={});for(var e in t.info)if(this.achievementInfoVoObj[e])this.achievementInfoVoObj[e].initData(t.info[e]);else{var i=new AchievementInfoVo;i.id=e,i.initData(t.info[e]),this.achievementInfoVoObj[e]=i}for(var e in this.achievementInfoVoObj)t.info[e]||delete this.achievementInfoVoObj[e]}},e.prototype.dispose=function(){if(this.achievementInfoVoObj)for(var t in this.achievementInfoVoObj)this.achievementInfoVoObj[t],this.achievementInfoVoObj[t].dispose(),this.achievementInfoVoObj[t]=null;this.achievementInfoVoObj=null},e}(BaseVo);__reflect(AchievementVo.prototype,"AchievementVo");var AchievementVoApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getAchievementInfoVoList=function(){var t=this.achievementVo.achievementInfoVoObj,e=new Array;for(var i in t)if(Api.switchVoApi.checkOpenShenhe()){var a=Config.AchievementCfg.getAchievementCfgById(i);a.isShieldWhenShenhe||e.push(t[i])}else e.push(t[i]);return e.sort(this.sortA),e},e.prototype.getAchGetNum=function(){for(var t=0,e=this.getAchievementInfoVoList(),i=0;i<e.length;i++){var a=e[i];1==a.f&&t++}return t},e.prototype.sortA=function(t,e){if(t.f==e.f){var i=Config.AchievementCfg.getAchievementCfgById(t.id),a=i.value[Api.achievementVoApi.getAchProById(t.id)],n=t.v/a;n>1&&(n=1);var o=Config.AchievementCfg.getAchievementCfgById(e.id),s=o.value[Api.achievementVoApi.getAchProById(e.id)],r=e.v/s;return r>1&&(r=1),n==r?t.cfg.sort-e.cfg.sort:r-n}var l,h;return l=1==t.f?3:0==t.f?2:1,h=1==e.f?3:0==e.f?2:1,h-l},e.prototype.getAchDetailList=function(t){for(var e=this,i=this.getAchievementInfoVoById(t).cfg,a=new Array,n=0;n<i.value.length;n++)a.push(n);var o=Api.achievementVoApi.getAchievementInfoVoById(t);o.stage,i.value[Api.achievementVoApi.getAchProById(t)];return a.sort(function(i,a){var n=e.getAchDetailState(t,i),o=e.getAchDetailState(t,a);return n==o?i-a:n-o}),a},e.prototype.getAchDetailState=function(t,e){var i=3,a=Api.achievementVoApi.getAchievementInfoVoById(t),n=Config.AchievementCfg.getAchievementCfgById(t);a.stage,n.value[Api.achievementVoApi.getAchProById(t)];return e<a.stage-1?i=4:n.value[e]>a.v?i=e==a.stage-1?2:3:e==a.stage-1?0==a.f?i=3:1==a.f?i=1:2==a.f&&(i=4):i=2,i},e.prototype.getAchDetailIndexVoById=function(t,e){for(var i=this.getAchDetailList(t),a=0;a<i.length;a++)if(e==i[a])return a;return 0},e.prototype.getAchDetailIndexVoById2=function(t,e,i){for(var a=0;a<i.length;a++)if(e==i[a])return a;return 0},e.prototype.getAchIndexVoById=function(t){for(var e=this.getAchievementInfoVoList(),i=0;i<e.length;i++)if(t==e[i].id)return i;return 0},e.prototype.getAchIndexVoById2=function(t,e){for(var i=0;i<e.length;i++)if(t==e[i].id)return i;return 0},e.prototype.getAchProById=function(t){var e=(Config.AchievementCfg.getAchievementCfgById(t),this.getAchievementInfoVoById(t));e.stage;return e.stage-1},e.prototype.getAchievementInfoVoById=function(t){if(this.achievementVo){var e=this.achievementVo.achievementInfoVoObj;if(e&&e[t])return e[t]}return null},e.prototype.dispose=function(){this.achievementVo=null,t.prototype.dispose.call(this)},e}(BaseVoApi);__reflect(AchievementVoApi.prototype,"AchievementVoApi");var DragProgressBar=function(t){function e(){var e=t.call(this)||this;return e._maxNum=1,e._curNum=1,e._minNum=1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this._dragIcon=BaseBitmap.create("public_dot1"),this._dragIcon.addTouch(this.dragTouchHandler,this),this._dragIcon.setPosition(this.progressBar.x-this._dragIcon.width/2,this.progressBar.y+(this.progressBar.height-this._dragIcon.height)/2),this.addChild(this._dragIcon),this._reduceBtn=ComponentManager.getButton("button_del1","",this.checkBtnHandler,this,[0]),this._reduceBtn.setPosition(-this._reduceBtn.width-12,this._progressBarBg.y+(this._progressBarBg.height-this._reduceBtn.height)/2),this.addChild(this._reduceBtn),this._addBtn=ComponentManager.getButton("button_add1","",this.checkBtnHandler,this,[1]),this._addBtn.setPosition(this._progressBarBg.width+12,this._progressBarBg.y+(this._progressBarBg.height-this._addBtn.height)/2),this.addChild(this._addBtn)},e.prototype.getReduceX=function(){return-this._reduceBtn.width-12},e.prototype.checkBtnHandler=function(t){var e;e=t?Math.min(this._maxNum,this._curNum+1):Math.max(this._minNum,this._curNum-1),this.setDragPercent(e,this._maxNum)},e.prototype.dragTouchHandler=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._startPoint?this._startPoint.setTo(t.stageX,t.stageY):this._startPoint=egret.Point.create(t.stageX,t.stageY);break;case egret.TouchEvent.TOUCH_MOVE:var e=t.stageX-this._startPoint.x,i=this.getDragCenterX()+e;i<this.progressBar.x+this._minNum*this.getEverSpace()&&(i=this.progressBar.x+this._minNum*this.getEverSpace()),i>this.progressBar.x+this.progressBar.width&&(i=this.progressBar.x+this.progressBar.width),this._startPoint.x+=i-this.getDragCenterX();var a=(i-this.progressBar.x)/this.progressBar.width;this.setDragPercent(a*this._maxNum,this._maxNum);break;default:egret.Point.release(this._startPoint),this._startPoint=null}},e.prototype.getEverSpace=function(){return this.progressBar.width/this._maxNum},e.prototype.getDragCenterX=function(){return this._dragIcon.x+this._dragIcon.width/2},e.prototype.setDragPercent=function(t,e,i){if(void 0===i&&(i=1),this._minNum=i,this._maxNum=e,this.setPercentage(t/e,null,null),this._dragIcon.setPosition(this.progressBar.x+this.progressBar.width*(t/e)-this._dragIcon.width/2,this._dragIcon.y),t=Math.floor(t),t>=0&&e>=t&&t!=this._curNum&&(this._curNum=t,this._callback)){var a=[this._curNum];this._callbackParams&&(a=a.concat(this._callbackParams)),this._callback.apply(this._callbackThisObj,a)}},e.prototype.setCallBack=function(t,e,i){this._callback=t,this._callbackThisObj=e,this._callbackParams=i},e.prototype.dispose=function(){this._dragIcon=null,this._callback=null,this._callbackThisObj=null,this._callbackParams=null,this._curNum=void 0,this._maxNum=void 0,t.prototype.dispose.call(this)},e}(ProgressBar);__reflect(DragProgressBar.prototype,"DragProgressBar");var AcCarnivalChargeVo=function(t){function e(){var e=t.call(this)||this;return e.flags={},e}return __extends(e,t),e.prototype.initData=function(t){var e=0,i=0;this.v&&(e=this.v),t.v&&(i=Number(t.v));for(var a in t)this[a]=t[a];e!=i&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_ACCARNIVAL_CHANGE_CHARGE)},Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){var t=Api.acVoApi.getActivityVoByAidAndCode("carnivalCharge"),e=Config.AcCfg.getCfgByActivityIdAndCode("carnivalCharge",t.code);if(!e)return!1;var i=e.getList();for(var a in i)if(!this.flags[a]&&i[a].needGem<=this.v&&(Api.switchVoApi.checkSpecialChargeReward()?!0:!(1==i[a].isSpecial)))return!0;return!1},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.v=0,this.flags={}},e}(AcBaseVo);__reflect(AcCarnivalChargeVo.prototype,"AcCarnivalChargeVo");var AcCarnivalCostVo=function(t){function e(){var e=t.call(this)||this;return e.flags={},e}return __extends(e,t),e.prototype.initData=function(t){var e=0,i=0;this.v&&(e=this.v),t.v&&(i=Number(t.v));for(var a in t)this[a]=t[a];e!=i&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_ACCARNIVAL_CHANGE_COST)},Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){var t=Api.acVoApi.getActivityVoByAidAndCode("carnivalCost"),e=Config.AcCfg.getCfgByActivityIdAndCode("carnivalCost",t.code);if(!e)return!1;var i=e.getList();for(var a in i)if(!this.flags[a]&&i[a].needGem<=this.v&&(Api.switchVoApi.checkSpecialChargeReward()?!0:!(1==i[a].isSpecial)))return!0},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.v=0,this.flags={}},e}(AcBaseVo);__reflect(AcCarnivalCostVo.prototype,"AcCarnivalCostVo");var AcCrossServerAtkRaceVo=function(t){function e(){var e=t.call(this)||this;return e.info=null,e}return __extends(e,t),e.prototype.initData=function(t){for(var e in t)this[e]=t[e]},Object.defineProperty(e.prototype,"acTimeAndHour",{get:function(){var t=this.et-86400;return App.DateUtil.getOpenLocalTime(this.st,t,!0)},enumerable:!0,configurable:!0}),e.prototype.getPreward=function(){return this.info.preward},e.prototype.getZonereward=function(){return this.info.zonereward},e.prototype.dispose=function(){this.info=null,t.prototype.dispose.call(this)},e}(AcBaseVo);__reflect(AcCrossServerAtkRaceVo.prototype,"AcCrossServerAtkRaceVo");var AcCrossServerIntimacyVo=function(t){function e(){var e=t.call(this)||this;return e.info=null,e}return __extends(e,t),e.prototype.initData=function(t){for(var e in t)this[e]=t[e]},Object.defineProperty(e.prototype,"acTimeAndHour",{get:function(){var t=this.et-86400;return App.DateUtil.getOpenLocalTime(this.st+7200,t,!0)},enumerable:!0,configurable:!0}),e.prototype.isGetPreward=function(){return 1==this.info.preward},e.prototype.isGettZonereward=function(){return 1==this.info.zonereward},e.prototype.getCurPoints=function(){return Number(this.info.v)},e.prototype.getIsCanJoin=function(){return this.info.iscanjoin},e.prototype.judgeTimeProcess=function(){var t=7200,e=86400,i=0;return GameData.serverTime<this.st?i=0:GameData.serverTime>=this.st&&GameData.serverTime<this.st+t?i=1:GameData.serverTime>=this.st+t&&GameData.serverTime<this.et-e?i=2:GameData.serverTime>=this.et-e&&GameData.serverTime<this.et?i=3:GameData.serverTime>=this.et&&(i=4),i},e.prototype.getCountTimeStr=function(t){var e=t;return 0>e&&(e=0),App.DateUtil.getFormatBySecond(e)},e.prototype.dispose=function(){this.info=null,t.prototype.dispose.call(this)},e}(AcBaseVo);__reflect(AcCrossServerIntimacyVo.prototype,"AcCrossServerIntimacyVo");var AcDailyChargeVo=function(t){function e(){var e=t.call(this)||this;return e.v=0,e.flags={},e}return __extends(e,t),e.prototype.initData=function(t){this.v;for(var e in t)this[e]=t[e];App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_DAILYCHARGE_REFRESH_V)},Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){var t=Api.acVoApi.getActivityVoByAidAndCode("dailyCharge"),e=Config.AcCfg.getCfgByActivityIdAndCode("dailyCharge",t.code);if(!e)return!1;var i=0,a=e.getList();for(var n in a){var o=a[n];if(o.isSpecial&&1==o.isSpecial){if(Api.switchVoApi.checkSpecialChargeReward()&&!this.flags[n]&&this.v>=a[n].needGem)return!0}else if(i=o.needGem,!this.flags[n]&&a[n].needGem<=this.v)return!0}return!1},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.v=0,this.flags={}},e}(AcBaseVo);__reflect(AcDailyChargeVo.prototype,"AcDailyChargeVo");var AcDiscountVo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initData=function(t){for(var e in t)this[e]=t[e]},Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.v=0},e}(AcBaseVo);__reflect(AcDiscountVo.prototype,"AcDiscountVo");var AcFourPeopleVo=function(t){function e(){var e=t.call(this)||this;return e.getServant=0,e.getWife=0,e.needItem=0,e.needNum=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){var t=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code);if(!t)return!1;for(var e=t.getPeopleList(),i=!1,a=0;a<e.length;a++){var n=e[a],o=Api.itemVoApi.getItemNumInfoVoById(n.needItem),s=Api.servantVoApi.getServantObj(n.getServant);if(!s)return i=o>=n.needNum?!0:!1;i=!1}},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.getServant=0,this.getWife=0,this.needItem=0,this.needNum=0},e}(AcBaseVo);__reflect(AcFourPeopleVo.prototype,"AcFourPeopleVo");var AcLimitedRewardInfoVo=function(t){function e(){var e=t.call(this)||this;return e.type=0,e.id=0,e.condition=0,e.reward="",e.aid="",e.code=0,e}return __extends(e,t),e.prototype.initData=function(t){},Object.defineProperty(e.prototype,"getTitleStr",{get:function(){return LanguageManager.getlocal("ac"+App.StringUtil.firstCharToUper(this.aid+"-"+this.type)+"_Title")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.type=0,this.id=0,this.condition=0,this.reward="",this.aid="",this.code=0},e}(BaseVo);__reflect(AcLimitedRewardInfoVo.prototype,"AcLimitedRewardInfoVo");var AcLimitedRewardVo=function(t){function e(){var e=t.call(this)||this;return e.red=!1,e.limitedRewardInfoVoList=[],e}return __extends(e,t),e.prototype.getLimitedRewardInfoVoList=function(){if(0==this.limitedRewardInfoVoList.length)for(var t in this.config.value)if(this.config.value[t]&&this.config.reward[t]){var e=new AcLimitedRewardInfoVo;e.id=Number(t),e.aid=this.aid,e.code=this.code,e.type=this.config.type,e.condition=Number(this.config.value[t]),e.reward=String(this.config.reward[t]),this.limitedRewardInfoVoList.push(e)}return this.limitedRewardInfoVoList},e.prototype.getFlagByIdAndCondition=function(t,e){return this.flags&&this.flags[t]?this.flags[t]:this.v<e?2:0},e.prototype.getMaxGrade=function(){var t=0;for(var e in this.flags)1==Number(this.flags[e])&&t+1==Number(e)&&(t=Number(e));return t},Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){return this.red},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){var t=GameConfig.config.limitedrewardbaseCfg[this.atype];return t.icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getTitleStr",{get:function(){return LanguageManager.getlocal("ac"+App.StringUtil.firstCharToUper(this.aid+"-"+this.atype)+"_Title")},enumerable:!0,configurable:!0}),e}(AcBaseVo);__reflect(AcLimitedRewardVo.prototype,"AcLimitedRewardVo");var AcMayDayVo=function(t){function e(){var e=t.call(this)||this;return e.ainfo=null,e.binfo=null,e.cinfo=null,e.cinfoTask=0,e.cinfoFlag=null,e.isfree=!1,e}return __extends(e,t),e.prototype.initData=function(t){for(var e in t)this[e]=t[e];this.isfree=t.isfree,t.ainfo&&(this.ainfo=t.ainfo),t.binfo&&(this.binfo=t.binfo),t.cinfo&&(this.cinfo=t.cinfo,t.cinfo.task&&(this.cinfoTask=t.cinfo.task),t.cinfo.flags&&(this.cinfoFlag=t.cinfo.flags)),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_MAYDAY_FRESH_ITEM)},e.prototype.getTurnTotal=function(){return this.ainfo.v},e.prototype.getChargeNum=function(){return Number(this.binfo.v)},e.prototype.getTask=function(t){return this.cinfoTask[t]?this.cinfoTask[t]:0},e.prototype.isGetTaskReward=function(t){return this.cinfoFlag[t]&&1==this.cinfoFlag[t]?!0:!1},e.prototype.isGetTurnProgress=function(t){if(this.ainfo&&this.ainfo.flags){for(var e in this.ainfo.flags)if(1==this.ainfo.flags[t])return!0;return!1}},e.prototype.isGetRecharge=function(t){if(this.binfo&&this.binfo.flags){for(var e in this.binfo.flags)if(1==this.binfo.flags[t])return!0;return!1}},Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code)},enumerable:!0,configurable:!0}),e.prototype.getpublicRedhot1=function(){var t=this.cfg,e=this.getTurnTotal();for(var i in t.lotteryNum){var a=t.lotteryNum[i];if(e>=a.needNum&&0==this.isGetTurnProgress(Number(i)+1))return!0}return this.isfree?!0:!1},e.prototype.getpublicRedhot2=function(){var t=this.cfg,e=this.getChargeNum();for(var i in t.recharge){var a=t.recharge[i];if(e>=a.needGem&&0==this.isGetRecharge(Number(i)+1))return!0}return!1},e.prototype.getpublicRedhot3=function(){for(var t=this.cfg,e=0;e<t.task.length;e++){var i=t.task[e],a=this.getTask(i.questType),n=this.isGetTaskReward(e+1);if(a>=i.value&&0==n)return!0}return!1},Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){return this.getpublicRedhot1()?!0:this.getpublicRedhot2()?!0:this.getpublicRedhot3()?!0:!1},enumerable:!0,configurable:!0}),e.prototype.isFree=function(){return this.isfree},Object.defineProperty(e.prototype,"acTimeAndHour",{get:function(){var t=this.et-86400;return App.DateUtil.getOpenLocalTime(this.st,t,!0)},enumerable:!0,configurable:!0}),e.prototype.getArr=function(t){var e=[],i=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code);if(!i)return[];var a=i;for(var n in a)if(n==t)for(var o in a[n])if(a[n][o]){var s=a[n][o];(s.needGem||s.questType||s.discount||s.limit)&&(a[n][o].key=Number(o)+1,a[n][o].key&&e.push(a[n][o]))}return e},e.prototype.dispose=function(){this.ainfo=null,this.binfo=null,this.cinfo=null,this.cinfoFlag=null},e}(AcBaseVo);__reflect(AcMayDayVo.prototype,"AcMayDayVo");var AcNewYearVo=function(t){function e(){var e=t.call(this)||this;return e.taskinfo=null,e.scoreinfo=null,e.diffday=0,e.score=0,e}return __extends(e,t),e.prototype.initData=function(t){for(var e in t)this[e]=t[e];t.taskinfo&&(this.taskinfo=t.taskinfo),t.scoreinfo&&(this.scoreinfo=t.scoreinfo),t.diffday&&(this.diffday=t.diffday),t.taskinfo.dayFlag&&1==t.taskinfo.dayFlag&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_RESFESH_NEWYEAR_LIST),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_RESFESH_NEWYEAR_ITEM)},Object.defineProperty(e.prototype,"acTimeAndHour",{get:function(){var t=this.et-86400;return App.DateUtil.getOpenLocalTime(this.st,t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){return this.taskinfo&&this.taskinfo.dayFlag&&1==this.taskinfo.dayFlag?!0:!1},enumerable:!0,configurable:!0}),e.prototype.getScore=function(){return this.scoreinfo.score},e.prototype.getBtnType=function(t){return void 0===t&&(t=0),this.scoreinfo.info?this.scoreinfo.info[t]&&1==this.scoreinfo.info[t]?!0:!1:void 0},e.prototype.getIdflag=function(t){return void 0===t&&(t=0),this.taskinfo.info[t]?this.taskinfo.info[t].flag:void 0},e.prototype.getTaskLength=function(){var t=[];for(var e in this.taskinfo.info)2==this.taskinfo.info[e].flag&&t.push(this.taskinfo.info[e]);return t.length},e.prototype.dispose=function(){this.taskinfo=null,this.scoreinfo=null,this.diffday=0,this.score=0},e}(AcBaseVo);__reflect(AcNewYearVo.prototype,"AcNewYearVo");var AcPunishVo=function(t){function e(){var e=t.call(this)||this;return e.score=0,e.v=0,e.get=!1,e}return __extends(e,t),e.prototype.initData=function(t){for(var e in t)this[e]=t[e];null!=t.item&&(this.item=t.item),null!=t.shop&&(this.shop=t.shop),null!=t.score&&(this.score=t.score),null!=t.get&&(this.get=t.get),null!=t.v&&(this.v=t.v)},Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDuringActive",{get:function(){if(this.isStart){var t=this.et;if(this.config&&this.config.extraTime&&(t=this.et-86400*this.config.extraTime),t>=GameData.serverTime)return!0}return!1},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.item=null,this.shop=null,this.score=0,this.v=0,this.get=!1},e}(AcBaseVo);__reflect(AcPunishVo.prototype,"AcPunishVo");var AcRankActiveVo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(AcBaseVo);__reflect(AcRankActiveVo.prototype,"AcRankActiveVo");var AcRankInfoVo=function(t){function e(){var e=t.call(this)||this;return e.activeId="",e.myrank=null,e.rankList=null,e}return __extends(e,t),e.prototype.initData=function(t){t.activeId&&(this.activeId=t.activeId),t.myrank&&(this.myrank=t.myrank),t.rankList&&(this.rankList=t.rankList)},e.prototype.getTitleStr=function(){return this.activeId.indexOf("limitedreward")?"userProgressTitle":""},e.prototype.getProgressTitle=function(){return this.activeId.indexOf("limitedreward")?LanguageManager.getlocal("limitedTitle",[this.getProgressDesc()]):""},e.prototype.getProgressDesc=function(){return this.activeId.indexOf("limitedreward")?LanguageManager.getlocal("ac"+App.StringUtil.firstCharToUper(this.activeId)+"_Title"):""},e.prototype.dispose=function(){this.activeId="",this.myrank=null,this.rankList=null},e}(BaseVo);__reflect(AcRankInfoVo.prototype,"AcRankInfoVo");var AcRankVo=function(t){function e(){var e=t.call(this)||this;return e.acRankInfoVoObj={},e}return __extends(e,t),e.prototype.initData=function(t){if(null==this.acRankInfoVoObj&&(this.acRankInfoVoObj={}),t.activeId)if(this.acRankInfoVoObj[t.activeId])this.acRankInfoVoObj[t.activeId].initData(t);else{var e=new AcRankInfoVo;e.initData(t),this.acRankInfoVoObj[t.activeId]=e}},e.prototype.dispose=function(){this.acRankInfoVoObj=null},e}(BaseVo);__reflect(AcRankVo.prototype,"AcRankVo");var AcSpringCelebrateVo=function(t){function e(){var e=t.call(this)||this;return e.ainfo=null,e.bininfo=null,e.cinfo=null,e.dinfo=null,e.cinfoTask=0,e.cinfoReward=null,e}return __extends(e,t),e.prototype.initData=function(t){for(var e in t)this[e]=t[e];t.ainfo&&(this.ainfo=t.ainfo),t.binfo&&(this.bininfo=t.binfo),t.cinfo&&(this.cinfo=t.cinfo,t.cinfo.task&&(this.cinfoTask=t.cinfo.task),t.cinfo.reward&&(this.cinfoReward=t.cinfo.reward)),t.dinfo&&(this.dinfo=t.dinfo),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_RESFESH_SPRING_ITEM)},e.prototype.getAinfoV=function(){return this.ainfo.v},e.prototype.getTask=function(t){return this.cinfoTask[t]?this.cinfoTask[t]:0},e.prototype.isGetRecharge=function(t){return this.cinfoReward[t]&&1==this.cinfoReward[t]?!0:!1},e.prototype.getReceiveType=function(t){if(this.ainfo&&this.ainfo.reward){for(var e in this.ainfo.reward)if(1==this.ainfo.reward[t])return!1;return!0}},e.prototype.getExchangeNum=function(t){return this.bininfo&&this.bininfo[t]?this.bininfo[t]:0},e.prototype.getExchange4Num=function(t){return this.dinfo&&this.dinfo[t]?this.dinfo[t]:0},e.prototype.getpublicRedhot1=function(){for(var t=this.getArr("recharge"),e=0;e<t.length;e++){var i=Number(t[e].key);if(1==this.getReceiveType(i)&&this.getAinfoV()>=t[e].needGem)return!0}return!1},e.prototype.getpublicRedhot2=function(){for(var t=this.getArr("exchange"),e=0;e<t.length;e++){var i=this.getExchangeNum(t[e].key);if(i!=t[e].limit){var a=Api.itemVoApi.getItemNumInfoVoById(t[e].needItem);if(a>=t[e].needNum)return!0}}return!1},e.prototype.getpublicRedhot3=function(){for(var t=this.getArr("task"),e=0;e<t.length;e++){var i=this.getTask(t[e].questType),a=this.isGetRecharge(t[e].key);if(i>=t[e].value&&0==a)return!0}return!1},Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){return this.getpublicRedhot1()?!0:this.getpublicRedhot2()?!0:this.getpublicRedhot3()?!0:!1},enumerable:!0,configurable:!0}),e.prototype.isExchange=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE);return GameData.serverTime>t.et-86400?!0:!1},Object.defineProperty(e.prototype,"acTimeAndHour",{get:function(){var t=this.et-86400;return App.DateUtil.getOpenLocalTime(this.st,t,!0)},enumerable:!0,configurable:!0}),e.prototype.getArr=function(t){var e=[],i=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code);if(!i)return[];for(var a=i.getItemListCfg2(),n=0;n<a.length;n++)if(a[n].key==t)for(var o in a[n])if(a[n][o]){var s=a[n][o];(s.needGem||s.questType||s.discount||s.limit)&&(a[n][o].key=Number(o)+1,a[n][o].key&&e.push(a[n][o]))}return e},e.prototype.dispose=function(){this.ainfo=null,this.bininfo=null,this.cinfo=null,this.dinfo=null},e}(AcBaseVo);__reflect(AcSpringCelebrateVo.prototype,"AcSpringCelebrateVo");var AcTailorVo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initData=function(t){for(var e in t)this[e]=t[e]},Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.getFreeNum=function(){return this.freeNum},e.prototype.dispose=function(){this.v=0},e}(AcBaseVo);__reflect(AcTailorVo.prototype,"AcTailorVo");var AcTotalDayRechargeVo=function(t){function e(){var e=t.call(this)||this;return e.v=0,e.flags={},e}return __extends(e,t),e.prototype.initData=function(t){this.v;for(var e in t)this[e]=t[e];App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_DAILYCHARGE_REFRESH_V)},Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){var t=Api.acVoApi.getActivityVoByAidAndCode("totalDayRecharge"),e=Config.AcCfg.getCfgByActivityIdAndCode("totalDayRecharge",t.code);if(!e)return!1;var i=e.getList(),a=0;for(var n in i){var o=i[n];if(o.isSpecial&&1==o.isSpecial){if(Api.switchVoApi.checkSpecialChargeReward()&&!this.flags[n]&&this.v>=i[n].needGem)return!0}else if(a=o.needDay,!this.flags[n]&&i[n].needDay<=this.v)return!0}return!1},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.v=0,this.flags={}},e}(AcBaseVo);__reflect(AcTotalDayRechargeVo.prototype,"AcTotalDayRechargeVo");var AcTotalRechargeVo=function(t){function e(){var e=t.call(this)||this;return e.v=0,e.flags={},e}return __extends(e,t),e.prototype.initData=function(t){this.v;for(var e in t)this[e]=t[e];App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_DAILYCHARGE_REFRESH_V)},Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){var t=Api.acVoApi.getActivityVoByAidAndCode("totalRecharge"),e=Config.AcCfg.getCfgByActivityIdAndCode("totalRecharge",t.code);if(!e)return!1;var i=0,a=e.getList();for(var n in a){var o=a[n];if(o.isSpecial&&1==o.isSpecial){if(Api.switchVoApi.checkSpecialChargeReward()&&!this.flags[n]&&this.v>=a[n].needGem)return!0}else if(i=o.needGem,!this.flags[n]&&a[n].needGem<=this.v)return!0}return!1},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.v=0,this.flags={}},e}(AcBaseVo);__reflect(AcTotalRechargeVo.prototype,"AcTotalRechargeVo");var AcVipShopVo=function(t){function e(){var e=t.call(this)||this;return e.shop=null,e}return __extends(e,t),e.prototype.initData=function(t){for(var e in t)this[e]=t[e];null!=t.shop&&(this.shop=t.shop)},e.prototype.dispose=function(){this.shop=null},e}(AcBaseVo);__reflect(AcVipShopVo.prototype,"AcVipShopVo");var AcWifeComeVo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initData=function(t){var e=this.v,i=this.get;for(var a in t)this[a]=t[a];1==this.get&&Api.acVoApi.setActiveUnlock(1),(e!=this.v||i!=this.get)&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_ACWIFECOME_VOCHANGE)},Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){var t=Api.acVoApi.getActivityVoByAidAndCode("wifeCome"),e=Config.AcCfg.getCfgByActivityIdAndCode("wifeCome",t.code);return 0==t.get&&t.v>=e.need?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isStart",{get:function(){return this.st<=GameData.serverTime&&this.et>GameData.serverTime&&0==this.get?!0:!1},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.v=0,this.get=0},e}(AcBaseVo);__reflect(AcWifeComeVo.prototype,"AcWifeComeVo");var AcWishTreeVo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initData=function(t){var e=!1;1==this.discount&&0==t.discount&&(e=!0);for(var i in t)this[i]=t[i];e&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_WISHTRER_NEXTDAY)},Object.defineProperty(e.prototype,"isShowRedDot",{get:function(){var t=Api.itemVoApi.getItemNumInfoVoById("2102");if(t>0){var e=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code),i=e.getLastWishTimes();if(i>0)return!0}return!1},enumerable:!0,configurable:!0}),e.prototype.getDiscount=function(){return this.discount},e}(AcBaseVo);__reflect(AcWishTreeVo.prototype,"AcWishTreeVo");var AdultAttrVo=function(t){function e(){var e=t.call(this)||this;return e.forceTotal=0,e.brainsTotal=0,e.politicsTotal=0,e.charmTotal=0,e.attTotal=0,e}return __extends(e,t),e.prototype.initData=function(t){t&&t&&(this.forceTotal=Number(t[0]),this.brainsTotal=Number(t[1]),this.politicsTotal=Number(t[2]),this.charmTotal=Number(t[3]),this.attTotal=this.forceTotal+this.brainsTotal+this.politicsTotal+this.charmTotal)},e.prototype.dispose=function(){this.forceTotal=0,this.brainsTotal=0,this.politicsTotal=0,this.charmTotal=0},e}(BaseVo);__reflect(AdultAttrVo.prototype,"AdultAttrVo");var AdultInfoVo=function(t){function e(){var e=t.call(this)||this;return e.id="",e.motherId=0,e.name="",e.level=0,e.sex=0,e.quality=0,e.aquality=0,e.ts=0,e}return __extends(e,t),e.prototype.initData=function(t){t&&(t.mother&&(this.motherId=Number(t.mother)),t.name&&(this.name=String(t.name)),t.vigour&&(this.vigour=t.vigour),t.lv&&(this.level=Number(t.lv)),t.sex&&(this.sex=Number(t.sex)),t.quality&&(this.quality=Number(t.quality)),t.aquality&&(this.aquality=Number(t.aquality)),null==this.attrVo&&(this.attrVo=new AdultAttrVo),t.attr&&this.attrVo.initData(t.attr),t.pro&&(this.pro=t.pro),t.ts&&(this.ts=t.ts))
},e.prototype.dispose=function(){this.id="",this.motherId=0,this.name="",this.vigour=0,this.level=0,this.sex=0,this.quality=0,this.attrVo&&(this.attrVo.dispose(),this.attrVo=null)},e}(BaseVo);__reflect(AdultInfoVo.prototype,"AdultInfoVo");var AdultMarryInfoVo=function(t){function e(){var e=t.call(this)||this;return e.id="",e.motherId=0,e.name="",e.level=0,e.sex=0,e.quality=0,e.aquality=0,e.total=0,e.ftotal=0,e.fname="",e.funame="",e.fuid=0,e.fattr=0,e.mts=0,e}return __extends(e,t),e.prototype.initData=function(t){t&&(t.mother&&(this.motherId=Number(t.mother)),t.name&&(this.name=String(t.name)),t.vigour&&(this.vigour=t.vigour),t.lv&&(this.level=Number(t.lv)),t.sex&&(this.sex=Number(t.sex)),t.quality&&(this.quality=Number(t.quality)),t.aquality&&(this.aquality=Number(t.aquality)),null==this.attrVo&&(this.attrVo=new AdultAttrVo),t.attr&&this.attrVo.initData(t.attr),t.pro&&(this.pro=t.pro),t.total&&(this.total=t.total),t.ftotal&&(this.ftotal=t.ftotal),t.fname&&(this.fname=t.fname),t.funame&&(this.funame=t.funame),t.funame&&(this.funame=t.funame),t.fattr&&(this.fattr=t.fattr),t.mts&&(this.mts=t.mts))},e.prototype.dispose=function(){this.id="",this.motherId=0,this.name="",this.vigour=0,this.level=0,this.sex=0,this.quality=0,this.attrVo&&(this.attrVo.dispose(),this.attrVo=null)},e}(BaseVo);__reflect(AdultMarryInfoVo.prototype,"AdultMarryInfoVo");var AdultMarryVo=function(t){function e(){var e=t.call(this)||this;return e.posnum=0,e.adultInfoVoObj=null,e}return __extends(e,t),e.prototype.initData=function(t){if(t&&(this.adultInfoVoObj=null,t.posnum&&(this.posnum=Number(t.posnum)),t)){null==this.adultInfoVoObj&&(this.adultInfoVoObj={});for(var e in t)if(this.adultInfoVoObj[e])this.adultInfoVoObj[e].initData(t[e]);else{var i=new AdultMarryInfoVo;i.id=e,i.initData(t[e]),this.adultInfoVoObj[e]=i}for(var e in this.adultInfoVoObj)t[e]||delete this.adultInfoVoObj[e]}},e.prototype.dispose=function(){if(this.adultInfoVoObj)for(var t in this.adultInfoVoObj)this.adultInfoVoObj[t],this.adultInfoVoObj[t].dispose(),this.adultInfoVoObj[t]=null;this.posnum=0,this.adultInfoVoObj=null},e}(BaseVo);__reflect(AdultMarryVo.prototype,"AdultMarryVo");var AdultVo=function(t){function e(){var e=t.call(this)||this;return e.posnum=0,e.adultInfoVoObj=null,e}return __extends(e,t),e.prototype.initData=function(t){if(t&&(this.adultInfoVoObj=null,t.posnum&&(this.posnum=Number(t.posnum)),t)){null==this.adultInfoVoObj&&(this.adultInfoVoObj={});for(var e in t)if(this.adultInfoVoObj[e])this.adultInfoVoObj[e].initData(t[e]);else{var i=new AdultInfoVo;i.id=e,i.initData(t[e]),this.adultInfoVoObj[e]=i}for(var e in this.adultInfoVoObj)t[e]||delete this.adultInfoVoObj[e]}},e.prototype.dispose=function(){if(this.adultInfoVoObj)for(var t in this.adultInfoVoObj)this.adultInfoVoObj[t],this.adultInfoVoObj[t].dispose(),this.adultInfoVoObj[t]=null;this.posnum=0,this.adultInfoVoObj=null},e}(BaseVo);__reflect(AdultVo.prototype,"AdultVo");var AllianceMemberInfoVo=function(t){function e(){var e=t.call(this)||this;return e.id="",e.name="",e.pic=0,e.level=0,e.ctv=0,e.tctv=0,e.po=0,e.logindt=0,e.power=0,e.uid=0,e.donate="0",e}return __extends(e,t),e.prototype.initData=function(t){t&&(t.name&&(this.name=String(t.name)),t.pic&&(this.pic=t.pic),t.level&&(this.level=t.level),t.tctv&&(this.tctv=Number(t.tctv)),t.ctv&&(this.ctv=Number(t.ctv)),t.po&&(this.po=Number(t.po)),t.logindt&&(this.logindt=Number(t.logindt)),t.power&&(this.power=Number(t.power)),t.uid&&(this.uid=Number(t.uid)),t.donate&&(this.donate=String(t.donate)))},e.prototype.dispose=function(){this.id="",this.name="",this.pic=0,this.level=0,this.tctv=0,this.po=0,this.logindt=0,this.power=0,this.uid=0,this.donate="0"},e}(BaseVo);__reflect(AllianceMemberInfoVo.prototype,"AllianceMemberInfoVo");var AllianceMemberVo=function(t){function e(){var e=t.call(this)||this;return e.memberInfoVoObj=null,e}return __extends(e,t),e.prototype.initData=function(t){if(t&&(this.memberInfoVoObj=null,t)){null==this.memberInfoVoObj&&(this.memberInfoVoObj={});for(var e in t)if(this.memberInfoVoObj[e])this.memberInfoVoObj[e].initData(t[e]);else{var i=new AllianceMemberInfoVo;i.id=e,i.initData(t[e]),this.memberInfoVoObj[e]=i}for(var e in this.memberInfoVoObj)t[e]||delete this.memberInfoVoObj[e]}},e.prototype.dispose=function(){if(this.memberInfoVoObj)for(var t in this.memberInfoVoObj)this.memberInfoVoObj[t],this.memberInfoVoObj[t].dispose(),this.memberInfoVoObj[t]=null},e}(BaseVo);__reflect(AllianceMemberVo.prototype,"AllianceMemberVo");var AllianceVo=function(t){function e(){var e=t.call(this)||this;return e.id=0,e.creator=0,e.creatorname="",e.exp=0,e.list=null,e.mn=0,e.maxmn=0,e.name=null,e.wealth=null,e.cqq=null,e.pswd=null,e.cweixin=null,e.level=0,e.intro=null,e.message=null,e.log=null,e.affect=0,e["switch"]=null,e.position=null,e.lastday=null,e.updated_at=null,e.info=null,e.apply=null,e.boss=null,e}return __extends(e,t),e.prototype.initData=function(t){t&&(null!=t.id&&(this.id=Number(t.id)),null!=t.creator&&(this.creator=Number(t.creator)),null!=t.creatorname&&(this.creatorname=String(t.creatorname)),null!=t.exp&&(this.exp=t.exp),null!=t.list&&(this.list=t.list),null!=t.mn&&(this.mn=t.mn),null!=t.maxmn&&(this.maxmn=t.maxmn),null!=t.name&&(this.name=t.name),null!=t.cqq&&(this.cqq=t.cqq),null!=t.cweixin&&(this.cweixin=t.cweixin),null!=t.level&&(this.level=t.level),null!=t.intro&&(this.intro=t.intro),null!=t.message&&(this.message=t.message),null!=t.log&&(this.log=t.log),null!=t.affect&&(this.affect=t.affect),null!=t["switch"]&&(this["switch"]=t["switch"]),null!=t.position&&(this.position=t.position),null!=t.lastday&&(this.lastday=t.lastday),null!=t.updated_at&&(this.updated_at=t.updated_at),null!=t.wealth&&(this.wealth=t.wealth),null!=t.pswd&&(this.pswd=t.pswd),null!=t.boss&&(this.boss=t.boss),null!=t.apply&&(this.apply=t.apply),null!=t.info&&(this.info=t.info))},e.prototype.isBossOpen=function(){return Object.keys(this.boss).length>0?!0:!1},e.prototype.dispose=function(){this.id=null,this.creator=null,this.creatorname=null,this.exp=0,this.list=null,this.mn=0,this.cqq=null,this.cweixin=null,this.level=null,this.intro=null,this.message=null,this.log=null,this.affect=0,this["switch"]=null,this.position=null,this.lastday=null,this.updated_at=null,this.maxmn=0,this.name=null,this.wealth=0,this.pswd=null,this.boss=null,this.info=0},e}(BaseVo);__reflect(AllianceVo.prototype,"AllianceVo");var MyAllianceVo=function(t){function e(){var e=t.call(this)||this;return e.uid=0,e.info=null,e.apply=null,e.po=0,e.tctv=0,e.ctv=0,e.joint=0,e.nextt=0,e.lastday=0,e.updated_at=0,e.shop=null,e.servant={},e}return __extends(e,t),e.prototype.initData=function(t){t&&(null!=t.uid&&(this.uid=Number(t.uid)),null!=t.info&&(this.info=t.info),null!=t.apply&&(this.apply=t.apply),null!=t.po&&(this.po=t.po),null!=t.tctv&&(this.tctv=t.tctv),null!=t.ctv&&(this.ctv=t.ctv),null!=t.donate&&(this.donate=t.donate),null!=t.joint&&(this.joint=t.joint),null!=t.nextt&&(this.nextt=t.nextt),null!=t.lastday&&(this.lastday=t.lastday),null!=t.updated_at&&(this.updated_at=t.updated_at),null!=t.shop&&(this.shop=t.shop),null!=t.servant&&(this.servant=t.servant))},e.prototype.dispose=function(){this.uid=0,this.info=null,this.apply=null,this.po=0,this.tctv=0,this.donate=null,this.joint=0,this.nextt=0,this.lastday=0,this.updated_at=0,this.shop=null,this.ctv=0,this.servant=null},e}(BaseVo);__reflect(MyAllianceVo.prototype,"MyAllianceVo");var ArrivalVo=function(t){function e(){var e=t.call(this)||this;return e.flag=0,e.arrival_count=0,e}return __extends(e,t),e.prototype.initData=function(t){t&&(null!=t.info&&(this.flag=Number(t.info)),null!=t.arrival_count&&(0==this.flag?this.arrival_count=Number(t.arrival_count)+1:this.arrival_count=Number(t.arrival_count)))},e.prototype.dispose=function(){this.flag=0,this.arrival_count=0},e}(BaseVo);__reflect(ArrivalVo.prototype,"ArrivalVo");var AtkraceAtkInfoVo=function(t){function e(){var e=t.call(this)||this;return e.uid="",e.fname="",e.fpoint=0,e.sids={},e.atype=0,e.mesid=null,e.fids={},e.fightnum=0,e.total=0,e.handle=0,e.tmpattr={},e}return __extends(e,t),e.prototype.initData=function(t){if(t)if(this.uid=t.uid,this.fname=t.fname,this.sids=t.sids,this.atype=t.atype,this.fpoint=t.fpoint,null!=t.mesid?(this.mesid=new AtkraceServantVo,this.mesid.initData(t.mesid)):this.mesid&&(this.mesid.dispose(),this.mesid=null),null!=t.fids){for(var e in t.fids)if(this.fids[e])this.fids[e].initData(t.fids[e]);else{var i=new AtkraceServantVo;i.id=e,i.initData(t.fids[e]),this.fids[e]=i}for(var e in this.fids)t.fids[e]||delete this.fids[e]}else{for(var e in this.fids)this.fids[e].dispose();this.fids={}}null!=t.fightnum?this.fightnum=t.fightnum:this.fightnum=0,null!=t.total?this.total=t.total:this.total=0,this.handle=t.handle,this.tmpattr=t.tmpattr},e.prototype.getFName=function(){var t=this.fname;return"robot"==this.uid&&(t=LanguageManager.getlocal("atkRaceRobotName"+this.fname)),t},e.prototype.dispose=function(){this.uid=null,this.fname=null,this.sids=null,this.fpoint=0,this.atype=0,this.fids=null,this.mesid&&(this.mesid.dispose(),this.mesid=null);for(var t in this.fids)this.fids[t].dispose();this.fids={},this.fightnum=0,this.total=0,this.handle=0,this.tmpattr=null},e}(BaseVo);__reflect(AtkraceAtkInfoVo.prototype,"AtkraceAtkInfoVo");var AtkraceInfoVo=function(t){function e(){var e=t.call(this)||this;return e.lasttime=0,e.num=0,e.isuse=0,e.asids=[],e.extranum=0,e.streak=0,e.morale=0,e.rankover=0,e}return __extends(e,t),e.prototype.initData=function(t){t&&(this.lasttime=t.lasttime,this.num=t.num,this.isuse=t.isuse,this.asids=t.asids,this.extranum=t.extranum,this.streak=t.streak,this.morale=t.morale,this.rankover=t.rankover)},e.prototype.dispose=function(){this.lasttime=0,this.num=0,this.isuse=0,this.asids.length=0,this.extranum=0,this.streak=0,this.morale=0,this.rankover=0},e}(BaseVo);__reflect(AtkraceInfoVo.prototype,"AtkraceInfoVo");var AtkraceServantVo=function(t){function e(){var e=t.call(this)||this;return e.attr=0,e.fullattr=0,e.ability=0,e.lv=0,e.sid=null,e.s1lv=0,e.s2lv=0,e.clv=0,e}return __extends(e,t),e.prototype.initData=function(t){t&&(this.attr=t.attr,this.fullattr=t.fullattr,this.ability=t.ability,this.lv=t.lv,this.sid=t.sid,this.s1lv=t.s1lv,this.s2lv=t.s2lv,null!=this.clv&&(this.clv=t.clv))},e.prototype.dispose=function(){this.id=null,this.attr=0,this.fullattr=0,this.ability=0,this.lv=0,this.sid=null,this.s1lv=0,this.s2lv=0,this.clv=0},e}(BaseVo);__reflect(AtkraceServantVo.prototype,"AtkraceServantVo");var AtkraceVo=function(t){function e(){var e=t.call(this)||this;return e.point=0,e.einfo=null,e.lastday=0,e.isjoin=0,e.info=null,e.ainfo=null,e.dinfo=null,e.rewardc=null,e}return __extends(e,t),e.prototype.initData=function(t){t&&(this.point=t.point,this.einfo=t.einfo,this.lastday=t.lastday,this.isjoin=t.isjoin,t.rewardc&&(this.rewardc=t.rewardc),null!=t.info?(null==this.info&&(this.info=new AtkraceInfoVo),this.info.initData(t.info)):null!=this.info&&(this.info.dispose(),this.info=null),null!=t.ainfo&&Object.keys(t.ainfo).length>0?(null==this.ainfo&&(this.ainfo=new AtkraceAtkInfoVo),this.ainfo.initData(t.ainfo)):null!=this.ainfo&&(this.ainfo.dispose(),this.ainfo=null),this.dinfo=t.dinfo)},e.prototype.dispose=function(){this.point=0,this.einfo=null,this.lastday=0,this.isjoin=0,this.info.dispose(),this.info=null,this.ainfo.dispose(),this.ainfo=null,this.dinfo=null,this.rewardc=null},e}(BaseVo);__reflect(AtkraceVo.prototype,"AtkraceVo");var AtkracecrossVo=function(t){function e(){var e=t.call(this)||this;return e.point=0,e.einfo=null,e.lastday=0,e.isjoin=0,e.info=null,e.ainfo=null,e.dinfo=null,e.rewardc=null,e}return __extends(e,t),e.prototype.initData=function(t){t&&(this.point=t.point,this.einfo=t.einfo,this.lastday=t.lastday,this.isjoin=t.isjoin,t.rewardc&&(this.rewardc=t.rewardc),null!=t.info?(null==this.info&&(this.info=new AtkraceInfoVo),this.info.initData(t.info)):null!=this.info&&(this.info.dispose(),this.info=null),null!=t.ainfo&&Object.keys(t.ainfo).length>0?(null==this.ainfo&&(this.ainfo=new AtkraceAtkInfoVo),this.ainfo.initData(t.ainfo)):null!=this.ainfo&&(this.ainfo.dispose(),this.ainfo=null),this.dinfo=t.dinfo)},e.prototype.dispose=function(){this.point=0,this.einfo=null,this.lastday=0,this.isjoin=0,this.info.dispose(),this.info=null,this.ainfo.dispose(),this.ainfo=null,this.dinfo=null,this.rewardc=null},e}(BaseVo);__reflect(AtkracecrossVo.prototype,"AtkracecrossVo");var BookroomInfoVo=function(t){function e(){var e=t.call(this)||this;return e.servantid="",e.et=0,e}return __extends(e,t),e.prototype.initData=function(t){t&&(this.servantid=t.servantid,this.et=t.et)},e.prototype.isStudyOver=function(){return this.et>0&&this.et<=GameData.serverTime?!0:!1},e.prototype.dispose=function(){this.servantid="",this.et=0,this.posId=""},e}(BaseVo);__reflect(BookroomInfoVo.prototype,"BookroomInfoVo");var BookroomVo=function(t){function e(){var e=t.call(this)||this;return e.pos_num=0,e.infoList={},e}return __extends(e,t),e.prototype.initData=function(t){this.pos_num=t.pos_num;for(var e in this.infoList)this.infoList[e].dispose();this.infoList={};for(var e in t.info){var i=t.info[e],a=this.infoList[e];null==a&&(a=new BookroomInfoVo,this.infoList[e]=a,a.posId=e),a.initData(i)}},e.prototype.dispose=function(){this.pos_num=0,this.infoList={}},e}(BaseVo);__reflect(BookroomVo.prototype,"BookroomVo");var ChallengeVo=function(t){function e(){var e=t.call(this)||this;return e.cid=0,e.ksoldier=0,e.info={},e}return __extends(e,t),e.prototype.initData=function(t){if(t){if(null!=t.cid){var e=this.cid;this.cid=Number(t.cid),e!=this.cid&&82==this.cid&&81==e&&(Api.rookieVoApi.curGuideKey="prison",Api.rookieVoApi.insertWaitingGuide({idx:"prison_1"},!0))}null!=t.ksoldier&&(this.ksoldier=Number(t.ksoldier)),null!=t.info&&(this.info=t.info)}},e.prototype.dispose=function(){this.cid=0,this.ksoldier=0,this.info={}},e}(BaseVo);__reflect(ChallengeVo.prototype,"ChallengeVo");var ChatblockVo=function(t){function e(){var e=t.call(this)||this;return e.chatblockVoObj=null,e}return __extends(e,t),e.prototype.initData=function(t){t&&(t.info&&(this.info=t.info),t.list&&(this.list=t.list))},e.prototype.dispose=function(){this.chatblockVoObj=null,this.info=[],this.list=[]},e}(BaseVo);__reflect(ChatblockVo.prototype,"ChatblockVo");var ChatVo=function(t){function e(){var e=t.call(this)||this;return e.chatVoObj=[],e.worldVoObj=[],e.allianceVoObj=[],e.chatSign={},e}return __extends(e,t),e.prototype.initData=function(t){if(t){if(Api.chatVoApi.getIsBlock(t.sender))return;if(t.sign){if(this.chatSign[t.sign])return;this.chatSign[t.sign]=!0}if(t.channel>=1e4&&t.channel!=Api.playerVoApi.getPlayerAllianceId())return;if(t.sender!=Api.playerVoApi.getPlayerID())for(var e=0,i=0;i<this.chatVoObj.length;i++){var a=this.chatVoObj[i];if(t.sender==a.sender&&(t.content.message==a.content.message?e++:e=0,e>2))return}this.chatVoObj.push(t),this.chatVoObj.length>30&&this.chatVoObj.shift(),t.channel<1e4?(this.worldVoObj.push(t),this.worldVoObj.length>30&&this.worldVoObj.shift()):(this.allianceVoObj.push(t),this.allianceVoObj.length>30&&this.allianceVoObj.shift());var n=LanguageManager.getlocal("chatWorldTitle");t.channel>1e4&&(n=LanguageManager.getlocal("chatallianceTitle"));var o=n+"<font color="+TextFieldConst.COLOR_LIGHT_YELLOW+">"+t.sendername+"</font>:"+t.content.message;Api.chatVoApi.setLastMessage(o)}},e.prototype.dispose=function(){this.chatVoObj=null,this.worldVoObj=null,this.allianceVoObj=null,this.chatSign={}},e}(BaseVo);__reflect(ChatVo.prototype,"ChatVo");var ChildAttrVo=function(t){function e(){var e=t.call(this)||this;return e.forceTotal=0,e.brainsTotal=0,e.politicsTotal=0,e.charmTotal=0,e.attTotal=0,e}return __extends(e,t),e.prototype.initData=function(t){if(t&&t){this.attTotal;this.forceTotal=Number(t[0]),this.brainsTotal=Number(t[1]),this.politicsTotal=Number(t[2]),this.charmTotal=Number(t[3]),this.attTotal=this.forceTotal+this.brainsTotal+this.politicsTotal+this.charmTotal}},e.prototype.dispose=function(){this.forceTotal=0,this.brainsTotal=0,this.politicsTotal=0,this.charmTotal=0},e}(BaseVo);__reflect(ChildAttrVo.prototype,"ChildAttrVo");var ChildInfoVo=function(t){function e(){var e=t.call(this)||this;return e.id="",e.motherId=0,e.name="",e.level=0,e.exp=0,e.sex=0,e.quality=0,e.bts=0,e.lastLevel=0,e}return __extends(e,t),e.prototype.initData=function(t){t&&(null!=t.mother&&(this.motherId=Number(t.mother)),null!=t.name&&(this.name=String(t.name)),t.vigour&&(this.vigour=t.vigour),null!=t.lv&&(this.lastLevel=0==this.lastLevel?Number(t.lv):this.level,this.level=Number(t.lv)),null!=t.sex&&(this.sex=Number(t.sex)),null!=t.quality&&(this.quality=Number(t.quality)),null==this.attrVo&&(this.attrVo=new ChildAttrVo),null!=t.attr&&this.attrVo.initData(t.attr),null!=t.exp&&(this.exp=Number(t.exp)),null!=t.bts&&(this.bts=Number(t.bts)))},e.prototype.dispose=function(){this.id="",this.motherId=0,this.name="",this.vigour=0,this.level=0,this.sex=0,this.quality=0,this.exp=0,this.bts=0,this.attrVo&&(this.attrVo.dispose(),this.attrVo=null)},e}(BaseVo);__reflect(ChildInfoVo.prototype,"ChildInfoVo");var ChildVo=function(t){function e(){var e=t.call(this)||this;return e.cnum=0,e.posnum=0,e.childInfoVoObj=null,e}return __extends(e,t),e.prototype.initData=function(t){if(t&&(t.posnum&&(this.posnum=Number(t.posnum)),null!=t.cnum&&(this.cnum=t.cnum),t.info)){null==this.childInfoVoObj&&(this.childInfoVoObj={});for(var e in t.info)if(this.childInfoVoObj[e])this.childInfoVoObj[e].initData(t.info[e]);else{var i=new ChildInfoVo;i.id=e,i.initData(t.info[e]),this.childInfoVoObj[e]=i}for(var e in this.childInfoVoObj)t.info[e]||delete this.childInfoVoObj[e]}},e.prototype.dispose=function(){if(this.childInfoVoObj)for(var t in this.childInfoVoObj)this.childInfoVoObj[t],this.childInfoVoObj[t].dispose(),this.childInfoVoObj[t]=null;this.posnum=0,this.childInfoVoObj=null},e}(BaseVo);__reflect(ChildVo.prototype,"ChildVo");var ConquestVo=function(t){function e(){var e=t.call(this)||this;return e.uid=0,e.point=0,e.tnum=0,e}return __extends(e,t),e.prototype.initData=function(t){t&&(null!=t.uid&&(this.uid=t.uid),null!=t.point&&(this.point=t.point),null!=t.tnum&&(this.tnum=t.tnum),null!=t.info&&(this.info=t.info))},e.prototype.dispose=function(){this.uid=0,this.point=0,this.tnum=0,this.info=null},e}(BaseVo);__reflect(ConquestVo.prototype,"ConquestVo");var DailybossVo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initData=function(t){for(var e in t)this[e]=t[e]},e.prototype.dispose=function(){},e}(BaseVo);__reflect(DailybossVo.prototype,"DailybossVo");var DailyTaskAttrVo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initData=function(t){this.task_f=t.f,this.task_v=t.v},e.prototype.dispose=function(){this.task_f=null,this.task_v=null},e}(BaseVo);__reflect(DailyTaskAttrVo.prototype,"DailyTaskAttrVo");var DailytaskVo=function(t){function e(){var e=t.call(this)||this;return e.dailyTaskList={},e.liveness=0,e}return __extends(e,t),e.prototype.initData=function(t){null==this.dailyTaskList&&(this.dailyTaskList={}),null!=t.liveness&&(this.liveness=t.liveness),this.rewards=t.rewards;for(var e in t.info){var i=this.dailyTaskList[e];null==i&&(i=new DailyTaskAttrVo,this.dailyTaskList[e]=i),i.initData(t.info[e]),i.taskId=e}App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_RESFESH_DAILYTASK_AFTER_SYNC)},e.prototype.dispose=function(){this.dailyTaskList=[],this.rewards=null,this.liveness=0},e}(BaseVo);__reflect(DailytaskVo.prototype,"DailytaskVo");var DinnerVo=function(t){function e(){var e=t.call(this)||this;return e.num=0,e.point=0,e.total_point=0,e.dtype=0,e.is_open=0,e.end_time=0,e.day_num=0,e.jinfo=[],e.total_score=0,e.shop_num=0,e.shop_last_time=0,e.shop_info=[],e.buy_info=null,e.lastday=0,e.name=null,e.pic=null,e.level=null,e.title=null,e.other_info=null,e.phototitle=null,e}return __extends(e,t),e.prototype.initData=function(t){t&&(null!=t.num&&(this.num=t.num),null!=t.point&&(this.point=t.point),null!=t.dtype&&(this.dtype=t.dtype),null!=t.is_open&&(this.is_open=t.is_open),null!=t.end_time&&(this.end_time=t.end_time),null!=t.day_num&&(this.day_num=t.day_num),null!=t.jinfo&&(this.jinfo=t.jinfo),null!=t.total_score&&(this.total_score=t.total_score),null!=t.total_point&&(this.total_point=t.total_point),null!=t.shop_num&&(this.shop_num=t.shop_num),null!=t.shop_last_time&&(this.shop_last_time=t.shop_last_time),null!=t.shop_info&&(this.shop_info=t.shop_info),null!=t.buy_info&&(this.buy_info=t.buy_info),null!=t.lastday&&(this.lastday=t.lastday),null!=t.name&&(this.name=t.name),null!=t.pic&&(this.pic=t.pic),null!=t.level&&(this.level=t.level),null!=t.title&&(this.title=t.title),null!=t.other_info&&(this.other_info=t.other_info),null!=t.phototitle&&(this.phototitle=t.phototitle))},e.prototype.dispose=function(){this.num=0,this.point=0,this.dtype=0,this.is_open=0,this.end_time=0,this.day_num=0,this.jinfo.length=0,this.total_score=0,this.total_point=0,this.shop_num=0,this.shop_last_time=0,this.shop_info.length=0,this.buy_info=null,this.lastday=0,this.name=null,this.other_info=null,this.pic=0,this.level=0,this.title=null,this.phototitle=null},e}(BaseVo);__reflect(DinnerVo.prototype,"DinnerVo");var GameinfoVo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initData=function(t){if(t)for(var e in t)this[e]=t[e]},e.prototype.dispose=function(){this.newerflag=0},e}(BaseVo);__reflect(GameinfoVo.prototype,"GameinfoVo");var InviteVo=function(t){function e(){var e=t.call(this)||this;return e.info={},e.rinfo={invite:{},power:{},recharge:{}},e}return __extends(e,t),e.prototype.initData=function(t){if(t)for(var e in t)this[e]=t[e]},e.prototype.dispose=function(){},e}(BaseVo);__reflect(InviteVo.prototype,"InviteVo");var ItemInfoVo=function(t){function e(){var e=t.call(this)||this;return e.id=0,e.num=0,e}return __extends(e,t),e.prototype.initData=function(t){null!=t.id&&(this.id=Number(t.id)),null!=t.num&&(this.num=Number(t.num))},Object.defineProperty(e.prototype,"name",{get:function(){return this.itemCfg.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"desc",{get:function(){return this.itemCfg.desc},enumerable:!0,configurable:!0}),e.prototype.getDescTxt=function(t){return this.itemCfg.getDescTxt(t)},Object.defineProperty(e.prototype,"dropDesc",{get:function(){return this.itemCfg.dropDesc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this.itemCfg.icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconBg",{get:function(){return this.itemCfg.iconBg},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.itemCfg?this.itemCfg.quality:1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShowUseBtn",{get:function(){return this.itemCfg?1==this.itemCfg.isUse:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOnly",{get:function(){return this.itemCfg?1==this.itemCfg.isUse:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sortId",{get:function(){return this.itemCfg?this.itemCfg.sortId:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this.itemCfg?this.itemCfg.target:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.itemCfg?this.itemCfg.type:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemCfg",{get:function(){return Config.ItemCfg.getItemCfgById(this.id)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.id=0,this.num=0},e}(BaseVo);__reflect(ItemInfoVo.prototype,"ItemInfoVo");var ItemVo=function(t){function e(){var e=t.call(this)||this;return e.updated_at=0,e.itemInfoVoObj=null,e.titleInfoVoObj=null,e.cinfo={},e.sinfo=null,e}return __extends(e,t),e.prototype.initData=function(t){if(t){if(null!=t.updated_at&&(this.updated_at=Number(t.updated_at)),t.info){null==this.itemInfoVoObj&&(this.itemInfoVoObj={});for(var e in t.info)if(this.itemInfoVoObj[e])this.itemInfoVoObj[e].initData({id:Number(e),num:t.info[e]});else{var i=new ItemInfoVo;i.initData({id:Number(e),num:t.info[e]}),this.itemInfoVoObj[e]=i}}if(null==this.titleInfoVoObj){this.titleInfoVoObj={};var a=Config.TitleCfg.getTitleCfg();for(var e in a){var n=new TitleInfoVo;n.initData({id:Number(e),num:-1}),this.titleInfoVoObj[e]=n}}if(t.tinfo)for(var e in this.titleInfoVoObj)null!=t.tinfo[e]?this.titleInfoVoObj[e].initData({id:Number(e),num:t.tinfo[e]}):this.titleInfoVoObj[e].initData({id:Number(e),num:-1});t.cinfo&&(this.cinfo=t.cinfo),Api.servantVoApi.isShowRedForItem()&&App.MessageHelper.dispatchNetMessage(MessageConst.MESSAGE_REFRESH_MODE,"servant"),t.sinfo&&(this.sinfo=t.sinfo)}},e.prototype.setcinfo=function(t){this.cinfo?(t.st&&(this.cinfo.st=t.st),t.version&&(this.cinfo.version=t.version),t.et&&(this.cinfo.et=t.et)):this.cinfo=t},e.prototype.dispose=function(){if(this.updated_at=0,this.itemInfoVoObj)for(var t in this.itemInfoVoObj)this.itemInfoVoObj[t]&&(this.itemInfoVoObj[t].dispose(),this.itemInfoVoObj[t]=null);if(this.itemInfoVoObj=null,this.titleInfoVoObj)for(var t in this.titleInfoVoObj)this.titleInfoVoObj[t],this.titleInfoVoObj[t].dispose(),this.titleInfoVoObj[t]=null;this.titleInfoVoObj=null},e}(BaseVo);__reflect(ItemVo.prototype,"ItemVo");var TitleInfoVo=function(t){function e(){var e=t.call(this)||this;return e.id=0,e.num=-1,e}return __extends(e,t),e.prototype.initData=function(t){null!=t.id&&(this.id=Number(t.id)),null!=t.num?this.num=Number(t.num):this.num=-1},Object.defineProperty(e.prototype,"name",{get:function(){return this.itemCfg.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"desc",{get:function(){return this.itemCfg.desc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropDesc",{get:function(){return this.itemCfg.dropDesc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this.itemCfg.icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconBg",{get:function(){return this.itemCfg.iconBg},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.itemCfg?this.itemCfg.quality:1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShowUseBtn",{get:function(){return this.itemCfg?1==this.itemCfg.isUse:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOnly",{get:function(){return this.itemCfg?1==this.itemCfg.isOnly:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sortId",{get:function(){return this.itemCfg?this.itemCfg.sortId:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.itemCfg?this.itemCfg.type:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemCfg",{get:function(){return Config.TitleCfg.getTitleCfgById(this.id)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.id=0,this.num=-1},e}(BaseVo);__reflect(TitleInfoVo.prototype,"TitleInfoVo");var MailInfoVo=function(t){function e(){var e=t.call(this)||this;return e.st=0,e.istouch=0,e.isread=0,e.mid=0,e.title="",e.touch="",e.hadget=0,e.content=null,e}return __extends(e,t),e.prototype.initData=function(t){null!=t.st&&(this.st=Number(t.st)),null!=t.istouch&&(this.istouch=Number(t.istouch)),null!=t.isread&&(this.isread=Number(t.isread)),null!=t.mid&&(this.mid=Number(t.mid)),null!=t.title&&(this.title=String(t.title)),null!=t.touch&&(this.touch=String(t.touch)),null!=t.hadget&&(this.hadget=Number(t.hadget)),null!=t.content&&(this.content=String(t.content),"xinshoufuli1"==this.content?this.content=LanguageManager.getlocal("xinshoufuli1"):"xinshoufuli2"==this.content&&(this.content=LanguageManager.getlocal("xinshoufuli2"))),null!=t.extra&&null!=t.extra.mt&&(this.title=LanguageManager.getlocal("systemMailTitleType"+t.extra.mt),this.content=LanguageManager.getlocal("systemMailContentType"+t.extra.mt,t.extra.pa))},Object.defineProperty(e.prototype,"timeStr",{get:function(){return App.DateUtil.getFormatBySecond(this.st,6)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.st=0,this.istouch=0,this.isread=0,this.mid=0,this.title="",this.touch="",this.hadget=0,this.content=null},e}(BaseVo);__reflect(MailInfoVo.prototype,"MailInfoVo");var MailVo=function(t){function e(){var e=t.call(this)||this;return e.mailInfoVoObj=null,e.unread=0,e.totalNum=0,e}return __extends(e,t),e.prototype.initData=function(t){if(t){if(t.system){if(null==this.mailInfoVoObj&&(this.mailInfoVoObj={}),t.system.c){var e=t.system.c;for(var i in e){var a=e[i].mid;if(this.mailInfoVoObj[a])this.mailInfoVoObj[a].initData(e[i]);else{var n=new MailInfoVo;n.initData(e[i]),this.mailInfoVoObj[a]=n}}}t.system.mids&&t.system.mids[0]&&(this.totalNum=t.system.mids.length)}t.unread&&(this.unread=t.unread.system)}},e.prototype.dispose=function(){this.mailInfoVoObj=null,this.unread=null,this.totalNum=null},e}(BaseVo);__reflect(MailVo.prototype,"MailVo");var AffairVo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initData=function(t){t.ainfo&&(this.num=t.ainfo.num,this.st=t.ainfo.st,this.opt=t.ainfo.afid)},e.prototype.dispose=function(){this.num=void 0,this.st=void 0,this.opt=void 0},e}(BaseVo);__reflect(AffairVo.prototype,"AffairVo");var AutoResVo=function(t){function e(){var e=t.call(this)||this;return e.gold=0,e.food=0,e.soldier=0,e}return __extends(e,t),e.prototype.initData=function(t){if(this.reset(),t)for(var e in t)this[e]=t[e]},Object.defineProperty(e.prototype,"notice",{get:function(){return Boolean(this.food||this.gold||this.soldier)},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.gold=0,this.food=0,this.soldier=0},e.prototype.dispose=function(){this.reset()},e}(BaseVo);__reflect(AutoResVo.prototype,"AutoResVo");var ManageVo=function(t){function e(){var e=t.call(this)||this;return e.itemsVo=[],e}return __extends(e,t),e.prototype.initData=function(t){if(t&&t.finfo)for(var e in t.finfo){this[e]||(this[e]=new ManageItemVo);var i=this[e];i.initData(t.finfo[e]),i.type=e}this.itemsVo.length=0,this.itemsVo=[this.gold,this.food,this.soldier]},e.prototype.dispose=function(){this.gold&&(this.gold.dispose(),this.gold=null),this.food&&(this.food.dispose(),this.food=null),this.soldier&&(this.soldier.dispose(),this.soldier=null),this.itemsVo&&(this.itemsVo.length=0)},e}(BaseVo);__reflect(ManageVo.prototype,"ManageVo");var ManageItemVo=function(t){function e(){var e=t.call(this)||this;return e.num=0,e.st=0,e.need_time=0,e.type=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"needRefresh",{get:function(){return this.num>0||GameData.serverTime-this.need_time-this.st>0},enumerable:!0,configurable:!0}),e.prototype.initData=function(t){t&&(null!=t.num&&(this.num=Number(t.num)),null!=t.st&&(this.st=Number(t.st)),null!=t.need_time&&(this.need_time=Number(t.need_time)))},Object.defineProperty(e.prototype,"maxNum",{get:function(){var t=String(Api.playerVoApi.getPlayerLevel());return Config.LevelCfg.getCfgByLevel(t)[this.type]},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.num=0,this.st=0,this.type=null},e}(BaseVo);__reflect(ManageItemVo.prototype,"ManageItemVo");var OtherInfoVo=function(t){function e(){var e=t.call(this)||this;return e.imacy=0,e.power=0,e.challenge=0,e.palace_flag=0,e.banet=0,e.certification=null,e}return __extends(e,t),e.prototype.initData=function(t){t.rv_info&&(t.rv_info.imacy&&(this.imacy=t.rv_info.imacy),t.rv_info.power&&(this.power=t.rv_info.power),t.rv_info.challenge&&(this.challenge=t.rv_info.challenge)),t.palace&&(this.palace_flag=t.palace.flag),t.info&&(this.info=t.info),t.banet&&(this.banet=t.banet),t.info&&t.info.certification&&(this.certification=t.info.certification)},e.prototype.dispose=function(){this.imacy=0,this.power=0,this.challenge=0,this.palace_flag=0,this.banet=0,this.info=null,this.certification=null},e}(BaseVo);__reflect(OtherInfoVo.prototype,"OtherInfoVo");var PalaceRoleInfoVo=function(t){function e(){var e=t.call(this)||this;
return e.uid=0,e.sign="",e.vip=0,e.level=0,e.pic=0,e.titleId="",e.name="",e.rank=[],e}return __extends(e,t),e.prototype.initData=function(t){t.uid&&(this.uid=t.uid,this.sign=t.sign,this.vip=t.vip,this.level=t.level,this.pic=t.pic,this.name=t.name),t.rank&&(this.rank=t.rank)},e.prototype.dispose=function(){this.uid=0,this.sign="",this.vip=0,this.level=0,this.pic=0,this.titleId="",this.name="",this.rank=[]},e}(BaseVo);__reflect(PalaceRoleInfoVo.prototype,"PalaceRoleInfoVo");var PalaceVo=function(t){function e(){var e=t.call(this)||this;return e.palace={},e.gpalace={},e.isInit=!1,e.isCross=!1,e}return __extends(e,t),e.prototype.initData=function(t){if(this.isInit=!0,t.palace)for(var e in t.palace){var i=this.palace[e];i||(i=new PalaceRoleInfoVo,this.palace[e]=i),i.initData(t.palace[e]),i.titleId=e}this.isCross=t.isCross},e.prototype.dispose=function(){this.palace={},this.gpalace={},this.isInit=!1,this.isCross=!1},e}(BaseVo);__reflect(PalaceVo.prototype,"PalaceVo");var PlayerVo=function(t){function e(){var e=t.call(this)||this;return e.uid=0,e.pic=0,e.name="",e.level=0,e.exp=0,e.vip=0,e.vipexp=0,e.gem=0,e.gold=0,e.mygid=0,e.mygname="",e.power=0,e.buyg=0,e.buyt=0,e.freeg=0,e.tcost=0,e.olt=0,e.updated_at=0,e.charm=0,e.inte=0,e.atk=0,e.politics=0,e.food=0,e.soldier=0,e.titleid=0,e}return __extends(e,t),e.prototype.initData=function(t){if(t){var e=this.checkRefreshUI(t);if(null!=t.uid&&(this.uid=Number(t.uid)),null!=t.pic&&(this.pic=Number(t.pic)),null!=t.name&&(this.name=String(t.name)),null!=t.level){var i=this.level;this.level=Number(t.level);var a=Config.DinnerCfg.getNeedLv();i!=this.level&&this.level==a&&i==a-1&&(Api.rookieVoApi.curGuideKey="dinner",Api.rookieVoApi.insertWaitingGuide({idx:"dinner_1"},!0));var n=Config.SearchbaseCfg.needLv;i!=this.level&&this.level==n&&i==n-1&&(Api.rookieVoApi.curGuideKey="search",Api.rookieVoApi.insertWaitingGuide({idx:"search_1"},!0)),i!=this.level&&0!=i&&PlatformManager.analyticsLevelup()}if(null!=t.exp&&(this.exp=Number(t.exp)),null!=t.vip&&(this.vip=Number(t.vip)),null!=t.vipexp&&(this.vipexp=Number(t.vipexp)),null!=t.gem&&(this.gem=Number(t.gem)),null!=t.gold&&(this.gold=Number(t.gold)),null!=t.mygid&&(this.mygid=Number(t.mygid)),null!=t.mygname&&(this.mygname=String(t.mygname)),null!=t.power){var o=this.power;this.power=Number(t.power);var s=NetManager.curReceiveCmd;if(0!=o&&this.power-o>0&&s!=NetRequestConst.REQUEST_WIFE_LOVE&&s!=NetRequestConst.REQUEST_WIFE_CALL&&1!==s.indexOf("push.")){var r=this.power-o,l=(egret.Point.create(320,GameConfig.stageHeigth/2),new PowerFly);l.init(r),LayerManager.msgLayer.addChild(l)}}null!=t.buyg&&(this.buyg=Number(t.buyg)),null!=t.buyt&&(this.buyt=Number(t.buyt)),null!=t.freeg&&(this.freeg=Number(t.freeg)),null!=t.tcost&&(this.tcost=Number(t.tcost)),null!=t.olt&&(this.olt=Number(t.olt)),null!=t.updated_at&&(this.updated_at=Number(t.updated_at)),null!=t.charm&&(this.charm=Number(t.charm)),null!=t.inte&&(this.inte=Number(t.inte)),null!=t.atk&&(this.atk=Number(t.atk)),null!=t.politics&&(this.politics=Number(t.politics)),null!=t.food&&(this.food=Number(t.food)),null!=t.soldier&&(this.soldier=Number(t.soldier)),e.length>0&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_RESCHANGE_REFRESH_UI,e),null!=t.title&&(this.titleid=Number(t.title))}},e.prototype.checkRefreshUI=function(t){var e=[];if(t)for(var i=GameConfig.refreshUIResArr,a=i.length,n=a-1;n>=0;n--){var o=i[n],s=!1;null!=t[o]&&(s=!App.MathUtil.checkEqual(this[o],t[o])),s&&e.push(o)}return e},e.prototype.dispose=function(){this.uid=0,this.pic=0,this.name="",this.level=0,this.exp=0,this.vip=0,this.vipexp=0,this.gem=0,this.gold=0,this.mygid=0,this.mygname="",this.power=0,this.buyg=0,this.buyt=0,this.freeg=0,this.tcost=0,this.olt=0,this.updated_at=0,this.charm=0,this.inte=0,this.atk=0,this.politics=0,this.food=0,this.soldier=0,this.titleid=0},e}(BaseVo);__reflect(PlayerVo.prototype,"PlayerVo");var PracticeVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attr=[],e.level=0,e.exp=0,e.spd=0,e.ability=[],e.task={},e}return __extends(e,t),e.prototype.initData=function(t){if(t&&(this.attr=t.attr,this.level=t.level,this.exp=t.exp,this.spd=t.spd,this.storage=t.storage,this.ability=t.ability,this.info=t.info,t.task)){this.task||(this.task={});for(var e in t.task){var i=this.task[e];i||(i=new PracticeTaskVo,this.task[e]=i),i.initData(t.task[e]),i.id=e}}},e.prototype.dispose=function(){this.attr=[],this.ability=[],this.info=null,this.level=0,this.exp=0,this.spd=0,this.storage=null},e}(BaseVo);__reflect(PracticeVo.prototype,"PracticeVo");var PracticeTaskVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stage=0,e.v=0,e.f=0,e.id="",e}return __extends(e,t),e.prototype.initData=function(t){t&&(this.stage=t.stage,this.v=t.v,this.f=t.f)},Object.defineProperty(e.prototype,"curV",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.stage=0,this.v=0,this.f=0,this.id=""},e}(BaseVo);__reflect(PracticeTaskVo.prototype,"PracticeTaskVo");var PrestigeVo=function(t){function e(){var e=t.call(this)||this;return e.pem=0,e.info=null,e.log=null,e}return __extends(e,t),e.prototype.initData=function(t){t&&(null!=t.pem&&(this.pem=t.pem),null!=t.info&&(this.info=t.info),null!=t.log&&(this.log=t.log))},e.prototype.dispose=function(){this.pem=0,this.info=null,this.log=null},e}(BaseVo);__reflect(PrestigeVo.prototype,"PrestigeVo");var PrisonVo=function(t){function e(){var e=t.call(this)||this;return e.info={},e.lastday=0,e.mypre=0,e.dailypre=0,e.maxpre=0,e}return __extends(e,t),e.prototype.initData=function(t){t&&(t.info&&(this.info=t.info),t.dailypre&&(this.dailypre=t.dailypre),t.mypre?this.mypre=t.mypre:this.mypre=0,t.maxpre&&(this.maxpre=t.maxpre),t.lastday&&(this.lastday=t.lastday))},e.prototype.dispose=function(){this.info={},this.lastday=0,this.mypre=0,this.dailypre=0,this.maxpre=0},e}(BaseVo);__reflect(PrisonVo.prototype,"PrisonVo");var RankUserVo=function(t){function e(){var e=t.call(this)||this;return e.level=0,e.name="",e.vip="",e.power="",e.uid="",e.title="",e.total_imacy="",e.cid="",e}return __extends(e,t),e.prototype.initData=function(t){null!=t.level&&(this.level=Number(t.level)),null!=t.name&&(this.name=t.name),null!=t.vip&&(this.vip=t.vip),null!=t.power&&(this.power=t.power),null!=t.uid&&(this.uid=t.uid),null!=t.title&&(this.title=t.title),null!=t.total_imacy&&(this.total_imacy=t.total_imacy),null!=t.cid&&(this.cid=t.cid)},e.prototype.dispose=function(){this.level=0,this.name="",this.vip="",this.power="",this.uid="",this.title="",this.total_imacy="",this.cid=""},e}(BaseVo);__reflect(RankUserVo.prototype,"RankUserVo");var RankVo=function(t){function e(){var e=t.call(this)||this;return e.cinfoList=[],e.iinfoList=[],e.pinfoList=[],e.crank=0,e.lv=0,e.imacy=0,e.name="",e.cid=0,e.power=0,e.irank=0,e.prank=0,e}return __extends(e,t),e.prototype.initData=function(t){t.minfo&&(this.crank=t.minfo.crank,this.lv=Number(t.minfo.lv),this.imacy=t.minfo.imacy,this.name=t.minfo.name,this.cid=t.minfo.cid,this.power=t.minfo.power,this.prank=t.minfo.prank,this.irank=t.minfo.irank),t.pinfo&&this.initMyData(t.pinfo,this.pinfoList),t.iinfo&&this.initMyData(t.iinfo,this.iinfoList),t.cinfo&&this.initMyData(t.cinfo,this.cinfoList)},e.prototype.initMyData=function(t,e){for(var i=0;i<t.length;i++){var a=t[i],n=e[i];n||(n=new RankUserVo,e.push(n)),n.initData(a)}},e.prototype.dispose=function(){this.crank=0,this.lv=0,this.imacy=0,this.name="",this.cid=0,this.power=0,this.irank=0,this.prank=0,this.cinfoList=[],this.iinfoList=[],this.pinfoList=[]},e}(BaseVo);__reflect(RankVo.prototype,"RankVo");var RewardItemVo=function(t){function e(){var e=t.call(this)||this;return e.type=0,e.id=0,e.num=0,e._name="",e._tipName="",e._desc="",e._icon="",e._iconbg="",e._quality=1,e}return __extends(e,t),e.prototype.initData=function(t){var e=t.split("_");this.type=Number(e[0]),this.id=Number(e[1]),this.num=Number(e[2]);var i=Config.ItemCfg.getItemCfgById(this.id);if(this._tipName="",1==this.type)this._name=LanguageManager.getlocal("gemName"),this._icon="itemicon1";else if(2==this.type)this._name=LanguageManager.getlocal("playerview_gold").replace(":  ",""),this._icon="itemicon2";else if(3==this.type)this._name=LanguageManager.getlocal("playerview_food").replace(":  ",""),this._icon="itemicon3";else if(4==this.type)this._name=LanguageManager.getlocal("playerview_soldier").replace(":  ",""),this._icon="itemicon4";else if(5==this.type)this._name=LanguageManager.getlocal("playerview_exp").replace(":  ",""),this._icon="itemicon5";else if(6==this.type)this._name=LanguageManager.getlocal("itemName_"+this.id),this._icon="itemicon"+this.id;else if(7==this.type)1==this.id?this._name=LanguageManager.getlocal("playerview_forceAtt").replace(":  ",""):2==this.id?this._name=LanguageManager.getlocal("playerview_inteAtt").replace(":  ",""):3==this.id?this._name=LanguageManager.getlocal("playerview_policyAtt").replace(":  ",""):4==this.id&&(this._name=LanguageManager.getlocal("playerview_charmAtt").replace(":  ","")),this._tipName=this._name;else if(8==this.type)this._icon="servant_half_"+this.id,this._name=LanguageManager.getlocal("servant_name"+this.id);else if(9==this.type)this._name=LanguageManager.getlocal("wifeIntimacy").replace(" :",""),this._tipName=this._name;else if(10==this.type){var a=Config.WifeCfg.getWifeCfgById(this.id);a&&(this._icon=a.icon,this._name=a.name)}else if(11==this.type)this._name=LanguageManager.getlocal("itemName_"+this.id),this._icon="itemicon"+this.id,i=Config.TitleCfg.getTitleCfgById(this.id);else if(12==this.type){var a=Config.WifeCfg.getWifeCfgById(this.id);this._name=LanguageManager.getlocal("wifeCharm").replace(" :",""),this._tipName=this._name,a&&(this._icon=a.icon)}else if(13==this.type)this._name=LanguageManager.getlocal("wifeExp").replace(" :",""),this._tipName=this._name;else if(14==this.type){if(this.id>10){var n=Config.ServantCfg.getServantItemById(this.id.toString());this._icon=n.halfIcon}else this._icon="itemicon14";this._name=LanguageManager.getlocal("itemName_"+this.type)}else if(15==this.type){if(this.id>10){var o=Config.ServantCfg.getServantItemById(this.id.toString());this._icon=o.halfIcon}else this._icon="itemicon15";this._name=LanguageManager.getlocal("itemName_"+this.type)}else if(16==this.type){var s=Config.WifeskinCfg.getWifeCfgById(this.id.toString());this._icon=s.icon,this._name=s.name}else 17==this.type&&(this._icon="itemicon17",this._name=LanguageManager.getlocal("itemName_17"));this._quality=i?i.quality:1,this._iconbg="itembg_"+this._quality,8==this.type&&(this._iconbg="itembg_7"),(14==this.type||15==this.type)&&(this._iconbg="itembg_1")},Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nameColor",{get:function(){var t=TextFieldConst.COLOR_QUALITY_WHITE;return 2==this._quality?t=TextFieldConst.COLOR_QUALITY_GREEN:3==this._quality?t=TextFieldConst.COLOR_QUALITY_BLUE:4==this._quality?t=TextFieldConst.COLOR_QUALITY_PURPLE:5==this._quality&&(t=TextFieldConst.COLOR_QUALITY_ORANGE),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconBg",{get:function(){return this._iconbg},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this.name+(this.num<0?this.num:"+"+this.num)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tipMessage",{get:function(){return this._tipName+(this.num<0?String(this.num):"+"+this.num)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"desc",{get:function(){var t="";if(6==this.type){var e=Config.ItemCfg.getItemCfgById(this.id);e&&(t=e.desc)}else if(8==this.type){var e=Config.ServantCfg.getServantItemById(this.id.toString());e&&(t=e.desc)}else if(10==this.type){var i=Config.WifeCfg.getWifeCfgById(this.id);t=i.name+"*1"}else if(11==this.type){var e=Config.TitleCfg.getTitleCfgById(this.id);e&&(t=e.desc)}else if(12==this.type){var i=Config.WifeCfg.getWifeCfgById(this.id);t=LanguageManager.getlocal("itemDesc_12",[i.name])}else if(14==this.type){var e=Config.ServantCfg.getServantItemById(this.id.toString());t=LanguageManager.getlocal("itemDesc_14",[e.name])}else if(15==this.type){var e=Config.ServantCfg.getServantItemById(this.id.toString());t=LanguageManager.getlocal("itemDesc_15",[e.name])}else if(16==this.type){var e=Config.WifeskinCfg.getWifeCfgById(this.id.toString());t=e.desc2}else t=LanguageManager.getlocal("itemDesc_"+this.type);return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropDesc",{get:function(){var t="";if(6==this.type){var e=Config.ItemCfg.getItemCfgById(this.id);e&&(t=e.dropDesc)}else if(8==this.type){var e=Config.ServantCfg.getServantItemById(this.id.toString());e&&(t=e.dropDesc)}else if(10==this.type)t=LanguageManager.getlocal("wifeDropDesc_"+this.id);else if(11==this.type){var e=Config.TitleCfg.getTitleCfgById(this.id);e&&(t=e.dropDesc)}else if(16==this.type){var e=Config.WifeskinCfg.getWifeCfgById(this.id.toString());t=e.dropDesc}else t=LanguageManager.getlocal("itemDropDesc_"+this.type);return t},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.type=0,this.id=0,this.num=0,this._name="",this._tipName="",this._desc="",this._icon="",this._iconbg="",this._quality=1},e}(BaseVo);__reflect(RewardItemVo.prototype,"RewardItemVo");var SearchBuildInfoItemVo=function(t){function e(){var e=t.call(this)||this;return e.unlock={},e}return __extends(e,t),e.prototype.initData=function(t){var e=Config.SearchCfg.getPersonItemCfgByPersonId(t);this.build=e.build,this.type=e.type,this.wifeId=e.wifeId,e.unlock&&(isNaN(e.unlock.needVip)||(this.unlock.needVip=e.unlock.needVip),isNaN(e.unlock.needPower)||(this.unlock.needPower=e.unlock.needPower),isNaN(e.unlock.needPower)||(this.unlock.needPower=e.unlock.needPower),isNaN(e.unlock.needQQ)||(this.unlock.needQQ=e.unlock.needQQ),isNaN(e.unlock.needActive)||(this.unlock.needActive=e.unlock.needActive)),this.maxValue=e.value,this.personId=e.personId},Object.defineProperty(e.prototype,"value",{get:function(){return Api.searchVoApi.getWifeValueById(this.personId)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventDesc",{get:function(){var t="";if(1==this.type)return t;if(this.isUnlock){var e=!1;this.wifeId&&Api.wifeVoApi.getWifeInfoVoById(Number(this.wifeId))&&(e=!0),t=0==e?LanguageManager.getlocal("searchEventDesc"):LanguageManager.getlocal("searchAlreadyMarried")}else this.unlock.needVip?Api.playerVoApi.getPlayerVipLevel()<this.unlock.needVip&&(t=LanguageManager.getlocal("searchLockVipDesc",[String(this.unlock.needVip)])):this.unlock.needPower?Api.playerVoApi.getPlayerPower()<this.unlock.needPower&&(t=LanguageManager.getlocal("searchLockPowerDesc",[String(this.unlock.needPower)])):this.unlock.needActive&&(Api.acVoApi.checkActiveIsUnlock(this.unlock.needActive)||(t=LanguageManager.getlocal("searchLockActiveDesc")));return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isUnlock",{get:function(){var t=!1;if(this.unlock){var e=!1;this.unlock.needVip&&(e=!0,t=Api.playerVoApi.getPlayerVipLevel()>=this.unlock.needVip),this.unlock.needPower&&(e=!0,t=Api.playerVoApi.getPlayerPower()>=this.unlock.needPower),this.unlock.needActive&&(e=!0,t=Api.wifeVoApi.getWifeInfoVoById(Number(this.wifeId))?!0:Api.acVoApi.checkActiveIsUnlock(this.unlock.needActive)),e||(t=!0)}else t=!0;return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShowProgress",{get:function(){return 0==isNaN(this.value)&&this.value>0},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){},e}(BaseVo);__reflect(SearchBuildInfoItemVo.prototype,"SearchBuildInfoItemVo");var SearchVo=function(t){function e(){var e=t.call(this)||this;return e.info={},e.lucky={},e}return __extends(e,t),e.prototype.initData=function(t){if(t){if(this.reset(),t.strength&&(this.strength=t.strength),t.info){for(var e in t.info){var i=this.info[e];i||(i=new SearchInfoItemVo,this.info[e]=i),i.initData(t.info[e]),i.personId=Number(e)}var a=Object.keys(t.info);for(var e in this.info)a.indexOf(e)<0&&delete this.info[e]}t.lucky&&(this.lucky=t.lucky)}},Object.defineProperty(e.prototype,"maxSearchNum",{get:function(){return Config.VipCfg.getVipCfgByLevel(Api.playerVoApi.getPlayerVipLevel()).maxStrength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"searchNum",{get:function(){var t=Math.floor((GameData.serverTime-this.strength.st)/Config.SearchbaseCfg.needTime)+this.strength.num;return Math.max(Math.min(t,this.maxSearchNum),0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftTime",{get:function(){var t=0,e=Math.floor((GameData.serverTime-this.strength.st)/Config.SearchbaseCfg.needTime)+this.strength.num;return e>=this.maxSearchNum?t=0:e=Config.SearchbaseCfg.needTime-(GameData.serverTime-this.strength.st)%Config.SearchbaseCfg.needTime,e},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.strength=null,this.lucky={}},e.prototype.dispose=function(){},e}(BaseVo);__reflect(SearchVo.prototype,"SearchVo");var SearchInfoItemVo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initData=function(t){this.progress=Number(t)},e.prototype.dispose=function(){},e}(BaseVo);__reflect(SearchInfoItemVo.prototype,"SearchInfoItemVo");var ServantAttrVo=function(t){function e(){var e=t.call(this)||this;return e.forceTotal=0,e.forceAdd_1=0,e.forceAdd_2=0,e.forceAdd_3=0,e.forceAdd_4=0,e.brainsTotal=0,e.brainsAdd_1=0,e.brainsAdd_2=0,e.brainsAdd_3=0,e.brainsAdd_4=0,e.politicsTotal=0,e.politicsAdd_1=0,e.politicsAdd_2=0,e.politicsAdd_3=0,e.politicsAdd_4=0,e.charmTotal=0,e.charmAdd_1=0,e.charmAdd_2=0,e.charmAdd_3=0,e.charmAdd_4=0,e}return __extends(e,t),e.prototype.initData=function(t){t&&(t.attr&&(this.forceTotal=Number(t.attr[0]),this.brainsTotal=Number(t.attr[1]),this.politicsTotal=Number(t.attr[2]),this.charmTotal=Number(t.attr[3])),t.attrAdd&&(this.forceAdd_1=Number(t.attrAdd[0][0]),this.forceAdd_2=Number(t.attrAdd[0][1]),this.forceAdd_3=Number(t.attrAdd[0][2]),this.forceAdd_4=Number(t.attrAdd[0][3]),this.brainsAdd_1=Number(t.attrAdd[1][0]),this.brainsAdd_2=Number(t.attrAdd[1][1]),this.brainsAdd_3=Number(t.attrAdd[1][2]),this.brainsAdd_4=Number(t.attrAdd[1][3]),this.politicsAdd_1=Number(t.attrAdd[2][0]),this.politicsAdd_2=Number(t.attrAdd[2][1]),this.politicsAdd_3=Number(t.attrAdd[2][2]),this.politicsAdd_4=Number(t.attrAdd[2][3]),this.charmAdd_1=Number(t.attrAdd[3][0]),this.charmAdd_2=Number(t.attrAdd[3][1]),this.charmAdd_3=Number(t.attrAdd[3][2]),this.charmAdd_4=Number(t.attrAdd[3][3])))},e.prototype.dispose=function(){this.forceTotal=0,this.forceAdd_1=0,this.forceAdd_2=0,this.forceAdd_3=0,this.forceAdd_4=0,this.brainsTotal=0,this.brainsAdd_1=0,this.brainsAdd_2=0,this.brainsAdd_3=0,this.brainsAdd_4=0,this.politicsTotal=0,this.politicsAdd_1=0,this.politicsAdd_2=0,this.politicsAdd_3=0,this.politicsAdd_4=0,this.charmTotal=0,this.charmAdd_1=0,this.charmAdd_2=0,this.charmAdd_3=0,this.charmAdd_4=0},e}(BaseVo);__reflect(ServantAttrVo.prototype,"ServantAttrVo");var ServantInfoVo=function(t){function e(){var e=t.call(this)||this;return e.level=0,e.hasexp=0,e.total=0,e.servantId="",e.skillExp=0,e.clv=0,e.skill=[],e.abilityExp=0,e.aura=0,e}return __extends(e,t),e.prototype.initData=function(t){if(t){if(null!=t.lv&&(this.level=Number(t.lv)),null!=t.hasexp&&(this.hasexp=Number(t.hasexp)),null!=t.total){this.total;this.total=Number(t.total)}null==this.attrVo&&(this.attrVo=new ServantAttrVo),null!=t.skillExp&&(this.skillExp=t.skillExp),null!=t.clv&&(this.clv=t.clv),null!=t.ability&&(this.ability=t.ability),null!=t.skill&&(this.skill=t.skill),null!=t.abilityExp&&(this.abilityExp=t.abilityExp),null!=t.aura&&(this.aura=t.aura),this.attrVo.initData(t)}},Object.defineProperty(e.prototype,"halfImgPath",{get:function(){return"servant_half_"+this.servantId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullImgPath",{get:function(){return"servant_full_"+this.servantId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"qualityBoxImgPath",{get:function(){return"servant_cardbg_"+this.clv},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"servantName",{get:function(){return LanguageManager.getlocal("servant_name"+this.servantId)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sound",{get:function(){return"effect_servant_"+this.servantId},enumerable:!0,configurable:!0}),e.prototype.isAtMaxLv=function(){var t=GameConfig.config.servantbaseCfg.servantLvList,e=t[String(this.clv)].upLv;return this.level!=e||t[String(this.clv+1)]?!1:!0},e.prototype.isAtTopLv=function(){var t=GameConfig.config.servantbaseCfg.servantLvList,e=t[String(this.clv)].upLv;return this.level>=e?!0:!1},e.prototype.isLvEnableForAdvance=function(){var t=GameConfig.config.servantbaseCfg.servantLvList,e=t[String(this.clv)].upLv;return this.level>=e&&t[String(this.clv+1)]?!0:!1},e.prototype.isAdvanceEnable=function(){var t=GameConfig.config.servantbaseCfg.servantLvList,e=t[String(this.clv)].upLv;if(this.level>=e&&t[String(this.clv+1)]){var i=t[String(this.clv+1)].needItem;for(var a in i){var n=Api.itemVoApi.getItemNumInfoVoById(Number(a));if(n<i[a])return!1}return!0}return!1},e.prototype.isSkillLvUpEnable=function(){for(var t=GameConfig.config.servantbaseCfg,e=t.skillUpgradeExp,i=t.skillLvLimit,a=0;a<this.skill.length;a++){var n=this.skill[a];if(i>n&&this.skillExp>=e[n-1])return!0}return!1},e.prototype.isBookLvUpEnable=function(){for(var t=GameConfig.config.abilitybaseCfg,e=t.typeList,i=t.numList,a={},n=GameConfig.config.servantCfg[this.servantId],o=n.ability,s=0;s<o.length;s++){var r=o[s],l=GameConfig.config.abilityCfg[r],h=this.ability[String(s)],d=GameConfig.config.servantbaseCfg.servantLvList[String(this.clv)],g=i[String(l.num)].abilityExp;if(h<d.abilityLv){var c=Api.itemVoApi.getItemNumInfoVoById(e[l.type]);(g<=this.abilityExp||c>=1)&&(a[String(s)]=s)}}return Object.keys(a).length>0?a:!1},e.prototype.isShowRedInServantList=function(){return Api.servantVoApi.isShowRedForItem()||this.isAdvanceEnable()||this.isSkillLvUpEnable()||this.isBookLvUpEnable()||this.isShowRedForaura()?!0:!1},e.prototype.getTotalBookValue=function(){for(var t=GameConfig.config.servantCfg[this.servantId],e=t.ability,i=0,a=0;a<e.length;a++){var n=e[a],o=GameConfig.config.abilityCfg[n],s=this.ability[String(a)];i+=s*o.num}return i},e.prototype.isShowRedForaura=function(){var t=GameConfig.config.servantCfg[this.servantId];if(t.aura){var e=t.aura[2];if(e.maxLv>this.aura[2]){var i=e.growNeed2,a=App.StringUtil.splitString(i,"_");if(Api.itemVoApi.getItemNumInfoVoById(a[1])>=Number(a[2]))return!0}}return!1},e.prototype.dispose=function(){this.level=0,this.hasexp=0,this.total=0,this.skillExp=0,this.clv=0,this.ability={},this.skill=[],this.abilityExp=0,this.aura={},this.attrVo&&(this.attrVo.dispose(),this.attrVo=null)},e}(BaseVo);__reflect(ServantInfoVo.prototype,"ServantInfoVo");var ServantVo=function(t){function e(){var e=t.call(this)||this;return e.servantInfoVoObj=null,e}return __extends(e,t),e.prototype.initData=function(t){if(t&&t.info){null==this.servantInfoVoObj&&(this.servantInfoVoObj={});for(var e in t.info)if(this.servantInfoVoObj[e])this.servantInfoVoObj[e].initData(t.info[e]);else{var i=new ServantInfoVo;i.servantId=e,i.initData(t.info[e]),this.servantInfoVoObj[e]=i}if(Object.keys(t.info).length>=15&&!Api.servantVoApi.isShowAtkraceGuide)for(var e in t.info)if(t.info[e].lv>=60){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_FUNCTION_TXT),Api.servantVoApi.isShowAtkraceGuide=!0,Api.servantVoApi.isCheckGuide&&(Api.rookieVoApi.curGuideKey="atkrace",Api.rookieVoApi.insertWaitingGuide({idx:"atkrace_1"},!0));break}Api.servantVoApi.isCheckGuide=!0}},e.prototype.dispose=function(){this.servantInfoVoObj=null},e}(BaseVo);__reflect(ServantVo.prototype,"ServantVo");var ShopInfoVo=function(t){function e(){var e=t.call(this)||this;return e.id=0,e.buyNum=0,e}return __extends(e,t),e.prototype.initData=function(t){null!=t.num&&(this.buyNum=Number(t.num)),null!=t.id&&(this.id=Number(t.id))},e.prototype.dispose=function(){this.id=0,this.buyNum=0},e}(BaseVo);__reflect(ShopInfoVo.prototype,"ShopInfoVo");var ShopVo=function(t){function e(){var e=t.call(this)||this;return e.updated_at=0,e.shopInfoVoObj=null,e.vipInfo=null,e.pay=null,e.payflag=0,e.monthcard=null,e.yearcard=null,e.lastUpdateTime=0,e.sinfo=null,e.version=0,e.st=0,e.et=0,e.hinfo=null,e.fourRateCharge=null,e}return __extends(e,t),e.prototype.initData=function(t){if(t&&(this.lastUpdateTime=GameData.serverTime,null!=t.updated_at&&(this.updated_at=Number(t.updated_at)),null!=t.vipinfo&&(this.vipInfo=t.vipinfo),null!=t.pay&&(this.pay=t.pay),null!=t.payflag&&(this.payflag=Number(t.payflag)),null!=t.monthcard&&(this.monthcard=t.monthcard),null!=t.yearcard&&(this.yearcard=t.yearcard),t.info)){null!=t.info.version&&(this.version=t.info.version),t.info.st&&(this.st=t.info.st),t.info.et&&(this.et=t.info.et),null==this.shopInfoVoObj&&(this.shopInfoVoObj={}),t.info.hinfo&&(this.hinfo=t.info.hinfo),t.info.fourRateCharge&&(this.fourRateCharge=t.info.fourRateCharge),(null==this.hinfo||0==Object.keys(this.hinfo).length)&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_SHOP_NEXTDAY),0==Object.keys(t.info.sinfo).length&&(this.shopInfoVoObj={});for(var e in t.info.sinfo)if(this.shopInfoVoObj[e])this.shopInfoVoObj[e].initData({id:Number(e),num:t.info.sinfo[e]});else{var i=new ShopInfoVo;i.initData({id:Number(e),num:t.info.sinfo[e]}),this.shopInfoVoObj[e]=i}}},e.prototype.dispose=function(){if(this.updated_at=0,this.shopInfoVoObj)for(var t in this.shopInfoVoObj)this.shopInfoVoObj[t]&&(this.shopInfoVoObj[t].dispose(),this.shopInfoVoObj[t]=null);this.shopInfoVoObj=null,this.vipInfo=null,this.pay=null,this.payflag=0,this.monthcard=null,this.lastUpdateTime=0,this.version=0,this.st=0,this.et=0},e}(BaseVo);__reflect(ShopVo.prototype,"ShopVo");var StudyatkTableInfoVo=function(t){function e(){var e=t.call(this)||this;return e.atklist=[],e}return __extends(e,t),e.prototype.initData=function(t){t.studyatk},e.prototype.dispose=function(){},e}(BaseVo);__reflect(StudyatkTableInfoVo.prototype,"StudyatkTableInfoVo");var StudyatkVo=function(t){function e(){var e=t.call(this)||this;return e.atkList=[],e.goout_time=0,e.join_uid=0,e.skillrate=0,e.create_time=0,e.join_st=0,e}return __extends(e,t),e.prototype.initData=function(t){if(t.studyatk){if(t.studyatk.atklist)for(var e=t.studyatk.atklist,i=0;i<e.length;i++){var a=this.atkList[i];null==a&&(a=new StudyatkTableInfoVo,this.atkList.push(a)),a.initData(e[i])}null!=t.studyatk.skillinfo&&(this.skillinfo=t.studyatk.skillinfo),null!=t.studyatk.goout_time&&(this.goout_time=t.studyatk.goout_time),null!=t.studyatk.finishinfo&&(this.finishinfo=t.studyatk.finishinfo),null!=t.studyatk.join_uid&&(this.join_uid=t.studyatk.join_uid),null!=t.studyatk.skillrate&&(this.skillrate=t.studyatk.skillrate),null!=t.studyatk.create_time&&(this.create_time=t.studyatk.create_time),null!=t.studyatk.join_st&&(this.join_st=t.studyatk.join_st),null!=t.studyatk.atkinfo&&(this.atkinfo=t.studyatk.atkinfo)}},e.prototype.dispose=function(){this.atkList=[],this.skillinfo=null,this.finishinfo=null,this.goout_time=0,this.join_uid=0,this.skillrate=0,this.create_time=0,this.join_st=0,this.atkinfo=null},e}(BaseVo);__reflect(StudyatkVo.prototype,"StudyatkVo");var SwitchVo=function(t){function e(){var e=t.call(this)||this;return e.switchList={},e}return __extends(e,t),e.prototype.initData=function(t){for(var e in t)this.switchList[e]=t[e]?Number(t[e]):0},e.prototype.dispose=function(){this.switchList={}},e}(BaseVo);__reflect(SwitchVo.prototype,"SwitchVo");var MainTaskVo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initData=function(t){t.info&&(this.value=t.info.v,this.taskId=t.info.id,App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_RESCHANGE_REFRESH_UI))},e.prototype.dispose=function(){this.value=0,this.taskId=null},e}(BaseVo);__reflect(MainTaskVo.prototype,"MainTaskVo");var TradeInfoVo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initData=function(t){null!=t.cid&&(this.cid=t.cid,this.rewards=t.rewards)},e.prototype.dispose=function(){this.cid=null,this.rewards=null},e}(BaseVo);__reflect(TradeInfoVo.prototype,"TradeInfoVo");var TradeVo=function(t){function e(){var e=t.call(this)||this;return e.point=0,e.lastday=0,e.updated_at=0,e.rewards=null,e.batchFlag=0,e}return __extends(e,t),e.prototype.initData=function(t){null!=t.point&&(this.point=t.point),null!=t.lastday&&(this.lastday=t.lastday),null!=t.updated_at&&(this.updated_at=t.updated_at),null!=t.info&&(this.cid=t.info.cid,this.rewards=t.info.rewards),null!=t.flag&&(this.batchFlag=t.flag)},e.prototype.dispose=function(){this.point=0,this.lastday=0,this.updated_at=0,this.cid=null,this.rewards=null,this.batchFlag=0},e}(BaseVo);__reflect(TradeVo.prototype,"TradeVo");var WifeInfoVo=function(t){function e(){var e=t.call(this)||this;return e.id=0,e.intimacy=0,e.glamour=0,e.exp=0,e.child=0,e}return __extends(e,t),e.prototype.initData=function(t){t&&(null!=t.intimacy&&(this.intimacy=Number(t.intimacy)),null!=t.exp&&(this.exp=Number(t.exp)),null!=t.child&&(this.child=Number(t.child)),null!=t.skill&&(this.skill=t.skill),null!=t.glamour&&(this.glamour=Number(t.glamour)))},Object.defineProperty(e.prototype,"name",{get:function(){return this.cfg.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"desc",{get:function(){return this.cfg.desc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"words",{get:function(){return this.cfg.words},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unlock",{get:function(){return this.cfg.wifeunlock},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bg",{get:function(){return this.cfg.bg},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this.cfg.icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return this.cfg.body},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"body2",{get:function(){return this.cfg.body2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bone",{get:function(){return this.cfg.bone},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bone2",{get:function(){return this.cfg.bone2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sound",{get:function(){return this.cfg.sound},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.WifeCfg.getWifeCfgById(this.id.toString())},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.id=0,this.intimacy=0,this.exp=0,this.child=0,this.skill=null,this.glamour=0},e}(BaseVo);__reflect(WifeInfoVo.prototype,"WifeInfoVo");var WifeskinInfoVo=function(t){function e(){var e=t.call(this)||this;return e.id="",e}return __extends(e,t),e.prototype.initData=function(t){t&&(null!=t.skin&&(this.skin=t.skin),null!=t.equip&&(this.equip=t.equip))},Object.defineProperty(e.prototype,"name",{get:function(){return this.cfg.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"desc",{get:function(){return this.cfg.desc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"words",{get:function(){return this.cfg.words},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.WifeskinCfg.getWifeCfgById(this.id.toString())},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.id="",this.skin=0,this.equip=null},e}(BaseVo);__reflect(WifeskinInfoVo.prototype,"WifeskinInfoVo");var WifeskinVo=function(t){function e(){var e=t.call(this)||this;return e.wifeSkinInfoVoObj=null,e}return __extends(e,t),e.prototype.initData=function(t){if(t&&t.info){null==this.wifeSkinInfoVoObj&&(this.wifeSkinInfoVoObj={});
for(var e in t.info)if(this.wifeSkinInfoVoObj[e])this.wifeSkinInfoVoObj[e].initData(t.info[e]);else{var i=new WifeskinInfoVo;i.id=String(e),i.initData(t.info[e]),this.wifeSkinInfoVoObj[e]=i}}},e.prototype.dispose=function(){if(this.wifeSkinInfoVoObj)for(var t in this.wifeSkinInfoVoObj)this.wifeSkinInfoVoObj[t],this.wifeSkinInfoVoObj[t].dispose(),this.wifeSkinInfoVoObj[t]=null;this.wifeSkinInfoVoObj=null},e}(BaseVo);__reflect(WifeskinVo.prototype,"WifeskinVo");var WifeVo=function(t){function e(){var e=t.call(this)||this;return e.wifeInfoVoObj=null,e.energy_num=0,e.energy_st=0,e}return __extends(e,t),e.prototype.initData=function(t){if(t&&(null!=t.energy&&(null!=t.energy.st&&(this.energy_st=t.energy.st),null!=t.energy.num&&(this.energy_num=t.energy.num)),t.info)){null==this.wifeInfoVoObj&&(this.wifeInfoVoObj={});for(var e in t.info)if(this.wifeInfoVoObj[e])this.wifeInfoVoObj[e].initData(t.info[e]);else{var i=new WifeInfoVo;i.id=Number(e),i.initData(t.info[e]),this.wifeInfoVoObj[e]=i}}},e.prototype.dispose=function(){if(this.wifeInfoVoObj)for(var t in this.wifeInfoVoObj)this.wifeInfoVoObj[t],this.wifeInfoVoObj[t].dispose(),this.wifeInfoVoObj[t]=null;this.energy_num=0,this.energy_st=0,this.wifeInfoVoObj=null},e}(BaseVo);__reflect(WifeVo.prototype,"WifeVo");var WifestatusVo=function(t){function e(){var e=t.call(this)||this;return e.star=0,e.level="",e.info=null,e}return __extends(e,t),e.prototype.initData=function(t){t&&(null!=t.star&&(this.star=Number(t.star)),null!=t.level&&(this.level=String(t.level)),null!=t.info&&(this.info=t.info))},e.prototype.dispose=function(){this.star=null,this.level=null,this.info=0},e}(BaseVo);__reflect(WifestatusVo.prototype,"WifestatusVo");var PlatformCfg;!function(t){t.bindPhone={},t.weichatPub={},t.useSDK={17001000:"0",17001001:"1",17001002:"1",devsdk:"1"},t.closeSwitchAcount={fkylc:"1",wanba:"1"},t.platNameCfg={17001000:"3k",17004000:"tw"},t.contactCfg={17001002:["客服QQ:3004776131","客服电话:400-993-3348"],"17001003-17001137":["客服QQ:3557595700"],17005000:["官方QQ群：497564630"],17007001:["官方QQ群：641188812"],17003000:["官方QQ群：496098831"],17009000:["客服QQ:2198936198"],"17009004-17009005":["客服QQ群: 724420901"]},t.statementCfg={17007000:"审批文号：新广出审【2014】1247号  出版物号：ISBN-978-7-89988-124-8\n著作权人：杭州汉唐文化传播有限公司  出版服务单位：杭州汉唐文化传播有限公司\n备案文号：文网游备字〔2018〕Ｍ-RPG 0604 号  适龄提示：16岁以上",17003000:"审批文号：新广出审【2014】1247号  出版物号：ISBN-978-7-89988-124-8\n著作权人：杭州汉唐文化传播有限公司  出版服务单位：杭州汉唐文化传播有限公司"}}(PlatformCfg||(PlatformCfg={}));var PlatformManager;!function(t){function e(){try{if(rsdkclientplugin)return rsdkclientplugin.getVersion()}catch(t){return"0"}return"0"}function i(){try{if(RSDK&&RSDK.getAppid)return RSDK.getAppid()}catch(t){try{if(SDK&&SDK.CommonUtil&&SDK.CommonUtil.appId)return SDK.CommonUtil.appId}catch(t){return""}}}function a(){var t=egret.getOption("r_bid");if(!t){var e=Number(i());t=String(1e3*Math.floor(e/1e3))}return String(t)}function n(){if(PlatformCfg.contactCfg[t.getAppid()])return PlatformCfg.contactCfg[t.getAppid()];if(PlatformCfg.contactCfg[t.getBigAppid()])return PlatformCfg.contactCfg[t.getBigAppid()];for(var e in PlatformCfg.contactCfg)if(e.indexOf("-")>-1){var i=e.split("-"),a=Number(t.getAppid());Number(t.getBigAppid());if(a>=Number(i[0])&&a<=Number(i[1]))return PlatformCfg.contactCfg[e]}return[]}function o(){var t;t=App.DeviceUtil.isWXgame()?"wxgame":P()?I()?"3k":NetManager.checkHttps()?"locals":"local":l()?"iosshenhe":b()?"wanba":R()?"3k":N()?"yyb":L()?"tw":h()?"fkylc":p()?"xly":_()?"xzy":u()?"zjlx":C()?"ewan":f()?"49y":m()?"sf":E()?"kr":T()?"fkcw":y()?"en":v()?"9130":M()?"test":"3k";var e=r();return e&&!l()&&(t=e),t}function s(){try{App.LogUtil.log("getSpid"+o()),App.LogUtil.log("checkIsWeiduan"+I()),console.log("getAppid"+i()),console.log("getBigAppid"+a())}catch(t){console.log("checkIsUseSDK log error")}if(App.DeviceUtil.isWXgame())return!1;if(egret.getOption("r_plat"))return!0;if(PlatformCfg.useSDK[a()]||PlatformCfg.useSDK[i()])return!0;if(o().indexOf("local")>-1)return I()?!0:!1;if("3k"==o()){if(1==w())return I()?!0:!1}else if("wanba"==o()){if(1==w())return ServerCfg.checkTestByBaseDiv()&&document.location.search?!0:!1}else{if("test"==o())return!1;if(1==w())return!1}return!0}function r(){var t=PlatformCfg.platNameCfg[a()];return t||(t=PlatformCfg.platNameCfg[i()]),t}function l(){if(App.DeviceUtil.IsHtml5()){var t=window.location.pathname;return t.indexOf("iosshenhe")>-1}return!1}function h(){if(App.DeviceUtil.IsHtml5()){var t=window.location.pathname;return t.indexOf("fkylc")>-1}return!1}function d(){return"17007002"==t.getAppid()?!0:!1}function g(){return"17004001"==t.getAppid()?!0:!1}function c(){return t.checkIsKRSp()&&App.DeviceUtil.isIOS()&&Api.switchVoApi.checkOpenShenhe()?!0:!1}function p(){if(App.DeviceUtil.IsHtml5()){var t=window.location.pathname;return t.indexOf("xly")>-1}return!1}function _(){if(App.DeviceUtil.IsHtml5()){var t=window.location.pathname;return t.indexOf("xzy")>-1}return!1}function u(){if(App.DeviceUtil.IsHtml5()){var t=window.location.pathname;return t.indexOf("zjly")>-1}return!1}function C(){if(App.DeviceUtil.IsHtml5()){var t=window.location.pathname;return t.indexOf("ewan")>-1}return!1}function f(){if(App.DeviceUtil.IsHtml5()){var t=window.location.pathname;return t.indexOf("49y")>-1}return!1}function m(){if(App.DeviceUtil.IsHtml5()){var t=window.location.pathname;return t.indexOf("_sf")>-1||t.indexOf("_testsf")>-1}return!1}function T(){if(App.DeviceUtil.IsHtml5()){var t=window.location.pathname;return t.indexOf("_fkcw")>-1||t.indexOf("_testfkcw")>-1}return!1}function y(){if(App.DeviceUtil.IsHtml5()){var t=window.location.pathname;return t.indexOf("_en")>-1||t.indexOf("_testen")>-1}return!1}function v(){if(App.DeviceUtil.IsHtml5()){var t=window.location.pathname;return t.indexOf("_9130")>-1||t.indexOf("_test9130")>-1}return!1}function A(){if(App.DeviceUtil.IsHtml5()){var t=void 0,e=window.location.pathname;return"/"!=e.substr(e.length)?(t=e.substr(e.lastIndexOf("/")+1),t&&t.indexOf(".")>-1&&(t=e.substring(0,e.lastIndexOf("/")),t=t.substr(e.lastIndexOf("/")+1))):(t=e.substring(0,e.length),t=t.substr(e.lastIndexOf("/")+1)),t.replace("gt_test","").replace("gt_","")}return"local"}function w(){if(App.DeviceUtil.IsHtml5()){var t=window.location.pathname;return t.indexOf("_test")>-1}return!1}function x(){var e=!1;return App.DeviceUtil.IsHtml5()&&(window.RSDKPlatform&&(e=!0),e=window.RSDKWebSocket?!0:!1),e=e&&t.client.getAndroidAPILevel()>0&&t.client.getAndroidAPILevel()<21?!0:!1}function I(){var t=!1;return App.DeviceUtil.IsHtml5()&&window&&(window.RSDKPlatform?t=!0:window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.RSDKLogin&&(t=!0)),t}function L(){if(App.DeviceUtil.IsHtml5()){var t=window.location.pathname;return t.indexOf("_tw")>-1||t.indexOf("_testtw")>-1}return!1}function E(){if(App.DeviceUtil.IsHtml5()){var t=window.location.pathname;return t.indexOf("_kr")>-1||t.indexOf("_testkr")>-1}return!1}function B(){return"17004004"==t.getAppid()?!0:!1}function S(){return"17007003"==t.getAppid()?!0:!1}function N(){if(App.DeviceUtil.IsHtml5()){var t=window.location.host;return t.indexOf("yyb")>-1}return!1}function M(){if(App.DeviceUtil.IsHtml5()){var t=window.location.host;return t.indexOf("gt-test")>-1}return!1}function b(){if(App.DeviceUtil.IsHtml5()){var t=window.location.pathname,e=window.location.host;return t.indexOf("wanba")>-1||e.indexOf("urlshare")>-1||e.indexOf("qzone")>-1}return!1}function O(){return"17001002"==t.getAppid()?!0:!1}function V(){return"17001195"==t.getAppid()||"17001196"==t.getAppid()||"17001197"==t.getAppid()||"17001198"==t.getAppid()?!0:!1}function R(){return P()&&I()?!0:App.DeviceUtil.IsHtml5()?window.location.pathname.indexOf("3k")>-1:!1}function k(){return"17001001"==i()||"17001186"==i()||"17001187"==i()||"17001185"==i()||"h5ios3kwan"==ge()||"h5iosshiyiwan"==ge()||"h5iosyinhu"==ge()}function P(){return GameData.isLocal()}function F(){return console.log("QAZ fkcw checkDesktop"+t.checkDesktop()),t.checkDesktop()}function D(){if(App.DeviceUtil.IsHtml5()&&b()&&s()){var t=window.OPEN_DATA,e=(t.platform,t.qua.app);return e}return""}function G(){return"SQ"==D()}function H(){if(App.DeviceUtil.IsHtml5()&&b()&&s()){var t=window.OPEN_DATA,e=t.via;return egret.log("ssSource"+t.via),e}return""}function U(){return console.log("QAZ fkcw checkShare"+t.checkShare()),1==t.checkShare()}function W(){return h()&&!S()||_()}function Y(){return PlatformCfg.bindPhone[i()]}function q(e,i){!App.DeviceUtil.IsMobile()&&L()?window.open("resource/other/一個官人七個妻.url"):t.requestDesktop({title:"极品大官人",desc:""},e,i)}function j(t,e,i){qqwanbaplugin.sendCandy("signin",t,e.bind(i))}function Q(t,e){RSDKHelper.isInit&&(1==L()?RSDKHelper.fbShare(function(i,a){16==Number(i)?t&&t.apply(e):console.log("分享失败 "+i)}):1==E()?RSDKHelper.krShare(function(i,a){16==Number(i)?t&&t.apply(e):console.log("分享失败 "+i)}):RSDKHelper.share(function(i,a){0==Number(i)&&t&&t.apply(e)}))}function K(){var e=!1;return e=s()?t.isLogin:!0}function Z(){s()&&RSDKHelper.init()}function X(){RSDKHelper.isInit&&RSDKHelper.login()}function z(){return t.isLogin=!1,RSDKHelper.isInit?(RSDKHelper.logout(),t.checkIsKRSp()?!0:!1):(LoginManager.changeAccount(),!0)}function J(e){t.checkIsUseSDK()?RSDKHelper.isInit&&RSDKHelper.pay(e):GameData.isLocal()&&$(e)}function $(t){var e=Config.RechargeCfg.getRechargeItemCfgByKey(t);if(GameData.isLocal()||GameData.isTest()){var i=String((new Date).getTime()+99999999*Math.random());NetManager.request(NetRequestConst.REQUEST_PAY_RROCCESSPAYMENT,{order_id:i,gold_num:e.gemCost,platform:"h5",name:e.id})}else App.CommonUtil.showTip("购买元宝:"+e.gemCost)}function te(){RSDKHelper.isInit&&RSDKHelper.analyticsLogin()}function ee(t){RSDKHelper.isInit&&RSDKHelper.analyticsNewGuide(t)}function ie(t,e){RSDKHelper.isInit&&RSDKHelper.analyticsPay(t,e)}function ae(){RSDKHelper.isInit&&RSDKHelper.analyticsLevelup()}function ne(){RSDKHelper.isInit&&RSDKHelper.analyticsRegister()}function oe(){RSDKHelper.isInit&&RSDKHelper.analyticsLoadEnd()}function se(t){if(1==G()){var e=LanguageManager.getlocal("wanbaPushMsg"+t.type);qqwanbaplugin.sendMessage(t.frd,"1",e,null)}}function re(){var t=null;return 1==b()&&s()&&(t=qqwanbaplugin.getGiftId()),t}function le(t,e){1==b()&&s()&&qqwanbaplugin.giftExchange(t.bind(e))}function he(){return!1}function de(){if(App.DeviceUtil.IsHtml5())try{var t=window.location.host,e=document.baseURI;return e&&e.indexOf(t)>-1?!1:!0}catch(i){return!1}return!1}function ge(){var t="";return App.DeviceUtil.IsHtml5()&&(t=egret.getOption("r_plat")),t}function ce(){console.log("attention:"+RSDKHelper.isInit),RSDKHelper.isInit&&RSDKHelper.attention()}function pe(){return RSDKHelper.isInit?RSDKHelper.checkAttention():!1}function _e(){try{return RSDK.getChannelId()}catch(t){return""}}function ue(){rsdkclientplugin&&rsdkclientplugin.openUserCenter()}function Ce(){return L()?"$":E()?App.DeviceUtil.isAndroid()?"원":"$":"￥"}function fe(){return L()}function me(){return"17001001"==t.getAppid()||"17001051"==t.getAppid()||"17001188"==t.getAppid()?!0:!1}function Te(){return L()||E()?!1:!0}function ye(){var e=t.getAppid(),i=t.getBigAppid(),a=t.getSpName();return PlatformCfg.statementCfg[e]?PlatformCfg.statementCfg[e]:PlatformCfg.statementCfg[i]?PlatformCfg.statementCfg[i]:PlatformCfg.statementCfg[a]?PlatformCfg.statementCfg[a]:""}function ve(){return RSDKHelper.isInit?RSDKHelper.checkShare():0}function Ae(){return RSDKHelper.isInit?RSDKHelper.checkDesktop():!1}function we(){return RSDKHelper.isInit?RSDKHelper.getCustomerServiceType():0}function xe(t,e){RSDKHelper.isInit&&RSDKHelper.getCustomerService(function(i){t&&(GameData.customerServiceData=i,t.apply(e))})}function Ie(t,e,i){return RSDKHelper.isInit?RSDKHelper.requestDesktop(t,e,i):!1}function Le(){return t.checkIsTWBSp()&&(!App.DeviceUtil.IsMobile()||"17004003"==t.getAppid())}function Ee(){try{t.checkIsWanbaSp()&&App.DeviceUtil.isAndroid()&&t.getIsWanbaSQ()&&"nwd"===Api.gameinfoVoApi.getDownType()&&qqwanbaplugin.checkDownloadApp(function(t){App.DeviceUtil.wanbaIsDownloadApp=t,t&&ViewController.getInstance().openView(ViewConst.POPUP.DOWNLOADVIEW,{})})}catch(e){console.log("checkDownloadApp error")}}function Be(){var e=[17013e3],i=[17001263,17014002],a=Number(t.getBigAppid()),n=e.indexOf(a)>-1,o=Number(t.getAppid()),s=i.indexOf(o)>-1;return t.checkIsIOSShenheSp()&&(s||n)}function Se(){return t.checkIs11WanSp()||t.checkIs3kShenHaiSp()||PlatformCfg.closeSwitchAcount[t.getSpid()]&&!t.checkIsTest()||"17001213"==String(t.getAppid())||"17017000"==String(t.getBigAppid())}t.isLogin=!1,t.kkk_age=0,t.getAppVersion=e,t.getAppid=i,t.getBigAppid=a,t.getContact=n,t.getSpid=o,t.checkIsUseSDK=s,t.getPlatName=r,t.checkIsIOSShenheSp=l,t.checkIsFkylcSp=h,t.checkIsAiweiyouSp=d,t.checkIsTWShenheSp=g,t.checkIsKRShenhe=c,t.checkIsXlySp=p,t.checkIsXzySp=_,t.checkIsZjlxSp=u,t.checkIsEwanSp=C,t.checkIs49ySp=f,t.checkIsSfSp=m,t.checkIsFkcwSp=T,t.checkIsEnSp=y,t.checkIs9130Sp=v,t.getSpFile=A,t.checkIsTest=w,t.checkUseRSDKSocket=x,t.checkIsWeiduan=I,t.checkIsTWBSp=L,t.checkIsKRSp=E,t.checkIsTWMCSp=B,t.checkIs4399Sp=S,t.checkIsYYBSp=N,t.checkIsTestSp=M,t.checkIsWanbaSp=b,t.checkIs11WanSp=O,t.checkIs3kShenHaiSp=V,t.checkIs3KSp=R,t.checkIs3KSubSp=k,t.checkIsLocal=P,t.isSupportDesktopIcon=F,t.getIsWanbaSQ=G,t.getFromQZonePet=H,t.isSupportShare=U,t.isSupportAttention=W,t.isSupportBindPhone=Y,t.sendToDesktop=q,t.sendCandy=j,t.share=Q,t.checkIsLoginPlat=K,t.init=Z,t.login=X,t.logout=z,t.pay=J,t.analyticsLogin=te,t.analyticsNewGuide=ee,t.analyticsPay=ie,t.analyticsLevelup=ae,t.analyticsRegister=ne,t.analyticsLoadEnd=oe,t.pushMsg=se,t.getGiftId=re,t.giftExchange=le,t.getCandyFlag=he,t.checkCrossDomon=de,t.getSpName=ge,t.attention=ce,t.checkAttention=pe,t.getChannelId=_e,t.openUserCenter=ue,t.getMoneySign=Ce,t.checkIsUseBigCfg=fe,t.checkIs3kQianYiSp=me,t.checkIsShowWarning=Te,t.getStatement=ye,t.checkShare=ve,t.checkDesktop=Ae,t.getCustomerServiceType=we,t.getCustomerServiceData=xe,t.requestDesktop=Ie;var Ne;!function(e){function i(t){I()?rsdkclientplugin.checkServerState(t):App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_TWLOGIN)}function a(t){App.DeviceUtil.isAndroid()&&rsdkclientplugin.checkPurchase(t)}function n(){return t.kkk_age>0}function o(t){return rsdkclientplugin?rsdkclientplugin.showPersonView(t):void 0}function s(){try{if(App.DeviceUtil.isAndroid())return App.LogUtil.log("getAndroidAPILevel"+rsdkclientplugin.getAndroidAPILevel()),Number(rsdkclientplugin.getAndroidAPILevel())}catch(t){return 0}return 0}function r(){return rsdkclientplugin?rsdkclientplugin.getGUID():null}function l(){RSDK.customerService("")}function h(t,e){return rsdkclientplugin?rsdkclientplugin.showBindPhoneView(t.bind(e)):void 0}function d(){return rsdkclientplugin?rsdkclientplugin.checkBindPhone():!1}function g(){if(I()&&rsdkclientplugin)try{console.log("QAZ setAppForeground "),rsdkclientplugin.setAppForegroundStatusChangeCallback(function(t){console.log("QAZ setAppForeground Callback "+t),1==Number(t)?SoundManager.resumeBg():SoundManager.pauseBg()})}catch(t){App.LogUtil.log("setAppForegroundStatusChange error")}}function c(){if(t.checkIs3KSp()&&App.DeviceUtil.IsHtml5())try{var e=Number(rsdkclientplugin.getVersion()),i=t.getChannelId(),a=rsdkclientplugin.getSubAppId(),n=ServerCfg.baseUrl+"getversion.php",o=window.location.host;(-1!=o.indexOf("127.0.0.1")||-1!=o.indexOf("192.168."))&&(n="http://192.168.8.82/gt_h5/getversion.php"),NetLoading.show(),NetManager.http.get(n,{version:e,appid:i+"_"+a},function(t){NetLoading.hide(),t&&t.gameurl&&ViewController.getInstance().openView(ViewConst.POPUP.WEIDUANUPGRADEPOPUPVIEW,t.gameurl)},function(){NetLoading.hide()},t)}catch(s){NetLoading.hide()}}e.checkServerState=i,e.checkPurchase=a,e.checkPerson=n,e.showPersonView=o,e.getAndroidAPILevel=s,e.getGUID=r,e.openServiceCenter=l,e.showBindPhoneView=h,e.checkBindPhone=d,e.setAppForegroundStatusChange=g,e.checkWeiduanUpgrade=c}(Ne=t.client||(t.client={})),t.checkIsTwWeb=Le,t.checkDownloadApp=Ee,t.checkIsShenHeYiWan=Be,t.checkHideSwitchAccountBtn=Se}(PlatformManager||(PlatformManager={}));var RSDKHelper;!function(t){function e(){App.DeviceUtil.IsHtml5()&&PlatformManager.checkIsFkylcSp()&&(window.shareTitle="想成就一番伟业么？",window.shareDesc="开服是个芝麻官，七天之后当王爷！",window.shareImgUrl="http://gt-fkylc-cdn.raygame3.com/gt_fkylc/shareicon.png"),RSDK.init({privateKey:"8505ED51CF9A766254A39F5762030153",debug:!1},function(e,i){t.isInit=!0,console.log("初始化结果"+e),App.LoginResLoader.isDefaultResLoaded&&App.LoginResLoader.initPlatCfg(),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_RSDK_INIT_SUCCESS),PlatformManager.client.setAppForegroundStatusChange()})}function i(){RSDK.login("",function(t,e){console.log("登录::"+t+"::"+App.StringUtil.toString(e)),0==Number(t)?(PlatformManager.userId=e.userId,PlatformManager.prefix=e.prefix,PlatformManager.userType=e.userType,PlatformManager.token=e.token,PlatformManager.isLogin=!0,PlatformManager.nickname=e.nickname,PlatformManager.avatar=e.avatar,PlatformManager.inviter_pid=e.inviter_pid,PlatformManager.inviter_uid=e.inviter_uid,App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_PLAT_LOGIN_SUCCESS)):-1==Number(t)||-2==Number(t)||(1001==Number(t)?PlatformManager.isSupportBindPhone()&&(GameData.kkkIsBindIos=String(e.msg),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_IOS_BINDPHONE,{result:String(e.msg)})):1002==Number(t)?PlatformManager.kkk_age=Number(e.msg):1003==Number(t)?(console.log("检查服务器:"+t+"  "+e.msg),1==Number(e.msg)&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_TWLOGIN)):1004==Number(t)&&(console.log("检查账号绑定:"+t+"  "+e.msg),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_BIND,e.msg)))},function(t,e){console.log("登出::"+t),0==Number(t)&&(PlatformManager.isLogin=!1,App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_LOGOUT),LoginManager.changeAccount())})}function a(){RSDK.logout()}function n(t){var e=Config.RechargeCfg.getRechargeItemCfgByKey(t);if(PlatformManager.checkIsWanbaSp()){var i=window.OPEN_DATA,a=i.platform;i.qua.app;t=Config.RechargeCfg.wanbaCfg[t]["pid"+a],window.__payError=function(){App.CommonUtil.showTip(LanguageManager.getlocal("payFailTip"))},window.__payClose=function(){App.CommonUtil.showTip(LanguageManager.getlocal("payCancelTip"))}}else e.orderid&&(t=e.orderid);var n=new productInfo;if(n.coinNum=e.gemCost.toString(),n.currency="CNY",PlatformManager.checkIsKRSp()&&(App.DeviceUtil.isAndroid()?n.currency="KRW":App.DeviceUtil.isIOS()&&(n.currency="USD")),n.gameUserId=GameData.userId.toString(),n.gameUserName=Api.playerVoApi.getPlayerName(),n.price=e.cost.toString(),d()){var i={channelId:"17003002",allProductId:Config.RechargeCfg.getAllProductid().join(",")};n.privateData=JSON.stringify(i)}else n.privateData=JSON.stringify({allProductId:Config.RechargeCfg.getAllProductid().join(",")});n.productCount="1",n.productId=t,n.productName=e.gemCost+LanguageManager.getlocal("gemName"),n.productType="1",n.roleLevel=Api.playerVoApi.getPlayerLevel().toString(),n.roleVipLevel=Api.playerVoApi.getPlayerVipLevel().toString(),n.serverId=ServerCfg.selectServer.zid,n.serverName=ServerCfg.selectServer.sname?ServerCfg.selectServer.sname:ServerCfg.selectServer.zid,RSDK.pay(n,function(t,i){if(PlatformManager.checkIsWanbaSp()&&i&&null!=i.balance){var a=Number(i.balance);0==isNaN(a)&&ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{msg:LanguageManager.getlocal("paySuccessLeftMoneyTip",[String(10*e.cost),String(e.gemCost),String(a),Config.RechargeCfg.getMoneyName()]),title:"itemUseConstPopupViewTitle",touchMaskClose:!0})}})}function o(t){var e=LanguageManager.getShareDesc(),i={title:"想成就一番伟业么？",desc:e||"开服是个芝麻官，七天之后当王爷！"};RSDK.share(i,t)}function s(t){var e=LanguageManager.getShareDesc(),i={title:"想成就一番伟业么？",desc:e||"开服是个芝麻官，七天之后当王爷！"};RSDK.setShareInfo(i,t)}function r(t){console.log("QAZ fbShare");var e=LanguageManager.getShareDesc(),i={title:"一個官人七個妻 真實體驗古風官場生活",desc:e||"好男兒生當作人傑，三妻四妾，封王拜侯，爭雄稱霸!\n春風得意馬蹄疾，一日看盡長安花！快意一生！",imageurl:"http://pic.heyyogame.com/panwuxi/picture/201711220fa85dce39574e4e3640ad85370e16ed.jpg",link:"https://adv.heyyogame.com/adv.jsp?gamecode=GD&partnerName=share&advcode=GD_yypV_414"};RSDK.share(i,t)}function l(t){console.log("QAZ krShare");var e=LanguageManager.getShareDesc(),i={title:"역천인 - 이제까지 없던 정통 사극 RPG!",desc:e||"역사 속 위대한 위인, 경국지색의 미녀들과 함께 써나가는 당신만의 장대한 서사시. 신분의 한계를 뛰어넘어 왕이 되어라!",imageurl:"https://yccs.mayngames.co.kr/img/fbshare1.jpg",link:"https://yccs.mayngames.co.kr/fbshare"};RSDK.share(i,t)}function h(t,e){if(!PlatformManager.checkIsKRShenhe())try{var i=d();if(i)switch(t){case N:case M:case b:case V:e.channelId="17003002"}RSDK.trackEvent(t,e)}catch(a){App.LogUtil.log("前端统计报错:"+t)}}function d(){return Api.switchVoApi.checkWifeAni()&&Api.switchVoApi.checkOpenWifeAbTest()}function g(){try{if(PlatformManager.checkIsWanbaSp()){var t=!0;1==GameData.closeSource&&(t=!1),t&&window&&window.reportLogin&&window.reportLogin()}}catch(e){}var i={};i.userId=PlatformManager.userId,i.gameUserId=GameData.userId.toString(),i.gameUserName=Api.playerVoApi.getPlayerName()?Api.playerVoApi.getPlayerName():GameData.userId.toString(),i.roleLevel=Api.playerVoApi.getPlayerLevel().toString(),i.roleVipLevel=Api.playerVoApi.getPlayerVipLevel().toString(),i.serverId=ServerCfg.selectServer.zid,i.serverName=ServerCfg.selectServer.sname,i.registerTime=Api.gameinfoVoApi.getRegdt().toString(),i.balance=Api.playerVoApi.getPlayerGem().toString(),i.guild_name=Api.playerVoApi.getPlayerAllianceName(),i.guild_id="0"==Api.playerVoApi.getPlayerAllianceId().toString()?"":Api.playerVoApi.getPlayerAllianceId().toString(),i.fighting=Api.playerVoApi.getPlayerPower().toString(),i.loginType=0,h(N,i)}function c(t){var e={};e.gameUserId=GameData.userId.toString(),e.serverId=ServerCfg.selectServer.zid,e.step=String(t),h(M,e)}function p(){if(PlatformManager.checkIsWanbaSp()){var t=!0;1==GameData.closeSource&&(t=!1),console.log("report"+(t?1:0)),t&&window&&window.reportRegister&&window.reportRegister()}var e={};e.userId=PlatformManager.userId,e.gameUserId=GameData.userId.toString(),e.gameUserName=Api.playerVoApi.getPlayerName()?Api.playerVoApi.getPlayerName():GameData.userId.toString(),e.roleLevel=Api.playerVoApi.getPlayerLevel().toString(),e.roleVipLevel=Api.playerVoApi.getPlayerVipLevel().toString(),e.serverId=ServerCfg.selectServer.zid,e.serverName=ServerCfg.selectServer.sname,e.registerTime=Api.gameinfoVoApi.getRegdt().toString(),e.balance=Api.playerVoApi.getPlayerGem().toString(),e.guild_name=Api.playerVoApi.getPlayerAllianceName(),e.guild_id="0"==Api.playerVoApi.getPlayerAllianceId().toString()?"":Api.playerVoApi.getPlayerAllianceId().toString(),e.fighting=Api.playerVoApi.getPlayerPower().toString(),e.loginType=1,h(b,e),PlatformManager.checkIsTWBSp()&&!PlatformManager.checkIsTest()&&StatisticsHelper.report_register_tw()}function _(t,e){var i=Config.RechargeCfg.getRechargeItemCfgByKey(t),a={};a.gameUserId=GameData.userId.toString(),a.gameUserName=Api.playerVoApi.getPlayerName(),a.roleLevel=Api.playerVoApi.getPlayerLevel().toString(),a.roleVipLevel=Api.playerVoApi.getPlayerVipLevel().toString(),a.serverId=ServerCfg.selectServer.zid,a.serverName=ServerCfg.selectServer.sname,a.orderId=e,a.price=i.cost,a.coinNum=i.gemCost,a.productCount="1",a.productType="1",a.currency="CNY",PlatformManager.checkIsKRSp()&&(App.DeviceUtil.isAndroid()?a.currency="KRW":App.DeviceUtil.isIOS()&&(a.currency="USD")),h(O,a),PlatformManager.checkIsTWBSp()&&!PlatformManager.checkIsTest()&&StatisticsHelper.report_pay_tw(i.cost)}function u(){App.LogUtil.log("__levelup_event__");var t={};t.userName="",t.userId=PlatformManager.userId,t.serverId=ServerCfg.selectServer.zid,t.serverName=ServerCfg.selectServer.sname,t.gameUserName=Api.playerVoApi.getPlayerName(),t.gameUserId=GameData.userId.toString(),t.roleLevel=Api.playerVoApi.getPlayerLevel().toString(),t.roleVipLevel=Api.playerVoApi.getPlayerVipLevel().toString(),t.registerTime=Api.gameinfoVoApi.getRegdt().toString(),t.balance=Api.playerVoApi.getPlayerGem().toString(),t.guild_name=Api.playerVoApi.getPlayerAllianceName(),t.guild_id="0"==Api.playerVoApi.getPlayerAllianceId().toString()?"":Api.playerVoApi.getPlayerAllianceId().toString(),t.fighting=Api.playerVoApi.getPlayerPower().toString(),t.loginType=2,h(V,t),PlatformManager.checkIsTWBSp()&&0==PlatformManager.checkIsTest()&&4==Api.playerVoApi.getPlayerLevel()&&StatisticsHelper.report_uplevel4_tw()}function C(){var t={};h(R,t)}function f(){try{return console.log("QAZ checkFollow "+RSDK.checkFollow()),RSDK.checkFollow()}catch(t){return!1}}function m(){try{RSDK.requestFollow()}catch(t){console.log("调用RSDK.requestFollow")}}function T(t){try{RSDK.callSdk("checkRealNameAuth",null,t)}catch(e){console.log("调用RSDK.callSdk/checkRealNameAuth error")}}function y(t){try{RSDK.callSdk("getRealNameAuth",null,t)}catch(e){console.log("调用RSDK.callSdk/getRealNameAuth error")}}function v(t,e,i){RSDK.callSdk(t,e,i)}function A(){rsdkclientplugin.bindAccountStatus()}function w(){try{RSDK.callSdk("callBackDrop",{url:"https://h5.qzone.qq.com/bgstore/detail/130859?_wv=2098179&from=adv&page=1&router=detail&coverid=130859&_proxy=1"},null)}catch(t){console.log("调用RSDK.callSdk callBackDrop error")}}function x(t){try{RSDK.callSdk("checkBackDrop",{cover_id:"130859"},t)}catch(e){console.log("调用RSDK.callSdk checkBackDrop error")}}function I(){try{return RSDK.checkShare()}catch(t){return 0}}function L(){try{return RSDK.getCustomerServiceType()}catch(t){return 0}}function E(){try{return RSDK.checkDesktop()}catch(t){return!1}}function B(t){try{RSDK.getCustomerServiceData(t)}catch(e){console.log("调用RSDK.getCustomerServiceData error")}}function S(t,e,i){try{return RSDK.requestDesktop(t,e.bind(i))}catch(a){return!1}}t.isInit=!1,t.init=e,t.login=i,t.logout=a,t.pay=n,t.share=o,t.setShareInfo=s,t.fbShare=r,t.krShare=l,t.analyticsLogin=g,t.analyticsNewGuide=c,t.analyticsRegister=p,t.analyticsPay=_,t.analyticsLevelup=u,t.analyticsLoadEnd=C;var N="-1",M="-2",b="-3",O="-4",V="-5",R="-6";t.checkAttention=f,t.attention=m,t.checkRealname=T,t.getRealNameAuth=y,t.callSdk=v,t.bindAccountStatus=A,t.callBackDrop=w,t.checkBackDrop=x,t.checkShare=I,t.getCustomerServiceType=L,t.checkDesktop=E,t.getCustomerService=B,t.requestDesktop=S}(RSDKHelper||(RSDKHelper={}));var StatisticsHelper;!function(t){function e(){App.DeviceUtil.IsHtml5()&&(window.google_conversion_id=819873248,window.google_conversion_label="slGECLnNt34Q4Iv5hgM",window.google_remarketing_only=!1,App.ResourceUtil.loadSingleScript("//www.googleadservices.com/pagead/conversion.js"),!function(t,e,i,a,n,o,s){t.fbq||(n=t.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)},t._fbq||(t._fbq=n),n.push=n,n.loaded=!0,n.version="2.0",n.queue=[],o=e.createElement(i),o.async=!0,o.src=a,s=e.getElementsByTagName(i)[0],s.parentNode.insertBefore(o,s))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js"),window.fbq("init","234770090424672"),window.fbq("track","CompleteRegistration"))}function i(t){App.DeviceUtil.IsHtml5()&&(window.google_conversion_id=819873248,window.google_conversion_label="DvFdCNGFu34Q4Iv5hgM",window.google_conversion_value=t?t:3,window.google_conversion_currency="USD",window.google_remarketing_only=!1,App.ResourceUtil.loadSingleScript("//www.googleadservices.com/pagead/conversion.js"),!function(t,e,i,a,n,o,s){t.fbq||(n=t.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)},t._fbq||(t._fbq=n),n.push=n,n.loaded=!0,n.version="2.0",n.queue=[],o=e.createElement(i),o.async=!0,o.src=a,s=e.getElementsByTagName(i)[0],s.parentNode.insertBefore(o,s))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js"),window.fbq("init","179480206020479"),window.fbq("track","Purchase",{value:String(t),currency:"USD"}))}function a(){App.DeviceUtil.IsHtml5()&&(window.google_conversion_id=819873248,window.google_conversion_label="Nx93CKDPt34Q4Iv5hgM",window.google_remarketing_only=!1,App.ResourceUtil.loadSingleScript("//www.googleadservices.com/pagead/conversion.js"))}function n(t){if(App.DeviceUtil.IsHtml5()&&window.requestGetStep)try{window.requestGetStep(t)}catch(e){console.log("requestGetStep error")}}function o(){App.DeviceUtil.IsHtml5()&&window.requestGetStepData&&(window.requestGetStepData={})}t.report_register_tw=e,t.report_pay_tw=i,t.report_uplevel4_tw=a,t.reportLoadData=n,t.clearReportData=o}(StatisticsHelper||(StatisticsHelper={}));var WxGameInclude=function(){function t(){}return t.include=function(){window.PromotionView=PromotionView,window.PromotionSuccessView=PromotionSuccessView,window.PromptView=PromptView,window.Soldier=Soldier,window.FightView=FightView,window.BattleDotBar=BattleDotBar,window.BattleRattle=BattleRattle,window.BattleWin=BattleWin,window.BattleInfo=BattleInfo,window.BattleView=BattleView,window.GuideBackground=GuideBackground,window.RookieView=RookieView,window.GuideCreateUserView=GuideCreateUserView,window.WelfareViewFirstRecharge=WelfareViewFirstRecharge,window.WelfareViewFunctionScrollltem=WelfareViewFunctionScrollltem,window.WelfareViewYearCard=WelfareViewYearCard,window.WelfareViewRealname=WelfareViewRealname,window.WelfareViewQgroup=WelfareViewQgroup,window.WelfareViewFunctionPreview=WelfareViewFunctionPreview,window.WelfareViewTab=WelfareViewTab,window.WelfareViewRebateScrollItem=WelfareViewRebateScrollItem,window.WelfareViewSignScrollItem=WelfareViewSignScrollItem,window.WelfareViewMonthCard=WelfareViewMonthCard,window.WelfareViewOfficialWeChat=WelfareViewOfficialWeChat,window.WelfareViewGoldblessScrollItem=WelfareViewGoldblessScrollItem,window.WelfareView=WelfareView,window.WelfareViewRechargeBox=WelfareViewRechargeBox,window.WelfareViewSignin=WelfareViewSignin,window.WelfareViewRebate=WelfareViewRebate,window.WelfareViewGodBless=WelfareViewGodBless,window.WelfareViewBinding=WelfareViewBinding,window.UserNamePopupView=UserNamePopupView,window.ItemJumpPopupView=ItemJumpPopupView,window.AcRankListPopupView=AcRankListPopupView,window.RuleInfoPopupView=RuleInfoPopupView,window.ServantSelectedPopupView=ServantSelectedPopupView,window.CommonRewardPopupView=CommonRewardPopupView,window.ItemUseConstPopupView=ItemUseConstPopupView,window.ServantAttrDetailPopupView=ServantAttrDetailPopupView,window.ItemUsePopupView=ItemUsePopupView,window.ItemInfoPopupView=ItemInfoPopupView,window.ErrorPopupView=ErrorPopupView,window.PopupViewTab=PopupViewTab,window.MainTaskPopupView=MainTaskPopupView,window.DailyTaskRewardPreviewPopuiView=DailyTaskRewardPreviewPopuiView,window.PalaceHistoryPopupView=PalaceHistoryPopupView,window.ScorePopupView=ScorePopupView,window.NamePopupView=NamePopupView,window.RankUserinfoPopupView=RankUserinfoPopupView,window.CandyGetPopupView=CandyGetPopupView,window.DownloadPackagePopupView=DownloadPackagePopupView,window.OfflineView=OfflineView,window.PalaceEditSignPopupView=PalaceEditSignPopupView,window.SetPasswordPopupView=SetPasswordPopupView,window.RankPopupView=RankPopupView,window.RankPopupListItem=RankPopupListItem,window.PopupView=PopupView,window.NetErrorPopupView=NetErrorPopupView,window.ConfirmPopupView=ConfirmPopupView,window.RealnamePopupView=RealnamePopupView,window.CostGemBuyItemPopupView=CostGemBuyItemPopupView,window.WeiduanUpgradePopupView=WeiduanUpgradePopupView,window.AttentionPopupView=AttentionPopupView,window.ConquestRankPopupView=ConquestRankPopupView,window.ConquestWinPopupView=ConquestWinPopupView,window.ConquestInfoPopupView=ConquestInfoPopupView,window.ConquestRankScrollItem=ConquestRankScrollItem,window.ConquestView=ConquestView,window.ConquestBatchPopupView=ConquestBatchPopupView,window.ConquestFightView=ConquestFightView,window.PrestigeLogPopupView=PrestigeLogPopupView,window.PrestigeInfoPopupView=PrestigeInfoPopupView,window.PrestigeView=PrestigeView,window.PrestigeLogPopupScollItem=PrestigeLogPopupScollItem,window.PrestigeItemPopupView=PrestigeItemPopupView,window.KRAgreementView=KRAgreementView,window.AtkracecrossActivityRewardViewTab1=AtkracecrossActivityRewardViewTab1,window.ActrackCrossMoreItem=ActrackCrossMoreItem,window.AtkraceCorssRankItem=AtkraceCorssRankItem,window.AtkracecrossServerItem=AtkracecrossServerItem,window.AtkraceCrossRankListView=AtkraceCrossRankListView,window.AtkracecrossDetailPopupView=AtkracecrossDetailPopupView,window.AtkraceCrossChallengeItem=AtkraceCrossChallengeItem,window.AtkraceCrossChallengeView=AtkraceCrossChallengeView,window.ActrackCrossVisitTab1Item=ActrackCrossVisitTab1Item,window.AtkraceCrossVisitView=AtkraceCrossVisitView,window.AtkraceCrossVisitViewTab3=AtkraceCrossVisitViewTab3,window.AtkraceCrossVisitViewTab2=AtkraceCrossVisitViewTab2,window.AtkraceCrossVisitViewTab1=AtkraceCrossVisitViewTab1,window.ActrackCrossVisitTab2Item=ActrackCrossVisitTab2Item,window.AtkracecrossAgreePopupDialog=AtkracecrossAgreePopupDialog,window.AtkracecrossArrestView=AtkracecrossArrestView,window.AtkracecrossBattleView=AtkracecrossBattleView,window.AtkracecrossActivityRewardView=AtkracecrossActivityRewardView,window.AtkracecrossSummaryView=AtkracecrossSummaryView,window.AtkracecrossBuyPopupView=AtkracecrossBuyPopupView,window.AtkracecrossView=AtkracecrossView,window.AtkracecrossRewardPopupView=AtkracecrossRewardPopupView,window.AtkracecrossActivityRewardViewTab2=AtkracecrossActivityRewardViewTab2,window.CommonView=CommonView,window.AchievementView=AchievementView,window.AchievementDetailPopupView=AchievementDetailPopupView,window.AchievementDetailScrollItem=AchievementDetailScrollItem,window.AchievementScrollItem=AchievementScrollItem,window.ChatViewTab2=ChatViewTab2,window.ChatScrollItem=ChatScrollItem,window.ChatView=ChatView,window.ChatblockView=ChatblockView,window.ChatblockScrollItem=ChatblockScrollItem,window.ChatViewTab1=ChatViewTab1,window.TradeFightView=TradeFightView,window.TradeView=TradeView,window.TradeRankListView=TradeRankListView,window.TradeInfoPopupView=TradeInfoPopupView,window.TradeOneKeyPopupView=TradeOneKeyPopupView,window.TradeRankItem=TradeRankItem,window.AcTailorSkinItem=AcTailorSkinItem,window.AcTailorGetView=AcTailorGetView,window.AcTailorView=AcTailorView,window.AcTailorExchangeView=AcTailorExchangeView,window.AcTailorRewardPopupView=AcTailorRewardPopupView,window.AcTailorSkinHeadItem=AcTailorSkinHeadItem,window.AcWishTreeExchangeView=AcWishTreeExchangeView,window.AcWishTreeExchangeItem=AcWishTreeExchangeItem,window.AcWishTreeView=AcWishTreeView,window.AcLimitedRewardScrollItem=AcLimitedRewardScrollItem,window.AcLimitedRewardView=AcLimitedRewardView,window.AcLimitedRewardDetailPopupView=AcLimitedRewardDetailPopupView,window.AcLimitedRewardDetailScrollItem=AcLimitedRewardDetailScrollItem,window.AcTotalDayRechargeScrollItem=AcTotalDayRechargeScrollItem,window.AcTotalRechargeScrollItem=AcTotalRechargeScrollItem,window.AcRechargeItem=AcRechargeItem,window.AcRechargeView=AcRechargeView,window.AcDailyChargeScrollItem=AcDailyChargeScrollItem,window.AcNewYearView=AcNewYearView,window.AcNewYearViewTab2=AcNewYearViewTab2,window.NewYear2ScrollItem=NewYear2ScrollItem,window.AcNewYearPopupView=AcNewYearPopupView,window.NewYear1ScrollItem=NewYear1ScrollItem,window.AcNewYearViewTab1=AcNewYearViewTab1,window.AcCommonView=AcCommonView,window.AcFourPeopleView=AcFourPeopleView,window.AcFourPeopleScrollItem=AcFourPeopleScrollItem,window.AcDiscountView=AcDiscountView,window.AcRankListScrollItem=AcRankListScrollItem,window.AcRankActiveView=AcRankActiveView,window.RankActiveView=RankActiveView,window.AcCarnivalChargeScrollItem=AcCarnivalChargeScrollItem,window.AcCarnivalCostScrollItem=AcCarnivalCostScrollItem,window.AcCarnivalItem=AcCarnivalItem,window.AcCarnivalView=AcCarnivalView,window.AcWifeComeView=AcWifeComeView,window.AcVipShopPopupView=AcVipShopPopupView,window.AcVipShopViewScrollItem=AcVipShopViewScrollItem,window.AcVipShopView=AcVipShopView,window.AcSpringCelebrateViewTab4=AcSpringCelebrateViewTab4,window.Celebration1ScrollItem=Celebration1ScrollItem,window.AcSpringCelebrateViewTab1=AcSpringCelebrateViewTab1,window.Celebration3ScrollItem=Celebration3ScrollItem,window.Celebration4ScrollItem=Celebration4ScrollItem,window.AcSpringCelebrateViewTab2=AcSpringCelebrateViewTab2,window.Celebration2ScrollItem=Celebration2ScrollItem,window.AcSpringCelebrateViewTab3=AcSpringCelebrateViewTab3,window.AcSpringCelebrateView=AcSpringCelebrateView,window.AcPunishReportView=AcPunishReportView,window.AcPunishRankRewardPopupView=AcPunishRankRewardPopupView,window.AcPunishExScrollItem=AcPunishExScrollItem,window.AcPunishRankPopupView=AcPunishRankPopupView,window.AcPunishExPopupView=AcPunishExPopupView,window.AcPunishRankAllianceRewardScrollItem=AcPunishRankAllianceRewardScrollItem,window.AcPunishBuyItemPopupView=AcPunishBuyItemPopupView,window.AcPunishView=AcPunishView,window.AcPunishRankScrollItem=AcPunishRankScrollItem,window.AcPunishBuyItemScrollItem=AcPunishBuyItemScrollItem,window.AcPunishRankRewardScrollItem=AcPunishRankRewardScrollItem,window.AcMayDay2ScrollItem=AcMayDay2ScrollItem,window.AcMayDayRankScrollItem=AcMayDayRankScrollItem,window.AcMayDayRankRewardScrollItem=AcMayDayRankRewardScrollItem,window.AcMayDayViewTab1=AcMayDayViewTab1,window.AcMayDay3ScrollItem=AcMayDay3ScrollItem,window.AcMayDayRankPopupView=AcMayDayRankPopupView,window.AcMayDayView=AcMayDayView,window.AcMayDayViewTab2=AcMayDayViewTab2,window.AcMayDayRewardPopupView=AcMayDayRewardPopupView,window.AcMayDayViewTab3=AcMayDayViewTab3,window.MailPopupView=MailPopupView,window.MailScrollItem=MailScrollItem,window.MailRewardScrollItem=MailRewardScrollItem,window.MailDetailPopupView=MailDetailPopupView,window.ViewTab=ViewTab,window.RankScrollItem=RankScrollItem,window.RankWorshipView=RankWorshipView,window.RankView=RankView,window.Shop3ScrollItem=Shop3ScrollItem,window.ShopScrollItem=ShopScrollItem,window.ShopViewTab1=ShopViewTab1,window.ShopView=ShopView,window.ShopViewTab2=ShopViewTab2,window.ShopViewTab3=ShopViewTab3,window.AllianceTurnPopupView=AllianceTurnPopupView,window.AlliancePswdPopupView=AlliancePswdPopupView,window.AllianceSetPoPopupView=AllianceSetPoPopupView,window.AllianceTurnScrollItem=AllianceTurnScrollItem,window.AllianceCreateView=AllianceCreateView,window.AllianceApplyPopupView=AllianceApplyPopupView,window.AllianceRankPopupView=AllianceRankPopupView,window.AllianceMoreItem=AllianceMoreItem,window.AllianceFindPopupView=AllianceFindPopupView,window.AllianceRankScrollItem=AllianceRankScrollItem,window.AllianceBossAttackedPopupView=AllianceBossAttackedPopupView,window.AllianceBossScrollItem=AllianceBossScrollItem,window.AllianceBossOpenPopupView=AllianceBossOpenPopupView,window.AllianceCreatePopupView=AllianceCreatePopupView,window.AllianceInfoPopupView=AllianceInfoPopupView,window.AllianceCreateAniView=AllianceCreateAniView,window.AllianceManagePopupView=AllianceManagePopupView,window.AllianceBossRankScrollItem=AllianceBossRankScrollItem,window.AllianceBossMoreItem=AllianceBossMoreItem,window.AllianceBossSelectScrollItem=AllianceBossSelectScrollItem,window.AllianceView=AllianceView,window.AllianceBuildScrollItem=AllianceBuildScrollItem,window.AllianceTimePopupView=AllianceTimePopupView,window.AllianceBuildPopupView=AllianceBuildPopupView,window.AllianceBossBattleView=AllianceBossBattleView,window.AllianceMemberScrollItem=AllianceMemberScrollItem,window.AllianceMemberPopupView=AllianceMemberPopupView,window.AllianceExScrollItem=AllianceExScrollItem,window.AllianceApplyScrollItem=AllianceApplyScrollItem,window.AllianceBossPopupView=AllianceBossPopupView,window.AllianceShowInfoPopupView=AllianceShowInfoPopupView,window.AllianceExPopupView=AllianceExPopupView,window.AllianceBossRankPopupView=AllianceBossRankPopupView,window.BookroomServantScrollItem=BookroomServantScrollItem,window.BookroomInfoItem=BookroomInfoItem,window.BookroomServantSelectPopupView=BookroomServantSelectPopupView,window.BookroomView=BookroomView,window.HoldDinnerPopupView=HoldDinnerPopupView,window.DinnerRewardView=DinnerRewardView,window.DinnerDetailView=DinnerDetailView,window.DinnerRankItem=DinnerRankItem,window.DinnerView=DinnerView,window.DinnerMessageItem=DinnerMessageItem,window.DinnerTypePopupView=DinnerTypePopupView,window.DinnerMsgPopupScollItem=DinnerMsgPopupScollItem,window.DinnerInfoItem=DinnerInfoItem,window.GotoDinnerView=GotoDinnerView,window.DinnerExchangePopupView=DinnerExchangePopupView,window.DinnerSharePopupView=DinnerSharePopupView,window.DinnerMsgPopupView=DinnerMsgPopupView,window.DinnerFinishView=DinnerFinishView,window.DinnerDesk=DinnerDesk,window.DinnerRankPopupView=DinnerRankPopupView,window.DinnerFindPopupView=DinnerFindPopupView,window.DinnerFinishItem=DinnerFinishItem,window.DinnerOpenedView=DinnerOpenedView,window.DinnerMessagePopupView=DinnerMessagePopupView,window.CatchPrisonPopupView=CatchPrisonPopupView,window.BossSelectedScrollItem=BossSelectedScrollItem,window.BossBattleView=BossBattleView,window.CommonViewTab=CommonViewTab,window.DailybossBattleResultPopupView=DailybossBattleResultPopupView,window.DailybossType1BattleResultPopupView=DailybossType1BattleResultPopupView,window.DailybossAttackedPopupView=DailybossAttackedPopupView,window.DailybossBattleView=DailybossBattleView,window.DailybossDamageRankPopupView=DailybossDamageRankPopupView,window.BossRecSelectedScrollItem=BossRecSelectedScrollItem,window.DailybossRewardListItem=DailybossRewardListItem,window.DailybossScroePopupView=DailybossScroePopupView,window.DailybossRankPopupView=DailybossRankPopupView,window.DailybossView=DailybossView,window.DailybossLastAttackPopupView=DailybossLastAttackPopupView,window.DailybossRankRewardPopupView=DailybossRankRewardPopupView,window.DailybossPao=DailybossPao,window.LoginView=LoginView,window.SearchBuildPopupView=SearchBuildPopupView,window.SearchLuckPopupView=SearchLuckPopupView,window.SearchResultPopupView=SearchResultPopupView,window.SearchView=SearchView,window.ThanksgivingView=ThanksgivingView,window.InviteViewTab2=InviteViewTab2,window.InviteViewTab3=InviteViewTab3,window.InviteViewTab1ScrollItem=InviteViewTab1ScrollItem,window.InviteViewTab4ScrollItem=InviteViewTab4ScrollItem,window.InviteViewTab3ScrollItem=InviteViewTab3ScrollItem,window.InviteViewTab4=InviteViewTab4,window.InviteView=InviteView,window.InviteViewTab2ScrollItem=InviteViewTab2ScrollItem,window.InviteViewTab1=InviteViewTab1,window.AnnouncementScrollItem=AnnouncementScrollItem,window.GameAnnouncementView=GameAnnouncementView,window.PalaceHouseGroupView=PalaceHouseGroupView,window.PalaceCrossView=PalaceCrossView,window.PalaceHouseView=PalaceHouseView,window.PalaceRoleInfoItem=PalaceRoleInfoItem,window.PalaceView=PalaceView,window.PalaceRoleInfoItem2=PalaceRoleInfoItem2,window.WifeGetView=WifeGetView,window.WifeSkillScrollItem=WifeSkillScrollItem,window.WifeScrollItem1=WifeScrollItem1,window.WifeskinScrollItem=WifeskinScrollItem,window.WifeGiveScrollItem=WifeGiveScrollItem,window.WifeViewTab2=WifeViewTab2,window.WifeCallBatchSuccessView=WifeCallBatchSuccessView,window.WifeLoveAniView=WifeLoveAniView,window.WifeSkillPopupView=WifeSkillPopupView,window.WifeViewTab1=WifeViewTab1,window.WifeView=WifeView,window.WifeOptView=WifeOptView,window.WifeskinView=WifeskinView,window.WifeGivePopupView=WifeGivePopupView,window.WifeScrollItem2=WifeScrollItem2,window.WifeUnLockView=WifeUnLockView,window.WifeGetChildView=WifeGetChildView,window.AtkraceRankItem=AtkraceRankItem,window.AtkraceRankListView=AtkraceRankListView,window.AtkraceVisitView=AtkraceVisitView,window.ActrackVisitTab2Item=ActrackVisitTab2Item,window.AtkraceVisitViewTab3=AtkraceVisitViewTab3,window.AtkraceVisitViewTab2=AtkraceVisitViewTab2,window.AtkraceVisitViewTab1=AtkraceVisitViewTab1,window.ActrackVisitTab1Item=ActrackVisitTab1Item,window.BaseBattleView=BaseBattleView,window.AtkraceChallengeItem=AtkraceChallengeItem,window.AtkraceChallengeView=AtkraceChallengeView,window.ActrackMoreItem=ActrackMoreItem,window.BattleHero=BattleHero,window.AtkraceArrestView=AtkraceArrestView,window.AtkraceBattleView=AtkraceBattleView,window.AtkraceView=AtkraceView,window.AtkraceBuyPopupView=AtkraceBuyPopupView,window.AtkraceRewardPopupView=AtkraceRewardPopupView,window.AtkraceAgreePopupDialog=AtkraceAgreePopupDialog,window.ItemView=ItemView,window.ItemScrollItem=ItemScrollItem,window.ItemViewTab2=ItemViewTab2,window.ItemViewTab3=ItemViewTab3,window.ComposePopupView=ComposePopupView,window.ItemUseSuccessView=ItemUseSuccessView,window.ItemViewTab1=ItemViewTab1,window.RechargeVipViewScrollltem=RechargeVipViewScrollltem,window.RechargeVipView=RechargeVipView,window.RechargeVipViewTab1=RechargeVipViewTab1,window.RechargeVipViewTab2=RechargeVipViewTab2,window.VipBtnScrollItem=VipBtnScrollItem,window.PrisonDetailsPopupView=PrisonDetailsPopupView,window.PrisonPopView=PrisonPopView,window.PrisonView=PrisonView,window.PrisonHeadView=PrisonHeadView,window.ZhubowanghongView=ZhubowanghongView,window.ServantInfoFourItemScrollItem=ServantInfoFourItemScrollItem,window.ServantBookLevelupPopupView=ServantBookLevelupPopupView,window.DialogueGetBaseView=DialogueGetBaseView,window.ServantInfoItemsScrollItem=ServantInfoItemsScrollItem,window.ServantSelectedScrollItem=ServantSelectedScrollItem,window.ServantInfoView=ServantInfoView,window.ServantInfoBookItems=ServantInfoBookItems,window.ServantInfoWifeItemScrollItem=ServantInfoWifeItemScrollItem,window.ServantScrollItem=ServantScrollItem,window.DropToggleGroup=DropToggleGroup,window.ServantInfoItems=ServantInfoItems,window.ServantAdvancePopupView=ServantAdvancePopupView,window.ServantGetView=ServantGetView,window.ServantView=ServantView,window.ServantInfoWifeItem=ServantInfoWifeItem,window.ServantAdvanceView=ServantAdvanceView,window.ServantInfoFourItems=ServantInfoFourItems,window.ServantInfoSkillsItem=ServantInfoSkillsItem,window.DailyTaskScrollItem=DailyTaskScrollItem,window.DailyTaskView=DailyTaskView,window.ManageView=ManageView,window.AutoResPopupView=AutoResPopupView,window.StudyatkFailedPopupView=StudyatkFailedPopupView,window.StudyatkBookScrollItem=StudyatkBookScrollItem,window.StudyatkCreatePopupView=StudyatkCreatePopupView,window.StudyatkBattleResultView=StudyatkBattleResultView,window.StudyatkBattleView=StudyatkBattleView,window.StudyatkDetailRoleInfoItem=StudyatkDetailRoleInfoItem,window.StudyatkView=StudyatkView,window.StudyatkFindPopupView=StudyatkFindPopupView,window.StudyatkBookPopupView=StudyatkBookPopupView,window.StudyatkDetailView=StudyatkDetailView,window.StudyatkTableItem=StudyatkTableItem,window.StudyAtkBookLvupSuccessView=StudyAtkBookLvupSuccessView,window.StudyatkSuccessView=StudyatkSuccessView,window.ServerListMyScrollItem=ServerListMyScrollItem,window.ServerListPopupView=ServerListPopupView,window.ServerListServerScrollItem=ServerListServerScrollItem,window.ServerListTabScrollItem=ServerListTabScrollItem,window.AdultMarrySuccessView=AdultMarrySuccessView,window.AdultMarryView=AdultMarryView,window.AdultChooseChildView=AdultChooseChildView,window.Adult2ScrollItem=Adult2ScrollItem,window.AdultScrollItem=AdultScrollItem,window.AdultMarryRequestScrollItem=AdultMarryRequestScrollItem,window.AdultMarryScrollItem=AdultMarryScrollItem,window.AdultMarryRequestView=AdultMarryRequestView,window.AdultView=AdultView,window.AdultChooseChildScrollItem=AdultChooseChildScrollItem,window.SettingCDKPopupView=SettingCDKPopupView,window.SettingPopopView=SettingPopopView,window.SettingContactPopupView=SettingContactPopupView,window.ChallengeStory=ChallengeStory,window.ChallengeAutoRewardsPopupView=ChallengeAutoRewardsPopupView,window.ChallengeAutoPopupView=ChallengeAutoPopupView,window.ChallengeButton=ChallengeButton,window.ChallengeView=ChallengeView,window.BindView=BindView,window.DesktopPopupView=DesktopPopupView,window.BuyGiftPopupView=BuyGiftPopupView,window.CoverView=CoverView,window.SharePopupView=SharePopupView,window.DownloadView=DownloadView,window.GetGiftPopupView=GetGiftPopupView,window.ChildScrollItem=ChildScrollItem,window.ChildView=ChildView,window.ChildUpdView=ChildUpdView,window.PlayerViewTab1=PlayerViewTab1,window.PlayerViewTab2=PlayerViewTab2,window.PlayerView=PlayerView,window.AffairView=AffairView,window.BaseScene=BaseScene,window.CityScene=CityScene,window.HomeScene=HomeScene,window.BaseVoApi=BaseVoApi,window.LampVoApi=LampVoApi,window.VipVoApi=VipVoApi,window.ConquestVoApi=ConquestVoApi,window.PrestigeVoApi=PrestigeVoApi,window.AtkracecrossVoApi=AtkracecrossVoApi,window.ChatVoApi=ChatVoApi,window.TradeVoApi=TradeVoApi,window.AcVoApi=AcVoApi,window.AcRankVoApi=AcRankVoApi,window.AcBaseVoApi=AcBaseVoApi,window.AcTailorApi=AcTailorApi,window.MailVoApi=MailVoApi,window.RookieVoApi=RookieVoApi,window.ShopVoApi=ShopVoApi,window.AllianceVoApi=AllianceVoApi,window.BookroomVoApi=BookroomVoApi,window.DinnerVoApi=DinnerVoApi,window.Api=Api,window.DailybossVoApi=DailybossVoApi,window.SearchVoApi=SearchVoApi,window.InviteVoApi=InviteVoApi,window.PalaceVoApi=PalaceVoApi,window.WifeskinVoApi=WifeskinVoApi,window.WifeVoApi=WifeVoApi,window.AtkraceVoApi=AtkraceVoApi,window.ItemVoApi=ItemVoApi,window.RechargeVoApi=RechargeVoApi,window.MainTaskVoApi=MainTaskVoApi,window.PrisonVoApi=PrisonVoApi,window.SwitchVoApi=SwitchVoApi,window.ServantVoApi=ServantVoApi,window.ManageVoApi=ManageVoApi,window.StudyatkVoApi=StudyatkVoApi,window.AdultVoApi=AdultVoApi,window.ChallengeVoApi=ChallengeVoApi,window.RankVoApi=RankVoApi,window.ArrivalVoApi=ArrivalVoApi,window.ChildVoApi=ChildVoApi,window.PlayerVoApi=PlayerVoApi,window.GameinfoVoApi=GameinfoVoApi,window.BaseVo=BaseVo,window.ConquestVo=ConquestVo,window.PrestigeVo=PrestigeVo,window.AtkracecrossVo=AtkracecrossVo,window.AchievementInfoVo=AchievementInfoVo,window.AchievementVoApi=AchievementVoApi,window.AchievementVo=AchievementVo,window.ChatblockVo=ChatblockVo,window.ChatVo=ChatVo,window.OtherInfoVo=OtherInfoVo,window.TradeInfoVo=TradeInfoVo,window.TradeVo=TradeVo,window.AcTailorVo=AcTailorVo,window.AcDailyChargeVo=AcDailyChargeVo,window.AcSpringCelebrateVo=AcSpringCelebrateVo,window.AcMayDayVo=AcMayDayVo,window.AcPunishVo=AcPunishVo,window.AcCarnivalCostVo=AcCarnivalCostVo,window.AcWifeComeVo=AcWifeComeVo,window.AcRankActiveVo=AcRankActiveVo,window.AcRankVo=AcRankVo,window.AcBaseVo=AcBaseVo,window.AcTotalRechargeVo=AcTotalRechargeVo,window.AcFourPeopleVo=AcFourPeopleVo,window.AcRankInfoVo=AcRankInfoVo,window.AcLimitedRewardVo=AcLimitedRewardVo,window.AcWishTreeVo=AcWishTreeVo,window.AcTotalDayRechargeVo=AcTotalDayRechargeVo,window.AcCarnivalChargeVo=AcCarnivalChargeVo,window.AcDiscountVo=AcDiscountVo,window.AcLimitedRewardInfoVo=AcLimitedRewardInfoVo,window.AcNewYearVo=AcNewYearVo,window.AcCrossServerAtkRaceVo=AcCrossServerAtkRaceVo,window.AcVipShopVo=AcVipShopVo,window.MailVo=MailVo,window.MailInfoVo=MailInfoVo,window.ShopVo=ShopVo,window.ShopInfoVo=ShopInfoVo,window.AllianceVo=AllianceVo,window.AllianceMemberVo=AllianceMemberVo,window.MyAllianceVo=MyAllianceVo,window.BookroomInfoVo=BookroomInfoVo,window.BookroomVo=BookroomVo,window.DinnerVo=DinnerVo,window.DailybossVo=DailybossVo,window.SearchBuildInfoItemVo=SearchBuildInfoItemVo,window.SearchVo=SearchVo,window.InviteVo=InviteVo,window.PalaceVo=PalaceVo,window.PalaceRoleInfoVo=PalaceRoleInfoVo,window.WifeskinInfoVo=WifeskinInfoVo,window.WifeskinVo=WifeskinVo,window.WifeVo=WifeVo,window.WifeInfoVo=WifeInfoVo,window.AtkraceVo=AtkraceVo,window.AtkraceServantVo=AtkraceServantVo,window.AtkraceInfoVo=AtkraceInfoVo,window.AtkraceAtkInfoVo=AtkraceAtkInfoVo,window.TitleInfoVo=TitleInfoVo,window.ItemVo=ItemVo,window.ItemInfoVo=ItemInfoVo,window.MainTaskVo=MainTaskVo,window.PrisonVo=PrisonVo,window.SwitchVo=SwitchVo,window.ServantInfoVo=ServantInfoVo,window.ServantAttrVo=ServantAttrVo,window.ServantVo=ServantVo,window.RewardItemVo=RewardItemVo,window.DailyTaskAttrVo=DailyTaskAttrVo,window.AffairVo=AffairVo,window.ManageVo=ManageVo,window.AutoResVo=AutoResVo,window.AdultMarryInfoVo=AdultMarryInfoVo,window.AdultMarryVo=AdultMarryVo,window.AdultVo=AdultVo,window.AdultAttrVo=AdultAttrVo,window.AdultInfoVo=AdultInfoVo,window.ChallengeVo=ChallengeVo,window.RankVo=RankVo,window.RankUserVo=RankUserVo,window.ArrivalVo=ArrivalVo,window.StudyatkTableInfoVo=StudyatkTableInfoVo,window.StudyatkVo=StudyatkVo,window.ChildVo=ChildVo,window.ChildInfoVo=ChildInfoVo,window.ChildAttrVo=ChildAttrVo,window.PlayerVo=PlayerVo,window.GameinfoVo=GameinfoVo,window.RankActiveScrollItem=RankActiveScrollItem,window.AdultChooseTypeView=AdultChooseTypeView,window.OtherInfoVoApi=OtherInfoVoApi,window.DailytaskVoApi=DailytaskVoApi,window.AllianceMemberInfoVo=AllianceMemberInfoVo,window.DailytaskVo=DailytaskVo,window.Config=Config
},t}();__reflect(WxGameInclude.prototype,"WxGameInclude");var GodBless=function(t){function e(){var e=t.call(this)||this;return e._config=null,e._tipBg=null,e._tipWord=null,e}return __extends(e,t),e.prototype.show=function(t){this._config=Config.DailyluckCfg.getDailylucyCfgByName(t),ResourceManager.loadResources(["godbless_tip_bg","godbless_tip_bg2","godbless_tip_word","godbless_"+this._config.name],[],this.init,null,this)},e.prototype.init=function(){this._tipBg=BaseBitmap.create("godbless_tip_bg"),this._tipBg.anchorOffsetX=this._tipBg.width,this._tipBg.setPosition(GameConfig.stageWidth/2,50);var t=BaseBitmap.create("godbless_tip_bg");t.anchorOffsetX=t.width,t.setPosition(GameConfig.stageWidth/2,50),this.addChild(this._tipBg),this.addChild(t),this._tipBg.scaleX=0,t.scaleX=0,egret.Tween.get(this._tipBg).to({scaleX:1},300).wait(100).call(this.showWord,this),egret.Tween.get(t).to({scaleX:-1},300)},e.prototype.showWord=function(){this._tipWord=BaseBitmap.create("godbless_tip_word"),this._tipWord.setPosition(GameConfig.stageWidth/2-1.5*this._tipWord.width,this._tipBg.y+this._tipBg.height/2-this._tipWord.height),this._tipWord.scaleX=2,this._tipWord.scaleY=2,this.addChild(this._tipWord);var t=egret.Point.create(GameConfig.stageWidth/2-this._tipWord.width,this._tipBg.y+this._tipBg.height/2-this._tipWord.height/2);egret.Tween.get(this._tipWord).to({scaleX:1,scaleY:1,x:t.x,y:t.y},500).call(this.showName,this)},e.prototype.showName=function(){var t=BaseBitmap.create("godbless_"+this._config.name);t.setPosition(GameConfig.stageWidth,this._tipBg.y+this._tipBg.height/2-t.height/2),this.addChild(t),egret.Tween.get(t).to({x:GameConfig.stageWidth/2},500).call(this.showDesc,this).wait(1e3).call(this.hide,this)},e.prototype.showDesc=function(){var t=new BaseDisplayObjectContainer;t.y=this._tipBg.y+140,this.addChild(t);var e=BaseBitmap.create("godbless_tip_bg2");e.setPosition(GameConfig.stageWidth/2-e.width,0),t.addChild(e);var i=BaseBitmap.create("godbless_tip_bg2");i.scaleX=-1,i.setPosition(GameConfig.stageWidth/2+i.width,e.y),t.addChild(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("godbless_desc_"+this._config.name,[this._config.times.toString()]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);a.setPosition(GameConfig.stageWidth/2-a.width/2,e.y+e.height/2-a.height/2),t.addChild(a),egret.Tween.get(t).to({y:t.y-50},500)},e.prototype.hide=function(){egret.Tween.get(this).to({alpha:0},300).call(this.remove,this)},e.prototype.remove=function(){LayerManager.msgLayer.removeChild(this)},e.prototype.dispose=function(){egret.Tween.removeTweens(this),this._config=null,this._tipBg=null,this._tipWord=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(GodBless.prototype,"GodBless");var CityScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setLayerPosition=function(){t.prototype.setLayerPosition.call(this),this._mapLayer.setPosition(0,0)},e.prototype.checkDinnerClose=function(){return Api.playerVoApi.getPlayerLevel()<Config.DinnerCfg.getNeedLv()?LanguageManager.getlocal("reachLvelUnlockDesc",[Api.playerVoApi.getPlayerOfficeByLevel(Config.DinnerCfg.getNeedLv())]):null},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseScene);__reflect(CityScene.prototype,"CityScene");var HomeScene=function(t){function e(){var e=t.call(this)||this;return e._isRequestedOfflineReward=!1,e._effectGroups=[["taohua","taohua_json"],["hudie"],["hudie01"],["hudie02"]],e._loadIndex=-1,e._needDestoryRes=[],e._yunList=[],e}return __extends(e,t),e.prototype.isNpcNameMove=function(){return!1},e.prototype.init=function(){if(t.prototype.init.call(this),!this._isRequestedOfflineReward&&Api.switchVoApi.checkAutoResManage()&&(this._isRequestedOfflineReward=!0,Api.manageVoApi.checkAndShowAutoReward("2")),Api.rookieVoApi.isInGuiding&&Api.rookieVoApi.checkWaitingGuide(),this.userLoginRequestHandler(),PlatformManager.checkIsWanbaSp()&&PlatformManager.checkIsUseSDK())try{qqwanbaplugin.sendToWanbaData({ach_type:3,ach_des:LanguageManager.getlocal("mainui_shili"),ach_value:Api.playerVoApi.getPlayerPower()})}catch(e){console.log("tjqs error")}},e.prototype.loadEffectRes=function(){this._loadIndex++;var t=ResourceManager.loadResources(this._effectGroups[this._loadIndex],[],this.showEffectAndLoadNext,null,this);this._needDestoryRes.indexOf(t)<0&&this._needDestoryRes.push(t),this.userLoginRequestHandler()},e.prototype.userLoginRequestHandler=function(){if(!Api.rookieVoApi.isInGuiding){if(GameData.announcementData&&GameData.announcementData.length>0){if(Api.rookieVoApi.isInGuiding)return;ViewController.getInstance().openView(ViewConst.COMMON.GAMEANNOUNCEMENtVIEW,GameData.announcementData)}GameData.wbrewards&&GameData.wbrewards.length>0&&ViewController.getInstance().openView(ViewConst.POPUP.GETGIFTPOPUPVIEW,{rewards:GameData.wbrewards}),PlatformManager.checkDownloadApp(),("501"==PlatformManager.getGiftId()||"502"==PlatformManager.getGiftId())&&(GameData.wbrewardsFlag?PlatformManager.giftExchange(this.exchangeCallback,this):ViewController.getInstance().openView(ViewConst.POPUP.BUYGIFTPOPUPVIEW,{rewards:GameData.wbrewards,code:"2003"}))}},e.prototype.exchangeCallback=function(t,e){"0"==String(t)?this.request(NetRequestConst.REQUEST_OTHERINFO_GETWBSCOREREWARD,{giftId:PlatformManager.getGiftId()}):ViewController.getInstance().openView(ViewConst.POPUP.BUYGIFTPOPUPVIEW,{rewards:GameData.wbrewards,code:String(e.ret)})},e.prototype.receiveData=function(t){t.data.cmd==NetRequestConst.REQUEST_OTHERINFO_GETWBSCOREREWARD&&t.data.data&&t.data.data.rewards&&ViewController.getInstance().openView(ViewConst.POPUP.BUYGIFTPOPUPVIEW,{rewards:t.data.data.rewards,code:"0"})},e.prototype.showEffect=function(){var t=(App.MathUtil.getRandom(1e4,2e4),App.MathUtil.getRandom(0,1500),App.ParticleUtil.getParticle("taohua"));t.x=0,t.y=this.height-700,t.rotation=-66,t.start(),this._effectLayer.addChild(t),egret.Tween.get(t).call(function(){t.start()},this)},e.prototype.showEffectAndLoadNext=function(){0==this._loadIndex&&this.showEffect(),1==this._loadIndex,2==this._loadIndex,3==this._loadIndex,this._loadIndex<this._effectGroups.length-1&&this.isShow()&&this.loadEffectRes()},e.prototype.createBt=function(){this._butterflys=new Array;for(var t=[{x:410,y:this.height-550,scale:.5},{x:460,y:this.height-545,scale:1},{x:520,y:this.height-540,scale:.8},{x:570,y:this.height-520,scale:.8}],e=new Array(1,2,3),i=3,a=new Array(3),n=0;i>n;n++){var o=App.MathUtil.getRandom(0,e.length-n);a[n]=e[o],e[o]=e[e.length-n-1]}a.push(App.MathUtil.getRandom(1,4));for(var s=0;4>s;s++){var r="hudie_";1==a[s]?r="hudie_":2==a[s]?r="hudie01_":3==a[s]&&(r="hudie02_");var l=ComponentManager.getCustomMovieClip(r,15,100);l.x=t[s].x,l.y=t[s].y,this._effectLayer.addChild(l),l.play(),l.setScale(t[s].scale),this.playBtAni(l)}},e.prototype.playBtAni=function(t){for(var e=(t.x,t.y,new Array),i=0;3>i;i++){var a=App.MathUtil.getRandom(390,640),n=App.MathUtil.getRandom(this.height-630,this.height-630+180);e.push({x:a,y:n})}t.tweenMoveList=[egret.Point.create(t.x,t.y),egret.Point.create(t.x,e[0].y),egret.Point.create(e[0].x,e[0].y)];var o=App.MathUtil.getRandom(1e3,5e3);App.LogUtil.log(e[2].y),egret.Tween.get(t).wait(o).to({factor:1},2e3).call(this.playBtAni,this,[t])},e.prototype.setLayerPosition=function(){t.prototype.setLayerPosition.call(this)},e.prototype.createRandSpeed=function(){var t=Math.random()>.5?1:-1,e=.35+t*Math.random()*.15;return e},e.prototype.move=function(){for(var t=0;t<this._yunList.length;t++){var e=this._yunList[t];e.x+=e.yunSpeed,e.texture&&0==e.visible&&(e.visible=!0),e.x>GameConfig.stageWidth&&(e.x=-e.width,e.yunSpeed=this.createRandSpeed())}},e.prototype.dispose=function(){for(this._yunList.length=0,TimerManager.remove(this.move,this),this._butterflys=null;this._needDestoryRes.length>0;)ResourceManager.destroyRes(this._needDestoryRes.pop());this._loadIndex=-1,GameData.announcementData=null,t.prototype.dispose.call(this)},e}(BaseScene);__reflect(HomeScene.prototype,"HomeScene");var App;!function(t){var e=function(){function e(){}return e.playRewardFlyAction=function(t,e,i){void 0===i&&(i=800);for(var a=function(a){var o=function(){var i=t[a],n=new RewardFly;n.init(i.icon,i.tipMessage,i.type),e?n.setPosition(e.x,e.y):n.setPosition(GameConfig.stageWidth/2,GameConfig.stageHeigth/2-100),LayerManager.msgLayer.addChild(n)};egret.setTimeout(o,n,i*a)},n=this,o=0;o<t.length;o++)a(o)},e.showTip=function(t){var i=e._tipContainer,a=1;if(i){var n=i.getChildByName("tipBg");n.texture||(n.texture=ResourceManager.getRes("public_tipbg"));var o=e._tipContainer.getChildByName("msgText");o.text=t,o.setPosition(n.x+(n.width-o.width)/2,n.y+(n.height-o.height)/2),i.setScale(1),i.alpha=1,egret.Tween.removeTweens(i),i.setPosition(GameConfig.stageWidth/2,GameConfig.stageHeigth/2),a=o.numLines,LayerManager.msgLayer.contains(i)||LayerManager.msgLayer.addChild(i)}else{var s=new BaseDisplayObjectContainer,n=BaseBitmap.create("public_tipbg");n.setPosition(-n.width/2,-n.height/2),n.name="tipBg",s.addChild(n);var o=ComponentManager.getTextField(t,TextFieldConst.FONTSIZE_TITLE_SMALL);o.setPosition(n.x+(n.width-o.width)/2,n.y+(n.height-o.height)/2),o.textAlign=egret.HorizontalAlign.CENTER,o.name="msgText",o.lineSpacing=2,a=o.numLines,s.addChild(o),s.setPosition(GameConfig.stageWidth/2,GameConfig.stageHeigth/2),LayerManager.msgLayer.addChild(s),e._tipContainer=s}egret.Tween.get(e._tipContainer).to({scaleX:1.1,scaleY:1.1},100).to({scaleX:1,scaleY:1},70).wait(1300*a).to({alpha:0},200).call(function(t){t&&(egret.Tween.removeTweens(t),LayerManager.msgLayer.contains(t)&&LayerManager.msgLayer.removeChild(t),t.setScale(1),t.alpha=1)}.bind(this,e._tipContainer),this)},e.showCollectEffect=function(t,e,i,a,n,o){var s=new CollectEffect;s.start(t,e,i,a,n,o)},e.getCenterPos=function(t,i,a){return{x:e.getCenterX(t,i,a),y:e.getCenterY(t,i,a)}},e.getCenterX=function(t,e,i){var a=0,n=1;return i||(a=t.x,n=t.scaleX),a+=.5*(t.width*n-t.anchorOffsetX-e.width*e.scaleX+e.anchorOffsetX)},e.getCenterY=function(t,e,i){var a=0,n=1;return i||(a=t.y,n=t.scaleY),a+=.5*(t.height*n-t.anchorOffsetY-e.height*e.scaleY+e.anchorOffsetY)},e.getContainerByLeftHalfRes=function(t){var e=new BaseDisplayObjectContainer,i=BaseBitmap.create(t);e.addChild(i);var a=BaseBitmap.create(t);return a.scaleX=-1,a.x=i.x+i.width+a.width,e.addChild(a),e},e.getContainerByLeftTopRes=function(t){for(var e=new BaseDisplayObjectContainer,i=0;4>i;i++){var a=BaseBitmap.create(t),n=0,o=0;i%2==1&&(a.scaleX=-1,n=2*a.width),Math.floor(i/2)>0&&(a.scaleY=-1,o=2*a.height),a.setPosition(n,o),e.addChild(a)}return e},e.createMainUIIcon=function(t,i,a,n){"share_icon_name"==i&&1==PlatformManager.checkIsAiweiyouSp()&&(i="share_icon_name_aiweiyou");var o=new BaseDisplayObjectContainer,s=BaseBitmap.create("mainui_bottombtnbg");if(o.addChild(s),o.width=s.width,o.height=s.height,o.anchorOffsetX=s.width/2,o.anchorOffsetY=s.height/2,o.name=i,n)var r=BaseLoadBitmap.create("ac_icon_bg"+n,null,{callback:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];r.setPosition(s.x+(s.width-r.width)/2,s.y+(s.height-r.height)/2),o.addChildAt(r,1)},callbackThisObj:e});if(a){var l=BaseBitmap.create("mainui_iconani");l.anchorOffsetX=l.width/2,l.anchorOffsetY=l.height/2,l.setPosition(o.width/2,o.height/2),o.addChild(l),egret.Tween.get(l,{loop:!0}).to({rotation:360},1e3)}var h=BaseLoadBitmap.create(t);o.addChild(h);var d=BaseLoadBitmap.create(i);return o.addChild(d),d.setPosition(-8.5,50),o.addTouch(function(t,e){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:e.setScale(.95);break;case egret.TouchEvent.TOUCH_CANCEL:e.setScale(1);break;case egret.TouchEvent.TOUCH_END:e.setScale(1)}},this,[o]),o},e.addRedDotToBDOC=function(t){if(t&&t.getChildByName("reddot")){var e=t.getChildByName("reddot");e&&(e.visible=!0)}else{var e=BaseBitmap.create("public_dot2");e.x=t.width-e.width,t.addChild(e),e.name="reddot"}},e.removeRedDotFromBDOC=function(t){if(t&&t.getChildByName("reddot")){var e=t.getChildByName("reddot");e&&(e.visible=!1)}},e.createTalkContainer=function(t,e,i){void 0===e&&(e=!0);var a=new BaseDisplayObjectContainer,n=BaseBitmap.create("public_npc_talkbg");a.addChild(n);var o=BaseBitmap.create("public_npc_talkarrow");0==e&&(o.skewY=1);var s=ComponentManager.getTextField(t,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);return n.width=s.width+26,e?i?isNaN(i.lx)?isNaN(i.rx)?n.setPosition(o.x-n.width/2,o.y-n.height+2):n.setPosition(o.x+o.width-n.width+33,o.y-n.height+2):n.setPosition(o.x-33,o.y-n.height+2):n.setPosition(o.x-n.width/2,o.y-n.height+2):i?isNaN(i.lx)?isNaN(i.rx)?n.setPosition(o.x-n.width/2,o.y-n.height+2):n.setPosition(o.x-n.width+33,o.y-n.height+2):n.setPosition(o.x-o.width-33,o.y-n.height+2):n.setPosition(o.x-n.width/2,o.y-n.height+2),a.addChild(o),s.width=n.width-26,s.x=n.x+13,s.y=n.y+(n.height-s.height)/2,a.addChild(s),a},e.showGodbless=function(t){var e=new GodBless;LayerManager.msgLayer.addChild(e),e.show(t)},e.addTouchScaleEffect=function(t,i,a){t.addTouch(function(t,e,i,a){var n=.9;switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:e.setScale(.9),e.x+=e.width*(1-n)/2,e.y+=e.height*(1-n)/2;break;case egret.TouchEvent.TOUCH_END:e.setScale(1),e.x-=e.width*(1-n)/2,e.y-=e.height*(1-n)/2,i.apply(a);break;case egret.TouchEvent.TOUCH_CANCEL:e.setScale(1),e.x-=e.width*(1-n)/2,e.y-=e.height*(1-n)/2}},e,[t,i,a])},e.getMoneyString=function(e){var i="anyMoney";return PlatformManager.checkIsKRSp()&&t.DeviceUtil.isIOS()&&(i="anyMoneyDollar"),LanguageManager.getlocal(i,[e.toString()])},e.compareVersion=function(t,e){for(var i=t.split("."),a=e.split("."),n=Math.max(i.length,a.length),o=0;n>o;o++){var s=i[o],r=a[o];if(void 0===s)return-1;if(void 0===r)return 1;if(parseInt(s)>parseInt(r))return 1;if(parseInt(s)<parseInt(r))return-1}return 0},e}();t.CommonUtil=e,__reflect(e.prototype,"App.CommonUtil")}(App||(App={}));var LoginLoading=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getResourceList=function(){return[]},e.prototype.init=function(){var t=BaseBitmap.create("loginbg_progressbg");t.setPosition(GameConfig.stageWidth/2-t.width/2,GameConfig.stageHeigth-128.8),this.addChild(t),this._progressBar=ComponentManager.getProgressBar(ProgressBarConst.IMAGE_PROGRESS1,ProgressBarConst.IMAGE_PROGRESS1_Bg),this._progressBar.x=GameConfig.stageWidth/2-this._progressBar.getBgWidth()/2,this._progressBar.y=GameConfig.stageHeigth-100,this.addChild(this._progressBar),this.setPercentage(0);var e=BaseBitmap.create("login_loading");e.setPosition(.5*GameConfig.stageWidth-.5*e.width,this._progressBar.y-e.height-5),this.addChild(e);var i=ComponentManager.getBitmapText("0%","loadnum_fnt");i.width=100,i.textAlign=egret.HorizontalAlign.CENTER,i.setPosition(.5*GameConfig.stageWidth-.5*i.width,this._progressBar.y+this._progressBar.getBgHeight()+5),this.addChild(i),this._loadNumBMTxt=i},e.prototype.showBg=function(){App.LogUtil.log("开始显示loginLoading的bg"),e.hideDivLoading(),this._loadImg&&(BaseLoadBitmap.release(this._loadImg),this._loadImg=null),this._bg||(this._bg=BaseBitmap.create(PlatCfg.loginBg),this.addChildAt(this._bg,0))},e.prototype.setPercentage=function(t,e,i){this._progressBar&&(this._progressBar.setPercentage(t),this._loadNumBMTxt&&(this._loadNumBMTxt.text=Math.floor(100*t)+"%"))},e.prototype.getParent=function(){return LayerManager.panelLayer},e.prototype.dispose=function(){e.hideDivLoading(),this._progressBar=null,this._loadImg=null,this._loadNumBMTxt=null,t.prototype.dispose.call(this)},e.show=function(){e._loginLoading?e._loginLoading.parent||e._loginLoading.getParent().addChild(e._loginLoading):(e._loginLoading=new e,e._loginLoading.show())},e.hide=function(){e._loginLoading&&(e._loginLoading.parent&&e._loginLoading.parent.removeChild(e._loginLoading),e.hideDivLoading(),e._loginLoading.setPercentage(0))},e.showBg=function(){e._loginLoading&&e._loginLoading.showBg()},e.setPercentage=function(t,i,a){e._loginLoading&&e._loginLoading.setPercentage(t,i,a)},e.hideDivLoading=function(){if(App.DeviceUtil.IsHtml5()){var t=document.getElementById("alertdiv");null!=t&&(App.LogUtil.log("htmlloding移除完成"),t.parentNode.removeChild(t))}},e}(BaseLoadDisplayObjectContiner);__reflect(LoginLoading.prototype,"LoginLoading");var App;!function(t){var e;!function(e){function i(){e.isLoginBgLoaded&&e.isLoginViewResLoaded&&(LoginLoading.showBg(),ViewController.getInstance().openView(ViewConst.BASE.LOGINVIEW))}function a(){_()}function n(){t.LogUtil.log("startload loginBg"),StatisticsHelper.reportLoadData(3),ResourceManager.loadGroup("loginBg",function(){StatisticsHelper.reportLoadData(4),t.LogUtil.log("loadcomplete loginBg"),LoginLoading.show(),0==PlatformManager.checkIsUseSDK()&&a(),StatisticsHelper.reportLoadData(5),o()},function(t){},e)}function o(){t.LogUtil.log("startload loginRes");var i,a=PlatformManager.getSpid();if(PlatformManager.checkIsLocal()){var n=egret.getOption("language");n&&RES.hasRes(n)&&(a=n)}i=RES.hasRes(a)?a:"cn";var r=["loginRes",i];if(PlatformManager.checkIsKRSp()){var l=LocalStorageManager.get("isShowKRAgreement");l||r.push("kragreement")}ResourceManager.loadResources(r,[],function(){t.LogUtil.log("loadcomplete loginRes"),LanguageManager.setData(ResourceManager.getRes(i)),s()},function(t){var e=t.itemsLoaded/t.itemsTotal,i=t.itemsLoaded+"/"+t.itemsTotal;LoginLoading.setPercentage(e,i)},e,function(t){o()})}function s(){ResourceManager.loadGroup("loginSound",function(){r()},function(t){var e=t.itemsLoaded/t.itemsTotal,i=t.itemsLoaded+"/"+t.itemsTotal;LoginLoading.setPercentage(e,i)},e,function(t){r()})}function r(){StatisticsHelper.reportLoadData(6),e.isLoginViewResLoaded||(e.isLoginViewResLoaded=!0,i()),GameConfig.loadConfig()}function l(){1!=e.isLoginResLoaded&&(StatisticsHelper.reportLoadData(11),ResourceManager.loadResources(["preload","homeRes"],[],function(){h()},function(t){var e=t.itemsLoaded/t.itemsTotal,i=t.itemsLoaded+"/"+t.itemsTotal;LoginLoading.setPercentage(e,i)},e,function(t){l()}))}function h(){ResourceManager.loadGroup("homeSound",function(){d()},function(t){var e=t.itemsLoaded/t.itemsTotal,i=t.itemsLoaded+"/"+t.itemsTotal;LoginLoading.setPercentage(e,i)},e,function(t){d()})}function d(){StatisticsHelper.reportLoadData(12),PlatformManager.checkIsTWBSp()?(StatisticsHelper.reportLoadData(13),ResourceManager.loadResources(["preload_tw"],[],function(){StatisticsHelper.reportLoadData(14),g()},function(t){var e=t.itemsLoaded/t.itemsTotal,i=t.itemsLoaded+"/"+t.itemsTotal;LoginLoading.setPercentage(e,i)},e,function(t){d()})):g()}function g(){e.isLoginResLoaded=!0,e.isNeedLoadGuideRes?c():LoginManager.isLoginSuccess?(StatisticsHelper.reportLoadData(15),LoginManager.checkAndCreateScene()):LoginManager.waitToCheckLoadGuide=!0}function c(){PlatformManager.analyticsNewGuide(1),ResourceManager.loadGroup("rookieRes",function(){e.isLoginResLoaded=!0,LoginManager.checkAndCreateScene()},function(t){var e=t.itemsLoaded/t.itemsTotal,i=t.itemsLoaded+"/"+t.itemsTotal;LoginLoading.setPercentage(e,i)},LoginManager)}function p(){e.isNeedLoadGuideRes=!0,LoginManager.waitToCheckLoadGuide&&(LoginManager.waitToCheckLoadGuide=!1,c())}function _(){PlatCfg.initCfg(function(){var i=[];PlatCfg.loginBg&&i.push(PlatCfg.loginBg),PlatCfg.loginLogo&&i.push(PlatCfg.loginLogo),ResourceManager.loadResources(i,[],function(){t.LoginResLoader.isLoginBgLoaded||(t.LoginResLoader.isLoginBgLoaded=!0,t.LoginResLoader.checkAndShowLoginView())},null,e,function(){})},e)}function u(){e.isNeedLoadGuideRes=!1}function C(){if(m++,T>m)if(f[m]){var e=f[m];ResourceManager.loadItem(e,C,this)}else t.LogUtil.log("缺少"+f[m]),C()}e.isLoginBgLoaded=!1,e.isLoginViewResLoaded=!1,e.isLoginResLoaded=!1,e.isNeedLoadGuideRes=!1,e.isDefaultResLoaded=!1,e.checkAndShowLoginView=i,e.loadLoginBgRes=n,e.loadPublicRes=l,e.setNeedLoadGuideRes=p,e.initPlatCfg=_,e.dispose=u;var f=["wifeview_namebg","wifeview_charmicon","wifeview_vigoricon","wifeview_unlockmask","wife_listbg","arena_bottom","wifehalfbg","wifelookbtn_down","wifelookbtn","servant_mask","wifeview_itembg","wifeview_lockbg","wifeview_itembg2","wifeview_optbg","wifeview_bottombg2","wifeview_childicon","wifeview_vexpicon","wifeview_mask","wife_btnbg","wife_give","wife_love","wife_skill","wifeview_btnbg","wifeview_skin","wifeview_skinmask","wifeview_skingray","wifeview_skinstar","guide_hand","manage_foodname","manage_goldname","manage_namebg","manage_soldiername","btn_manage_normal_down","manage_boomtext","btn_manage_normal","btn_manage_red","btn_manage_red_down","arena_bottom","guide_hand","manage_recoverytxt","manage_managetxt","manage_waittime","managebg","servant_namebg","servant_dropBtn","servant_dropBtn_down","servant_dropIcon","servant_namebg","servant_star","servant_cardbg_selected","servant_topnumbg","servant_lvbg","servant_starbg","servant_topresbg","servant_probigbg","servant_detailBtn","servant_bottombg","progress3","progress3_bg","servant_namebg","servant_infobg","servant_infoPro1","servant_infoPro2","servant_infoPro3","servant_infoPro4","servant_infoTabbg","servant_upgrade_frame","levelup_lizi","levelup_lizi_json","servant_mask","servant_probigbg2","servant_alv_namebg","guide_hand","servant_downbg","servant_attribute1","servant_attribute2","servant_attribute3","servant_attribute4","servant_attributemap","servant_levebg","servant_speciality1","servant_speciality2","servant_speciality3","servant_speciality4","servant_speciality5","servant_speciality6","hold_dinner_box","cityscene","citynpcalliance","citynpcatkrace","citynpcbookroom","citynpcchallenge","citynpcconquest","citynpcdailyboss","citynpcdinner","citynpcpalace","citynpcprison","citynpcrank","citynpcsearch","citynpcstudyatk","citynpctrade","challenge_pass","progress4","progress7_bg","promotion_officerbg1","channel_bg","channel_light","channel_knife","battle_boss","challenge_icon_force","challenge_arrow","challenge_icon_power","office_fnt","challenge_story_bg","challenge_top_bg","btn_challenge_auto","mainui_fg","challenge_bg1","hero_anim_1","npc_anim_1","battlebg",ButtonConst.BATTLE_START_BTN_1,"exp_progress_bg","battle_dot_boss","battle_dot_none","battle_dot_full","battle_hero_bar","battle_info_bg","battle_npc_bar","battle_luanz","promotion_officerbg1","atkrace_skip","rechargetitlebg","recharge_fnt","rechargeview_greenarrow","rechargevie_topbar","common_left_bg","common_9_bg","rechargevie_close","rechargevie_down","rechargevie_open","achievement_state3","servant_topresbg","rechargedoubletip2","recharge_gift_tip","progress7","progress7_bg","itemeffect","rechargevie_btn","rechargevie_btn_down","rechargevie_receivebtn_down","rechargevie_receivebtn","rechargevie_received","rechargevie_receiveImg","rechargevie_effects","recharge_discount_left","recharge_discount_right","btn_small_orange_down","btn_small_orange","recharge2big","recharge4","rechargelistimg","recharges2mall","rechargetitlenewbg","recharge2_fnt","rechargetitlle","gov_icon","gov_img1","promotion_officerbg1","progress3","progress3_bg","affairview_bg","affairview_mark","affairview_zibg","affairview_zibg2","affairview_zhuozi","firstrecharge_bottom","firstrecharge2_bg","firstrecharge_font","firstrechargemask_bg","common_9_bg","common_left_bg","welfare_line","signin_had_get","welfare_hasbuy","itemeffect","monthcard_bigicon","yearcard_bigicon","godbless_bookRoom","godbless_child","godbless_manage","godbless_rank","godbless_servantLv","godbless_wife","signin2_bg","signin3_bg","rechargebox_bg1","rechargebox_bg2","rechargebox_bg","dinner_gems_1","unlock_challenge_skip","itemeffect","funtionbottom","progress6_bg","dinner_rankbg","dinnerrankpopupview","dinner_rank_titlebg","achievement_state3","common_titlebg","signin_had_get","dailytask_topbg","dailytask_icon1","dailytask_topbg","progress4","progress4_bg","dailytask_liveness","dailytask_box1_1","dailytask_box1_2","dailytask_box1_3","dailytask_liveness_numbg","dailytask_arrow","dailytask_box2_1","dailytask_box2_2","dailytask_box2_3","progress6_bg","progress5","progress3_bg","progress6","progress6_bg","achievement_state1","achievement_state2","achievement_state3","shopview_bg","shopview_corner","shopview_line","servant_bottombg","common_titlebg","vipLimit_img","palace_bg","palace_arrow_left","palace_arrow_right","palace_titlebg","palace_role_shadow","palace_role_empty","palace_historyBtn","palace_historyBtn_down","wifeview_bottombg","user_title_3000","user_title_3000_2","user_title_3001","user_title_3001_2","user_title_3002","user_title_3002_2","user_title_3003","user_title_3003_2","user_title_3004","user_title_3004_2","user_title_3005","user_title_3005_2","palace_title_bg","palace_title_bg_1","palace_rewardbg","servant_attributemap","palace_editBtn_down","palace_editBtn","playerview_bg2","playerview_btn1_txt","playerview_btn1","playerview_btn1_down","playerview_fan","playerview_btn1_bg","player_frame","playerview_wipbg","playerview_name_bg","playerview_powerbg","playerview_probg","playerview_pro1","playerview_pro2","playerview_pro3","playerview_pro4","playerview_pro5","playerview_pro6","playerview_pro_inmg2","playerview_infobg","playerview_arrow","playerview_pro7","progress3","progress3_bg","playerview_lvupBtn","playerview_lvupBtn_down","playerview_power_img","office_fnt","playerview_lvup_word","servant_mask","childview_bg","childview_girlicon","childview_boyicon","childview_mask","childview_pic_1","childview_powar","childview_power2","progress3","progress3_bg","servant_probigbg","childview_expup","childview_levelup","servant_upgrade_frame","levelup_lizi","levelup_lizi_json","childview_addicon","childview_bg1","childview_bg2","childview_bg3","childview_itembg","childview_namebg1","childview_namebg2","childview_newbg","servant_attributemap","servant_downbg","servant_levebg","servant_attribute1","servant_attribute2","servant_attribute3","servant_attribute4","servant_attributemap","bookroom_batch","bookroom_bg","bookroom_cdbg","bookroom_desk","bookroom_tipbg","bookroom_visitIcon","forpeople_bottom","bookroom_visitIcon_down","dailybossview","dailybossbg","promotion_officerbg1","progress8","progress7_bg","boss_start_war","boss_start_war_down","dailyboss_kaopao","dailybossbattle_more","dailybossbattle_more_down","rank_1","rank_2","rank_3","rank_display_namebg","rank_line","rank_select_mask","servant_bottombg","wifeview_bottombg","rank_visited","prisonview_bg","prisonview_progress","progress3_bg","prisonview_font","prisonview_redx","prisonview_itembg","prisonview_small_bg","searchbinfowifebg","prisonview_namebg","prison_head1","prison_head2","prison_body","prison_bottom","tokenAnimation","punish_ani1","punish_ani2","punish_ani3","punish_ani4","punish_light","prisonview_bg_2","prison_head1_2","prison_head2_2","forpeople_top","prisonview_font_2","searchbg1","progress3","common_buttombigbg","rankinglist_rankbg","rankinglist_line","arena_bg","arena_servant","forpeople_bottom","arena_bottom","atkrace_morale","arena_arrow","arena_bottom_bg","arena_more_down","arena_more","arena_rank","arena_rank_text","arena_visit","arena_visit_text","servant_mask","dinner_bg","dinner_black_circle","dinner_desk1","dinner_desk2","dinner_drum","dinner_exchange","dinner_message","dinner_name_bg1","dinner_name_bg2","dinner_rank","dinner_tip","dinner_waitress","dinner_roof","wifeview_bottombg","dinner_rank_titlebg","dinner_line","alliance_bg1","alliance_attbg","alliance_level","alliance_noticebg","recharge_fnt","alliance_notice","arena_bottom","arena_arrow","arena_bottom_bg","arena_more_down","arena_more","alliance_manageicon","alliance_manage","alliance_buildicon","alliance_build","alliance_memicon","alliance_mem","alliance_exicon","alliance_ex","alliance_bossicon","alliance_boss","allianc_rankicon","alliance_rank","alliance_iconbg","dinner_rank_titlebg","dinner_line","progress9","progress9_bg","rankinglist_line","rankinglist_rankbg","story_npc_8","studyatk_table","studyatk_bg1","wifeview_bottombg","studyatk_book","forpeople_bottom","studyatk_master_bg","studyatk_master","studyatk_pkBtn","studyatk_pkBtn_down","studyatk_table_npc","studyatk_book_name","atkrace_battle_info","arena_bg","battle_attack_anim",ProgressBarConst.IMAGE_PROGRESS_EXP,ProgressBarConst.IMAGE_PROGRESS_EXP_Bg,"conquest_cellbg","promotion_officerbg1","channel_bg","channel_light","channel_knife","challenge_icon_force","challenge_top_bg","mainui_topresbg","progress4","progress7_bg","mainui_fg","npc_anim_1","conquest_fightbg",ButtonConst.BATTLE_START_BTN_1,"exp_progress_bg","battle_hero_bar","battle_info_bg","battle_npc_bar","battle_luanz","promotion_officerbg1","trade_bg","forpeople_bottom","trade_tanlBtn","trade_tanlBtn_down","studyatk_master_bg","trade_ship1","trade_ship2","trade_ship3","trade_pb_bottombg","trade_port1","trade_port2","trade_port3","trade_port4","trade_port5","servant_infoPro2","trade_arrow","trade_bottombg","trade_bottomnumbg","trade_namebg_gray","trade_namebg_red","trade_bg2"],m=-1,T=f.length;e.autoLoadNextResItem=C}(e=t.LoginResLoader||(t.LoginResLoader={}))}(App||(App={}));var LoopLamp=function(t){function e(e){var i=t.call(this)||this;return i._stringList=e,i.init(),i}return __extends(e,t),e.prototype.init=function(){this._speed=GameConfig.stageWidth/6e3,this._tfPool=new Array,this.loadString()},e.prototype.loadString=function(){if(!(this._stringList.length<=0)){var t;t=this._tfPool[0]?this._tfPool.shift():ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),t.text=this._stringList[0];var e=this._stringList.shift();this._stringList.push(e),this.addChild(t),t.x=GameConfig.stageWidth;var i=this,a=(t.width+50)/this._speed,n=(GameConfig.stageWidth-50)/this._speed;egret.Tween.get(t).to({x:GameConfig.stageWidth-t.width-50},a).call(function(){i.loadString()},this).to({x:-t.width},n).call(function(t){egret.Tween.removeTweens(t),i._tfPool.push(t),t.parent&&t.parent.removeChild(t)},this,[t])}},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(LoopLamp.prototype,"LoopLamp");var PowerFly=function(t){function e(){var e=t.call(this)||this;return e._temScale=.6,e}return __extends(e,t),e.prototype.init=function(t){SoundManager.playEffect(SoundConst.EFFECT_SHOWTIP);var e=new BaseDisplayObjectContainer;this.addChild(e);var i="public_9_powertipbg",a=BaseBitmap.create(i);e.addChild(a);var n=LanguageManager.getlocal("powerAdd")+t,o=ComponentManager.getBitmapText(n,"crit_fnt");e.addChild(o),a.width=o.width+90,o.x=45,o.y=a.height/2-o.height/2,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,this.setPosition(GameConfig.stageWidth/2,GameConfig.stageHeigth/2),e.setScale(.1),this._tw=egret.Tween.get(e),this._tw.to({scaleX:1.2,scaleY:1.2},100).to({scaleX:1,scaleY:1},50).to({y:-80,alpha:.5},1500).call(this.onComplete,this)},e.prototype.onComplete=function(){this._tw&&(egret.Tween.removeTweens(this._tw),this._tw=null),this.dispose()},e.prototype.dispose=function(){this._tw&&(egret.Tween.removeTweens(this._tw),this._tw=null),this._temScale=.6,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(PowerFly.prototype,"PowerFly");var LoginView=function(t){function e(){var e=t.call(this)||this;return e._username="",e._inviteUid="",e._password="123456",e._isnotice=!1,PlatformManager.checkIsLocal()&&(e._password=""),e}return __extends(e,t),e.prototype.getCfg=function(t,e,i){var a=this;i||StatisticsHelper.reportLoadData(8),NetLoading.show();var n=this,o={t:"getlastserver",pid:LoginManager.getLocalUserName()};ServerCfg.checkServerDebug()&&(o.debug=1);var s=PlatformManager.getAppVersion(),r=PlatformManager.getAppid();s&&(o.version=s),r&&(o.channel=r),PlatformManager.checkIsIOSShenheSp()&&(o.isShenhe="1"),o.isnew=!0,console.log("start getcfg"),NetManager.http.get(ServerCfg.svrCfgUrl,o,function(i){StatisticsHelper.reportLoadData(9);var o=i.server,s=i.isnewuser;if(NetLoading.hide(),ServerCfg.lastServer=o,o.state&&n.showLoginNotice(o.state,o.msg),i&&i.notice&&i.notice.length>0&&!s){a._isnotice=!0,a._noticeButton.visible=!0;var r={};r.name="login",r.notice=i.notice,ViewController.getInstance().openView(ViewConst.COMMON.GAMEANNOUNCEMENtVIEW,r)}else a._isnotice=!1,a._noticeButton&&(a._noticeButton.visible=!1);
o&&o.zid&&ServerCfg.setServerData(o),console.log("getcfg success"),t&&t.call(e),s&&n.loginBtnHandler()},function(){NetLoading.hide(),console.log("get serverlist error"),n.getCfg(t,e,!0)},this)},e.prototype.initView=function(){if(StatisticsHelper.reportLoadData(7),App.LogUtil.log("iniview loginView"),App.LogUtil.log("ready play login music"),this.playBgMusic(),App.LogUtil.log("play login music end"),GameConfig.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playBgMusic,this),ResourceManager.getRes(PlatCfg.loginBg)){var t=BaseBitmap.create(PlatCfg.loginBg);this.addChild(t)}this.showLogoAndLoginBtn()},e.prototype.playBgMusic=function(){try{SoundManager.playBg(SoundConst.MUSIC_LOGIN)}catch(t){App.LogUtil.log("login播放背景音效报错"+t)}GameConfig.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.playBgMusic,this)},e.prototype.showLogoAndLoginBtn=function(){if(!App.MessageHelper.hasEventListener(MessageConst.MESSAGE_NOTICE_SELECT_SERVERLIST)){if(App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_SELECT_SERVERLIST,this.refresh,this),this._serverContainer)return this._serverContainer.visible=!0,this._serverContainer&&(this._serverContainer.visible=!0),this._serverBg&&(this._serverBg.visible=!0),this._switchAccountBtn&&(this._switchAccountBtn.visible=!0),void(this._noticeButton&&(this._noticeButton.visible=!0));if(1!=PlatformManager.checkIsTWBSp()&&PlatCfg.loginLogo){var t=void 0;t=BaseBitmap.create(PlatCfg.loginLogo),t.x=GameConfig.stageWidth/2-t.width/2,t.y=5,this.addChild(t)}this._serverContainer=new BaseDisplayObjectContainer,this.addChild(this._serverContainer),this._serverBg=BaseBitmap.create("loginres_9_serverbg"),this._serverBg.width=452,this._serverContainer.addChild(this._serverBg),this._serverContainer.addTouch(this.clickSelectedHandler,this),this._serverContainer.setPosition(GameConfig.stageWidth/2-this._serverBg.width/2,GameConfig.stageHeigth-290);var e=TextFieldConst.COLOR_WARN_RED3,i=LanguageManager.getlocal("serverListOld");ServerCfg.selectServer&&1==ServerCfg.selectServer.flag&&(i=LanguageManager.getlocal("serverListNew"),e=TextFieldConst.COLOR_WARN_GREEN);var a=ComponentManager.getTextField(i,TextFieldConst.FONTSIZE_CONTENT_COMMON);a.textColor=e,a.x=30,a.y=this._serverContainer.height/2-a.height/2,a.name="serverStateTxt",this._serverContainer.addChild(a);var n=ComponentManager.getTextField("1",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);n.width=200,n.textAlign=egret.HorizontalAlign.CENTER,n.x=this._serverContainer.width/2-n.width/2,n.y=this._serverContainer.height/2-n.height/2,n.text=ServerCfg.selectServer&&ServerCfg.selectServer.sname?ServerCfg.selectServer.sname:"",n.name="serverNameTxt",this._serverContainer.addChild(n);var o=BaseBitmap.create("loginres_txt1");o.x=this._serverContainer.width-o.width-20,o.y=this._serverContainer.height/2-o.height/2,this._serverContainer.addChild(o),this._noticeButton=ComponentManager.getButton("loginres_logo_notice","",this.showNotice,this),this._noticeButton.x=10,this._noticeButton.y=10,this.addChild(this._noticeButton),this._noticeButton.visible=!1,this._isnotice?this._noticeButton.visible=!0:this._noticeButton.visible=!1,this._switchAccountBtn=ComponentManager.getButton("loginres_btn2","",this.switchAccountHandler,this),this._switchAccountBtn.setPosition(App.DeviceUtil.isWXgame()?10:GameConfig.stageWidth-this._switchAccountBtn.width-10,10),this.addChild(this._switchAccountBtn);var s=PlatformManager.checkIsLoginPlat();PlatformManager.checkHideSwitchAccountBtn()?this._switchAccountBtn.visible=!1:this._switchAccountBtn.visible=s,App.MessageHelper.addEventListener(MessageConst.MESSAGE_PLAT_LOGIN_SUCCESS,this.sdkLoginSuccess,this),this._loginButton=ComponentManager.getButton("loginres_btn3","",this.loginBtnHandler,this),this._loginButton.x=GameConfig.stageWidth/2-this._loginButton.width/2,this._loginButton.y=this._serverContainer.y+this._serverContainer.height+20,this.addChild(this._loginButton);var r=ComponentManager.getTextField("背景故事纯属虚构，并非真实历史故事",14,TextFieldConst.COLOR_QUALITY_GRAY),l=PlatformManager.getStatement();if(PlatformManager.checkIsShowWarning())if(l){var h=BaseBitmap.create("public_9_black");h.width=640,h.height=70,h.setPosition(0,GameConfig.stageHeigth-h.height),this.addChild(h);var d=BaseBitmap.create("loginres_9_gradual");d.width=640,d.setPosition(0,h.y-d.height),this.addChild(d),this.addChild(r);var g=ComponentManager.getTextField("抵制不良游戏  拒绝盗版游戏  注意自我保护  谨防上当受骗\n适度游戏益脑  沉迷游戏伤身  合理安排时间  享受健康生活",TextFieldConst.FONTSIZE_CONTENT_SMALL);g.lineSpacing=5,g.setPosition((GameConfig.stageWidth-g.width)/2,GameConfig.stageHeigth-h.height-g.height-20),this.addChild(g);var c=ComponentManager.getTextField(l,16);c.width<GameConfig.stageWidth-20&&(c.textAlign=egret.HorizontalAlign.CENTER),c.lineSpacing=5,c.width=GameConfig.stageWidth-20,c.setPosition(10,GameConfig.stageHeigth-h.height+(h.height-c.height)/2),this.addChild(c),r.setPosition(GameConfig.stageWidth-r.width-5,h.y-r.height-3)}else{var h=BaseBitmap.create("public_9_black");h.width=640,h.height=88,h.setPosition(0,GameConfig.stageHeigth-h.height),this.addChild(h),this.addChild(r);var g=ComponentManager.getTextField("抵制不良游戏  拒绝盗版游戏  注意自我保护  谨防上当受骗\n适度游戏益脑  沉迷游戏伤身  合理安排时间  享受健康生活",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);g.lineSpacing=5,g.setPosition((GameConfig.stageWidth-g.width)/2,GameConfig.stageHeigth-g.height-20),this.addChild(g),r.setPosition(GameConfig.stageWidth-r.width-5,h.y-r.height-5)}else r.setPosition(GameConfig.stageWidth-r.width-5,GameConfig.stageHeigth-r.height-5);if(PlatformManager.checkIsUseSDK())if(0==PlatformManager.isLogin){if(RSDKHelper.isInit)if(PlatformManager.checkIsKRSp()){var p=LocalStorageManager.get("isShowKRAgreement");p&&""!=p?this.doLogin():ViewController.getInstance().openView(ViewConst.BASE.KRAGREEMENTVIEW,{confirmCallback:this.doLogin,handler:this})}else this.doLogin()}else ServerCfg.selectServer&&ServerCfg.selectServer.zid||this.getCfg(this.refresh,this);else(GameData.isLocal()||GameData.isTest())&&(PlatformManager.userId=LoginManager.getLocalUserName(),GameData.tmpUserPassword=LoginManager.getUserPassword(),PlatformManager.userId?ServerCfg.selectServer&&ServerCfg.selectServer.zid||this.getCfg(this.refresh,this):this.showAccountPanel())}},e.prototype.doLogin=function(){PlatformManager.client.checkWeiduanUpgrade(),PlatformManager.login()},e.prototype.showNotice=function(){var t={};t.name="login",ViewController.getInstance().openView(ViewConst.COMMON.GAMEANNOUNCEMENtVIEW,t)},e.prototype.showLoginNotice=function(t,e){if(t&&e&&1==Number(t)){var i=new BaseDisplayObjectContainer,a=new BaseShape;a.graphics.beginFill(0,.4),a.graphics.drawRect(0,0,GameConfig.stageWidth,GameConfig.stageHeigth),a.graphics.endFill(),i.addChild(a),a.touchEnabled=!0;var n=new BaseShape;n.graphics.beginFill(0,.7),n.graphics.drawRoundRect(0,0,540,300,15,15),n.graphics.endFill(),n.setPosition((i.width-n.width)/2,(i.height-n.height)/2),i.addChild(n);var o=ComponentManager.getTextField(e,TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);o.textAlign=egret.HorizontalAlign.CENTER,o.lineSpacing=5,o.width=n.width-60,o.setPosition(n.x+(n.width-o.width)/2,n.y+(n.height-o.height)/2),i.addChild(o),this.addChild(i),this.hideLoginBtn()}},e.prototype.sdkLoginSuccess=function(){ServerCfg.selectServer&&ServerCfg.selectServer.zid||this.getCfg(this.refresh,this),PlatformManager.checkHideSwitchAccountBtn()||this._switchAccountBtn&&(this._switchAccountBtn.visible=!0)},e.prototype.refresh=function(){if(this._serverContainer){var t=this._serverContainer.getChildByName("serverStateTxt");if(t){var e=TextFieldConst.COLOR_WARN_RED,i=LanguageManager.getlocal("serverListOld");ServerCfg.selectServer&&1==ServerCfg.selectServer.flag&&(i=LanguageManager.getlocal("serverListNew"),e=TextFieldConst.COLOR_WARN_GREEN),t.textColor=e,t.text=i}var a=this._serverContainer.getChildByName("serverNameTxt");a&&(a.text=ServerCfg.selectServer.sname)}},e.prototype.loginBtnHandler=function(){return PlatformManager.checkIsUseSDK()&&0==PlatformManager.isLogin?void PlatformManager.login():void(!PlatformManager.checkIsUseSDK()||1!=PlatformManager.checkIsTWBSp()&&1!=PlatformManager.checkIsTWShenheSp()&&"17004000"!=PlatformManager.getBigAppid()?this.doLoginHandler():(App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_TWLOGIN,this.doLoginHandler,this),PlatformManager.client.checkServerState(ServerCfg.selectServer.zid)))},e.prototype.doLoginHandler=function(){StatisticsHelper.reportLoadData(10),App.LogUtil.log("gotoSdk"),LoginManager.login()},e.prototype.showAccountPanel=function(){this._maskSp=new egret.Shape,this._maskSp.graphics.beginFill(TextFieldConst.COLOR_BLACK,.5),this._maskSp.graphics.drawRect(0,0,GameConfig.stageWidth,GameConfig.stageHeigth),this._maskSp.graphics.endFill(),this._maskSp.touchEnabled=!0,this.addChild(this._maskSp),this._accountPanel=new BaseDisplayObjectContainer,this.addChild(this._accountPanel);var t=new egret.Shape;t.graphics.beginFill(TextFieldConst.COLOR_BLACK,1),t.graphics.drawRect(0,0,400,300),t.graphics.endFill(),this._accountPanel.addChild(t),this._accountPanel.x=GameConfig.stageWidth/2-t.width/2,this._accountPanel.y=GameConfig.stageHeigth/2-t.height/2;var e=new BaseTextField;e.x=20,e.y=50,e.text="账号：",this._accountPanel.addChild(e);var i=new egret.Shape;i.graphics.beginFill(TextFieldConst.COLOR_LIGHT_RED,1),i.graphics.drawRect(0,0,250,50),i.graphics.endFill(),i.graphics.beginFill(TextFieldConst.COLOR_BLACK,1),i.graphics.drawRect(1,1,248,48),i.graphics.endFill(),i.x=110,i.y=e.y+e.height/2-i.height/2,this._accountPanel.addChild(i);var a=new BaseTextField;a.type=egret.TextFieldType.INPUT,a.width=250,a.height=e.height,a.x=120,a.y=50;var n=new BaseTextField;n.x=20,n.y=150,n.text="邀请者uid：",this._accountPanel.addChild(n);var o=new egret.Shape;o.graphics.beginFill(TextFieldConst.COLOR_LIGHT_RED,1),o.graphics.drawRect(0,0,210,50),o.graphics.endFill(),o.graphics.beginFill(TextFieldConst.COLOR_BLACK,1),o.graphics.drawRect(1,1,208,48),o.graphics.endFill(),o.x=150,o.y=n.y+n.height/2-o.height/2,this._accountPanel.addChild(o);var s=new BaseTextField;s.type=egret.TextFieldType.INPUT,s.width=210,s.height=n.height,s.x=160,s.y=150,GameData.isTest()||(a.maxChars=100),a.text=PlatformManager.userId,this._username=a.text,this._accountPanel.addChild(a),a.addEventListener(egret.TextEvent.CHANGE,this.callbackInput,this,!1,2),this._accountPanel.addChild(s),s.addEventListener(egret.TextEvent.CHANGE,this.callbackInviteUidInput,this,!1,2);var r=ComponentManager.getButton("loginres_btn3","",this.confirmHandler,this);r.x=this._accountPanel.width/2-r.width/2,r.y=this._accountPanel.height-70,this._accountPanel.addChild(r)},e.prototype.callbackInput=function(t){this._username=t.target.text,App.LogUtil.log("event.target.text:"+t.target.text)},e.prototype.callbackInviteUidInput=function(t){this._inviteUid=t.target.text,App.LogUtil.log("event.target.text:"+t.target.text)},e.setLoginByPID=function(t,e){var i=ViewController.getInstance().getView(ViewConst.BASE.LOGINVIEW);i&&i.setLoginByPID(t,e)},e.prototype.setLoginByPID=function(t,e){this._accountPanel&&(this._accountPanel.dispose(),this._accountPanel=null),PlatformManager.userId=t,GameData.tmpUserPassword=e,this.loginBtnHandler()},e.prototype.confirmHandler=function(){return this._username.length>100?void App.CommonUtil.showTip("账号不能超过100位字符"):this._username.length<3?void App.CommonUtil.showTip("账号最少三个字符"):(this._accountPanel&&(this._accountPanel.dispose(),this._accountPanel=null),this._maskSp&&this.contains(this._maskSp)&&(this.removeChild(this._maskSp),this._maskSp=null),PlatformManager.userId=this._username,PlatformManager.inviter_uid=this._inviteUid,GameData.tmpUserPassword=this._password,void(ServerCfg.selectServer&&ServerCfg.selectServer.zid||this.getCfg(this.refresh,this)))},e.prototype.hideLoginBtn=function(){this._serverContainer&&(this._serverContainer.visible=!1),this._serverBg&&(this._serverBg.visible=!1),this._switchAccountBtn&&(this._switchAccountBtn.visible=!1),this._loginButton&&(this._loginButton.visible=!1),this._noticeButton&&(this._noticeButton.visible=!1)},e.prototype.switchAccountHandler=function(t){if(App.LogUtil.log("switchAccountHandler"),PlatformManager.checkIsUseSDK()){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_LOGOUT,this.hideSwitchBtn,this);var e=PlatformManager.logout();e&&this.hideSwitchBtn()}else this.showAccountPanel()},e.prototype.getTitleStr=function(){return null},e.prototype.hideSwitchBtn=function(){this._switchAccountBtn&&(this._switchAccountBtn.visible=!1),PlatformManager.checkIsKRSp()&&PlatformManager.login()},e.prototype.clickSelectedHandler=function(t){var e=this._serverContainer,i=e.scaleX,a=e.scaleY;switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:e.setScale(.95);break;case egret.TouchEvent.TOUCH_END:e.setScale(1),ViewController.getInstance().openView(ViewConst.POPUP.SERVERLISTPOPUPVIEW);break;case egret.TouchEvent.TOUCH_CANCEL:e.setScale(1)}e.x+=(e.width*i-e.width*e.scaleX)/2,e.y+=(e.height*a-e.height*e.scaleY)/2},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_RSDK_INIT_SUCCESS,this.preInit,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_LOGOUT,this.hideSwitchBtn,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_PLAT_LOGIN_SUCCESS,this.sdkLoginSuccess,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_SELECT_SERVERLIST,this.refresh,this),GameConfig.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.playBgMusic,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_TWLOGIN,this.doLoginHandler,this),this._serverContainer=null,this._switchAccountBtn&&(this._switchAccountBtn.dispose(),this._switchAccountBtn=null),t.prototype.dispose.call(this)},e}(BaseView);__reflect(LoginView.prototype,"LoginView");var BaseDisplayObject=function(t){function e(){var e=t.call(this)||this;return e.bindData=null,e._touchTapHelper=null,e._touchHelper=null,e}return __extends(e,t),e.prototype.addTouchTap=function(t,e,i){null==this._touchTapHelper&&(this._touchTapHelper=TouchHelper.addTouchTap(this,t,e,i))},e.prototype.removeTouchTap=function(){this._touchTapHelper&&(this._touchTapHelper.removeTouchTap(),this._touchTapHelper=null)},e.prototype.addTouch=function(t,e,i,a){this._touchHelper||(this._touchHelper=TouchHelper.addTouch(this,t,e,i,a))},e.prototype.removeTouch=function(){this._touchHelper&&(this._touchHelper.removeTouch(),this._touchHelper=null)},e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.stopAllActions=function(){egret.Tween.removeTweens(this)},e.prototype.setVisible=function(t){this.visible=t},e.prototype.setScale=function(t){this.scaleX=this.scaleY=t},e.prototype.dispose=function(){this.stopAllActions(),this.removeTouchTap(),this.removeTouch(),this.bindData=null},e}(egret.DisplayObject);__reflect(BaseDisplayObject.prototype,"BaseDisplayObject",["base.Iinteractive","base.Ibase"]);var AchievementDetailPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_ACH_GETDETAILREWARD,this.doGetReward,this),e.itemId=this.param.data.achId;var t=egret.Rectangle.create();t.setTo(0,0,522,640);var i=Api.achievementVoApi.getAchDetailList(e.itemId);this._oldList=i,this._scrollList=ComponentManager.getScrollList(AchievementDetailScrollItem,i,t),this.addChildToContainer(this._scrollList),this._scrollList.x=25,this._scrollList.y=20},e.prototype.doGetReward=function(t){this._achIndex=t.data.achIndex,this.request(NetRequestConst.REQUEST_ACHIEVEMENT_GETREWARDS,{aid:e.itemId})},e.prototype.receiveData=function(t){var i=Api.achievementVoApi.getAchDetailIndexVoById2(e.itemId,this._achIndex,this._oldList),a=this._scrollList.getItemByIndex(i);a.refreshData(i);var n=this._scrollList.getItemByIndex(i+1);n&&n.refreshData(i+1);var o=GameData.formatRewardItem(t.data.data.rewards);App.CommonUtil.playRewardFlyAction(o),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_ACH_REFRESHLIST,{achId:e.itemId})},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_ACH_GETDETAILREWARD,this.doGetReward,this),this._scrollList=null,this._achIndex=null,this._oldList=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AchievementDetailPopupView.prototype,"AchievementDetailPopupView");var AchievementDetailScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=522,this.height=100+this.getSpaceY(),this._achIndex=e;var i=Api.achievementVoApi.getAchievementInfoVoById(AchievementDetailPopupView.itemId);this._achInfo=i;var a=Config.AchievementCfg.getAchievementCfgById(i.id),n=BaseBitmap.create("public_9_probiginnerbg");n.width=this.width,n.height=100,this.addChild(n);var o=e+1+"."+i.name,s=ComponentManager.getTextField(o,TextFieldConst.FONTSIZE_CONTENT_COMMON);s.x=20,s.y=30,this.addChild(s);var r=GameData.getRewardsStr(a.reward[e]),l=ComponentManager.getTextField(r,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN);l.x=s.x,l.y=60,this.addChild(l);var h="("+i.v+"/"+a.value[e]+")";this._achProTF=ComponentManager.getTextField(h,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_YELLOW),this._achProTF.x=s.x+s.width+10,this._achProTF.y=s.y,this.addChild(this._achProTF),this._getBtn=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskCollect",this.getBtnClickHandler,this),this._getBtn.x=378,this._getBtn.y=this.height/2-this._getBtn.height/2,this._getBtn.setColor(TextFieldConst.COLOR_BLACK),this.addChild(this._getBtn),this._stateIcon=BaseBitmap.create("achievement_state2"),this._stateIcon.x=378,this._stateIcon.y=this.height/2-this._stateIcon.height/2,this.addChild(this._stateIcon);i.stage,a.value[Api.achievementVoApi.getAchProById(i.id)];this._getBtn.visible=!1,this._stateIcon.visible=!0,e<i.stage-1?this._stateIcon.texture=ResourceManager.getRes("achievement_state3"):a.value[e]>i.v?this._achIndex==i.stage-1?this._stateIcon.texture=ResourceManager.getRes("achievement_state1"):this._stateIcon.texture=ResourceManager.getRes("achievement_state2"):e==i.stage-1?2==i.f?(this._getBtn.visible=!1,this._stateIcon.visible=!0,this._stateIcon.texture=ResourceManager.getRes("achievement_state3")):(this._getBtn.visible=!0,this._stateIcon.visible=!1):this._stateIcon.texture=ResourceManager.getRes("achievement_state1")},e.prototype.refreshData=function(t){var e=Api.achievementVoApi.getAchievementInfoVoById(AchievementDetailPopupView.itemId),i=(e.stage,Config.AchievementCfg.getAchievementCfgById(e.id));i.value[Api.achievementVoApi.getAchProById(e.id)];this._getBtn.visible=!1,this._stateIcon.visible=!0;var a=this._achIndex;a<e.stage-1?this._stateIcon.texture=ResourceManager.getRes("achievement_state3"):i.value[a]>e.v?this._achIndex==e.stage-1?this._stateIcon.texture=ResourceManager.getRes("achievement_state1"):this._stateIcon.texture=ResourceManager.getRes("achievement_state2"):a==e.stage-1?2==e.f?(this._getBtn.visible=!1,this._stateIcon.visible=!0,this._stateIcon.texture=ResourceManager.getRes("achievement_state3")):(this._getBtn.visible=!0,this._stateIcon.visible=!1):this._stateIcon.texture=ResourceManager.getRes("achievement_state1")},e.prototype.getBtnClickHandler=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_ACH_GETDETAILREWARD,{achIndex:this._achIndex})},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._achProTF=null,this._getBtn=null,this._stateIcon=null,this._achInfo=null,this._achIndex=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AchievementDetailScrollItem.prototype,"AchievementDetailScrollItem");var AchievementScrollItem=function(t){function e(){var e=t.call(this)||this;return e._expProgress=null,e._achRedDotSp=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=616,this.height=148+this.getSpaceY(),this._achInfo=e;var i=Config.AchievementCfg.getAchievementCfgById(e.id),a=BaseBitmap.create("public_9_bg14");a.width=this.width,a.height=148,this.addChild(a);var n=BaseBitmap.create("progress6_bg");n.x=7,n.y=20,this.addChild(n);var o=new BaseDisplayObjectContainer;this.addChild(o),o.x=n.x+n.width/2-44,o.y=n.y+n.height/2-44;var s=BaseLoadBitmap.create(e.icon);o.addChild(s);var r=BaseLoadBitmap.create(e.nameIcon);r.x=17,r.y=58,o.addChild(r),App.CommonUtil.addTouchScaleEffect(o,this.clickItemHandler,this);var l=Api.achievementVoApi.getAchProById(e.id),h=ComponentManager.getCircleProgressBar("progress6");h.setPercentage(l/i.value.length*100),h.x=7,h.y=20,this.addChild(h),this._achRedDotSp=BaseBitmap.create("public_dot2"),this._achRedDotSp.x=n.x+n.width-this._achRedDotSp.width-20,this._achRedDotSp.y=n.y+2,this.addChild(this._achRedDotSp),1==e.f?this._achRedDotSp.visible=!0:this._achRedDotSp.visible=!1;var d=BaseBitmap.create("public_numbg");d.width=194,d.height=41,d.x=140,d.y=30,this.addChild(d);var g=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_WARN_YELLOW);g.x=d.x+15,g.y=d.y+d.height/2-g.height/2,this.addChild(g),this._expProgress=ComponentManager.getProgressBar("progress5","progress3_bg",300),this._expProgress.setPosition(140,90),this._expProgress.setTextSize(TextFieldConst.FONTSIZE_CONTENT_SMALL),this.addChild(this._expProgress);var c=i.value[Api.achievementVoApi.getAchProById(e.id)];c||(c=e.v),this._expProgress.setPercentage(e.v/c);var p=e.v+"/"+c;this._achProTF=ComponentManager.getTextField(p,TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._achProTF.x=this._expProgress.x+this._expProgress.width/2-this._achProTF.width/2,this._achProTF.y=this._expProgress.y+this._expProgress.height/2-this._achProTF.height/2,this.addChild(this._achProTF),this._getBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"taskCollect",this.getBtnClickHandler,this),this._getBtn.x=450,this._getBtn.y=70-this._getBtn.height/2,this._getBtn.setColor(TextFieldConst.COLOR_BLACK),this.addChild(this._getBtn),this._stateIcon=BaseBitmap.create("achievement_state1"),this._stateIcon.x=450,this._stateIcon.y=70-this._stateIcon.height/2,this.addChild(this._stateIcon),0==e.f?this._getBtn.visible=!1:1==e.f?this._stateIcon.visible=!1:2==e.f&&(this._stateIcon.visible=!1,this._getBtn.visible=!1,h.setPercentage(100)),this.cacheAsBitmap=!0},e.prototype.clickItemHandler=function(t){ViewController.getInstance().openView(ViewConst.POPUP.ACHIEVEMENTDETAILPOPUPVIEW,{achId:this._achInfo.id})},e.prototype.refreshData=function(t){var e=Api.achievementVoApi.getAchievementInfoVoById(this._achInfo.id),i=Config.AchievementCfg.getAchievementCfgById(e.id),a=i.value[Api.achievementVoApi.getAchProById(e.id)];this._expProgress.setPercentage(e.v/a);var n=e.v+"/"+a;this._achProTF.text=n,0==e.f?(this._getBtn.visible=!1,this._stateIcon.visible=!0):1==e.f?(this._getBtn.visible=!1,this._stateIcon.visible=!0):2==e.f&&(this._stateIcon.visible=!1,this._getBtn.visible=!1),1==e.f?this._achRedDotSp.visible=!0:this._achRedDotSp.visible=!1},e.prototype.getBtnClickHandler=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_ACH_GETREWARD,{achId:this._achInfo.id})},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._achProTF=null,this._getBtn=null,this._stateIcon=null,this._expProgress=null,this._achInfo=null,this._achRedDotSp=null,this.cacheAsBitmap=!1,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AchievementScrollItem.prototype,"AchievementScrollItem");var AchievementView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_ACH_GETREWARD,this.doGetReward,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_ACH_REFRESHLIST,this.refreshItem,this);var t=BaseBitmap.create("public_9_bg23");t.width=GameConfig.stageWidth-10,t.height=GameConfig.stageHeigth-105,t.x=5,t.y=-7,this.addChildToContainer(t);var e=Api.achievementVoApi.getAchievementInfoVoList();this._oldList=e;var i=egret.Rectangle.create();i.setTo(0,0,t.width-6,t.height-8),this._scrollList=ComponentManager.getScrollList(AchievementScrollItem,e,i),this.addChildToContainer(this._scrollList),this._scrollList.x=t.x+t.width/2-this._scrollList.width/2+4,this._scrollList.y=t.y+t.height/2-this._scrollList.height/2},e.prototype.doGetReward=function(t){this._achId=t.data.achId,this.request(NetRequestConst.REQUEST_ACHIEVEMENT_GETREWARDS,{aid:t.data.achId})},e.prototype.receiveData=function(t){this.refreshItem();var e=GameData.formatRewardItem(t.data.data.rewards);App.CommonUtil.playRewardFlyAction(e)},e.prototype.refreshItem=function(){var t=Api.achievementVoApi.getAchievementInfoVoList();this._scrollList.refreshData(t)},e.prototype.clickItemHandler=function(t){var e=Number(t.data),i=Api.achievementVoApi.getAchievementInfoVoList(),a=i[e];ViewController.getInstance().openView(ViewConst.POPUP.ACHIEVEMENTDETAILPOPUPVIEW,{achId:a.id})},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["progress5","progress3_bg","progress6","progress6_bg","achievement_state1","achievement_state2","achievement_state3"])},e.prototype.dispose=function(){this._scrollList=null,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_ACH_GETREWARD,this.doGetReward,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_ACH_REFRESHLIST,this.refreshItem,this),this._achId=null,this._oldList=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(AchievementView.prototype,"AchievementView");var RewardFly=function(t){function e(){var e=t.call(this)||this;return e._temScale=.6,e}return __extends(e,t),e.prototype.init=function(t,e,i){void 0===i&&(i=0),SoundManager.playEffect(SoundConst.EFFECT_SHOWTIP);var a=new BaseDisplayObjectContainer;this.addChild(a);var n=0,o=0,s=null,r="public_itemtipbg2";t&&(r="public_itemtipbg");var l=BaseBitmap.create(r);if(a.addChild(l),t){var h=BaseBitmap.create("public_tipiconbg");a.addChild(h);var d=egret.Rectangle.create();d.setTo(0,0,100,100),s=BaseLoadBitmap.create(t,d),s.setScale(this._temScale),(10==i||8==i)&&(s.scaleX=s.scaleY=.5),a.addChild(s),l.x=40,l.y=s.y+.7*s.height/2-l.height/2-5}var g=ComponentManager.getBitmapText(e,TextFieldConst.FONTNAME_ITEMTIP);s&&(n=s.width*s.scaleX,o=s.height*s.scaleY/2),g.x=n,g.y=o-g.height/2,l.width=g.width+50,g.x=n,s?(g.y=s.y+.7*s.height/2-g.height/2,g.y=l.y+l.height/2-g.height/2):(g.x=l.x+(l.width-g.width)/2,g.y=l.y+l.height/2-g.height/2),a.addChild(g),a.x=-a.width/2,this._tw=egret.Tween.get(a),this._tw.to({y:-80},1500).call(this.onComplete,this)},e.prototype.onComplete=function(){this._tw&&(egret.Tween.removeTweens(this._tw),this._tw=null),this.dispose()},e.prototype.dispose=function(){this._tw&&(egret.Tween.removeTweens(this._tw),this._tw=null),this._temScale=.6,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(RewardFly.prototype,"RewardFly");var AcCarnivalChargeScrollItem=function(t){function e(){var e=t.call(this)||this;return e._itemData=void 0,e._curIdx=0,e._rechargeItem=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(MessageConst.MESSAGE_ACCARNIVAL_CHANGE_CHARGE,this.refreshBtnStatus,this),this._itemData=e,this._curIdx=t;var i=Api.acVoApi.getActivityVoByAidAndCode("carnivalCharge"),a=Config.AcCfg.getCfgByActivityIdAndCode("carnivalCharge",i.code);this._rechargeItem=a.getRechargeItemById(this._itemData);var n=BaseBitmap.create("public_9_bg14");n.width=598,n.height=246,this.addChild(n),this._detailBgImg=BaseBitmap.create("accarnivalview_tab_red"),this._detailBgImg.y=5,this._detailBgImg.x=2,this.addChild(this._detailBgImg);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);o.text=LanguageManager.getlocal("acCarnivalChargeItemTitle",[String(this._rechargeItem.needGem)]),o.x=this._detailBgImg.x+20,o.y=this._detailBgImg.y+10,this.addChild(o);for(var s=GameData.formatRewardItem(this._rechargeItem.reward),r=60,l=14,t=0;t<s.length;t++){var h=GameData.getItemIcon(s[t],!0,!0);h.x=l,h.y=r,l+=h.width+7,l>n.width-8&&(l=14,r+=h.height+10,h.x=l,h.y=r,l+=h.width+7),this.addChild(h)}r+=130,n.height=r+60,this.height=n.height,this._progress=ComponentManager.getProgressBar("progress5","progress3_bg",386),this._progress.x=20,this._progress.y=r,this.addChild(this._progress),this.refreshBtnStatus()},e.prototype.refreshBtnStatus=function(){var t=Api.acVoApi.getActivityVoByAidAndCode("carnivalCharge");if(this._progress.setText(LanguageManager.getlocal("acCarnivalProgressText",[String(t.v),this._rechargeItem.needGem])),this._progress.setPercentage(t.v/this._rechargeItem.needGem),this._collectFlag&&this.removeChild(this._collectFlag),this._collectFlag=null,this._collectBtn&&this.removeChild(this._collectBtn),this._collectBtn=null,this._chargeBtn&&this.removeChild(this._chargeBtn),this._chargeBtn=null,t.v>=this._rechargeItem.needGem?this._detailBgImg.texture=ResourceManager.getRes("accarnivalview_tab_green"):this._detailBgImg.texture=ResourceManager.getRes("accarnivalview_tab_red"),t.flags[this._itemData]&&e._lastReqIdx!=this._curIdx)this.createCollectFlag();else if(t.v>=this._rechargeItem.needGem){var i=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"ac_recharge_Btntxt2",this.eventCollectHandler,this);i.x=this._progress.x+this._progress.width+20,i.y=this._progress.y+this._progress.height/2-i.height/2,i.name="collectBtn",this.addChild(i),this._collectBtn=i}else{var a=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"acCarnivalToChargeBtnText",this.goRechargeHandler,this);a.x=this._progress.x+this._progress.width+20,a.y=this._progress.y+this._progress.height/2-a.height/2,a.name="chargeBtn",this.addChild(a),this._chargeBtn=a}},e.prototype.refreshUI=function(){this.getChildByName("collectBtn")&&(this.getChildByName("collectBtn").visible=!1),this.createCollectFlag(),this._collectFlag.visible=!1,this._collectFlag.setScale(1.3),this._collectFlag.visible=!0,egret.Tween.get(this._collectFlag,{loop:!1}).to({scaleX:.7,scaleY:.7},300)},e.prototype.createCollectFlag=function(){this._collectFlag=BaseBitmap.create("collectflag"),this._collectFlag.anchorOffsetX=this._collectFlag.width/2,this._collectFlag.anchorOffsetY=this._collectFlag.height/2,this._collectFlag.setScale(.7),this._collectFlag.x=this._progress.x+this._progress.width+100,this._collectFlag.y=this._progress.y+this._progress.height/2-10,this.addChild(this._collectFlag)},e.prototype.eventCollectHandlerCallBack=function(t){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETCARNIVALCHARGE),this.eventCollectHandlerCallBack,this);var i=t.data.data.data,a=t.data.data.ret;if(0!=a)return void App.CommonUtil.showTip(LanguageManager.getlocal("collect_error"));if(e._lastReqIdx==this._curIdx){e._lastReqIdx=null,this.refreshUI();var n=i.rewards,o=GameData.formatRewardItem(n),s=e._lastPos;App.CommonUtil.playRewardFlyAction(o,s)}},e.prototype.eventCollectHandler=function(t){e._lastReqIdx=this._curIdx,e._lastPos=this._progress.localToGlobal(this._progress.width+50,20);var i=Api.acVoApi.getActivityVoByAidAndCode("carnivalCharge");App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETCARNIVALCHARGE),this.eventCollectHandlerCallBack,this),NetManager.request(NetRequestConst.REQUEST_ACTIVITY_GETCARNIVALCHARGE,{activeId:"carnivalCharge-"+i.code,rkey:this._itemData})},e.prototype.goRechargeHandler=function(t){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.getSpaceX=function(){return 10},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_ACCARNIVAL_CHANGE_CHARGE,this.refreshBtnStatus,this),this._itemData=null,this._collectFlag=null,this._progress=null,this._collectBtn=null,this._chargeBtn=null,this._curIdx=0,this._rechargeItem=null,t.prototype.dispose.call(this)
},e._lastReqIdx=null,e._lastPos=null,e}(ScrollListItem);__reflect(AcCarnivalChargeScrollItem.prototype,"AcCarnivalChargeScrollItem");var AcCarnivalCostScrollItem=function(t){function e(){var e=t.call(this)||this;return e._itemData=void 0,e._curIdx=0,e._rechargeItem=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(MessageConst.MESSAGE_ACCARNIVAL_CHANGE_COST,this.refreshBtnStatus,this),this._itemData=e,this._curIdx=t;var i=Api.acVoApi.getActivityVoByAidAndCode("carnivalCost"),a=Config.AcCfg.getCfgByActivityIdAndCode("carnivalCost",i.code);this._rechargeItem=a.getRechargeItemById(this._itemData);var n=BaseBitmap.create("public_9_bg14");n.width=598,n.height=246,this.addChild(n),this._detailBgImg=BaseBitmap.create("accarnivalview_tab_red"),this._detailBgImg.y=5,this._detailBgImg.x=2,this.addChild(this._detailBgImg);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);o.text=LanguageManager.getlocal("acCarnivalCostItemTitle",[String(this._rechargeItem.needGem)]),o.x=this._detailBgImg.x+20,o.y=this._detailBgImg.y+10,this.addChild(o);for(var s=GameData.formatRewardItem(this._rechargeItem.reward),r=60,l=14,t=0;t<s.length;t++){var h=GameData.getItemIcon(s[t],!0,!0);h.x=l,h.y=r,l+=h.width+7,l>n.width-8&&(l=14,r+=h.height+10,h.x=l,h.y=r,l+=h.width+7),this.addChild(h)}r+=130,n.height=r+60,this.height=n.height,this._progress=ComponentManager.getProgressBar("progress5","progress3_bg",386),this._progress.x=20,this._progress.y=r,this.addChild(this._progress),this.refreshBtnStatus()},e.prototype.refreshBtnStatus=function(){var t=Api.acVoApi.getActivityVoByAidAndCode("carnivalCost");if(this._progress.setText(LanguageManager.getlocal("acCarnivalProgressText",[String(t.v),this._rechargeItem.needGem])),this._progress.setPercentage(t.v/this._rechargeItem.needGem),this._collectFlag&&this.removeChild(this._collectFlag),this._collectFlag=null,this._collectBtn&&this.removeChild(this._collectBtn),this._collectBtn=null,this._chargeBtn&&this.removeChild(this._chargeBtn),this._chargeBtn=null,t.v>=this._rechargeItem.needGem?this._detailBgImg.texture=ResourceManager.getRes("accarnivalview_tab_green"):this._detailBgImg.texture=ResourceManager.getRes("accarnivalview_tab_red"),t.flags[this._itemData]&&e._lastReqIdx!=this._curIdx)this.createCollectFlag();else if(t.v>=this._rechargeItem.needGem){var i=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"ac_recharge_Btntxt2",this.eventCollectHandler,this);i.x=this._progress.x+this._progress.width+20,i.y=this._progress.y+this._progress.height/2-i.height/2,i.name="collectBtn",this.addChild(i),this._collectBtn=i}else{var a=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"acCarnivalToCostBtnText",this.goRechargeHandler,this);a.x=this._progress.x+this._progress.width+20,a.y=this._progress.y+this._progress.height/2-a.height/2,a.name="costBtn",this.addChild(a),this._chargeBtn=a}},e.prototype.refreshUI=function(){this.getChildByName("collectBtn")&&(this.getChildByName("collectBtn").visible=!1),this.createCollectFlag(),this._collectFlag.visible=!1,this._collectFlag.setScale(1.3),this._collectFlag.visible=!0,egret.Tween.get(this._collectFlag,{loop:!1}).to({scaleX:.7,scaleY:.7},300)},e.prototype.createCollectFlag=function(){this._collectFlag=BaseBitmap.create("collectflag"),this._collectFlag.anchorOffsetX=this._collectFlag.width/2,this._collectFlag.anchorOffsetY=this._collectFlag.height/2,this._collectFlag.setScale(.7),this._collectFlag.x=this._progress.x+this._progress.width+100,this._collectFlag.y=this._progress.y+this._progress.height/2-10,this.addChild(this._collectFlag)},e.prototype.eventCollectHandlerCallBack=function(t){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETCARNIVALCOST),this.eventCollectHandlerCallBack,this);var i=t.data.data.data,a=t.data.data.ret;if(0!=a)return void App.CommonUtil.showTip(LanguageManager.getlocal("collect_error"));if(e._lastReqIdx==this._curIdx){e._lastReqIdx=null,this.refreshUI();var n=i.rewards,o=GameData.formatRewardItem(n),s=e._lastPos;App.CommonUtil.playRewardFlyAction(o,s)}},e.prototype.eventCollectHandler=function(t){e._lastReqIdx=this._curIdx,e._lastPos=this._progress.localToGlobal(this._progress.width+50,20);var i=Api.acVoApi.getActivityVoByAidAndCode("carnivalCost");App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETCARNIVALCOST),this.eventCollectHandlerCallBack,this),NetManager.request(NetRequestConst.REQUEST_ACTIVITY_GETCARNIVALCOST,{activeId:"carnivalCost-"+i.code,rkey:this._itemData})},e.prototype.goRechargeHandler=function(t){ViewController.getInstance().openView(ViewConst.COMMON.SHOPVIEW_TAB1)},e.prototype.getSpaceX=function(){return 10},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_ACCARNIVAL_CHANGE_COST,this.refreshBtnStatus,this),this._itemData=null,this._collectFlag=null,this._progress=null,this._collectBtn=null,this._chargeBtn=null,this._curIdx=0,this._rechargeItem=null,t.prototype.dispose.call(this)},e._lastReqIdx=null,e._lastPos=null,e}(ScrollListItem);__reflect(AcCarnivalCostScrollItem.prototype,"AcCarnivalCostScrollItem");var AcCarnivalItem=function(t){function e(){var e=t.call(this)||this;return e._seprateNum=0,e._isSpecial=!1,e}return __extends(e,t),e.prototype.init=function(t,e,i){"carnivalCharge"==t?App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETCARNIVALCHARGE),this.refreshAfterRecharge,this):App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETCARNIVALCOST),this.refreshAfterRecharge,this),this._aid=t,this._code=String(e),this.refreshList(i)},Object.defineProperty(e.prototype,"typeCode",{get:function(){return this._typeCode},set:function(t){this._typeCode=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topImgName",{get:function(){return this._topImgName},set:function(t){this._topImgName=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topBgImgName",{get:function(){return this._topBgImgName},set:function(t){this._topBgImgName=t},enumerable:!0,configurable:!0}),e.prototype.refreshAfterRecharge=function(){if(this._isSpecial){var t=Api.acVoApi.getActivityVoByAidAndCode(this._aid);t.v>=this._seprateNum&&this.refreshList()}},e.prototype.refreshList=function(t){var e=Api.acVoApi.getActivityVoByAidAndCode(this._aid),i=Config.AcCfg.getCfgByActivityIdAndCode(this._aid,this._code),a=i.getList(),n={};for(var o in a){var s=a[o];s.isSpecial&&1==s.isSpecial?(Api.switchVoApi.checkSpecialChargeReward()?this._isSpecial=!0:this._isSpecial=!1,Api.switchVoApi.checkSpecialChargeReward()&&e.v>=this._seprateNum&&(n[o]=s)):(this._seprateNum=s.needGem,n[o]=s)}var r=Object.keys(n);r.sort(function(t,e){return Number(t)-Number(e)});var l=void 0;if("carnivalCharge"==this._aid?l=AcCarnivalChargeScrollItem:"carnivalCost"==this._aid&&(l=AcCarnivalCostScrollItem),t){var h=ComponentManager.getScrollList(l,r,t);this.addChild(h),this._scrollList=h}else this._scrollList.refreshData(r)},e.prototype.dispose=function(){"carnivalCharge"==this._aid?App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETCARNIVALCHARGE),this.refreshAfterRecharge,this):App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETCARNIVALCOST),this.refreshAfterRecharge,this),this._aid=null,this._code=null,this._scrollList=null,this._seprateNum=0,this._isSpecial=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(AcCarnivalItem.prototype,"AcCarnivalItem");var AcCarnivalView=function(t){function e(){var e=t.call(this)||this;return e._carnivalItemList=[],e._redImgList=[],e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_ACCARNIVAL_CHANGE_CHARGE,this.checkRedpoints,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_ACCARNIVAL_CHANGE_COST,this.checkRedpoints,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETCARNIVALCHARGE),this.checkRedpoints,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETCARNIVALCOST),this.checkRedpoints,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer),this._topBg=BaseBitmap.create("accarnivalview_charge_topbg"),this._topBg.width=GameConfig.stageWidth+18,this._topBg.y=-13,this._nodeContainer.addChild(this._topBg),this._top=BaseBitmap.create("accarnivalview_charge_top"),this._top.anchorOffsetY=this._top.height/2,this._top.y=30,this._top.x=20,this._nodeContainer.addChild(this._top),this._activityDurTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON),this._activityDurTxt.x=30,this._activityDurTxt.y=80.5,this._nodeContainer.addChild(this._activityDurTxt),this._cdTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._cdTxt.x=this._activityDurTxt.x,this._cdTxt.y=110.5,this._nodeContainer.addChild(this._cdTxt),this._chargeHintTxt1=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON),this._chargeHintTxt1.text=LanguageManager.getlocal("payrule1"),this._chargeHintTxt1.x=this._activityDurTxt.x,this._chargeHintTxt1.y=155.5,this._nodeContainer.addChild(this._chargeHintTxt1),this._chargeHintTxt2=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON),this._chargeHintTxt2.text=LanguageManager.getlocal("payrule2"),this._chargeHintTxt2.x=this._activityDurTxt.x,this._chargeHintTxt2.y=180.5,this._nodeContainer.addChild(this._chargeHintTxt2);var t=BaseBitmap.create("servant_bottombg");t.width=GameConfig.stageWidth+16,t.height=GameConfig.stageHeigth-this._topBg.height-this._topBg.y-this.container.y+5,t.x=-8,t.y=this._topBg.height+this._topBg.y,this._nodeContainer.addChild(t);var e=BaseBitmap.create("public_9_bg32");e.height=t.height-110,e.width=t.width-40,e.x=t.x+20,e.y=t.y+85,this._nodeContainer.addChild(e);var i=[],a=new egret.Rectangle(0,0,e.width,e.height-10),n=t.y+24,o=15,s=Api.acVoApi.getActivityVoByAidAndCode("carnivalCharge");if(s){var r=BaseBitmap.create("public_dot2");r.name="carnivalCharge_"+s.code,r.y=n,r.x=o+125,this._redImgList.push(r),this._nodeContainer.addChild(r),i.push("acCarnivalViewTabCharge");var l=new AcCarnivalItem;l.name=r.name,l.typeCode="carnivalCharge",l.topImgName="accarnivalview_charge_top",l.topBgImgName="accarnivalview_charge_topbg",l.x=21,l.y=e.y+5,l.init("carnivalCharge",s.code,a),this._nodeContainer.addChild(l),this._carnivalItemList.push(l)}var h=Api.acVoApi.getActivityVoByAidAndCode("carnivalCost");if(h){var r=BaseBitmap.create("public_dot2");r.name="carnivalCost_"+h.code,this._redImgList.push(r),r.y=n,r.x=o+280,this._nodeContainer.addChild(r),i.push("acCarnivalViewTabCost");var l=new AcCarnivalItem;l.name=r.name,l.typeCode="carnivalCost",l.topImgName="accarnivalview_cost_top",l.topBgImgName="accarnivalview_cost_topbg",l.init("carnivalCost",h.code,a),l.x=21,l.y=e.y+5,l.visible=!1,this._nodeContainer.addChild(l),this._carnivalItemList.push(l)}var d=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,i,this.tabBtnClickHandler,this);d.x=o,d.y=n,this._nodeContainer.addChild(d);for(var g in this._redImgList){var c=this._redImgList[g];c.visible=!1,"0"==g&&(c.x=o+122),"1"==g&&(c.x=o+280),this._nodeContainer.addChild(c)}this.tabBtnClickHandler({index:0}),this.checkRedpoints()},e.prototype.tabBtnClickHandler=function(t){for(var e=t.index,i=0;i<this._carnivalItemList.length;i++)this._carnivalItemList[i].visible=!1;this._carnivalItemList[e].visible=!0;var a=this._carnivalItemList[e].name,n=this._carnivalItemList[e].topImgName,o=this._carnivalItemList[e].topBgImgName;App.StringUtil.splitString(a,"_");this._topBg.texture=ResourceManager.getRes(o),this._top.texture=ResourceManager.getRes(n),this._top.anchorOffsetY=this._top.height/2,this._top.y=30,"carnivalCharge"==this._carnivalItemList[e].typeCode?(this._chargeHintTxt1.visible=!0,this._chargeHintTxt2.y=180.5):(this._chargeHintTxt1.visible=!1,this._chargeHintTxt2.y=155.5);var s=void 0;s=Api.acVoApi.getActivityVoByAidAndCode(this._carnivalItemList[e].typeCode),this._tmpVo=s;App.DateUtil.getOpenLocalTime(s.st,s.et,!0);this._activityDurTxt.text=this._tmpVo.getAcLocalTime(!0),this.tick()},e.prototype.tick=function(){var t=this._tmpVo.et-GameData.serverTime;return this._cdTxt&&t>0?(this._cdTxt.text=LanguageManager.getlocal("acrecharge_acCD",[App.DateUtil.getFormatBySecond(t,1)]),!0):(this._cdTxt.text=LanguageManager.getlocal("acrecharge_acCD",[LanguageManager.getlocal("acRank_acCDEnd")]),!1)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["accarnivalview_charge_topbg","accarnivalview_charge_top","accarnivalview_cost_topbg","accarnivalview_cost_top","accarnivalview_tab_green","accarnivalview_tab_red","activity_charge_word4","activity_charge_word5","servant_bottombg","progress3_bg","progress5","recharge_fnt","itemeffect"])},e.prototype.checkRedpoints=function(){for(var t=0;t<this._redImgList.length;t++){var e=this._redImgList[t],i=e.name,a=i.split("_"),n=Api.acVoApi.getActivityVoByAidAndCode(a[0],a[1]);n.isShowRedDot?e.visible=!0:e.visible=!1}},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_ACCARNIVAL_CHANGE_CHARGE,this.checkRedpoints,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_ACCARNIVAL_CHANGE_COST,this.checkRedpoints,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETCARNIVALCHARGE),this.checkRedpoints,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETCARNIVALCOST),this.checkRedpoints,this),this._nodeContainer=null,this._carnivalItemList=[],this._topBg=null,this._top=null,this._cdTxt=null,this._activityDurTxt=null,this._tmpVo=null,this._redImgList=[],t.prototype.dispose.call(this)},e}(CommonView);__reflect(AcCarnivalView.prototype,"AcCarnivalView");var AcDailyChargeScrollItem=function(t){function e(){var e=t.call(this)||this;return e._uiData=void 0,e._rechargeItem=null,e._curIdx=0,e._lastReqIdx=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(MessageConst.MESSAGE_DAILYCHARGE_REFRESH_V,this.refreshBtnStatus,this),this._uiData=e,this._curIdx=t;var i=Api.acVoApi.getActivityVoByAidAndCode("dailyCharge"),a=Config.AcCfg.getCfgByActivityIdAndCode("dailyCharge",i.code);this._rechargeItem=a.getRechargeItemById(this._uiData);var n=BaseBitmap.create("public_9_bg14");n.width=598,n.height=246,this.addChild(n);var o=BaseBitmap.create("activity_charge_red");o.y=5,this.addChild(o);var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);s.text=LanguageManager.getlocal("acDaily_recharge_txt1",[String(this._rechargeItem.needGem)]),s.x=o.x+20,s.y=o.y+10,this.addChild(s);for(var r=GameData.formatRewardItem(this._rechargeItem.reward),l=60,h=14,t=0;t<r.length;t++){var d=GameData.getItemIcon(r[t],!0,!0);d.x=h,d.y=l,h+=d.width+7,h>n.width-8&&(h=14,l+=d.height+10,d.x=h,d.y=l,h+=d.width+7),this.addChild(d)}l+=130,n.height=l+60,this.height=n.height+5;var g=ComponentManager.getProgressBar("progress5","progress3_bg",386);g.x=20,g.y=l,this.addChild(g),this._progress=g,this.refreshBtnStatus()},e.prototype.refreshBtnStatus=function(){var t=Api.acVoApi.getActivityVoByAidAndCode("dailyCharge");if(null!=t&&null!=t.v)if(this._progress.setText(LanguageManager.getlocal("acrecharge_yuan",[String(t.v),this._rechargeItem.needGem])),this._progress.setPercentage(t.v/this._rechargeItem.needGem),this._collectFlag&&this.removeChild(this._collectFlag),this._collectFlag=null,this._collectBtn&&this.removeChild(this._collectBtn),this._collectBtn=null,this._chargeBtn&&this.removeChild(this._chargeBtn),this._chargeBtn=null,t.flags[this._uiData])this.createCollectFlag();else if(t.v>=this._rechargeItem.needGem){var e=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"ac_recharge_Btntxt2",this.eventCollectHandler,this);e.x=this._progress.x+this._progress.width+20,e.y=this._progress.y+this._progress.height/2-e.height/2,e.name="collectBtn",this.addChild(e),this._collectBtn=e}else{var i=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"ac_recharge_Btntxt1",this.goRechargeHandler,this);i.x=this._progress.x+this._progress.width+20,i.y=this._progress.y+this._progress.height/2-i.height/2,i.name="chargeBtn",this.addChild(i),this._chargeBtn=i}},e.prototype.refreshUI=function(){this.getChildByName("collectBtn")&&(this.getChildByName("collectBtn").visible=!1),this._collectFlag&&this.removeChild(this._collectFlag),this._collectFlag=null,this.createCollectFlag(),this._collectFlag.visible=!1,this._collectFlag.setScale(1.3),this._collectFlag.visible=!0,egret.Tween.get(this._collectFlag,{loop:!1}).to({scaleX:.7,scaleY:.7},300)},e.prototype.createCollectFlag=function(){this._collectFlag=BaseBitmap.create("collectflag"),this._collectFlag.anchorOffsetX=this._collectFlag.width/2,this._collectFlag.anchorOffsetY=this._collectFlag.height/2,this._collectFlag.setScale(.7),this._collectFlag.x=this._progress.x+this._progress.width+100,this._collectFlag.y=this._progress.y+this._progress.height/2-10,this.addChild(this._collectFlag)},e.prototype.eventCollectHandlerCallBack=function(t){this.removeUIListener();var e=t.data.data.data,i=t.data.data.ret,a=e.rkey;if(0==i&&a==this._uiData){this._lastReqIdx=null,this.refreshUI();var n=e.rewards,o=GameData.formatRewardItem(n),s=this._progress.localToGlobal(this._progress.width+50,20);App.CommonUtil.playRewardFlyAction(o,s)}},e.prototype.eventCollectHandler=function(t){this.addUIListener(),this._lastReqIdx=this._curIdx;var e=Api.acVoApi.getActivityVoByAidAndCode("dailyCharge");NetManager.request(NetRequestConst.REQUEST_RECHARGE_GETDAILYREWARD,{activeId:"dailyCharge-"+e.code,rkey:this._uiData})},e.prototype.goRechargeHandler=function(t){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.getSpaceX=function(){return 10},e.prototype.getSpaceY=function(){return 5},e.prototype.addUIListener=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RECHARGE_GETDAILYREWARD),this.eventCollectHandlerCallBack,this)},e.prototype.removeUIListener=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RECHARGE_GETDAILYREWARD),this.eventCollectHandlerCallBack,this)},e.prototype.dispose=function(){this.removeUIListener(),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_DAILYCHARGE_REFRESH_V,this.refreshBtnStatus,this),this._uiData=null,this._collectFlag=null,this._progress=null,this._collectBtn=null,this._chargeBtn=null,this._curIdx=0,this._rechargeItem=null,this._lastReqIdx=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AcDailyChargeScrollItem.prototype,"AcDailyChargeScrollItem");var AcRechargeItem=function(t){function e(){var e=t.call(this)||this;return e._seprateNum=0,e._isSpecial=!1,e}return __extends(e,t),e.prototype.init=function(t,e,i){App.MessageHelper.addEventListener(MessageConst.MESSAGE_DAILYCHARGE_REFRESH_V,this.refreshAfterRecharge,this),this._aid=t,this._code=String(e),this.refreshList(i)},e.prototype.refreshAfterRecharge=function(){if(this._isSpecial){var t=Api.acVoApi.getActivityVoByAidAndCode(this._aid);t.v>=this._seprateNum&&Api.switchVoApi.checkSpecialChargeReward()&&egret.callLater(this.refreshList,this)}},e.prototype.refreshList=function(t){var e=Api.acVoApi.getActivityVoByAidAndCode(this._aid),i=Config.AcCfg.getCfgByActivityIdAndCode(this._aid,this._code),a=i.getList(),n={};for(var o in a){var s=a[o];s.isSpecial&&1==s.isSpecial?Api.switchVoApi.checkSpecialChargeReward()&&e.v>=this._seprateNum&&(this._isSpecial=!0,n[o]=s):(this._seprateNum=s.needGem,n[o]=s)}var r=Object.keys(n);r.sort(function(t,e){return Number(t)-Number(e)});var l=void 0;if("dailyCharge"==this._aid)l=AcDailyChargeScrollItem;else if("totalRecharge"==this._aid)l=AcTotalRechargeScrollItem;else if("totalDayRecharge"==this._aid){l=AcTotalDayRechargeScrollItem;var h=e.getShowNum(1);r.length>0&&r.splice(h,r.length-h)}if(t){var d=ComponentManager.getScrollList(l,r,t);this.addChild(d),this._scrollList=d}else this._scrollList.refreshData(r)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_DAILYCHARGE_REFRESH_V,this.refreshAfterRecharge,this),this._aid=null,this._code=null,this._scrollList=null,this._seprateNum=0,this._isSpecial=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(AcRechargeItem.prototype,"AcRechargeItem");var AcRechargeView=function(t){function e(){var e=t.call(this)||this;return e._rechargeItemList=[],e._redImgList=[],e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RECHARGE_GETTOTALDAILYREWARD),this.checkRedpoints,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_DAILYCHARGE_REFRESH_V,this.checkRedpoints,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RECHARGE_GETDAILYREWARD),this.checkRedpoints,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RECHARGE_GETTOTALREWARD),this.checkRedpoints,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var t=BaseBitmap.create("activity_charge_topbg");t.width=GameConfig.stageWidth+18,t.y=-13,this._nodeContainer.addChild(t),this._wordTipImg=BaseBitmap.create("activity_charge_word1"),this._wordTipImg.anchorOffsetY=this._wordTipImg.height/2,this._wordTipImg.y=40,this._wordTipImg.x=20,this._nodeContainer.addChild(this._wordTipImg);var e=BaseBitmap.create("public_9_bg38");if(e.width=400,e.x=0,e.y=70,this._nodeContainer.addChild(e),this._activityDurTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON),this._activityDurTxt.x=30,this._activityDurTxt.y=e.y+e.height/2-10,this._nodeContainer.addChild(this._activityDurTxt),this._cdTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._cdTxt.x=this._activityDurTxt.x,this._cdTxt.y=this._activityDurTxt.y+40,this._nodeContainer.addChild(this._cdTxt),this._rechargeTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._rechargeTxt.x=this._activityDurTxt.x,this._rechargeTxt.y=this._cdTxt.y+30,this._rechargeTxt.visible=!1,this._nodeContainer.addChild(this._rechargeTxt),1==PlatformManager.checkIsTWBSp()){var i=ComponentManager.getTextField(LanguageManager.getlocal("rechargeNotContainPresent"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_RED);i.x=this._activityDurTxt.x,i.y=this._cdTxt.y+60,this._nodeContainer.addChild(i)}var a=BaseBitmap.create("servant_bottombg");a.width=GameConfig.stageWidth+16,a.height=GameConfig.stageHeigth-t.height-t.y-this.container.y+5,a.x=-8,a.y=t.height+t.y,this._nodeContainer.addChild(a);var n=BaseBitmap.create("public_9_bg32");n.height=a.height-110,n.width=a.width-40,n.x=a.x+20,n.y=a.y+85,this._nodeContainer.addChild(n);var o=[],s=new egret.Rectangle(0,0,n.width,n.height-10),r=a.y+24,l=15,h=Api.acVoApi.getActivityVoByAidAndCode("dailyCharge");if(h){var d=BaseBitmap.create("public_dot2");d.name="dailyCharge_"+h.code,d.y=r,d.x=l+125,this._redImgList.push(d),this._nodeContainer.addChild(d),o.push("acCharge_tab1");var g=new AcRechargeItem;g.name=d.name,g.x=21,g.y=n.y+5,g.init("dailyCharge",h.code,s),this._nodeContainer.addChild(g),this._rechargeItemList.push(g)}var c=Api.acVoApi.getActivityVoByAidAndCode("totalRecharge");if(c){var d=BaseBitmap.create("public_dot2");d.name="totalRecharge_"+c.code,this._redImgList.push(d),d.y=r,d.x=l+280,this._nodeContainer.addChild(d),o.push("acCharge_tab2");var g=new AcRechargeItem;g.name=d.name,g.init("totalRecharge",c.code,s),g.x=21,g.y=n.y+5,g.visible=!1,this._nodeContainer.addChild(g),this._rechargeItemList.push(g)}var p=Api.acVoApi.getActivityVoByAidAndCode("totalDayRecharge");if(p){var d=BaseBitmap.create("public_dot2");d.name="totalDayRecharge_"+p.code,this._redImgList.push(d),d.y=r,d.x=l+455,this._nodeContainer.addChild(d),o.push("acCharge_tab3");var g=new AcRechargeItem;g.name=d.name,g.init("totalDayRecharge",p.code,s),g.x=21,g.y=n.y+5,g.visible=!1,this._nodeContainer.addChild(g),this._rechargeItemList.push(g)}var _=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,o,this.tabBtnClickHandler,this);_.x=l,_.y=r,this._nodeContainer.addChild(_);for(var u in this._redImgList){var C=this._redImgList[u];C.visible=!1,"0"==u&&(C.x=l+122),"1"==u&&(C.x=l+280),"2"==u&&(C.x=l+437),this._nodeContainer.addChild(C)}this.tabBtnClickHandler({index:0}),this.checkRedpoints()},e.prototype.tabBtnClickHandler=function(t){for(var e=t.index,i=0;i<this._rechargeItemList.length;i++)this._rechargeItemList[i].visible=!1;this._rechargeItemList[e].visible=!0;var a=this._rechargeItemList[e].name,n=App.StringUtil.splitString(a,"_");this._wordTipImg.texture=ResourceManager.getRes("activity_charge_"+n[0]),this._wordTipImg.anchorOffsetY=this._wordTipImg.height/2,this._wordTipImg.y=40;var o=void 0;this._rechargeTxt.visible=!1,o=Api.acVoApi.getActivityVoByAidAndCode(n[0]),"dailyCharge"==n[0]&&(this._rechargeTxt.visible=!0),this._tmpVo=o,this._rechargeTxt.text=LanguageManager.getlocal("acrecharge_todayRecharge",[String(this._tmpVo.v)]);App.DateUtil.getOpenLocalTime(o.st,o.et,!0);this._activityDurTxt.text=this._tmpVo.getAcLocalTime(!0),this.tick()},e.prototype.tick=function(){var t=this._tmpVo.et-GameData.serverTime;return this._cdTxt&&t>0?(this._cdTxt.text=LanguageManager.getlocal("acrecharge_acCD",[App.DateUtil.getFormatBySecond(t,1)]),!0):(this._cdTxt.text=LanguageManager.getlocal("acrecharge_acCD",[LanguageManager.getlocal("acRank_acCDEnd")]),!1)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["activity_charge_topbg","activity_charge_red","activity_charge_dailyCharge","activity_charge_totalDayRecharge","activity_charge_totalRecharge","activity_charge_word4","activity_charge_word5","servant_bottombg","progress3_bg","progress5","recharge_fnt","itemeffect"])},e.prototype.checkRedpoints=function(){for(var t=0;t<this._redImgList.length;t++){var e=this._redImgList[t],i=e.name,a=i.split("_"),n=Api.acVoApi.getActivityVoByAidAndCode(a[0],a[1]);n.isShowRedDot?e.visible=!0:e.visible=!1}},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RECHARGE_GETTOTALDAILYREWARD),this.checkRedpoints,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RECHARGE_GETDAILYREWARD),this.checkRedpoints,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RECHARGE_GETTOTALREWARD),this.checkRedpoints,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_DAILYCHARGE_REFRESH_V,this.checkRedpoints,this),this._nodeContainer=null,this._rechargeItemList=[],this._wordTipImg=null,this._cdTxt=null,this._activityDurTxt=null,this._rechargeTxt=null,this._tmpVo=null,this._redImgList=[],t.prototype.dispose.call(this)},e}(CommonView);__reflect(AcRechargeView.prototype,"AcRechargeView");var AcTotalDayRechargeScrollItem=function(t){function e(){var e=t.call(this)||this;return e._uiData=void 0,e._rechargeItem=null,e._curIdx=0,e._lastReqIdx=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(MessageConst.MESSAGE_DAILYCHARGE_REFRESH_V,this.refreshBtnStatus,this),this._uiData=e,this._curIdx=t;var i=Api.acVoApi.getActivityVoByAidAndCode("totalDayRecharge"),a=Config.AcCfg.getCfgByActivityIdAndCode("totalDayRecharge",i.code),n=a.getRechargeItemById(e);this._rechargeItem=n;var o=BaseBitmap.create("public_9_bg14");o.width=598,o.height=246,this.addChild(o);var s=BaseBitmap.create("activity_charge_red");s.width=550,s.y=5,this.addChild(s);var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);String(n.needDay);r.x=s.x+20,r.name="Txt1",r.y=s.y+10,this.addChild(r);var l=BaseBitmap.create("activity_charge_word5");l.x=210,l.y=s.y+s.height/2-l.height/2-2,this.addChild(l);var h=ComponentManager.getBitmapText(n.showGem+"","recharge_fnt");h.x=l.x+l.width,h.y=l.y+l.height/2-h.height/2,this.addChild(h);var d=BaseBitmap.create("activity_charge_word4");d.x=h.x+h.width,d.y=l.y,this.addChild(d);for(var g=GameData.formatRewardItem(n.reward),c=60,p=14,t=0;t<g.length;t++){var _=GameData.getItemIcon(g[t],!0,!0);_.x=p,_.y=c,p+=_.width+7,p>o.width-8&&(p=14,c+=_.height+10,_.x=p,_.y=c,p+=_.width+7),this.addChild(_)}c+=130,o.height=c+60,this.height=o.height+5;var u=ComponentManager.getProgressBar("progress5","progress3_bg",386);u.x=20,u.y=c,this.addChild(u),this._progress=u,this.refreshBtnStatus()},e.prototype.refreshBtnStatus=function(){var t=Api.acVoApi.getActivityVoByAidAndCode("totalDayRecharge");if(null!=t&&null!=t.v){var e=String(this._rechargeItem.needDay);this._progress.setPercentage(t.v/this._rechargeItem.needDay),this._progress.setText(LanguageManager.getlocal("acrecharge_day",[String(t.v),String(this._rechargeItem.needDay)]));var i=this.getChildByName("Txt1");if(i.text=LanguageManager.getlocal("acrecharge_tday",[e,String(t.v),e]),this._collectFlag&&this.removeChild(this._collectFlag),this._collectFlag=null,this._collectBtn&&this.removeChild(this._collectBtn),this._collectBtn=null,this._chargeBtn&&this.removeChild(this._chargeBtn),this._chargeBtn=null,t.flags[this._uiData])this.createCollectFlag();else if(t.v>=this._rechargeItem.needDay){var a=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"ac_recharge_Btntxt2",this.eventCollectHandler,this);a.x=this._progress.x+this._progress.width+20,a.y=this._progress.y+this._progress.height/2-a.height/2,a.name="collectBtn",this.addChild(a),this._collectBtn=a}else{var n=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"ac_recharge_Btntxt1",this.goRechargeHandler,this);n.x=this._progress.x+this._progress.width+20,n.y=this._progress.y+this._progress.height/2-n.height/2,n.name="chargeBtn",this.addChild(n),this._chargeBtn=n}}},e.prototype.refreshUI=function(){this.getChildByName("collectBtn")&&(this.getChildByName("collectBtn").visible=!1),this._collectFlag&&this.removeChild(this._collectFlag),this._collectFlag=null,this.createCollectFlag(),this._collectFlag.visible=!1,this._collectFlag.setScale(1.3),this._collectFlag.visible=!0,egret.Tween.get(this._collectFlag,{loop:!1}).to({scaleX:.7,scaleY:.7},300)},e.prototype.createCollectFlag=function(){this._collectFlag=BaseBitmap.create("collectflag"),this._collectFlag.anchorOffsetX=this._collectFlag.width/2,this._collectFlag.anchorOffsetY=this._collectFlag.height/2,this._collectFlag.setScale(.7),this._collectFlag.x=this._progress.x+this._progress.width+100,this._collectFlag.y=this._progress.y+this._progress.height/2-10,this.addChild(this._collectFlag)},e.prototype.eventCollectHandlerCallBack=function(t){this.removeUIListener();var e=t.data.data.data,i=t.data.data.ret;if(0==i&&this._lastReqIdx==this._curIdx){this._lastReqIdx=null,this.refreshUI();var a=e.rewards,n=GameData.formatRewardItem(a),o=this._progress.localToGlobal(this._progress.width+50,20);App.CommonUtil.playRewardFlyAction(n,o)}},e.prototype.eventCollectHandler=function(t){this.addUIListener(),this._lastReqIdx=this._curIdx;var e=Api.acVoApi.getActivityVoByAidAndCode("totalDayRecharge");NetManager.request(NetRequestConst.REQUEST_RECHARGE_GETTOTALDAILYREWARD,{activeId:"totalDayRecharge-"+e.code,rkey:this._uiData})},e.prototype.goRechargeHandler=function(t){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.getSpaceX=function(){return 10},e.prototype.getSpaceY=function(){return 5
},e.prototype.addUIListener=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RECHARGE_GETTOTALDAILYREWARD),this.eventCollectHandlerCallBack,this)},e.prototype.removeUIListener=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RECHARGE_GETTOTALDAILYREWARD),this.eventCollectHandlerCallBack,this)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_DAILYCHARGE_REFRESH_V,this.refreshBtnStatus,this),this.removeUIListener(),this._uiData=null,this._collectFlag=null,this._progress=null,this._collectBtn=null,this._chargeBtn=null,this._curIdx=0,this._rechargeItem=null,this._lastReqIdx=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AcTotalDayRechargeScrollItem.prototype,"AcTotalDayRechargeScrollItem");var AcTotalRechargeScrollItem=function(t){function e(){var e=t.call(this)||this;return e._uiData=void 0,e._rechargeItem=null,e._curIdx=0,e._lastReqIdx=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(MessageConst.MESSAGE_DAILYCHARGE_REFRESH_V,this.refreshBtnStatus,this),this._uiData=e,this._curIdx=t;var i=Api.acVoApi.getActivityVoByAidAndCode("totalRecharge"),a=Config.AcCfg.getCfgByActivityIdAndCode("totalRecharge",i.code),n=a.getRechargeItemById(e);this._rechargeItem=n;var o=BaseBitmap.create("public_9_bg14");o.width=598,o.height=158,this.addChild(o);var s=BaseBitmap.create("activity_charge_red");s.y=5,this.addChild(s);var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);r.text=LanguageManager.getlocal("acTotal_recharge_txt1",[String(n.needGem)]),r.x=s.x+20,r.y=s.y+10,this.addChild(r);var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_BROWN);l.text=LanguageManager.getlocal("acrecharge_return"),l.x=s.x+20,l.y=65,this.addChild(l);var h=BaseLoadBitmap.create("itemicon1");h.setScale(.45),h.x=130,h.y=l.y-12,this.addChild(h);var d=ComponentManager.getBitmapText(n.getGem+"","recharge_fnt");d.x=175,d.y=l.y+l.height/2-d.height/2,this.addChild(d);var g=ComponentManager.getProgressBar("progress5","progress3_bg",386);g.x=20,g.y=100,this._progress=g,this.addChild(g),this.refreshBtnStatus()},e.prototype.refreshBtnStatus=function(){var t=Api.acVoApi.getActivityVoByAidAndCode("totalRecharge");if(null!=t&&null!=t.v)if(this._progress.setText(LanguageManager.getlocal("acrecharge_yuan",[String(t.v),this._rechargeItem.needGem])),this._progress.setPercentage(t.v/this._rechargeItem.needGem),this._collectFlag&&this.removeChild(this._collectFlag),this._collectFlag=null,this._collectBtn&&this.removeChild(this._collectBtn),this._collectBtn=null,this._chargeBtn&&this.removeChild(this._chargeBtn),this._chargeBtn=null,t.flags[this._uiData])this.createCollectFlag();else if(t.v>=this._rechargeItem.needGem){var e=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"ac_recharge_Btntxt2",this.eventCollectHandler,this);e.x=this._progress.x+this._progress.width+20,e.y=this._progress.y+this._progress.height/2-e.height/2,e.name="collectBtn",this.addChild(e),this._collectBtn=e}else{var i=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"ac_recharge_Btntxt1",this.goRechargeHandler,this);i.x=this._progress.x+this._progress.width+20,i.y=this._progress.y+this._progress.height/2-i.height/2,i.name="chargeBtn",this.addChild(i),this._chargeBtn=i}},e.prototype.refreshUI=function(){this.getChildByName("collectBtn")&&(this.getChildByName("collectBtn").visible=!1),this._collectFlag&&this.removeChild(this._collectFlag),this._collectFlag=null,this.createCollectFlag(),this._collectFlag.visible=!1,this._collectFlag.setScale(1.3),this._collectFlag.visible=!0,egret.Tween.get(this._collectFlag,{loop:!1}).to({scaleX:.7,scaleY:.7},300)},e.prototype.createCollectFlag=function(){this._collectFlag=BaseBitmap.create("collectflag"),this._collectFlag.anchorOffsetX=this._collectFlag.width/2,this._collectFlag.anchorOffsetY=this._collectFlag.height/2,this._collectFlag.setScale(.7),this._collectFlag.x=this._progress.x+this._progress.width+100,this._collectFlag.y=this._progress.y+this._progress.height/2-10,this.addChild(this._collectFlag)},e.prototype.eventCollectHandlerCallBack=function(t){this.removeUIListener();var e=t.data.data.data,i=t.data.data.ret;if(0==i&&this._lastReqIdx==this._curIdx){this._lastReqIdx=null,this.refreshUI();var a=e.rewards,n=GameData.formatRewardItem(a),o=this._progress.localToGlobal(this._progress.width+50,20);App.CommonUtil.playRewardFlyAction(n,o)}},e.prototype.eventCollectHandler=function(t){this.addUIListener(),this._lastReqIdx=this._curIdx;var e=Api.acVoApi.getActivityVoByAidAndCode("totalRecharge");NetManager.request(NetRequestConst.REQUEST_RECHARGE_GETTOTALREWARD,{activeId:"totalRecharge-"+e.code,rkey:this._uiData})},e.prototype.goRechargeHandler=function(t){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.getSpaceX=function(){return 10},e.prototype.getSpaceY=function(){return 5},e.prototype.addUIListener=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RECHARGE_GETTOTALREWARD),this.eventCollectHandlerCallBack,this)},e.prototype.removeUIListener=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RECHARGE_GETTOTALREWARD),this.eventCollectHandlerCallBack,this)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_DAILYCHARGE_REFRESH_V,this.refreshBtnStatus,this),this.removeUIListener(),this._uiData=null,this._collectFlag=null,this._progress=null,this._collectBtn=null,this._chargeBtn=null,this._curIdx=0,this._rechargeItem=null,this._lastReqIdx=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AcTotalRechargeScrollItem.prototype,"AcTotalRechargeScrollItem");var AcCorssImacyPRankItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){var i=e.type;this.width="enterIn"==i?502:520,this.height="enterIn"==i?32:52;var a=(570-this.width)/2,n={enterIn:[40,184,372,516],rank:[65-a,160-a,300-a,407-a]};if(3>t&&"enterIn"!=i){var o=BaseBitmap.create("rankinglist_rank"+String(t+1));o.x=n[i][0]+(44-o.width)/2,o.y=this.height/2-o.height/2,this.addChild(o)}else{var o=BaseBitmap.create("rankinglist_rankbg");o.x=n[i][0]+(44-o.width)/2,o.y=this.height/2-o.height/2,this.addChild(o);var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);s.text=String(t+1),s.x=n[i][0]+(44-s.textWidth)/2,s.y=this.height/2-s.height/2,this.addChild(s)}var r=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_CONTENT_COMMON);r.x=n[i][1]+(88-r.textWidth)/2,r.y=this.height/2-r.height/2,this.addChild(r);var l=ComponentManager.getTextField(LanguageManager.getlocal("ranserver2",[e.zid+""]),TextFieldConst.FONTSIZE_CONTENT_COMMON);l.x=n[i][2]+(44-l.textWidth)/2,l.y=this.height/2-r.height/2,this.addChild(l);var h=ComponentManager.getTextField(e.point,TextFieldConst.FONTSIZE_CONTENT_COMMON);h.x=n[i][3]+(88-h.textWidth)/2,h.y=this.height/2-r.height/2,this.addChild(h),Api.playerVoApi.getPlayerName()==e.name&&(r.textColor=l.textColor=h.textColor=TextFieldConst.COLOR_QUALITY_GREEN,s&&(s.textColor=TextFieldConst.COLOR_QUALITY_GREEN)),Api.playerVoApi.getPlayerName()!=e.name&&e.zid==ServerCfg.selectServer.zid&&(r.textColor=l.textColor=h.textColor=8448508,s&&(s.textColor=8448508))},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AcCorssImacyPRankItem.prototype,"AcCorssImacyPRankItem");var AcCorssImacyServerItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){var i=e.type;this.width="enterIn"==i?GameConfig.stageWidth:520,this.height="enterIn"==i?40:52;var a=(570-this.width)/2,n={enterIn:[143,298,431],rank:[65-a,236-a,407-a]};if(3>t&&"enterIn"!=i){var o=BaseBitmap.create("rankinglist_rank"+String(t+1));o.x=n[i][0]+(44-o.width)/2,o.y=this.height/2-o.height/2,this.addChild(o)}else{var o=BaseBitmap.create("rankinglist_rankbg");o.x=GameConfig.stageWidth/2-155-o.width/2,o.y=this.height/2-o.height/2,this.addChild(o);var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);s.text=String(t+1),s.x=n[i][0]+(44-s.textWidth)/2,s.y=this.height/2-s.height/2,this.addChild(s)}var r=ComponentManager.getTextField(e.zid+LanguageManager.getlocal("serverListServer"),TextFieldConst.FONTSIZE_CONTENT_COMMON);r.x=n[i][1]+(44-r.textWidth)/2,r.y=this.height/2-r.textHeight/2,this.addChild(r);var l=ComponentManager.getTextField(String(e.point),TextFieldConst.FONTSIZE_CONTENT_COMMON);l.x=n[i][2]+(88-l.textWidth)/2,l.y=this.height/2-l.textHeight/2,this.addChild(l),Number(e.zid)==Number(ServerCfg.selectServer.zid)&&(r.textColor=l.textColor=TextFieldConst.COLOR_QUALITY_GREEN,s&&(s.textColor=TextFieldConst.COLOR_QUALITY_GREEN))},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AcCorssImacyServerItem.prototype,"AcCorssImacyServerItem");var AcCrossServerDetailPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["atkracecross_explain_bg","atkracecross_explain_pic","crossserverinti_detailbg-1"])},e.prototype.getTitleStr=function(){return"atkracecrossDetailTitle"},Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.AcCfg.getCfgByActivityIdAndCode(AcCrossServerIntimacyView.AID,AcCrossServerIntimacyView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vo",{get:function(){return Api.acVoApi.getActivityVoByAidAndCode(AcCrossServerIntimacyView.AID,AcCrossServerIntimacyView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"api",{get:function(){return Api.crossImacyVoApi},enumerable:!0,configurable:!0}),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=524,t.height=664,t.setPosition(this.viewBg.width/2-t.width/2,12),this.addChildToContainer(t);var e=BaseBitmap.create("crossserverinti_detailbg-"+this.vo.code);e.setPosition(this.viewBg.width/2-e.width/2,t.y+4),this.addChildToContainer(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("crossImacyOpenDesc3-"+this.vo.code),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_BROWN);i.setPosition(e.x+5,e.y+e.height+8),this.addChildToContainer(i);var a=BaseBitmap.create("atkracecross_explain_bg");a.width=518,a.height=35,a.setPosition(this.viewBg.width/2-a.width/2,i.y+i.height+8),this.addChildToContainer(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("crossImacyDetailDesc1-"+this.vo.code),TextFieldConst.FONTSIZE_CONTENT_SMALL);n.setPosition(a.x+20,a.y+8),n.width=a.width-40,n.lineSpacing=6,this.addChildToContainer(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("acPunishRankRewardTab1"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_BROWN);o.setPosition(i.x,a.y+a.height+12),this.addChildToContainer(o);var s=BaseBitmap.create("atkracecross_explain_bg");s.width=518,s.height=65,s.setPosition(this.viewBg.width/2-s.width/2,o.y+o.height+8),this.addChildToContainer(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("crossImacyDetailDesc2-"+this.vo.code),19);r.setPosition(s.x+20,s.y+12),r.width=a.width-40,r.lineSpacing=6,this.addChildToContainer(r);var l=BaseBitmap.create("atkracecross_explain_bg");l.width=518,l.height=45,l.setPosition(this.viewBg.width/2-l.width/2,s.y+s.height+12),this.addChildToContainer(l);var h=this.vo,d=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossTime",[h.acTimeAndHour]),TextFieldConst.FONTSIZE_CONTENT_SMALL);d.x=r.x,d.y=l.y+10,this.addChildToContainer(d);var g=BaseBitmap.create("public_9_bg41");g.width=492,g.height=136,g.setPosition(this.viewBg.width/2-g.width/2,l.y+l.height+12),this.addChildToContainer(g);var c=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_RED);c.setPosition(g.x+20,g.y+12),c.width=g.width-40,c.height=g.height-24,c.lineSpacing=6,c.textAlign=egret.HorizontalAlign.CENTER,c.verticalAlign=egret.VerticalAlign.MIDDLE,this.addChildToContainer(c),h.getIsCanJoin()?c.text=LanguageManager.getlocal("crossImacyOpenDesc1-"+h.code):c.text=LanguageManager.getlocal("crossImacyOpenDesc2-"+h.code);var p=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"sysConfirm",this.hide,this);p.setPosition(this.viewBg.width/2-p.width/2,t.y+t.height+20),this.addChildToContainer(p)},e.prototype.getBgExtraHeight=function(){return 20},e}(PopupView);__reflect(AcCrossServerDetailPopupView.prototype,"AcCrossServerDetailPopupView");var AcCrossServerIntimacyEnterView=function(t){function e(){var e=t.call(this)||this;return e._scrollList=null,e._scoreTextTab=[],e._countDownText=null,e._serverList=null,e._atkracedes1=null,e._atkracedes2=null,e._isCanJoin=!1,e._cdType=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.AcCfg.getCfgByActivityIdAndCode(AcCrossServerIntimacyView.AID,AcCrossServerIntimacyView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vo",{get:function(){return Api.acVoApi.getActivityVoByAidAndCode(AcCrossServerIntimacyView.AID,AcCrossServerIntimacyView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"api",{get:function(){return Api.crossImacyVoApi},enumerable:!0,configurable:!0}),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["crossserverintienterbg-1","atkracecross_award_text","atkracecross_award","atkracecross_top","rankinglist_rankbg",,"forpeople_bottom","atkracecross_rankbg","atkracecross_rank","atkracecross_explain",,"arena_rank","arena_rank_text","public_9_downbg","dinner_line","rankinglist_rank1","rankinglist_rank2","rankinglist_rank3","public_9_wordbg2"])},e.prototype.getBgName=function(){return"crossserverintienterbg-1"},e.prototype.getTitleStr=function(){return"crossImacyTitle-"+AcCrossServerIntimacyView.CODE},e.prototype.initBg=function(){var t=this.getBgName();if(t){var e=egret.Rectangle.create();e.setTo(0,0,640,1136),this.viewBg=BaseLoadBitmap.create(t,e),this.viewBg.setPosition(0,.1*(GameConfig.stageHeigth-this.viewBg.height)),this.addChild(this.viewBg)}},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_ACTIVITY_CROSSIMACY_ZRANK,requestData:{}}},e.prototype.receiveData=function(t){var e=this;e.api.setZoneRankInfo(t.data.data)},e.prototype.initView=function(){var t=this,e=t.vo;t._cdType=e.judgeTimeProcess();var i=t.api.zonerankinfos,a=[];for(var n in i)a.push(i[n]);a.length?i.length>2?t.init_top2():t.init_top1():t.init_top2(),t.init_middle(),NetManager.request(NetRequestConst.REQUEST_ACTIVITY_CROSSIMACY_PRANK,{}),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_CROSSIMACY_PRANK),this.useCallback,this);var o=ComponentManager.getButton("atkracecross_explain","",this.clickDetailBtnHandler,this);o.x=12,o.y=22,this.addChild(o),""==LocalStorageManager.get(LocalStorageConst.LOCAL_IMACY_RULE)&&(t.clickDetailBtnHandler(1),LocalStorageManager.set(LocalStorageConst.LOCAL_IMACY_RULE,"1"))},e.prototype.init_top1=function(){var t=this,e=t.api,i=BaseLoadBitmap.create("atkracecross_top");i.x=0,i.y=89,this.addChild(i);var a,n,o=e.zonerankinfos;if(o.length){String(o[0].zid)==ServerCfg.selectServer.zid?(a=o[0],n=o[1]):(a=o[1],n=o[0]);var s=ComponentManager.getTextField(a.zid+LanguageManager.getlocal("serverListServer"),TextFieldConst.FONTSIZE_CONTENT_COMMON);s.setPosition(56-s.width/2,i.y+46),this.addChild(s);var r=ComponentManager.getTextField(n.zid+LanguageManager.getlocal("serverListServer"),TextFieldConst.FONTSIZE_CONTENT_COMMON);r.setPosition(GameConfig.stageWidth-56-r.width/2,s.y),this.addChild(r),this._scoreTextTab.length=0;var l=ComponentManager.getBitmapText(String(a.point),TextFieldConst.FONTNAME_ITEMTIP);l.setPosition(114,i.y+67),this.addChild(l),this._scoreTextTab.push(l);var h=ComponentManager.getBitmapText(String(n.point),TextFieldConst.FONTNAME_ITEMTIP);h.setPosition(GameConfig.stageWidth-110-h.width,l.y),this.addChild(h),this._scoreTextTab.push(h)}},e.prototype.init_top2=function(){var t=this,e=t.api,i=e.zonerankinfos,a=BaseBitmap.create("atkracecross_rankbg");a.y=89,a.height=224,this.addChild(a);var n=BaseBitmap.create("atkracecross_rank");n.setPosition(GameConfig.stageWidth/2-n.width/2,a.y+8),this.addChild(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("rankorder"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);o.setPosition(GameConfig.stageWidth/2-155-o.width/2,a.y+50),this.addChild(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("atkraceServerDesc"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);s.setPosition(GameConfig.stageWidth/2-s.width/2,o.y),this.addChild(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("croessImacyScore-"+this.vo.code),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);r.setPosition(GameConfig.stageWidth/2+155-r.width/2,o.y),this.addChild(r);var l=egret.Rectangle.create();l.setTo(0,0,640,144);for(var h=[],d=0,g=i;d<g.length;d++){var c=g[d];c.type="enterIn",h.push(c)}this._serverList=ComponentManager.getScrollList(AcCorssImacyServerItem,h,l),this.addChild(this._serverList),this._serverList.y=a.y+80;var p=ComponentManager.getTextField(LanguageManager.getlocal("atkracedes5"),20);p.x=(GameConfig.stageWidth-p.textWidth)/2,p.y=this._serverList.y+50,this.addChild(p),this._atkracedes1=p,this._atkracedes1.visible=0==h.length},e.prototype.init_middle=function(){var t=this,e=(this.api,this.vo),i=BaseBitmap.create("public_9_wordbg2");i.height=125,i.x=(GameConfig.stageWidth-i.width)/2,i.y=GameConfig.stageHeigth/2-62.5,this.addChild(i);var a=t.api.getCountDownTime(),n=LanguageManager.getlocal(e.getIsCanJoin()?"croessImacyJoin-"+AcCrossServerIntimacyView.CODE:"croessImacyNotJoin-"+AcCrossServerIntimacyView.CODE,[LanguageManager.getlocal("crossIntimacyCDTime"+t._cdType)+e.getCountTimeStr(a)]),o=ComponentManager.getTextField(n,TextFieldConst.FONTSIZE_CONTENT_COMMON);o.lineSpacing=6,o.setPosition(i.x+i.width/2-o.textWidth/2,i.y+23.5+7),o.textAlign=egret.HorizontalAlign.CENTER,this._countDownText=o,this.addChild(o)},e.prototype.tick=function(){var t=this,e=t.vo;if(t._countDownText){var i=t.api.getCountDownTime();if(0>=i&&(t._cdType=t.vo.judgeTimeProcess(),4==t._cdType))return t.hide(),void App.CommonUtil.showTip(LanguageManager.getlocal("crossIntimacyCDTime4"));t._countDownText.text=LanguageManager.getlocal(e.getIsCanJoin()?"croessImacyJoin-"+AcCrossServerIntimacyView.CODE:"croessImacyNotJoin-"+AcCrossServerIntimacyView.CODE,[LanguageManager.getlocal("crossIntimacyCDTime"+t._cdType)+e.getCountTimeStr(i)])}},e.prototype.refreshEnterBtn=function(){},e.prototype.initBottom=function(){var t=BaseBitmap.create("public_9_downbg");t.height=200,t.width=GameConfig.stageWidth,t.y=GameConfig.stageHeigth-200,this.addChild(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("rankorder"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);e.setPosition(40,t.y+20),this.addChild(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("ranknickName"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);i.setPosition(e.x+e.textWidth+100,e.y),this.addChild(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("rankServer"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);a.setPosition(i.x+i.textWidth+100,e.y),this.addChild(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("croessImacyScore-"+AcCrossServerIntimacyView.CODE),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);n.setPosition(a.x+a.textWidth+100,e.y),this.addChild(n);var o=new egret.Rectangle(t.x,e.y+e.textHeight,t.width,100),s=[];for(var r in this.api.prankinfos){var l=this.api.prankinfos[r];l.type="enterIn",s.push(l)}this._scrollList=ComponentManager.getScrollList(AcCorssImacyPRankItem,s,o),this._scrollList.x=t.x,this._scrollList.y=e.y+e.textHeight+10,this.addChild(this._scrollList);var h=ComponentManager.getTextField(LanguageManager.getlocal("atkracedes5"),20);h.x=(GameConfig.stageWidth-h.textWidth)/2,h.y=this._scrollList.y+50,this.addChild(h),this._atkracedes2=h,this._atkracedes2.visible=0==s.length;var d=BaseBitmap.create("dinner_line");d.x=(t.width-d.width)/2,d.y=this._scrollList.y+o.height+7,this.addChild(d);var g,c=this.api.merank;g=c?c>300?"10000+":c.toString():LanguageManager.getlocal(this.vo.getIsCanJoin()?"atkracedes4":"crossImacyNoAccess");var p=ComponentManager.getTextField(g,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_GREEN);p.setPosition(e.x+(e.textWidth-p.textWidth)/2,d.y+d.height+10),this.addChild(p);var _=ComponentManager.getTextField(Api.playerVoApi.getPlayerName(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_GREEN);_.setPosition(i.x+(i.textWidth-_.textWidth)/2,p.y),this.addChild(_);var u=ServerCfg.selectServer.zid,C=ComponentManager.getTextField(LanguageManager.getlocal("ranserver2",[u+""]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_GREEN);C.setPosition(a.x+(a.textWidth-C.textWidth)/2,_.y),this.addChild(C);var f="",m=this.api.mepoint;f=m?m.toString():"0";var T=ComponentManager.getTextField(f,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_GREEN);T.setPosition(n.x+(n.textWidth-T.textWidth)/2,C.y),this.addChild(T);var y=ComponentManager.getButton("forpeople_bottom",null,this.rewardHandle,this,null,0);y.setPosition(0,t.y-10-y.height),this.addChild(y);var v=BaseBitmap.create("atkracecross_award");v.setPosition(y.width/2-v.width/2,y.height/2-v.height/2-5),y.addChild(v);var A=BaseBitmap.create("atkracecross_award_text");A.setPosition(y.width/2-A.width/2,v.y+v.height-30),y.addChild(A);var w=ComponentManager.getButton("forpeople_bottom",null,this.rankHandle,this,null,0);w.setPosition(GameConfig.stageWidth-w.width-5,y.y),this.addChild(w);var x=BaseBitmap.create("arena_rank");x.setPosition(w.width/2-x.width/2,w.height/2-x.height/2-5),w.addChild(x);var I=BaseBitmap.create("arena_rank_text");I.setPosition(w.width/2-I.width/2,x.y+x.height-30),w.addChild(I)},e.prototype.useCallback=function(t){Api.crossImacyVoApi.setPRankInfo(t.data.data.data),this.initBottom()},e.prototype.rankHandle=function(){ViewController.getInstance().openView(ViewConst.POPUP.ACCROSSSERVERINTIMACYRANKLISTVIEW)},e.prototype.rewardHandle=function(){ViewController.getInstance().openView(ViewConst.POPUP.ACCROSSSERVERINTIMACYREWARDVIEW)},e.prototype.refreshServant=function(){NetManager.request(NetRequestConst.REQUEST_ACTIVITY_CROSSIMACY_PRANK,{}),NetManager.request(NetRequestConst.REQUEST_ACTIVITY_CROSSIMACY_ZRANK,{})},e.prototype.clickDetailBtnHandler=function(t){ViewController.getInstance().openView(ViewConst.POPUP.ACCROSSSERVERDETAILPOPUPVIEW)},e.prototype.hide=function(){t.prototype.hide.call(this),ViewController.getInstance().hideAllView()},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_CROSSIMACY_PRANK),this.useCallback,this),this._scrollList=null,this._scoreTextTab.length=0,this._countDownText=null,this._serverList=null,this._isCanJoin=!1,this._atkracedes1=null,this._atkracedes2=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(AcCrossServerIntimacyEnterView.prototype,"AcCrossServerIntimacyEnterView");var AcCrossServerIntimacyRankListView=function(t){function e(){var e=t.call(this)||this;return e._infoList=null,e.atkracedes5=null,e.isShowTextBoo=!1,e._curTabIdx=0,e._nickName=null,e._nickNameTxt=null,e._serverTxt=null,e._playerName=null,e._playerServer=null,e._playerRank=null,e._playerScore=null,e._atkracedes5=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["rankinglist_line","rankinglist_rankbg","rankinglist_rank1","rankinglist_rank2","rankinglist_rank3"])},Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.AcCfg.getCfgByActivityIdAndCode(AcCrossServerIntimacyView.AID,AcCrossServerIntimacyView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vo",{get:function(){return Api.acVoApi.getActivityVoByAidAndCode(AcCrossServerIntimacyView.AID,AcCrossServerIntimacyView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"api",{get:function(){return Api.crossImacyVoApi},enumerable:!0,configurable:!0}),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_CROSSIMACY_PRANK),this.fresh_view,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_CROSSIMACY_ZRANK),this.fresh_view,this);var t=["crossServerImacyRankListViewTab1","crossServerImacyRankListViewTab2"],e=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,t,this.tabBtnClickHandler,this);e.x=40,e.y=10,this.addChildToContainer(e);var i=BaseBitmap.create("public_9_probiginnerbg");i.width=520,i.height=526,i.setPosition(this.viewBg.width/2-i.width/2,e.y+e.height),this.addChildToContainer(i);var a=BaseBitmap.create("public_9_bg41");a.width=i.width,a.height=36,a.setPosition(i.x,i.y),this.addChildToContainer(a),this._infoList=[];for(var n in this.api.zonerankinfos){var o=this.api.zonerankinfos[n];o.type="rank",this._infoList.push(o)}this._scroRect=new egret.Rectangle(a.x,a.y+a.height,a.width,i.height-a.height-8),this._scrollList=ComponentManager.getScrollList(AcCorssImacyServerItem,this._infoList,this._scroRect),this._scrollList.x=a.x,this._scrollList.y=a.y+a.height,this.addChildToContainer(this._scrollList),this._scrollList2=ComponentManager.getScrollList(AcCorssImacyPRankItem,[],this._scroRect),this._scrollList2.x=a.x,this._scrollList2.y=a.y+a.height,this._scrollList2.visible=!1,this.addChildToContainer(this._scrollList2);var s=BaseBitmap.create("public_9_probiginnerbg");s.width=516,s.height=84,s.setPosition(this.viewBg.width/2-s.width/2,i.y+i.height+8),this.addChildToContainer(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("rankorder"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);r.setPosition(65,a.y+a.height/2-r.height/2),this.addChildToContainer(r);var l=ComponentManager.getTextField(LanguageManager.getlocal("ranknickName"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);l.setPosition(160,r.y),this.addChildToContainer(l),this._nickNameTxt=l,this._nickNameTxt.visible=!1;var h=ComponentManager.getTextField(LanguageManager.getlocal("rankServer"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);h.setPosition((516-h.textWidth)/2,r.y),this.addChildToContainer(h),this._serverTxt=h;var d=ComponentManager.getTextField(LanguageManager.getlocal("croessImacyScore-"+this.vo.code),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);d.setPosition(407,r.y),this.addChildToContainer(d);var g=ComponentManager.getTextField(LanguageManager.getlocal("atkracedes5"),20);g.x=i.x+(i.width-g.textWidth)/2,g.y=a.y+a.height+150,this.addChildToContainer(g),this._atkracedes5=g,this._atkracedes5.visible=0==this._infoList.length;var c=ComponentManager.getTextField(LanguageManager.getlocal("ranknickName")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);c.setPosition(r.x,s.y+s.height/2-5-c.height),this.addChildToContainer(c),this._nickName=c,this._nickName.visible=!1;var p=ComponentManager.getTextField(Api.playerVoApi.getPlayerName(),TextFieldConst.FONTSIZE_CONTENT_COMMON);p.setPosition(c.x+c.width+12,c.y),this.addChildToContainer(p),this._playerName=p,this._playerName.visible=!1;var _,u=0,C=0;for(var n in this.api.zonerankinfos){var o=this.api.zonerankinfos[n];if(Number(o.zid)==Number(ServerCfg.selectServer.zid)){u=Number(n)+1,C=Number(o.point);break}}_=u?u>300?"10000+":u.toString():LanguageManager.getlocal("atkracedes4");var f=ComponentManager.getTextField(LanguageManager.getlocal("rankorder")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);f.setPosition(r.x,s.y+s.height/2+5),this.addChildToContainer(f);var m=ComponentManager.getTextField(_,TextFieldConst.FONTSIZE_CONTENT_COMMON);m.setPosition(f.x+f.width+12,f.y),this.addChildToContainer(m),this._playerRank=m;var T="";T=C?C.toString():"0";var y=ComponentManager.getTextField(T,TextFieldConst.FONTSIZE_CONTENT_COMMON);y.setPosition(s.x+s.width-20-y.width,f.y),this.addChildToContainer(y),this._playerScore=y;var v=ComponentManager.getTextField(LanguageManager.getlocal("croessImacyScore-"+this.vo.code)+": ",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);v.setPosition(y.x-20-99,f.y),this.addChildToContainer(v);var A=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);A.setPosition(this._nickName.x,p.y);var w=ServerCfg.selectServer.zid;A.text=LanguageManager.getlocal("crossranserver",[w+""]),this.addChildToContainer(A),this._playerServer=A},e.prototype.tabBtnClickHandler=function(t){this._curTabIdx=t.index,NetManager.request(0==this._curTabIdx?NetRequestConst.REQUEST_ACTIVITY_CROSSIMACY_ZRANK:NetRequestConst.REQUEST_ACTIVITY_CROSSIMACY_PRANK,{})},e.prototype.fresh_view=function(t){this._scrollList.visible=0==this._curTabIdx,this._scrollList2.visible=this._nickNameTxt.visible=this._playerName.visible=this._nickName.visible=!this._scrollList.visible;var e,i=0;if(this._infoList=[],0==this._curTabIdx){var a=0;this.api.setZoneRankInfo(t.data.data.data);for(var n in this.api.zonerankinfos){var o=this.api.zonerankinfos[n];o.type="rank",this._infoList.push(o),Number(o.zid)==Number(ServerCfg.selectServer.zid)&&(a=Number(n)+1,i=Number(o.point).toString())}this._scrollList.refreshData(this._infoList),e=a?a>300?"10000+":a.toString():LanguageManager.getlocal("atkracedes4")}else{this.api.setPRankInfo(t.data.data.data);for(var n in this.api.prankinfos){var o=this.api.prankinfos[n];o.type="rank",this._infoList.push(o)}this._scrollList2.refreshData(this._infoList);var s=this.api.merank;i=this.api.mepoint||"0",e=s?s>300?"10000+":s.toString():LanguageManager.getlocal(this.vo.getIsCanJoin()?"atkracedes4":"crossImacyNoAccess")}this._atkracedes5.visible=0==this._infoList.length,this._playerRank.text=e,this._playerScore.text=Number(i).toString(),this._serverTxt.x=0==this._curTabIdx?(516-this._serverTxt.textWidth)/2:300,this._playerServer.x=0==this._curTabIdx?this._nickName.x:this._playerScore.x-20-94},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_CROSSIMACY_PRANK),this.fresh_view,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_CROSSIMACY_ZRANK),this.fresh_view,this),this._scrollList=null,this._infoList=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AcCrossServerIntimacyRankListView.prototype,"AcCrossServerIntimacyRankListView");var AcCrossServerIntimacyRewardView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getTabbarTextArr=function(){return["atkracecrossActivityRewardTab1","atkracecrossActivityRewardTab2"]},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["atkracecross_rewatdbg1","atkracecross_rewatdbg2","atkracecross_rewatdbg3","wifeview_bottombg","itemeffect"])},e.prototype.initView=function(){},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(CommonView);__reflect(AcCrossServerIntimacyRewardView.prototype,"AcCrossServerIntimacyRewardView");var AcCrossServerIntimacyRewardViewTab1=function(t){function e(){var e=t.call(this)||this;return e._nodeContainer=null,e._countDownText=null,e.initView(),e}return __extends(e,t),Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.AcCfg.getCfgByActivityIdAndCode(AcCrossServerIntimacyView.AID,AcCrossServerIntimacyView.CODE)
},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vo",{get:function(){return Api.acVoApi.getActivityVoByAidAndCode(AcCrossServerIntimacyView.AID,AcCrossServerIntimacyView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"api",{get:function(){return Api.crossImacyVoApi},enumerable:!0,configurable:!0}),e.prototype.getListType=function(){return 1},e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_CROSSIMACY_AWARD),this.collectHandlerCallBack,this),this._nodeContainer=new BaseDisplayObjectContainer;var t=BaseBitmap.create("public_9_bg23");t.width=628,t.y=3,t.x=6,this._nodeContainer.addChild(t);var e=BaseBitmap.create("atkracecross_rewatdbg1");e.y=t.y,e.x=GameConfig.stageWidth/2-e.width/2,this._nodeContainer.addChild(e);var i=BaseBitmap.create("public_line3");i.width=480,i.x=GameConfig.stageWidth/2-i.width/2,i.y=e.y+e.height/2-i.height/2,this._nodeContainer.addChild(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossActivityRewardTxt1"),24,TextFieldConst.COLOR_LIGHT_YELLOW);a.x=GameConfig.stageWidth/2-a.width/2,a.y=e.y+e.height/2-a.height/2,this._nodeContainer.addChild(a);for(var n=this.cfg,o=n.getWinServerRewards(),s=t.x+15,r=e.y+e.height+5,l=0;l<o.length;l++){var h=o[l];h.x=s,h.y=r,s+=h.width+15,s-5>=t.x+t.width&&(s=t.x+15,r+=h.height+10,h.x=s,h.y=r,s+=h.width+15),this._nodeContainer.addChild(h)}r+=120,t.height=r,r+=20;var d=BaseBitmap.create("public_9_bg23");d.width=t.width,d.y=r,d.x=t.x,this._nodeContainer.addChild(d);var g=BaseBitmap.create("atkracecross_rewatdbg1");g.y=d.y,g.x=e.x,this._nodeContainer.addChild(g);var c=BaseBitmap.create("public_line3");c.width=i.width,c.x=i.x,c.y=g.y+g.height/2-c.height/2,this._nodeContainer.addChild(c);var p=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossActivityRewardTxt2"),24,TextFieldConst.COLOR_LIGHT_YELLOW);p.x=GameConfig.stageWidth/2-p.width/2,p.y=g.y+g.height/2-p.height/2,this._nodeContainer.addChild(p);var _=n.getLossServerRewards();s=t.x+15,r=g.y+g.height+5;for(var l=0;l<_.length;l++){var h=_[l];h.x=s,h.y=r,s+=h.width+15,s-5>=t.x+t.width&&(s=t.x+15,r+=h.height+10,h.x=s,h.y=r,s+=h.width+15),this._nodeContainer.addChild(h)}r+=120,d.height=r-d.y;var u=BaseBitmap.create("wifeview_bottombg");u.y=GameConfig.stageHeigth-u.height-150,this.addChild(u);var C=ComponentManager.getTextField("",20);1==this.api.iszonewin?C.text=LanguageManager.getlocal("atkracecrossActivityRewardTxt3"):C.text=LanguageManager.getlocal("atkracecrossActivityRewardTxt4"),C.x=u.x+30,C.y=u.y+25,this.addChild(C),TickManager.addTick(this.tick,this);var f=this.vo;this._countDownText=ComponentManager.getTextField("",20),this.tick(),this._countDownText.x=C.x,this._countDownText.y=C.y+35,this.addChild(this._countDownText),this._collectBtn=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskCollect",this.collectHandler,this),this._collectBtn.x=u.x+u.width-150,this._collectBtn.y=u.y+u.height/2-this._collectBtn.height/2,this._collectBtn.setColor(TextFieldConst.COLOR_BLACK),this._collectBtn.setEnable(!1),this.addChild(this._collectBtn);var m=this.vo;m.isGettZonereward()?(this._collectBtn.visible=!1,this.createCollectFlag(),this._collectFlag.setScale(.75)):GameData.serverTime>=f.st&&GameData.serverTime<=f.et&&GameData.serverTime+86400>f.et?this._collectBtn.setEnable(!0):C.text=LanguageManager.getlocal("atkracecrossActivityRewardTxt6");var T=new egret.Rectangle(0,0,GameConfig.stageWidth,u.y-5),y=ComponentManager.getScrollView(this._nodeContainer,T);y.y=3,y.horizontalScrollPolicy="off",this.addChild(y)},e.prototype.collectHandler=function(){var t=this.vo;NetManager.request(NetRequestConst.REQUEST_ACTIVITY_CROSSIMACY_AWARD,{activeId:t.aid+"-"+t.code})},e.prototype.collectHandlerCallBack=function(t){var e=t.data.data;if(0==e.ret){this._collectBtn.visible=!1;var i=e.data.rewards,a=GameData.formatRewardItem(i);App.CommonUtil.playRewardFlyAction(a),this.createCollectFlag(),this._collectFlag.setScale(1),this._collectFlag.visible=!1,this._collectFlag.setScale(1.3),this._collectFlag.visible=!0,egret.Tween.get(this._collectFlag,{loop:!1}).to({scaleX:.75,scaleY:.75},300)}},e.prototype.tick=function(){if(this._countDownText){var t=this.api.getCountDownTime(),e=this.vo.judgeTimeProcess();4>e?this._countDownText.text=LanguageManager.getlocal("crossIntimacyCDTime"+e)+this.vo.getCountTimeStr(t):this._countDownText.text=LanguageManager.getlocal("crossIntimacyCDTime3")+LanguageManager.getlocal("acRank_acCDEnd")}},e.prototype.getCountTimeStr=function(t){return 0>t&&(t=0),App.DateUtil.getFormatBySecond(t)},e.prototype.createCollectFlag=function(){this._collectFlag||(this._collectFlag=BaseBitmap.create("collectflag"),this._collectFlag.anchorOffsetX=this._collectFlag.width/2,this._collectFlag.anchorOffsetY=this._collectFlag.height/2,this._collectFlag.x=this._collectBtn.x+this._collectBtn.width/2,this._collectFlag.y=this._collectBtn.y+this._collectBtn.height/2,this.addChild(this._collectFlag))},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_CROSSIMACY_AWARD),this.collectHandlerCallBack,this),this._nodeContainer=null,this._collectBtn=null,this._collectFlag=null,this._countDownText=null,TickManager.removeTick(this.tick,this),t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(AcCrossServerIntimacyRewardViewTab1.prototype,"AcCrossServerIntimacyRewardViewTab1");var AcCrossServerIntimacyRewardViewTab2=function(t){function e(){var e=t.call(this)||this;return e._nodeContainer=null,e.initView(),e}return __extends(e,t),Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.AcCfg.getCfgByActivityIdAndCode(AcCrossServerIntimacyView.AID,AcCrossServerIntimacyView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vo",{get:function(){return Api.acVoApi.getActivityVoByAidAndCode(AcCrossServerIntimacyView.AID,AcCrossServerIntimacyView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"api",{get:function(){return Api.crossImacyVoApi},enumerable:!0,configurable:!0}),e.prototype.getListType=function(){return 2},e.prototype.initView=function(){this._nodeContainer=new BaseDisplayObjectContainer;var t=this.cfg,e=t.getServerRankRewards(),i=Object.keys(e);i.sort(function(t,e){return Number(t)-Number(e)});for(var a=20,n=3,o=0;o<i.length;o++){var s=i[o],r=e[s],l=BaseBitmap.create("public_9_bg23");l.width=628,l.y=n,l.x=6,this._nodeContainer.addChild(l);var h=BaseBitmap.create("atkracecross_rewatdbg3");h.y=n,h.x=GameConfig.stageWidth/2-h.width/2,this._nodeContainer.addChild(h);var d=BaseBitmap.create("public_line3");d.width=480,d.x=GameConfig.stageWidth/2-d.width/2,d.y=h.y+h.height/2-d.height/2,this._nodeContainer.addChild(d);var g=r.reward,c=r.rank,p=ComponentManager.getTextField("",24,TextFieldConst.COLOR_LIGHT_YELLOW);Number(s)<4?p.text=LanguageManager.getlocal("acRank_rank"+s):p.text=p.text=LanguageManager.getlocal("acRank_rank4",[String(c[0]),String(c[1])]),p.x=GameConfig.stageWidth/2-p.width/2,p.y=h.y+h.height/2-p.height/2,this._nodeContainer.addChild(p);var _=GameData.getRewardItemIcons(g,!0,!0),u=_.length,C=h.y+h.height+5;a=20,n=C;for(var f=0;u>f;f++){var m=_[f];m.x=a,m.y=n,a+=m.width+15,a>=GameConfig.stageWidth&&(a=20,n+=m.height+15,m.x=a,m.y=n,a+=m.width+8),this._nodeContainer.addChild(m)}n+=130,l.height=n-l.y,n+=10}n+=10;var T=BaseBitmap.create("wifeview_bottombg");T.y=GameConfig.stageHeigth-T.height-150,this.addChild(T);var y=ComponentManager.getTextField("",20);this.api.merank?y.text=LanguageManager.getlocal("acRank_myrank1",[String(this.api.merank)]):y.text=LanguageManager.getlocal("acRank_myrank1",[LanguageManager.getlocal("atkracedes4")]),y.x=T.x+30,y.y=T.y+T.height/2-y.height/2,this.addChild(y);var v=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossActivityRewardTxt5"),20,TextFieldConst.COLOR_LIGHT_YELLOW);v.x=T.x+T.width-v.width-30,v.y=y.y,this.addChild(v);var A=new egret.Rectangle(0,0,GameConfig.stageWidth,T.y-10),w=ComponentManager.getScrollView(this._nodeContainer,A);w.y=3,w.horizontalScrollPolicy="off",this.addChild(w)},e.prototype.dispose=function(){this._nodeContainer=null,this._collectBtn=null,this._collectFlag=null,t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(AcCrossServerIntimacyRewardViewTab2.prototype,"AcCrossServerIntimacyRewardViewTab2");var AcCrossServerIntimacyView=function(t){function e(){var e=t.call(this)||this;return e._canJoinImg=null,e._cdTimeDesc=null,e._cdType=0,e._countDownText=null,e._countDownTime=0,e._enterBtn=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"api",{get:function(){return Api.crossImacyVoApi},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.AcCfg.getCfgByActivityIdAndCode(e.AID,e.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vo",{get:function(){return Api.acVoApi.getActivityVoByAidAndCode(e.AID,e.CODE)},enumerable:!0,configurable:!0}),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["crossserverinti_canjoin-1","crossserverinti_detailbg-1","crossserverinti_enterin-1","crossserverinti_enterin-1_down","crossserverintibg-1","public_9_wordbg2"])},e.prototype.initTitle=function(){},e.prototype.getBgName=function(){return"crossserverintibg-"+this.code},e.prototype.getCloseBtnName=function(){return ButtonConst.POPUP_CLOSE_BTN_1},e.prototype.getTitleStr=function(){return"atkracecross"},e.prototype.initView=function(){var t=this;e.AID=t.aid,e.CODE=t.code;var i=this.vo.getIsCanJoin();t._canJoinImg=BaseLoadBitmap.create("crossserverinti_canjoin-"+this.code),t._canJoinImg.visible=i,t.addChildToContainer(t._canJoinImg);var a=t.vo,n=BaseBitmap.create("public_9_wordbg2");n.height=146,n.y=GameConfig.stageHeigth-n.height,t.addChildToContainer(n),t._cdType=a.judgeTimeProcess(),t._cdType>0&&t._cdType<4&&(1==t._cdType?t._countDownTime=a.st+7200-GameData.serverTime:2==t._cdType?t._countDownTime=a.et-86400-GameData.serverTime:t._countDownTime=a.et-GameData.serverTime,t.api.setCountDownTime(t._countDownTime)),t._enterBtn=ComponentManager.getButton("crossserverinti_enterin-"+t.code,"",t.enterInHandler,this),t._cdType>1&&t._cdType<4?t._enterBtn.setEnable(!0):t._enterBtn.setEnable(!1),t._enterBtn.setPosition(GameConfig.stageWidth/2-104,n.y-179-5),t.addChildToContainer(this._enterBtn);var o=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossTime",[a.acTimeAndHour]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);o.x=10,o.y=n.y+20,t.addChildToContainer(o),t._cdTimeDesc=ComponentManager.getTextField(LanguageManager.getlocal("crossIntimacyCDTime"+t._cdType),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),t._cdTimeDesc.x=o.x,t._cdTimeDesc.y=o.y+o.textHeight+5,t.addChildToContainer(this._cdTimeDesc),t._countDownTime>0&&(t._countDownText=ComponentManager.getTextField(t.vo.getCountTimeStr(t._countDownTime),TextFieldConst.FONTSIZE_CONTENT_COMMON,16711680),t._countDownText.setPosition(this._cdTimeDesc.x+this._cdTimeDesc.textWidth,this._cdTimeDesc.y),t.addChildToContainer(t._countDownText));var s=ComponentManager.getTextField(LanguageManager.getlocal("crossIntimacyRule-"+t.code),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);s.width=GameConfig.stageWidth-100,s.lineSpacing=6,s.x=o.x,s.y=t._cdTimeDesc.y+t._cdTimeDesc.textHeight+5,t.addChildToContainer(s)},e.prototype.tick=function(){var t=this;if(t._countDownText&&(--t._countDownTime,t.api.setCountDownTime(t._countDownTime),t._countDownText.text=t.vo.getCountTimeStr(t._countDownTime),t._countDownTime<=0)){if(t._cdType=t.vo.judgeTimeProcess(),2==t._cdType)t._enterBtn.setEnable(!0),t._countDownTime=t.vo.et-86400-GameData.serverTime;else if(3==t._cdType)t._countDownTime=t.vo.et-GameData.serverTime;else if(4==t._cdType)return t._enterBtn.setEnable(!1),t.hide(),void App.CommonUtil.showTip(LanguageManager.getlocal("crossIntimacyCDTime4"));t.api.setCountDownTime(t._countDownTime),t._cdTimeDesc.text=LanguageManager.getlocal("crossIntimacyCDTime"+t._cdType),t._countDownText.text=t.vo.getCountTimeStr(t._countDownTime)}},e.prototype.enterInHandler=function(){var t=this;t._cdType>1&&t._cdType<4?ViewController.getInstance().openView(ViewConst.COMMON.ACCROSSSERVERINTIMACYENTERVIEW):App.CommonUtil.showTip(LanguageManager.getlocal("crossIntimacyCDTime0"))},e.prototype.dispose=function(){var e=this;e._canJoinImg=null,e._cdTimeDesc=null,e._enterBtn.removeTouchTap(),e._enterBtn=null,t.prototype.dispose.call(this)},e.AID=null,e.CODE=null,e}(AcCommonView);__reflect(AcCrossServerIntimacyView.prototype,"AcCrossServerIntimacyView");var AcDiscountView=function(t){function e(){var e=t.call(this)||this;return e._activeCfgList=[],e}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("forpeople_top");this.addChildToContainer(t),t.y=-50;var e=ComponentManager.getTextField(LanguageManager.getlocal("acDiscount_desc"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);this.addChildToContainer(e),e.x=30,e.y=20,e.width=550;var i=115;if(Api.acVoApi.getActivityVoByAidAndCode("discount","1")&&Api.acVoApi.getActivityVoByAidAndCode("discount","1").isStart){var a=BaseBitmap.create("acdiscountviewbg1");this.addChildToContainer(a),a.y=i;var n=ComponentManager.getTextField(Api.acVoApi.getActivityVoByAidAndCode(this.aid,"1").getAcLocalTime(!1),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_GREEN);this.addChildToContainer(n),n.x=30,n.y=a.y+227;var o=ComponentManager.getTextField(LanguageManager.getlocal("acDiscount_vipDesc"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);this.addChildToContainer(o),o.x=30,o.y=a.y+270,o.width=420;var s=ComponentManager.getButton(ButtonConst.BTN_RECHARGE,"acDiscount_goVip",this.goVipHandler,this);s.x=473,s.y=a.y+265,s.name="goVipBtn",this.addChildToContainer(s);var r=BaseBitmap.create("acdiscount1zhe");this.addChildToContainer(r),r.x=563,r.y=a.y+213,i=a.y+a.height}if(Api.acVoApi.getActivityVoByAidAndCode("discount","2")&&Api.acVoApi.getActivityVoByAidAndCode("discount","2").isStart){var l=BaseBitmap.create("acdiscountviewbg2");this.addChildToContainer(l),l.y=i;var n=ComponentManager.getTextField(Api.acVoApi.getActivityVoByAidAndCode(this.aid,"2").getAcLocalTime(!1),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_GREEN);this.addChildToContainer(n),n.x=30,n.y=l.y+227;var h=ComponentManager.getTextField(LanguageManager.getlocal("acDiscount_yearcardDesc"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);this.addChildToContainer(h),h.x=30,h.y=l.y+270,h.width=420;var d=ComponentManager.getButton(ButtonConst.BTN_RECHARGE,"acDiscount_goYearCard",this.goYearCardHandler,this);d.x=473,d.y=l.y+265,d.name="goYearCardBtn",this.addChildToContainer(d);var g=BaseBitmap.create("acdiscount_zhongshenkajiage");this.addChildToContainer(g),g.x=553,g.y=l.y+204,i=l.y+l.height}},e.prototype.goVipHandler=function(){return 0==Api.acVoApi.getActivityVoByAidAndCode(this.aid,"1").isStart?void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd")):void ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEWTAB2)},e.prototype.goYearCardHandler=function(){return 0==Api.acVoApi.getActivityVoByAidAndCode(this.aid,"2").isStart?void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd")):void ViewController.getInstance().openView(ViewConst.COMMON.WELFAREVIEWYEARCARD)},e.prototype.getTitleStr=function(){return"ac"+App.StringUtil.firstCharToUper(this.aid)+"_Title"},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["forpeople_top","acdiscountviewbg1","acdiscount1zhe","acdiscountviewbg2","acdiscount_zhongshenkajiage"])},e.prototype.useCallback=function(t){for(var e=0;e<this._activeCfgList.length;e++){var i=this._scrollList.getItemByIndex(e);i&&i.checkBtnState()}},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETLIMITEDREWARD),this.useCallback,this),this._scrollList=null,this._activeCfgList=null,t.prototype.dispose.call(this)},e}(AcCommonView);__reflect(AcDiscountView.prototype,"AcDiscountView");var AcFourPeopleScrollItem=function(t){function e(){var e=t.call(this)||this;return e._fourPeopleNameText=null,e._fourPeopleLvText=null,e._itemNumberText=null,e._label_Text=null,e._servantId=0,e._itemNum=0,e._needNum=0,e._curr_index=0,e._AcFourPeopleVo=null,e._achRedDotSp=null,e.itemBitmap=null,e.bottomName=null,e.currNum=0,e._data=null,e}return __extends(e,t),e.prototype.initItem=function(t,i){this.width=640,this.height=331,this.showBg(t),this._servantId=i.getServant,this._data=i,this._itemNum=Api.itemVoApi.getItemNumInfoVoById(i.needItem),this._needNum=i.needNum,this._curr_index=t;var a=BaseLoadBitmap.create(i.servantIcon);a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,a.scaleX=.6,a.scaleY=.6,a.x=a.x+30,a.y=a.y,this.addChild(a);var n=BaseBitmap.create("fourpeople_mask");this.addChild(n),n.width=640,n.x=0,n.y=260;var o=BaseBitmap.create("public_infobg2");this.addChild(o),o.x=10,o.y=10;var s=BaseBitmap.create("forpeople_qualifications");this.addChild(s),s.x=25,s.y=220;var r=Api.servantVoApi.getServantStarsNumWithId(i.getServant),l=ComponentManager.getBitmapText(r+"","recharge_fnt");this.addChild(l),l.x=s.x+130,l.y=s.y;var h=BaseBitmap.create("forpeople_bottom");this.addChild(h),h.x=500,h.y=150,this._achRedDotSp=BaseBitmap.create("public_dot2"),this._achRedDotSp.x=h.x+h.width-10,this._achRedDotSp.y=h.y,this.addChild(this._achRedDotSp);var d=Api.servantVoApi.getServantObj(i.getServant);if(d){var g=BaseBitmap.create("achievement_state3");this.addChild(g),g.x=this.width-160,g.y=this.height-180,this._achRedDotSp&&this.removeChild(this._achRedDotSp)}else this._achRedDotSp.visible=!0,this.itemBitmap=BaseLoadBitmap.create("itemicon200"+e.CODE),this.itemBitmap.x=this.width-this.itemBitmap.width-140,this.itemBitmap.y=this.height/2-this.itemBitmap.height/2-15,this.addChild(this.itemBitmap),this.itemBitmap.name=t+"",this.itemBitmap.addTouchTap(this.itemHandler,this),this.bottomName=BaseBitmap.create("fourpeople_bottom"),this.bottomName.x=h.x,this.bottomName.y=h.y+80,this.addChild(this.bottomName),this._itemNumberText=ComponentManager.getTextField(Api.playerVoApi.getPlayerGem().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON),this._itemNumberText.x=h.x+26,this._itemNumberText.y=h.y+82,this._itemNum>=i.needNum?(this._itemNumberText.textColor=TextFieldConst.COLOR_WARN_GREEN,this._achRedDotSp.visible=!0):(this._itemNumberText.textColor=TextFieldConst.COLOR_WARN_YELLOW,this._achRedDotSp.visible=!1),this._itemNumberText.text=this._itemNum+"/"+i.needNum,this.addChild(this._itemNumberText);this._fourPeopleNameText=ComponentManager.getTextField(Api.playerVoApi.getPlayerGem().toString(),TextFieldConst.FONTSIZE_TITLE_COMMON),this._fourPeopleNameText.x=o.x+25,this._fourPeopleNameText.y=o.y+30,this._fourPeopleNameText.width=25,this._fourPeopleNameText.text=i.servantName,this.addChild(this._fourPeopleNameText);for(var c=GameConfig.config.servantCfg[this._servantId],p=c.ability,_=0;_<p.length;_++){var u=p[_],C=GameConfig.config.abilityCfg[u],f=ComponentManager.getTextField(LanguageManager.getlocal("servant_attrNameTxt"+u),20);f.x=210*_+20,f.y=275,this.addChild(f),_>=3&&(f.x=210*(_-3)+20,f.y=305);var m=BaseBitmap.create("servant_star");m.x=f.x+125,m.y=f.y-4,this.addChild(m);var T=ComponentManager.getTextField("x"+C.num.toString(),20);T.x=m.x+35,T.y=f.y,this.addChild(T)}this.speciaLaura()},e.prototype.speciaLaura=function(){var t=BaseBitmap.create("fourfloor");t.y=70,t.x=180,t.width=312,t.height=110,t.x=this.width-t.width-20,t.y=20,this.addChild(t);var i=BaseBitmap.create("fourpecialaura");this.addChild(i),i.x=t.x+90,i.y=t.y+12;var a=ComponentManager.getTextField(Api.playerVoApi.getPlayerGem().toString(),18),n=LanguageManager.getlocal("acFourPeoplea_force"+e.CODE);a.x=t.x+16,a.y=t.y+50,a.text=n,a.width=t.width,this.addChild(a);var o=ComponentManager.getTextField(Api.playerVoApi.getPlayerGem().toString(),18),s=LanguageManager.getlocal("acFourPeoplea_attribute"+e.CODE);o.x=t.x+16,o.y=t.y+80,o.width=t.width,o.text=s,this.addChild(o)},e.prototype.itemHandler=function(t){var i=Number(t.currentTarget.name);if(i+=1,this.currNum=i,this._itemNum>=this._needNum){var a=LanguageManager.getlocal("acFourPeoplea_de"+e.CODE,[App.StringUtil.toString(this._needNum),"11"]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{confirmCallback:this.confirmCallbackHandler,handler:this,icon:"itemicon200"+e.CODE,iconBg:"itembg_7",num:this._itemNum,msg:a,id:this._data.needItem,useNum:this._needNum})}else{var a=LanguageManager.getlocal("acFourPeoplea_de"+e.CODE,[App.StringUtil.toString(this._needNum),"11"]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{confirmCallback:this.confirmCallbackHandler2,handler:this,icon:"itemicon200"+e.CODE,iconBg:"itembg_7",num:this._itemNum,msg:a,id:this._data.needItem,useNum:this._needNum})}},e.prototype.confirmCallbackHandler=function(){NetManager.request(NetRequestConst.REQUEST_ACTIVITY_EXCHANGEFOURPEOPLE,{activeId:"fourPeople-"+e.CODE,rkey:this.currNum})},e.prototype.confirmCallbackHandler2=function(){App.CommonUtil.showTip(LanguageManager.getlocal("acFourPeoplea_token"+e.CODE))},e.prototype.showBg=function(t){void 0===t&&(t=0);var i;if("1"==e.CODE){var a=t+1;i=BaseBitmap.create("fourpeople_bg_"+a)}else"2"==e.CODE&&(i=BaseBitmap.create("forpeople_bg2"));this.addChild(i)},e.prototype.getSpaceY=function(){return 10},e.prototype.getSpaceX=function(){return 0},e.prototype.dispose=function(){this._fourPeopleNameText=null,this._fourPeopleLvText=null,this._itemNumberText=null,this.itemBitmap=null,this._servantId=0,this._itemNum=0,this._needNum=0,this._curr_index=0,this._achRedDotSp=null,this.bottomName=null,this.currNum=0,t.prototype.dispose.call(this)},e.CODE="1",e}(ScrollListItem);__reflect(AcFourPeopleScrollItem.prototype,"AcFourPeopleScrollItem");var AcFourPeopleView=function(t){function e(){var e=t.call(this)||this;return e._scrollList=null,e._fourPeopleInfoVoList=null,e._activityTimerText=null,e._acCDTxt=null,e._ruleText=null,e._inOrderText=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["forpeople_bottom","forpeople_qualifications","forpeople_top","fourpeople_bg_1","fourpeople_bg_2","fourpeople_bg_3","fourpeople_bg_4","servant_star","achievement_state3","recharge_fnt","fourfloor","fourpecialaura","fourpeople_mask","fourpeople_bottom","forpeople_bg2"])},e.prototype.initView=function(){var t=new egret.Shape;t.graphics.beginFill(0),t.graphics.drawRect(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-180),t.graphics.endFill(),t.y=180,this.addChildToContainer(t),this.showText(),this.showList(),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_EXCHANGEFOURPEOPLE),this.useCallback,this);var e=this.acVo.et-GameData.serverTime;this._acCDTxt&&e>0?this._acCDTxt.text=LanguageManager.getlocal("acFourPeople_acCD",[App.DateUtil.getFormatBySecond(e,1)]):this._acCDTxt.text=LanguageManager.getlocal("acFourPeople_acCD",[LanguageManager.getlocal("acFourPeoplea_acCDEnd")])},e.prototype.showText=function(){var t=BaseBitmap.create("forpeople_top");this.addChildToContainer(t),t.y=85,this._activityTimerText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._activityTimerText.x=30,this._activityTimerText.y=109,this._activityTimerText.text=this.acVo.getAcLocalTime(!0),this.addChildToContainer(this._activityTimerText);var e=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);e.text=LanguageManager.getlocal("acFourPeople_acCD",[""]),e.x=this._activityTimerText.x,e.y=this._activityTimerText.y+33,this.addChildToContainer(e),this._acCDTxt=e,this._ruleText=ComponentManager.getTextField(Api.playerVoApi.getPlayerGem().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._ruleText.x=30,this._ruleText.y=this._acCDTxt.y+33,this._ruleText.text=LanguageManager.getlocal("acFourPeopleRule"+this.code),this.addChildToContainer(this._ruleText),this._inOrderText=ComponentManager.getTextField(LanguageManager.getlocal("acFourPeopleInOrder"+this.code),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._inOrderText.x=30,this._inOrderText.y=this._ruleText.y+33,this.addChildToContainer(this._inOrderText)},e.prototype.addChildToContainer=function(t){t&&(this.container.addChild(t),this.container.y=0)},e.prototype.showList=function(){this._fourPeopleInfoVoList=[];var t=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code);this._fourPeopleInfoVoList=t.getPeopleList(),AcFourPeopleScrollItem.CODE=this.code,this._scrollList=null;var e=egret.Rectangle.create();e.setTo(0,0,640,GameConfig.stageHeigth-260),this._scrollList=ComponentManager.getScrollList(AcFourPeopleScrollItem,this._fourPeopleInfoVoList,e),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(0,250)},e.prototype.tick=function(){var t=this.acVo.et-GameData.serverTime;return this._acCDTxt&&t>0?(this._acCDTxt.text=LanguageManager.getlocal("acFourPeople_acCD",[App.DateUtil.getFormatBySecond(t,1)]),!0):(this._acCDTxt.text=LanguageManager.getlocal("acFourPeople_acCD",[LanguageManager.getlocal("acFourPeoplea_acCDEnd")]),!1)},e.prototype.useCallback=function(t){if(1==t.data.ret){var e=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code),i=e.getPeopleList();this._scrollList.refreshData(i)}},e.prototype.getSheepType=function(){return 1},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_EXCHANGEFOURPEOPLE),this.useCallback,this),this._scrollList=null,this._activityTimerText=null,this._acCDTxt=null,this._inOrderText=null,this._ruleText=null,this._fourPeopleInfoVoList=null,t.prototype.dispose.call(this)},e}(AcCommonView);__reflect(AcFourPeopleView.prototype,"AcFourPeopleView");var AcLimitedRewardDetailPopupView=function(t){function e(){var e=t.call(this)||this;return e._aid="",e._code="",e._limitedRewardInfoVoList=[],e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_ACTIVITY_LIMITEDREWARD,this.clickItemHandler,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETLIMITEDREWARD),this.useCallback,this);var t=Api.acVoApi.getActivityVoByAidAndCode(this._aid,this._code);if(this._limitedRewardInfoVoList=t.getLimitedRewardInfoVoList(),this._limitedRewardInfoVoList&&this._limitedRewardInfoVoList.length>0){var e=t.getShowNum();this._limitedRewardInfoVoList.splice(e,this._limitedRewardInfoVoList.length-e)}var i=ComponentManager.getTextField(LanguageManager.getlocal("rewardGradeTitle"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_BLACK);i.x=20,i.y=10,this.addChildToContainer(i);var a=this.viewBg.width-40,n=this.getShowHeight()-180,o=BaseBitmap.create("public_9_probiginnerbg");o.width=a,o.height=n,o.x=20,o.y=i.y+i.height+10,this.addChildToContainer(o);var s=egret.Rectangle.create();s.setTo(0,0,a-10,n-20),this._scrollList=ComponentManager.getScrollList(AcLimitedRewardDetailScrollItem,this._limitedRewardInfoVoList,s),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(25,o.y+10);var r=t.getMaxGrade(),l=this._limitedRewardInfoVoList.length;r=r+2>l?r-2:r,r=0>=r?0:r,this._scrollList.setScrollTopByIndex(r)},e.prototype.useCallback=function(t){var e=this._scrollList.getItemByIndex(this._index);if(e){Api.acVoApi.getActivityVoByAidAndCode(this._aid,this._code);e.updateButtonState()}},e.prototype.clickItemHandler=function(t){this._index=Number(t.data.index);var e=Number(t.data.rkey);NetManager.request(NetRequestConst.REQUEST_ACTIVITY_GETLIMITEDREWARD,{activeId:this._aid+"-"+this._code,rkey:e})},e.prototype.getRequestData=function(){return this._aid=String(this.param.data.aid),this._code=String(this.param.data.code),""==this._aid||""==this._code?null:{requestType:NetRequestConst.REQUEST_ACTIVITY_GETACTIVECFG,requestData:{activeId:this._aid+"-"+this._code}}},e.prototype.getTitleStr=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(this._aid,this._code);return"ac"+App.StringUtil.firstCharToUper(this._aid+"-"+t.atype)+"_Title"},e.prototype.getShowHeight=function(){return 750},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_ACTIVITY_LIMITEDREWARD,this.clickItemHandler,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETLIMITEDREWARD),this.useCallback,this),this._aid=null,this._code=null,this._scrollList=null,this._limitedRewardInfoVoList=null,this._index=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AcLimitedRewardDetailPopupView.prototype,"AcLimitedRewardDetailPopupView");var AcLimitedRewardDetailScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this._limitedRewardInfoVo=e;var i=Api.acVoApi.getActivityVoByAidAndCode(this._limitedRewardInfoVo.aid,this._limitedRewardInfoVo.code.toString()),a=i.getFlagByIdAndCondition(this._limitedRewardInfoVo.id,this._limitedRewardInfoVo.condition),n=520;this._selectedIndex=t;var o=BaseBitmap.create("public_9_bg14");o.width=n,o.height=148,this.addChild(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("rewardGradeNum",[this._limitedRewardInfoVo.id.toString()]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);s.x=20,s.y=15,this.addChild(s);var r="("+App.StringUtil.changeIntToText(i.v)+"/"+App.StringUtil.changeIntToText(this._limitedRewardInfoVo.condition)+")",l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),h="limitedCondition2";2==a&&(h="limitedCondition"),l.text=LanguageManager.getlocal(h,[this._limitedRewardInfoVo.getTitleStr,r]),l.x=n-l.width-20,l.y=16,this.addChild(l);var d=BaseBitmap.create("public_line1");d.x=n/2-d.width/2,d.y=s.y+s.height+5,this.addChild(d);var g=GameData.formatRewardItem(this._limitedRewardInfoVo.reward);if(this._rewardList=g,g)for(var c=.7,p=0;p<g.length;p++){var _=GameData.getItemIcon(g[p],!0);_.x=10+7*(p+1)+_.width*c*p,_.y=d.y+13,_.scaleX=_.scaleY=c,this.addChild(_)}if(1==a){var u=BaseBitmap.create("signin_had_get");u.x=n-85-u.width/2,u.y=o.y+o.height/2-u.height/2+18,this.addChild(u)}else{var C=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskCollect",this.clickGetBtnHandler,this);C.x=n-85-C.width/2,C.y=o.y+o.height/2-C.height/2+18,this.addChild(C),this._getBtn=C,2==a&&C.setEnable(!1)}},e.prototype.updateButtonState=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(this._limitedRewardInfoVo.aid,this._limitedRewardInfoVo.code.toString()),e=t.getFlagByIdAndCondition(this._limitedRewardInfoVo.id,this._limitedRewardInfoVo.condition);if(1==e&&this._getBtn){this._getBtn.visible=!1;var i=BaseBitmap.create("signin_had_get");i.x=this._getBtn.x+this._getBtn.width/2-i.width/2,i.y=this._getBtn.y+this._getBtn.height/2-i.height/2,this.addChild(i)}if(this._rewardList){var a=this._getBtn.localToGlobal(this._getBtn.width/2,this._getBtn.height/2),n=new egret.Point(a.x+55,a.y-30);App.CommonUtil.playRewardFlyAction(this._rewardList,n)}},e.prototype.clickGetBtnHandler=function(t){Api.acVoApi.checkActivityStartByAid(this._limitedRewardInfoVo.aid)?App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_ACTIVITY_LIMITEDREWARD,{rkey:this._limitedRewardInfoVo.id,index:this._selectedIndex}):App.CommonUtil.showTip(LanguageManager.getlocal("composeLimitTimeEndDesc"))},e.prototype.getSpaceX=function(){return 0},e.prototype.update=function(){},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){this._limitedRewardInfoVo=null,this._selectedIndex=null,this._getBtn=null,this._rewardList=null,t.prototype.dispose.call(this)
},e}(ScrollListItem);__reflect(AcLimitedRewardDetailScrollItem.prototype,"AcLimitedRewardDetailScrollItem");var AcLimitedRewardScrollItem=function(t){function e(){var e=t.call(this)||this;return e._limitedRewardVo=null,e._selectedIndex=0,e._lastRed=null,e._acCDTxt=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){this._limitedRewardVo=e;var i=618,a=148,n=150;this._selectedIndex=t;var o=BaseBitmap.create("public_9_bg14");o.width=i,o.height=148,o.x=2,this.addChild(o);var s=BaseBitmap.create("common_titlebg");s.x=70,s.y=19,this.addChild(s);var r=BaseBitmap.create("progress6_bg");r.x=10,r.y=a/2-r.height/2,this.addChild(r);var l=BaseLoadBitmap.create(this._limitedRewardVo.icon);l.x=r.x+r.width/2-44,l.y=r.y+r.height/2-44,this.addChild(l);var h=ComponentManager.getTextField(LanguageManager.getlocal("limitedTitle",[this._limitedRewardVo.getTitleStr]),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);h.x=n,h.y=s.y+s.height/2-h.height/2,this.addChild(h);var d=ComponentManager.getTextField(App.StringUtil.formatStringColor(this._limitedRewardVo.acTimeAndHour,TextFieldConst.COLOR_WARN_RED),TextFieldConst.FONTSIZE_CONTENT_SMALL);d.x=n,d.y=h.y+h.height+20,this.addChild(d),this._acCDTxt=ComponentManager.getTextField(this._limitedRewardVo.acLocalCountDown,TextFieldConst.FONTSIZE_CONTENT_SMALL),this._acCDTxt.x=n,this._acCDTxt.y=d.y+d.height+10,this.addChild(this._acCDTxt);var g=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"openActivityTitle",this.clickItemHandler,this);g.x=i-g.width-15,g.y=a/2-g.height/2,this.addChild(g),this._openBtn=g,this.checkBtnState(),egret.startTick(this.tick,this)},e.prototype.tick=function(t){return this._acCDTxt.text=this._limitedRewardVo.acLocalCountDown,!1},e.prototype.clickItemHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.ACLIMITEDREWARDDETAILPOPUPVIEW,{aid:this._limitedRewardVo.aid,code:this._limitedRewardVo.code})},e.prototype.checkBtnState=function(){var t=this._limitedRewardVo.red;(null==this._lastRed||this._lastRed!=t)&&(this._lastRed=t,1==t?this._openBtn.showStatusIcon("public_dot2"):this._openBtn.removeStatusIcon())},e.prototype.getSpaceY=function(){return 10},e.prototype.getSpaceX=function(){return 0},e.prototype.dispose=function(){egret.stopTick(this.tick,this),this._limitedRewardVo=null,this._selectedIndex=0,this._openBtn=null,this._lastRed=null,this._acCDTxt=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AcLimitedRewardScrollItem.prototype,"AcLimitedRewardScrollItem");var AcLimitedRewardView=function(t){function e(){var e=t.call(this)||this;return e._activeCfgList=[],e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETLIMITEDREWARD),this.useCallback,this),this._activeCfgList=Api.acVoApi.getActivityVoListByAid(this.aid);var t=GameConfig.stageWidth-10,e=GameConfig.stageHeigth-160,i=ComponentManager.getTextField(LanguageManager.getlocal("limitedRewardDesc"),TextFieldConst.FONTSIZE_TITLE_SMALL);i.x=GameConfig.stageWidth/2-i.width/2,i.y=5,this.addChildToContainer(i);var a=BaseBitmap.create("public_9_probiginnerbg");a.width=t,a.height=e,a.x=5,a.y=i.y+i.height+15,this.addChildToContainer(a);var n=egret.Rectangle.create();n.setTo(0,0,t-10,e-10),this._scrollList=ComponentManager.getScrollList(AcLimitedRewardScrollItem,this._activeCfgList,n),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(10,a.y+10)},e.prototype.getTitleStr=function(){return"ac"+App.StringUtil.firstCharToUper(this.aid)+"_Title"},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["progress6_bg","dinner_rankbg","dinnerrankpopupview","dinner_rank_titlebg","achievement_state3","common_titlebg","signin_had_get"])},e.prototype.useCallback=function(t){for(var e=0;e<this._activeCfgList.length;e++){var i=this._scrollList.getItemByIndex(e);i&&i.checkBtnState()}},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETLIMITEDREWARD),this.useCallback,this),this._scrollList=null,this._activeCfgList=null,t.prototype.dispose.call(this)},e}(AcCommonView);__reflect(AcLimitedRewardView.prototype,"AcLimitedRewardView");var AcMayDay2ScrollItem=function(t){function e(){var e=t.call(this)||this;return e._itemData=void 0,e._curIdx=0,e._rechargeItem=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.AcCfg.getCfgByActivityIdAndCode(AcMayDayView.AID,AcMayDayView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vo",{get:function(){return Api.acVoApi.getActivityVoByAidAndCode(AcMayDayView.AID,AcMayDayView.CODE)},enumerable:!0,configurable:!0}),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETMAYDAYITEMB),this.eventCollectHandlerCallBack,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_MAYDAY_FRESH_ITEM,this.refreshBtnStatus,this),this._itemData=e,this._curIdx=t;var i=Config.AcCfg.getCfgByActivityIdAndCode(AcMayDayView.AID,AcMayDayView.CODE);i.recharge;this._rechargeItem=i.getChargeRewardById(this._itemData);var a=BaseBitmap.create("public_9_bg14");a.width=598,a.height=246,this.addChild(a),this._detailBgImg=BaseBitmap.create("accarnivalview_tab_red"),this._detailBgImg.y=5,this._detailBgImg.x=2,this.addChild(this._detailBgImg);var n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);n.text=LanguageManager.getlocal("acMayDayTotal_recharge",[String(this._rechargeItem.needGem)]),n.x=this._detailBgImg.x+20,n.y=this._detailBgImg.y+10,this.addChild(n);for(var o=GameData.formatRewardItem(this._rechargeItem.getReward),s=60,r=14,t=0;t<o.length;t++){var l=GameData.getItemIcon(o[t],!0,!0);l.x=r,l.y=s,r+=l.width+7,r>a.width-8&&(r=14,s+=l.height+10,l.x=r,l.y=s,r+=l.width+7),this.addChild(l)}s+=130,a.height=s+60,this.height=a.height,this._progress=ComponentManager.getProgressBar("progress5","progress3_bg",386),this._progress.x=20,this._progress.y=s,this.addChild(this._progress),this.refreshBtnStatus()},e.prototype.refreshBtnStatus=function(){var t=this.vo;if(t){var i=t.getChargeNum();if(this._progress.setText(LanguageManager.getlocal("acCarnivalProgressText",[String(i),this._rechargeItem.needGem])),this._progress.setPercentage(i/this._rechargeItem.needGem),this._collectFlag&&this.removeChild(this._collectFlag),this._collectFlag=null,this._collectBtn&&this.removeChild(this._collectBtn),this._collectBtn=null,this._chargeBtn&&this.removeChild(this._chargeBtn),this._chargeBtn=null,i>=this._rechargeItem.needGem?this._detailBgImg.texture=ResourceManager.getRes("accarnivalview_tab_green"):this._detailBgImg.texture=ResourceManager.getRes("accarnivalview_tab_red"),t.isGetRecharge(this._curIdx+1)&&e._lastReqIdx!=this._curIdx)this.createCollectFlag();else if(i>=this._rechargeItem.needGem){var a=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"ac_recharge_Btntxt2",this.eventCollectHandler,this);a.x=this._progress.x+this._progress.width+20,a.y=this._progress.y+this._progress.height/2-a.height/2,a.name="collectBtn",this.addChild(a),this._collectBtn=a}else{var n=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"acCarnivalToChargeBtnText",this.goRechargeHandler,this);n.x=this._progress.x+this._progress.width+20,n.y=this._progress.y+this._progress.height/2-n.height/2,n.name="costBtn",this.addChild(n),this._chargeBtn=n}}},e.prototype.refreshUI=function(){this.getChildByName("collectBtn")&&(this.getChildByName("collectBtn").visible=!1),this.createCollectFlag(),this._collectFlag.visible=!1,this._collectFlag.setScale(1.3),this._collectFlag.visible=!0,egret.Tween.get(this._collectFlag).to({scaleX:.7,scaleY:.7},300)},e.prototype.createCollectFlag=function(){this._collectFlag=BaseBitmap.create("collectflag"),this._collectFlag.anchorOffsetX=this._collectFlag.width/2,this._collectFlag.anchorOffsetY=this._collectFlag.height/2,this._collectFlag.setScale(.7),this._collectFlag.x=this._progress.x+this._progress.width+100,this._collectFlag.y=this._progress.y+this._progress.height/2-10,this.addChild(this._collectFlag)},e.prototype.eventCollectHandlerCallBack=function(t){var i=t.data.data.data;if(!i)return void App.CommonUtil.showTip(LanguageManager.getlocal("collect_error"));if(e._lastReqIdx==this._curIdx){e._lastReqIdx=null,this.refreshUI();var a=i.rewards,n=GameData.formatRewardItem(a),o=e._lastPos;App.CommonUtil.playRewardFlyAction(n,o)}},Object.defineProperty(e.prototype,"acTivityId",{get:function(){return AcMayDayView.AID+"-"+AcMayDayView.CODE},enumerable:!0,configurable:!0}),e.prototype.eventCollectHandler=function(t){return this.vo.et<GameData.serverTime?void App.CommonUtil.showTip(LanguageManager.getlocal("collect_error")):(e._lastReqIdx=this._curIdx,e._lastPos=this._progress.localToGlobal(this._progress.width+50,20),void NetManager.request(NetRequestConst.REQUEST_ACTIVITY_GETMAYDAYITEMB,{activeId:this.acTivityId,rechargeId:this._curIdx+1}))},e.prototype.goRechargeHandler=function(t){return this.vo.et<GameData.serverTime?void App.CommonUtil.showTip(LanguageManager.getlocal("collect_error")):void ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.getSpaceX=function(){return 10},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETMAYDAYITEMB),this.eventCollectHandlerCallBack,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_MAYDAY_FRESH_ITEM,this.refreshBtnStatus,this),this._itemData=null,this._collectFlag=null,this._progress=null,this._collectBtn=null,this._chargeBtn=null,this._curIdx=0,this._rechargeItem=null,t.prototype.dispose.call(this)},e._lastReqIdx=null,e._lastPos=null,e}(ScrollListItem);__reflect(AcMayDay2ScrollItem.prototype,"AcMayDay2ScrollItem");var AcMayDay3ScrollItem=function(t){function e(){var e=t.call(this)||this;return e._data=null,e._goBtn2=null,e._goBtn3=null,e._needTxt=null,e._collectflag=null,e._curIdx=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.AcCfg.getCfgByActivityIdAndCode(AcMayDayView.AID,AcMayDayView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vo",{get:function(){return Api.acVoApi.getActivityVoByAidAndCode(AcMayDayView.AID,AcMayDayView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"acTivityId",{get:function(){return AcMayDayView.AID+"-"+AcMayDayView.CODE},enumerable:!0,configurable:!0}),e.prototype.initItem=function(t,e){this._data=e,this._curIdx=t,App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETMAYDAYITEMC),this.eventCollectHandlerCallBack,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_MAYDAY_FRESH_ITEM,this.update,this);var i=BaseBitmap.create("public_9_bg14");i.width=598,i.height=170,this.addChild(i);var a=BaseBitmap.create("activity_charge_red");this.addChild(a);var n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);1==e.questType?n.text=LanguageManager.getlocal("acSpringceleBrationLand1",[e.value+""]):2==e.questType?n.text=LanguageManager.getlocal("acSpringceleBrationquestType2",[e.value+""]):n.text=LanguageManager.getlocal("acSpringceleBrationquestType"+e.questType,[e.value+""]),n.width=a.width,n.x=a.x+20,n.y=a.y+10,this.addChild(n);var o=GameData.getRewardItemIcons(e.getReward,!0);if(o&&o.length>0)for(var s=20,r=50,l=o.length,h=0;l>h;h++){var d=o[h];d.setPosition(s+h*(d.width*d.scaleX+12),r),this.addChild(d)}this._goBtn3=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"taskGoBtn",this.collectHandler,this),this._goBtn3.x=420,this._goBtn3.y=60,this.addChild(this._goBtn3),this._goBtn2=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"taskGoBtn",this.collectHandler,this),this._goBtn2.x=420,this._goBtn2.y=60,this._goBtn2.visible=!1,this.addChild(this._goBtn2);var g=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_BROWN);g.text=LanguageManager.getlocal("springcelebrationNeedStr",["1",e.value+""]),g.width=this._goBtn3.width,g.x=this._goBtn3.x,g.y=this._goBtn3.y-30,g.textAlign="center",this._needTxt=g,this.addChild(g),1==e.questType&&(g.text=LanguageManager.getlocal("springcelebrationNeedStr",["1",e.value+""]));var c=BaseBitmap.create("collectflag");c.x=450,c.y=50,c.scaleX=.7,c.scaleY=.7,c.visible=!1,this.addChild(c),this._collectflag=c,this.update()},e.prototype.collectHandler=function(t){var i=this.vo;if(i){var a=i.getTask(this._data.questType);if(this.vo.et<GameData.serverTime)return void App.CommonUtil.showTip(LanguageManager.getlocal("collect_error"));if(a>=this._data.value)e._lastReqIdx=this._curIdx,e._lastPos=this._needTxt.localToGlobal(this._needTxt.width,20),NetManager.request(NetRequestConst.REQUEST_ACTIVITY_GETMAYDAYITEMC,{activeId:this.acTivityId,taskId:""+this._data.key});else{if(2==this._data.questType)return void ViewController.getInstance().openView(ViewConst.COMMON.SHOPVIEW_TAB1);if(!this._data.openType)return;var n=this._data.openType,o=App.StringUtil.firstCharToUper(n);if(""==n)ViewController.getInstance().openView(ViewConst.COMMON.PROMOTIONVIEW);else{if(Api[n+"VoApi"]&&Api[n+"VoApi"].isShowNpc){var s=Api[n+"VoApi"].isShowNpc();if(!s){var r=Api[n+"VoApi"].getLockedString?Api[n+"VoApi"].getLockedString():LanguageManager.getlocal("dailyTask_"+n+"Tip");return void App.CommonUtil.showTip(r?r:LanguageManager.getlocal("sysWaitOpen"))}}egret.getDefinitionByName(o+"View")?ViewController.getInstance().openView(o+"View"):egret.getDefinitionByName(o+"PopupView")?ViewController.getInstance().openView(o+"PopupView"):"recharge"==n&&ViewController.getInstance().openView(o+"VipView")}}}},e.prototype.eventCollectHandlerCallBack=function(t){var i=t.data.data.data;if(!i)return void App.CommonUtil.showTip(LanguageManager.getlocal("collect_error"));if(e._lastReqIdx==this._curIdx){e._lastReqIdx=null,this.update();var a=i.rewards,n=GameData.formatRewardItem(a),o=e._lastPos;App.CommonUtil.playRewardFlyAction(n,o)}},e.prototype.update=function(){var t=this.vo;if(t){if(this._needTxt){var e=t.getTask(this._data.questType);e>=this._data.value?this._needTxt.text=LanguageManager.getlocal("springcelebrationNeedStr",[e+"",this._data.value+""]):this._needTxt.text=LanguageManager.getlocal("springcelebrationNeedStr2",[e+"",this._data.value+""])}this._goBtn3&&(e>=this._data.value?t.isGetTaskReward(this._data.key)?(this._goBtn3.visible=!1,this._needTxt.visible=!1,this._collectflag.visible=!0,this._goBtn2.visible=!1):(this._goBtn2.visible=!1,this._goBtn3.visible=!0,this._goBtn3.setText("realnamedes6"),App.DisplayUtil.changeToNormal(this._goBtn3)):1==this._data.questType?(this._goBtn3.visible=!0,this._goBtn3.setText("realnamedes6"),App.DisplayUtil.changeToGray(this._goBtn3)):(this._goBtn3.visible=!1,this._goBtn2.visible=!0))}},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._goBtn3=null,this._collectflag=null,this._data=null,this._goBtn2=null,this._needTxt=null,App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETMAYDAYITEMC),this.eventCollectHandlerCallBack,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_MAYDAY_FRESH_ITEM,this.update,this),t.prototype.dispose.call(this)},e._lastReqIdx=null,e._lastPos=null,e}(ScrollListItem);__reflect(AcMayDay3ScrollItem.prototype,"AcMayDay3ScrollItem");var AcMayDayRankPopupView=function(t){function e(){var e=t.call(this)||this;return e._topBg=null,e._curTabIdx=0,e._acCDTxt=null,e._acVo=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.AcCfg.getCfgByActivityIdAndCode(AcMayDayView.AID,AcMayDayView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vo",{get:function(){return Api.acVoApi.getActivityVoByAidAndCode(AcMayDayView.AID,AcMayDayView.CODE)},enumerable:!0,configurable:!0}),e.prototype.initView=function(){var t=["acPunishRankRewardPopupViewTitle","acPunishRankTab1"],e=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,t,this.tabBtnClickHandler,this);e.x=35,e.y=15,this.addChildToContainer(e);var i=BaseBitmap.create("public_9_probiginnerbg");i.width=518,i.height=520,i.x=this.viewBg.x+this.viewBg.width/2-i.width/2,i.y=60,this.addChildToContainer(i);var a=BaseBitmap.create("public_9_probiginnerbg");a.width=518,a.height=84,a.x=this.viewBg.x+this.viewBg.width/2-a.width/2,a.y=i.y+i.height+5,this.addChildToContainer(a);var n="10000+",o=0;this._acData.myrankArr.myrank&&(n=String(this._acData.myrankArr.myrank),o=this._acData.myrankArr.value);var s=LanguageManager.getlocal("acPunishMyrank1",[n]);this._myRankTF=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._myRankTF.textAlign=egret.HorizontalAlign.LEFT,this._myRankTF.x=a.x+60,this._myRankTF.y=a.y+15,this.addChildToContainer(this._myRankTF),this._acCDTxt=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._acCDTxt.x=a.x+280,this._acCDTxt.y=a.y+15,this.addChildToContainer(this._acCDTxt);var r=(this.cfg,this._acVo.et-GameData.serverTime-86400);this._acCDTxt&&r>0?this._acCDTxt.text=LanguageManager.getlocal("acFourPeople_acCD",[App.DateUtil.getFormatBySecond(r,1)]):this._acCDTxt.text=LanguageManager.getlocal("acFourPeople_acCD",[LanguageManager.getlocal("acFourPeoplea_acCDEnd")]),this._sendDesc=ComponentManager.getTextField(LanguageManager.getlocal("acRanktip"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._sendDesc.x=130.5+a.x,this._sendDesc.y=a.y+50,this.addChildToContainer(this._sendDesc);for(var l=new Array,h=this.cfg,d=0;d<h.rankReward.length;d++)l.push(h.rankReward[d.toString()]);var g=egret.Rectangle.create();g.setTo(0,0,508,i.height-20),this._scrollList=ComponentManager.getScrollList(AcMayDayRankRewardScrollItem,l,g),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(i.x+5,i.y+10),this._scrollList.setEmptyTip(LanguageManager.getlocal("acPunishNoData"));var c=BaseLoadBitmap.create("public_9_bg24");c.width=i.width,c.height=40,c.x=i.x,c.y=i.y,this.addChildToContainer(c),this._topBg=c,this._topBg.visible=!1,this._titleTxt1=ComponentManager.getTextField(LanguageManager.getlocal("acRankPop_title1"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW),this._titleTxt1.x=i.x+40,this._titleTxt1.y=i.y+8,this.addChildToContainer(this._titleTxt1),this._titleTF=ComponentManager.getTextField(LanguageManager.getlocal("acRankPop_title2"),this._titleTxt1.size,TextFieldConst.COLOR_LIGHT_YELLOW),this._titleTF.x=i.x+175,this._titleTF.y=this._titleTxt1.y,this.addChildToContainer(this._titleTF),this._titleTxt3=ComponentManager.getTextField(LanguageManager.getlocal("acMayDayRankCishu"),this._titleTxt1.size,TextFieldConst.COLOR_LIGHT_YELLOW),this._titleTxt3.x=i.x+430-this._titleTxt3.width/2,this._titleTxt3.y=this._titleTxt1.y,this.addChildToContainer(this._titleTxt3),this._titleTxt3.visible=this._titleTxt1.visible=this._titleTF.visible=!1,this._nickNameTF=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._nickNameTF.text=LanguageManager.getlocal("acRank_mynick")+Api.playerVoApi.getPlayerName(),this._nickNameTF.x=a.x+66,this._nickNameTF.y=a.y+10,this._nickNameTF.visible=!1,this.addChildToContainer(this._nickNameTF),this._scoreTF=ComponentManager.getTextField("",this._nickNameTF.size,TextFieldConst.COLOR_LIGHT_YELLOW),this._scoreTF.text=LanguageManager.getlocal("acMayDayMYRankNum",[this.vo.getTurnTotal().toString()]),this._scoreTF.x=this._nickNameTF.x+214,this._scoreTF.y=this._nickNameTF.y+22+20,this._scoreTF.visible=!1,this.addChildToContainer(this._scoreTF),this._sendTip=ComponentManager.getTextField(LanguageManager.getlocal("acMayDayRankPopupViewTip",[this.cfg.rankNeedNum.toString()]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._sendTip.x=this._nickNameTF.x+214,this._sendTip.y=this._nickNameTF.y,this._sendTip.visible=!1,this.addChildToContainer(this._sendTip);var p=[];if(this._acData.rankArr)for(var _ in this._acData.rankArr)p.push(this._acData.rankArr[_]);var u=egret.Rectangle.create();u.setTo(0,0,508,i.height-60),this._scrollList2=ComponentManager.getScrollList(AcMayDayRankScrollItem,p,u),this.addChildToContainer(this._scrollList2),this._scrollList2.setPosition(i.x+5,i.y+50),this._scrollList2.setEmptyTip(LanguageManager.getlocal("acPunishNoData")),this._scrollList2.visible=!1},e.prototype.tick=function(){var t=(this.cfg,this._acVo.et-GameData.serverTime-86400);return this._acCDTxt&&t>0?(this._acCDTxt.text=LanguageManager.getlocal("acFourPeople_acCD",[App.DateUtil.getFormatBySecond(t,1)]),!0):(this._acCDTxt.text=LanguageManager.getlocal("acFourPeople_acCD",[LanguageManager.getlocal("acFourPeoplea_acCDEnd")]),!1)},e.prototype.tabBtnClickHandler=function(t){this._curTabIdx=t.index,this.refreshRankList()},e.prototype.refreshRankList=function(){this._acCDTxt.visible=this._sendDesc.visible=this._scrollList.visible=0==this._curTabIdx,this._topBg.visible=this._titleTxt3.visible=this._titleTxt1.visible=this._titleTF.visible=this._nickNameTF.visible=this._sendTip.visible=this._scoreTF.visible=this._scrollList2.visible=!this._scrollList.visible,this._myRankTF.y=this._nickNameTF.y+(0==this._curTabIdx?5:42)},Object.defineProperty(e.prototype,"acTivityId",{get:function(){return AcMayDayView.AID+"-"+AcMayDayView.CODE},enumerable:!0,configurable:!0}),e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_ACTIVITY_GETMAYDAYRANK,requestData:{activeId:this.acTivityId}}},e.prototype.receiveData=function(t){t.data.cmd==NetRequestConst.REQUEST_ACTIVITY_GETMAYDAYRANK&&(this._acData=t.data.data,this._acVo=Api.acVoApi.getActivityVoByAidAndCode(e.aid,e.code))},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.dispose=function(){this._sendDesc=this._sendDesc=null,this._scrollList=null,this._scrollList2=null,this._myRankTF=null,this._nickNameTF=this._acCDTxt=null,this._selectChildData=null,this._acVo=null,this._sendTip=null,this._sendDesc=null,this._scoreTF=null,this._titleTxt1=null,this._titleTF=null,this._titleTxt3=null,t.prototype.dispose.call(this)},e.aid="",e.code="",e}(PopupView);__reflect(AcMayDayRankPopupView.prototype,"AcMayDayRankPopupView");var AcMayDayRankRewardScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this._cfgData=e,this._itemIndex=t,this.width=508;var i=e.rank[0],a=GameData.formatRewardItem(e.getReward);if(a)for(var n=.85,o=0;o<a.length;o++){var s=GameData.getItemIcon(a[o],!0,!0),r=o%4;s.x=110+7*(r+1)+s.width*n*r,s.y=(s.height+5)*Math.floor(o/4)+15,a.length<=4&&(s.y=(s.height+5)*Math.floor(o/4)+25),s.scaleX=s.scaleY=n,this.addChild(s)}this.height=.85*this.height;var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);Number(i)<4?l.text=LanguageManager.getlocal("acRank_rank"+i):l.text=l.text=LanguageManager.getlocal("acRank_rank5",[String(e.rank[0]),String(e.rank[1])]),l.x=20,l.y=this.height/2-l.height/2-7,a.length<=4&&(l.y=l.y+10),this.addChild(l);var h=BaseBitmap.create("public_line1");h.x=this.width/2-h.width/2,h.y=this.height+0,this.addChild(h)},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){this._itemIndex=null,this._key=null,this._wifeInfoVo=null,this._att1TF=null,this._att2TF=null,this._att3TF=null,this._skillLevelTF=null,this._updBtn=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AcMayDayRankRewardScrollItem.prototype,"AcMayDayRankRewardScrollItem");var AcMayDayRankScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.height=58,this._nodeContainer=new BaseDisplayObjectContainer,this.addChild(this._nodeContainer);var i=16;if(t>2){var a=ComponentManager.getTextField("",20,TextFieldConst.COLOR_BROWN);a.text=String(t+1),a.x=90-a.width/2-30,a.y=i,this._nodeContainer.addChild(a),e.uid==Api.playerVoApi.getPlayerID()&&(a.textColor=TextFieldConst.COLOR_WARN_YELLOW)}else{var n=BaseLoadBitmap.create("rank_"+String(t+1));n.width=51,n.height=47,n.x=90-n.width/2-30,n.y=3,this.addChild(n)}var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);o.text=e.name,o.x=245-o.width/2-30,o.y=i,this._nodeContainer.addChild(o);var s=ComponentManager.getTextField("",o.size,TextFieldConst.COLOR_WHITE);s.text=String(e.value),s.x=460-s.width/2-30,s.y=i,this._nodeContainer.addChild(s),(e.uid==Api.playerVoApi.getPlayerID()||e.id==Api.playerVoApi.getPlayerAllianceId())&&(o.textColor=TextFieldConst.COLOR_WARN_YELLOW,s.textColor=TextFieldConst.COLOR_WARN_YELLOW);var r=BaseLoadBitmap.create("rank_line");r.width=500,r.height=2,r.x=30,r.y=50,this._nodeContainer.addChild(r)},e.prototype.getSpaceX=function(){return 0},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){this._nodeContainer=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AcMayDayRankScrollItem.prototype,"AcMayDayRankScrollItem");var AcMayDayRewardPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.AcCfg.getCfgByActivityIdAndCode(AcMayDayView.AID,AcMayDayView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vo",{get:function(){return Api.acVoApi.getActivityVoByAidAndCode(AcMayDayView.AID,AcMayDayView.CODE)},enumerable:!0,configurable:!0}),e.prototype.initView=function(){var t=(this.param.data.aid,this.param.data.code,this.cfg,this.param.data),e=BaseBitmap.create("tailor_get_light");e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=GameConfig.stageWidth/2,e.y=40+e.height/2,egret.Tween.get(e,{loop:!0}).to({rotation:360},5e3),this.addChild(e);var i=BaseBitmap.create("tailor_get_light");i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.x=e.x,i.y=e.y,egret.Tween.get(i,{loop:!0}).to({rotation:-360},5e3),this.addChild(i);var a=BaseBitmap.create("tailor_get_wordbg");a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,a.x=GameConfig.stageWidth/2,a.y=e.y,a.setScale(0),egret.Tween.get(a,{loop:!1}).to({scaleX:1.2,scaleY:1.2},200).to({scaleX:1,scaleY:1},50),this.addChild(a);var n=BaseBitmap.create("tailor_get_word");n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.x=GameConfig.stageWidth/2,n.y=a.y,n.setScale(0),egret.Tween.get(n,{loop:!1}).wait(100).to({scaleX:1.2,scaleY:1.2},200).to({scaleX:1,scaleY:1},50),this.addChild(n);var o=t.split("|"),s=BaseBitmap.create("public_9_wordbg2");s.height=o.length>4?380:220,s.name="bottomBg",s.x=this.viewBg.x+this.viewBg.width/2-s.width/2,s.y=a.y+a.height+50,this.addChildToContainer(s);var r=egret.Rectangle.create();r.setTo(0,0,s.width,s.height-10);var l=new BaseDisplayObjectContainer,h=o.length>2?10:1,d=ComponentManager.getTextField(LanguageManager.getlocal("acTailGetTip",[String(h)]),24);d.x=GameConfig.stageWidth/2-d.width/2,d.y=a.y+90,this.addChild(d);var g=BaseLoadBitmap.create("itemicon1001");g.x=d.x+100,g.y=d.y-18,g.setScale(.5),this.addChild(g);var c=(GameConfig.stageWidth-540-48)/2;for(var p in o){var _=o[p];if(_.indexOf("1001")>-1){o.splice(p,1);break}}var u=(s.height-(106*Math.ceil(o.length/5)+20*(Math.ceil(o.length/5)-1)))/2,C=GameData.getRewardItemIcons(o.join("|"),!0,!1),f=0;if(1==C.length){var m=C[0];m.anchorOffsetX=m.width/2,m.anchorOffsetY=m.height/2,m.x=GameConfig.stageWidth/2,m.y=u+m.height/2,m.setScale(4),f=400,egret.Tween.get(m,{loop:!1}).to({scaleX:.9,scaleY:.9},200).to({scaleX:1,scaleY:1},50),l.addChild(m)}else{for(var T=0;T<C.length;T++){var m=C[T];m.anchorOffsetX=m.width/2,m.anchorOffsetY=m.height/2,m.setScale(0),m.x=c+m.width/2,m.y=u+m.height/2,c+=m.width+12,c>=GameConfig.stageWidth&&(c=(GameConfig.stageWidth-540-48)/2,u+=m.height+20,m.x=c+m.width/2,m.y=u+m.height/2,c+=m.width+12),egret.Tween.get(m,{loop:!1}).wait(100*T).to({scaleX:1.2,scaleY:1.2},200).to({scaleX:1,scaleY:1},50),l.addChild(m)}f=100*C.length}var y=ComponentManager.getScrollView(l,r);y.horizontalScrollPolicy="off",y.x=s.x,y.y=s.y+5,this.addChildToContainer(y);var v=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"sysConfirm",this.hide,this);v.x=(GameConfig.stageWidth-v.width)/2,v.y=s.y+s.height+50,v.alpha=0,egret.Tween.get(v,{loop:!1}).wait(f).to({alpha:1},500),this.addChild(v),this.doWaitAni(v,f),this.doWaitAni(d,f),this.doWaitAni(g,f)},e.prototype.doWaitAni=function(t,e){t.alpha=0,egret.Tween.get(t,{loop:!1}).wait(e).to({alpha:1},500)},e.prototype.getShowHeight=function(){var t=this.param.data,e=t.split("|");return e.length>4?528:300},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["itemeffect","public_9_wordbg2","tailor_get_light","tailor_get_word","tailor_get_wordbg","tailor_get_bg"])},e.prototype.isTouchMaskClose=function(){return!0},e.prototype.dispose=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_MAYDAY_FRESHTURNTABLE),t.prototype.dispose.call(this)},e}(BaseView);__reflect(AcMayDayRewardPopupView.prototype,"AcMayDayRewardPopupView");var AcMayDayView=function(t){function e(){var e=t.call(this)||this;return e._activityTimerText=null,e._activityDescText=null,e._topBg=null,e._topMan=null,e._topName=null,e._descBg=null,e._bottomBg=null,e.public_dot1=null,e.public_dot2=null,e.public_dot3=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.AcCfg.getCfgByActivityIdAndCode(e.AID,e.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vo",{get:function(){return Api.acVoApi.getActivityVoByAidAndCode(e.AID,e.CODE)},enumerable:!0,configurable:!0}),e.prototype.initView=function(){var t=this;App.MessageHelper.addEventListener(MessageConst.MESSAGE_MAYDAY_FRESH_ITEM,this.update,this),e.AID=t.aid,e.CODE=t.code,t._nodeContainer=new BaseDisplayObjectContainer,t.addChildToContainer(t._nodeContainer);var i=null;i=ResourceManager.getRes("acturntable_top_bg1_"+this.code)?BaseLoadBitmap.create("acturntable_top_bg1_"+this.code):BaseLoadBitmap.create("acturntable_top_bg1_1"),i.y=-241,t.addChildToContainer(i),t._topBg=i,t._topMan=BaseLoadBitmap.create("acmaydayman1_"+t.code),t._topMan.x=0,t._topMan.y=1==Number(t.code)?-225:-240,this.addChildToContainer(t._topMan);var a=null;a=ResourceManager.getRes("acturntable_tab1_"+this.code+"text")?BaseLoadBitmap.create("acturntable_tab1_"+this.code+"text"):BaseLoadBitmap.create("acturntable_tab1_1text"),a.x=GameConfig.stageWidth-351-19,a.y=1==Number(t.code)?-245:-210,this.addChildToContainer(a),this._topName=a;var n=BaseLoadBitmap.create("acturntabletop_descbg");n.width=1==Number(this.code)?456:440,n.x=GameConfig.stageWidth-n.width-5,n.y=-150,n.height=122,this.addChildToContainer(n),this._descBg=n;var o=this.vo,s=App.DateUtil.getFormatBySecond(o.st,7),r=App.DateUtil.getFormatBySecond(o.et-86400,7);t._activityTimerText=ComponentManager.getTextField(LanguageManager.getlocal("AcTurnTableViewTime",[s+"-"+r]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),t._activityTimerText.x=n.x+20,t._activityTimerText.y=-140,t.addChildToContainer(t._activityTimerText),t._activityDescText=ComponentManager.getTextField(LanguageManager.getlocal("AcTurnTableViewTabDesc1_"+this.code),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW),t._activityDescText.width=432,t._activityDescText.lineSpacing=6,t._activityDescText.x=n.x+22,t._activityDescText.y=-110,t.addChildToContainer(t._activityDescText);var l=BaseLoadBitmap.create("servant_bottombg");l.width=GameConfig.stageWidth+16,l.x=-8,l.y=-30,l.height=GameConfig.stageHeigth-i.height+i.y-60,t._nodeContainer.addChild(l),t._bottomBg=l;var h=BaseBitmap.create("public_dot2");this.addChild(h),h.x=135,h.y=this.tabbarGroup.y,this.public_dot1=h;
var d=BaseBitmap.create("public_dot2");this.addChild(d),d.x=295,d.y=this.tabbarGroup.y,this.public_dot2=d;var g=BaseBitmap.create("public_dot2");this.addChild(g),g.x=455,g.y=this.tabbarGroup.y,this.public_dot3=g,i=null,a=null,n=null,l=null,h=d=g=null,this.update()},e.prototype.clickTabbarHandler=function(e){var i=this;t.prototype.clickTabbarHandler.call(this,e);var a=Number(e.index)+1;i._topName.visible=!1,i._descBg.visible=i._topMan.visible=1==a,ResourceManager.getRes("acturntable_top_bg"+a+"_"+this.code)?i._topBg.setload("acturntable_top_bg"+a+"_"+this.code):i._topBg.setload("acturntable_top_bg"+a+"_1"),i._activityDescText.text=LanguageManager.getlocal("AcTurnTableViewTabDesc"+a+"_"+this.code),ResourceManager.getRes("acturntable_tab"+a+"_"+this.code+"text")?i._topName.setload("acturntable_tab"+a+"_"+this.code+"text",null,{callback:function(){i._topName.x=3==a?GameConfig.stageWidth-440:GameConfig.stageWidth-351-19,1==Number(i.code)?i._topName.y=1==a?-245:-210:(i._topName.x=3==a?GameConfig.stageWidth-340:GameConfig.stageWidth-351-19,i._topName.y=3==a?-230:-210),i._topName.visible=!0},callbackThisObj:this}):i._topName.setload("acturntable_tab"+a+"_1text",null,{callback:function(){i._topName.x=3==a?GameConfig.stageWidth-440:GameConfig.stageWidth-351-19,i._topName.y=1==a?-245:-210,i._topName.visible=!0},callbackThisObj:this}),i._activityTimerText.y=1==a?-140:-150,i._activityDescText.y=1==a?-110:-120},e.prototype.getTabbarTextArr=function(){return["AcTurnTableViewTab1_"+this.code,"AcTurnTableViewTab2_"+this.code,"AcTurnTableViewTab3_"+this.code]},e.prototype.getTabbarGroupY=function(){return 232},e.prototype.getTitleButtomY=function(){return 335},e.prototype.getRuleInfo=function(){return"acMatDatRule"+this.code},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["activity_charge_red","shopview_corner","servant_bottombg","recharge_fnt","itemeffect","public_9_bg43","accarnivalview_tab_red","accarnivalview_tab_green","collectflag","wifeview_bottombg","mainui_bottombtnbg","punish_rank_icon","punish_rank_name","progress5","progress3_bg","acturantable_task_arrow","acturantable_task_box1_1","acturantable_task_box1_2","acturantable_task_box1_3","acturantable_task_box2_1","acturantable_task_box2_2","acturantable_task_box2_3","acturantable_taskbox_light","acturntable_tab1_1text","acturntable_bg","acturntable_line","acturntable_point","acturntable_rankicon","acturntable_tab2_1text","acturntable_tjbg","acturntable_top_bg1_1","acturntable_top_bg2_1","acturntable_top_bg3_1","acturntabletop_descbg","public_dot2","progress10","progress10_bg","btn_upgrade_yellow","btn_upgrade_yellow_down","public_9_bg14","public_9_bg4","shopview_line","acturntable_rankicon_down","acmaydayman1_1","acturntable_tab3_1text","acturntable_tab1_2text","acturntable_tab2_2text","acturntable_tab3_2text","acturntable_top_bg2_2","acturntable_top_bg3_2","acmaydayman1_2"])},e.prototype.update=function(){var t=this.vo;t&&(this.public_dot1&&(this.public_dot1.visible=t.getpublicRedhot1()),this.public_dot2&&(this.public_dot2.visible=t.getpublicRedhot2()),this.public_dot3&&(this.public_dot3.visible=t.getpublicRedhot3()))},e.prototype.dispose=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_MAYDAY_FRESH_ITEM,this.update,this);var e=this;e._topBg=null,e._topName=null,e._descBg=null,e._activityDescText=e._activityTimerText=null,e._nodeContainer=null,e._activityTimerText=null,e._activityDescText=null,e.public_dot1=null,e.public_dot2=null,e.public_dot3=null,e._bottomBg=null,t.prototype.dispose.call(this)},e.AID=null,e.CODE=null,e}(AcCommonView);__reflect(AcMayDayView.prototype,"AcMayDayView");var AcMayDayViewTab1=function(t){function e(){var e=t.call(this)||this;return e._nodeGroup=null,e._scrollList=null,e._circleGroup=null,e._rankBtn=null,e._progress=null,e._curRewardBoxId="",e._isCircleRun=!1,e._rewardItem=0,e.initView(),e}return __extends(e,t),Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.AcCfg.getCfgByActivityIdAndCode(AcMayDayView.AID,AcMayDayView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vo",{get:function(){return Api.acVoApi.getActivityVoByAidAndCode(AcMayDayView.AID,AcMayDayView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"acTivityId",{get:function(){return AcMayDayView.AID+"-"+AcMayDayView.CODE},enumerable:!0,configurable:!0}),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETMAYDAYITEMA),this.rewardBoxClickhandlerCallBack,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETMAYDAYLOTTERY),this.buyBtnHandlerCaller,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_MAYDAY_FRESHTURNTABLE,this.fresh_table,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_MAYDAY_FRESH_ITEM,this.fresh_free,this);var t=this,e=GameConfig.stageHeigth-221-241-120,i=new BaseDisplayObjectContainer;i.y=0;var a=199,n=199.5;i.x=0,i.y=-175+n+(e-399)/2,t.addChild(i),t._nodeGroup=i;var o=new BaseDisplayObjectContainer;o.width=398,o.height=399,o.anchorOffsetX=a,o.anchorOffsetY=n,o.x=30+a,o.y=20;var s=BaseLoadBitmap.create("acturntable_bg");s.x=30,s.y=-180,t._nodeGroup.addChild(s),t._nodeGroup.addChild(o),t._circleGroup=o,o=null;var r=ComponentManager.getButton("acturntable_rankicon","",t.rankClick,this);r.x=10,r.y=-180,t._nodeGroup.addChild(r),t._rankBtn=r;var l=this.cfg,h=l.lotteryPool.length,d=Math.PI/180,g=t._circleGroup.height/2,c=[];for(var p in l.lotteryPool)c.push(l.lotteryPool[p][0]);for(var _=GameData.getRewardItemIcons(c.join("|"),!0,!1),u=0;h>u;++u){var C=360/h*d*u,f=BaseLoadBitmap.create("acturntable_line");f.width=163.5,f.rotation=90+360/h*u,f.x=a,f.y=n,t._circleGroup.addChild(f);var m=_[u];m.setScale(.6),m.anchorOffsetX=m.width/2,m.anchorOffsetY=m.height/2;var T=(g+30)*Math.sin(C+360/h*d/2)/2,y=(g+30)*Math.cos(C+360/h*d/2)/2;m.x=a+T,m.y=n-y,m.name="item"+u,t._circleGroup.addChild(m)}var v=BaseLoadBitmap.create("acturntable_point");v.anchorOffsetX=68.5,v.anchorOffsetY=78.5,v.x=t._circleGroup.x,v.y=t._circleGroup.y-9,t._nodeGroup.addChild(v);var A=GameData.formatRewardItem(l.getReward),w=[1,10],x=l.cost;for(var u in w){var I=w[u],L=GameData.getRewardItemVoByIdAndType(1),E=ComponentManager.getButton("btn_upgrade_yellow","",this.buyBtnHandler,this,[I]);E.x=1==I?130:GameConfig.stageWidth-151-100,E.y=t._circleGroup.height/2+60,E.setEnable(this.vo.et>GameData.serverTime+86400),t._nodeGroup.addChild(E);var B=ComponentManager.getTextField(LanguageManager.getlocal("acPunishBuyItemBuy"),24,TextFieldConst.COLOR_BLACK);B.x=E.x+(1==I?19.3:9.3),B.y=E.y+16,t._nodeGroup.addChild(B);var m=BaseLoadBitmap.create(L.icon);m.setScale(.4),m.y=E.y+55;var S=ComponentManager.getTextField((I*x*(1==I?1:l.discount)).toString(),18,TextFieldConst.COLOR_BLACK);if(m.name="item1",m.x=E.x+(151-100*m.scaleX-S.textWidth)/2,S.name="desc1",S.x=m.x+40,1==I){var N=ComponentManager.getTextField(LanguageManager.getlocal("sysFreeDesc"),18,TextFieldConst.COLOR_BLACK);N.name="freetxt",N.x=E.x+57.5,N.y=m.y+13,t._nodeGroup.addChild(N)}t._nodeGroup.addChild(m),S.y=m.y+13,t._nodeGroup.addChild(S);var M=BaseLoadBitmap.create(A[0].icon);M.setScale(.4),M.x=E.x+(1==I?66:59),M.y=E.y+6,t._nodeGroup.addChild(M);var b=ComponentManager.getTextField("x"+I,24,TextFieldConst.COLOR_BLACK);b.x=B.x+53+40-(1==I?2.3:1.3),b.y=E.y+16,t._nodeGroup.addChild(b);var O=ComponentManager.getTextField(LanguageManager.getlocal("AcTurnDesc",[I.toString()]),TextFieldConst.FONTSIZE_CONTENT_SMALL,4071183);if(O.x=E.x+(151-O.textWidth)/2,O.y=E.y-O.textHeight,t._nodeGroup.addChild(O),10==I){var V=BaseLoadBitmap.create("acturntable_tjbg");V.x=E.x+E.width+5,V.y=E.y-7,t._nodeGroup.addChild(V);var R=ComponentManager.getTextField(LanguageManager.getlocal("AcTurnTjDesc"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);R.x=V.x+11,R.y=V.y+25,t._nodeGroup.addChild(R)}}var k=BaseLoadBitmap.create("acmaydaynumbg");k.y=-190,k.x=GameConfig.stageWidth-172-50,t._nodeGroup.addChild(k);var P=ComponentManager.getTextField(LanguageManager.getlocal("acMayDayCurnNum",[this.vo.getTurnTotal().toString()]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_YELLOW);P.x=k.x+(172-P.textWidth)/2,P.y=k.y+7,P.name="curnTurn",t._nodeGroup.addChild(P),this._progress=ComponentManager.getProgressBar("progress10","progress10_bg",354),this._progress.x=GameConfig.stageWidth-this._progress.height-168,this._progress.y=220,this._progress.rotation=-90,this._progress.setPercentage(this.getProgressPercent()),t._nodeGroup.addChild(this._progress);for(var F=l.lotteryNum,D=Object.keys(F),G=this._progress.y,H=88.5,U=0;U<F.length;U++){var W=(F[U],G-(U+1)*H),Y=BaseBitmap.create("acturantable_task_arrow");Y.rotation=90,Y.x=this._progress.x+this._progress.height+Y.height-5,Y.y=W-Y.width/2+10,t._nodeGroup.addChild(Y);var q=this.getBoxStatusById(D[U]),j="acturantable_task_box1_";U>1&&(j="acturantable_task_box2_");var Q=BaseLoadBitmap.create(j+String(q));Q.anchorOffsetX=26.5,Q.anchorOffsetY=25.5,Q.name="boxImg"+D[U],Q.x=Y.x+26.5,Q.y=W+10;var K=BaseLoadBitmap.create("acturantable_taskbox_light");K.anchorOffsetX=40,K.anchorOffsetY=40,K.x=Y.x+20,K.name="lightImg"+D[U],K.y=W+4,K.visible=!1,t._nodeGroup.addChild(K),t._nodeGroup.addChild(Q),Q.addTouchTap(this.rewardBoxClickhandler,this,[D[U]]);var Z=l.getBoxRewardById(D[U]),X=Z.needNum,z=ComponentManager.getTextField(LanguageManager.getlocal("AcTurnDesc",[X.toString()]),18,4071183);z.x=Q.x+32,z.y=W-z.height/2+10,t._nodeGroup.addChild(z)}t.fresh_free(),t.refreshProfress()},e.prototype.rewardBoxClickhandler=function(t,e){if(!this._isCircleRun){var i=e,a=this.getBoxStatusById(i);2==a?(this._curRewardBoxId=i,NetManager.request(NetRequestConst.REQUEST_ACTIVITY_GETMAYDAYITEMA,{activeId:this.acTivityId,lotteryId:Number(i)+1})):ViewController.getInstance().openView(ViewConst.POPUP.DAILYTASK_REWARDPREVIEWPOPUPVIEW,{type:AcMayDayView.AID,id:i})}},e.prototype.getBoxStatusById=function(t){var e=this.cfg,i=this.vo,a=1;if(i.isGetTurnProgress(Number(t)+1))a=3;else{var n=e.getBoxRewardById(t);n.needNum<=i.getTurnTotal()&&(a=2)}return a},e.prototype.fresh_free=function(){var t=this;if(t.vo){var e=t._nodeGroup.getChildByName("item1"),i=t._nodeGroup.getChildByName("desc1"),a=t._nodeGroup.getChildByName("freetxt");e.visible=i.visible=!t.vo.isFree(),a.visible=t.vo.isFree()}},e.prototype.getProgressPercent=function(){var t=this.vo.getTurnTotal(),e=this.cfg.lotteryNum,i=Object.keys(e);if(0==t)return 0;if(t>=e[String(i.length-1)].needNum)return 100;for(var a=1/i.length,n=0;n<i.length;n++)if(t<=e[String(n)].needNum){var o=a*n,s=0;n>0&&(s=e[String(n-1)].needNum);var r=e[String(n)].needNum;return o+=(t-s)/(r-s)*a}},e.prototype.refreshProfress=function(){var t=this._nodeGroup.getChildByName("curnTurn");t.text=LanguageManager.getlocal("acMayDayCurnNum",[this.vo.getTurnTotal().toString()]);var e=this.getProgressPercent(),i=this._progress.getPercent();egret.Tween.get(this._progress,{loop:!1}).to({percent:e},5e3*(e-i));for(var a=this.cfg.lotteryNum,n=Object.keys(a),o=0;o<n.length;o++){var s=String(n[o]),r=this._nodeGroup.getChildByName("boxImg"+s),l=this._nodeGroup.getChildByName("lightImg"+s),h=this.getBoxStatusById(s),d="acturantable_task_box1_";o>2&&(d="acturantable_task_box1_"),r instanceof BaseBitmap&&(r.texture=ResourceManager.getRes(d+h)),2==h?(l.visible=!0,egret.Tween.get(l,{loop:!0}).to({rotation:l.rotation+360},1e4),egret.Tween.get(r,{loop:!0}).to({rotation:10},50).to({rotation:-10},100).to({rotation:10},100).to({rotation:0},50).wait(500)):(l.visible=!1,egret.Tween.removeTweens(l),egret.Tween.removeTweens(r))}},e.prototype.getSheepType=function(){return 1},e.prototype.buyBtnHandler=function(t){if(!this._isCircleRun){if(this.vo.et-GameData.serverTime-86400<=0)return void App.CommonUtil.showTip(LanguageManager.getlocal("buy_error"));NetManager.request(NetRequestConst.REQUEST_ACTIVITY_GETMAYDAYLOTTERY,{activeId:this.acTivityId,isTenPlay:10==t?1:0})}},e.prototype.buyBtnHandlerCaller=function(t){var e=this,i=t.data.data.data;if(!i)return void App.CommonUtil.showTip(LanguageManager.getlocal("requestLoadErrorTip"));if(-3==t.data.data.ret)return void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough"));var a=this;a.fresh_free(),a.refreshProfress();var n=i.rewards||"",o=n.split("|");if(2==o.length){a._isCircleRun=!0;var s=this.cfg.lotteryPool.length;o.splice(o.indexOf(this.cfg.getReward),1),a._rewardItem=this.cfg.getSelectItemIdx(o[0]);var r=(Math.PI/180,360/s*a._rewardItem);egret.Tween.get(a._circleGroup,{onChange:function(){for(var t=e.cfg.lotteryPool.length,i=0;t>i;++i){var n=a._circleGroup.getChildByName("item"+i);n&&(n.rotation=0-a._circleGroup.rotation)}}}).to({rotation:9e3},1500).to({rotation:9360},100).to({rotation:9720},200).to({rotation:10080},400).to({rotation:10440-(r+360/s/2)},800).wait(500).call(function(){a._isCircleRun=!1,ViewController.getInstance().openView(ViewConst.POPUP.ACMAYDAYREWARDPOPUPVIEW,n)},this)}else ViewController.getInstance().openView(ViewConst.POPUP.ACMAYDAYREWARDPOPUPVIEW,n)},e.prototype.rankClick=function(){return this._isCircleRun?void 0:(AcMayDayRankPopupView.aid=AcMayDayView.AID,AcMayDayRankPopupView.code=AcMayDayView.CODE,this.vo.et<GameData.serverTime?void App.CommonUtil.showTip(LanguageManager.getlocal("collect_error")):void ViewController.getInstance().openView(ViewConst.POPUP.ACTMAYDAYRANKPOPUPVIEW,{aid:AcMayDayRankPopupView.aid,code:AcMayDayRankPopupView.code}))},e.prototype.rewardBoxClickhandlerCallBack=function(t){var e=t.data.data.data;if(!e)return void App.CommonUtil.showTip(LanguageManager.getlocal("collect_error"));3==Number(this._curRewardBoxId)&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_CHANGE_IMG);var i=e.rewards,a=GameData.formatRewardItem(i),n=this._nodeGroup.getChildByName("boxImg"+this._curRewardBoxId),o=n.localToGlobal(n.width/2,50);App.CommonUtil.playRewardFlyAction(a,o),this.refreshProfress()},e.prototype.refreshWhenSwitchBack=function(){var t=this;t.fresh_table()},e.prototype.fresh_table=function(){var t=this;t._circleGroup.rotation=0;for(var e=this.cfg.lotteryPool.length,i=0;e>i;++i){var a=t._circleGroup.getChildByName("item"+i);a&&(a.rotation=0)}},e.prototype.dispose=function(){var e=this;App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETMAYDAYITEMA),this.rewardBoxClickhandlerCallBack,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETMAYDAYLOTTERY),this.buyBtnHandlerCaller,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_MAYDAY_FRESHTURNTABLE,this.fresh_table,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_MAYDAY_FRESH_ITEM,this.fresh_free,this),egret.Tween.removeTweens(e._circleGroup),egret.Tween.removeTweens(this._progress);for(var i=0;4>i;i++){var a=this._nodeGroup.getChildByName("boxImg"+i),n=this._nodeGroup.getChildByName("lightImg"+i);egret.Tween.removeTweens(a),egret.Tween.removeTweens(n)}e._rankBtn.removeTouchTap(),e._rankBtn.dispose(),e._circleGroup.removeTouchTap(),e._circleGroup.removeChildren(),e._nodeGroup.removeChildren(),e._rankBtn=null,e._progress=null,e._nodeGroup=null,e._circleGroup=null,t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(AcMayDayViewTab1.prototype,"AcMayDayViewTab1");var AcMayDayViewTab2=function(t){function e(){var e=t.call(this)||this;return e._scrollList=null,e._isSpecial=!1,e._seprateNum=0,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg43");t.width=625,t.height=GameConfig.stageHeigth-410,t.x=5,t.y=-180,this.addChild(t);var e=AcMayDayView.AID,i=(AcMayDayView.CODE,Api.acVoApi.getActivityVoByAidAndCode(e),this.cfg.recharge),a=Object.keys(i);a.sort(function(t,e){return Number(t)-Number(e)});var n=new egret.Rectangle(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-430),o=ComponentManager.getScrollList(AcMayDay2ScrollItem,a,n);o.setPosition(20,-170),this.addChild(o),this._scrollList=o},Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.AcCfg.getCfgByActivityIdAndCode(AcMayDayView.AID,AcMayDayView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vo",{get:function(){return Api.acVoApi.getActivityVoByAidAndCode(AcMayDayView.AID,AcMayDayView.CODE)},enumerable:!0,configurable:!0}),e.prototype.getSheepType=function(){return 2},e.prototype.dispose=function(){this._scrollList=null,t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(AcMayDayViewTab2.prototype,"AcMayDayViewTab2");var AcMayDayViewTab3=function(t){function e(){var e=t.call(this)||this;return e._scrollList=null,e._rechargeArr=null,e.initView(),e}return __extends(e,t),Object.defineProperty(e.prototype,"cfg",{get:function(){return Config.AcCfg.getCfgByActivityIdAndCode(AcMayDayView.AID,AcMayDayView.CODE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vo",{get:function(){return Api.acVoApi.getActivityVoByAidAndCode(AcMayDayView.AID,AcMayDayView.CODE)},enumerable:!0,configurable:!0}),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_MAYDAY_FRESH_ITEM,this.update,this);var t=BaseBitmap.create("public_9_bg43");t.width=625,t.height=GameConfig.stageHeigth-410,t.x=5,t.y=-180,this.addChild(t);var e=this.vo,i=e.getArr("task");i=this.updataArr(i),this._rechargeArr=i;var a=new egret.Rectangle(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-430),n=ComponentManager.getScrollList(AcMayDay3ScrollItem,i,a);this._scrollList=n,this._scrollList.setPosition(20,-170),this.addChild(n)},e.prototype.update=function(){if(this.vo){var t=this.vo.getArr("task");t=this.updataArr(t),this._rechargeArr=t,this._scrollList.refreshData(t)}},e.prototype.updataArr=function(t){void 0===t&&(t=[]);var e=this.vo;if(e){for(var i=[],a=[],n=[],o=0;o<t.length;o++){var s=e.getTask(t[o].questType);this.vo.isGetTaskReward(t[o].key)?i.push(t[o]):s>=t[o].value?a.push(t[o]):n.push(t[o])}return a.concat(n).concat(i)}},e.prototype.dispose=function(){this._scrollList=null,this._rechargeArr=null,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_MAYDAY_FRESH_ITEM,this.update,this),t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(AcMayDayViewTab3.prototype,"AcMayDayViewTab3");var AcNewYearPopupView=function(t){function e(){var e=t.call(this)||this;return e._rbg=null,e._goBtn=null,e.isShowBtnType=0,e._isshow=!1,e._rewardNum=0,e._btnType=0,e._name="",e._btnTypeNum=0,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETNEWYEARREWARD),this.refreshUIInfo,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var t=this.param.data.reward;this.isShowBtnType=this.param.data.isShowBtnType,this._isshow=this.param.data.isshow,this._rewardNum=this.param.data.rewardNum,this.param.data._name&&(this._name=this.param.data._name,this._btnTypeNum=this.param.data._btnTypeNum);var e=91,i=BaseBitmap.create("public_9_bg4");i.width=520,i.height=205,i.x=this.viewBg.x+this.viewBg.width/2-i.width/2,i.y=116-e,this._nodeContainer.addChild(i),this._rbg=i;var a=GameData.getRewardItemIcons(t,!0),n=Math.ceil(a.length/4),o=BaseBitmap.create("public_9_bg1");o.width=i.width-20,o.height=120*n,o.x=this.viewBg.x+this.viewBg.width/2-o.width/2,o.y=i.y+20,this._nodeContainer.addChild(o),i.height=o.height+90;var s=o.x+20,r=o.y+10,l=new BaseDisplayObjectContainer;this.addChildToContainer(l);for(var h=0;h<a.length;h++){var d=a[h];h>0&&(s+=d.width+10,h%4==0&&(s=o.x+10,r+=d.height+5)),d.x=s,d.y=r,l.addChild(d)}if(l.x=o.x+(o.width-l.width)/2-55,this._nodeContainer.addChild(l),this.setConfirmBtnPosition(0,0),this._goBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"sysConfirm",this.collectHandler,this),this._goBtn.x=o.x+o.width/2-this._goBtn.width/2,this._goBtn.y=o.y+o.height-this._goBtn.height/2+40,this._nodeContainer.addChild(this._goBtn),"newYear1"!=this._name)if(2==this.isShowBtnType&&(this._goBtn.visible=!1),1==this.isShowBtnType&&this._goBtn.setText("taskCollect"),0==AcNewYearViewTab2.isStarBoo)this._goBtn.visible=!1;else{var g=Api.acVoApi.getActivityVoByAidAndCode(AcNewYearView.AID,AcNewYearView.CODE);if(2==g.taskinfo.dayFlag){this._goBtn.visible=!1;var c=BaseBitmap.create("collectflag");c.x=215,c.y=167,c.scaleX=.6,c.scaleY=.6,this._nodeContainer.addChild(c)}else 1==g.taskinfo.dayFlag?(this._goBtn.visible=!0,this._goBtn.setText("taskCollect")):this._goBtn.setEnable(!0)}else{this._goBtn.visible=!1;var p=Api.acVoApi.getActivityVoByAidAndCode(AcNewYearView.AID,AcNewYearView.CODE);if(p.getBtnType(this._rewardNum)){var _=BaseBitmap.create("collectflag");_.x=215,_.y=167,_.scaleX=.6,_.scaleY=.6,this._nodeContainer.addChild(_)}else _?_.visible=!1:2==this._btnTypeNum&&(this._goBtn.visible=!0,this._goBtn.setText("taskCollect"))}},e.prototype.collectHandler=function(t){2==this._btnTypeNum?NetManager.request(NetRequestConst.REQUEST_ACTIVITY_GETNEWYEARREWARD,{activeId:AcNewYearView.AID+"-"+AcNewYearView.CODE,questType:this._rewardNum+"",ftype:3}):1==this.isShowBtnType?NetManager.request(NetRequestConst.REQUEST_ACTIVITY_GETNEWYEARREWARD,{activeId:AcNewYearView.AID+"-"+AcNewYearView.CODE,questType:"1001",ftype:2}):this.hide()},e.prototype.refreshUIInfo=function(t){if(t.data.ret){var e=BaseBitmap.create("collectflag");e.x=215,e.y=167,e.scaleX=.6,e.scaleY=.6,this._nodeContainer.addChild(e),this._goBtn.visible=!1,App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.data.rewards))}},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([])},e.prototype.dispose=function(){this._rbg=null,this._goBtn=null,this.isShowBtnType=0,this._isshow=!1,this._nodeContainer=null,this._rewardNum=0,this._btnType=0,this._name=null,this._btnTypeNum=null,App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETNEWYEARREWARD),this.refreshUIInfo,this),t.prototype.dispose.call(this)},e}(PopupView);__reflect(AcNewYearPopupView.prototype,"AcNewYearPopupView");var AcNewYearView=function(t){function e(){var e=t.call(this)||this;return e._activityTimerText=null,e._activityDesText=null,e._chineseknot=null,e.lastType=0,e._topBg=null,e._topBg2=null,e.curr_acNewYearVo=null,e.public_dot1=null,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_RESFESH_NEWYEAR_LIST,this.isShowRedhot,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_RESFESH_NEWYEAR_REDHOT,this.isShowRedhot,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETNEWYEARREWARD),this.isShowRedhot,this),e.AID=this.aid,e.CODE=this.code;var t=Api.acVoApi.getActivityVoByAidAndCode(this.aid);this.curr_acNewYearVo=t,this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var i=BaseBitmap.create("acnewyear_topbg_"+this.code);i.width=GameConfig.stageWidth+18,i.y=-286,this.addChild(i),this._nodeContainer.addChild(i),this._topBg=i;var a=BaseBitmap.create("acnewyear_topbg2_"+this.code);a.width=GameConfig.stageWidth+18,a.y=-286,this._nodeContainer.addChild(a),this._topBg2=a,this._topBg2.visible=!1,e.topBgHeight=GameConfig.stageHeigth-i.height-i.y-this.container.y+5;var n=BaseBitmap.create("servant_bottombg");n.width=GameConfig.stageWidth+16,n.height=GameConfig.stageHeigth-i.height-i.y-this.container.y+9,n.x=-8,n.y=i.height+i.y-4,this._nodeContainer.addChild(n),this._activityTimerText=ComponentManager.getTextField(Api.playerVoApi.getPlayerGem().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._activityTimerText.x=80,this._activityTimerText.y=-142,this._activityTimerText.text=t.acTimeAndHour,this.addChildToContainer(this._activityTimerText),this._activityDesText=ComponentManager.getTextField(Api.playerVoApi.getPlayerGem().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._activityDesText.x=80,this._activityDesText.y=-102,this._activityDesText.text=LanguageManager.getlocal("newayearactivityDes_"+this.code),this.addChildToContainer(this._activityDesText);var o=BaseBitmap.create("acnewyear_chineseknot2_"+this.code);o.x=280,o.y=-118,this._chineseknot=o,this._nodeContainer.addChild(o);n.y+24;this.public_dot1=BaseBitmap.create("public_dot2"),this.addChild(this.public_dot1),this.public_dot1.x=295,this.public_dot1.y=this.tabbarGroup.y,this.public_dot1.visible=this.curr_acNewYearVo.isShowRedDot},e.prototype.isShowRedhot=function(){1==AcNewYearViewTab2.isStarBoo?this.public_dot1.visible=this.curr_acNewYearVo.isShowRedDot:this.public_dot1.visible=!1},e.prototype.clickTabbarHandler=function(e){t.prototype.clickTabbarHandler.call(this,e),this.acEnd(),1==e.index?(this._topBg2.visible=!0,this._topBg.visible=!0,this._activityTimerText.visible=!1,this._chineseknot.visible=!1,this._activityDesText.visible=!1):(this._topBg2.visible=!1,this._topBg.visible=!0,this._activityTimerText.visible=!0,this._chineseknot.visible=!0,this._activityDesText.visible=!0)},e.prototype.acEnd=function(){return 0==this.curr_acNewYearVo.isStart?void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd")):void 0},e.prototype.getTabbarTextArr=function(){return["acNewYearViewTab1","acNewYearViewTab2_"+this.code]},e.prototype.getTabbarGroupY=function(){return 235},e.prototype.goToRechargeHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["acnewyear_big_package","acnewyear_bottom","acnewyear_bottom2","acnewyear_bottom3","acnewyear_chineseknot_1","acnewyear_chineseknot_2","acnewyear_box","acnewyear_chineseknot2_1","acnewyear_chineseknot2_2","acnewyear_look","acnewyear_small_package","acnewyear_topbg_1","acnewyear_topbg2_1","acnewyear_topbg_2","acnewyear_topbg2_2","progress3","progress3_bg","servant_bottombg","progress6_bg","forpeople_bottom","rechargevie_effects"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_RESFESH_NEWYEAR_LIST,this.isShowRedhot,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_RESFESH_NEWYEAR_REDHOT,this.isShowRedhot,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETNEWYEARREWARD),this.isShowRedhot,this),this._nodeContainer=null,AcVipShopView.AID=null,AcVipShopView.CODE=null,this.lastType=0,this._activityTimerText=null,this._activityDesText=null,this._chineseknot=null,this._topBg=null,this._topBg2=null,e.topBgHeight=0,t.prototype.dispose.call(this)},e.AID=null,e.CODE=null,e.topBgHeight=0,e}(AcCommonView);__reflect(AcNewYearView.prototype,"AcNewYearView");var AcNewYearViewTab1=function(t){function e(){var e=t.call(this)||this;return e._progressBar=null,e._cfgObj=null,e._arrReward=[],e._acNewYearVo=null,e._myScore=0,e._needTxt=null,e._maxScore=0,e._downTitleLine=null,e.newYearCfg=[{id:1,acnewyearPosY:-165},{id:2,acnewyearPosY:-5},{id:3,acnewyearPosY:80},{id:4,acnewyearPosY:155},{id:5,acnewyearPosY:225}],e.initView(),e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETNEWYEARREWARD),this.updata,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_BUYNEWYEARGIFT),this.updata,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChild(this._nodeContainer);var t=Api.acVoApi.getActivityVoByAidAndCode(AcNewYearView.AID,AcNewYearView.CODE);this._acNewYearVo=t,this._myScore=this._acNewYearVo.getScore(),this._cfgObj=Config.AcCfg.getCfgByActivityIdAndCode(AcNewYearView.AID,AcNewYearView.CODE);var i=this._cfgObj.itemListCfg.totalScoreReward;this._arrReward=[];var a=[];for(var n in i)if(Number(n)){this._arrReward.push(i[n]);var o=BaseBitmap.create("acnewyear_bottom");o.y=this.newYearCfg[Number(n)-1].acnewyearPosY,o.x=63,this._nodeContainer.addChild(o),a.push(i[n].needScore)}e.SCOREARR=a,a.reverse(),this._maxScore=a[0];for(var s=0;s<a.length;s++){var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);r.text=a[s],r.setPosition(o.x+15,this.newYearCfg[s].acnewyearPosY),r.width=60,r.textAlign="right",this._nodeContainer.addChild(r)}var l=BaseBitmap.create("public_line3");l.width=550,l.setPosition(50,-210),this._downTitleLine=l,this._nodeContainer.addChild(l);var h=ComponentManager.getTextField(LanguageManager.getlocal("newayearNeednumDes"),TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_BROWN);h.setPosition(190,l.y-5),this._nodeContainer.addChild(h);var d=BaseBitmap.create("acnewyear_chineseknot2_"+AcNewYearView.CODE);d.x=300,d.y=l.y-18,this._nodeContainer.addChild(d);var g=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_BROWN);g.setPosition(d.x+50,h.y),g.text=this._myScore+"",this._needTxt=g,this._nodeContainer.addChild(g);var c=BaseBitmap.create("public_9_bg43");c.width=492,c.height=506,c.x=140,c.y=l.y+30,this._nodeContainer.addChild(c);var p=new egret.Rectangle(0,0,GameConfig.stageWidth,506);this._arrReward.reverse();var _=ComponentManager.getScrollList(NewYear1ScrollItem,this._arrReward,p);_.y=l.y+40,_.x=150,this._scrollList=_,this._nodeContainer.addChild(_),this._progressBar=ComponentManager.getProgressBar("progress3","progress3_bg",470),this._progressBar.x=30,this._progressBar.y=315,this._progressBar.setTextSize(18),this._progressBar.setPercentage(this._myScore/this._maxScore),this._progressBar.rotation=this._progressBar.rotation-90,this._nodeContainer.addChild(this._progressBar);var u=AcNewYearView.topBgHeight-this._nodeContainer.height;this._nodeContainer.y=u/2-50},e.prototype.updata=function(t){var e=Api.acVoApi.getActivityVoByAidAndCode(AcNewYearView.AID,AcNewYearView.CODE);this._myScore=e.getScore(),this._progressBar&&this._progressBar.setPercentage(this._myScore/this._maxScore),this._needTxt&&(this._needTxt.text=""+this._myScore),this._scrollList&&(this._scrollList.refreshData(this._arrReward),this._scrollList.y=this._downTitleLine.y+40),t.data.data&&App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.data.rewards))},e.prototype.getSheepType=function(){return 1},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETNEWYEARREWARD),this.updata,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_BUYNEWYEARGIFT),this.updata,this),this._scrollList=null,this._newYearInfoVoList=null,this._progressBar=null,this._cfgObj=null,this._arrReward=[],this._nodeContainer=null,this._acNewYearVo=null,this._myScore=null,this._needTxt=null,this._maxScore=null,e.SCOREARR=[],t.prototype.dispose.call(this)},e.SCOREARR=[],e}(CommonViewTab);__reflect(AcNewYearViewTab1.prototype,"AcNewYearViewTab1");var AcNewYearViewTab2=function(t){function e(){var e=t.call(this)||this;return e._index=0,e._bottomBg=null,e._cfgObj=null,e._dailyTask_arr=[],e._currDayNum=0,e._leftBtn=null,e.num=0,e._tadayNumTxt=null,e.public_dot2=null,e._bigArr=[],e._tadayTaskTxt=null,e._lastNumTxt=null,e._afterTxt=null,e.btntype=0,e._lastNum=0,e._afterNum=0,e.currNewDay=0,e._curr_acNewYearVo=null,e.rechargevie_effects=null,e.big_package=null,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_RESFESH_NEWYEAR_ITEM,this.update,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETNEWYEARREWARD),this.refreshUIInfo,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_RESFESH_NEWYEAR_LIST,this.restList,this);var t=Api.acVoApi.getActivityVoByAidAndCode(AcNewYearView.AID);this._curr_acNewYearVo=t;var e=t.diffday;e>7&&(e=7),this.currNewDay=e,NewYear2ScrollItem.TADAY=e,this.num=e-1,this.showDayNum();
var i=BaseBitmap.create("public_9_bg43");i.width=625,i.height=GameConfig.stageHeigth-470,i.x=5,i.y=-160,this._bottomBg=i,this.addChild(i),this.showBtn()},e.prototype.showEff=function(){this.rechargevie_effects=BaseBitmap.create("rechargevie_effects"),this.addChild(this.rechargevie_effects),this.rechargevie_effects.anchorOffsetX=this.rechargevie_effects.width/2,this.rechargevie_effects.anchorOffsetY=this.rechargevie_effects.height/2,this.rechargevie_effects.setPosition(555,-370),this.rechargevie_effects.visible=!1},e.prototype.restList=function(){this.refreshList()},e.prototype.removeEff=function(){this.rechargevie_effects&&(egret.Tween.removeTweens(this.rechargevie_effects),this.rechargevie_effects.visible=!1),this.big_package&&(this.big_package.rotation=0,egret.Tween.removeTweens(this.big_package)),this.public_dot2.visible=!1},e.prototype.showBtn=function(){var t=235,e=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_WHITE);e.text=LanguageManager.getlocal("acNewYeartab2des_"+AcNewYearView.CODE),e.width=400,e.x=40,e.y=-400,this.addChild(e);var i=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_WARN_GREEN);i.text=LanguageManager.getlocal("acNewYeartask_des",["0","0"]),i.width=400,i.x=e.x,i.y=e.y+60,this.addChild(i),this._tadayTaskTxt=i;var a=BaseBitmap.create("forpeople_bottom");a.x=500,a.y=-420,this.addChild(a),this.showEff();var n=BaseBitmap.create("acnewyear_big_package");n.x=a.x+5+n.width/2,n.y=a.y+n.height/2,n.scaleX=.9,n.scaleY=.9,n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.addTouchTap(this.packageHandler,this),this.big_package=n,this.addChild(n);var o=BaseBitmap.create("acnewyear_look");o.x=a.x+8,o.y=a.y+a.height-o.width/2+10,this.addChild(o);var s=ComponentManager.getButton("btn_leftpage","",this.eventCollectHandler,this);s.x=60,s.y=15-t,s.addTouchTap(this.onClickHandler,this),this._leftBtn=s,this.addChild(s),this.public_dot2=BaseBitmap.create("public_dot2"),this.addChild(this.public_dot2),this.public_dot2.x=o.x+o.width-10,this.public_dot2.y=o.y-75,this.public_dot2.visible=!1;var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);0==this._currDayNum&&(this._lastNum=7,this._afterNum=2),r.text=LanguageManager.getlocal("newayearDate"+this._lastNum),r.width=120,r.x=150,r.y=-200,r.textAlign="center",r.alpha=.5,this._lastNumTxt=r,this.addChild(r);var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_BROWN),h=this._currDayNum+1;l.text=LanguageManager.getlocal("newayearDate"+h),l.width=120,l.x=250,l.y=-200,l.textAlign="center",this._tadayNumTxt=l,this.addChild(l);var d=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN),g=h+=1;d.text=LanguageManager.getlocal("newayearDate"+g),d.width=120,d.x=350,d.y=-200,d.textAlign="center",d.alpha=.5,this._afterTxt=d,this.addChild(d);var c=ComponentManager.getButton("btn_leftpage","",this.eventCollectHandler,this);c.scaleX=-1,c.x=GameConfig.stageWidth-60,c.y=15-t,c.addTouchTap(this.onClickHandler,this),this.addChild(c),this._cfgObj=Config.AcCfg.getCfgByActivityIdAndCode(AcNewYearView.AID,AcNewYearView.CODE);var p=this._cfgObj.itemListCfg.dailyTask;this._dailyTask_arr=[];for(var _ in p)Number(_)&&this._dailyTask_arr.push(p[_]);var u=[];u=this.getCurrDayData(this._currDayNum),this._tadayTaskTxt.text=LanguageManager.getlocal("acNewYeartask_des",["0",u.length+""]);var C=new egret.Rectangle(0,0,GameConfig.stageWidth,this._bottomBg.height-20),f=ComponentManager.getScrollList(NewYear2ScrollItem,u,C);f.y=this._bottomBg.y+10,f.x=15,this._scrollList=f,this.addChild(f),this.refreshList(),this.update()},e.prototype.refreshUIInfo=function(){2==this._curr_acNewYearVo.taskinfo.dayFlag&&(this.public_dot2.visible=!1,this.removeEff())},e.prototype.refreshList=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(AcNewYearView.AID,AcNewYearView.CODE),i=[];this._currDayNum==this.currNewDay-1?(e.isStarBoo=!0,1==t.taskinfo.dayFlag&&(this.playEff(),this.btntype=1)):(e.isStarBoo=!1,this.removeEff()),i=this.getCurrDayData(this._currDayNum),this._scrollList.refreshData(i);var a=this._currDayNum+1;this._lastNumTxt.text=LanguageManager.getlocal("newayearDate"+this._lastNum),this._tadayNumTxt.text=LanguageManager.getlocal("newayearDate"+a),this._tadayTaskTxt.text=LanguageManager.getlocal("acNewYeartask_des",[t.getTaskLength()+"",i.length+""]),this._afterTxt.text=LanguageManager.getlocal("newayearDate"+this._afterNum)},e.prototype.packageHandler=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(AcNewYearView.AID,AcNewYearView.CODE);if(0==t.isStart)return void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd"));var e={};this._bigArr.length>1&&(e.reward=this._bigArr[0].reward),e.isShowBtnType=this.btntype,ViewController.getInstance().openView(ViewConst.POPUP.ACNEWYEARPOPUPVIEW,e)},e.prototype.onClickHandler=function(t,e){var i=Api.acVoApi.getActivityVoByAidAndCode(AcNewYearView.AID,AcNewYearView.CODE);return 0==i.isStart?void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd")):(t.currentTarget==this._leftBtn?this.num-=1:this.num+=1,this.showDayNum(),this.refreshList(),void App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_RESFESH_NEWYEAR_REDHOT))},e.prototype.showDayNum=function(){this.num<0&&(this.num=7+this.num),this.num>6&&(this.num=7-this.num),this._currDayNum=this.num,this._lastNum=this.num,this._afterNum=this.num+2,0==this.num&&(this._lastNum=7,this._afterNum=2),this._afterNum>7&&(this._afterNum=1),NewYear2ScrollItem.TADAY=this.num+1},e.prototype.showHotRed=function(){this.playEff()},e.prototype.playEff=function(){this.rechargevie_effects&&(this.rechargevie_effects.visible=!0,egret.Tween.get(this.rechargevie_effects,{loop:!0}).to({rotation:this.rechargevie_effects.rotation+360},1e4)),this.big_package&&egret.Tween.get(this.big_package,{loop:!0}).to({rotation:10},50).to({rotation:-10},100).to({rotation:10},100).to({rotation:0},50).wait(500),this.public_dot2.visible=!0},e.prototype.update=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(AcNewYearView.AID,AcNewYearView.CODE);if(t.getTaskLength()){var e=this.getCurrDayData(this._currDayNum);this._tadayTaskTxt.text=LanguageManager.getlocal("acNewYeartask_des",[t.getTaskLength()+"",e.length+""]),1==this._curr_acNewYearVo.taskinfo.dayFlag?(this.showHotRed(),this.btntype=1):this.btntype=0}t.diffday!=this.currNewDay&&(this.currNewDay=t.diffday,t.diffday>7?this.currNewDay=7:this.num+=1,this.showDayNum(),this.refreshList())},e.prototype.eventCollectHandler=function(){},e.prototype.getCurrDayData=function(t){void 0===t&&(t=0);var e=[];e=this._dailyTask_arr[t];var i=[];for(var a in e)e[a].sortId?i.push(e[a]):this._bigArr.push(e[a]);return i.sort(function(t,e){return t.sortId>e.sortId?1:t.sortId==e.sortId?0:-1}),i},e.prototype.getSheepType=function(){return 2},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_RESFESH_NEWYEAR_ITEM,this.update,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETNEWYEARREWARD),this.refreshUIInfo,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_RESFESH_NEWYEAR_LIST,this.restList,this),this._scrollList=null,this._newYearInfoVoList=null,this._index=0,e.isStarBoo=!1,this.btntype=0,this._lastNum=0,this._afterNum=0,this._tadayTaskTxt=null,this._lastNumTxt=null,this._afterTxt=null,this.currNewDay=0,t.prototype.dispose.call(this)},e.isStarBoo=!1,e}(CommonViewTab);__reflect(AcNewYearViewTab2.prototype,"AcNewYearViewTab2");var NewYear1ScrollItem=function(t){function e(){var e=t.call(this)||this;return e._data=null,e._packageStateTxt=null,e._typeBg=null,e._myScore=0,e._rewardNum=0,e._btnTypeNum=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_RESFESH_NEWYEAR_ITEM,this.update,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETNEWYEARREWARD),this.update,this);var i=Api.acVoApi.getActivityVoByAidAndCode(AcNewYearView.AID,AcNewYearView.CODE);this._myScore=i.getScore();var a=BaseBitmap.create("public_9_bg1");a.width=474,a.height=92,this.addChild(a);var n=BaseBitmap.create("progress6_bg");this.addChild(n),n.scaleX=.75,n.scaleY=.75,n.x=20,n.y=5,this._data=e;var o=null;0==t?(o=BaseBitmap.create("acnewyear_big_package"),o.x=n.x+5,o.y=n.y):(o=BaseBitmap.create("acnewyear_small_package"),o.x=30,o.y=5),o.scaleX=.8,o.scaleY=.8,o.addTouchTap(this.big_packageHandler,this),this.addChild(o);var s=BaseBitmap.create("acnewyear_bottom3");s.x=o.x,s.y=o.y+o.height-40,this.addChild(s),this._typeBg=s,this._typeBg.visible=!1;var r=ComponentManager.getTextField("",18,TextFieldConst.COLOR_QUALITY_WHITE);r.text=LanguageManager.getlocal("taskCollect"),r.x=s.x-5,r.y=70,r.width=s.width,r.textAlign="center",this._packageStateTxt=r,this._packageStateTxt.visible=!1,this.addChild(r);var l=BaseBitmap.create("acnewyear_chineseknot2_"+AcNewYearView.CODE);l.x=200,l.y=5,this.addChild(l);var h=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_WHITE);h.text=e.needScore+"",h.x=l.x+50,h.y=20,this.addChild(h);var d=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN),g=t+1,c=LanguageManager.getlocal("acNewYearfestivalDes"+g+"_"+AcNewYearView.CODE);d.text=c,d.x=170,d.y=60,this.addChild(d),0==t&&d.setColor(TextFieldConst.COLOR_WARN_YELLOW),this.update()},e.prototype.big_packageHandler=function(t){var e=Api.acVoApi.getActivityVoByAidAndCode(AcNewYearView.AID,AcNewYearView.CODE);if(0==e.isStart)return void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd"));var i={};i.reward=this._data.reward,i._name="newYear1";var a=AcNewYearViewTab1.SCOREARR.indexOf(this._data.needScore);i.rewardNum=a+1,i._btnTypeNum=this._btnTypeNum,ViewController.getInstance().openView(ViewConst.POPUP.ACNEWYEARPOPUPVIEW,i)},e.prototype.update=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(AcNewYearView.AID,AcNewYearView.CODE);if(this._packageStateTxt){3200==AcNewYearViewTab1.SCOREARR[0]&&AcNewYearViewTab1.SCOREARR.reverse();var e=AcNewYearViewTab1.SCOREARR.indexOf(this._data.needScore);this._packageStateTxt.visible=!0;var i=e+=1;this._myScore>=this._data.needScore?(t.getBtnType(i)?(this._packageStateTxt.text=LanguageManager.getlocal("candyGetAlready"),this._packageStateTxt.textColor=TextFieldConst.COLOR_WHITE):(this._packageStateTxt.text=LanguageManager.getlocal("ac_recharge_Btntxt2"),this._packageStateTxt.textColor=TextFieldConst.COLOR_WARN_GREEN,this._btnTypeNum=2),this._typeBg.visible=!0):this._packageStateTxt.visible=!1}},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){this._data=null,this._packageStateTxt=null,this._typeBg=null,this._myScore=0,this._rewardNum=0,this._btnTypeNum=0,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_RESFESH_NEWYEAR_ITEM,this.update,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETNEWYEARREWARD),this.update,this),t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(NewYear1ScrollItem.prototype,"NewYear1ScrollItem");var NewYear2ScrollItem=function(t){function e(){var e=t.call(this)||this;return e._data=null,e.gemTF=null,e._gobtnTypeNum=0,e._tmpVo=null,e._tadayTaskTxt=null,e._tadayPackageTxt=null,e._goBtn2=null,e._collectflag=null,e._goBtn3=null,e}return __extends(e,t),e.prototype.initItem=function(t,i){this._data=i;var a=Api.acVoApi.getActivityVoByAidAndCode(AcNewYearView.AID,AcNewYearView.CODE);this._tmpVo=a,App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_RESFESH_NEWYEAR_ITEM,this.update,this);var n=BaseBitmap.create("public_9_bg14");n.width=600,n.height=152,this.addChild(n);var o=BaseBitmap.create("acnewyear_bottom2");this.addChild(o);var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),r=t+1;s.text=LanguageManager.getlocal("acNewYearViewTask"+r),s.width=30,s.x=10,s.y=30,s.lineSpacing=5,this.addChild(s);var l=BaseBitmap.create("acnewyear_chineseknot2_"+AcNewYearView.CODE);this.addChild(l);var h=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_BROWN);if(h.text="+"+i.getScore,this.addChild(h),"1002"==i.questType){var d=BaseBitmap.create("progress6_bg");this.addChild(d),d.x=60,d.y=20;var g=BaseBitmap.create("acnewyear_box");g.x=80,g.y=28,g.scaleX=.9,g.scaleY=.9,g.addTouchTap(this.onPackageHandler,this),this.addChild(g),l.x=280,l.y=65;var c=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_BROWN);c.text=LanguageManager.getlocal("acNewYearViewbuyDes"),c.x=210,c.y=80,this.addChild(c),h.x=330,h.y=80;var p=38,_=BaseLoadBitmap.create("itemicon1");_.scaleX=.4,_.scaleY=.4,_.x=450,_.y=35,this.addChild(_),this.gemTF=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_BROWN),this.gemTF.x=_.x+p+5,this.gemTF.y=_.y+5,this.gemTF.text=i.value,this.addChild(this.gemTF);var u=e.TADAY,C=LanguageManager.getlocal("acNewYearPackageName"+u+"_"+AcNewYearView.CODE),f=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_BROWN);f.text=C,f.x=210,f.y=20,this._tadayPackageTxt=f,this.addChild(f);var m=0;if(AcNewYearViewTab2.isStarBoo&&(m=a.getIdflag(i.questType),2==m)){var T=BaseBitmap.create("collectflag");return T.x=450,T.y=50,T.scaleX=.7,T.scaleY=.7,this.addChild(T),this.gemTF.visible=!1,void(_.visible=!1)}this._goBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"acPunishBuyItemBuy",this.buyHandler,this),this._goBtn.x=440,this._goBtn.y=80,this.addChild(this._goBtn),m&&m>0&&this._goBtn.setText("atkrace_buy_already"),0==AcNewYearViewTab2.isStarBoo?App.DisplayUtil.changeToGray(this._goBtn):App.DisplayUtil.changeToNormal(this._goBtn),this._goBtn&&GameData.serverTime>a.et-86400&&(App.DisplayUtil.changeToGray(this._goBtn),this._goBtn.touchEnabled=!1)}else{l.x=450,l.y=0,h.x=495,h.y=12;var T=BaseBitmap.create("collectflag");T.x=450,T.y=50,T.scaleX=.7,T.scaleY=.7,this.addChild(T),T.visible=!1,T.touchEnabled=!1,this._collectflag=T;var y=BaseBitmap.create("public_line1");y.x=50,y.y=44,this.addChild(y);var v=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_BROWN),A=0;AcNewYearViewTab2.isStarBoo&&this._tmpVo.taskinfo.info&&this._tmpVo.taskinfo.info[i.questType]&&(A=this._tmpVo.taskinfo.info[i.questType].v),v.text=LanguageManager.getlocal("acNewYearquestType"+i.questType,[A+"",i.value]),v.x=60,v.y=20,this._tadayTaskTxt=v,this.addChild(v);var w=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_BROWN);w.text=LanguageManager.getlocal("acNewYearViewneedNum"),w.x=60,w.y=80,this.addChild(w);var x=GameData.getRewardItemIcons(i.reward,!0);if(x&&x.length>0)for(var I=150,L=50,E=x.length,B=0;E>B;B++){var S=x[B];S.scaleX=.78,S.scaleY=.78,S.setPosition(I+B*(S.width*S.scaleX+12),L),this.addChild(S)}this._goBtn2=ComponentManager.getButton(ButtonConst.BTN_NORMAL_BLUE,"taskGoBtn",this.collectHandler,this),this._goBtn2.x=440,this._goBtn2.y=60,this.addChild(this._goBtn2),this._goBtn3=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"taskCollect",this.collectHandler,this),this._goBtn3.x=440,this._goBtn3.y=60,this._goBtn3.visible=!1,this.addChild(this._goBtn3),0==AcNewYearViewTab2.isStarBoo?App.DisplayUtil.changeToGray(this._goBtn2):App.DisplayUtil.changeToNormal(this._goBtn2),AcNewYearViewTab2.isStarBoo&&this.update()}},e.prototype.onPackageHandler=function(t){var e=Api.acVoApi.getActivityVoByAidAndCode(AcNewYearView.AID,AcNewYearView.CODE);if(0==e.isStart)return void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd"));var i={};i.reward=this._data.reward,i.isShowBtnType=2,ViewController.getInstance().openView(ViewConst.POPUP.ACNEWYEARPOPUPVIEW,i)},e.prototype.collectHandler=function(t){var e=Api.acVoApi.getActivityVoByAidAndCode(AcNewYearView.AID,AcNewYearView.CODE);if(0==e.isStart)return void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd"));if(0==AcNewYearViewTab2.isStarBoo){var i=LanguageManager.getlocal("acNewYearisOpen");return void App.CommonUtil.showTip(i)}if(this._gobtnTypeNum>0&&1==this._gobtnTypeNum)return App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETNEWYEARREWARD),this.refreshUIInfo,this),void NetManager.request(NetRequestConst.REQUEST_ACTIVITY_GETNEWYEARREWARD,{activeId:AcNewYearView.AID+"-"+AcNewYearView.CODE,questType:this._data.questType+"",ftype:1});if(GameData.serverTime>e.et-86400)return void App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_RESFESH_NEWYEAR_LIST);var a=this._data.openType,n=App.StringUtil.firstCharToUper(a);if("level"==a||"arrival"==a||""==a)ViewController.getInstance().openView(ViewConst.COMMON.PROMOTIONVIEW);else{if(Api[a+"VoApi"]&&Api[a+"VoApi"].isShowNpc){var o=Api[a+"VoApi"].isShowNpc();if(!o){var s=Api[a+"VoApi"].getLockedString?Api[a+"VoApi"].getLockedString():LanguageManager.getlocal("dailyTask_"+a+"Tip");return void App.CommonUtil.showTip(s?s:LanguageManager.getlocal("sysWaitOpen"))}}if("alliance"==a)return void Api.allianceVoApi.openMainView();if("studyatk"==a)return void Api.studyatkVoApi.openMainView();egret.getDefinitionByName(n+"View")?ViewController.getInstance().openView(n+"View"):egret.getDefinitionByName(n+"PopupView")?ViewController.getInstance().openView(n+"PopupView"):"recharge"==a&&ViewController.getInstance().openView(n+"VipView")}},e.prototype.refreshUIInfo=function(t){1==t.data.ret&&this.update()},e.prototype.update=function(){if(this._data&&this._data.questType){var t=this._tmpVo.getIdflag(this._data.questType);this._gobtnTypeNum=t}if(t?2==t?(this._collectflag&&(this._collectflag.visible=!0),this._goBtn2&&(this._goBtn2.visible=!1),this._goBtn3&&(this._goBtn3.visible=!1)):1==t&&(this._goBtn3&&(this._goBtn3.visible=!0),this._goBtn2&&(this._goBtn2.visible=!1)):(this._goBtn2&&(this._goBtn2.visible=!0),this._collectflag&&(this._collectflag.visible=!1),this._goBtn3&&(this._goBtn3.visible=!1)),"1002"!=this._data.questType){if(this._tmpVo.taskinfo.info&&this._tmpVo.taskinfo.info[this._data.questType])var e=0;this._tmpVo.taskinfo.info[this._data.questType]&&this._tmpVo.taskinfo.info[this._data.questType].v&&(e=this._tmpVo.taskinfo.info[this._data.questType].v,this._tadayTaskTxt.text=LanguageManager.getlocal("acNewYearquestType"+this._data.questType,[e+"",this._data.value]))}GameData.serverTime>this._tmpVo.et-86400&&(this._goBtn2&&(this._goBtn2.touchEnabled=!1,App.DisplayUtil.changeToGray(this._goBtn2)),this._goBtn&&(this._goBtn.touchEnabled=!1,App.DisplayUtil.changeToGray(this._goBtn)))},e.prototype.buyHandler=function(t){var e=Api.acVoApi.getActivityVoByAidAndCode(AcNewYearView.AID,AcNewYearView.CODE);if(0==e.isStart)return void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd"));if(0==AcNewYearViewTab2.isStarBoo){var i=LanguageManager.getlocal("acNewYearUnopenedDes");return void App.CommonUtil.showTip(i)}return this._data.value>Api.playerVoApi.getPlayerGem()?void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough")):(App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_BUYNEWYEARGIFT),this.useCallback,this),void NetManager.request(NetRequestConst.REQUEST_ACTIVITY_BUYNEWYEARGIFT,{activeId:AcNewYearView.AID+"-"+AcNewYearView.CODE}))},e.prototype.useCallback=function(t){if(t.data.ret){this._goBtn.visible=!1;var e=BaseBitmap.create("collectflag");e.x=450,e.y=50,e.scaleX=.7,e.scaleY=.7,this.addChild(e),App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.data.rewards))}},e.prototype.getSpaceY=function(){return 0},e.prototype.dispose=function(){this._goBtn3=null,this._goBtn2=null,this._goBtn=null,this._tadayTaskTxt=null,this._collectflag=null,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_RESFESH_NEWYEAR_ITEM,this.update,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_BUYNEWYEARGIFT),this.useCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETNEWYEARREWARD),this.refreshUIInfo,this),t.prototype.dispose.call(this)},e.TADAY=0,e}(ScrollListItem);__reflect(NewYear2ScrollItem.prototype,"NewYear2ScrollItem");var AcPunishBuyItemPopupView=function(t){function e(){var e=t.call(this)||this;return e._index=0,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_PUNISH_BUYITEM,this.doBuy,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.checkData,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_PAYMENT,this.refreshHandler,this);var t=BaseBitmap.create("public_9_resbg");t.x=20,t.y=15,this.addChildToContainer(t);var i=BaseLoadBitmap.create("itemicon1");i.setScale(.5),i.x=t.x-3,i.y=t.y+t.height/2-50+25,this.addChildToContainer(i);var a=Api.playerVoApi.getPlayerGemStr();this._text1=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._text1.x=t.x+50,this._text1.y=t.y+t.height/2-this._text1.height/2,this.addChildToContainer(this._text1);var n=ComponentManager.getButton("mainui_btn1","",this.addGoldBtnClickHandler,this);if(n.x=t.x+t.width-15,n.y=t.y+t.height/2-n.height/2,this.addChildToContainer(n),Api.switchVoApi.checkPunishVip()){var o=ComponentManager.getTextField(LanguageManager.getlocal("acPunishBuyItemDesc"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);o.setPosition(this.viewBg.width-o.width-20,t.y+t.height/2-n.height/2+6),this.addChildToContainer(o)}var s=BaseBitmap.create("public_9_probiginnerbg");s.width=535,s.height=535,s.x=this.viewBg.x+this.viewBg.width/2-s.width/2,s.y=75,this.addChildToContainer(s);for(var r=new Array,l=0;4>l;l++)r.push(l);this._dataList=new Array;for(var h=Config.AcCfg.getCfgByActivityIdAndCode("punish",e.code),l=1;5>l;l++)this._dataList.push(h.punishList[l.toString()]);var d=egret.Rectangle.create();d.setTo(0,0,525,535),this._scrollList=ComponentManager.getScrollList(AcPunishBuyItemScrollItem,this._dataList,d),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(s.x+5,s.y+8)},e.prototype.addGoldBtnClickHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.doBuy=function(t){var i=t.data;this._index=i.index,this.request(NetRequestConst.REQUEST_ACTIVITY_BUYPUNISHITEM,{activeId:e.aid+"-"+e.code,itemKey:i.key})},e.prototype.receiveData=function(t){if(t.data.cmd==NetRequestConst.REQUEST_ACTIVITY_BUYPUNISHITEM){if(t.data.data&&t.data.data.rewards){var e=GameData.formatRewardItem(t.data.data.rewards);e&&e.length>0&&App.CommonUtil.playRewardFlyAction(e)}var i=this._index,a=this._scrollList.getItemByIndex(i);a.refreshData(i);var n=Api.playerVoApi.getPlayerGemStr();this._text1.text=n}},e.prototype.refreshHandler=function(){this._scrollList.refreshData(this._dataList)},e.prototype.checkData=function(){this._text1.text=Api.playerVoApi.getPlayerGemStr()},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_PAYMENT,this.refreshHandler,this),this._scrollList=null,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_PUNISH_BUYITEM,this.doBuy,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.checkData,this),this._text1=null,this._index=null,this._dataList=null,t.prototype.dispose.call(this)},e.aid="",e.code="",e}(PopupView);__reflect(AcPunishBuyItemPopupView.prototype,"AcPunishBuyItemPopupView");var AcPunishBuyItemScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this._itemIndex=t,this._itemData=e,this.width=525,this.height=126+this.getSpaceY();var i=(t+1).toString(),a=BaseBitmap.create("public_9_bg14");a.width=this.width,a.height=148,a.scaleY=126/148,this.addChild(a),this._key=i;var n=Config.ItemCfg.getItemCfgById(e.item),o=n.getIconContainer(!0);o.setPosition(15,a.height/2*a.scaleY-o.width/2),o.name="icon",this.addChild(o);var s=ComponentManager.getTextField(n.name,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_YELLOW2);s.setPosition(o.x+o.width+10,10),this.addChild(s);var r=Api.acVoApi.getActivityVoByAidAndCode(AcPunishBuyItemPopupView.aid,AcPunishBuyItemPopupView.code),l=e.buyLimit;"number"==typeof e.buyLimit?l=e.buyLimit:e.buyLimit&&(l=Api.switchVoApi.checkPunishVip()?e.buyLimit[Api.playerVoApi.getPlayerVipLevel()]:e.buyLimit[0]);var h=0;r.item[(t+1).toString()]&&(h=r.item[(t+1).toString()]);var d=l-h,g=LanguageManager.getlocal("acPunishBuyItemLimit",[d.toString()]);if(Api.switchVoApi.checkPunishVip()&&Api.playerVoApi.getPlayerVipLevel()>0&&e.buyLimit&&"2"==i){g=LanguageManager.getlocal("acPunishBuyItemLimit2",[d.toString()]);var c=ComponentManager.getTextField("(",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);c.setPosition(s.x+s.width+5,s.y),this.addChild(c);var p=BaseLoadBitmap.create(Api.vipVoApi.getVipCfgByLevel(Api.playerVoApi.getPlayerVipLevel()).icon);this.addChild(p),p.setScale(.8),p.setPosition(c.x+c.width,s.y),e.buyLimit||(p.visible=!1)}this._numTF=ComponentManager.getTextField(g,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK),this._numTF.setPosition(s.x+s.width+5,s.y),this.addChild(this._numTF),Api.switchVoApi.checkPunishVip()&&Api.playerVoApi.getPlayerVipLevel()>0&&"2"==i&&this._numTF.setPosition(s.x+s.width+80,s.y),e.buyLimit||(this._numTF.visible=!1);var _=LanguageManager.getlocal("acPunishBuyItemScore",[e.getScore]),u=ComponentManager.getTextField(_,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);u.setPosition(s.x,s.y+s.height+7),this.addChild(u);for(var C="",t=0;t<e.drop.length;t++){var f=GameData.formatRewardItem(e.drop[t][0])[0];C=0==t?f.name:C+"、"+f.name}C=LanguageManager.getlocal("acPunishBuyItemGet",[C]);var m=ComponentManager.getTextField(C,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);m.setPosition(s.x,u.y+u.height+7),m.width=260,this.addChild(m);var T="itemicon2",y=0;0==this._itemIndex?y=e.costGold:1==this._itemIndex&&(T="itemicon1",y=e.costGem);var v=BaseLoadBitmap.create(T);v.x=400,v.y=5,v.setScale(.4),this.addChild(v);var A=ComponentManager.getTextField(y.toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);A.setPosition(445,s.y+7),A.width=260,this.addChild(A);var w="acPunishBuyItemBuy",x=ButtonConst.BTN_SMALL_YELLOW;e.buyLimit||(w="acPunishBuyItemGoNow",x=ButtonConst.BTN_SMALL_RED,v.visible=!1,A.visible=!1);var I=ComponentManager.getButton(x,w,this.chooseBtnClick,this);I.x=390,I.y=a.height/2*a.scaleY-I.height/2+10,this.addChild(I),I.setColor(TextFieldConst.COLOR_BLACK)},e.prototype.chooseBtnClick=function(){if(2!=this._itemIndex&&3!=this._itemIndex){var t=Api.acVoApi.getActivityVoByAidAndCode(AcPunishBuyItemPopupView.aid,AcPunishBuyItemPopupView.code),e=this._itemData.buyLimit;"number"==typeof this._itemData.buyLimit?e=this._itemData.buyLimit:this._itemData.buyLimit&&(e=Api.switchVoApi.checkPunishVip()?this._itemData.buyLimit[Api.playerVoApi.getPlayerVipLevel()]:this._itemData.buyLimit[0]);var i=0;t.item[(this._itemIndex+1).toString()]&&(i=t.item[(this._itemIndex+1).toString()]);var a=e-i;if(i||(a=e),0>=a)return void(Api.switchVoApi.checkPunishVip()?App.CommonUtil.showTip(LanguageManager.getlocal("acPunishBuyItemBuyTip2")):App.CommonUtil.showTip(LanguageManager.getlocal("acPunishBuyItemBuyTip")));if(0==this._itemIndex){if(Api.playerVoApi.getPlayerGold()<this._itemData.costGold)return void App.CommonUtil.showTip(LanguageManager.getlocal("servantInfo_levelupTip3"))}else if(1==this._itemIndex&&Api.playerVoApi.getPlayerGem()<this._itemData.costGem)return void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough"));App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_PUNISH_BUYITEM,{key:this._key,index:this._itemIndex})}2==this._itemIndex?ViewController.getInstance().openView(ViewConst.COMMON.SHOPVIEW_TAB2,{}):3==this._itemIndex&&(Api.acVoApi.checkActivityStartByAid("dailyCharge")?ViewController.getInstance().openView(ViewConst.COMMON.ACRECHARGEVIEW,{code:"1"}):ViewController.getInstance().openView(ViewConst.COMMON.SHOPVIEW_TAB1,{}))},e.prototype.refreshData=function(t){var e=Api.acVoApi.getActivityVoByAidAndCode(AcPunishBuyItemPopupView.aid,AcPunishBuyItemPopupView.code),i=this._itemData.buyLimit;"number"==typeof this._itemData.buyLimit?i=this._itemData.buyLimit:this._itemData.buyLimit&&(i=Api.switchVoApi.checkPunishVip()?this._itemData.buyLimit[Api.playerVoApi.getPlayerVipLevel()]:this._itemData.buyLimit[0]);var a=0;e.item[(t+1).toString()]&&(a=e.item[(t+1).toString()]);var n=i-a,o=LanguageManager.getlocal("acPunishBuyItemLimit",[n.toString()]);Api.switchVoApi.checkPunishVip()&&Api.playerVoApi.getPlayerVipLevel()>0&&"2"==this._key&&(o=LanguageManager.getlocal("acPunishBuyItemLimit2",[n.toString()])),this._numTF.text=o},e.prototype.getBtnClickHandler=function(){},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){this._numTF=null,this._key=null,this._itemData=null,this._itemIndex=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AcPunishBuyItemScrollItem.prototype,"AcPunishBuyItemScrollItem");var AcPunishExPopupView=function(t){function e(){var e=t.call(this)||this;return e._index=0,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_PUNISH_EXITEM,this.doBuy,this),this._pointText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK),this._pointText.y=11,this.addChildToContainer(this._pointText);var t=egret.Rectangle.create();t.setTo(0,0,540,710);for(var e=new Array,i=Config.AcCfg.getCfgByActivityIdAndCode(this.param.data.aid,this.param.data.code),a=1;20>a&&i.shop[a.toString()];a++)e.push(i.shop[a.toString()]);this._scrollList=ComponentManager.getScrollList(AcPunishExScrollItem,e,t),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(23,40),this.resetPointText()},e.prototype.doBuy=function(t){var e=t.data;this._index=e.index,this.request(NetRequestConst.REQUEST_ACTIVITY_BUYPUNISHSHOP,{activeId:this.param.data.aid+"-"+this.param.data.code,itemKey:e.key})},e.prototype.receiveData=function(t){if(t.data.cmd==NetRequestConst.REQUEST_ACTIVITY_BUYPUNISHSHOP){if(t.data.data&&t.data.data.rewards){var e=GameData.formatRewardItem(t.data.data.rewards);e&&e.length>0&&App.CommonUtil.playRewardFlyAction(e)}var i=this._index,a=this._scrollList.getItemByIndex(i);a.refreshData(i),this.resetPointText()}},e.prototype.resetPointText=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(this.param.data.aid,this.param.data.code);this._pointText.text=LanguageManager.getlocal("acPunishShopScore1",[t.score.toString()]),this._pointText.x=this.viewBg.width/2-this._pointText.width/2},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_PUNISH_EXITEM,this.doBuy,this),this._index=null,t.prototype.dispose.call(this)},e.aid="",e.code="",e}(PopupView);__reflect(AcPunishExPopupView.prototype,"AcPunishExPopupView");var AcPunishExScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=172+this.getSpaceX(),this.height=229+this.getSpaceY();var i=(t+1).toString();this._key=i,this._itemIndex=t,this._itemData=e;var a=new BaseDisplayObjectContainer,n=BaseBitmap.create("public_9_bg4");n.width=170,n.height=228,a.addChild(n);var o=BaseBitmap.create("public_9_cell_title");o.width=164,o.x=3,o.y=3,a.addChild(o);var s=(e.sell,e),r=GameData.formatRewardItem(s.sell)[0],l=ComponentManager.getTextField(r.name,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);
l.setPosition(n.width/2-l.width/2,7),a.addChild(l);var h=GameData.getItemIcon(r,!0);h.setPosition(n.width/2-h.width/2,35),h.name="icon",a.addChild(h),h.getChildByName("numLb").visible=!1;var d=Api.acVoApi.getActivityVoByAidAndCode(AcPunishExPopupView.aid,AcPunishExPopupView.code),g=e.limit,c=0;d.shop[(t+1).toString()]&&(c=d.shop[(t+1).toString()]);var p=g-c,_=TextFieldConst.COLOR_QUALITY_GREEN;0>=p&&(_=TextFieldConst.COLOR_WARN_RED);var u=LanguageManager.getlocal("buyNum",[_.toString(),p.toString()]);this._numTF=ComponentManager.getTextField(u,TextFieldConst.FONTSIZE_CONTENT_SMALL),this._numTF.setPosition(n.width/2-this._numTF.width/2,h.y+h.height+3),a.addChild(this._numTF),this._exchangeBtn=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"exchange",this.chooseBtnClick,this),this._exchangeBtn.setText(s.cost+LanguageManager.getlocal("pointNumber"),!1),this._exchangeBtn.setPosition(n.width/2-this._exchangeBtn.width/2,n.height-this._exchangeBtn.height-8),this._exchangeBtn.setColor(TextFieldConst.COLOR_BLACK),a.addChild(this._exchangeBtn),0>=p&&this._exchangeBtn.setEnable(!1),this.addChild(a)},e.prototype.chooseBtnClick=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(AcPunishExPopupView.aid,AcPunishExPopupView.code),e=this._itemData.limit,i=0;t.shop[(this._itemIndex+1).toString()]&&(i=t.shop[(this._itemIndex+1).toString()]);var a=e-i;return 0>=a?void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishShopTip1")):this._itemData.cost>t.score?void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishShopTip2")):void App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_PUNISH_EXITEM,{key:this._key,index:this._itemIndex})},e.prototype.refreshData=function(t){var e=Api.acVoApi.getActivityVoByAidAndCode(AcPunishExPopupView.aid,AcPunishExPopupView.code),i=this._itemData.limit,a=0;e.shop[(t+1).toString()]&&(a=e.shop[(t+1).toString()]);var n=i-a,o=TextFieldConst.COLOR_QUALITY_GREEN;0>=n&&(o=TextFieldConst.COLOR_WARN_RED);var s=LanguageManager.getlocal("buyNum",[o.toString(),n.toString()]);this._numTF.text=s,0>=n&&this._exchangeBtn.setEnable(!1)},e.prototype.getSpaceY=function(){return 5},e.prototype.getSpaceX=function(){return 5},e.prototype.dispose=function(){this._numTF=null,this._key=null,this._itemData=null,this._itemIndex=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AcPunishExScrollItem.prototype,"AcPunishExScrollItem");var AcPunishRankAllianceRewardScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this._cfgData=e,this._itemIndex=t,this.width=513;var i=BaseBitmap.create("public_9_cell_title");i.width=this.width,i.height=34,i.x=0,i.y=0,this.addChild(i);var a=BaseBitmap.create("public_line3");a.width=480,a.x=this.width/2-a.width/2,a.y=10,this.addChild(a);var n=e.rank[0],o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);Number(n)<4?o.text=LanguageManager.getlocal("acRank_rank"+n):o.text=o.text=LanguageManager.getlocal("acRank_rank5",[String(e.rank[0]),String(e.rank[1])]),o.x=this.width/2-o.width/2,o.y=5,this.addChild(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("acRank_alliance_masterget1"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);s.x=10,s.y=80,this.addChild(s);var r=GameData.formatRewardItem(e.reward1),l=new BaseDisplayObjectContainer;if(r)for(var h=.85,d=0;d<r.length;d++){var g=GameData.getItemIcon(r[d],!0,!0),c=d%4;g.x=110+7*(c+1)+g.width*h*c,g.y=(g.height+5)*Math.floor(d/4),g.scaleX=g.scaleY=h,l.addChild(g)}this.addChild(l),l.y=50,l.height=.85*l.height;var p=BaseBitmap.create("public_line1");p.x=this.width/2-p.width/2,p.y=l.y+l.height-20,this.addChild(p);var _=ComponentManager.getTextField(LanguageManager.getlocal("acRank_alliance_memberget"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);_.x=10,_.y=l.y+l.height+60,this.addChild(_);var u=GameData.formatRewardItem(e.reward2),C=new BaseDisplayObjectContainer;if(u)for(var h=.85,d=0;d<u.length;d++){var g=GameData.getItemIcon(u[d],!0,!0),c=d%4;g.x=110+7*(c+1)+g.width*h*c,g.y=(g.height+5)*Math.floor(d/4),g.scaleX=g.scaleY=h,C.addChild(g)}this.addChild(C),C.y=l.y+l.height+10,C.height=.85*C.height},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){this._itemIndex=null,this._key=null,this._wifeInfoVo=null,this._att1TF=null,this._att2TF=null,this._att3TF=null,this._skillLevelTF=null,this._updBtn=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AcPunishRankAllianceRewardScrollItem.prototype,"AcPunishRankAllianceRewardScrollItem");var AcPunishRankPopupView=function(t){function e(){var e=t.call(this)||this;return e._curTabIdx=0,e}return __extends(e,t),e.prototype.initView=function(){this._acVo=Api.acVoApi.getActivityVoByAidAndCode(e.aid,e.code);var t=["acPunishRankTab1","acPunishRankTab2"];Api.switchVoApi.checkPunishAllianceRank()&&(t=["acPunishRankTab1"]);var i=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,t,this.tabBtnClickHandler,this);i.x=35,i.y=15,this.addChildToContainer(i);var a=BaseBitmap.create("public_9_bg32");a.width=520,a.height=600,a.x=this.viewBg.width/2-a.width/2,a.y=60,this.addChildToContainer(a);var n=BaseBitmap.create("public_9_bg33");n.width=a.width,n.height=40,n.x=a.x,n.y=a.y,this.addChildToContainer(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("acRankPop_title1"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);o.x=n.x+40,o.y=n.y+8,this.addChildToContainer(o),this._titleTF=ComponentManager.getTextField(LanguageManager.getlocal("acRankPop_title2"),o.size,TextFieldConst.COLOR_LIGHT_YELLOW),this._titleTF.x=n.x+175,this._titleTF.y=o.y,this.addChildToContainer(this._titleTF);var s=ComponentManager.getTextField(LanguageManager.getlocal("acPunish_score"),o.size,TextFieldConst.COLOR_LIGHT_YELLOW);s.x=n.x+430-s.width/2,s.y=o.y,this.addChildToContainer(s);var r=BaseBitmap.create("public_9_bg1");r.width=a.width,r.height=100,r.x=a.x,r.y=a.y+a.height+9,this.addChildToContainer(r),this._nickNameTF=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._nickNameTF.text=LanguageManager.getlocal("acRank_mynick")+Api.playerVoApi.getPlayerName(),this._nickNameTF.x=r.x+20,this._nickNameTF.y=r.y+20,this.addChildToContainer(this._nickNameTF);var l="10000+",h=0;this._acData.myrank.myrank&&(l=String(this._acData.myrank.myrank),h=this._acData.myrank.value),this._myRankTF=ComponentManager.getTextField("",this._nickNameTF.size,TextFieldConst.COLOR_LIGHT_YELLOW),this._myRankTF.text=LanguageManager.getlocal("acRank_myrank",[l]),this._myRankTF.x=this._nickNameTF.x,this._myRankTF.y=this._nickNameTF.y+40,this.addChildToContainer(this._myRankTF),this._scoreTF=ComponentManager.getTextField("",this._nickNameTF.size,TextFieldConst.COLOR_LIGHT_YELLOW),this._scoreTF.text=LanguageManager.getlocal("acPunishScore",[this._acVo.v.toString()]),this._scoreTF.x=this._myRankTF.x+240,this._scoreTF.y=this._myRankTF.y,this.addChildToContainer(this._scoreTF);var d=this._acData.rankList,g=egret.Rectangle.create();g.setTo(0,0,this.viewBg.width,a.height-70),this._scrollList=ComponentManager.getScrollList(AcPunishRankScrollItem,d,g),this.addChildToContainer(this._scrollList),this._scrollList.y=n.y+50,this._scrollList.setEmptyTip(LanguageManager.getlocal("acPunishNoData")),1==this.param.data.tt?(this._curTabIdx=0,i.selectedIndex=0):(this._curTabIdx=1,i.selectedIndex=1),this.param.data.tt||(this._curTabIdx=0,i.selectedIndex=0),this._allianceRankTip=ComponentManager.getTextField("",19,TextFieldConst.COLOR_BROWN),this._allianceRankTip.text=LanguageManager.getlocal("acPunishRankTip"),this._allianceRankTip.x=this.viewBg.x+this.viewBg.width/2-this._allianceRankTip.width/2,this._allianceRankTip.y=this._myRankTF.y+55,this._allianceRankTip.visible=!1,this.addChildToContainer(this._allianceRankTip),this.refreshRankList()},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_ACTIVITY_GETPUNISHACTIVE,requestData:{activeId:e.aid+"-"+e.code}}},e.prototype.receiveData=function(t){t.data.cmd==NetRequestConst.REQUEST_ACTIVITY_GETPUNISHACTIVE&&(this._acData=t.data.data.punishActive,this._acVo=Api.acVoApi.getActivityVoByAidAndCode(e.aid,e.code))},e.prototype.rankBtnClick=function(){},e.prototype.tabBtnClickHandler=function(t){this._curTabIdx=t.index,this.refreshRankList()},e.prototype.refreshRankList=function(){var t=this._acData.rankList;if(0==this._curTabIdx){this._allianceRankTip.visible=!1;var e="10000+",i=0;this._nickNameTF.text=LanguageManager.getlocal("acRank_mynick")+Api.playerVoApi.getPlayerName(),this._titleTF.text=LanguageManager.getlocal("acRankPop_title2"),this._acData.myrank.myrank&&(e=String(this._acData.myrank.myrank),i=this._acData.myrank.value),this._myRankTF.text=LanguageManager.getlocal("acRank_myrank",[e]),this._scoreTF.text=LanguageManager.getlocal("acPunishScore",[this._acVo.v.toString()])}else{this._allianceRankTip.visible=!0,t=this._acData.arankList,this._titleTF.text=LanguageManager.getlocal("acRankPop_titleAlliance");var a=LanguageManager.getlocal("allianceRankNoAlliance"),e=LanguageManager.getlocal("nothing"),n=LanguageManager.getlocal("nothing"),i=0;this._nickNameTF.text=LanguageManager.getlocal("acRank_myAlliancenick")+e,this._titleTF.text=LanguageManager.getlocal("acRankPop_titleAlliance"),this._acData.amyrank.myrank&&(e=String(this._acData.amyrank.myrank),n=String(this._acData.amyrank.value)),0!=Api.playerVoApi.getPlayerAllianceId()&&(a=Api.playerVoApi.getPlayerAllianceName()),this._nickNameTF.text=LanguageManager.getlocal("acRank_myAlliancenick")+a,this._scoreTF.text=LanguageManager.getlocal("acPunishScore",[n]),this._myRankTF.text=LanguageManager.getlocal("acRank_myrank",[e])}this._scrollList.refreshData(t)},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.dispose=function(){this._scrollList=null,this._timeTF=null,this._selectChildData=null,this._acVo=null,this._titleTF=null,this._nickNameTF=null,this._myRankTF=null,this._scoreTF=null,this._allianceRankTip=null,t.prototype.dispose.call(this)},e.aid="",e.code="",e}(PopupView);__reflect(AcPunishRankPopupView.prototype,"AcPunishRankPopupView");var AcPunishRankRewardPopupView=function(t){function e(){var e=t.call(this)||this;return e._curTabIdx=0,e._acCDTxt=null,e}return __extends(e,t),e.prototype.initView=function(){this._acData=this.param.data.acData,this._acVo=Api.acVoApi.getActivityVoByAidAndCode(e.aid,e.code);var t=["acPunishRankRewardTab1","acPunishRankRewardTab2"];Api.switchVoApi.checkPunishAllianceRank()&&(t=["acPunishRankRewardTab1"]);var i=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,t,this.tabBtnClickHandler,this);i.x=35,i.y=15,this.addChildToContainer(i);var a=BaseBitmap.create("public_9_bg4");a.width=520,a.height=589,a.x=this.viewBg.x+this.viewBg.width/2-a.width/2,a.y=60,this.addChildToContainer(a);var n=BaseBitmap.create("public_9_probiginnerbg");n.width=520,n.height=105,n.x=this.viewBg.x+this.viewBg.width/2-n.width/2,n.y=a.y+a.height+5,this.addChildToContainer(n);var o="10000+",s=0;this._acData.myrank.myrank&&(o=String(this._acData.myrank.myrank),s=this._acData.myrank.value);var r=LanguageManager.getlocal("acPunishMyrank1",[o]);this._myRankTF=ComponentManager.getTextField(r,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._myRankTF.x=n.x+20,this._myRankTF.y=n.y+10,this.addChildToContainer(this._myRankTF);var l=LanguageManager.getlocal("nothing"),h=0;this._acData.amyrank.myrank&&(l=String(this._acData.amyrank.myrank),h=this._acData.myrank.value);var d=LanguageManager.getlocal("acPunishMyrank2",[l]);this._allianceRankTF=ComponentManager.getTextField(d,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._allianceRankTF.x=n.x+20,this._allianceRankTF.y=n.y+10,this.addChildToContainer(this._allianceRankTF),this._allianceRankTF.visible=!1,this._acCDTxt=ComponentManager.getTextField(r,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._acCDTxt.x=n.x+220,this._acCDTxt.y=n.y+10,this.addChildToContainer(this._acCDTxt);var g=Config.AcCfg.getCfgByActivityIdAndCode("punish",e.code),c=this._acVo.et-GameData.serverTime-86400*g.extraTime;this._acCDTxt&&c>0?this._acCDTxt.text=LanguageManager.getlocal("acFourPeople_acCD",[App.DateUtil.getFormatBySecond(c,1)]):this._acCDTxt.text=LanguageManager.getlocal("acFourPeople_acCD",[LanguageManager.getlocal("acFourPeoplea_acCDEnd")]),this._myBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"acPunishRankTab1",this.rankBtnClick,this),this._myBtn.x=this._myRankTF.x,this._myBtn.y=this._myRankTF.y+this._myRankTF.height+8,this.addChildToContainer(this._myBtn),this._myBtn.setColor(TextFieldConst.COLOR_BLACK),this._aBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"acPunishRankTab2",this.rankBtnClick2,this),this._aBtn.x=this._myRankTF.x,this._aBtn.y=this._myRankTF.y+this._myRankTF.height+8,this.addChildToContainer(this._aBtn),this._aBtn.setColor(TextFieldConst.COLOR_BLACK),this._aBtn.visible=!1;var p=ComponentManager.getTextField(LanguageManager.getlocal("acRanktip"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);p.x=230,p.y=n.y+60,this.addChildToContainer(p);for(var _=new Array,u=Config.AcCfg.getCfgByActivityIdAndCode("punish",e.code),C=1;9>C;C++)_.push(u.personRank[C.toString()]);var f=egret.Rectangle.create();f.setTo(0,0,508,a.height-20),this._scrollList=ComponentManager.getScrollList(AcPunishRankRewardScrollItem,_,f),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(a.x+5,a.y+10),this._scrollList.setEmptyTip(LanguageManager.getlocal("acPunishNoData"));for(var m=new Array,C=1;9>C;C++)u.allianceRank[C.toString()]&&m.push(u.allianceRank[C.toString()]);var T=egret.Rectangle.create();T.setTo(0,0,514,a.height-20),this._scrollList2=ComponentManager.getScrollList(AcPunishRankAllianceRewardScrollItem,m,T),this.addChildToContainer(this._scrollList2),this._scrollList2.setPosition(a.x+3,a.y+4),this._scrollList2.visible=!1,this._scrollList2.setEmptyTip(LanguageManager.getlocal("acPunishNoData"))},e.prototype.rankBtnClick=function(){AcPunishRankPopupView.aid=e.aid,AcPunishRankPopupView.code=e.code,ViewController.getInstance().openView(ViewConst.POPUP.ACPUNISHRANKPOPUPVIEW,{tt:1})},e.prototype.rankBtnClick2=function(){AcPunishRankPopupView.aid=e.aid,AcPunishRankPopupView.code=e.code,ViewController.getInstance().openView(ViewConst.POPUP.ACPUNISHRANKPOPUPVIEW,{tt:2})},e.prototype.tick=function(){var t=Config.AcCfg.getCfgByActivityIdAndCode("punish",e.code),i=this._acVo.et-GameData.serverTime-86400*t.extraTime;return this._acCDTxt&&i>0?(this._acCDTxt.text=LanguageManager.getlocal("acFourPeople_acCD",[App.DateUtil.getFormatBySecond(i,1)]),!0):(this._acCDTxt.text=LanguageManager.getlocal("acFourPeople_acCD",[LanguageManager.getlocal("acFourPeoplea_acCDEnd")]),!1)},e.prototype.tabBtnClickHandler=function(t){this._curTabIdx=t.index,this.refreshRankList()},e.prototype.refreshRankList=function(){this._acData.rankList;0==this._curTabIdx?(this._scrollList.visible=!0,this._scrollList2.visible=!1,this._aBtn.visible=!1,this._myBtn.visible=!0,this._myRankTF.visible=!0,this._allianceRankTF.visible=!1):(this._scrollList.visible=!1,this._scrollList2.visible=!0,this._aBtn.visible=!0,this._myBtn.visible=!1,this._myRankTF.visible=!1,this._allianceRankTF.visible=!0)},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.dispose=function(){this._scrollList=null,this._scrollList2=null,this._myBtn=null,this._myRankTF=null,this._aBtn=null,this._allianceRankTF=null,this._timeTF=null,this._selectChildData=null,this._acVo=null,t.prototype.dispose.call(this)},e.aid="",e.code="",e}(PopupView);__reflect(AcPunishRankRewardPopupView.prototype,"AcPunishRankRewardPopupView");var AcPunishRankRewardScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this._cfgData=e,this._itemIndex=t,this.width=508;var i=e.rank[0],a=GameData.formatRewardItem(e.reward);if(a)for(var n=.85,o=0;o<a.length;o++){var s=GameData.getItemIcon(a[o],!0,!0),r=o%4;s.x=110+7*(r+1)+s.width*n*r,s.y=(s.height+5)*Math.floor(o/4)+15,a.length<=4&&(s.y=(s.height+5)*Math.floor(o/4)+25),s.scaleX=s.scaleY=n,this.addChild(s)}this.height=.85*this.height;var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);Number(i)<4?l.text=LanguageManager.getlocal("acRank_rank"+i):l.text=l.text=LanguageManager.getlocal("acRank_rank5",[String(e.rank[0]),String(e.rank[1])]),l.x=20,l.y=this.height/2-l.height/2-7,a.length<=4&&(l.y=l.y+10),this.addChild(l);var h=BaseBitmap.create("public_line1");h.x=this.width/2-h.width/2,h.y=this.height+0,this.addChild(h)},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){this._itemIndex=null,this._key=null,this._wifeInfoVo=null,this._att1TF=null,this._att2TF=null,this._att3TF=null,this._skillLevelTF=null,this._updBtn=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AcPunishRankRewardScrollItem.prototype,"AcPunishRankRewardScrollItem");var AcPunishRankScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.height=52,this._nodeContainer=new BaseDisplayObjectContainer,this.addChild(this._nodeContainer);var i=16;if(t>2){var a=ComponentManager.getTextField("",20,TextFieldConst.COLOR_BROWN);a.text=String(t+1),a.x=90-a.width/2,a.y=i,this._nodeContainer.addChild(a),e.uid==Api.playerVoApi.getPlayerID()&&(a.textColor=TextFieldConst.COLOR_WARN_YELLOW)}else{var n=BaseLoadBitmap.create("rank_"+String(t+1));n.width=51,n.height=47,n.x=90-n.width/2,n.y=3,this.addChild(n)}var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);o.text=e.name,o.x=245-o.width/2,o.y=i,this._nodeContainer.addChild(o);var s=ComponentManager.getTextField("",o.size,TextFieldConst.COLOR_BROWN);s.text=String(e.value),s.x=460-s.width/2,s.y=i,this._nodeContainer.addChild(s),(e.uid==Api.playerVoApi.getPlayerID()||e.id==Api.playerVoApi.getPlayerAllianceId())&&(o.textColor=TextFieldConst.COLOR_WARN_YELLOW,s.textColor=TextFieldConst.COLOR_WARN_YELLOW);var r=BaseLoadBitmap.create("rank_line");r.width=500,r.height=2,r.x=30,r.y=50,this._nodeContainer.addChild(r)},e.prototype.getSpaceX=function(){return 0},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AcPunishRankScrollItem.prototype,"AcPunishRankScrollItem");var AcPunishReportView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["adult_updtitle"])},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getBgName=function(){return"public_9_bg8"},e.prototype.initView=function(){this.addTouchTap(this.touchTap,this,null),this.viewBg.touchEnabled=!0;var t=BaseBitmap.create("public_9_wordbg");t.height=300,t.setPosition(GameConfig.stageWidth/2-t.width/2,GameConfig.stageHeigth/2-t.height/2),this.addChild(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("acPunishReportView-"+this.param.data.code),TextFieldConst.FONTSIZE_TITLE_SMALL);e.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,e.setPosition(t.width/2-e.width/2,t.y+40),this.addChild(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("acPunishReportDesc-"+this.param.data.code),TextFieldConst.FONTSIZE_CONTENT_COMMON);i.textColor=TextFieldConst.COLOR_WHITE,i.lineSpacing=20,i.width=t.width-60,i.setPosition(t.width/2-i.width/2,t.y+80),this.addChild(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("clickContinue"),TextFieldConst.FONTSIZE_TITLE_SMALL);a.textColor=TextFieldConst.COLOR_WARN_GREEN,a.width=t.width-60,a.setPosition(470,t.y+260),this.addChild(a)},e.prototype.touchTap=function(){this.hide()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseView);__reflect(AcPunishReportView.prototype,"AcPunishReportView");var AcPunishView=function(t){function e(){var e=t.call(this)||this;return e._punishItemVoList={},e._activityTimerText=null,e._acCDTxt=null,e._score1Text=null,e._score2Text=null,e._selectIndex=-1,e._lastTime=0,e._touchSwitch=!0,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["forpeople_top","punish_box_close","punish_box_open","wifeview_bottombg","acpunish","taoxinani","punish_rank_icon","punish_body","punish_head1","punish_head2","punish_body2","punish_head2_1","punish_head2_2","punish_light","punish_ani1","punish_ani2","punish_ani3","punish_ani4","punish_rank_name","punish_bigbg","btn_buy_tool_down","btn_buy_tool","btn_buy_tool2_down","btn_buy_tool2","progress8","punish_buyitem","progress3_bg","itemeffect","punish_bigbg2","punish_ani41","punish_ani42","punish_bigbg4","punish_nian","punish_nian1"])},e.prototype.initView=function(){this._lastTime=App.DateUtil.getWeeTs(GameData.serverTime),this._acVo=Api.acVoApi.getActivityVoByAidAndCode("punish",this.code);var t=BaseBitmap.create("commonview_bg1");t.width=GameConfig.stageWidth,t.height=180,this.addChildToContainer(t),this._punishItemList=new Array,this.showText(),this.showList(),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_BUYPUNISHITEM),this.buyCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_BUYPUNISHSHOP),this.exCallback,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_ITEM,this.buyCallback,this);var e=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code);this._acCDTxt.text=LanguageManager.getlocal("acPunishTime",[e.activeTime[0],e.activeTime[1]]),this._acCDTxt.x=10,this._activityTimerText.x=10,this.refreshState(),this.runText(),this.checkState()},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_ACTIVITY_GETPUNISHACTIVE,requestData:{activeId:this.acVo.aidAndCode}}},e.prototype.showText=function(){var t="punish_bigbg";"2"==this.code?t="punish_bigbg2":"4"==this.code&&(t="punish_bigbg4");var e=BaseBitmap.create(t);this.container.addChildAt(e,0),e.y=20;var i=BaseBitmap.create("forpeople_top");if(this.addChildToContainer(i),i.y=20,"1"==this.code){this._bodyContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._bodyContainer);var a=BaseBitmap.create("punish_body2");this._bodyContainer.addChild(a),a.y=0,this._headPic=BaseBitmap.create("punish_head2_1"),this._headPic.y=45,this._headPic.x=36,this._bodyContainer.addChild(this._headPic),this._bodyContainer.x=GameConfig.stageWidth/2-this._bodyContainer.width/2,this._bodyContainer.y=230}else if("3"==this.code){this._bodyContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._bodyContainer);var a=BaseBitmap.create("punish_body");this._bodyContainer.addChild(a),a.y=0,this._headPic=BaseBitmap.create("punish_head1"),this._headPic.y=45,this._headPic.x=36,this._bodyContainer.addChild(this._headPic),this._bodyContainer.x=GameConfig.stageWidth/2-this._bodyContainer.width/2,this._bodyContainer.y=230}else"4"==this.code&&(this._bodyContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._bodyContainer),this._headPic=BaseBitmap.create("punish_nian"),this._bodyContainer.addChild(this._headPic),this._bodyContainer.x=GameConfig.stageWidth/2-this._bodyContainer.width/2,this._bodyContainer.y=230);this._activityTimerText=ComponentManager.getTextField(Api.playerVoApi.getPlayerGem().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._activityTimerText.x=30,this._activityTimerText.y=109;App.DateUtil.getFormatBySecond(this.acVo.st,7),App.DateUtil.getFormatBySecond(this.acVo.et-86400,7);this._activityTimerText.text=this.acVo.getAcLocalTime(!0),this.addChildToContainer(this._activityTimerText);var n=ComponentManager.getTextField(Api.playerVoApi.getPlayerGem().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);n.text=LanguageManager.getlocal("acFourPeople_acCD",[""]),n.x=this._activityTimerText.x,n.y=this._activityTimerText.y+33,this.addChildToContainer(n),this._acCDTxt=n;var o=BaseBitmap.create("public_9_probiginnerbg");o.width=190,o.height=63,o.x=440,o.y=100,this.addChildToContainer(o);var s=LanguageManager.getlocal("acPunishScore2",[this._acVo.v.toString()]);this._score1Text=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._score1Text.x=o.x+20,this._score1Text.y=o.y+7,this.addChildToContainer(this._score1Text);var r=LanguageManager.getlocal("acPunishScore1",[this._acVo.score.toString()]);this._score2Text=ComponentManager.getTextField(r,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._score2Text.x=this._score1Text.x,this._score2Text.y=this._score1Text.y+this._score1Text.height+8,this.addChildToContainer(this._score2Text);var l=BaseBitmap.create("public_ac_notice_bg");l.width=GameConfig.stageWidth,l.x=0,l.y=185,this.addChildToContainer(l);var h=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code),d=BaseBitmap.create("wifeview_bottombg");if(d.width=GameConfig.stageWidth,d.height=96,d.x=0,d.y=GameConfig.stageHeigth-this.container.y-d.height,this.addChildToContainer(d),!Api.switchVoApi.checkOpenShenhe()){var g=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"acPunishRankRewardPopupViewTitle",this.rankRewardBtnCilck,this);g.x=85,g.y=d.y+d.height/2-g.height/2,this.addChildToContainer(g),g.setColor(TextFieldConst.COLOR_BLACK)}var c=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"dinnerExchangePopupViewTitle",this.exchangeCilck,this);if(c.x=390,c.y=d.y+d.height/2-30,this.addChildToContainer(c),c.setColor(TextFieldConst.COLOR_BLACK),"3"==this.code){var p=ComponentManager.getButton("btn_buy_tool2","",this.butItemBtnCilck,this);p.x=0,p.y=GameConfig.stageHeigth-this.container.y-d.height-120,this.addChildToContainer(p)}else{var p=ComponentManager.getButton("btn_buy_tool","",this.butItemBtnCilck,this);p.x=0,p.y=GameConfig.stageHeigth-this.container.y-d.height-120,this.addChildToContainer(p)}var _=BaseBitmap.create("punish_buyitem");if(_.x=80,_.y=GameConfig.stageHeigth-this.container.y-d.height-30,_.anchorOffsetX=_.width/2,_.anchorOffsetY=_.height/2,this.addChildToContainer(_),this._tw=egret.Tween.get(_,{loop:!0}),this._tw.to({scaleX:1.15,scaleY:1.15},700).to({scaleX:1,scaleY:1},700),!Api.switchVoApi.checkOpenShenhe()){var u=BaseBitmap.create("mainui_bottombtnbg");u.x=GameConfig.stageWidth-u.width-20,u.y=GameConfig.stageHeigth-this.container.y-d.height-80,this.addChildToContainer(u);var C=BaseBitmap.create("punish_rank_icon");C.x=u.x+u.width/2-C.width/2,C.y=u.y+5,this.addChildToContainer(C);var f=BaseBitmap.create("punish_rank_name");f.x=u.x+u.width/2-f.width/2,f.y=C.y+50,C.addTouchTap(this.rankCilck,this),this.addChildToContainer(f)}this._progressBar=ComponentManager.getProgressBar("progress8","progress3_bg",562),this._progressBar.x=GameConfig.stageWidth/2-this._progressBar.width/2,this._progressBar.y=l.y+l.height+30,this.addChildToContainer(this._progressBar);var m="";"2"==this.code?(m=(100-this._acData.hp/h.Hp*100).toFixed(3),this._progressBar.setPercentage(1-this._acData.hp/h.Hp)):(m=Math.floor(this._acData.hp/h.Hp*100).toString(),this._progressBar.setPercentage(this._acData.hp/h.Hp)),this._levelTxt=ComponentManager.getTextField(m+"%",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this._levelTxt.x=this._progressBar.x+this._progressBar.width/2-this._levelTxt.width/2,this._levelTxt.y=this._progressBar.y+this._progressBar.height/2-this._levelTxt.height/2,this.addChildToContainer(this._levelTxt);var T="acPunishBtn";"2"==this.code?T="useBtn":"3"==this.code?T="acPunishBtn2":"4"==this.code&&(T="acPunishBtn3"),this._chooseBtn=ComponentManager.getButton(ButtonConst.BTN_BIG_RED,T,this.chooseBtnClick,this),this._chooseBtn.x=this.width/2-this._chooseBtn.width/2,this._chooseBtn.y=GameConfig.stageHeigth-this.container.y-d.height-80,this.addChildToContainer(this._chooseBtn),this._chooseBtn.setColor(TextFieldConst.COLOR_BLACK);var y=LanguageManager.getlocal("acPunishOpenTime",["00:00:00"]);this._openTxt=ComponentManager.getTextField(y,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._openTxt.x=GameConfig.stageWidth/2-this._openTxt.width/2,this._openTxt.y=350,this.addChildToContainer(this._openTxt),this._boxContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._boxContainer),this._lightSp=BaseBitmap.create("public_rotatelight"),this._lightSp.scaleX=1.5,this._lightSp.scaleY=1.5,this._lightSp.anchorOffsetX=this._lightSp.width/2,this._lightSp.anchorOffsetY=this._lightSp.height/2,this._lightSp.setPosition(GameConfig.stageWidth/2,GameConfig.stageHeigth/2),egret.Tween.get(this._lightSp,{loop:!0}).to({rotation:360},3e3),this._boxContainer.addChild(this._lightSp),this._boxSp=BaseBitmap.create("punish_box_close"),this._boxSp.x=GameConfig.stageWidth/2-this._boxSp.width/2,this._boxSp.y=GameConfig.stageHeigth/2-this._boxSp.height/2,this._boxContainer.addChild(this._boxSp),this._boxSp.addTouchTap(this.getBoxClick,this);var v=BaseBitmap.create("public_searchdescbg");v.x=GameConfig.stageWidth/2-v.width/2,v.y=this._boxSp.y+this._boxSp.height+50,this._boxContainer.addChild(v),this._boxDesc=ComponentManager.getTextField(LanguageManager.getlocal("acPunishBoxDesc-"+this.code),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._boxDesc.x=GameConfig.stageWidth/2-this._boxDesc.width/2,this._boxDesc.y=v.y+v.height/2-this._boxDesc.height/2,this._boxContainer.addChild(this._boxDesc),this.tick(),this._wordsContanier=new BaseDisplayObjectContainer,this._wordsContanier.x=50,this._wordsContanier.y=300,this.addChildToContainer(this._wordsContanier);var A=BaseBitmap.create("public_9_bg25");A.x=0,A.y=0,A.width=200,A.height=78,this._wordsContanier.addChild(A);var w=BaseBitmap.create("public_9_bg25_tail");w.x=150,w.y=A.y+A.height-3,w.skewY=180,this._wordsContanier.addChild(w),this._wordsTF=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._wordsTF.text=LanguageManager.getlocal("acPunishHitTip"),this._wordsTF.x=A.x+20,this._wordsTF.y=A.y+20,this._wordsTF.width=180,this._wordsTF.height=80,this._wordsContanier.addChild(this._wordsTF),this._wordsContanier.visible=!1},e.prototype.refreshState=function(){var t=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code),e=(this._acVo.st,App.DateUtil.getWeeTs(GameData.serverTime));if(GameData.serverTime-e<3600*t.activeTime[0])this._openTxt.visible=!0,this.setBoxVisible(!1),this.setBossVisible(!1);else if(this._openTxt.visible=!1,this._acData.hp<=0)this.setBoxVisible(!0),this.setBossVisible(!1),this._boxDesc.text=LanguageManager.getlocal("acPunishGetBoxDesc-"+this.code),this._boxDesc.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,this._acVo.get?(this._boxSp.texture=ResourceManager.getRes("punish_box_open"),this._lightSp.visible=!0):(this._boxSp.texture=ResourceManager.getRes("punish_box_close"),this._lightSp.visible=!1);else{var i=this._acVo.et-GameData.serverTime-86400*t.extraTime;GameData.serverTime-e>3600*t.activeTime[1]||0>i?(this.setBoxVisible(!0),this.setBossVisible(!1),this._boxDesc.text=LanguageManager.getlocal("acPunishBoxDesc-"+this.code),this._boxDesc.textColor=TextFieldConst.COLOR_WARN_RED,this._lightSp.visible=!1,App.DisplayUtil.changeToGray(this._boxSp),0>i?this._openTxt.visible=!1:this._openTxt.visible=!0):(this.setBoxVisible(!1),this.setBossVisible(!0))}},e.prototype.checkState=function(){var t=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code),e=(this._acVo.st,App.DateUtil.getWeeTs(GameData.serverTime));if(GameData.serverTime-e<3600*t.activeTime[0]);else if(this._openTxt.visible=!1,this._acData.hp<=0);else{var i=this._acVo.et-GameData.serverTime-86400*t.extraTime;GameData.serverTime-e>3600*t.activeTime[1]||0>i||ViewController.getInstance().openView(ViewConst.BASE.ACPUNISHREPORTVIEW,{aid:this.aid,code:this.code})
}},e.prototype.getState=function(){var t=0,e=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code),i=(this._acVo.st,App.DateUtil.getWeeTs(GameData.serverTime)),a=this._acVo.et-GameData.serverTime-86400*e.extraTime;if(GameData.serverTime-i<3600*e.activeTime[0]&&a>0)t=1;else if(this._openTxt.visible=!1,this._acData.hp<=0)t=2;else{var n=this._acVo.et-GameData.serverTime-86400*e.extraTime;t=GameData.serverTime-i>3600*e.activeTime[1]||0>n?0>n?3:4:5}return t},e.prototype.setBoxVisible=function(t){this._boxContainer.visible=t},e.prototype.setBossVisible=function(t){this._levelTxt.visible=t,this._progressBar.visible=t,this._chooseBtn.visible=t,this._bodyContainer&&(this._bodyContainer.visible=t);for(var e=0;e<this._punishItemList.length;e++){var i=this._punishItemList[e];i.visible=t}},e.prototype.setSelect=function(t){if(this._selectItem&&this._selectItem.getChildByName("select")){this._selectItem.removeChild(this._selectItem.getChildByName("select"));var e=this._selectItem.getChildByName("select");e=null}this._selectItem=this._punishItemList[t];var i=BaseBitmap.create("itembg_selected");i.width=108,i.height=104,i.x=0,i.y=0,i.name="select",this._selectItem.addChild(i),this._selectIndex=t},e.prototype.chooseBtnClick=function(){if(-1==this._selectIndex)return void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishSelectItem"));if(this._touchSwitch){var t=this._punishItemVoList[(this._selectIndex+1).toString()],e=Api.itemVoApi.getItemNumInfoVoById(Number(t.item));if(0>=e){var i=LanguageManager.getlocal("acPunishBuyTitleDesc");return void ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"acPunishBuyTitle",msg:i,callback:this.doBuy,handler:this,needCancel:!0})}this._touchSwitch=!1,"2"==this.code?this.doCodeTwoLightAni():"3"==this.code?this.doAni1():"4"==this.code?this.doYanHuaAni():this.doAni2()}},e.prototype.doYanHuaAni=function(){var t=this,e=this._selectIndex+1+1812,i=BaseBitmap.create("itemicon"+e);i.rotation=-20;var a=new BaseDisplayObjectContainer;a.x=GameConfig.stageWidth/2-i.width/2*i.scaleX,a.addChild(i),a.y=this._chooseBtn.y-a.height-80,this.container.addChildAt(a,10),i.alpha=0;var n=App.MathUtil.getRandom(0,50);egret.Tween.get(i,{loop:!1}).to({alpha:1},500).wait(300).call(function(){},this),egret.Tween.get(a,{loop:!1}).to({y:this._chooseBtn.y-a.height-230,x:a.x-n,scaleX:.5,scaleY:.5},500).call(function(){t.removeChildFromContainer(a),a=null,i=null,t.doNianShouAni()},this)},e.prototype.doNianShouAni=function(){var t=this;SoundManager.playEffect("effect_punish_boom");var e=[1,3,5,7];this._selectIndex+1+1812;this._headPic.texture=ResourceManager.getRes("punish_nian1"),egret.Tween.get(this._headPic,{loop:!1}).wait(500).call(function(){t._headPic.texture=ResourceManager.getRes("punish_nian")},this);for(var i=function(){var e=App.MathUtil.getRandom(1,3),i=BaseBitmap.create("punish_ani4"+e);i.rotation=-20,i.setScale(1.3);var o=new BaseDisplayObjectContainer,s=App.MathUtil.getRandom(0,100),r=App.MathUtil.getRandom(-20,80);o.x=GameConfig.stageWidth/2-i.width/2*i.scaleX+s,o.addChild(i),o.y=a._chooseBtn.y-o.height-180+r,a.container.addChildAt(o,10),egret.Tween.get(i,{loop:!1}).wait(500).call(function(){t._touchSwitch=!0},a),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,o.setScale(.1),egret.Tween.get(o,{loop:!1}).wait(100*n).to({scaleX:1,scaleY:1},100).call(function(){t.removeChildFromContainer(o),o=null,i=null},a)},a=this,n=0;n<e[this._selectIndex];n++)i();var o=(this._selectIndex+1).toString();this.request(NetRequestConst.REQUEST_ACTIVITY_USEPUNISHITEM,{activeId:this.aid+"-"+this.code,itemKey:o})},e.prototype.doCodeTwoLightAni=function(){var t=this,e=this._selectIndex+1+1804,i=BaseBitmap.create("itemicon"+e);i.rotation=-20,i.setScale(1.7);var a=new BaseDisplayObjectContainer;a.x=GameConfig.stageWidth/2-i.width/2*i.scaleX,a.addChild(i),a.y=this._chooseBtn.y-a.height-80,this.container.addChildAt(a,1),i.alpha=0;var n=App.MathUtil.getRandom(0,50);egret.Tween.get(i,{loop:!1}).to({alpha:1},500).wait(300).call(function(){t._touchSwitch=!0},this),egret.Tween.get(a,{loop:!1}).to({y:0,x:a.x+n},2500).call(function(){t.removeChildFromContainer(a),a=null,i=null},this);var o=(this._selectIndex+1).toString();this.request(NetRequestConst.REQUEST_ACTIVITY_USEPUNISHITEM,{activeId:this.aid+"-"+this.code,itemKey:o})},e.prototype.doAni1=function(){var t=(this._selectIndex+1).toString(),e=[200,200,220,220],i=[300,300,140,300],a="punish_"+t+"_",n=ComponentManager.getCustomMovieClip(a,2,100);n.frameImages=["punish_"+t+"_1","punish_"+t+"_2"],n.x=e[this._selectIndex],n.y=i[this._selectIndex],this.addChildToContainer(n),n.playWithTime(1),n.setEndCallBack(this.nextAni,this)},e.prototype.doAni2=function(){SoundManager.playEffect(SoundConst.EFFECT_PRISON_HIT),this._wordsContanier.visible=!0;var t=App.MathUtil.getRandom(1,4);this._wordsTF.text=LanguageManager.getlocal("acPunishHitTip"+t);var e=(this._selectIndex+1).toString(),i=new BaseDisplayObjectContainer,a=BaseBitmap.create("punish_ani"+e);i.setScale(2.5),this.addChildToContainer(i),i.addChild(a),egret.Tween.get(i).to({scaleX:1,scaleY:1},200).call(function(t){t&&this.nextAni2(t)}.bind(this,i),this),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2;var n=[250,320,250,300],o=[500,500,440,400];i.x=n[this._selectIndex],i.y=o[this._selectIndex]},e.prototype.nextAni2=function(t){var e=(this._selectIndex+1).toString();this.request(NetRequestConst.REQUEST_ACTIVITY_USEPUNISHITEM,{activeId:this.aid+"-"+this.code,itemKey:e}),this._headPic.texture=ResourceManager.getRes("punish_head2_2");var i=BaseBitmap.create("punish_light");t.addChildAt(i,0),egret.Tween.removeTweens(t),egret.Tween.get(t).wait(200).to({alpha:0},500).call(function(t){t&&(egret.Tween.removeTweens(t),this._headPic.texture=ResourceManager.getRes("punish_head2_1"),t.dispose(),this._touchSwitch=!0,this._wordsContanier.visible=!1)}.bind(this,t),this)},e.prototype.doBuy=function(){AcPunishBuyItemPopupView.aid=this.aid,AcPunishBuyItemPopupView.code=this.code,ViewController.getInstance().openView(ViewConst.POPUP.ACPUNISHBUYITEMPOPUPVIEW,{})},e.prototype.nextAni=function(t){var e=(this._selectIndex+1).toString(),i=App.MathUtil.getRandom(1,5);SoundManager.playEffect("effect_punish_"+i),SoundManager.playEffect("effect_item_"+e);var a=[200,200,220,220],n=[300,300,140,300],o="punish_"+e+"_",s=ComponentManager.getCustomMovieClip(o,2,100);s.frameImages=["punish_"+e+"_3","punish_"+e+"_4"],s.x=a[this._selectIndex],s.y=n[this._selectIndex],this.addChildToContainer(s),this._touchSwitch=!1,s.playWithTime(1),this._headPic.texture=ResourceManager.getRes("punish_head2"),s.setEndCallBack(this.setEnd,this),t.dispose()},e.prototype.setEnd=function(t){var e=(this._selectIndex+1).toString();this._headPic.texture=ResourceManager.getRes("punish_head1"),this.request(NetRequestConst.REQUEST_ACTIVITY_USEPUNISHITEM,{activeId:"punish-"+this.code,itemKey:e}),this._touchSwitch=!0;egret.Tween.get(t).to({alpha:0},300).call(function(t){t&&(egret.Tween.removeTweens(t),t.dispose())}.bind(this,t),this)},e.prototype.getBoxClick=function(){return this._acVo.get?void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishGetBoxTip1")):void(this._acData.hp>0||this.request(NetRequestConst.REQUEST_ACTIVITY_GETPUNISHREWARD,{activeId:"punish-"+this.code}))},e.prototype.receiveData=function(t){if(t.data.cmd==NetRequestConst.REQUEST_ACTIVITY_USEPUNISHITEM){if(t.data.data&&t.data.data.rewards){var e=GameData.formatRewardItem(t.data.data.rewards);e&&e.length>0&&App.CommonUtil.playRewardFlyAction(e)}t.data.data.hasKill?this._acData.hp=0:this._acData=t.data.data.punishActive,this._acVo=Api.acVoApi.getActivityVoByAidAndCode("punish",this.code),this.buyCallback(null),this.refreshState();var i=[],a=t.data.data.score1,n=LanguageManager.getlocal("acPunishGetScoreTxt1",[String(a)]);i.push({tipMessage:n});var o=t.data.data.score2;if(o>0){var s=LanguageManager.getlocal("acPunishGetScoreTxt2",[String(o)]);i.push({tipMessage:s})}egret.setTimeout(function(){App.CommonUtil.playRewardFlyAction(i)},this,800)}else if(t.data.cmd==NetRequestConst.REQUEST_ACTIVITY_GETPUNISHACTIVE)this._acData=t.data.data.punishActive,this._acVo=Api.acVoApi.getActivityVoByAidAndCode("punish",this.code);else if(t.data.cmd==NetRequestConst.REQUEST_ACTIVITY_GETPUNISHREWARD){if(t.data.data&&t.data.data.rewards){var e=GameData.formatRewardItem(t.data.data.rewards);e&&e.length>0&&App.CommonUtil.playRewardFlyAction(e)}this.refreshState()}},e.prototype.butItemBtnCilck=function(){var t=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code),e=(this._acVo.st,App.DateUtil.getWeeTs(GameData.serverTime)),i=this._acVo.et-GameData.serverTime-86400*t.extraTime;return GameData.serverTime-e>3600*t.activeTime[1]||0>i?void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd")):(AcPunishBuyItemPopupView.aid=this.aid,AcPunishBuyItemPopupView.code=this.code,void ViewController.getInstance().openView(ViewConst.POPUP.ACPUNISHBUYITEMPOPUPVIEW,{}))},e.prototype.rankRewardBtnCilck=function(){AcPunishRankRewardPopupView.aid=this.aid,AcPunishRankRewardPopupView.code=this.code,ViewController.getInstance().openView(ViewConst.POPUP.ACPUNISHRANKREWARDPOPUPVIEW,{acData:this._acData,aid:this.aid,code:this.code})},e.prototype.rankCilck=function(){AcPunishRankPopupView.aid=this.aid,AcPunishRankPopupView.code=this.code,ViewController.getInstance().openView(ViewConst.POPUP.ACPUNISHRANKPOPUPVIEW,{aid:this.aid,code:this.code})},e.prototype.exchangeCilck=function(){AcPunishExPopupView.aid=this.aid,AcPunishExPopupView.code=this.code,ViewController.getInstance().openView(ViewConst.POPUP.ACPUNISHEXPOPUPVIEW,{aid:this.aid,code:this.code})},e.prototype.getRuleInfo=function(){return"acPunish_Rule-"+this.code},e.prototype.addChildToContainer=function(t){t&&(this.container.addChild(t),this.container.y=0)},e.prototype.showList=function(){var t=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code);this._punishItemVoList=t.punishList;for(var e=1;5>e;e++){var i=this.getItem(this._punishItemVoList[e.toString()]);this._punishItemList.push(i),i.setScale(.9),i.x=77+(.9*i.width+10)*(e-1),i.y=GameConfig.stageHeigth-this.container.y-350,this.addChild(i),i.addTouchTap(this.itemClick,this,[e-1])}for(var e=0;e<this._punishItemList.length;e++){var a=this._punishItemVoList[(e+1).toString()],n=Api.itemVoApi.getItemNumInfoVoById(Number(a.item));if(n>0)return void this.setSelect(e)}},e.prototype.getItem=function(t){var e=new BaseDisplayObjectContainer,i=Config.ItemCfg.getItemCfgById(Number(t.item)),a=BaseBitmap.create(i.iconBg);a.name="itembg",e.addChild(a);var n=BaseLoadBitmap.create(i.icon);e.addChild(n),n.name="itemicon",n.setPosition(4,3);var o=Api.itemVoApi.getItemNumInfoVoById(Number(t.item)),s=ComponentManager.getTextField(o.toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL);s.setPosition(a.width-8-s.width,a.height-8-s.height),e.addChild(s),s.name="numLb";var r=BaseBitmap.create("public_numbg");r.x=a.width/2-r.width/2,r.y=a.height+5,e.addChild(r);var l=ComponentManager.getTextField(i.name,TextFieldConst.FONTSIZE_CONTENT_COMMON);return l.x=r.x+r.width/2-l.width/2,l.y=r.y+r.height/2-l.height/2,e.addChild(l),0>=o&&(App.DisplayUtil.changeToGray(n),App.DisplayUtil.changeToGray(a)),e},e.prototype.itemClick=function(t,e){this.setSelect(e)},e.prototype.tick=function(){var t=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code),e=(this._acVo.st,App.DateUtil.getWeeTs(GameData.serverTime)),i=GameData.serverTime,a=e+3600*t.activeTime[0],n=e+3600*t.activeTime[1],o=!1;if(this._lastTime<a&&i>a&&(o=!0),this._lastTime<n&&i>n&&(o=!0),(3==this.getState()||4==this.getState())&&this._boxContainer&&0==this._boxContainer.visible&&(o=!0),o&&(this.refreshState(),this._lastTime=i),4==this.getState()){var s=86400+App.DateUtil.getWeeTs(GameData.serverTime)-GameData.serverTime+3600*t.activeTime[0],r=LanguageManager.getlocal("acPunishOpenTime",[App.DateUtil.getFormatBySecond(s,1)]);this._openTxt.visible=!0,this._openTxt.text=r}if(1==this.getState()){var s=App.DateUtil.getWeeTs(GameData.serverTime)-GameData.serverTime+3600*t.activeTime[0],r=LanguageManager.getlocal("acPunishOpenTime",[App.DateUtil.getFormatBySecond(s,1)]);this._openTxt.visible=!0,this._openTxt.text=r}},e.prototype.buyCallback=function(t){for(var e=0;e<this._punishItemList.length;e++){var i=this._punishItemList[e].getChildByName("numLb"),a=this._punishItemVoList[(e+1).toString()],n=Api.itemVoApi.getItemNumInfoVoById(Number(a.item));i.text=n.toString(),i.setPosition(100-i.width,98-i.height);var o=this._punishItemList[e].getChildByName("itembg"),s=this._punishItemList[e].getChildByName("itemicon");0>=n?(App.DisplayUtil.changeToGray(s),App.DisplayUtil.changeToGray(o)):(App.DisplayUtil.changeToNormal(s),App.DisplayUtil.changeToNormal(o))}this._acVo=Api.acVoApi.getActivityVoByAidAndCode("punish",this.code);var r=LanguageManager.getlocal("acPunishScore2",[this._acVo.v.toString()]);this._score1Text.text=r;var l=LanguageManager.getlocal("acPunishScore1",[this._acVo.score.toString()]);this._score2Text.text=l;var h=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code),d="";"2"==this.code?(d=(100-this._acData.hp/h.Hp*100).toFixed(3),this._progressBar.setPercentage(1-this._acData.hp/h.Hp)):(d=Math.floor(this._acData.hp/h.Hp*100).toString(),this._progressBar.setPercentage(this._acData.hp/h.Hp)),this._levelTxt.text=d+"%"},e.prototype.runText=function(){for(var t=new Array,e=0;e<this._acData.log.length;e++){var i=this.getTipText(this._acData.log[e]);t.push(i)}var a=new LoopLamp(t);a.y=190,this.addChildToContainer(a)},e.prototype.getTipText=function(t){var e="";if(!t)return"";var i=Config.ItemCfg.getItemCfgById(Number(t[1])),a=GameData.getRewardsStr(t[2]);return e=LanguageManager.getlocal("acPunishTip",[t[0],i.name,a])},e.prototype.exCallback=function(t){this._acVo=Api.acVoApi.getActivityVoByAidAndCode("punish",this.code),this._score2Text.text=LanguageManager.getlocal("acPunishScore1",[this._acVo.score.toString()])},e.prototype.getSheepType=function(){return 1},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_BUYPUNISHITEM),this.buyCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_BUYPUNISHSHOP),this.exCallback,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_ITEM,this.buyCallback,this),this._scrollList=null,this._activityTimerText=null,this._acCDTxt=null,this._score1Text=null,this._score2Text=null,this._acData=null,this._acVo=null,this._progressBar=null,this._selectBg=null,this._selectIndex=-1,this._openTxt=null,this._boxContainer=null,this._lightSp=null,this._boxDesc=null,this._boxSp=null,this._chooseBtn=null,this._touchSwitch=!0,this._bodyContainer=null,this._headPic=null,this._wordsContanier=null,this._punishItemList=null,this._tw&&(egret.Tween.removeTweens(this._tw),this._tw=null),t.prototype.dispose.call(this)},e}(AcCommonView);__reflect(AcPunishView.prototype,"AcPunishView");var AcRankActiveView=function(t){function e(){var e=t.call(this)||this;return e._deltaSecs=86400,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETRANKACTIVE),this.getRankListHandler,this),NetManager.request(NetRequestConst.REQUEST_ACTIVITY_GETRANKACTIVE,{activeId:this.aid+"-"+this.code}),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer),this._rewardNodeContainer=new BaseDisplayObjectContainer;var t=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,String(this.code)),e="activity_rank_bg";if(11==t.type)e=e="activity_rank_bg_"+this.code;else{var i=Api.playerVoApi.getPlayerPortrait(t.title,Api.playerVoApi.getPlayePicId());i.width=382,i.height=618,i.x=30,i.setScale(.7),this._nodeContainer.addChild(i);var a=BaseLoadBitmap.create("user_title_"+t.title+"_2");a.x=10,a.y=10,this._nodeContainer.addChild(a)}var n=BaseBitmap.create(e);n.x=0,n.y=-15,this._nodeContainer.addChildAt(n,0);var o=BaseBitmap.create("activity_rank_rightBg");o.height=265,o.x=GameConfig.stageWidth-o.width-5,o.y=-10,this._nodeContainer.addChild(o);var s=BaseBitmap.create("public_9_managebg");s.width=o.width-30,s.height=205,s.x=o.x+15,s.y=-15,this._nodeContainer.addChild(s);var r=ComponentManager.getTextField("",20,TextFieldConst.COLOR_BROWN);App.DateUtil.getFormatBySecond(this.acVo.st,7),App.DateUtil.getFormatBySecond(this.acVo.et-this._deltaSecs,7),App.DateUtil.getOpenLocalTime(this.acVo.st,this.acVo.et,!0);r.multiline=!0,r.lineSpacing=3,r.width=s.width-50,r.text=this.acVo.getAcLocalTime(!0),r.x=o.x+25,r.y=o.y+20,this._nodeContainer.addChild(r);var l=this.acVo.et-this._deltaSecs-GameData.serverTime,h=ComponentManager.getTextField("",20,TextFieldConst.COLOR_BROWN);this._acCDTxt=h,this._acCDTxt&&l>0?this._acCDTxt.text=LanguageManager.getlocal("acRank_acCD",[App.DateUtil.getFormatBySecond(l,1)]):this._acCDTxt.text=LanguageManager.getlocal("acRank_acCD",[LanguageManager.getlocal("acRank_acCDEnd")]),h.x=r.x,h.y=r.y+r.height+8,this._nodeContainer.addChild(h);var d=ComponentManager.getTextField("",20,TextFieldConst.COLOR_BROWN);this._rankDescTxt=d,d.multiline=!0,d.lineSpacing=5,d.width=240,this._rankDescTxt.text=LanguageManager.getlocal("acRankActiveDesc"+t.type,[t.getMaxRangValue()]),d.x=o.x+25,d.y=h.y+h.height+8,this._nodeContainer.addChild(d);var g=ComponentManager.getTextField("",20,TextFieldConst.COLOR_BROWN);if(g.y=s.y+s.height-28,this._nodeContainer.addChild(g),this._myRankTxt=g,!Api.switchVoApi.checkOpenShenhe()){var c=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"acRankBtnTxt",this.rankListBtnHandler,this);c.x=o.x+o.width/2-c.width/2,c.y=o.y+205,this._nodeContainer.addChild(c),this._rankListBtn=c}var p="activity_rank_word";3==t.titleType&&(p="activity_rank_word2"),11==t.type&&(p="activity_rank_word3");var _=BaseBitmap.create(p);_.x=5,_.y=n.y+220,this._nodeContainer.addChild(_);var u=BaseBitmap.create("public_9_bg22");u.x=0,u.y=n.y+n.height-3,u.height=GameConfig.stageHeigth-u.y-this.container.y,this._nodeContainer.addChild(u);var C=ComponentManager.getTextField("",20,TextFieldConst.COLOR_BROWN);C.text=LanguageManager.getlocal("acRanktip"),11==t.type&&(C.text=LanguageManager.getlocal("acRanktip2")),C.x=GameConfig.stageWidth/2-C.width/2,C.y=u.y+u.height-50,u.name="bottomBg",this._nodeContainer.addChild(C)},e.prototype.getRankListHandler=function(t){var e=t.data.data;if(0==e.ret){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETRANKACTIVE),this.getRankListHandler,this);var i=t.data.data.data;this._rankData=i,i.acrank.myrank.myrank?this._myRankTxt.text=LanguageManager.getlocal("acRank_myrank1",[String(i.acrank.myrank.myrank)]):this._myRankTxt.text=LanguageManager.getlocal("acRank_myrank1",["10000+"]),this._myRankTxt.x=399;var a=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,String(this.code)),n=a.getRankList(),o=this._nodeContainer.getChildByName("bottomBg");if(1==a.isCross){var s=BaseBitmap.create("activity_rank_cross");s.width=GameConfig.stageWidth,s.x=0,s.y=o.y-5,this._nodeContainer.addChild(s),o.height-=s.height,o.y+=s.height-5}var r=10;for(var l in n){var h=n[l],d=(h.id,BaseBitmap.create("public_line3"));d.width=480,d.x=GameConfig.stageWidth/2-d.width/2,d.y=r,this._rewardNodeContainer.addChild(d);var g=1;h.reward1&&""!=h.reward1&&(g=2);var c=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_BROWN);Number(l)<4?c.text=LanguageManager.getlocal("acRank_rank"+l):c.text=LanguageManager.getlocal("acRank_rank4",[String(h.minRank),String(h.maxRank)]),c.x=d.x+d.width/2-c.width/2,c.y=r+10-c.height/2,this._rewardNodeContainer.addChild(c);var p=0;if(1==Number(l)&&11!=a.type){var _=ComponentManager.getTextField("",24,TextFieldConst.COLOR_BROWN);_.text=LanguageManager.getlocal("acRank_getofficer"),2==g&&(_.text=LanguageManager.getlocal("acRank_alliance_masterget2")),_.x=c.x+c.width/2-_.width,_.y=c.y+c.height+20,this._rewardNodeContainer.addChild(_);var u=BaseLoadBitmap.create("user_title_"+a.title+"_3"),C=.8;u.width=155*C,u.height=59*C,u.x=_.x+_.width,u.y=_.y+_.height/2-30,this._rewardNodeContainer.addChild(u)}for(var f=h.rewardIcons,m=0;g>m;m++){1==m&&(f=h.reward1Icons);var T=BaseBitmap.create("public_9_managebg");if(T.width=o.width-50,T.height=125,T.x=25,T.y=r+30,this._rewardNodeContainer.addChild(T),p=0,1==Number(l)&&0==m&&(p=35,r+=35),r+=40,2==g){var y=ComponentManager.getTextField("",24,TextFieldConst.COLOR_BROWN);y.y=T.y+10,1==m?(y.text=LanguageManager.getlocal("acRank_alliance_memberget"),y.x=T.x+T.width/2-y.width/2,this._rewardNodeContainer.addChild(y),r+=40):0==m&&Number(l)>1&&(y.text=LanguageManager.getlocal("acRank_alliance_masterget1"),y.x=T.x+T.width/2-y.width/2,this._rewardNodeContainer.addChild(y),r+=40)}for(var v=33,A=0;A<f.length;A++){var w=f[A];w.x=v,w.y=r,v+=w.width+8,v>=GameConfig.stageWidth&&(v=33,r+=w.height+15,w.x=v,w.y=r,p+=w.height+15,v+=w.width+8),this._rewardNodeContainer.addChild(w)}2==g?(r+=0==m?105:145,1==Number(l)&&0==m||(p+=45)):r+=145,T.height+=p+5}}var x=new egret.Rectangle(0,10,GameConfig.stageWidth,o.height-85),I=ComponentManager.getScrollView(this._rewardNodeContainer,x);I.horizontalScrollPolicy="off",I.x=0,I.y=o.y+25,this._nodeContainer.addChild(I)}},e.prototype.rankListBtnHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.ACRANKLISTPOPUPVIEW,{aid:this.aid,code:this.code})},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["activity_rank_bg","activity_rank_rightBg","activity_rank_word","itemeffect","activity_rank_word2","activity_rank_word3","activity_rank_bg_19","activity_rank_cross","activity_rank_bg_23","activity_rank_bg_27"])},e.prototype.getRuleInfo=function(){var t=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,String(this.code));return t.helpInfo},e.prototype.tick=function(){var t=this.acVo.et-this._deltaSecs-GameData.serverTime;return this._acCDTxt&&t>0?(this._acCDTxt.text=LanguageManager.getlocal("acRank_acCD",[App.DateUtil.getFormatBySecond(t,1)]),!0):(this._acCDTxt.text=LanguageManager.getlocal("acRank_acCD",[LanguageManager.getlocal("acRank_acCDEnd")]),!1)},e.prototype.getTitleStr=function(){var t=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,String(this.code));return"ac"+App.StringUtil.firstCharToUper(this.acVo.aid+"-"+t.type)+"_Title"},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETRANKACTIVE),this.getRankListHandler,this),this._nodeContainer=null,this._rewardNodeContainer=null,this._myRankTxt=null,this._rankListBtn=null,this._rankData=null,this._acCDTxt=null,t.prototype.dispose.call(this)},e}(AcCommonView);__reflect(AcRankActiveView.prototype,"AcRankActiveView");var AcRankListScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.height=52,this._nodeContainer=new BaseDisplayObjectContainer,this.addChild(this._nodeContainer);var i=TextFieldConst.COLOR_BROWN;e.uid?e.uid==Api.playerVoApi.getPlayerID()&&(i=TextFieldConst.COLOR_WARN_YELLOW):e.id==Api.playerVoApi.getPlayerAllianceId()&&(i=TextFieldConst.COLOR_WARN_YELLOW);var a=16;if(t>2){var n=ComponentManager.getTextField("",20,i);n.text=String(t+1),n.x=90-n.width/2,n.y=a,this._nodeContainer.addChild(n)}else{var o=BaseLoadBitmap.create("rank_"+String(t+1));o.width=51,o.height=47,o.x=90-o.width/2,o.y=3,this.addChild(o)}var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,i);e.eflag&&1==e.eflag?(s.text=LanguageManager.getlocal("acRankList_allianceQuit",[e.name]),s.x=245-s.width/2+30):(s.text=e.name,s.x=245-s.width/2),s.y=a,this._nodeContainer.addChild(s);var r=ComponentManager.getTextField("",s.size,i);r.text=String(e.value),r.x=460-r.width/2,r.y=a,this._nodeContainer.addChild(r);var l=BaseLoadBitmap.create("rank_line");l.width=500,l.height=2,l.x=30,l.y=50,this._nodeContainer.addChild(l)},e.prototype.getSpaceX=function(){return 0},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AcRankListScrollItem.prototype,"AcRankListScrollItem");var RankActiveScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this._acVo=e,this.width=GameConfig.stageWidth,this.height=312+this.getSpaceY();var i=BaseBitmap.create("ranactivecellbg");i.x=this.width/2-i.width/2,this.addChild(i);var a="rankactive_bg_"+e.atype,n=BaseLoadBitmap.create(a);this.addChild(n),n.x=35,n.y=20;var o=BaseBitmap.create("rankactivenamebg");o.x=30,o.y=8,this.addChild(o);var s="rankactive_name_"+e.atype,r=BaseLoadBitmap.create(s);r.x=o.x+16,r.y=o.y+20,this.addChild(r);var l=Config.AcCfg.getCfgByActivityIdAndCode(e.aid,String(e.code)),h=ComponentManager.getTextField("",20,TextFieldConst.COLOR_BROWN);h.multiline=!0,h.lineSpacing=5,h.text=LanguageManager.getlocal("acRankActiveDesc"+e.atype,[l.getMaxRangValue()]),h.x=40,h.y=210,this.addChild(h);var d=ComponentManager.getTextField("",20,TextFieldConst.COLOR_BROWN);App.DateUtil.getFormatBySecond(e.st,7),App.DateUtil.getFormatBySecond(e.et-86400,7),App.DateUtil.getOpenLocalTime(e.st,e.et,!0);d.multiline=!0,d.lineSpacing=3,d.text=e.getAcLocalTime(!0),d.x=40,d.y=h.y+h.height+8,this.addChild(d);var g=e.et-86400-GameData.serverTime,c=ComponentManager.getTextField("",20,TextFieldConst.COLOR_BROWN);this._acCDTxt=c,this._acCDTxt&&g>0?this._acCDTxt.text=LanguageManager.getlocal("acRank_acCD",[App.DateUtil.getFormatBySecond(g,1)]):this._acCDTxt.text=LanguageManager.getlocal("acRank_acCD",[LanguageManager.getlocal("acRank_acCDEnd")]),c.x=40,c.y=d.y+d.height+8,this.addChild(c);var p=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"acRank_enter",this.rankListBtnHandler,this);if(p.x=470,p.y=240,this.addChild(p),1==l.isCross){var _=BaseLoadBitmap.create("atkracecross_tip");_.setPosition(360,20),this.addChild(_)}TickManager.addTick(this.tick,this)},e.prototype.tick=function(){var t=this._acVo.et-86400-GameData.serverTime;this._acCDTxt&&t>0?this._acCDTxt.text=LanguageManager.getlocal("acRank_acCD",[App.DateUtil.getFormatBySecond(t,1)]):this._acCDTxt.text=LanguageManager.getlocal("acRank_acCD",[LanguageManager.getlocal("acRank_acCDEnd")])},e.prototype.rankListBtnHandler=function(t){ViewController.getInstance().openView("Ac"+App.StringUtil.firstCharToUper(this._acVo.aid)+"View",this._acVo.code)},e.prototype.refreshData=function(t){var e=Api.wifeVoApi.getWifeInfoVoById(t);this._intimacyTF.text=e.intimacy.toString(),this._glamourTF.text=e.glamour.toString()},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){this._intimacyTF=null,this._glamourTF=null,this._wifeInfoVo=null,this._acVo=null,this._acCDTxt=null,TickManager.removeTick(this.tick,this),t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(RankActiveScrollItem.prototype,"RankActiveScrollItem");var RankActiveView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg23");t.width=GameConfig.stageWidth,t.height=GameConfig.stageHeigth-105,t.x=0,t.y=-7,this.addChildToContainer(t);var e=Api.acVoApi.getRanActives(),i=egret.Rectangle.create();i.setTo(0,0,t.width,t.height-8),this._scrollList=ComponentManager.getScrollList(RankActiveScrollItem,e,i),this.addChildToContainer(this._scrollList),this._scrollList.x=t.x+t.width/2-this._scrollList.width/2+4,this._scrollList.y=t.y+t.height/2-this._scrollList.height/2},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["progress5","progress3_bg","progress6","progress6_bg","achievement_state1","achievement_state2","achievement_state3","ranactivecellbg","rankactivenamebg"])},e.prototype.dispose=function(){this._scrollList=null,this._achId=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(RankActiveView.prototype,"RankActiveView");var AcSpringCelebrateView=function(t){function e(){var e=t.call(this)||this;return e._activityTimerText=null,e._springAlcohol1NeedText=null,e._springAlcohol2NeedText=null,e._topBgArr=[],e.curr_acNewYearVo=null,e.public_dot1=null,e.public_dot2=null,e.public_dot3=null,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_RESFESH_SPRING_ITEM,this.update,this),App.MessageHelper.addEventListener(MessageConst.RESFESH_SPRING_TAB,this.changeViewTab,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.ACTIVITY_GETSPRINGITEMA),this.useCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.ACTIVITY_GETSPRINGITEMB),this.useCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.ACTIVITY_GETSPRINGITEMC),this.useCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.ACTIVITY_GETSPRINGITEMD),this.useCallback,this),e.AID=this.aid,e.CODE=this.code;var t=Api.acVoApi.getActivityVoByAidAndCode(this.aid,this.code);this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var i=BaseBitmap.create("springcelerationbg_"+this.code);i.y=-286,this.addChildToContainer(i),this._activityTimerText=ComponentManager.getTextField(LanguageManager.getlocal("acSpringCelebrateTime",[t.acTimeAndHour]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_YELLOW2),this._activityTimerText.x=250,this._activityTimerText.y=-180,this.addChildToContainer(this._activityTimerText);var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);a.text=LanguageManager.getlocal("springAlcohol1_"+this.code),this.addChildToContainer(a),a.x=270,a.y=-135;var n=BaseBitmap.create("spring_small_nuerhong_"+this.code);n.x=a.x+80,n.y=-145,this.addChildToContainer(n);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);"2"==this.code&&(o.text=Api.itemVoApi.getItemNumInfoVoById(2105)+""),o.text=Api.itemVoApi.getItemNumInfoVoById(2103)+"",this.addChildToContainer(o),o.x=n.x+n.width+2,o.y=a.y,this._springAlcohol1NeedText=o;var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);s.text=LanguageManager.getlocal("springAlcohol2_"+this.code),this.addChildToContainer(s),s.x=450,s.y=a.y;var r=BaseBitmap.create("spring_small_clcohol_"+this.code);r.x=s.x+80,r.y=n.y,this.addChildToContainer(r);var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);l.text=Api.itemVoApi.getItemNumInfoVoById(2104)+"","2"==this.code&&(l.text=Api.itemVoApi.getItemNumInfoVoById(2106)+""),this.addChildToContainer(l),l.x=r.x+r.width-2,l.y=s.y,this._springAlcohol2NeedText=l;var h=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);h.text=LanguageManager.getlocal("acspringcelebrate_des1_"+this.code),this.addChildToContainer(h),h.x=this._activityTimerText.x-10,h.y=this._activityTimerText.y+85;var d=BaseBitmap.create("servant_bottombg");d.width=GameConfig.stageWidth+16,d.height=GameConfig.stageHeigth-i.height-i.y-this.container.y+9,d.x=-8,d.y=i.height+i.y-4,this._nodeContainer.addChild(d);var g=BaseBitmap.create("public_dot2");this.addChild(g),g.x=135,g.y=this.tabbarGroup.y,this.public_dot1=g;var c=BaseBitmap.create("public_dot2");this.addChild(c),c.x=295,c.y=this.tabbarGroup.y,this.public_dot2=c;var p=BaseBitmap.create("public_dot2");this.addChild(p),p.x=455,p.y=this.tabbarGroup.y,this.public_dot3=p,this.update()},e.prototype.useCallback=function(t){t.data.ret&&("11_4002_1"==t.data.data.data.rewards&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_CHANGE_IMG),App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.data.rewards)))},e.prototype.update=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(e.AID,e.CODE);this.public_dot1&&(this.public_dot1.visible=t.getpublicRedhot1()),this.public_dot2&&(this.public_dot2.visible=t.getpublicRedhot2()),this.public_dot3&&(this.public_dot3.visible=t.getpublicRedhot3()),this._springAlcohol1NeedText&&("2"==this.code?this._springAlcohol1NeedText.text=Api.itemVoApi.getItemNumInfoVoById(2105)+"":this._springAlcohol1NeedText.text=Api.itemVoApi.getItemNumInfoVoById(2103)+""),this._springAlcohol2NeedText&&("2"==this.code?this._springAlcohol2NeedText.text=Api.itemVoApi.getItemNumInfoVoById(2106)+"":this._springAlcohol2NeedText.text=Api.itemVoApi.getItemNumInfoVoById(2104)+"")
},e.prototype.changeViewTab=function(){var t=[];t.index=3,this.clickTabbarHandler(t),this.tabbarGroup.selectedIndex=t.index},e.prototype.clickTabbarHandler=function(i){var a=Api.acVoApi.getActivityVoByAidAndCode(e.AID,e.CODE);return 0==a.isStart?void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd")):(t.prototype.clickTabbarHandler.call(this,i),void App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_RESFESH_SPRING_TAB))},e.prototype.getTabbarTextArr=function(){return["acSpringCelebrateViewTab1_"+this.code,"acSpringCelebrateViewTab2_"+this.code,"acSpringCelebrateViewTab3_"+this.code,"acSpringCelebrateViewTab4_"+this.code]},e.prototype.getTabbarGroupY=function(){return 235},e.prototype.getRuleInfo=function(){return"acspringcelebrate_description_"+this.code},e.prototype.goToRechargeHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["spring_arrow","spring_sign","spring_small_clcohol_1","spring_small_clcohol_2","spring_small_clcohol_3","spring_small_nuerhong_1","spring_small_nuerhong_2","spring_small_nuerhong_3","springcelerationbg_1","springcelerationbg_2","springcelerationbg_3","activity_charge_red","shopview_corner","servant_bottombg"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.RESFESH_SPRING_TAB,this.changeViewTab,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.ACTIVITY_GETSPRINGITEMA),this.useCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.ACTIVITY_GETSPRINGITEMB),this.useCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.ACTIVITY_GETSPRINGITEMC),this.useCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.ACTIVITY_GETSPRINGITEMD),this.useCallback,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_RESFESH_SPRING_ITEM,this.update,this),this.public_dot1=null,this.public_dot2=null,this.public_dot3=null,this._springAlcohol1NeedText=null,this._springAlcohol2NeedText=null,t.prototype.dispose.call(this)},e.AID=null,e.CODE=null,e}(AcCommonView);__reflect(AcSpringCelebrateView.prototype,"AcSpringCelebrateView");var Scale9gridCfg;!function(t){function e(t){return a[t]}function i(t){var e=a[t];return e?e.scale9grid:null}t.get=e,t.getScale9gridCfg=i;var a={mainui_chatbg:{scale9grid:"5,5,1,1"},popupview_bg1:{scale9grid:"285,59,1,1"},public_9_bg1:{scale9grid:"16,16,1,2"},public_9_bg2:{scale9grid:"300,17,1,4"},public_9_bg3:{scale9grid:"14,20,1,1"},public_9_bg4:{scale9grid:"8,8,1,1"},public_9_bg5:{scale9grid:"8,22,1,1"},public_alphabg:{scale9grid:"2,2,1,1"},public_tipbg:{scale9grid:"317,44,1,1"},public_9_bg8:{scale9grid:"13,17,1,1"},public_9_bg9:{scale9grid:"24,24,1,2"},public_9_bg11:{scale9grid:"11,11,1,1"},public_9_bg42:{scale9grid:"21,21,1,1"},public_9_bg12:{scale9grid:"53,16,4,2"},wifeview_lovewordsbg:{scale9grid:"147,55,43,37"},public_9_bg13:{scale9grid:"28,27,6,7"},public_9_bg20:{scale9grid:"5,5,1,1"},public_9_bg21:{scale9grid:"15,15,1,1"},public_line3:{scale9grid:"140,10,1,1"},public_9_bg22:{scale9grid:"320,94,1,1"},public_9_bg23:{scale9grid:"5,5,1,1"},public_9_bg24:{scale9grid:"15,15,1,1"},manage_itembg:{scale9grid:"52,109,1,1"},public_9_managebg:{scale9grid:"20,19,1,1"},servant_topresbg:{scale9grid:"12,14,1,1"},public_9_probiginnerbg:{scale9grid:"21,21,1,1"},servant_bottombg:{scale9grid:"238,111,1,1"},progress3_bg:{scale9grid:"15,11,1,1"},progress3:{scale9grid:"15,11,1,1"},progress5:{scale9grid:"15,11,1,1"},public_9_bg25:{scale9grid:"21,21,1,1"},public_9_bg26:{scale9grid:"20,20,1,1"},public_9_bg27:{scale9grid:"20,30,1,1"},public_9_bg28_down:{scale9grid:"43,30,1,1"},public_9_bg28:{scale9grid:"43,30,1,1"},public_9_bg29:{scale9grid:"36,24,1,1"},public_9_wordbg:{scale9grid:"320,53,1,1"},public_9_wordbg2:{scale9grid:"320,53,1,1"},public_9_viewmask:{scale9grid:"2,2,1,1"},servant_mask:{scale9grid:"6,70,1,1"},public_9_bg30:{scale9grid:"14,17,1,1"},public_9_bg31_down:{scale9grid:"61,29,1,1"},public_9_bg31:{scale9grid:"61,29,1,1"},public_9_wifebg:{scale9grid:"71,50,1,1"},public_numbg:{scale9grid:"66,24,1,1"},guide_rect:{scale9grid:"17,17,1,1"},public_itemtipbg:{scale9grid:"2,10,1,1"},public_itemtipbg2:{scale9grid:"38,10,1,1"},public_9_bg32:{scale9grid:"16,16,1,1"},public_9_bg33:{scale9grid:"19,18,1,1"},public_chatbg1:{scale9grid:"20,27,1,1"},public_chatbg2:{scale9grid:"20,27,1,1"},public_chatbg3:{scale9grid:"20,27,1,1"},public_chatinputbg:{scale9grid:"10,10,1,1"},public_9_bg34:{scale9grid:"300,18,1,1"},public_9_bg35:{scale9grid:"25,25,1,1"},public_9_bg14:{scale9grid:"33,50,1,1"},public_9_bg15:{scale9grid:"68,20,1,1"},progress4_bg:{scale9grid:"21,20,1,1"},progress4:{scale9grid:"21,20,1,1"},commonview_titlebgshadow:{scale9grid:"4,4,1,1"},public_9_bg16:{scale9grid:"46,42,1,1"},public_9_bg37:{scale9grid:"11,9,1,1"},common_9_bg:{scale9grid:"200,42,1,1"},loginres_9_serverbg:{scale9grid:"29,27,1,1"},loginres_9_serverbg_down:{scale9grid:"29,27,1,1"},common_left_bg:{scale9grid:"74,10,1,1"},dinner_list_bg:{scale9grid:"23,23,1,1"},dinner_list_title_bg:{scale9grid:"5,5,1,1"},dinner_name_bg1:{scale9grid:"23,22,1,1"},dinner_name_bg2:{scale9grid:"28,22,1,1"},dinner_rank_titlebg:{scale9grid:"10,8,1,1"},activity_rank_rightBg:{scale9grid:"156,17,1,1"},goto_dinner_namebg:{scale9grid:"143,42,1,1"},public_9_bg38:{scale9grid:"35,21,1,1"},fourfloor:{scale9grid:"22,22,1,1"},fourpeople_mask:{scale9grid:"16,75,1,1"},activity_charge_red:{scale9grid:"10,24,1,1"},public_searchmask:{scale9grid:"5,17,1,1"},public_npc_talkbg:{scale9grid:"7,15,1,1"},public_9_tipbg:{scale9grid:"320,5,1,1"},public_9_bg39:{scale9grid:"13,12,1,1"},public_9_bg40:{scale9grid:"9,9,1,1"},progress7:{scale9grid:"9,13,1,1"},progress7_bg:{scale9grid:"9,13,1,1"},prisonview_progress:{scale9grid:"15,15,1,1"},prisonview_progress_bg:{scale9grid:"13,13,1,1"},public_ac_notice_bg:{scale9grid:"5,5,1,1"},public_9_cell_title:{scale9grid:"10,10,1,1"},progress8:{scale9grid:"9,13,1,1"},prisonview_namebg:{scale9grid:"106,5,1,1"},atkrace_name_bg:{scale9grid:"52,13,1,1"},public_9_resbg:{scale9grid:"74,22,1,1"},progress9:{scale9grid:"5,9,1,1"},progress9_bg:{scale9grid:"5,9,1,1"},public_9_alliancebtnbg:{scale9grid:"60,80,1,1"},alliance_attbg:{scale9grid:"120,60,1,1"},public_9_downbg:{scale9grid:"21,21,1,1"},studyatk_master_bg:{scale9grid:"11,11,1,1"},arena_bottom_bg:{scale9grid:"320,62,1,1"},alliance_effect:{scale9grid:"75,75,1,1"},public_9_powertipbg:{scale9grid:"90,20,1,1"},conquest_cellbg:{scale9grid:"50,255,1,1"},public_itemmask:{scale9grid:"20,20,1,1"},candyline:{scale9grid:"5,5,1,1"},guideGrayBg:{scale9grid:"100,100,1,1"},public_9_manageinfo:{scale9grid:"16,37,1,1"},public_9_bg43:{scale9grid:"17,15,1,1"},playerview_infobg:{scale9grid:"139,22,1,1"},childview_bg1:{scale9grid:"25,25,1,1"},childview_bg2:{scale9grid:"25,25,1,1"},childview_bg3:{scale9grid:"25,25,1,1"},acvipshopview_bluebottom:{scale9grid:"8,8,1,1"},wifeskin_bottombg:{scale9grid:"2,2,1,1"},atkracecross_rankbg:{scale9grid:"320,90,1,1"},wifeview_skingetbg:{scale9grid:"90,10,1,1"},activity_rank_cross:{scale9grid:"2,2,1,1"},firstrechargemask_bg:{scale9grid:"5,32,1,1"},atkracecross_timebg:{scale9grid:"320,55,1,1"},atkracecross_explain_bg:{scale9grid:"89,5,1,1"},public_9_bg41:{scale9grid:"22,21,1,1"},thanksgivingview_top:{scale9grid:"8,5,1,1"},prestige_pillar_base:{scale9grid:"84,47,1,1"},prestige_black_bg:{scale9grid:"96,14,1,1"},coverBg:{scale9grid:"639,873,1,1"},playerpromo_abitopbg:{scale9grid:"320,60,1,1"},public_9_bg44:{scale9grid:"10,10,1,1"},wifestatus_itembg:{scale9grid:"300,98,1,1"},wifestatus_itembg2:{scale9grid:"300,98,1,1"}}}(Scale9gridCfg||(Scale9gridCfg={}));var AcSpringCelebrateViewTab2=function(t){function e(){var e=t.call(this)||this;return e._scrollList=null,e._rechargeArr=null,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_RESFESH_SPRING_TAB,this.update,this);var t=BaseBitmap.create("public_9_bg43");t.width=625,t.height=GameConfig.stageHeigth-410,t.x=5,t.y=-220,this.addChild(t);var e=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE),i=e.getArr("exchange");i=this.updataArr(i),this._rechargeArr=i;var a=new egret.Rectangle(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-430),n=ComponentManager.getScrollList(Celebration2ScrollItem,i,a);n.setPosition(20,-210),this.addChild(n),this._scrollList=n},e.prototype.updataArr=function(t){void 0===t&&(t=[]);var e=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE);if(e){for(var i=[],a=[],n=0;n<t.length;n++){var o=e.getExchangeNum(t[n].key);o==t[n].limit?i.push(t[n]):a.push(t[n])}return a.concat(i)}},e.prototype.update=function(){if(this._scrollList){var t=this.updataArr(this._rechargeArr);this._scrollList.refreshData(t),this._scrollList.setPosition(20,-210)}},e.prototype.getSheepType=function(){return 2},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_RESFESH_SPRING_TAB,this.update,this),this._scrollList=null,this._rechargeArr=null,t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(AcSpringCelebrateViewTab2.prototype,"AcSpringCelebrateViewTab2");var AcSpringCelebrateViewTab3=function(t){function e(){var e=t.call(this)||this;return e._scrollList=null,e._rechargeArr=null,e.initView(),App.MessageHelper.addEventListener(MessageConst.MESSAGE_RESFESH_SPRING_TAB,e.update,e),e}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg43");t.width=625,t.height=GameConfig.stageHeigth-410,t.x=5,t.y=-220,this.addChild(t);var e=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE),i=e.getArr("task");i=this.updataArr(i),this._rechargeArr=i;var a=new egret.Rectangle(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-430),n=ComponentManager.getScrollList(Celebration3ScrollItem,i,a);this._scrollList=n,this._scrollList.setPosition(20,-210),this.addChild(n)},e.prototype.updataArr=function(t){void 0===t&&(t=[]);var e=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE);if(e){for(var i=[],a=[],n=[],o=0;o<t.length;o++)if(e.isGetRecharge(t[o].key))i.push(t[o]);else{var s=e.getTask(t[o].questType);s>=t[o].value?a.push(t[o]):n.push(t[o])}return a.concat(n).concat(i)}},e.prototype.update=function(){if(this._scrollList){var t=this.updataArr(this._rechargeArr);this._scrollList.refreshData(t)}},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_RESFESH_SPRING_TAB,this.update,this),this._scrollList=null,this._rechargeArr=null,t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(AcSpringCelebrateViewTab3.prototype,"AcSpringCelebrateViewTab3");var AcSpringCelebrateViewTab4=function(t){function e(){var e=t.call(this)||this;return e._scrollList=null,e._rechargeArr=null,e.initView(),App.MessageHelper.addEventListener(MessageConst.MESSAGE_RESFESH_SPRING_TAB,e.update,e),e}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg43");t.width=625,t.height=GameConfig.stageHeigth-410,t.x=5,t.y=-220,this.addChild(t);var e=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE),i=e.getArr("shop");i=this.updataArr(i),this._rechargeArr=i;var a=new egret.Rectangle(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-430),n=ComponentManager.getScrollList(Celebration4ScrollItem,i,a);n.setPosition(20,-210),this.addChild(n),this._scrollList=n},e.prototype.updataArr=function(t){void 0===t&&(t=[]);var e=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE);if(e){for(var i=[],a=[],n=0;n<t.length;n++){var o=e.getExchange4Num(t[n].key);o==t[n].limit?i.push(t[n]):a.push(t[n])}return a.concat(i)}},e.prototype.update=function(){if(this._scrollList){var t=this.updataArr(this._rechargeArr);this._scrollList.refreshData(t)}},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_RESFESH_SPRING_TAB,this.update,this),this._scrollList=null,this._rechargeArr=null,t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(AcSpringCelebrateViewTab4.prototype,"AcSpringCelebrateViewTab4");var Celebration1ScrollItem=function(t){function e(){var e=t.call(this)||this;return e._data=null,e._needTxt=null,e._goBtn3=null,e.cu_index=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(MessageConst.MESSAGE_RESFESH_SPRING_ITEM,this.update,this),this._data=e,this.cu_index=Number(e.key);var i=BaseBitmap.create("public_9_bg14");i.width=598,i.height=170,this.addChild(i);var a=BaseBitmap.create("activity_charge_red");a.width=405,this.addChild(a);var n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);n.text=LanguageManager.getlocal("acSpringCelebrationRechargedes",[e.needGem+""]),n.width=a.width,n.x=a.x+15,n.y=a.y+10,this.addChild(n),a.width=n.textWidth+35;var o=GameData.getRewardItemIcons(e.getReward,!0);if(o&&o.length>0)for(var s=20,r=50,l=o.length,h=0;l>h;h++){var d=o[h];d.setPosition(s+h*(d.width*d.scaleX+12),r),this.addChild(d)}this._goBtn3=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"taskCollect",this.collectHandler,this),this._goBtn3.x=420,this._goBtn3.y=75,this.addChild(this._goBtn3);var g=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_BROWN);g.width=this._goBtn3.width+50,g.x=this._goBtn3.x-20,g.y=this._goBtn3.y-30,g.textAlign="center",this._needTxt=g,this.addChild(g),this.update()},e.prototype.collectHandler=function(t){var e=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE);if(0==e.isStart)return void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd"));if(this._data.needGem<=e.getAinfoV()){var i=this.cu_index;NetManager.request(NetRequestConst.ACTIVITY_GETSPRINGITEMA,{activeId:AcSpringCelebrateView.AID+"-"+AcSpringCelebrateView.CODE,rechargeId:i})}else{if(1==e.isExchange())return void App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_RESFESH_SPRING_ITEM);ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)}},e.prototype.update=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE);if(t){var e=t.getAinfoV();if(t&&0==t.getReceiveType(this.cu_index)){if(1==this._goBtn3.visible){this._goBtn3.visible=!1,this._needTxt.visible=!1;var i=BaseBitmap.create("collectflag");i.x=450,i.y=50,i.scaleX=.7,i.scaleY=.7,this.addChild(i)}}else e>=this._data.needGem?(this._goBtn3.setText("taskCollect"),this._needTxt.text=LanguageManager.getlocal("springcelebrationNeedStr",[e+"",this._data.needGem+""])):(this._needTxt.text=LanguageManager.getlocal("springcelebrationNeedStr2",[e+"",this._data.needGem+""]),this._goBtn3.setText("vipshopbtn"),1==t.isExchange()&&(App.DisplayUtil.changeToGray(this._goBtn3),this._goBtn3.touchEnabled=!1))}},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._data=null,this._needTxt=null,this._goBtn3=null,this.cu_index=0,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_RESFESH_SPRING_ITEM,this.update,this),t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(Celebration1ScrollItem.prototype,"Celebration1ScrollItem");var Celebration2ScrollItem=function(t){function e(){var e=t.call(this)||this;return e._goBtn3=null,e._data=null,e._needTxt=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(MessageConst.MESSAGE_RESFESH_SPRING_ITEM,this.update,this),this._data=e;var i=BaseBitmap.create("public_9_bg14");i.width=600,i.height=126,this.addChild(i);var a=BaseBitmap.create("spring_arrow");a.x=140,a.y=35,this.addChild(a);var n=Config.ItemCfg.getItemCfgById(Number(e.needItem)),o=GameData.getItemIcon(n,!1);this.addChild(o),o.x=20,o.y=10;var s=n.id;o.addTouch(this.openItemDes,this,s);var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);r.text=e.needNum+"",r.x=o.x+70,r.y=o.y+80,r.width=30,r.textAlign="right",this.addChild(r);var l=GameData.getRewardItemIcons(e.getReward,!0);if(l&&l.length>0)for(var h=220,d=10,g=l.length,c=0;g>c;c++){var p=l[c];p.setPosition(h+c*(p.width*p.scaleX+12),d),this.addChild(p)}this._goBtn3=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"exchange",this.collectHandler,this),this._goBtn3.x=420,this._goBtn3.y=45,this.addChild(this._goBtn3);var _=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);_.text=LanguageManager.getlocal("springExchangedes",["1",e.limit+""]),_.x=this._goBtn3.x-30,_.y=this._goBtn3.y-25,_.width=this._goBtn3.width+55,_.textAlign="center",this._needTxt=_,this.addChild(_),this.update()},e.prototype.update=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE);if(t){if(this._goBtn3){var e=Api.itemVoApi.getItemNumInfoVoById(this._data.needItem);e>=this._data.needNum?App.DisplayUtil.changeToNormal(this._goBtn3):App.DisplayUtil.changeToGray(this._goBtn3)}if(this._needTxt){var i=t.getExchangeNum(this._data.key);this._needTxt.text=LanguageManager.getlocal("springExchangedes",[i+"",this._data.limit+""]),i==this._data.limit&&(this._goBtn3.setText("acSpringOutofstock"),App.DisplayUtil.changeToGray(this._goBtn3),this._goBtn3.touchEnabled=!1,this._goBtn3.y=45,this._needTxt.visible=!1)}}},e.prototype.openItemDes=function(t,e){ViewController.getInstance().openView(ViewConst.POPUP.ITEMINFOPOPUPVIEW,e)},e.prototype.collectHandler=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE);if(0==t.isStart)return void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd"));var e=Api.itemVoApi.getItemNumInfoVoById(this._data.needItem);if(e>=this._data.needNum)return void NetManager.request(NetRequestConst.ACTIVITY_GETSPRINGITEMB,{activeId:AcSpringCelebrateView.AID+"-"+AcSpringCelebrateView.CODE,exchangeId:""+this._data.key});var i=LanguageManager.getlocal("itemName_"+this._data.needItem);return void App.CommonUtil.showTip(LanguageManager.getlocal("acSpringceItemDes",[i]))},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_RESFESH_SPRING_ITEM,this.update,this),this._goBtn3=null,this._data=null,this._needTxt=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(Celebration2ScrollItem.prototype,"Celebration2ScrollItem");var Celebration3ScrollItem=function(t){function e(){var e=t.call(this)||this;return e._data=null,e._goBtn2=null,e._goBtn3=null,e._needTxt=null,e._collectflag=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){this._data=e,App.MessageHelper.addEventListener(MessageConst.MESSAGE_RESFESH_SPRING_ITEM,this.update,this);var i=BaseBitmap.create("public_9_bg14");i.width=598,i.height=170,this.addChild(i);var a=BaseBitmap.create("activity_charge_red");this.addChild(a);var n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);1==e.questType?n.text=LanguageManager.getlocal("acSpringceleBrationLand1",[e.value+""]):2==e.questType?n.text=LanguageManager.getlocal("acSpringceleBrationquestType2",[e.value+""]):n.text=LanguageManager.getlocal("acSpringceleBrationquestType"+e.questType,[e.value+""]),n.width=a.width,n.x=a.x+15,n.y=a.y+10,this.addChild(n);var o=GameData.getRewardItemIcons(e.getReward,!0);if(o&&o.length>0)for(var s=20,r=50,l=o.length,h=0;l>h;h++){var d=o[h];d.setPosition(s+h*(d.width*d.scaleX+12),r),this.addChild(d)}this._goBtn3=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"taskGoBtn",this.collectHandler,this),this._goBtn3.x=420,this._goBtn3.y=75,this.addChild(this._goBtn3),this._goBtn2=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"taskGoBtn",this.collectHandler,this),this._goBtn2.x=420,this._goBtn2.y=75,this._goBtn2.visible=!1,this.addChild(this._goBtn2);var g=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_BROWN);g.text=LanguageManager.getlocal("springcelebrationNeedStr",["1",e.value+""]),g.width=this._goBtn3.width,g.x=this._goBtn3.x,g.y=this._goBtn3.y-30,g.textAlign="center",this._needTxt=g,this.addChild(g),1==e.questType&&(g.text=LanguageManager.getlocal("springcelebrationNeedStr",["1",e.value+""]));var c=BaseBitmap.create("collectflag");c.x=450,c.y=50,c.scaleX=.7,c.scaleY=.7,c.visible=!1,this.addChild(c),this._collectflag=c,this.update()},e.prototype.collectHandler=function(t){var e=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE);if(e){var i=e.getTask(this._data.questType);if(0==e.isStart)return void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd"));if(i>=this._data.value)NetManager.request(NetRequestConst.ACTIVITY_GETSPRINGITEMC,{activeId:AcSpringCelebrateView.AID+"-"+AcSpringCelebrateView.CODE,taskId:""+this._data.key});else{if(1==e.isExchange())return void App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_RESFESH_SPRING_ITEM);if(2==this._data.questType)return void App.MessageHelper.dispatchEvent(MessageConst.RESFESH_SPRING_TAB);if(!this._data.openType)return;var a=this._data.openType,n=App.StringUtil.firstCharToUper(a);if("level"==a||"arrival"==a||""==a)ViewController.getInstance().openView(ViewConst.COMMON.PROMOTIONVIEW);else{if(Api[a+"VoApi"]&&Api[a+"VoApi"].isShowNpc){var o=Api[a+"VoApi"].isShowNpc();if(!o){var s=Api[a+"VoApi"].getLockedString?Api[a+"VoApi"].getLockedString():LanguageManager.getlocal("dailyTask_"+a+"Tip");return void App.CommonUtil.showTip(s?s:LanguageManager.getlocal("sysWaitOpen"))}}if("alliance"==a)return void Api.allianceVoApi.openMainView();if("studyatk"==a)return void Api.studyatkVoApi.openMainView();egret.getDefinitionByName(n+"View")?ViewController.getInstance().openView(n+"View"):egret.getDefinitionByName(n+"PopupView")?ViewController.getInstance().openView(n+"PopupView"):"recharge"==a&&ViewController.getInstance().openView(n+"VipView")}}}},e.prototype.update=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE);if(t){if(this._needTxt){var e=t.getTask(this._data.questType);e>=this._data.value?this._needTxt.text=LanguageManager.getlocal("springcelebrationNeedStr",[e+"",this._data.value+""]):this._needTxt.text=LanguageManager.getlocal("springcelebrationNeedStr2",[e+"",this._data.value+""])}this._goBtn3&&(e>=this._data.value?t.isGetRecharge(this._data.key)?(this._goBtn3.visible=!1,this._needTxt.visible=!1,this._collectflag.visible=!0,this._goBtn2.visible=!1):(this._goBtn2.visible=!1,this._goBtn3.visible=!0,this._goBtn3.setText("realnamedes6"),App.DisplayUtil.changeToNormal(this._goBtn3)):1==this._data.questType?(this._goBtn3.visible=!0,this._goBtn3.setText("realnamedes6"),App.DisplayUtil.changeToGray(this._goBtn3)):(this._goBtn3.visible=!1,this._goBtn2.visible=!0,1==t.isExchange()&&(App.DisplayUtil.changeToGray(this._goBtn2),this._goBtn2.touchEnabled=!1)))}},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._goBtn3=null,this._collectflag=null,this._data=null,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_RESFESH_SPRING_ITEM,this.update,this),t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(Celebration3ScrollItem.prototype,"Celebration3ScrollItem");var Celebration4ScrollItem=function(t){function e(){var e=t.call(this)||this;return e._goBtn3=null,e._data=[],e._needTxt=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(MessageConst.MESSAGE_RESFESH_SPRING_ITEM,this.update,this),this._data=e;var i=BaseBitmap.create("public_9_bg14");i.width=600,i.height=126,this.addChild(i);var a=BaseBitmap.create("spring_sign");a.x=140,a.y=35,this.addChild(a);var n=(GameData.formatRewardItem(e.needItem),BaseBitmap.create("itembg_7"));this.addChild(n),n.x=20,n.y=10;var o=BaseLoadBitmap.create("itemicon1");o.scaleX=o.scaleY=.78,o.x=n.x+15,o.y=n.y+10,this.addChild(o);var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);s.text=e.cost,s.x=n.x+50,s.y=n.y+80,s.width=50,s.textAlign="right",this.addChild(s);var r=BaseBitmap.create("shopview_corner");r.x=3,r.y=1,this.addChild(r);var l=ComponentManager.getTextField("",18,TextFieldConst.COLOR_LIGHT_YELLOW);l.x=9,l.y=25,l.rotation=-40;var h=10*e.discount;l.text=LanguageManager.getlocal("discountTitle",[h+""]),this.addChild(l);var d=GameData.getRewardItemIcons(e.getReward,!0);if(d&&d.length>0)for(var g=220,c=10,p=d.length,_=0;p>_;_++){var u=d[_];u.setPosition(g+_*(u.width*u.scaleX+12),c),this.addChild(u)}this._goBtn3=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"exchange",this.collectHandler,this),this._goBtn3.x=420,this._goBtn3.y=45,this.addChild(this._goBtn3);var C=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);C.text=LanguageManager.getlocal("springExchangedes",["1",e.limit+""]),C.x=this._goBtn3.x-30,C.y=this._goBtn3.y-25,C.width=this._goBtn3.width+55,C.textAlign="center",this._needTxt=C,this.addChild(C),this.update()},e.prototype.update=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE);if(t&&(this._goBtn3&&(Api.playerVoApi.getPlayerGem()>=this._data.cost?App.DisplayUtil.changeToNormal(this._goBtn3):App.DisplayUtil.changeToGray(this._goBtn3)),1==t.isExchange()&&(App.DisplayUtil.changeToGray(this._goBtn3),this._goBtn3.touchEnabled=!1),this._needTxt)){var e=t.getExchange4Num(this._data.key);this._needTxt.text=LanguageManager.getlocal("springExchangedes",[e+"",this._data.limit+""]),e==this._data.limit&&(this._goBtn3.setText("acSpringOutofstock"),App.DisplayUtil.changeToGray(this._goBtn3),this._goBtn3.touchEnabled=!1,this._goBtn3.y=45,this._needTxt.visible=!1)}},e.prototype.collectHandler=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(AcSpringCelebrateView.AID,AcSpringCelebrateView.CODE);return 0==t.isStart?void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd")):1==t.isExchange()?void App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_RESFESH_SPRING_ITEM):Api.playerVoApi.getPlayerGem()>=this._data.cost?void NetManager.request(NetRequestConst.ACTIVITY_GETSPRINGITEMD,{activeId:AcSpringCelebrateView.AID+"-"+AcSpringCelebrateView.CODE,shopId:""+this._data.key}):void App.CommonUtil.showTip(LanguageManager.getlocal("springAcerNotenoughdes"))},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._needTxt=null,this._data=null,this._goBtn3=null,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_RESFESH_SPRING_ITEM,this.update,this),t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(Celebration4ScrollItem.prototype,"Celebration4ScrollItem");var AcTailorExchangeView=function(t){function e(){var e=t.call(this)||this;return e._txtList=[],e._skinIdList=[],e._curSkinIdx=0,e._exchangeEnable=!1,e}return __extends(e,t),e.prototype.initView=function(){var t=this.param.data;this._aid=t.aid,this._code=t.code,App.MessageHelper.addEventListener(MessageConst.MESSAGE_REFRESH_SKIN_HEADBG,this.refreshSkin,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_OTHER_ACTIVITY_EXCHANGE_SKIN),this.buyCallbackHandler,this);var e=Config.AcCfg.getCfgByActivityIdAndCode(this._aid,String(this._code));this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var i=BaseBitmap.create("tailor_bg2");i.y=-100,this._nodeContainer.addChild(i);var a=Object.keys(e.shop),n=a.length;this._skinIdList=a;for(var o=new BaseDisplayObjectContainer,s=0;n>s;s++){var r=new AcTailorSkinHeadItem;r.init(a[s]);var l=r.width*s;r.width*n;r.x=l,o.addChild(r)}var h=new egret.Rectangle(0,0,GameConfig.stageWidth,110),d=ComponentManager.getScrollView(o,h);this._nodeContainer.addChild(d),this._skinScrollView=d,this._skinScrollView.bounces=!1;var g=BaseBitmap.create("public_9_bg22");g.height=324,g.y=GameConfig.stageHeigth-g.height-this.container.y+10,g.name="bottomBg",this._nodeContainer.addChild(g);var c=ComponentManager.getButton("btn_leftpage","",this.switchBtnHandler,this,[-1]);c.x=20,c.y=g.y-120,this._nodeContainer.addChild(c);var p=ComponentManager.getButton("btn_leftpage","",this.switchBtnHandler,this,[1]);p.scaleX=-1,p.x=GameConfig.stageWidth-20,p.y=c.y,this._nodeContainer.addChild(p);var _=ComponentManager.getTextField(LanguageManager.getlocal("acTailorskin"),20);_.x=70,_.y=c.y+85,this._nodeContainer.addChild(_);var u=ComponentManager.getTextField(LanguageManager.getlocal("acTailorskin"),20,TextFieldConst.COLOR_QUALITY_GREEN);u.x=_.x+_.width+10,u.y=_.y,this._nodeContainer.addChild(u),this._txtList.push(u);var C=ComponentManager.getTextField(LanguageManager.getlocal("acTailorowner"),20);C.y=_.y,C.x=GameConfig.stageWidth/2+20,this._nodeContainer.addChild(C);var f=ComponentManager.getTextField(LanguageManager.getlocal("acTailorowner"),20,TextFieldConst.COLOR_QUALITY_GREEN);f.x=C.x+C.width+10,f.y=_.y,this._nodeContainer.addChild(f),this._txtList.push(f);var m=BaseBitmap.create("public_9_managebg");m.height=224,m.width=300,m.x=30,m.y=g.y+30,this._nodeContainer.addChild(m);var T=ComponentManager.getTextField(LanguageManager.getlocal("皮肤描述描述描述描述描述描述描述"),20,TextFieldConst.COLOR_BROWN);T.multiline=!0,T.lineSpacing=3,T.width=GameConfig.stageWidth/2-80,T.x=GameConfig.stageWidth/2+40,T.y=g.y+40,this._nodeContainer.addChild(T),this._txtList.push(T);var y=ComponentManager.getTextField(LanguageManager.getlocal("acTailorExchangeTip"),20,TextFieldConst.COLOR_BROWN);y.x=GameConfig.stageWidth/2-y.width/2,y.y=g.y+g.height-45,this._nodeContainer.addChild(y);var v=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"",this.buyHandler,this,[10]);v.setText("10",!1),v.addTextIcon("tailor_icon2"),v.x=420,v.y=g.y+200,this._nodeContainer.addChild(v),this._buyBtn=v,this._ownNumTxt=ComponentManager.getTextField(LanguageManager.getlocal("acTailorowner"),20,TextFieldConst.COLOR_BROWN),this._ownNumTxt.y=v.y-25,this._ownNumTxt.x=v.x+10,this._nodeContainer.addChild(this._ownNumTxt),this._goBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"acGobtnTxt",this.goHandler,this),this._goBtn.x=v.x,this._goBtn.y=v.y,this._goBtn.visible=!1,this._nodeContainer.addChild(this._goBtn);for(var A=m.y+10,s=0;9>s;s++){var w=ComponentManager.getTextField("0",18,TextFieldConst.COLOR_BROWN);w.x=m.x+15,w.y=A,A=A+w.height+5,this._nodeContainer.addChild(w),this._txtList.push(w)}this._curSkinId=this._skinIdList[this._curSkinIdx],this.switchBtnHandler(0,!0)},e.prototype.refreshSkin=function(t){var e=t.data;this._curSkinId=e;for(var i=0;i<this._skinIdList.length;i++)if(e==this._skinIdList[i]){this._curSkinIdx=i;break}this.refreshSkinInfo()},e.prototype.refreshSkinInfo=function(){var t=Config.WifeskinCfg.getWifeCfgById(this._curSkinId),e=Api.wifeSkinVoApi.isOwnSkinOfSkinId(this._curSkinId);if(e?this._goBtn.visible=!0:this._goBtn.visible=!1,this._curWifeImg)this._curWifeImg.setload("wife_skin_"+this._curSkinId);else{var i=this._nodeContainer.getChildByName("bottomBg").y;this._curWifeImg=BaseLoadBitmap.create("wife_skin_"+this._curSkinId),this._curWifeImg.width=540,this._curWifeImg.height=760;var a=(i-60-this.container.y)/this._curWifeImg.height;this._curWifeImg.setScale(a),this._curWifeImg.anchorOffsetX=this._curWifeImg.width/2,this._curWifeImg.anchorOffsetY=this._curWifeImg.height,this._curWifeImg.x=GameConfig.stageWidth/2,this._curWifeImg.y=i-50,this._curWifeImg.y<498&&(this._curWifeImg.y=498),this._nodeContainer.addChildAt(this._curWifeImg,3)}this._droWifeIcon&&(this._droWifeIcon.dispose(),this._droWifeIcon=null),Api.wifeVoApi.isHaveBone(t.bone+"_ske")&&(egret.log("skinCfg.bone."+t.bone),this._droWifeIcon=App.DragonBonesUtil.getLoadDragonBones(t.bone),this._nodeContainer.addChildAt(this._droWifeIcon,2),this._droWifeIcon.setScale(.8)),this._droWifeIcon?(this._droWifeIcon.x=this._curWifeImg.x,this._droWifeIcon.y=this._curWifeImg.y+100,this._curWifeImg.visible=!1):this._curWifeImg.visible=!0;
var n=Config.AcCfg.getCfgByActivityIdAndCode(this._aid,String(this._code)).shop[this._curSkinId];this._buyBtn.removeTextIcon(),this._buyBtn.setText(n.toString(),!1),this._buyBtn.addTextIcon("tailor_icon2");var o=Api.itemVoApi.getItemNumInfoVoById("2101");this._ownNumTxt.text=LanguageManager.getlocal("acTailorownNum",[o.toString()]),this._txtList[0].text=LanguageManager.getlocal("skinName"+this._curSkinId),this._exchangeEnable=!1,o>=n&&(this._exchangeEnable=!0);var s=LanguageManager.getlocal("wifeName_"+t.wifeId);Api.wifeVoApi.getWifeInfoVoById(t.wifeId)?this._txtList[1].text=s+LanguageManager.getlocal("servant_wife_own"):this._txtList[1].text=s+LanguageManager.getlocal("servant_wife_not_own"),this._txtList[2].text=LanguageManager.getlocal("skinDesc"+this._curSkinId);for(var r=this.dealAttrChangeInfo(),l=3;l<this._txtList.length;l++){var h=r[l-3];h?this._txtList[l].text=r[l-3]:this._txtList[l].text=""}},e.prototype.dealAttrChangeInfo=function(){var t=Config.WifeskinCfg.getWifeCfgById(this._curSkinId),e=[],i=t.atkAdd,a=t.inteAdd,n=t.politicsAdd,o=t.charmAdd,s=t.wifeIntimacy,r=t.wifeGlamour,l=t.childReduce,h=t.searchReduce,d=t.wifeReduce;return 1==i[0]?e.push(LanguageManager.getlocal("acTailAttrAdd1",[i[1]])):e.push(LanguageManager.getlocal("acTailAttrAdd1",[100*i[1]+"%"])),1==a[0]?e.push(LanguageManager.getlocal("acTailAttrAdd2",[a[1]])):e.push(LanguageManager.getlocal("acTailAttrAdd2",[100*a[1]+"%"])),1==n[0]?e.push(LanguageManager.getlocal("acTailAttrAdd3",[n[1]])):e.push(LanguageManager.getlocal("acTailAttrAdd3",[100*n[1]+"%"])),1==o[0]?e.push(LanguageManager.getlocal("acTailAttrAdd4",[o[1]])):e.push(LanguageManager.getlocal("acTailAttrAdd4",[100*o[1]+"%"])),s&&s>0&&e.push(LanguageManager.getlocal("acTailAttrAdd5",[s.toString()])),r&&r>0&&e.push(LanguageManager.getlocal("acTailAttrAdd6",[r.toString()])),l&&l>0&&e.push(LanguageManager.getlocal("acTailAttrAdd7",[l.toString()])),h&&h>0&&e.push(LanguageManager.getlocal("acTailAttrAdd8",[h.toString()])),d&&d>0&&e.push(LanguageManager.getlocal("acTailAttrAdd9",[d.toString()])),e},e.prototype.buyHandler=function(t){var e=Api.wifeSkinVoApi.isOwnSkinOfSkinId(this._curSkinId);if(!e){if(!this._exchangeEnable){var i=LanguageManager.getlocal("acTailorExchangeFailTip");return void ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"itemUseConstPopupViewTitle",msg:i,callback:this.hide,handler:this,needCancel:!0})}var a=Config.WifeskinCfg.getWifeCfgById(this._curSkinId);if(!Api.wifeVoApi.getWifeInfoVoById(a.wifeId)){var i=LanguageManager.getlocal("acTailorExchangeTip1");return void ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"itemUseConstPopupViewTitle",msg:i,callback:this.doExchangeRequest,handler:this,needCancel:!0})}this.doExchangeRequest()}},e.prototype.doExchangeRequest=function(){return 0==Api.acVoApi.getActivityVoByAidAndCode(this._aid,this._code).isStart?void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd")):void NetManager.request(NetRequestConst.REQUEST_OTHER_ACTIVITY_EXCHANGE_SKIN,{activeId:this._aid+"-"+this._code,shopId:this._curSkinId})},e.prototype.goHandler=function(){var t=Config.WifeskinCfg.getWifeCfgById(this._curSkinId);return Api.wifeVoApi.getWifeInfoVoById(t.wifeId)?void ViewController.getInstance().openView(ViewConst.COMMON.WIFEOPTVIEW,{id:t.wifeId,handler:this}):void App.CommonUtil.showTip(LanguageManager.getlocal("acTailorGoTip1"))},e.prototype.buyCallbackHandler=function(t){var e=t.data.data;0==e.ret&&(App.CommonUtil.showTip(LanguageManager.getlocal("acTailorExchangeTip2")),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_SKIN_HEADBG,this._skinIdList[this._curSkinIdx]))},e.prototype.switchBtnHandler=function(t,e){if(e)return void App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_SKIN_HEADBG,this._skinIdList[this._curSkinIdx]);var i=this._skinIdList.length-1;if(!(0==this._curSkinIdx&&-1==t||this._curSkinIdx==i&&1==t)){this._curSkinIdx+=t;var a=this._skinScrollView.scrollLeft,n=0;113*this._curSkinIdx-a>=GameConfig.stageWidth&&(n=113*this._curSkinIdx-a-GameConfig.stageWidth,n+=113),a>113*this._curSkinIdx&&(n=113*this._curSkinIdx-a),this._skinScrollView.setScrollLeft(a+n,1e3),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_SKIN_HEADBG,this._skinIdList[this._curSkinIdx])}},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["tailor_bg2","tailor_headmask","public_9_managebg"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_REFRESH_SKIN_HEADBG,this.refreshSkin,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_OTHER_ACTIVITY_EXCHANGE_SKIN),this.buyCallbackHandler,this),this._txtList=[],this._nodeContainer=null,this._ownNumTxt=null,this._curSkinId=null,this._txtList=[],this._aid=null,this._code=null,this._skinIdList=[],this._curSkinIdx=0,this._skinScrollView=null,this._curWifeImg=null,this._buyBtn=null,this._goBtn=null,this._exchangeEnable=!1,this._droWifeIcon=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(AcTailorExchangeView.prototype,"AcTailorExchangeView");var AcTailorGetView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this._nodeContainer=new BaseDisplayObjectContainer,this.addChild(this._nodeContainer);var t=BaseBitmap.create("tailor_get_bg");this._nodeContainer.addChild(t);var e=BaseBitmap.create("tailor_get_light");e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=GameConfig.stageWidth/2,e.y=20+e.height/2,egret.Tween.get(e,{loop:!0}).to({rotation:360},5e3),this._nodeContainer.addChild(e);var i=BaseBitmap.create("tailor_get_light");i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.x=e.x,i.y=e.y,egret.Tween.get(i,{loop:!0}).to({rotation:-360},5e3),this._nodeContainer.addChild(i);var a=BaseBitmap.create("tailor_get_wordbg");a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,a.x=GameConfig.stageWidth/2,a.y=e.y,a.setScale(0),egret.Tween.get(a,{loop:!1}).to({scaleX:1.2,scaleY:1.2},200).to({scaleX:1,scaleY:1},50),this._nodeContainer.addChild(a);var n=BaseBitmap.create("tailor_get_word");n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.x=GameConfig.stageWidth/2,n.y=a.y,n.setScale(0),egret.Tween.get(n,{loop:!1}).wait(100).to({scaleX:1.2,scaleY:1.2},200).to({scaleX:1,scaleY:1},50),this._nodeContainer.addChild(n);var o=this.param.data.rewards,s=this.param.data.buyCost,r=1;-1!=o.indexOf("|")&&(r=10);var l=ComponentManager.getTextField(LanguageManager.getlocal("acTailGetTip",[String(r)]),24);l.x=GameConfig.stageWidth/2-l.width/2,l.y=GameConfig.stageHeigth/2-50,this._nodeContainer.addChild(l);var h=BaseLoadBitmap.create("itemicon1001");h.x=l.x+100,h.y=l.y-18,h.setScale(.5),this._nodeContainer.addChild(h);var d=GameData.getRewardItemIcons(o,!0,!1),g=25,c=l.y+80,p=0;if(1==d.length){var _=d[0];_.anchorOffsetX=_.width/2,_.anchorOffsetY=_.height/2,_.x=GameConfig.stageWidth/2,_.y=c+_.height/2,_.setScale(4),p=400,egret.Tween.get(_,{loop:!1}).to({scaleX:.9,scaleY:.9},200).to({scaleX:1,scaleY:1},50),this._nodeContainer.addChild(_)}else{for(var u=0;u<d.length;u++){var _=d[u];_.anchorOffsetX=_.width/2,_.anchorOffsetY=_.height/2,_.setScale(0),_.x=g+_.width/2,_.y=c+_.height/2,g+=_.width+12,g>=GameConfig.stageWidth&&(g=25,c+=_.height+20,_.x=g+_.width/2,_.y=c+_.height/2,g+=_.width+12),egret.Tween.get(_,{loop:!1}).wait(100*u).to({scaleX:1.2,scaleY:1.2},200).to({scaleX:1,scaleY:1},50),this._nodeContainer.addChild(_)}p=100*d.length}var C=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"sysConfirm",this.hide,this);C.x=100,C.y=GameConfig.stageHeigth-85,C.alpha=0,egret.Tween.get(C,{loop:!1}).wait(p).to({alpha:1},500),this._nodeContainer.addChild(C);var f="",m=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,f,this.buyAgainHandler,this,[r]);m.x=400,m.y=C.y,this.doWaitAni(m,p),this._nodeContainer.addChild(m);var T=BaseLoadBitmap.create("itemicon1001");T.x=m.x+65,T.y=m.y+5,T.setScale(.4),this._nodeContainer.addChild(T),10==r?(f=LanguageManager.getlocal("acTailorBtnTW",["10"]),T.x=m.x+60):f=LanguageManager.getlocal("acTailorBtnTW",["1"]),m.setText(f,!1);var y=BaseBitmap.create("public_icon1");y.x=m.x+30,y.y=m.y-30,y.setScale(.7),this.doWaitAni(y,p),this._nodeContainer.addChild(y);var v=ComponentManager.getTextField(String(s),18);if(v.x=y.x+y.width-5,v.y=y.y+y.height/2-v.height/2-5,this.doWaitAni(v,p),this._nodeContainer.addChild(v),10==d.length){var A=ComponentManager.getTextField(LanguageManager.getlocal("acTailTenTip"),18);A.x=m.x+m.width/2-A.width/2,A.y=m.y+60,this._nodeContainer.addChild(A),this.doWaitAni(A,p)}var w=BaseBitmap.create("public_icon1");w.x=120,w.y=10,this._nodeContainer.addChild(w);var x=ComponentManager.getTextField(Api.playerVoApi.getPlayerGemStr(),18);x.x=w.x+50,x.y=w.y+15,this._nodeContainer.addChild(x);var I=BaseBitmap.create("tailor_icon2");I.x=380,I.y=w.y+5,this._nodeContainer.addChild(I);var L=ComponentManager.getTextField("",18);L.text=Api.itemVoApi.getItemNumInfoVoById("2101").toString(),L.x=I.x+50,L.y=x.y,this._nodeContainer.addChild(L),this.doWaitAni(C,p),this.doWaitAni(l,p),this.doWaitAni(h,p),this.doWaitAni(T,p),this.doWaitAni(w,p),this.doWaitAni(I,p),this.doWaitAni(x,p),this.doWaitAni(L,p)},e.prototype.doWaitAni=function(t,e){t.alpha=0,egret.Tween.get(t,{loop:!1}).wait(e).to({alpha:1},500)},e.prototype.buyAgainHandler=function(t){var e=this.param.data.callback,i=this.param.data.handler;e.apply(i,[t]),this.hide()},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["tailor_get_light","tailor_get_word","tailor_get_wordbg","tailor_get_bg"])},e.prototype.dispose=function(){this._nodeContainer=null,t.prototype.dispose.call(this)},e}(BaseView);__reflect(AcTailorGetView.prototype,"AcTailorGetView");var AcTailorRewardPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=this.param.data.aid,e=this.param.data.code,i=Config.AcCfg.getCfgByActivityIdAndCode(t,e),a=i.tailorPool,n=[];for(var o in a)n.push(a[o][0]);var s=BaseBitmap.create("public_9_bg39");s.width=520,s.height=522,s.name="bottomBg",s.x=this.viewBg.x+this.viewBg.width/2-s.width/2,s.y=this.viewBg.y+20,this.addChildToContainer(s);var r=egret.Rectangle.create();r.setTo(0,0,s.width,s.height-10);for(var l=new BaseDisplayObjectContainer,h=25,d=15,g=GameData.getRewardItemIcons(n.join("|"),!0,!0),c=0;c<g.length;c++){var p=g[c];p.x=h,p.y=d,h+=p.width+15,h>=s.x+s.width&&(h=25,d+=p.height+15,p.x=h,p.y=d,h+=p.width+15),l.addChild(p)}var _=ComponentManager.getScrollView(l,r);_.horizontalScrollPolicy="off",_.x=s.x,_.y=s.y+5,this.addChildToContainer(_)},e.prototype.getShowHeight=function(){return 660},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["itemeffect"])},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(PopupView);__reflect(AcTailorRewardPopupView.prototype,"AcTailorRewardPopupView");var AcTailorSkinHeadItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(t){App.MessageHelper.addEventListener(MessageConst.MESSAGE_REFRESH_SKIN_HEADBG,this.refreshStatus,this),this._skinId=""+t;Config.WifeskinCfg.getWifeCfgById(this._skinId);this._headBg=BaseBitmap.create("tailor_iconBtn"),this._headBg.addTouchTap(this.bgClickHandler,this),this.addChild(this._headBg);var e=BaseLoadBitmap.create("wife_skinhalf_"+this._skinId);e.width=205,e.height=196;var i=BaseBitmap.create("tailor_headmask"),a=new BaseDisplayObjectContainer;a.addChild(i),this.addChild(a),e.setScale(.5),e.anchorOffsetX=e.width/2,e.x=this._headBg.x+this._headBg.width/2,e.y=5,a.x=17,a.y=12,e.mask=i,this.addChild(e),this._ownBg=BaseBitmap.create("tailor_namebg"),this._ownBg.visible=!1,this._ownBg.x=this._headBg.x+this._headBg.width/2-this._ownBg.width/2,this._ownBg.y=this._headBg.y+this._headBg.height-35,this.addChild(this._ownBg),this._ownTxt=ComponentManager.getTextField(LanguageManager.getlocal("acTailOwn"),20,TextFieldConst.COLOR_QUALITY_GREEN),this._ownTxt.visible=!1,this._ownTxt.x=this._ownBg.x+this._ownBg.width/2-this._ownTxt.width/2,this._ownTxt.y=this._ownBg.y+5,this.addChild(this._ownTxt),this.cacheAsBitmap=!0},e.prototype.bgClickHandler=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_SKIN_HEADBG,this._skinId)},e.prototype.refreshStatus=function(t){var e=t.data,i=Api.wifeSkinVoApi.isOwnSkinOfSkinId(this._skinId);e==this._skinId?this._headBg.texture=ResourceManager.getRes("tailor_iconBtn_down"):this._headBg.texture=ResourceManager.getRes("tailor_iconBtn"),i?(this._ownBg.visible=!0,this._ownTxt.visible=!0):(this._ownBg.visible=!1,this._ownTxt.visible=!1)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_REFRESH_SKIN_HEADBG,this.refreshStatus,this),this.cacheAsBitmap=!1,this._skinId="",this._headBg=null,this._ownBg=null,this._ownTxt=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(AcTailorSkinHeadItem.prototype,"AcTailorSkinHeadItem");var AcTailorSkinItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(t,e,i){var a=(_={},_[101]=20,_[102]=0,_[103]=20,_[104]=0,_[105]=0,_[106]=-40,_[107]=0,_[108]=-30,_[109]=0,_[201]=-10,_[202]=0,_[203]=0,_[204]=0,_[205]=0,_[206]=0,_[207]=0,_[208]=-60,_[209]=-20,_[210]=0,_[303]=-10,_[302]=0,_[304]=0,_[305]=0,_[306]=0,_[307]=-20,_[310]=0,_);this._skinId=""+t[0];var n=(Config.AcCfg.getCfgByActivityIdAndCode(e,i),BaseBitmap.create("tailor_box"));this.addChild(n),this.width=n.width+5,this.height=n.height;var o=Config.WifeskinCfg.getWifeCfgById(this._skinId),s=o.wifeId,r=BaseLoadBitmap.create("wife_skin_"+this._skinId);r.width=540,r.height=760,r.anchorOffsetX=r.width/2+a[s],r.setScale(.5);var l=BaseBitmap.create("tailor_skinMask"),h=new BaseDisplayObjectContainer;h.addChild(l),this.addChild(h),r.mask=l,r.x=n.width/2,r.y=80,h.x=8,h.y=70,this.addChild(r);var d=ComponentManager.getTextField(LanguageManager.getlocal("wifeName_"+s),22,TextFieldConst.COLOR_BROWN);d.x=n.x+n.width/2-d.width/2,d.y=n.y+15,this.addChild(d);var g=ComponentManager.getTextField(LanguageManager.getlocal("skinName"+this._skinId),22,TextFieldConst.COLOR_WARN_GREEN2);g.x=n.x+n.width/2-g.width/2,g.y=d.y+22,this.addChild(g);var c=BaseLoadBitmap.create("tailor_icon2");c.x=n.x+40,c.y=n.y+n.height-45,this.addChild(c);var p=ComponentManager.getTextField(t[1],20);p.x=c.x+55,p.y=c.y+8,this.addChild(p),this.cacheAsBitmap=!0;var _},e.prototype.dispose=function(){this._skinId="",this.cacheAsBitmap=!1,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(AcTailorSkinItem.prototype,"AcTailorSkinItem");var AcTailorView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_OTHER_ACTIVITY_EXCHANGE_SKIN),this.refreshSkinNum,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_OTHER_ACTIVITY_USETENTAILOR),this.buyCallbackHandler,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_OTHER_ACTIVITY_USETAILOR),this.buyCallbackHandler,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var t=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,String(this.code)),e=BaseBitmap.create("tailor_bg");e.y=-100,this._nodeContainer.addChild(e);var i=BaseBitmap.create("tailor_word");i.y=50,i.x=270,this._nodeContainer.addChild(i);var a=BaseBitmap.create("public_icon1");a.x=120,a.y=-10,this._nodeContainer.addChild(a),this._goldNumTxt=ComponentManager.getTextField(Api.playerVoApi.getPlayerGemStr(),18),this._goldNumTxt.x=a.x+50,this._goldNumTxt.y=a.y+15,this._nodeContainer.addChild(this._goldNumTxt);var n=BaseBitmap.create("tailor_icon2");n.x=380,n.y=a.y+5,this._nodeContainer.addChild(n),this._skinNumTxt=ComponentManager.getTextField("",18),this._skinNumTxt.text=Api.itemVoApi.getItemNumInfoVoById("2101").toString(),this._skinNumTxt.x=n.x+50,this._skinNumTxt.y=this._goldNumTxt.y,this._nodeContainer.addChild(this._skinNumTxt);var o=App.DateUtil.getFormatBySecond(this.acVo.st,9),s=App.DateUtil.getFormatBySecond(this.acVo.et,9),r=ComponentManager.getTextField("",18,TextFieldConst.COLOR_QUALITY_GREEN);r.text=LanguageManager.getlocal("acPunishDate",[o,s]),r.x=330,r.y=145,this._nodeContainer.addChild(r);var l=ComponentManager.getButton("tailor_btn2","",this.illuHandler,this);l.x=10,l.y=50,this._nodeContainer.addChild(l);var h=ComponentManager.getButton("tailor_btn1","",this.rewardHandler,this);h.x=130,h.y=l.y,this._nodeContainer.addChild(h);var d=BaseBitmap.create("tailor_btn1_txt");d.x=l.x+l.width/2-d.width/2,d.y=l.y+h.height-30,this._nodeContainer.addChild(d);var g=BaseBitmap.create("tailor_btn2_txt");g.x=h.x+h.width/2-g.width/2,g.y=d.y,this._nodeContainer.addChild(g);for(var c=(Object.keys(t.showList),t.showList),p=c.length,_=0;p>_;_++){var u=new AcTailorSkinItem,C=c[_];u.init(C,this.aid,this.code);var f=u.width*_;u.width*p;u.x=f,u.y=195;var m=4500;egret.Tween.get(u,{loop:!0}).to({x:-u.width},(_+1)*m).set({x:u.width*(p-1)},u).to({x:f},(p-_-1)*m),this._nodeContainer.addChild(u)}var T=ComponentManager.getTextField(LanguageManager.getlocal("acTailBuyTip"),20);T.x=GameConfig.stageWidth/2-T.width/2,T.y=710,this._nodeContainer.addChild(T);var y=BaseLoadBitmap.create("itemicon1001");y.x=T.x+160,y.y=T.y-18,y.setScale(.5),this._nodeContainer.addChild(y);var v=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"acTailorBtnOne",this.buyHandler,this,[1]);v.x=100,v.y=770,this._nodeContainer.addChild(v);var A=BaseBitmap.create("public_icon1");A.x=v.x+30,A.y=v.y-30,A.name="oneCostIcon",A.setScale(.7),this._nodeContainer.addChild(A);var w=Api.acVoApi.getActivityVoByAidAndCode(this.aid,this.code),x=ComponentManager.getTextField(String(t.cost),18);x.name="oneCostTxt",x.x=A.x+A.width-5,x.y=A.y+A.height/2-x.height/2-5,this._nodeContainer.addChild(x);var I="acTailorFree",L=ComponentManager.getTextField(LanguageManager.getlocal("sysFreeDesc"),18,TextFieldConst.COLOR_WARN_GREEN);L.name="freeTxt",L.text=LanguageManager.getlocal(I),L.x=v.x+v.width/2-L.width/2,L.y=x.y,L.visible=!1,this._nodeContainer.addChild(L),1==w.getFreeNum()&&(x.visible=!1,A.visible=!1,L.visible=!0);var E=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"acTailorBtnTen",this.buyHandler,this,[10]);E.x=400,E.y=v.y,this._nodeContainer.addChild(E);var B=LanguageManager.getlocal("acTailorBtnTW",["1"]),S=LanguageManager.getlocal("acTailorBtnTW",["10"]);E.setText(S,!1),v.setText(B,!1);var N=BaseLoadBitmap.create("itemicon1001");N.x=v.x+65,N.y=v.y+5,N.setScale(.4),this._nodeContainer.addChild(N);var M=BaseLoadBitmap.create("itemicon1001");M.x=E.x+60,M.y=N.y,M.setScale(.4),this._nodeContainer.addChild(M);var b=BaseBitmap.create("public_icon1");b.x=E.x+30,b.y=A.y,b.setScale(.7),this._nodeContainer.addChild(b);var O=ComponentManager.getTextField(String(t.cost*t.discount*10),18);O.x=b.x+b.width-5,O.y=x.y,this._nodeContainer.addChild(O);var V=ComponentManager.getTextField(LanguageManager.getlocal("acTailTenTip"),18);V.x=E.x+E.width/2-V.width/2,V.y=E.y+60,this._nodeContainer.addChild(V)},e.prototype.buyHandler=function(t){if(0==Api.acVoApi.getActivityVoByAidAndCode(this.aid,this.code).isStart)return void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd"));var e=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,String(this.code));if(1==t){var i=Api.acVoApi.getActivityVoByAidAndCode(this.aid,this.code);if(1!=i.getFreeNum()&&Api.playerVoApi.getPlayerGem()<e.cost)return void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough"));NetManager.request(NetRequestConst.REQUEST_OTHER_ACTIVITY_USETAILOR,{activeId:this.aid+"-"+this.code})}else{if(Api.playerVoApi.getPlayerGem()<e.cost*e.discount*10)return void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough"));NetManager.request(NetRequestConst.REQUEST_OTHER_ACTIVITY_USETENTAILOR,{activeId:this.aid+"-"+this.code})}},e.prototype.buyCallbackHandler=function(t){var e=t.data.data;if(0==e.ret){var i=Api.acVoApi.getActivityVoByAidAndCode(this.aid,this.code);1==i.getFreeNum()?(this._nodeContainer.getChildByName("oneCostTxt").visible=!1,this._nodeContainer.getChildByName("oneCostIcon").visible=!1,this._nodeContainer.getChildByName("freeTxt").visible=!0):(this._nodeContainer.getChildByName("oneCostTxt").visible=!0,this._nodeContainer.getChildByName("oneCostIcon").visible=!0,this._nodeContainer.getChildByName("freeTxt").visible=!1),this._goldNumTxt.text=Api.playerVoApi.getPlayerGemStr(),this._skinNumTxt.text=Api.itemVoApi.getItemNumInfoVoById("2101").toString();var a=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,String(this.code)),n=e.data.rewards,o=a.cost;-1!=n.indexOf("|")&&(o=o*a.discount*10),ViewController.getInstance().openView("AcTailorGetView",{rewards:e.data.rewards,buyCost:o,callback:this.buyHandler,handler:this})}},e.prototype.refreshSkinNum=function(){this._skinNumTxt.text=Api.itemVoApi.getItemNumInfoVoById("2101").toString()},e.prototype.rewardHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.ACTAILOREXCHANGEVIEW,{aid:this.aid,code:this.code})},e.prototype.illuHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.ACTAILORREWARDPOPUPVIEW,{aid:this.aid,code:this.code})},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["tailor_bg","tailor_box","tailor_clothes","tailor_icon1","tailor_icon","tailor_iconBtn_down","tailor_iconBtn","tailor_mask","tailor_namebg","tailor_icon2","tailor_word","tailor_skinMask","tailor_btn1","tailor_btn2","tailor_btn1_down","tailor_btn2_down","tailor_btn1_txt","tailor_btn2_txt"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_OTHER_ACTIVITY_EXCHANGE_SKIN),this.refreshSkinNum,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_OTHER_ACTIVITY_USETENTAILOR),this.buyCallbackHandler,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_OTHER_ACTIVITY_USETAILOR),this.buyCallbackHandler,this),this._nodeContainer=null,this._goldNumTxt=null,this._skinNumTxt=null,t.prototype.dispose.call(this)},e}(AcCommonView);__reflect(AcTailorView.prototype,"AcTailorView");var AcVipShopPopupView=function(t){function e(){var e=t.call(this)||this;return e.rewardArrList=[],e}return __extends(e,t),e.prototype.getBgName=function(){return"public_9_wordbg"},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitle=function(){return null},e.prototype.isTouchMaskClose=function(){return!0},e.prototype.initView=function(){var t=BaseLoadBitmap.create("wife_full_205");t.x=10,t.scaleX=.4,t.scaleY=.4,t.y=-210,this.addChildToContainer(t);var e=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),i=LanguageManager.getlocal("vipshopbuydes1");e.width=310,e.height=54,e.text=i,e.x=270,e.y=this.viewBg.y-70,this.addChildToContainer(e);var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN),n=LanguageManager.getlocal("vipshopbuydes2");a.width=320,a.height=54,a.text=n,a.x=300,a.y=e.y+60,this.addChildToContainer(a);var o=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"vipshopbtn",this.clickBtnHandler,this);o.x=this.viewBg.width/2-o.width/2+100,o.y=this.viewBg.y+35,this.addChildToContainer(o)},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this),this.viewBg.height=200,this.viewBg.y=this.viewBg.y-100,this.closeBtn.y=this.viewBg.y-50,this.closeBtn.x=this.closeBtn.x-10},e.prototype.clickBtnHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW),ViewController.getInstance().hideView(ViewConst.POPUP.ACVIPSHOPPOPUPVIEW)},e.prototype.touchHandler=function(){ViewController.getInstance().hideView(ViewConst.POPUP.ACVIPSHOPPOPUPVIEW)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([])},e.prototype.dispose=function(){this._scrollList=null,this.rewardArrList=[],t.prototype.dispose.call(this)},e}(PopupView);__reflect(AcVipShopPopupView.prototype,"AcVipShopPopupView");var AcVipShopView=function(t){function e(){var e=t.call(this)||this;return e.gemTF=null,e._currVipLevel=0,e._nextVipLevel=0,e._storeDesTxt=null,e._itemArr=[],e._cfgObj=null,e._scrollList=null,e._activityTimerText=null,e._acvipshopvipText=null,e._vipImg=null,e.lastType=0,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.ACTIVITY_BUYVIPSHOP),this.buyCallback,this),e.AID=this.aid,e.CODE=this.code,this._currVipLevel=Api.playerVoApi.getPlayerVipLevel(),this._nextVipLevel=Api.playerVoApi.getPlayerNextVipLevel(),App.MessageHelper.addNetMessage(NetPushConst.PUSH_PAY,this.checkRedpoints,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var t=BaseBitmap.create("acvipshopview_bluebottom");t.width=640,t.height=500,t.y=800,this._nodeContainer.addChild(t);var i=BaseBitmap.create("activity_vipshop_topbg");i.width=GameConfig.stageWidth+18,i.y=-13,this._nodeContainer.addChild(i);var a=BaseBitmap.create("public_9_bg25");a.width=380,a.height=90,this._nodeContainer.addChild(a),a.x=250,a.y=60;var n=BaseBitmap.create("acvipshopview_horn");this._nodeContainer.addChild(n),n.x=a.x-20,n.y=a.y+a.height/2-n.height/2-20;var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN),s=LanguageManager.getlocal("vipspeakdes");o.text=s,o.width=a.width-30,o.x=a.x+15,o.y=a.y+18,o.lineSpacing=3,this._nodeContainer.addChild(o);var r=BaseBitmap.create("servant_bottombg");r.width=GameConfig.stageWidth+16,r.height=GameConfig.stageHeigth-i.height-i.y-this.container.y+5-60,r.x=-8,r.y=i.height+i.y,this._nodeContainer.addChild(r),this._activityTimerText=ComponentManager.getTextField(Api.playerVoApi.getPlayerGem().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._activityTimerText.x=260,this._activityTimerText.y=205;App.DateUtil.getFormatBySecond(this.acVo.st,7),App.DateUtil.getFormatBySecond(this.acVo.et-86400,7);this._activityTimerText.text=this.acVo.getAcLocalTime(!0),this.addChildToContainer(this._activityTimerText);var l=[],h=new egret.Rectangle(0,0,GameConfig.stageWidth,r.height-130),d=r.y+24,g=15;if(this._cfgObj=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code),this._cfgObj){this._itemArr=this._cfgObj.getList(1),l.push("acvip_tab1"),l.push("acvip_tab2"),l.push("acvip_tab3");var c=ComponentManager.getScrollList(AcVipShopViewScrollItem,this._itemArr,h);c.y=d+170,c.x=25,this._scrollList=c,this.addChild(c)}var p=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,l,this.tabBtnClickHandler,this);p.x=g,p.y=d,this._nodeContainer.addChild(p);var _=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),u=LanguageManager.getlocal("vipshopcurrvipdes");if(_.text=u,_.x=430,_.y=r.y+r.height+12,this.addChildToContainer(_),this._acvipshopvipText=_,this._currVipLevel>0){var C=BaseLoadBitmap.create(Api.vipVoApi.getVipCfgByLevel(this._currVipLevel).icon);this.addChildToContainer(C),C.x=_.x+_.width,C.y=_.y-5,C.bindData=Api.vipVoApi.getVipCfgByLevel(this._currVipLevel).icon,this._vipImg=C}else 0==this._currVipLevel&&(_.text=u+":无");var f=38,m=BaseBitmap.create("servant_topnumbg");m.x=8,m.y=_.y+102,this.addChild(m);var T=BaseBitmap.create("public_icon1");T.scaleX=f/T.width,T.scaleY=f/T.height,T.x=15,T.y=_.y+100,this.addChild(T),this.gemTF=ComponentManager.getTextField(Api.playerVoApi.getPlayerGem().toString(),TextFieldConst.FONTSIZE_TITLE_SMALL),this.gemTF.x=T.x+f+5,this.gemTF.y=T.y+5,this.addChild(this.gemTF);var y=ComponentManager.getButton("mainui_btn1","",this.goToRechargeHandler,this);y.setScale(.85),y.x=m.width-5,y.y=m.y,this.addChild(y)},e.prototype.buyCallback=function(t){this.gemTF.text=Api.playerVoApi.getPlayerGemStr(),1==t.data.ret&&(t.data&&t.data.data&&t.data.data.data.rewards&&App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.data.rewards)),0==this.lastType&&(this.lastType=1),this._itemArr=this._cfgObj.getList(this.lastType),this._scrollList.refreshData(this._itemArr),this._scrollList.setPosition(25,427))},e.prototype.tabBtnClickHandler=function(t){this._itemArr=[];var e=t.index;this.lastType=e+1,this._itemArr=this._cfgObj.getList(e+1),this._scrollList.refreshData(this._itemArr),this._scrollList.setPosition(25,427)},e.prototype.goToRechargeHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["activity_vipshop_topbg","acvipshopview_red","acvipshopview_horn","servant_bottombg","acvipshopview_bluebottom","servant_topnumbg"])},e.prototype.checkRedpoints=function(){if(this._currVipLevel=Api.playerVoApi.getPlayerVipLevel(),this._currVipLevel>0&&this._vipImg){var t=Api.vipVoApi.getVipCfgByLevel(this._currVipLevel).icon;this._vipImg.setload(t);var e=LanguageManager.getlocal("vipshopcurrvipdes");this._acvipshopvipText.text=e}else if(this._currVipLevel>0){var i=BaseLoadBitmap.create(Api.vipVoApi.getVipCfgByLevel(this._currVipLevel).icon);this.addChildToContainer(i),i.x=this._acvipshopvipText.x+this._acvipshopvipText.width-23,i.y=this._acvipshopvipText.y-5,this._vipImg=i;var e=LanguageManager.getlocal("vipshopcurrvipdes");this._acvipshopvipText.text=e}var t=Api.vipVoApi.getVipCfgByLevel(this._currVipLevel).icon;this._vipImg&&this._vipImg.bindData!=t&&(this._vipImg.bindData=t,0==this.lastType&&(this.lastType=1),this._itemArr=this._cfgObj.getList(this.lastType),this._scrollList.refreshData(this._itemArr),this._scrollList.setPosition(25,427),this.gemTF&&(this.gemTF.text=Api.playerVoApi.getPlayerGem().toString()))},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(NetPushConst.PUSH_PAY,this.checkRedpoints,this),this._nodeContainer=null,e.AID=null,e.CODE=null,this._activityDurTxt=null,this._storeDesTxt=null,this.lastType=0,this._activityTimerText=null,this._vipImg=null,t.prototype.dispose.call(this)},e.AID=null,e.CODE=null,e}(AcCommonView);__reflect(AcVipShopView.prototype,"AcVipShopView");var AcVipShopViewScrollItem=function(t){function e(){var e=t.call(this)||this;return e._uiData=void 0,e._rechargeItem=null,e._curIdx=0,e._lastReqIdx=null,e._databuyNum=[],e._data=null,e._needGod=0,e._buyNum=0,e._acVo=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){var i=Api.playerVoApi.getPlayerVipLevel(),a=Api.playerVoApi.getPlayerNextVipLevel();this._databuyNum=e.buyNum,this._data=e;var n=BaseBitmap.create("public_9_managebg");n.width=189,n.height=237,this.addChild(n);var o=GameData.getRewardItemIcons(e.content,!0)[0];if(o.x=n.width-o.width-(n.width-o.width)/2,o.y=n.y+10,this.addChild(o),e.needVip>0){var s=BaseBitmap.create("acvipshopview_red");s.x=o.x,s.y=o.y,this.addChild(s);var r=BaseLoadBitmap.create(Api.vipVoApi.getVipCfgByLevel(e.needVip).icon);this.addChild(r),r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,r.scaleX=.72,r.scaleY=.72,r.rotation=r.rotation-45,r.x=s.x+r.width/2-5,r.y=s.y+r.height+35}var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN),h="";if(0==i&&0==e.buyNum[i]?(h=LanguageManager.getlocal("vipshopbuydes0",[i+"",e.buyNum[i]+""]),l.x=o.x+15):(h=0==e.buyNum[i]?LanguageManager.getlocal("vipshopbuydes_red",[i+"",e.buyNum[i]+""]):LanguageManager.getlocal("vipshopbuydes",[i+"",e.buyNum[i]+""]),l.x=o.x-10),l.text=h,l.y=o.y+o.height+5,this.addChild(l),this._buyNum=e.buyNum[i],i==Config.VipCfg.getMaxLevel())l.y=o.y+o.height+15;else{var d=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN),g=LanguageManager.getlocal("vipshopbuydes",[a+"",e.buyNum[a]+""]);
d.text=g,d.x=o.x-10,d.y=l.y+25,d.alpha=.5,this.addChild(d);var c=this.getNextVipNum(e.buyNum[i],e.buyNum[a]),p=this._databuyNum.length-1;c&&c>0&&c!=p&&(g=LanguageManager.getlocal("vipshopbuydes",[c+"",e.buyNum[c]+""]),d.text=g)}var _=Api.acVoApi.getActivityVoByAidAndCode(AcVipShopView.AID,AcVipShopView.CODE);this._acVo=_;var u=0;if(_.shop&&(u=_.shop[e.id]),u){u=u,this._buyNum=e.buyNum[i]-u;var C=LanguageManager.getlocal("vipshopbuydes",[i+"",e.buyNum[i]-u+""]);if(l.text=C,e.buyNum[i]-u==0){var f=LanguageManager.getlocal("vipshopbuydes_red",[i+"",e.buyNum[i]-u+""]);l.text=f}if(i!=Config.VipCfg.getMaxLevel()){var g=LanguageManager.getlocal("vipshopbuydes",[a+"",e.buyNum[a]-u+""]),c=this.getNextVipNum(e.buyNum[i],e.buyNum[a]),p=this._databuyNum.length-1;c&&c>0&&c!=p&&(g=LanguageManager.getlocal("vipshopbuydes",[c+"",e.buyNum[c]-u+""])),d.text=g}}else u=0;if(e.buyCost.length==u){var m=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);return m.text=LanguageManager.getlocal("vipshopSoldoutdes"),m.x=o.x+15,m.y=o.y+o.height+60,void this.addChild(m)}this._needGod=e.buyCost[u],this._buyBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"nothing",this.buyHandler,this),this._buyBtn.setText(this._needGod.toString(),!1),this._buyBtn.addTextIcon("public_icon1"),this._buyBtn.x=o.x-20,this._buyBtn.y=n.y+n.height-this._buyBtn.height-10,this.addChild(this._buyBtn)},e.prototype.getNextVipNum=function(t,e,i){if(void 0===i&&(i=!1),t==e)for(var a=0;a<this._databuyNum.length;a++)if(this._databuyNum[a]>t)return this._databuyNum.indexOf(this._databuyNum[a])},e.prototype.buyHandler=function(t){return 0==this._acVo.isStart?void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd")):this._data.needVip>Api.playerVoApi.getPlayerVipLevel()?void ViewController.getInstance().openView(ViewConst.POPUP.ACVIPSHOPPOPUPVIEW):0==this._buyNum?void ViewController.getInstance().openView(ViewConst.POPUP.ACVIPSHOPPOPUPVIEW):this._needGod>Api.playerVoApi.getPlayerGem()?void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough")):void NetManager.request(NetRequestConst.ACTIVITY_BUYVIPSHOP,{activeId:AcVipShopView.AID+"-"+AcVipShopView.CODE,shopId:this._data.id})},e.prototype.getSpaceX=function(){return 10},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._uiData=null,this._collectFlag=null,this._progress=null,this._collectBtn=null,this._chargeBtn=null,this._curIdx=0,this._rechargeItem=null,this._lastReqIdx=null,this._acVo=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AcVipShopViewScrollItem.prototype,"AcVipShopViewScrollItem");var AcWifeComeView=function(t){function e(){var e=t.call(this)||this;return e._dataVo=null,e._dataCfg=null,e._isCollected=!1,e._nodeContainer=null,e._topBgImg=null,e._bottomBgImg=null,e._actTimeTitleText=null,e._actTimeText=null,e._actDescText=null,e._actDetailText=null,e._contentImg=null,e._misaJoinImg=null,e._progress=null,e._progressText=null,e._collectFlag=null,e._collectBtn=null,e._chargeBtn=null,e}return __extends(e,t),e.prototype.initView=function(){null==this._dataVo&&(this._dataVo=Api.acVoApi.getActivityVoByAidAndCode("wifeCome")),null==this._dataCfg&&(this._dataCfg=Config.AcCfg.getCfgByActivityIdAndCode("wifeCome",this._dataVo.code)),this._isCollected=1==this._dataVo.get?!0:!1,this._nodeContainer=new BaseDisplayObjectContainer,this._nodeContainer.height=GameConfig.stageHeigth-104,this.addChildToContainer(this._nodeContainer),this._topBgImg=BaseBitmap.create("forpeople_top"),this._topBgImg.y=-82,this._nodeContainer.addChild(this._topBgImg),this._actTimeTitleText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW),this._actTimeTitleText.text=LanguageManager.getlocal("acWifeComeTimeTitle"),this._actTimeTitleText.x=10,this._actTimeTitleText.y=this._topBgImg.y+75,this._nodeContainer.addChild(this._actTimeTitleText),this._actTimeText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_QUALITY_WHITE),this._actTimeText.text=this._dataVo.acTimeAndHour,this._actTimeText.x=110,this._actTimeText.y=this._topBgImg.y+75,this._nodeContainer.addChild(this._actTimeText),this._actDescText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW),this._actDescText.text=LanguageManager.getlocal("acWifeComeDesc"),this._actDescText.x=10,this._actDescText.y=this._topBgImg.y+105,this._nodeContainer.addChild(this._actDescText),this._actDetailText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_QUALITY_WHITE),this._actDetailText.text=LanguageManager.getlocal("acWifeComeDetail",[this._dataCfg.exchange,this._dataCfg.need]),this._actDetailText.x=10,this._actDetailText.y=this._topBgImg.y+135,this._nodeContainer.addChild(this._actDetailText),this._contentImg=BaseBitmap.create("acwifecomeview_content"),this._contentImg.y=-82+this._topBgImg.height,this._nodeContainer.addChild(this._contentImg);var t=BaseBitmap.create("wifeview_namebg");t.x=20,t.y=285,this.addChildToContainer(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("acWifeComeName"),TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_WHITE);e.width=27,e.x=t.x+t.width/2-e.width/2,e.y=t.y+95-e.height/2,this.addChildToContainer(e),this._bottomBgImg=BaseBitmap.create("wifeskin_barbg"),this._bottomBgImg.y=this._nodeContainer.height-this._bottomBgImg.height+13,this._nodeContainer.addChild(this._bottomBgImg),this._progress=ComponentManager.getProgressBar("progress3","progress3_bg",this._nodeContainer.width-60),this._progress.y=this._bottomBgImg.y-50,this._progress.x=40,this._nodeContainer.addChild(this._progress),this._progressText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_WHITE),this._progressText.text="0/0",this._progressText.textAlign=egret.HorizontalAlign.CENTER,this._progressText.verticalAlign=egret.VerticalAlign.MIDDLE,this._progressText.x=this._nodeContainer.width/2-this._progressText.width/2,this._progressText.y=this._progress.y+4,this._nodeContainer.addChild(this._progressText);var i=BaseBitmap.create("acwifecomeview_flower");i.x=17,i.y=this._bottomBgImg.y-65,this._nodeContainer.addChild(i),App.MessageHelper.addEventListener(MessageConst.MESSAGE_ACWIFECOME_VOCHANGE,this.refreshDataStatus,this),this.refreshDataStatus()},e.prototype.refreshDataStatus=function(){this._progressText.text=(this._dataVo.v>this._dataCfg.need?this._dataCfg.need:this._dataVo.v)+"/"+this._dataCfg.need,this._progressText.x=this._nodeContainer.width/2-this._progressText.width/2,this._progress.setPercentage(this._dataVo.v/this._dataCfg.need);var t=this._dataVo.v-this._dataCfg.need,e=0;0>t?e=1:0==this._dataVo.get?e=2:1==this._dataVo.get&&(e=3),this.refreshBtnStatus(e)},e.prototype.refreshBtnStatus=function(t){switch(null==this._chargeBtn&&(this._chargeBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"acCarnivalToChargeBtnText",this.goRechargeHandler,this),this._chargeBtn.x=this._nodeContainer.width/2-this._chargeBtn.width/2,this._chargeBtn.y=this._bottomBgImg.y+25,this._nodeContainer.addChild(this._chargeBtn)),null==this._collectBtn&&(this._collectBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"ac_recharge_Btntxt2",this.collectBtnHandler,this),this._collectBtn.x=this._nodeContainer.width/2-this._collectBtn.width/2,this._collectBtn.y=this._bottomBgImg.y+25,this._nodeContainer.addChild(this._collectBtn)),null==this._collectFlag&&this.createCollectFlag(),t){case 1:this._chargeBtn.visible=!0,this._collectBtn.visible=!1,this._collectFlag.visible=!1;break;case 2:this._chargeBtn.visible=!1,this._collectBtn.visible=!0,this._collectFlag.visible=!1;break;case 3:this._chargeBtn.visible=!1,this._collectBtn.visible=!1,this.checkShowCollectAnim()}},e.prototype.createCollectFlag=function(){this._collectFlag=BaseBitmap.create("collectflag"),this._collectFlag.setScale(.7),this._collectFlag.anchorOffsetX=this._collectFlag.width/2,this._collectFlag.anchorOffsetY=this._collectFlag.height/2,this._collectFlag.x=this._nodeContainer.width/2,this._collectFlag.y=this._bottomBgImg.y+50,this._nodeContainer.addChild(this._collectFlag)},e.prototype.checkShowCollectAnim=function(){this._isCollected?this._collectFlag.visible=!0:(this._isCollected=!0,this._collectFlag.setScale(1.3),this._collectFlag.visible=!0,egret.Tween.get(this._collectFlag,{loop:!1}).to({scaleX:.7,scaleY:.7},300))},e.prototype.collectBtnHandler=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETWIFECOMEREWARD),this.collectBtnHandlerCallback,this),NetManager.request(NetRequestConst.REQUEST_ACTIVITY_GETWIFECOMEREWARD,{activeId:"wifeCome-"+this._dataVo.code})},e.prototype.collectBtnHandlerCallback=function(t){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETWIFECOMEREWARD),this.collectBtnHandlerCallback,this);var e=t.data.data.ret;return 0!=e?void App.CommonUtil.showTip(LanguageManager.getlocal("collect_error")):void 0},e.prototype.goRechargeHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["forpeople_top","acwifecomeview_content","wifeskin_barbg","progress3","progress3_bg","acwifecomeview_flower","wifeview_namebg"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_ACWIFECOME_VOCHANGE,this.refreshDataStatus,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_GETWIFECOMEREWARD),this.collectBtnHandlerCallback,this),this._dataVo=null,this._dataCfg=null,this._isCollected=!1,this._nodeContainer=null,this._topBgImg=null,this._bottomBgImg=null,this._actTimeTitleText=null,this._actTimeText=null,this._actDescText=null,this._actDetailText=null,this._contentImg=null,this._misaJoinImg=null,this._progress=null,this._progressText=null,this._collectFlag=null,this._collectBtn=null,this._chargeBtn=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(AcWifeComeView.prototype,"AcWifeComeView");var AcWishTreeExchangeItem=function(t){function e(){var e=t.call(this)||this;return e._cfgData=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){this._cfgData=e;var i=this._cfgData.wifeId,a=BaseBitmap.create("wishtree_listbg");this.addChild(a);var n=ComponentManager.getTextField("",22);n.width=25,n.multiline=!0,n.lineSpacing=4,n.text=LanguageManager.getlocal("wifeName_"+i),n.x=32,n.y=90-n.height/2,this.addChild(n);var o=BaseLoadBitmap.create("wife_half_"+i);o.width=205,o.height=196,o.anchorOffsetY=o.height,o.setScale(.9),o.x=100,o.y=a.y+a.height-7,this.addChild(o);var s=ComponentManager.getTextField("",22,TextFieldConst.COLOR_BROWN);s.text=LanguageManager.getlocal("acWishTreeCost",[""+this._cfgData.needNum]),s.x=510-s.width/2,s.y=80,this.addChild(s);var r=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"exchange",this.exchangeBtnHandler,this);r.x=435,r.y=110,this.addChild(r),this.checkMask()},e.prototype.checkMask=function(){if(Api.wifeVoApi.getWifeInfoVoById(this._cfgData.wifeId)){var t=BaseBitmap.create("wishtree_mask");t.touchEnabled=!0,this.addChild(t);var e=BaseBitmap.create("wishtree_get");e.x=t.width/2-e.width/2,e.y=t.height/2-e.height/2,this.addChild(e)}},e.prototype.exchangeBtnHandler=function(){if(!Api.wifeVoApi.getWifeInfoVoById(this._cfgData.wifeId)){var t=Api.itemVoApi.getItemNumInfoVoById("2102");if(t<this._cfgData.needNum)return void App.CommonUtil.showTip(LanguageManager.getlocal("acWishTreeExchangeTip1"));if(!Api.wifeVoApi.getWifeInfoVoById(this._cfgData.wifeId)){var e=Api.acVoApi.getActivityVoByAidAndCode("wishTree");return e.isStart?void NetManager.request(NetRequestConst.REQUEST_ACTIVITY_EXCHANGEWIFE,{activeId:e.aidAndCode,shopId:this._cfgData.id}):void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd"))}}},e.prototype.dispose=function(){this._cfgData=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AcWishTreeExchangeItem.prototype,"AcWishTreeExchangeItem");var AcWishTreeExchangeView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_EXCHANGEWIFE),this.exchangeHandler,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer),this._curownTxt=ComponentManager.getTextField("",22,TextFieldConst.COLOR_LIGHT_YELLOW),this._curownTxt.x=8,this._curownTxt.y=5,this._nodeContainer.addChild(this._curownTxt);var t=BaseBitmap.create("public_9_bg23");t.width=GameConfig.stageWidth,t.height=GameConfig.stageHeigth-this.container.y-this._curownTxt.y-30,t.y=this._curownTxt.y+35,this._nodeContainer.addChild(t);var e=new egret.Rectangle(0,0,GameConfig.stageWidth,t.height-8),i=ComponentManager.getScrollList(AcWishTreeExchangeItem,[],e);i.y=t.y+4,i.x=10,this._scrollList=i,i.bounces=!1,this._nodeContainer.addChild(i),this.refreshUI()},e.prototype.refreshUI=function(){var t=this.param.data.aid,e=this.param.data.code;Api.acVoApi.getActivityVoByAidAndCode(t,e);this._curownTxt.text=LanguageManager.getlocal("acWishTreeown",[""+Api.itemVoApi.getItemNumInfoVoById("2102")]);var i=Config.AcCfg.getCfgByActivityIdAndCode(this.param.data.aid,this.param.data.code),a=i.getWishWifeIdList();this._scrollList.refreshData(a)},e.prototype.exchangeHandler=function(t){var e=t.data.data;0==e.ret&&this.refreshUI()},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_EXCHANGEWIFE),this.exchangeHandler,this),this._nodeContainer=null,this._curownTxt=null,this._scrollList=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(AcWishTreeExchangeView.prototype,"AcWishTreeExchangeView");var AcWishTreeView=function(t){function e(){var e=t.call(this)||this;return e._cdNum=-2,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addNetMessage(NetPushConst.PUSH_PAY,this.receivePushData,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_EXCHANGEWIFE),this.exchangeHandler,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_WISHTRER_NEXTDAY,this.refreshUI,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var t=BaseBitmap.create("forpeople_top");t.y=-15,this._nodeContainer.addChild(t);var e=ComponentManager.getTextField("",22,TextFieldConst.COLOR_LIGHT_YELLOW);e.text=this.acVo.getAcLocalTime(!0,"0xffffff"),e.x=8,e.y=5,this._nodeContainer.addChild(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("acWishTreeTip1"),22,TextFieldConst.COLOR_LIGHT_YELLOW);i.x=e.x,i.y=e.y+35,this._nodeContainer.addChild(i);var a=BaseBitmap.create("wishtree_bg");a.y=80,this._nodeContainer.addChild(a);var n=BaseBitmap.create("wishtree_word");n.y=a.y+80,n.x=GameConfig.stageWidth-100,this._nodeContainer.addChild(n);var o=ComponentManager.getButton("wishtree_btn1","",this.exchangeBtnHandler,this);o.x=5,o.y=a.y+5,this._exchangeBtn=o,this._nodeContainer.addChild(o);var s=BaseBitmap.create("wifeskin_barbg");s.y=GameConfig.stageHeigth-this.container.y-s.height,this._nodeContainer.addChild(s);var r=BaseBitmap.create("wifeview_skingetbg");r.width=260,r.height=40,r.x=GameConfig.stageWidth-r.width,r.y=s.y-r.height,r.name="timesBg",this._nodeContainer.addChild(r),this._lastTimeTxt=ComponentManager.getTextField("",24,TextFieldConst.COLOR_LIGHT_YELLOW),this._lastTimeTxt.text=LanguageManager.getlocal("acWishTreeTimesTxt",["",""]),this._lastTimeTxt.x=r.x+r.width/2-this._lastTimeTxt.width/2-5,this._lastTimeTxt.y=r.y+r.height/2-this._lastTimeTxt.height/2,this._nodeContainer.addChild(this._lastTimeTxt);var l=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"acTailorBtnOne",this.buyHandler,this);l.setText(""),l.x=GameConfig.stageWidth/2-l.width/2,l.y=s.y+15,this._buyBtn=l,this._nodeContainer.addChild(l);var h=ComponentManager.getTextField(LanguageManager.getlocal("acWishTreeTip2"),20,TextFieldConst.COLOR_LIGHT_YELLOW);h.name="bottomTipTxt",this._bottomTipTxt=h,h.x=GameConfig.stageWidth/2-h.width/2,h.y=s.y+s.height-30,this._nodeContainer.addChild(h),this.refreshUI(),this.showEffect()},e.prototype.refreshUI=function(){var t=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code),e=t.getLastWishTimes(),i=Api.itemVoApi.getItemNumInfoVoById("2102"),a=e-i;0>=a&&(a=0),this._lastTimeTxt.text=LanguageManager.getlocal("acWishTreeTimesTxt",[String(a),""+e]),0==e&&(this._nodeContainer.getChildByName("timesBg").visible=!1,this._lastTimeTxt.visible=!1,this._buyBtn.visible=!1,this._bottomTipTxt.text=LanguageManager.getlocal("acWishTreeTip3"),this._bottomTipTxt.x=GameConfig.stageWidth/2-this._bottomTipTxt.width/2,this._bottomTipTxt.y=this._buyBtn.y+30);var n=Api.acVoApi.getActivityVoByAidAndCode(this.aid,this.code);n.isShowRedDot?App.CommonUtil.addRedDotToBDOC(this._exchangeBtn):App.CommonUtil.removeRedDotFromBDOC(this._exchangeBtn),-2==this._cdNum&&(0==n.getDiscount()?this._buyBtn.setText("acWishTreeBtnTxt1"):this._buyBtn.setText("acWishTreeBtnTxt2"))},e.prototype.buyHandler=function(){if(!(this._cdNum>0)){var t=Config.AcCfg.getCfgByActivityIdAndCode(this.aid,this.code),e=Api.acVoApi.getActivityVoByAidAndCode(this.aid,this.code);if(!e.isStart)return void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd"));var i=t.getLastWishTimes(),a=Api.itemVoApi.getItemNumInfoVoById("2102");if(a>=i)return void App.CommonUtil.showTip(LanguageManager.getlocal("acWishTreebuytip2"));this._cdNum=15,0==e.getDiscount()?PlatformManager.pay(t.cost1):PlatformManager.pay(t.cost2)}},e.prototype.exchangeBtnHandler=function(){var t=Api.acVoApi.getActivityVoByAidAndCode(this.aid,this.code);return t.isStart?void ViewController.getInstance().openView(ViewConst.COMMON.ACWISHTREEEXCHANGEVIEW,{aid:this.aid,code:this.code}):void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd"))},e.prototype.exchangeHandler=function(t){var e=t.data.data;0==e.ret&&this.refreshUI()},e.prototype.showEffect=function(){var t=(App.MathUtil.getRandom(1e4,2e4),App.MathUtil.getRandom(0,1500),App.ParticleUtil.getParticle("taohua"));t.x=0,t.y=this.height-700,t.rotation=-66,t.start(),this._nodeContainer.addChild(t),egret.Tween.get(t).call(function(){t.start()},this)},e.prototype.receivePushData=function(t){var e=t.data;if(0==e.data.ret&&e.data.cmd==NetPushConst.PUSH_PAY){this.refreshUI();var i="6_2102_1",a=GameData.formatRewardItem(i);if(App.CommonUtil.playRewardFlyAction(a),e.data.data.payment){var n=e.data.data.payment.itemId;PlatformManager.analyticsPay(n,e.data.data.payment.orderId)}}},e.prototype.tick=function(){if(this._cdNum>=0){var t=App.DateUtil.getFormatBySecond(this._cdNum,3);return this._buyBtn.setText(t,!1),this._cdNum--,!0}if(-1==this._cdNum){this._cdNum=-2;var e=Api.acVoApi.getActivityVoByAidAndCode(this.aid,this.code);0==e.getDiscount()?this._buyBtn.setText("acWishTreeBtnTxt1"):this._buyBtn.setText("acWishTreeBtnTxt2")}return!1},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["wishtree_bg","wishtree_btn_down","wishtree_btn1","wishtree_headmask","wishtree_listbg","wishtree_word","wifeskin_barbg","forpeople_top","wishtree_get","wishtree_mask","taohua","taohua_json","wifeview_skingetbg"])},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(NetPushConst.PUSH_PAY,this.receivePushData,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ACTIVITY_EXCHANGEWIFE),this.exchangeHandler,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_WISHTRER_NEXTDAY,this.refreshUI,this),this._nodeContainer=null,this._lastTimeTxt=null,this._cdNum=-2,t.prototype.dispose.call(this)},e}(AcCommonView);__reflect(AcWishTreeView.prototype,"AcWishTreeView");var Adult2ScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=604,this.height=128+this.getSpaceY();var i=BaseBitmap.create("public_9_bg27");i.width=this.width,i.height=this.height-5,i.x=this.width/2-i.width/2,i.y=this.height/2-i.height/2,this.addChild(i);var a=BaseBitmap.create("public_9_bg26");a.width=this.width-40,a.height=this.height-45,a.x=20,a.y=10,a.name="bg2",this.addChild(a);var n="childview_boyicon",o="childview_girlicon";2==e.sex&&(n="childview_girlicon",o="childview_boyicon");var s=BaseBitmap.create(n);s.x=40,s.y=a.y+a.height/2-s.height/2,this.addChild(s);var r=e.name,l=TextFieldConst.COLOR_WHITE,h=ComponentManager.getTextField(r,TextFieldConst.FONTSIZE_CONTENT_SMALL);h.textColor=l,h.x=90,h.y=20,this.addChild(h);var d=LanguageManager.getlocal("adult_quality")+LanguageManager.getlocal("adult_quality"+e.aquality),g=ComponentManager.getTextField(d,TextFieldConst.FONTSIZE_CONTENT_SMALL);g.textColor=l,g.x=h.x,g.y=h.y+h.height+7,this.addChild(g);var c=LanguageManager.getlocal("servant_infoAttr")+e.attrVo.attTotal,p=ComponentManager.getTextField(c,TextFieldConst.FONTSIZE_CONTENT_SMALL);p.textColor=l,p.x=h.x,p.y=g.y+g.height+7,this.addChild(p);var _=BaseBitmap.create(o);_.x=330,_.y=a.y+a.height/2-s.height/2,this.addChild(_);var u=e.fname,C=ComponentManager.getTextField(u,TextFieldConst.FONTSIZE_CONTENT_SMALL);C.textColor=l,C.x=380,C.y=h.y,this.addChild(C);var f=ComponentManager.getTextField(d,TextFieldConst.FONTSIZE_CONTENT_SMALL);f.textColor=l,f.x=C.x,f.y=C.y+C.height+7,this.addChild(f);var m=LanguageManager.getlocal("servant_infoAttr")+e.ftotal,T=ComponentManager.getTextField(m,TextFieldConst.FONTSIZE_CONTENT_SMALL);T.textColor=l,T.x=C.x,T.y=f.y+f.height+7,this.addChild(T);var y=App.DateUtil.getFormatBySecond(e.mts,2),v=ComponentManager.getTextField(y,TextFieldConst.FONTSIZE_CONTENT_COMMON);v.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,v.x=100,v.y=a.y+a.height+6,this.addChild(v);var A=LanguageManager.getlocal("adultOtherName")+e.funame,w=ComponentManager.getTextField(A,TextFieldConst.FONTSIZE_CONTENT_COMMON);w.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,w.x=400,w.y=v.y,this.addChild(w)},e.prototype.refreshData=function(t){},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._adultInfo=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(Adult2ScrollItem.prototype,"Adult2ScrollItem");var AdultChooseChildScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=244+this.getSpaceX(),this.height=292,this._childInfo=e;var i=BaseBitmap.create("public_9_bg31");i.width=244,i.height=292,i.x=5,this.addChild(i);var a=BaseBitmap.create("adult_smallbg");this.addChild(a),a.x=i.x+15,a.y=40;var n="adult_boy";2==e.sex&&(n="adult_girl");var o=BaseBitmap.create("adult_namebg");o.x=a.x+10,o.y=a.y+10,this.addChild(o);var s=BaseBitmap.create("adult_q"+e.aquality);s.x=a.x+10,s.y=a.y+15,s.setScale(.7),this.addChild(s);var r=BaseBitmap.create(n);r.x=i.x+40,r.y=40,r.setScale(.45),this.addChild(r);var l=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);l.x=this.width/2-l.width/2,l.y=15,this.addChild(l);var h=BaseBitmap.create("adult_attbg");h.x=a.x+40,h.y=a.y+a.height-h.height,this.addChild(h);var d=LanguageManager.getlocal("servant_infoAttr")+e.attrVo.attTotal,g=ComponentManager.getTextField(d,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);g.x=h.x+h.width/2-g.width/2,g.y=h.y+h.height/2-g.height/2,this.addChild(g);var c=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"adultMarryViewTitle",this.chooseBtnClick,this);c.x=this.width/2-c.width/2,c.y=a.y+a.height+9,this.addChild(c),c.setColor(TextFieldConst.COLOR_BLACK)},e.prototype.chooseBtnClick=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_ADULT_CHILDMARRY,{childId:this._childInfo.id})},e.prototype.getSpaceY=function(){return 10},e.prototype.getSpaceX=function(){return 10},e.prototype.dispose=function(){this._intimacyTF=null,this._childInfo=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AdultChooseChildScrollItem.prototype,"AdultChooseChildScrollItem");var AdultChooseChildView=function(t){function e(){var e=t.call(this)||this;return e._sortType=1,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_ADULT_CHILDMARRY,this.doMarry,this),this._handler=this.param.data.handler,this._confirmCallback=this.param.data.confirmCallback,this._childInfo=this.param.data.childInfo;var t=BaseBitmap.create("mainui_topresbg");t.x=250,t.y=21,this.addChildToContainer(t);var e=BaseLoadBitmap.create("itemicon1");e.setScale(.5),e.x=230,e.y=t.y+t.height/2-50+23,this.addChildToContainer(e);var i=Api.playerVoApi.getPlayerGem(),a=ComponentManager.getTextField(i.toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);a.x=280,a.y=t.y+t.height/2-a.height/2,this.addChildToContainer(a);var n=BaseBitmap.create("public_9_bg4");n.width=520,n.height=GameConfig.stageHeigth-500,n.x=this.viewBg.x+this.viewBg.width/2-n.width/2,n.y=75,this.addChildToContainer(n);var o=Api.adultVoApi.getAdultVoListById(this._childInfo.aquality,this._childInfo.sex),s=egret.Rectangle.create();s.setTo(0,0,508,n.height-20),this._scrollList=ComponentManager.getScrollList(AdultChooseChildScrollItem,o,s),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(n.x+7,n.y+10),this._scrollList.setEmptyTip(LanguageManager.getlocal("adultEmptyTip3")),this._sortBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"adultChooseSort1",this.refreshHandler,this),this._sortBtn.x=n.x+n.width/2-this._sortBtn.width/2,this._sortBtn.y=n.y+n.height+12,this.addChildToContainer(this._sortBtn),this._sortBtn.setColor(TextFieldConst.COLOR_BLACK)},e.prototype.receiveData=function(t){if(t.data.cmd==NetRequestConst.REQUEST_RADULT_AGREEPROPOSE){if(2==t.data.data.proflag)return App.CommonUtil.showTip(LanguageManager.getlocal("adultMarryRequestTip4")),this.param.data.confirmCallback&&this.param.data.confirmCallback.apply(this.param.data.handler,[]),void this.hide();var e=t.data.data.adultId;ViewController.getInstance().openView(ViewConst.BASE.ADULTMARRYSUCCESSVIEW,{childId:e,confirmCallback:null,handler:this}),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_ADULT_REFRESHCHILDMARRY,null),this.hide()}else t.data.cmd==NetRequestConst.REQUEST_RADULT_REFUSEPROPOSE},e.prototype.refreshHandler=function(){var t;1==this._sortType?(this._sortType=2,t=Api.adultVoApi.getAdultVoListByIdByAttr(this._childInfo.aquality,this._childInfo.sex),this._sortBtn.setText("adultChooseSort2")):(this._sortType=1,t=Api.adultVoApi.getAdultVoListById(this._childInfo.aquality,this._childInfo.sex),this._sortBtn.setText("adultChooseSort1")),this._scrollList.refreshData(t)},e.prototype.doMarry=function(t){this._selectChildId=t.data.childId,ViewController.getInstance().openView(ViewConst.POPUP.ADULTCHOOSETYPEVIEW,{childId:t.data.childId,confirmCallback:this.selectMarryHander,handler:this})},e.prototype.selectMarryHander=function(t){this.request(NetRequestConst.REQUEST_RADULT_AGREEPROPOSE,{aid:this._childInfo.id,childId:this._selectChildId,protype:t})},e.prototype.marryOneHandler=function(){},e.prototype.chooseAllCallBack=function(t){},e.prototype.chooseOneCallBack=function(t){App.LogUtil.log(t)},e.prototype.dispose=function(){this._scrollList=null,this._confirmCallback=null,this._handler=null,this._timeTF=null,this._selectChildData=null,this._selectChildId=null,this._childInfo=null,this._sortBtn=null,this._sortType=1,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_ADULT_CHILDMARRY,this.doMarry,this),t.prototype.dispose.call(this)},e}(PopupView);__reflect(AdultChooseChildView.prototype,"AdultChooseChildView");var AdultChooseTypeView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=this.param.data.childId,e=Api.adultVoApi.getAdultInfoVoById(t),i=Config.AdultCfg.getItemCfgById(e.aquality).needItem,a=Api.itemVoApi.getItemInfoVoById(Number(i)),n=(Config.ItemCfg.getItemCfgById,Config.ItemCfg.getItemCfgById(Number(i))),o=0;a&&(o=a.num);var s=BaseBitmap.create("public_9_bg4");s.width=520,s.height=270,s.x=this.viewBg.x+this.viewBg.width/2-s.width/2,s.y=45,this.addChildToContainer(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("adultChooseTypeDesc"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);r.x=30,r.y=15,this.addChildToContainer(r);var l=BaseBitmap.create("public_9_bg1");l.width=500,l.height=120,l.x=this.viewBg.x+this.viewBg.width/2-l.width/2,l.y=58,this.addChildToContainer(l);var h=BaseBitmap.create("public_9_bg1");h.width=500,h.height=120,h.x=this.viewBg.x+this.viewBg.width/2-h.width/2,h.y=l.y+l.height+5,this.addChildToContainer(h);var d=BaseBitmap.create("itembg_1");d.x=l.x+8,d.y=l.y+8,this.addChildToContainer(d);var g=BaseLoadBitmap.create("itemicon1");g.x=d.x+5,g.y=d.y+5,this.addChildToContainer(g);var c=BaseBitmap.create(n.iconBg);c.x=h.x+8,c.y=h.y+8,this.addChildToContainer(c);var p=BaseLoadBitmap.create(n.icon);p.x=c.x+5,p.y=c.y+5,this.addChildToContainer(p);var _=LanguageManager.getlocal("adultChooseCost")+Config.AdultCfg.getItemCfgById(e.aquality).needGem+LanguageManager.getlocal("gemName"),u=ComponentManager.getTextField(_,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN);u.x=d.x+d.width+15,u.y=d.y+20,this.addChildToContainer(u);var C=LanguageManager.getlocal("adultChooseCost")+n.name,f=ComponentManager.getTextField(C,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN);f.x=u.x,f.y=c.y+20,this.addChildToContainer(f);var m=LanguageManager.getlocal("adultChooseNum")+Api.playerVoApi.getPlayerGem(),T=ComponentManager.getTextField(m,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);T.x=d.x+d.width+15,T.y=d.y+70,this.addChildToContainer(T);var y=LanguageManager.getlocal("adultChooseNum")+o,v=ComponentManager.getTextField(y,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);v.x=u.x,v.y=c.y+70,this.addChildToContainer(v);var A=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"adultChoose",this.choose1Handler,this);A.x=370,A.y=l.y+l.height/2-A.height/2,A.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(A);var w=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"adultChoose",this.choose2Handler,this);w.x=370,w.y=h.y+h.height/2-w.height/2,w.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(w)},e.prototype.choose1Handler=function(t){var e=this.param.data.childId,i=Api.adultVoApi.getAdultInfoVoById(e),a=Config.AdultCfg.getItemCfgById(i.aquality).needGem;return a>Api.playerVoApi.getPlayerGem()?void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough")):(this.param.data.confirmCallback.apply(this.param.data.handler,[1]),void this.hide())},e.prototype.choose2Handler=function(t){var e=this.param.data.childId,i=Api.adultVoApi.getAdultInfoVoById(e),a=Config.AdultCfg.getItemCfgById(i.aquality).needItem,n=Api.itemVoApi.getItemInfoVoById(Number(a)),o=(Config.ItemCfg.getItemCfgById,Config.ItemCfg.getItemCfgById(Number(a)),0);return n&&(o=n.num),0>=o?void App.CommonUtil.showTip(LanguageManager.getlocal("itemNumNotEnough")):(this.param.data.confirmCallback.apply(this.param.data.handler,[2]),void this.hide())},e.prototype.getTitleStr=function(){return"adultChooseTypeViewTitle"},e.prototype.dispose=function(){this._type=null,this._useCallback=null,this._handler=null,this._cancelBtn=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AdultChooseTypeView.prototype,"AdultChooseTypeView");var AdultMarryRequestScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=500,this.height=208,this._childInfo=e;var i=BaseBitmap.create("public_9_bg31");i.width=this.width,i.height=this.height,i.x=5,this.addChild(i);
var a=BaseBitmap.create("adult_smallbg");this.addChild(a),a.x=i.x+10,a.y=i.y+i.height/2-a.height/2;var n="adult_boy";2==e.sex&&(n="adult_girl");var o=BaseBitmap.create("adult_namebg");o.x=a.x+10,o.y=a.y+10,this.addChild(o);var s=BaseBitmap.create("adult_q"+e.aquality);s.x=a.x+10,s.y=a.y+15,s.setScale(.7),this.addChild(s);var r=BaseBitmap.create(n);r.x=i.x+40,r.y=20,r.setScale(.45),this.addChild(r);var l=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);l.x=a.x+a.width+10,l.y=a.y+7,this.addChild(l);var h=LanguageManager.getlocal("adultMarryFather")+e.fatherName,d=ComponentManager.getTextField(h,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);d.x=l.x,d.y=l.y+l.height+10,this.addChild(d);var g=LanguageManager.getlocal("servant_infoAttr")+e.total,c=ComponentManager.getTextField(g,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);c.x=l.x,c.y=d.y+l.height+10,this.addChild(c);var p=LanguageManager.getlocal("adultMarryRequestCost"),_=ComponentManager.getTextField(p,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);_.x=l.x,_.y=c.y+l.height+10,this.addChild(_);var u=BaseLoadBitmap.create("itemicon1");u.setScale(.45),u.x=_.x+_.width-7,u.y=100,this.addChild(u);var C=Config.AdultCfg.getItemCfgById(e.aquality).needItem,f=(Api.itemVoApi.getItemInfoVoById(Number(C)),Config.ItemCfg.getItemCfgById(Number(C))),m=Config.AdultCfg.getItemCfgById(e.aquality).needGem,T=m+"/"+f.name,y=ComponentManager.getTextField(T,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN2);y.x=l.x+105,y.y=c.y+l.height+10,this.addChild(y);var v=ComponentManager.getButton(ButtonConst.BTN_SMALL_RED,"adultMarryRequestRefuse",this.refuseBtnClick,this);v.x=l.x,v.y=_.y+_.height+7,this.addChild(v),v.setColor(TextFieldConst.COLOR_BLACK);var A=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"adultMarryRequestChooseChild",this.chooseBtnClick,this);A.x=v.x+v.width+5,A.y=_.y+_.height+7,this.addChild(A),A.setColor(TextFieldConst.COLOR_BLACK)},e.prototype.refuseBtnClick=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_ADULT_REFUSEMARRY,{id:this._childInfo.id,childId:this._childInfo.id})},e.prototype.chooseBtnClick=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_ADULT_CHOOSECHILD,{childInfo:this._childInfo})},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._intimacyTF=null,this._childInfo=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AdultMarryRequestScrollItem.prototype,"AdultMarryRequestScrollItem");var AdultMarryRequestView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_ADULT_REFUSEMARRY,this.doRefuse,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_ADULT_CHOOSECHILD,this.doChoose,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_ADULT_REFRESHCHILDMARRY,this.doRefresh,this),this._handler=this.param.data.handler,this._confirmCallback=this.param.data.confirmCallback,this.request(NetRequestConst.REQUEST_RADULT_GETPROPOSEE,null);var t=BaseBitmap.create("public_9_resbg");t.x=230,t.y=21,this.addChildToContainer(t);var e=BaseLoadBitmap.create("itemicon1");e.setScale(.5),e.x=230,e.y=t.y+t.height/2-50+23,this.addChildToContainer(e);var i=Api.playerVoApi.getPlayerGem(),a=ComponentManager.getTextField(i.toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);a.x=280,a.y=t.y+t.height/2-a.height/2,this.addChildToContainer(a);var n=BaseBitmap.create("public_9_bg4");n.width=520,n.height=GameConfig.stageHeigth-500,n.x=this.viewBg.x+this.viewBg.width/2-n.width/2,n.y=75,this.addChildToContainer(n);var o=egret.Rectangle.create();o.setTo(0,0,508,n.height-20),this._scrollList=ComponentManager.getScrollList(AdultMarryRequestScrollItem,null,o),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(n.x+5,n.y+10),this._scrollList.setEmptyTip(LanguageManager.getlocal("adultEmptyTip2"));var s=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"adultMarryRequestRefuseAll",this.refuseAllHandler,this);s.x=n.x+n.width/2-s.width/2,s.y=n.y+n.height+12,this.addChildToContainer(s),s.setColor(TextFieldConst.COLOR_BLACK)},e.prototype.receiveData=function(t){t.ret&&(t.data.cmd==NetRequestConst.REQUEST_RADULT_GETPROPOSEE?this._scrollList.refreshData(t.data.data.minfo):t.data.cmd==NetRequestConst.REQUEST_RADULT_REFUSEPROPOSE&&this._scrollList.refreshData(t.data.data.minfo),t.data&&t.data.data&&t.data.data.minfo?this.param.data.confirmCallback2.apply(this.param.data.handler,[1]):this.param.data.confirmCallback2.apply(this.param.data.handler,[2]))},e.prototype.refreshHandler=function(){},e.prototype.doRefuse=function(t){this._selectChildData=t.data,this.request(NetRequestConst.REQUEST_RADULT_REFUSEPROPOSE,{aid:t.data.id,isBatch:0})},e.prototype.doChoose=function(t){this._selectChildData=t.data,ViewController.getInstance().openView(ViewConst.POPUP.ADULTCHOOSECHILDVIEW,{childInfo:t.data.childInfo,confirmCallback:this.selectMarryHander,handler:this})},e.prototype.doRefresh=function(t){this.request(NetRequestConst.REQUEST_RADULT_GETPROPOSEE,null)},e.prototype.selectMarryHander=function(t){this.doRefresh(null)},e.prototype.refuseAllHandler=function(){return this._scrollList.getItemByIndex(0)?void this.request(NetRequestConst.REQUEST_RADULT_REFUSEPROPOSE,{isBatch:1}):void App.CommonUtil.showTip(LanguageManager.getlocal("adultEmptyTip2"))},e.prototype.marryOneHandler=function(){},e.prototype.chooseAllCallBack=function(t){},e.prototype.chooseOneCallBack=function(t){},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_ADULT_REFUSEMARRY,this.doRefuse,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_ADULT_CHOOSECHILD,this.doChoose,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_ADULT_REFRESHCHILDMARRY,this.doRefresh,this),this._scrollList=null,this._confirmCallback=null,this._handler=null,this._timeTF=null,this._selectChildData=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AdultMarryRequestView.prototype,"AdultMarryRequestView");var AdultMarryScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=618,this.height=208,this._childInfo=e;var i=BaseBitmap.create("public_9_bg31");i.width=this.width,i.height=this.height,i.x=5,this.addChild(i);var a=BaseBitmap.create("adult_smallbg");this.addChild(a),a.x=i.x+10,a.y=i.y+i.height/2-a.height/2;var n=BaseBitmap.create("public_9_managebg");n.width=370,n.height=100,n.x=a.x+a.width+10,n.y=a.y+10,this.addChild(n);var o="adult_boy";2==e.sex&&(o="adult_girl");var s=BaseBitmap.create("adult_namebg");s.x=a.x+10,s.y=a.y+10,this.addChild(s);var r=BaseBitmap.create("adult_q"+e.aquality);r.x=a.x+10,r.y=a.y+15,r.setScale(.7),this.addChild(r);var l=BaseBitmap.create(o);l.x=i.x+40,l.y=20,l.setScale(.45),this.addChild(l);var h=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);h.x=n.x+5,h.y=n.y+7,this.addChild(h);var d=LanguageManager.getlocal("adultMarryFather")+e.fatherName,g=ComponentManager.getTextField(d,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);g.x=h.x,g.y=h.y+h.height+10,this.addChild(g);var c=LanguageManager.getlocal("servant_infoAttr")+e.total,p=ComponentManager.getTextField(c,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);p.x=h.x,p.y=g.y+h.height+10,this.addChild(p);var _=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"adultMarry",this.marryBtnClick,this);_.x=450,_.y=n.y+n.height+12,this.addChild(_),_.setColor(TextFieldConst.COLOR_BLACK)},e.prototype.marryBtnClick=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_ADULT_CLICKMARRY,{id:this._childInfo.id,childId:this._childInfo.id})},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._childInfo=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AdultMarryScrollItem.prototype,"AdultMarryScrollItem");var AdultMarrySuccessView=function(t){function e(){var e=t.call(this)||this;return e._childId=null,e}return __extends(e,t),e.prototype.getResourceList=function(){var e=t.prototype.getResourceList.call(this);return this.param.data&&(this._childId=this.param.data),e.concat(["childview_getgirl","childview_boyicon","childview_girlicon","wifeget_bg"])},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getBgName=function(){return"public_9_bg8"},e.prototype.initView=function(){this._confirmCallback=this.param.data.confirmCallback,this.addTouchTap(this.touchTap,this,null),SoundManager.playEffect(SoundConst.EFFECT_UPD),this._childId=this.param.data.childId;var t=this._childId,e=Api.adultVoApi.getAdultMarryInfoVoById(t),i=App.CommonUtil.getContainerByLeftTopRes("wifeget_bg");i.setScale(GameConfig.stageWidth/i.width),this.addChildToContainer(i),i.y=260;var a="adult_boy",n="adult_girl";2==e.sex&&(a="adult_girl",n="adult_boy");var o=BaseBitmap.create("adult_lovebg");o.setPosition(this.viewBg.width/2-o.width/2,100),this.addChild(o);var s=BaseBitmap.create(a);s.setPosition(40,o.y+o.height+10),this.addChild(s);var r=BaseBitmap.create(n);r.setPosition(260,o.y+o.height+10),this.addChild(r);var l=BaseBitmap.create("public_9_wordbg");l.height=200,l.setPosition(GameConfig.stageWidth/2-l.width/2,s.y+s.height),this.addChild(l);var h=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_TITLE_SMALL);h.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,h.setPosition(100,l.y+40),this.addChild(h);var d=LanguageManager.getlocal("adultMarryFather")+Api.playerVoApi.getPlayerName(),g=ComponentManager.getTextField(d,TextFieldConst.FONTSIZE_TITLE_SMALL);g.setPosition(h.x,h.y+h.height+20),this.addChild(g);var c=LanguageManager.getlocal("servant_infoAttr")+e.total,p=ComponentManager.getTextField(c,TextFieldConst.FONTSIZE_TITLE_SMALL);p.setPosition(h.x,g.y+g.height+20),this.addChild(p);var _=ComponentManager.getTextField(e.fname,TextFieldConst.FONTSIZE_TITLE_SMALL);_.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,_.setPosition(400,l.y+40),this.addChild(_);var u=LanguageManager.getlocal("adultMarryFather")+e.funame,C=ComponentManager.getTextField(u,TextFieldConst.FONTSIZE_TITLE_SMALL);C.setPosition(_.x,_.y+_.height+20),this.addChild(C);var f=LanguageManager.getlocal("servant_infoAttr")+e.ftotal,m=ComponentManager.getTextField(f,TextFieldConst.FONTSIZE_TITLE_SMALL);m.setPosition(_.x,C.y+C.height+20),this.addChild(m);var T=e.ftotal,y=(egret.Point.create(320,GameConfig.stageHeigth/2),new PowerFly);y.init(T),LayerManager.msgLayer.addChild(y),2==e.sex&&(s.anchorOffsetX=s.width/2,r.anchorOffsetX=r.width/2,s.x=s.x+s.width/2,r.x=r.x+r.width/2,s.skewY=180,r.skewY=180)},e.prototype.sureBtnClick=function(){ViewController.getInstance().hideAllView(),this._childId=this.param.data,ViewController.getInstance().openView(ViewConst.COMMON.CHILDVIEW,{childId:this._childId})},e.prototype.noBtnClick=function(){this.hide()},e.prototype.touchTap=function(){this.hide()},e.prototype.hide=function(){t.prototype.hide.call(this),this.param.data.confirmCallback&&this.param.data.confirmCallback.apply(this.param.data.handler,[])},e.prototype.dispose=function(){this._childId=null,t.prototype.dispose.call(this)},e}(BaseView);__reflect(AdultMarrySuccessView.prototype,"AdultMarrySuccessView");var AdultMarryView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_ADULT_CLICKMARRY,this.doChooseType,this),this._adultInfoVo=Api.adultVoApi.getAdultInfoVoById(this.param.data.childId),this._handler=this.param.data.handler,this._confirmCallback=this.param.data.confirmCallback,this._confirmCallback2=this.param.data.confirmCallback2,this.request(NetRequestConst.REQUEST_RADULT_GETALLPROPOSE,{childId:this._adultInfoVo.id});var t=BaseBitmap.create("public_bg6");t.y=-21,this.addChildToContainer(t);var e=ComponentManager.getTextField(this._adultInfoVo.name,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);e.x=20,e.y=5,this.addChildToContainer(e);var i=LanguageManager.getlocal("adultMarryFather")+Api.playerVoApi.getPlayerName(),a=ComponentManager.getTextField(i,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);a.x=130,a.y=5,this.addChildToContainer(a);var n=LanguageManager.getlocal("adult_quality")+LanguageManager.getlocal("adult_quality"+this._adultInfoVo.aquality),o=ComponentManager.getTextField(n,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);o.x=330,o.y=5,this.addChildToContainer(o);var s=LanguageManager.getlocal("servant_infoAttr")+this._adultInfoVo.attrVo.attTotal,r=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);r.x=500,r.y=5,this.addChildToContainer(r);var l=ComponentManager.getTextField(LanguageManager.getlocal("adultMarryObject"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);l.x=20,l.y=70,this.addChildToContainer(l);var h=BaseBitmap.create("public_chatinputbg");h.width=240,h.height=40,h.x=250,h.y=l.y+l.height/2-h.height/2,this.addChildToContainer(h);var d=LanguageManager.getlocal("adultMarryRefreshTime",["00:00:00"]);this._timeTF=ComponentManager.getTextField(d,TextFieldConst.FONTSIZE_CONTENT_COMMON),this._timeTF.x=h.x+10,this._timeTF.y=l.y+l.height/2-this._timeTF.height/2,this.addChildToContainer(this._timeTF);var g=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"adultMarryRefresh",this.refreshHandler,this);g.x=h.x+h.width+10,g.y=l.y+l.height/2-g.height/2,g.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(g);var c=BaseBitmap.create("public_9_bg23");c.width=GameConfig.stageWidth-10,c.height=GameConfig.stageHeigth-300,c.x=5,c.y=115,this.addChildToContainer(c);var p=egret.Rectangle.create();p.setTo(0,0,GameConfig.stageWidth-14,GameConfig.stageHeigth-245),this._scrollList=ComponentManager.getScrollList(AdultMarryScrollItem,null,p),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(c.x,c.y+10),this._scrollList.setEmptyTip(LanguageManager.getlocal("adultEmptyTip1"));var _=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"adultMarryAll",this.marryAllHandler,this);_.x=35,_.y=c.y+c.height+12,this.addChildToContainer(_),_.setColor(TextFieldConst.COLOR_BLACK);var u=ComponentManager.getTextField(LanguageManager.getlocal("adultMarryNumber"),TextFieldConst.FONTSIZE_TITLE_SMALL);u.x=200,u.y=_.y+_.height/2-u.height/2,this.addChildToContainer(u);var C=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,140,48,"public_chatinputbg",LanguageManager.getlocal("adultMarryInputHolder"),10785151);C.x=u.x+u.width+10,C.y=_.y+_.height/2-C.height/2,this.addChildToContainer(C),this._inputTextField=C.getChildByName("textField"),this._inputTextField.restrict="0-9";var f=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"adultMarryOne",this.marryOneHandler,this);f.x=GameConfig.stageWidth-f.width-35,f.y=_.y,this.addChildToContainer(f),f.setColor(TextFieldConst.COLOR_BLACK)},e.prototype.receiveData=function(t){if(t.data.cmd==NetRequestConst.REQUEST_RADULT_GETALLPROPOSE)this._scrollList.refreshData(t.data.data.pinfo.d),this._nextRefreshTime=t.data.data.pinfo.ft,this.tick();else if(t.data.cmd==NetRequestConst.REQUEST_RADULT_PROPOSEALL)this.param.data.confirmCallback&&this.param.data.confirmCallback.apply(this.param.data.handler,[]),App.CommonUtil.showTip(LanguageManager.getlocal("adultMarryRequestTip1")),this.hide();else if(t.data.cmd==NetRequestConst.REQUEST_RADULT_PROPOSE){if(t.data.data.proflag)return void App.CommonUtil.showTip(LanguageManager.getlocal("adultMarryRequestTip2"));App.CommonUtil.showTip(LanguageManager.getlocal("adultMarryRequestTip1")),this.param.data.confirmCallback&&this.param.data.confirmCallback.apply(this.param.data.handler,[]),this.hide()}else if(t.data.cmd==NetRequestConst.REQUEST_RADULT_AGREEPROPOSE){if(2==t.data.data.proflag)return App.CommonUtil.showTip(LanguageManager.getlocal("adultMarryRequestTip4")),void this.request(NetRequestConst.REQUEST_RADULT_GETALLPROPOSE,{childId:this._adultInfoVo.id});this.param.data.confirmCallback2&&this.param.data.confirmCallback2.apply(this.param.data.handler,[]);var e=t.data.data.adultId;ViewController.getInstance().openView(ViewConst.BASE.ADULTMARRYSUCCESSVIEW,{childId:e,confirmCallback:null,handler:this}),this.hide()}},e.prototype.tick=function(){var t=this._nextRefreshTime-GameData.serverTime;if(t>0){var e=LanguageManager.getlocal("adultMarryRefreshTime",[App.DateUtil.getFormatBySecond(t,1)]);this._timeTF.text=e}else this.request(NetRequestConst.REQUEST_RADULT_GETALLPROPOSE,{childId:this._adultInfoVo.id})},e.prototype.refreshHandler=function(){var t=Api.playerVoApi.getPlayerGem(),e=Config.AdultCfg.freshGem,i=LanguageManager.getlocal("adultRefreshGem",[App.StringUtil.toString(e)]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{confirmCallback:this.refreshList,handler:this,icon:"itemicon1",iconBg:"itembg_1",num:t,msg:i,id:1,useNum:e})},e.prototype.refreshList=function(){this.request(NetRequestConst.REQUEST_RADULT_GETALLPROPOSE,{childId:this._adultInfoVo.id,freshFlag:!0})},e.prototype.doChooseType=function(t){this._selectChildData=t.data,ViewController.getInstance().openView(ViewConst.POPUP.ADULTCHOOSETYPEVIEW,{type:2,childId:this._adultInfoVo.id,confirmCallback:this.selectMarryHander,handler:this})},e.prototype.selectMarryHander=function(t){this.request(NetRequestConst.REQUEST_RADULT_AGREEPROPOSE,{aid:this._selectChildData.id,childId:this._adultInfoVo.id,protype:t})},e.prototype.marryAllHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.ADULTCHOOSETYPEVIEW,{type:2,childId:this._adultInfoVo.id,confirmCallback:this.chooseAllCallBack,handler:this})},e.prototype.marryOneHandler=function(){return this._inputTextField.text.length<=0||this._inputTextField.text==LanguageManager.getlocal("adultMarryInputHolder")?void App.CommonUtil.showTip(LanguageManager.getlocal("adultMarryEmptyTip")):Number(this._inputTextField.text)==Api.playerVoApi.getPlayerID()?void App.CommonUtil.showTip(LanguageManager.getlocal("adultMarryRequestTip3")):void ViewController.getInstance().openView(ViewConst.POPUP.ADULTCHOOSETYPEVIEW,{type:2,childId:this._adultInfoVo.id,confirmCallback:this.chooseOneCallBack,handler:this})},e.prototype.chooseAllCallBack=function(t){this.request(NetRequestConst.REQUEST_RADULT_PROPOSEALL,{childId:this._adultInfoVo.id,protype:t})},e.prototype.chooseOneCallBack=function(t){this.request(NetRequestConst.REQUEST_RADULT_PROPOSE,{childId:this._adultInfoVo.id,fuid:this._inputTextField.text,protype:t})},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_ADULT_CLICKMARRY,this.doChooseType,this),this._scrollList=null,this._adultInfoVoList=null,this._inputTextField=null,this._adultInfoVo=null,this._confirmCallback=null,this._confirmCallback2=null,this._handler=null,this._timeTF=null,this._nextRefreshTime=null,this._selectChildData=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(AdultMarryView.prototype,"AdultMarryView");var AdultScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addTick,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeTick,this),this.width=604,this.height=60+this.getSpaceY();Api.adultVoApi.getAdultVoList();this._itemBg=BaseBitmap.create("public_9_bg27"),this._itemBg.width=this.width,this._itemBg.height=this.height-5,this._itemBg.x=this.width/2-this._itemBg.width/2,this._itemBg.y=this.height/2-this._itemBg.height/2,this.addChild(this._itemBg);var i="childview_boyicon";2==e.sex&&(i="childview_girlicon");var a=BaseBitmap.create(i);a.x=22,a.y=this.height/2-a.height/2,this.addChild(a);var n=BaseBitmap.create("public_9_bg26");n.width=this.width-80,n.height=this.height-25,n.x=this.width/2-n.width/2+20,n.y=this.height/2-n.height/2,n.name="bg2",this.addChild(n);var o=e.name,s=TextFieldConst.COLOR_WHITE;""==o&&(o=LanguageManager.getlocal("childNeedName"),s=TextFieldConst.COLOR_WARN_RED),this._nameTF=ComponentManager.getTextField(o,TextFieldConst.FONTSIZE_TITLE_SMALL),this._nameTF.textColor=s,this._nameTF.x=70,this._nameTF.y=this.height/2-this._nameTF.height/2,this.addChild(this._nameTF);var r=LanguageManager.getlocal("adult_quality")+LanguageManager.getlocal("adult_quality"+e.aquality);this._qualityTF=ComponentManager.getTextField(r,TextFieldConst.FONTSIZE_TITLE_SMALL),this._qualityTF.textColor=s,this._qualityTF.x=220,this._qualityTF.y=this.height/2-this._qualityTF.height/2,this.addChild(this._qualityTF);var l=LanguageManager.getlocal("servant_infoAttr")+e.attrVo.attTotal;this._attrTF=ComponentManager.getTextField(l,TextFieldConst.FONTSIZE_TITLE_SMALL),this._attrTF.textColor=s,this._attrTF.x=410,this._attrTF.y=this.height/2-this._attrTF.height/2,this.addChild(this._attrTF),this._inMarryBB=BaseBitmap.create("adult_inmarry"),this._inMarryBB.x=this.width-this._inMarryBB.width-3,this._inMarryBB.y=this.height/2-this._inMarryBB.height/2,this.addChild(this._inMarryBB);var h=0;e.pro&&e.pro[0]&&(h=e.pro[0]-GameData.serverTime),h>0?this._inMarryBB.visible=!0:this._inMarryBB.visible=!1},e.prototype.eventHandler=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._itemBg.texture=ResourceManager.getRes("public_9_bg28_down");break;case egret.TouchEvent.TOUCH_CANCEL:this._itemBg.texture=ResourceManager.getRes("public_9_bg28");break;case egret.TouchEvent.TOUCH_END:this._itemBg.texture=ResourceManager.getRes("public_9_bg28")}},e.prototype.refreshData=function(t){this._childIndex=t;var e=Api.adultVoApi.getAdultVoList(),i=e[t],a=i.name;if(this._nameTF.text=a,i){var n=0;i.pro&&i.pro[0]&&(n=i.pro[0]-GameData.serverTime),n>0?this._inMarryBB.visible=!0:this._inMarryBB.visible=!1}},e.prototype.tick=function(){var t=this._adultInfo;if(t){var e=0;t.pro&&t.pro[0]&&(e=t.pro[0]-GameData.serverTime),e>0?this._inMarryBB.visible=!0:this._inMarryBB.visible=!1}},e.prototype.addTick=function(){TickManager.addTick(this.tick,this)},e.prototype.removeTick=function(){TickManager.removeTick(this.tick,this)},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._nameTF=null,this._qualityTF=null,this._attrTF=null,this._childIndex=null,this._itemBg.removeTouch(),this._itemBg=null,this._inMarryBB=null,this._adultInfo=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AdultScrollItem.prototype,"AdultScrollItem");var AdultView=function(t){function e(){var e=t.call(this)||this;return e._curTabIdx=0,e._childId=null,e._childInfoObj=null,e._proTxtList=null,e._childProCfg=null,e._curLevel=0,e._marryIndex=0,e._achRedDotSp=null,e}return __extends(e,t),e.prototype.initView=function(){if(Api.rookieVoApi.checkNextStep(),Api.adultVoApi.getAdultMarryNum(),Api.adultVoApi._marryList.length>0&&(this._marryData=Api.adultVoApi._marryList,this.playMarry()),Api.adultVoApi._refuseData&&""!=Api.adultVoApi._refuseData){var t=GameData.getRewardsStr(Api.adultVoApi._refuseData),e=LanguageManager.getlocal("adultMarryMsg",[t]);ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"adultMarryRefuse",msg:e,callback:null,handler:this})}App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_ADULT_REFRESHCHILDMARRY,this.doRefresh,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT,this.doGuide,this),this.request(NetRequestConst.REQUEST_RADULT_GETADULTINFO,{});var i=BaseBitmap.create("public_bg6");i.y=-21,this.addChildToContainer(i);var a=BaseBitmap.create("adult_bg");if(a.x=0,a.y=i.y+i.height+0,this.addChildToContainer(a),this._childContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._childContainer),this._childContainer2=new BaseDisplayObjectContainer,this.addChildToContainer(this._childContainer2),Api.adultVoApi.getAdultNum()>0){this._child_wordbg=BaseBitmap.create("public_9_bg25"),this._child_wordbg.visible=!1,this._child_wordbg.x=60,this._child_wordbg.y=60,this._child_wordbg.width=300,this._child_wordbg.height=78,this._childContainer.addChild(this._child_wordbg),this._child_wordbgCor=BaseBitmap.create("public_9_bg25_tail"),this._child_wordbgCor.x=260,this._child_wordbgCor.y=this._child_wordbg.y+this._child_wordbg.height-3,this._childContainer.addChild(this._child_wordbgCor),this._childWordsText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._childWordsText.text=LanguageManager.getlocal("childIntimacyDesc"),this._childWordsText.x=this._child_wordbg.x+20,this._childWordsText.y=this._child_wordbg.y+20,this._childWordsText.width=280,this._childWordsText.height=80,this._childContainer.addChild(this._childWordsText),this._child_Icon=BaseBitmap.create(""),this._child_Icon.x=40,this._child_Icon.y=this._child_wordbgCor.y-10,this._childContainer.addChild(this._child_Icon),this._proTxtList=[],this._adultInfoVo=Api.adultVoApi.getAdultVoList()[0],this._adultInfoVoList=Api.adultVoApi.getAdultVoList(),this._motherText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._motherText.x=30,this._motherText.y=5,this._childContainer.addChild(this._motherText),this._intimacyText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._intimacyText.x=200,this._intimacyText.y=5,this._childContainer.addChild(this._intimacyText),this._intimacyDescText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._intimacyDescText.text=LanguageManager.getlocal("childIntimacyDesc"),this._intimacyDescText.x=GameConfig.stageWidth-this._intimacyDescText.width-30,this._intimacyDescText.y=5,this._childContainer.addChild(this._intimacyDescText),this._child_infobg=BaseBitmap.create("servant_probigbg"),this._child_infobg.x=375,this._child_infobg.y=this._child_wordbg.y+70,this._childContainer.addChild(this._child_infobg),this._attBg=BaseBitmap.create("public_9_probiginnerbg"),this._attBg.width=182,this._attBg.height=190,this._attBg.x=this._child_infobg.x+this._child_infobg.width/2-this._attBg.width/2,this._attBg.y=this._child_infobg.y+50,this._childContainer.addChild(this._attBg),this._childNameText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN),this._childNameText.text="",this._childNameText.x=this._child_infobg.x+this._child_infobg.width/2-this._childNameText.width/2,this._childNameText.y=this._child_infobg.y+20,this._childContainer.addChild(this._childNameText),this._childNameText.addTouchTap(this.changeNameHandler,this,null);for(var n=410,o=this._attBg.y+10,s=0;6>s;s++){var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,14538183);r.x=n,r.y=o,this._childContainer.addChild(r),o+=25,this._proTxtList.push(r)}this._vigouTimeText=ComponentManager.getTextField("00:00:00",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN),this._vigouTimeText.x=410,this._vigouTimeText.y=this._child_infobg.y+this._child_infobg.height-100,this._childContainer.addChild(this._vigouTimeText),this.tick()}var l=BaseBitmap.create("servant_bottombg");l.height=GameConfig.stageHeigth-this.container.y-a.height-i.height-i.y,l.x=0,l.y=GameConfig.stageHeigth-this.container.y-l.height,this.addChildToContainer(l);var h=["adultTab1","adultTab2"],d=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,h,this.tabBtnClickHandler,this);d.x=20,d.y=l.y+24,this.addChildToContainer(d);var g=Api.adultVoApi.getAdultVoList(),c=egret.Rectangle.create();if(c.setTo(0,0,GameConfig.stageWidth-36,l.height-120),this._scrollList=ComponentManager.getScrollList(AdultScrollItem,g,c),this.addChildToContainer(this._scrollList),this._scrollList.x=l.x+l.width/2-this._scrollList.width/2,this._scrollList.y=l.y+90,this._scrollList.addTouchTap(this.clickItemHandler,this),this._scrollList.setEmptyTip(LanguageManager.getlocal("adultEmptyMsg"),TextFieldConst.COLOR_BLACK),this._goChildBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"adultEmptyBtnMsg",this.goChildBtnClick,this),this._goChildBtn.x=l.x+l.width/2-this._goChildBtn.width/2,this._goChildBtn.y=l.y+l.height/2+70,this.addChildToContainer(this._goChildBtn),g.length<=0?this._goChildBtn.visible=!0:this._goChildBtn.visible=!1,this.param&&this.param.data.childId){if(this.param.data.childId){var p=Api.adultVoApi.getAdultIndexVoById(this.param.data.childId);this._scrollList.setScrollTopByIndex(p,0);var _=this._adultInfoVoList[p],u=_.id;this._adultInfoVo=_,this.updChildAttData(_),this.setSelect(u)}}else if(Api.adultVoApi.getAdultNum()>0){var _=this._adultInfoVoList[0],u=_.id;this._adultInfoVo=_,this.updChildAttData(_);var p=Api.adultVoApi.getAdultIndexVoById(u);this.setSelect(u)}this._marryChild_wordbg=BaseBitmap.create("public_9_bg25"),this._marryChild_wordbg.x=160,this._marryChild_wordbg.y=60,this._marryChild_wordbg.width=300,this._marryChild_wordbg.height=78,this._childContainer2.addChild(this._marryChild_wordbg),this._marryChild_wordbgCor=BaseBitmap.create("public_9_bg25_tail"),this._marryChild_wordbgCor.x=300,this._marryChild_wordbgCor.y=this._marryChild_wordbg.y+this._marryChild_wordbg.height-3,this._childContainer2.addChild(this._marryChild_wordbgCor),this._marryWordsText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._marryWordsText.text=LanguageManager.getlocal("adultMarryWord1"),this._marryWordsText.x=this._marryChild_wordbg.x+20,this._marryWordsText.y=this._marryChild_wordbg.y+20,this._marryWordsText.width=280,this._marryWordsText.height=80,this._childContainer2.addChild(this._marryWordsText),this._marryChild_Icon=BaseBitmap.create(""),this._marryChild_Icon.x=40,this._marryChild_Icon.y=this._marryChild_wordbgCor.y-10,this._childContainer2.addChild(this._marryChild_Icon),this._marryChild_Icon2=BaseBitmap.create(""),this._marryChild_Icon2.x=260,this._marryChild_Icon2.y=this._marryChild_wordbgCor.y-10,this._childContainer2.addChild(this._marryChild_Icon2),this._otherNameText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._otherNameText.x=30,this._otherNameText.y=5,this._childContainer2.addChild(this._otherNameText),this._marryBuffText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._marryBuffText.x=230,this._marryBuffText.y=5,this._childContainer2.addChild(this._marryBuffText),this._marryTimeText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._marryTimeText.x=430,this._marryTimeText.y=5,this._childContainer2.addChild(this._marryTimeText);var C=Api.adultVoApi.getAdultMarryVoList(),f=egret.Rectangle.create();f.setTo(0,0,GameConfig.stageWidth-36,l.height-120),this._scrollList2=ComponentManager.getScrollList(Adult2ScrollItem,C,f),this.addChildToContainer(this._scrollList2),this._scrollList2.x=l.x+l.width/2-this._scrollList2.width/2,this._scrollList2.y=l.y+90,this._scrollList2.addTouchTap(this.clickItemHandler2,this),this._scrollList2.visible=!1,this._scrollList2.setEmptyTip(LanguageManager.getlocal("adultEmptyMsg2"),TextFieldConst.COLOR_BLACK),Api.adultVoApi.getAdultMarryNum()>0&&(this._adultMarryInfoVo=Api.adultVoApi.getAdultMarryVoList()[0],this.updMarryChildAttData(this._adultMarryInfoVo),this.setSelect2(this._adultMarryInfoVo.id)),this._childContainer2.visible=!1,this._scrollList2.visible=!1,this._marryChild_Icon.anchorOffsetX=this._marryChild_Icon.width/2,this._marryChild_Icon2.anchorOffsetX=this._marryChild_Icon2.width/2,this._marryChild_Icon.x=this._marryChild_Icon.x+this._marryChild_Icon.width/2,this._marryChild_Icon2.x=this._marryChild_Icon2.x+this._marryChild_Icon2.width/2;
var m=ComponentManager.getButton("btn_marry","",this.requestBtnClick,this);m.x=0,m.y=GameConfig.stageHeigth-m.height,this.addChild(m),this._achRedDotSp=BaseBitmap.create("public_dot2"),this._achRedDotSp.x=m.x+m.width-this._achRedDotSp.width-1,this._achRedDotSp.y=m.y-2,this._achRedDotSp.visible=!1,this.addChild(this._achRedDotSp),this.request(NetRequestConst.REQUEST_RADULT_GETPROPOSEE,null)},e.prototype.goChildBtnClick=function(){ViewController.getInstance().openView(ViewConst.COMMON.CHILDVIEW,{}),this.hide()},e.prototype.requestBtnClick=function(){ViewController.getInstance().openView(ViewConst.POPUP.ADULTMARRYREQUESTVIEW,{confirmCallback:this.requestMarryCallback,confirmCallback2:this.checkRedPoint,handler:this})},e.prototype.checkRedPoint=function(t){1==t?this._achRedDotSp.visible=!0:this._achRedDotSp.visible=!1},e.prototype.tabBtnClickHandler=function(t){if(this._curTabIdx=t.index,0==this._curTabIdx){this._scrollList.visible=!0,this._childContainer.visible=!0,this._childContainer2.visible=!1,this._scrollList2.visible=!1,Api.adultVoApi.getAdultNum()>0?this._childContainer.visible=!0:this._childContainer.visible=!1;var e=Api.adultVoApi.getAdultVoList();e.length<=0?this._goChildBtn.visible=!0:this._goChildBtn.visible=!1}else this._childContainer.visible=!1,this._scrollList.visible=!1,this._goChildBtn.visible=!1,Api.adultVoApi.getAdultMarryNum()>0&&(this._scrollList2.visible=!0,this._childContainer2.visible=!0),this._scrollList2.visible=!0},e.prototype.clickItemHandler=function(t){var e=Number(t.data);if(this._adultInfoVoList=Api.adultVoApi.getAdultVoList(),this._adultInfoVoList){var i=this._adultInfoVoList[e];if(i){var a=i.id;this._adultInfoVo=i,this.updChildAttData(i),this.setSelect(a)}}this.tick()},e.prototype.clickItemHandler2=function(t){var e=Number(t.data),i=Api.adultVoApi.getAdultMarryVoList();if(this._adultMarryInfoVo=i[e],this._adultMarryInfoVo){var a=this._adultMarryInfoVo.id;this.updMarryChildAttData(this._adultMarryInfoVo),this.setSelect2(a)}},e.prototype.tick=function(){if(!(Api.adultVoApi.getAdultNum()<=0)&&null!=this._vigouTimeText){var t=0;this._adultInfoVo.pro&&(t=this._adultInfoVo.pro[0]-GameData.serverTime),t>0?(this._vigouTimeText.text=LanguageManager.getlocal("adultMarryTime")+App.DateUtil.getFormatBySecond(t,1),this._vigouTimeText.visible=!0):this._vigouTimeText.visible=!1}},e.prototype.addChildPos=function(){this.request(NetRequestConst.REQUEST_CHILD_ADDPOSNUM,null)},e.prototype.setSelect=function(t){var e=Api.adultVoApi.getAdultIndexVoById(t);if(this._adultScrollItem&&this._adultScrollItem.getChildByName("select")){this._adultScrollItem.removeChild(this._adultScrollItem.getChildByName("select"));var i=this._adultScrollItem.getChildByName("select");i=null}this._adultScrollItem=this._scrollList.getItemByIndex(e);var a=this._adultScrollItem.getChildIndex(this._adultScrollItem.getChildByName("bg2")),n=BaseBitmap.create("public_9_bg29");n.width=this._adultScrollItem.width-75,n.height=48,n.x=this._adultScrollItem.width/2-n.width/2+20,n.y=this._adultScrollItem.height/2-n.height/2,n.name="select",this._adultScrollItem.addChildAt(n,a+1)},e.prototype.setSelect2=function(t){var e=Api.adultVoApi.getAdultMarryIndexVoById(t);if(this._adult2ScrollItem&&this._adult2ScrollItem.getChildByName("select2")){this._adult2ScrollItem.removeChild(this._adult2ScrollItem.getChildByName("select2"));var i=this._adult2ScrollItem.getChildByName("select2");i=null}this._adult2ScrollItem=this._scrollList2.getItemByIndex(e);var a=this._adult2ScrollItem.getChildIndex(this._adult2ScrollItem.getChildByName("bg2")),n=BaseBitmap.create("public_9_bg29");n.width=this._adult2ScrollItem.width-36,n.height=97,n.x=18,n.y=8,n.name="select2",this._adult2ScrollItem.addChildAt(n,a+1)},e.prototype.updChildAttData=function(t){if(null!=t){this._childProCfg=[{txt:this.getProStringWithProId(1)},{txt:this.getProStringWithProId(2)},{txt:this.getProStringWithProId(3)},{txt:this.getProStringWithProId(4)},{txt:this.getProStringWithProId(5)},{txt:this.getProStringWithProId(6)}],this._child_Icon.texture=ResourceManager.getRes(Api.adultVoApi.getAdultPic(t.id));var e=GameConfig.config.childCfg[t.quality.toString()];t.level==e.lv?(this._child_wordbg.visible=!1,this._child_wordbgCor.visible=!1,this._childWordsText.visible=!1):(this._childWordsText.text=Api.adultVoApi.getAdultWord(t.id),this._child_wordbg.visible=!0,this._child_wordbgCor.visible=!0,this._childWordsText.visible=!0);var i=Api.wifeVoApi.getWifeInfoVoById(t.motherId);this._motherText.text=LanguageManager.getlocal("childMother",[i.name]),this._intimacyText.text=LanguageManager.getlocal("childIntimacy",[i.intimacy.toString()]);var a=t.name;a=""==a?LanguageManager.getlocal("childNeedName"):"<font u ='true'>"+t.name+"</font>",this._childNameText.text=a,this._childNameText.x=this._child_infobg.x+this._child_infobg.width/2-this._childNameText.width/2,this._childNameText.y=this._child_infobg.y+20;var n=GameConfig.config.childCfg[t.quality.toString()],o=LanguageManager.getlocal("servant_infoLv")+t.level+"/"+n.lv;t.level>=n.lv&&(o=LanguageManager.getlocal("child_levelMax"));for(var s=0;s<this._childProCfg.length;s++){var r=this._childProCfg[s],l=this._proTxtList[s];l.text=r.txt}if(Api.adultVoApi.getAdultIsInMarry(this._adultInfoVo.id))this._childUpdBtn&&(this._childUpdBtn.visible=!1),this._childNameBtn?this._childNameBtn.visible=!0:(this._childNameBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"adultCancelMarry",this.nameBtnClickHandler,this),this._childNameBtn.x=this._child_infobg.x+this._child_infobg.width/2-this._childNameBtn.width/2,this._childNameBtn.y=this._child_infobg.y+this._child_infobg.height-65,this._childNameBtn.setColor(TextFieldConst.COLOR_BLACK),this._childContainer.addChild(this._childNameBtn));else{var h="adultMarry";this._childNameBtn&&(this._childNameBtn.visible=!1),this._childUpdBtn?this._childUpdBtn.visible=!0:(this._childUpdBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,h,this.updBtnClickHandler,this),this._childUpdBtn.x=this._child_infobg.x+this._child_infobg.width/2-this._childUpdBtn.width/2,this._childUpdBtn.y=this._child_infobg.y+this._child_infobg.height-65,this._childUpdBtn.setColor(TextFieldConst.COLOR_BLACK),this._childContainer.addChild(this._childUpdBtn)),this._childUpdBtn.setText(h)}}},e.prototype.updMarryChildAttData=function(t){if(Api.adultVoApi.getAdultMarryNum()<=0)return void(this._childContainer2.visible=!1);this._childContainer2.visible=!0,this._otherNameText.text=LanguageManager.getlocal("adultOtherName")+t.funame,this._marryBuffText.text=LanguageManager.getlocal("adultMarryBuff")+t.ftotal,this._marryTimeText.text=App.DateUtil.getFormatBySecond(t.mts,2);var e="adult_boy",i="adult_girl";2==t.sex?(e="adult_girl",i="adult_boy",this._marryChild_Icon.skewY=180,this._marryChild_Icon2.skewY=180):(this._marryChild_Icon.skewY=0,this._marryChild_Icon2.skewY=0),this._marryChild_Icon.texture=ResourceManager.getRes(e),this._marryChild_Icon2.texture=ResourceManager.getRes(i)},e.prototype.changeNameHandler=function(){""!=this._adultInfoVo.name&&ViewController.getInstance().openView(ViewConst.POPUP.NAMEPOPUPVIEW,{type:3,childId:this._adultInfoVo.id,confirmCallback:this.reNameCallBack,handler:this})},e.prototype.nameBtnClickHandler=function(){var t="";if(1==this._adultInfoVo.pro[1])t=.8*Config.AdultCfg.getItemCfgById(this._adultInfoVo.aquality).needGem+LanguageManager.getlocal("gemName");else if(2==this._adultInfoVo.pro[1]){var e=Config.AdultCfg.getItemCfgById(this._adultInfoVo.aquality).needItem,i=(Api.itemVoApi.getItemInfoVoById(Number(e)),Config.ItemCfg.getItemCfgById,Config.ItemCfg.getItemCfgById(Number(e)));t=i.name}var a=LanguageManager.getlocal("adultMarryCancalMsg",[t]);ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"adultCancelMarry",msg:a,callback:this.doCancel,handler:this,needCancel:!0})},e.prototype.doCancel=function(){this.request(NetRequestConst.REQUEST_RADULT_CANCELPROPOSE,{childId:this._adultInfoVo.id})},e.prototype.reNameCallBack=function(){this.refreshItem(),this._adultInfoVo=Api.adultVoApi.getAdultInfoVoById(this._adultInfoVo.id),this._adultInfoVoList=Api.adultVoApi.getAdultVoList(),this.updChildAttData(this._adultInfoVo)},e.prototype.useItemConfirmCallbackHandler=function(){this.request(NetRequestConst.REQUEST_CHILD_RECOVER,{childId:this._adultInfoVo.id})},e.prototype.updBtnClickHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.ADULTMARRYVIEW,{childId:this._adultInfoVo.id,confirmCallback:this.reNameCallBack,confirmCallback2:this.requestMarryCallback,handler:this})},e.prototype.doGuide=function(){this.updBtnClickHandler()},e.prototype.requestMarryCallback=function(){var t=Api.adultVoApi.getAdultVoList();this._scrollList.refreshData(t),Api.adultVoApi.getAdultNum()>0?(this._adultInfoVo=Api.adultVoApi.getAdultVoList()[0],this.updChildAttData(this._adultInfoVo),this._childContainer.visible=!0,this.setSelect(this._adultInfoVo.id)):this._childContainer.visible=!1;var e=Api.adultVoApi.getAdultMarryVoList();this._scrollList2.refreshData(e),Api.adultVoApi.getAdultMarryNum()>0&&(this._adultMarryInfoVo=Api.adultVoApi.getAdultMarryVoList()[0],this.updMarryChildAttData(this._adultMarryInfoVo),this._childContainer2.visible=!1,this.setSelect2(this._adultMarryInfoVo.id))},e.prototype.receiveData=function(t){if(t.data.data)if(this._adultInfoVo&&(this._adultInfoVo=Api.adultVoApi.getAdultInfoVoById(this._adultInfoVo.id)),t.data.cmd==NetRequestConst.REQUEST_RADULT_CANCELPROPOSE){if(this.updChildAttData(this._adultInfoVo),this.refreshItem(),t.data.data.rewards){var e=GameData.formatRewardItem(t.data.data.rewards);e&&e.length>0&&App.CommonUtil.playRewardFlyAction(e)}}else t.data.cmd==NetRequestConst.REQUEST_CHILD_RECOVER?(this.updChildAttData(this._adultInfoVo),this.refreshItem()):t.data.cmd==NetRequestConst.REQUEST_RADULT_GETADULTINFO||t.data.cmd==NetRequestConst.REQUEST_RADULT_GETPROPOSEE&&(t.data.data.minfo?this._achRedDotSp.visible=!0:this._achRedDotSp.visible=!1)},e.prototype.playMarry=function(){if(this._marryIndex<=this._marryData.length-1){var t=this._marryData[this._marryIndex];ViewController.getInstance().openView(ViewConst.BASE.ADULTMARRYSUCCESSVIEW,{childId:t,confirmCallback:this.playMarry,handler:this}),this._marryIndex++}},e.prototype.doRefresh=function(){var t=Api.adultVoApi.getAdultVoList();this._adultInfoVo=Api.adultVoApi.getAdultVoList()[0],this.updChildAttData(this._adultInfoVo),this._scrollList.refreshData(t);var e=Api.adultVoApi.getAdultMarryVoList();this._scrollList2.refreshData(e),Api.adultVoApi.getAdultMarryNum()>0&&(this._adultMarryInfoVo=Api.adultVoApi.getAdultMarryVoList()[0],this.updMarryChildAttData(this._adultMarryInfoVo)),this._childContainer2.visible=!1,this._scrollList2.visible=!1},e.prototype.refreshItem=function(){if(null!=this._adultInfoVo){var t=Api.adultVoApi.getAdultIndexVoById(this._adultInfoVo.id),e=this._scrollList.getItemByIndex(t);e.refreshData(t)}},e.prototype.getProStringWithProId=function(t){if(1==t){var e=LanguageManager.getlocal("adult_quality")+LanguageManager.getlocal("adult_quality"+this._adultInfoVo.aquality);return e}return 2==t?LanguageManager.getlocal("servant_infoAttr")+this._adultInfoVo.attrVo.attTotal:3==t?LanguageManager.getlocal("servant_force",[this._adultInfoVo.attrVo.forceTotal.toString()]):4==t?LanguageManager.getlocal("servant_inte",[this._adultInfoVo.attrVo.brainsTotal.toString()]):5==t?LanguageManager.getlocal("servant_policy",[this._adultInfoVo.attrVo.politicsTotal.toString()]):6==t?LanguageManager.getlocal("servant_charm",[this._adultInfoVo.attrVo.charmTotal.toString()]):""},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["childview_mask","childview_pic_1","servant_bottombg","progress3","progress3_bg","servant_probigbg","childview_boyicon","childview_girlicon"])},e.prototype.getRuleInfo=function(){return"adult_description"},e.prototype.dispose=function(){this._scrollList=null,this._scrollList2=null,this._adultInfoVoList=null,this._motherText=null,this._intimacyText=null,this._intimacyDescText=null,this._childWordsText=null,this._childNameText=null,this._child_Icon=null,this._adultInfoVo=null,this._childUpdBtn=null,this._childNameBtn=null,this._adultMarryInfoVo=null,this._otherNameText=null,this._marryBuffText=null,this._marryTimeText=null,this._marryWordsText=null,this._marryChild_Icon=null,this._marryChild_Icon2=null,this._curTabIdx=0,this._attBg=null,this._child_infobg=null,this._vigouTimeText=null,this._childContainer=null,this._childContainer2=null,this._childId=null,this._childInfoObj=null,this._proTxtList=null,this._childProCfg=null,this._curLevel=null,this._child_wordbg=null,this._child_wordbgCor=null,this._marryChild_wordbg=null,this._marryChild_wordbgCor=null,this._adultScrollItem=null,this._adult2ScrollItem=null,this._achRedDotSp=null,this._childNameText&&this._childNameText.removeTouchTap(),this._marryIndex=0,this._marryData=null,this._goChildBtn=null,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_ADULT_REFRESHCHILDMARRY,this.doRefresh,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT,this.doGuide,this),t.prototype.dispose.call(this)},e}(CommonView);__reflect(AdultView.prototype,"AdultView");var AffairView=function(t){function e(){var e=t.call(this)||this;return e._lastUseTime=0,e._dialogueBg=null,e._dialogueBg2=null,e._prisonDesTxt=null,e._bubbleContainer=null,e._bottomInfoY=0,e._nameType="",e._affair_rewardbg1=null,e._affair_rewardbg2=null,e._pubTextbg=null,e._collectFlag=null,e}return __extends(e,t),e.prototype.initView=function(){this.initTop(),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_ADDAFFAIR),this.clickUseBtnCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_DEALAFFAIR),this.affairTouchImgClickCallBack,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_ITEM,this.clickUseBtnCallback,this)},e.prototype.getBgName=function(){return"affairview_bg"},e.prototype.initTop=function(){this._nodeContainer=new BaseDisplayObjectContainer,this._nodeContainer.y=-20,this.addChildToContainer(this._nodeContainer),this._bottomnodeContainer1=new BaseDisplayObjectContainer,this._bottomnodeContainer2=new BaseDisplayObjectContainer,this._bottomnodeContainer2.y=GameConfig.stageHeigth-460;var t=new MainUITop({showName:!1});this._nodeContainer.addChild(t),this._curoptId=Api.manageVoApi.getCurAffairOpt();var e=BaseBitmap.create("public_icon5");e.x=15,e.y=105,this._nodeContainer.addChild(e),this._progressBar=ComponentManager.getProgressBar("progress3","progress3_bg",562),this._progressBar.x=65,this._progressBar.y=117,this._nodeContainer.addChild(this._progressBar),this._progressBar.setPercentage(.5);var i=BaseBitmap.create("promotion_officerbg1");i.x=GameConfig.stageWidth-i.width,i.y=t.y+107+40,this._bottomnodeContainer1.addChild(i),this._timesText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW),this._timesText.x=i.x+40,this._timesText.y=i.y+15,this._bottomnodeContainer1.addChild(this._timesText);var a=BaseLoadBitmap.create("servant_full_1001");a.x=10,a.y=GameConfig.stageHeigth-785,this._bottomnodeContainer1.addChild(a),this._bottomInfoY=t.y+107;var n=BaseBitmap.create("public_9_bg22");n.x=0,n.height=300,n.y=GameConfig.stageHeigth-360,this._nodeContainer.addChild(n),this._bottomBg=n,this._nodeContainer.addChild(this._bottomnodeContainer1),this._nodeContainer.addChild(this._bottomnodeContainer2);var o=BaseBitmap.create("affairview_zhuozi");o.x=0,o.y=GameConfig.stageHeigth-320,this._bottomnodeContainer1.addChild(o);var s=BaseBitmap.create("affairview_zibg");s.x=23,s.y=GameConfig.stageHeigth-290,this._bottomnodeContainer1.addChild(s),s.touchEnabled=!0,s.name="1",s.addTouch(this.eventHandler,this),this._affairTouchImg1=s,this._affairImgText1=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._affairImgText1.width=190,this._affairImgText1.x=s.x+30,this._affairImgText1.y=GameConfig.stageHeigth-250,this._bottomnodeContainer1.addChild(this._affairImgText1);var r=BaseBitmap.create("affairview_zibg");r.x=360,r.y=s.y,r.name="2",r.touchEnabled=!0,this._bottomnodeContainer1.addChild(r),r.addTouch(this.eventHandler,this),this._affairTouchImg2=r;var l=BaseBitmap.create("public_9_bg30");l.width=200,l.x=5,l.y=r.y+100,l.visible=!1,this._bottomnodeContainer1.addChild(l),this._affair_rewardbg1=l,this._rewardText1=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL),this._rewardText1.width=200,this._rewardText1.textAlign="center",this._rewardText1.x=l.x+45,this._rewardText1.y=l.y+22,this._bottomnodeContainer1.addChild(this._rewardText1);var h=BaseBitmap.create("public_9_bg30");h.width=l.width,h.x=440,h.y=l.y,h.visible=!1,this._bottomnodeContainer1.addChild(h),this._affair_rewardbg2=h,this._rewardText2=ComponentManager.getTextField("",this._rewardText1.size),this._rewardText2.x=425,this._rewardText2.y=h.y+22,this._bottomnodeContainer1.addChild(this._rewardText2),this._affairImgText2=ComponentManager.getTextField("",this._affairImgText1.size,this._affairImgText1.textColor),this._affairImgText2.width=this._affairImgText1.width-5,this._affairImgText2.x=390,this._affairImgText2.y=this._affairImgText1.y,this._bottomnodeContainer1.addChild(this._affairImgText2),this.showDialogue(),this.initButtomContainer(),this.checkAffairNum()},e.prototype.showDialogue=function(){this._bubbleContainer=new BaseDisplayObjectContainer,this._nodeContainer.addChild(this._bubbleContainer),this._bubbleContainer.y=GameConfig.stageHeigth-960,this._dialogueBg=BaseBitmap.create("public_9_bg42"),this._bubbleContainer.addChild(this._dialogueBg),this._dialogueBg.width=300,this._dialogueBg.height=100,this._dialogueBg.x=290,this._dialogueBg.y=200,this._dialogueBg2=BaseBitmap.create("public_9_bg42_tail"),this._bubbleContainer.addChild(this._dialogueBg2),this._dialogueBg2.x=this._dialogueBg.x+50,this._dialogueBg2.y=this._dialogueBg.y+this._dialogueBg.height-5,this._prisonDesTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN),this._prisonDesTxt.width=this._dialogueBg.width-18,this._prisonDesTxt.setPosition(this._dialogueBg.x+10,this._dialogueBg.y+20),this._bubbleContainer.addChild(this._prisonDesTxt)},e.prototype.checkAffairNum=function(){this.refreshUIInfo(),Api.manageVoApi.getCurAffairNums()>0?(this._bottomnodeContainer1.visible=!0,this._bottomnodeContainer2.visible=!1,this._noAffairTipText.text="",this._bubbleContainer.visible=!0,this._bottomBg.visible=!1,this._pubTextbg.visible=!1):(this._bottomBg.visible=!0,this._bottomnodeContainer1.visible=!1,this._bottomnodeContainer2.visible=!0,this._timesText.text="",this._noAffairTipText.visible=!0,this._bubbleContainer.visible=!1,this._pubTextbg.visible=!0)},e.prototype.initButtomContainer=function(){var t=BaseBitmap.create("public_tipbg");t.x=0,t.y=360,t.height=160,this._pubTextbg=t,this._nodeContainer.addChild(t),this._noAffairTipText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._noAffairTipText.textAlign=egret.HorizontalAlign.CENTER,this._noAffairTipText.text="",this._noAffairTipText.x=GameConfig.stageWidth/2-this._noAffairTipText.width/2,this._noAffairTipText.y=400,this._nodeContainer.addChild(this._noAffairTipText);var i=BaseBitmap.create("public_line3");i.width=450,i.x=GameConfig.stageWidth/2-i.width/2,i.y=this._bottomInfoY+30,this._bottomnodeContainer2.addChild(i);var a=new BaseTextField;a.size=TextFieldConst.FONTSIZE_TITLE_SMALL,a.textColor=TextFieldConst.COLOR_BLACK,a.text=LanguageManager.getlocal("itemName_"+e.ITEMID),a.x=GameConfig.stageWidth/2-a.width/2,a.y=i.y+i.height/2-a.height/2,this._bottomnodeContainer2.addChild(a);var n=BaseBitmap.create("itembg_2");n.x=50,n.y=i.y+i.height+10,this._bottomnodeContainer2.addChild(n);var o=Config.ItemCfg.getItemCfgById(e.ITEMID);o||(o=GameData.getRewardItemVoByIdAndType(e.ITEMID));var s=GameData.getItemIcon(o,!0);s.width=s.height=100,s.x=n.x+n.width/2-s.width/2,s.y=n.y+n.height/2-s.height/2,this._bottomnodeContainer2.addChild(s),this._numTextF=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._numTextF.text=LanguageManager.getlocal("numTitle")+Api.itemVoApi.getItemNumInfoVoById(e.ITEMID),this._numTextF.x=s.x+50-this._numTextF.width/2,this._numTextF.y=s.y+110,this._bottomnodeContainer2.addChild(this._numTextF);var r=BaseBitmap.create("public_9_bg21");r.width=420,r.height=124,r.y=i.y+i.height+10,r.x=GameConfig.stageWidth-450,this._bottomnodeContainer2.addChild(r);var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);l.text=LanguageManager.getlocal("itemDesc_"+e.ITEMID),l.x=r.x+10,l.width=r.width-20,l.y=r.y+10,this._bottomnodeContainer2.addChild(l);var h=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"useBtn",this.clickUseBtnHandler,this);h.x=GameConfig.stageWidth/2-h.width/2,h.y=310,h.setColor(TextFieldConst.COLOR_BLACK),this._bottomnodeContainer2.addChild(h)},e.prototype.refreshUIInfo=function(){var t=0,e=Config.LevelCfg.getCfgByLevel((Api.playerVoApi.getPlayerLevel()+1).toString());t=e?e.exp:Config.LevelCfg.getCfgByLevel(Api.playerVoApi.getPlayerLevel().toString()).exp,this._progressBar.setText(LanguageManager.getlocal("affairtxt")+Api.playerVoApi.getPlayerExp()+"/"+t);var i=Api.playerVoApi.getPlayerExp()/t;this._progressBar.setPercentage(i>1?1:i);var a=GameConfig.config.affairCfg.affairList[this._curoptId.toString()],n=GameConfig.config.affairCfg.getExp[Api.playerVoApi.getPlayerLevel()-1];this._prisonDesTxt.text=LanguageManager.getlocal("affairDesc"+this._curoptId,[String(n)]),console.log("this._prisonDesTxt.height->"+this._prisonDesTxt.height),this._prisonDesTxt.height>60&&(this._dialogueBg.height=this._prisonDesTxt.height+40,this._dialogueBg.y=200-this._prisonDesTxt.height+60,this._prisonDesTxt.y=this._dialogueBg.y+20),this._affairImgText1.text=LanguageManager.getlocal("affairOptDesc"+this._curoptId+"_1"),this._affairImgText2.text=LanguageManager.getlocal("affairOptDesc"+this._curoptId+"_2");var o=Config.LevelCfg.getCfgByLevel(Api.playerVoApi.getPlayerLevel().toString()).affair;this._timesText.text=LanguageManager.getlocal("affairEvent")+Api.manageVoApi.getCurAffairNums()+"/"+o,a.reward1?this._rewardText1.text=this.getRewardTxt(a.reward1,a):this._rewardText1.text=this.getRewardTxt(a.reward3,a);var s=GameConfig.config.affairCfg.getExp[Api.playerVoApi.getPlayerLevel()-1];this._rewardText2.text=LanguageManager.getlocal("affairtxt3",[String(s)])},e.prototype.getRewardTxt=function(t,e){if("string"==typeof t){var i=new RewardItemVo;return i.initData(t),LanguageManager.getlocal("affair_reward_txt",[i.name+"+"+i.num])}var a=e.base,n=t,o=e.parameter,s=Object.keys(o).length,r=Api.playerVoApi.getPlayerLevel(),l=o[r-1];return r>=s&&(l=o[s-1]),2==n?LanguageManager.getlocal("affair_reward_txt",[LanguageManager.getlocal("affair_rewardType1")+"+"+App.StringUtil.changeIntToText(Math.floor(Api.playerVoApi.getInte()*l+a))]):3==n?LanguageManager.getlocal("affair_reward_txt",[LanguageManager.getlocal("affair_rewardType2")+"+"+App.StringUtil.changeIntToText(Math.floor(Api.playerVoApi.getPolitics()*l+a))]):4==n?LanguageManager.getlocal("affair_reward_txt",[LanguageManager.getlocal("affair_rewardType3")+"+"+App.StringUtil.changeIntToText(Math.floor(Api.playerVoApi.getCharm()*l+a))]):void 0},e.prototype.uiTextDoRefreshAction=function(t){egret.Tween.get(t,{loop:!1}).to({alpha:0},500).set({alpha:0}).to({alpha:1},500)},e.prototype.uiBitMapDoRefreshAction=function(t){egret.Tween.get(t,{loop:!1}).to({alpha:0},500).to({alpha:1},500)},e.prototype.affairTouchImgClickCallBack=function(){this.createCollectFlag(),egret.Tween.get(this._collectFlag,{loop:!1}).to({scaleX:1,scaleY:1},300).call(function(){},this);var t=GameConfig.config.affairCfg.affairList[this._curoptId.toString()],e=[];if(2==this._lastOpt)e=GameData.formatRewardItem("5_0_"+GameConfig.config.affairCfg.getExp[Api.playerVoApi.getPlayerLevel()-1]);else{var i="",a=t.reward3;if(t.reward1){a=t.reward1;var n=t.parameter,o=Object.keys(n).length,s=Api.playerVoApi.getPlayerLevel(),r=n[s-1];s>=o&&(r=n[o-1]);var l=a;2==l?i+="2_0_"+Math.floor(Api.playerVoApi.getInte()*r+t.base):3==l?i+="3_0_"+Math.floor(Api.playerVoApi.getPolitics()*r+t.base):4==l&&(i+="4_0_"+Math.floor(Api.playerVoApi.getCharm()*r+t.base))}else i=t.reward3;e=GameData.formatRewardItem(i)}var h=new egret.Point(GameConfig.stageWidth/2,this._selectedBox.y+50);App.CommonUtil.playRewardFlyAction(e,h),this._curoptId=Api.manageVoApi.getCurAffairOpt(),0==Api.manageVoApi.getCurAffairNums()&&(this._noAffairTipText.visible=!1,this._pubTextbg.visible=!1);var d=this;egret.Tween.get(this,{loop:!1}).wait(800).call(function(){d.uiTextDoRefreshAction(d._affairImgText1),d.uiTextDoRefreshAction(d._affairImgText2),d.uiTextDoRefreshAction(d._rewardText1),d.uiTextDoRefreshAction(d._rewardText2),d.uiTextDoRefreshAction(this._bubbleContainer),d.uiBitMapDoRefreshAction(d._affairTouchImg1),d.uiBitMapDoRefreshAction(d._affairTouchImg2),d.uiBitMapDoRefreshAction(d._affair_rewardbg1),d.uiBitMapDoRefreshAction(d._affair_rewardbg2),d._collectFlag&&d._nodeContainer&&(d._nodeContainer.removeChild(d._collectFlag),d._collectFlag=null)}).wait(500).call(function(){d.checkAffairNum()})},e.prototype.clickUseBtnCallback=function(){var t=Api.itemVoApi.getItemNumInfoVoById(e.ITEMID);this._numTextF.text=LanguageManager.getlocal("numTitle")+t.toString(),this.checkAffairNum()},e.prototype.doUseRequest=function(t){App.CommonUtil.showTip(LanguageManager.getlocal("affair_useTip1",[String(t)])),NetManager.request(NetRequestConst.REQUEST_MANAGE_ADDAFFAIR,{num:t})},e.prototype.clickUseBtnHandler=function(){var t=Api.itemVoApi.getItemNumInfoVoById(e.ITEMID);if(0==t)return void ViewController.getInstance().openView(ViewConst.POPUP.ITEMJUMPPOPUPVIEW,{itemId:1102,callback:null,handler:this});if(t>=5){var i=Config.LevelCfg.getCfgByLevel(Api.playerVoApi.getPlayerLevel().toString()).affair;ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSEPOPUPVIEW,{itemId:e.ITEMID,maxNum:i,callback:this.doUseRequest,handler:this})}else this.doUseRequest(1)},e.prototype.affairTouchImgClick=function(t,e){var i=e;1==e&&GameConfig.config.affairCfg.affairList[this._curoptId.toString()].reward3&&(i=3),this._lastOpt=i,NetManager.request(NetRequestConst.REQUEST_MANAGE_DEALAFFAIR,{optid:i})},e.prototype.roleHeadClickHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.PLAYERVIEW)},e.prototype.addGoldBtnClickHandler=function(){},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["gov_icon","gov_img1",,"promotion_officerbg1","progress3","progress3_bg","affairview_bg","affairview_mark","affairview_zibg","affairview_zibg2","affairview_zhuozi"])},e.prototype.tick=function(){if(0==Api.manageVoApi.getCurAffairNums()){var t=GameData.serverTime,e=Api.manageVoApi.getAffairST()+GameConfig.config.affairCfg.needTime-t;return e>=0?(this._noAffairTipText.text=LanguageManager.getlocal("affair_cdTip",[App.DateUtil.getFormatBySecond(e).toString()]),this._noAffairTipText.x=GameConfig.stageWidth/2-this._noAffairTipText.width/2,!0):(Api.manageVoApi.setCurAffairNums(1),this.checkAffairNum(),!1)}return""!=this._noAffairTipText.text?(this.checkAffairNum(),!1):!1},e.prototype.eventHandler=function(t){var e=egret.getTimer()-this._lastUseTime;if(!(this._lastUseTime>0&&2500>e))switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:t.target.texture=ResourceManager.getRes("affairview_zibg2"),this._selectedBox=t.target;break;case egret.TouchEvent.TOUCH_CANCEL:this._selectedBox.texture=ResourceManager.getRes("affairview_zibg2"),this._lastUseTime=egret.getTimer();break;case egret.TouchEvent.TOUCH_END:this._lastUseTime=egret.getTimer(),this._nameType=t.target.name,t.target.texture=ResourceManager.getRes("affairview_zibg"),this.affairTouchImgClick(t.target,Number(t.target.name))}},e.prototype.createCollectFlag=function(){this._collectFlag||(this._collectFlag=BaseBitmap.create("affairview_mark"),this._collectFlag.anchorOffsetX=this._collectFlag.width/2,this._collectFlag.anchorOffsetY=this._collectFlag.height/2,"1"==this._nameType?this._collectFlag.x=130:this._collectFlag.x=500,this._collectFlag.scaleX=1.2,this._collectFlag.scaleY=1.2,this._collectFlag.y=GameConfig.stageHeigth-220,this._nodeContainer.addChild(this._collectFlag))},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_ADDAFFAIR),this.clickUseBtnCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_DEALAFFAIR),this.affairTouchImgClickCallBack,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_ITEM,this.clickUseBtnCallback,this),this._timesText=null,this._affairImgText1=null,this._affairImgText2=null,this._rewardText1=null,this._rewardText2=null,this.headImg=null,this._progressBar=null,this._numTextF=null,this._noAffairTipText=null,this._curoptId=null,this._affairTouchImg1=null,this._affairTouchImg2=null,this._nodeContainer=null,this._bottomnodeContainer1=null,this._bottomnodeContainer2=null,this._prisonDesTxt=null,this._dialogueBg=null,this._dialogueBg2=null,this._bubbleContainer=null,this._nameType=null,this._affair_rewardbg1=null,this._affair_rewardbg2=null,this._lastUseTime=0,t.prototype.dispose.call(this)},e.ITEMID=1102,e}(CommonView);__reflect(AffairView.prototype,"AffairView");var AllianceApplyPopupView=function(t){function e(){var e=t.call(this)||this;return e._curTabIdx=0,e._index=0,e._type="",e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_ALLIANCE_AGREEAPPLY,this.doApply,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_ALLIANCE_REFUSEAPPLY,this.doCancel,this),this._allianceVo=Api.allianceVoApi.getAllianceVo();var t=BaseBitmap.create("public_9_probiginnerbg");t.width=520,t.height=600,t.x=this.viewBg.width/2-t.width/2,t.y=60,this.addChildToContainer(t),this._soundText=ComponentManager.getTextField(LanguageManager.getlocal("allianceJoinTitle"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN),this._soundText.x=30,this._soundText.y=20,this.addChildToContainer(this._soundText),this._soundBB=BaseBitmap.create("btn_swicth"),this._soundBB.x=300,this._soundBB.y=this._soundText.y+this._soundText.height/2-this._soundBB.height/2,this.addChildToContainer(this._soundBB),this._soundBB.addTouchTap(this.sonndHander,this),this._soundState=ComponentManager.getTextField("ON",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW),this._soundState.x=this._soundBB.x+15,this._soundState.y=this._soundBB.y+this._soundBB.height/2-this._soundState.height/2,this.addChildToContainer(this._soundState);var e=TextFieldConst.COLOR_WARN_GREEN;0==this._allianceVo["switch"]?this._type="ON":this._type="OFF",""==this._type&&(this._type="ON"),"ON"!=this._type&&(this._soundBB.skewY=180,this._soundBB.x=this._soundBB.x+this._soundBB.width,this._soundState.x=370,e=11645361),this._soundState.text=this._type,this._soundState.textColor=e;var i=this._applyData,a=egret.Rectangle.create();a.setTo(0,0,t.width-10,t.height-70),this._scrollList=ComponentManager.getScrollList(AllianceApplyScrollItem,i,a),this.addChildToContainer(this._scrollList),this._scrollList.x=t.x+5,this._scrollList.y=t.y+10,this._scrollList.setEmptyTip(LanguageManager.getlocal("allianceApplyTip"));var n="";n=i.length?LanguageManager.getlocal("allianceApplyPopupApplyNum")+i.length:LanguageManager.getlocal("allianceApplyPopupApplyNum")+0,this._applyTxt=ComponentManager.getTextField(n,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN),this._applyTxt.x=t.x+20,this._applyTxt.y=t.y+t.height+30,this.addChildToContainer(this._applyTxt);var o=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"adultMarryRequestRefuseAll",this.refuseAllHandler,this);
o.x=t.x+t.width-o.width-30,o.y=t.y+t.height+12,this.addChildToContainer(o),o.setColor(TextFieldConst.COLOR_BLACK)},e.prototype.refuseAllHandler=function(){return this._scrollList.getItemByIndex(0)?void this.request(NetRequestConst.REQUEST_ALLIANCE_REFUSEALLAPPLY,{}):void App.CommonUtil.showTip(LanguageManager.getlocal("allianceApplyTip"))},e.prototype.sonndHander=function(t){var e=0,i=TextFieldConst.COLOR_WARN_GREEN;""==this._type||"ON"==this._type?this._type="OFF":this._type="ON","ON"!=this._type?(this._soundBB.skewY=180,this._soundBB.x=this._soundBB.x+this._soundBB.width,this._soundState.x=this._soundBB.x-50,i=11645361,e=1,App.CommonUtil.showTip(LanguageManager.getlocal("allianceJoinTip2"))):(this._soundBB.skewY=0,this._soundBB.x=this._soundText.x+this._soundText.width+10,this._soundState.x=this._soundBB.x+15,App.CommonUtil.showTip(LanguageManager.getlocal("allianceJoinTip1"))),this._soundState.text=this._type,this._soundState.textColor=i,this.request(NetRequestConst.REQUEST_ALLIANCE_SETSWITCH,{"switch":e})},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_ALLIANCE_GETALLIANCEAPPLY,requestData:{}}},e.prototype.receiveData=function(t){if(!(t.data.ret<0)){if(1==t.data.data.allianceFlag)return App.CommonUtil.showTip(LanguageManager.getlocal("allianceErrorMsg1")),void this.hide();if(2==t.data.data.allianceFlag)return App.CommonUtil.showTip(LanguageManager.getlocal("allianceErrorMsg2")),void this.hide();if(3==t.data.data.allianceFlag)return App.CommonUtil.showTip(LanguageManager.getlocal("allianceErrorMsg3")),void this.hide();t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_GETALLIANCEAPPLY&&(this._applyData=t.data.data.allianceapply),t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_ACCEPT&&(this._applyData=t.data.data.allianceapply,this._scrollList.refreshData(this._applyData)),t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_REFUSEAPPLY&&(this._applyData=t.data.data.allianceapply,this._scrollList.refreshData(this._applyData)),t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_REFUSEALLAPPLY&&(this._applyData=[],this._scrollList.refreshData(this._applyData),App.CommonUtil.showTip(LanguageManager.getlocal("allianceApplyTip2"))),t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_SETSWITCH;var e="";e=this._applyData&&this._applyData.length?LanguageManager.getlocal("allianceApplyPopupApplyNum")+this._applyData.length:LanguageManager.getlocal("allianceApplyPopupApplyNum")+0,this._applyTxt&&(this._applyTxt.text=e)}},e.prototype.doApply=function(t){var e=t.data;this._index=e.index,this.request(NetRequestConst.REQUEST_ALLIANCE_ACCEPT,{auid:t.data.uid})},e.prototype.doCancel=function(t){var e=t.data;this._index=e.index,this.request(NetRequestConst.REQUEST_ALLIANCE_REFUSEAPPLY,{auid:t.data.uid})},e.prototype.rankBtnClick=function(){},e.prototype.tabBtnClickHandler=function(t){this._curTabIdx=t.index,this.refreshRankList()},e.prototype.refreshRankList=function(){},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["dinner_rankbg","dinnerrankpopupview"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_ALLIANCE_APPLYALLIANCE,this.doApply,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_ALLIANCE_CANCELAPPLYALLIANCE,this.doCancel,this),this._scrollList=null,this._timeTF=null,this._selectChildData=null,this._allianceVo=null,this._index=null,this._soundBB=null,this._soundState=null,this._type="",this._selectChildData=null,this._curTabIdx=0,this._applyData=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceApplyPopupView.prototype,"AllianceApplyPopupView");var AllianceApplyScrollItem=function(t){function e(){var e=t.call(this)||this;return e._applyData=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=510,this.height=156+this.getSpaceY(),this._applyData=e,this._itemIndex=t;var i=BaseBitmap.create("public_9_bg14");i.width=this.width,i.height=156,this.addChild(i);var a=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);a.x=23,a.y=15,this.addChild(a);var n=BaseBitmap.create("public_line1");n.x=this.width/2-n.width/2,n.y=40,this.addChild(n);var o=new BaseDisplayObjectContainer;this.addChild(o),o.x=20,o.y=50;var s=BaseBitmap.create("public_chatheadbg");o.addChild(s);var r=egret.Rectangle.create();r.setTo(0,0,136,143);var l=BaseLoadBitmap.create(Api.playerVoApi.getUserHeadImgPathById(e.pic),r);l.x=0,l.y=-7,l.setScale(2/3),o.addChild(l),App.CommonUtil.addTouchScaleEffect(o,this.clickItemHandler,this);var h=LanguageManager.getlocal("mainui_shili")+e.power,d=ComponentManager.getTextField(h,18,TextFieldConst.COLOR_BROWN);d.x=120,d.y=a.y+a.height+14,this.addChild(d);var g=LanguageManager.getlocal("mainui_officer")+Api.playerVoApi.getPlayerOfficeByLevel(e.level),c=ComponentManager.getTextField(g,18,TextFieldConst.COLOR_BROWN);c.x=120,c.y=d.y+d.height+10,this.addChild(c);var p=ComponentManager.getButton(ButtonConst.BTN_SMALL_RED,"allianceApplyRefuse",this.refuseBtnClick,this);p.x=246,p.y=95,this.addChild(p),p.setColor(TextFieldConst.COLOR_BLACK);var _=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"allianceApplyAgree",this.chooseBtnClick,this);_.x=p.x+p.width+5,_.y=95,this.addChild(_),_.setColor(TextFieldConst.COLOR_BLACK)},e.prototype.userShotCallback=function(t){var e=t.data.data.data;ViewController.getInstance().openView(ViewConst.POPUP.RANKUSERINGOPOPUPVIEW,e),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_USERSHOT),this.userShotCallback,this)},e.prototype.clickItemHandler=function(t){this.showUserInfo()},e.prototype.showUserInfo=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_USERSHOT),this.userShotCallback,this),NetManager.request(NetRequestConst.REQUEST_RANK_USERSHOT,{ruid:this._applyData.uid})},e.prototype.refuseBtnClick=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_ALLIANCE_REFUSEAPPLY,{uid:this._applyData.uid})},e.prototype.chooseBtnClick=function(){var t=Api.allianceVoApi.getAllianceVo();return t.mn>=t.maxmn?void App.CommonUtil.showTip(LanguageManager.getlocal("allianceApplyMaxMn")):void App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_ALLIANCE_AGREEAPPLY,{uid:this._applyData.uid})},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._applyData=null,this._itemIndex=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AllianceApplyScrollItem.prototype,"AllianceApplyScrollItem");var AllianceBossAttackedPopupView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["dailybosslastattackpopupview","allianceboss_fight_text"])},e.prototype.initView=function(){this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f),this.addTouchTap(this.hide,this);var t=this.param.data;if(3==t.type){var e=ComponentManager.getTextField(LanguageManager.getlocal("allianceBossHasKill"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);return e.setPosition((this.viewBg.width-e.width)/2,38),void this.addChildToContainer(e)}var i,a,n=LanguageManager.getlocal("allianceBoss_monsterName"+t.index);1==t.type?(i="dailybosslastattacktitle",a=LanguageManager.getlocal("alliancebossattacked1",[n,n,String(t.damage)])):(i="allianceboss_fight_text",a=LanguageManager.getlocal("alliancebossattacked2",[n,String(t.damage)]));var o=BaseBitmap.create(i);o.setPosition((this.viewBg.width-o.width)/2,10),this.addChildToContainer(o);var s=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);s.textAlign=egret.HorizontalAlign.CENTER,s.width=480,s.lineSpacing=6,s.setPosition((this.viewBg.width-s.width)/2,o.y+o.height+18),this.addChildToContainer(s);var r=0;if(1==t.type){var l=GameData.formatRewardItem(t.rewards)[0],h=GameData.getItemIcon(l);h.setPosition((this.viewBg.width-h.width)/2,s.y+s.height+16),this.addChildToContainer(h),r=105}var d=ComponentManager.getTextField(LanguageManager.getlocal("allianceBuildGet3")+App.StringUtil.formatStringColor("+"+t.exp,TextFieldConst.COLOR_WARN_GREEN),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN);d.setPosition((this.viewBg.width-d.width)/2,s.y+s.height+r+30),this.addChildToContainer(d)},e.prototype.getTitleStr=function(){return null},e.prototype.getCloseBtnName=function(){return null},e.prototype.isTouchMaskClose=function(){return!0},e.prototype.getBgExtraHeight=function(){return 10},e.prototype.getBgName=function(){return"public_9_wordbg"},e.prototype.hide=function(){this._obj&&this._callbackF&&this._callbackF.apply(this._obj),t.prototype.hide.call(this)},e.prototype.dispose=function(){this._callbackF=null,this._obj=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceBossAttackedPopupView.prototype,"AllianceBossAttackedPopupView");var AllianceBossBattleView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e._idx=null,e._rewards=null,e._curKey=null,e._curValue=0,e._bossConfig=null,e._allServantInfo=null,e._dps=0,e._exp=0,e._bossValue=0,e._heroValue=0,e._isBattling=!1,e._hasKill=0,e._moreArrow=null,e._isShowMore=!1,e.touchBoo=!0,e._nameTxt=null,e._describeTxt=null,e.moveContainer=null,e._currMaskBmp=null,e._touchBg=null,e.moreBg=null,e.bottom=null,e._isRefresh=!1,e._bossInfoVoList=[],e}return __extends(e,t),e.prototype.getResourceList=function(){var e=t.prototype.getResourceList.call(this);return e.concat(["alliancebossbg",ButtonConst.BATTLE_START_BTN_1,"allianceboss_down","progress8","progress7_bg"])},e.prototype.getBgName=function(){return"alliancebossbg"},e.prototype.getTitleStr=function(){return"allianceBossPopupViewTitle"},e.prototype.resetTopKey=function(){var t=this;if(null==this._allServantInfo){this._allServantInfo={};var e=Api.servantVoApi.getServantInfoIdListWithSort(1);for(var i in e){var a=e[i];this._allServantInfo[a]=Api.servantVoApi.getServantCombatWithId(a)}}this._curKey=null,this._heroValue=0;var n=Object.keys(this._allServantInfo);n.sort(function(e,i){var a=Api.allianceVoApi.getServantInfoValue(e),n=Api.allianceVoApi.getServantInfoValue(i);return a==n?Number(t._allServantInfo[i]-t._allServantInfo[e]):Number(a-n)}),0==Api.allianceVoApi.getServantInfoValue(n[0])&&(this._curKey=n[0],this._heroValue=this._allServantInfo[this._curKey])},e.prototype.initView=function(){var t=BaseBitmap.create("arena_bottom");this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f);var e=BaseBitmap.create("allianceboss_down");e.y=GameConfig.stageHeigth-this.getTitleButtomY()-e.height-75,this.addChildToContainer(e),this._idx=this.param.data.idx,this._bossConfig=Config.AlliancebossCfg.getAllianceCfgByLv(this._idx),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ALLIANCE_ATTACK),this.intoBossBattle,this),this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f),this._bossValue=this._bossConfig.bossHp;var i=Api.allianceVoApi.getBossHp(this._idx);this.resetTopKey(),this.setTopProgress(i,this._bossValue,GameConfig.stageWidth-100,2),this._topProgress.y=0;var a="alliance_monster"+this._bossConfig.bossPic;this.setUpHero(a,null,2),this._upHero.x=GameConfig.stageWidth/2-this._upHero.width/2;var n=null,o=null;if(this._curKey){n="servant_full_"+this._curKey;var s=this._allServantInfo[this._curKey];o=[[LanguageManager.getlocal("fightForce")+":"+s,TextFieldConst.COLOR_LIGHT_YELLOW],[LanguageManager.getlocal("clickChooseServant")]]}else n="servant_empty",o=[["empty",TextFieldConst.COLOR_LIGHT_YELLOW],[LanguageManager.getlocal("clickChooseServant")]];this.setDownHero(n,o,2),this._downHero.x=GameConfig.stageWidth/2-this._downHero.width/2,this._downHero.y=GameConfig.stageHeigth-this._downHero.height-100,this._upPositon=egret.Point.create(this._upHero.x,this._upHero.y),this._downPositon=egret.Point.create(this._downHero.x,this._downHero.y),this._downHero.addTouchTap(this.clickChangeHero,this);var r=BaseBitmap.create("public_itemtipbg2");this.addChildToContainer(r);var l=ComponentManager.getTextField(LanguageManager.getlocal("allianceBoss_monsterName"+this._idx),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);l.setPosition(GameConfig.stageWidth/2-l.width/2,this._topProgress.y+33),this.addChildToContainer(l),r.width=l.width+30,r.setPosition(GameConfig.stageWidth/2-r.width/2,l.y+l.height/2-15),this._gameBtn=ComponentManager.getButton(ButtonConst.BATTLE_START_BTN_1,null,this.btnClick,this),this._gameBtn.setPosition(GameConfig.stageWidth/2,GameConfig.stageHeigth/2-20),this._gameBtn.anchorOffsetX=this._gameBtn.width/2,this._gameBtn.anchorOffsetY=this._gameBtn.height/2,this.addChild(this._gameBtn),this.btnAnim(),null==this._curKey&&(this._gameBtn.visible=!1),t.y=GameConfig.stageHeigth-t.height,this.addChild(t),this.bottom=t,this.requestGetBossLog(),this._isRefresh=!1,App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_ALLIANCE,this.requestGetBossLog,this);var h=ComponentManager.getButton("arena_more",null,this.showMoreHandle,this);h.setPosition(515,GameConfig.stageHeigth-52),this.addChild(h),this._moreArrow=BaseBitmap.create("arena_arrow"),this._moreArrow.setPosition(480,911),this.addChild(this._moreArrow)},e.prototype.requestGetBossLog=function(){this._isRefresh=!0,App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ALLIANCE_GETBOSSLOG),this.showBossLog,this),null!=this._idx&&NetManager.request(NetRequestConst.REQUEST_ALLIANCE_GETBOSSLOG,{bossId:this._idx})},e.prototype.showBossLog=function(t){var e=t.data.data;0==e.ret&&(this._bossInfoVoList=e.data.allianceBossLog,this._isRefresh||this.showText())},e.prototype.showMoreHandle=function(){this.touchBoo&&(this._isShowMore=!this._isShowMore,1==this._isShowMore?(this._moreArrow.scaleY=-1,this._moreArrow.y+=this._moreArrow.height,this.showList()):(this._moreArrow.scaleY=1,this._moreArrow.y-=this._moreArrow.height,this.closeList()))},e.prototype.closeList=function(){this.touchBoo=!1,this.moveContainer&&egret.Tween.get(this.moveContainer).to({y:1150},500).call(function(){this.touchBoo=!0,egret.Tween.removeTweens(this.moveContainer)},this),this._currMaskBmp&&this._currMaskBmp.parent&&(this._currMaskBmp.parent.removeChild(this._currMaskBmp),this._currMaskBmp.dispose(),this._currMaskBmp=null),this._touchBg&&this._touchBg.parent&&(this._touchBg.parent.removeChild(this._touchBg),this._touchBg.dispose(),this._touchBg=null)},e.prototype.clickChangeHero=function(){if(1!=this._isBattling){var t=Object.keys(this._allServantInfo),e=[];for(var i in t){var a=t[i];e.push([a,Api.allianceVoApi.getServantInfoValue(a),this._allServantInfo[a]])}e.sort(function(t,e){var i=t[1],a=e[1];return i==a?Number(e[2]-t[2]):Number(i-a)}),ViewController.getInstance().openView(ViewConst.POPUP.SERVANTSELECTEDPOPUPVIEW,{type:ServantSelectedPopupView.TYPE_ALLIANCE,info:e,callback:this.sendRequest,handler:this})}},e.prototype.sendRequest=function(t){var e=t.key;if(e!=this._curKey){this._curKey=e;var i=Api.servantVoApi.getServantObj(e);this._downHero.resetHero("servant_full_"+i.servantId,this._allServantInfo[e]),this._gameBtn.visible=!0}},e.prototype.btnClick=function(){NetManager.request(NetRequestConst.REQUEST_ALLIANCE_ATTACK,{servantId:this._curKey,bossId:this._idx})},e.prototype.btnAnim=function(){this._gameBtn&&egret.Tween.get(this._gameBtn).to({scaleX:.9,scaleY:.9},600).to({scaleX:1,scaleY:1},600).call(this.btnAnim,this)},e.prototype.intoBossBattle=function(t){if(1==t.data.ret){if(SoundManager.playEffect(SoundConst.EFFECT_BATTLE_START),this._hasKill=t.data.data.data.hasKill,1==this._hasKill)return void ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCEBOSSATTACKEDPOPUPVIEW,{type:3,f:this.hide,o:this});this._rewards=t.data.data.data.bossInfo.rewards,this._isAttackWin=t.data.data.data.bossInfo.killFlag,this._dps=t.data.data.data.bossInfo.damage,this._exp=t.data.data.data.bossInfo.ctv,this._isBattling=!0,this._gameBtn.visible=!1,this.gameBegin()}},e.prototype.gameBegin=function(){this.attackHandle(1,this._dps)},e.prototype.attackHandle=function(t,e,i){if(1!=this._isMoving){this._isMoving=!0,this._heroArray.length=0,this._damage=e,this._area=t;var a,n,o,s=.75;1==t?(this._heroArray=[this._downHero,this._upHero],a=50,n=this._upHero.y+100,o=a*(this._downHero.x-this._upHero.x)/(this._downHero.y-this._upHero.y)):(this._heroArray=[this._upHero,this._downHero],a=-50,n=this._downHero.y-100+this._downHero.height*(1-s),o=a*(this._downHero.x-this._upHero.x)/(this._downHero.y-this._upHero.y)),this.container.getChildIndex(this._heroArray[0])<this.container.getChildIndex(this._heroArray[1])&&this.container.swapChildren(this._heroArray[0],this._heroArray[1]);var r=0,l=60,h=260,d=egret.Point.create(this._heroArray[1].x+(1-s)*this._heroArray[0].width/2,n),g=1.06;egret.Point.create(this._heroArray[0].x-(g-1)*this._heroArray[0].width/2,this._heroArray[0].y-(g-1)*this._heroArray[0].height/2);egret.Tween.get(this._heroArray[0]).wait(r).to({y:this._heroArray[0].y+(1==t?20:-20)},300).to({y:d.y},l).to({y:this._heroArray[0].y},h),TimerManager.doTimer(r+300+l,1,this.showBeAttackAnim,this)}},e.prototype.showEndGame=function(){},e.prototype.atkEndCallback=function(){if(this._isAttackWin)ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCEBOSSATTACKEDPOPUPVIEW,{type:1,index:this._idx,damage:this._dps,exp:this._exp,rewards:this._rewards,f:this.hide,o:this});else if(ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCEBOSSATTACKEDPOPUPVIEW,{type:2,index:this._idx,damage:this._dps,exp:this._exp}),this._isBattling=!1,this.closeBtn.setEnable(!0),this.resetTopKey(),this._curKey){var t=Api.servantVoApi.getServantObj(this._curKey);this._downHero.resetHero("servant_full_"+t.servantId,this._allServantInfo[this._curKey]),TimerManager.doTimer(100,1,this.showGameBtn,this)}else this._downHero.resetHero();this._isRefresh&&this.refreshText()},e.prototype.showGameBtn=function(){this._gameBtn&&(this._gameBtn.visible=null!=this._curKey)},e.prototype.hide=function(){Api.playerVoApi.getPlayerAllianceId()>0&&this._obj&&this._callbackF&&this._callbackF.apply(this._obj),t.prototype.hide.call(this)},e.prototype.showList=function(){if(this.moveContainer=new BaseDisplayObjectContainer,this.addChild(this.moveContainer),this.moreBg=BaseBitmap.create("arena_bottom_bg"),this.moreBg.width=640,this.moreBg.height=GameConfig.stageHeigth-330,this.moveContainer.addChild(this.moreBg),this._currMaskBmp=BaseBitmap.create("public_9_viewmask"),this._currMaskBmp.width=GameConfig.stageWidth,this._currMaskBmp.height=GameConfig.stageHeigth,this._currMaskBmp.touchEnabled=!0,this.addChild(this._currMaskBmp),this.setChildIndex(this._currMaskBmp,this.getChildIndex(this._gameBtn)),this._touchBg=BaseBitmap.create("public_9_bg25"),this._touchBg.width=640,this._touchBg.height=260,this._touchBg.x=0,this._touchBg.y=-240,this._touchBg.alpha=0,this._touchBg.addTouchTap(this.showMoreHandle,this),this.moveContainer.addChild(this._touchBg),this._bossInfoVoList&&this._bossInfoVoList.length>0){var t=egret.Rectangle.create();t.setTo(0,10,640,GameConfig.stageHeigth-340),this._scrollList=ComponentManager.getScrollList(AllianceBossMoreItem,this._bossInfoVoList,t),this.moveContainer.addChild(this._scrollList),this._scrollList.y=5}else{var e=ComponentManager.getTextField(LanguageManager.getlocal("atkracedes3"),20);e.x=250,e.y=300,this.moveContainer.addChild(e)}this.moveContainer.y=1150,this.touchBoo=!1,egret.Tween.get(this.moveContainer).to({y:260},500).call(function(){egret.Tween.removeTweens(this.moveContainer),this.touchBoo=!0},this)},e.prototype.showText=function(){if(this._bossInfoVoList&&this._bossInfoVoList.length>=1){var t=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);t.text=this._bossInfoVoList[0].name,t.x=20,t.y=GameConfig.stageHeigth-67,this.addChild(t),this._nameTxt=t;var e=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL),i=Config.ServantCfg.getServantItemById(this._bossInfoVoList[0].servantId).name,a=LanguageManager.getlocal("alliancelogdes13",[i,this._bossInfoVoList[0].dps]);e.x=20,e.y=GameConfig.stageHeigth-40,e.height=16,e.text=a,this._describeTxt=e,this.addChild(e)}},e.prototype.refreshText=function(){if(this._nameTxt&&this._bossInfoVoList.length>1&&this._describeTxt){this._nameTxt.text=this._bossInfoVoList[0].name;var t=Config.ServantCfg.getServantItemById(this._bossInfoVoList[0].servantId).name;this._describeTxt.text=LanguageManager.getlocal("alliancelogdes13",[t,this._bossInfoVoList[0].dps])}else this.showText()},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ALLIANCE_ATTACK),this.intoBossBattle,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ALLIANCE_GETBOSSLOG),this.showBossLog,this),this._bossConfig=null,this._callbackF=null,this._obj=null,this._rewards=null,this._curKey=null,this._isBattling=!1,this._gameBtn=null,this._isAttackWin=null,this._allServantInfo=null,this._dps=0,this._idx=null,this._exp=0,this._hasKill=0,this._isRefresh=!1,this._bossInfoVoList=null,this.bottom=null,this._moreArrow=null,this._isShowMore=!1,this.touchBoo=!0,this._nameTxt=null,this._describeTxt=null,this.moveContainer=null,this._currMaskBmp=null,this._scrollList=null,this.moreBg=null,t.prototype.dispose.call(this)},e}(BaseBattleView);__reflect(AllianceBossBattleView.prototype,"AllianceBossBattleView");var AllianceBossMoreItem=function(t){function e(){var e=t.call(this)||this;return e.uid=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){var i=BaseBitmap.create("public_9_bg25");i.width=640,i.height=124,i.x=0,i.y=0,this.addChild(i),i.visible=!1;var a=BaseBitmap.create("rankinglist_line");a.y=128,a.x=15,this.addChild(a);var n=BaseBitmap.create("rankinglist_rankbg");n.x=50-n.width/2-20,n.y=15,this.addChild(n);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);o.text=String(t+1),o.x=50-o.width/2-20,o.y=20,this.addChild(o);var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);s.text=e.name,s.x=n.x+50,s.y=20,this.addChild(s);var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);r.text=App.DateUtil.getFormatBySecond(e.time,2),r.x=s.x,r.y=98,this.addChild(r);var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);l.width=450,l.x=s.x,l.y=50,l.lineSpacing=3,this.addChild(l);var h="",d=Config.ServantCfg.getServantItemById(e.servantId).name;h=LanguageManager.getlocal("alliancelogdes13",[d,e.dps]),l.text=h},e.prototype.getSpaceY=function(){return 1},e.prototype.getSpaceX=function(){return 0},e.prototype.dispose=function(){this.uid=0,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AllianceBossMoreItem.prototype,"AllianceBossMoreItem");var AllianceBossOpenPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ALLIANCE_OPENBOSS),this.openBtnHandlerCallBack,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var t=LanguageManager.getlocal("allianceBoss_monsterName"+this.param.data);this._topTipTF=ComponentManager.getTextField(LanguageManager.getlocal("allianceBossOpen_tip",[t]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN),this._topTipTF.x=30,this._topTipTF.y=20,this._nodeContainer.addChild(this._topTipTF);var e=BaseBitmap.create("public_9_bg4");e.width=520,e.height=290,e.x=this.viewBg.width/2-e.width/2,e.y=this._topTipTF.x+20,this._nodeContainer.addChild(e);for(var i=Config.AlliancebossCfg.getAllianceCfgByLv(this.param.data),a=[{iconStr:"1_0_0",txt1:LanguageManager.getlocal("allianceBossOpen_txt1"),txt2:LanguageManager.getlocal("allianceBossOpen_txt2",[String(i.needAsset)]),txt3:LanguageManager.getlocal("allianceBossOpen_txt3",[String(Api.allianceVoApi.getAllianceVo().wealth)])},{iconStr:"1_0_0",txt1:LanguageManager.getlocal("allianceBossOpen_txt4"),txt2:LanguageManager.getlocal("allianceBossOpen_txt5",[String(i.needGem)]),txt3:LanguageManager.getlocal("allianceBossOpen_txt6",[String(Api.playerVoApi.getPlayerGem())])}],n=e.x+10,o=e.y+10,s=0;s<a.length;s++){var r=a[s],l=BaseBitmap.create("public_9_probiginnerbg");l.width=500,l.height=126,l.y=o,l.x=n,this._nodeContainer.addChild(l),o+=l.height+10;var h=GameData.getRewardItemIcons(r.iconStr)[0];h.x=l.x+10,h.y=l.y+10,this._nodeContainer.addChild(h);var d=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"useBtn",this.openBtnHandler,this,[s+1]);d.x=l.x+l.width-d.width-20,d.y=l.y+l.height/2-d.height/2,this._nodeContainer.addChild(d);for(var g=h.x+h.width+10,c=h.y,p=1;3>=p;p++){var _=ComponentManager.getTextField(r["txt"+p],20);_.x=g,_.y=c,c+=_.height+10,this._nodeContainer.addChild(_),2==p&&(0==s&&i.needAsset>Api.allianceVoApi.getAllianceVo().wealth&&(_.text=LanguageManager.getlocal("allianceBossOpen_txt2_1",[String(i.needAsset)])),1==s&&i.needGem>Api.playerVoApi.getPlayerGem()&&(_.text=LanguageManager.getlocal("allianceBossOpen_txt5_1",[String(i.needGem)])))}}},e.prototype.openBtnHandlerCallBack=function(t){var e=t.data.data;return 1==e.data.allianceFlag?(App.CommonUtil.showTip(LanguageManager.getlocal("allianceErrorMsg1")),void this.hide()):void(0==e.ret&&(App.CommonUtil.showTip(LanguageManager.getlocal("allianceBossOpen_tip6")),this.hide()))},e.prototype.openBtnHandler=function(t){var e=Api.allianceVoApi.getMyAllianceVo(),i=Api.allianceVoApi.getAllianceVo(),a=Config.AlliancebossCfg.getAllianceCfgByLv(this.param.data);if(1==t){if(e.po>2)return void App.CommonUtil.showTip(LanguageManager.getlocal("allianceBossOpen_tip2"));if(i.wealth<a.needAsset)return void App.CommonUtil.showTip(LanguageManager.getlocal("allianceBossOpen_tip3"))}else{if(e.po>3)return void App.CommonUtil.showTip(LanguageManager.getlocal("allianceBossOpen_tip4"));if(Api.playerVoApi.getPlayerGem()<a.needGem)return void App.CommonUtil.showTip(LanguageManager.getlocal("allianceBossOpen_tip5"))}NetManager.request(NetRequestConst.REQUEST_ALLIANCE_OPENBOSS,{bossId:this.param.data,openType:t})},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ALLIANCE_OPENBOSS),this.openBtnHandlerCallBack,this),this._nodeContainer=null,this._topTipTF=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceBossOpenPopupView.prototype,"AllianceBossOpenPopupView");var AllianceBossPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ALLIANCE_GETBOSSLOG),this.showBossLog,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer),this._topTipTF=ComponentManager.getTextField(LanguageManager.getlocal("allianceBoss_tip1"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN),this._topTipTF.x=this.viewBg.width/2-this._topTipTF.width/2,this._topTipTF.y=20,this._nodeContainer.addChild(this._topTipTF);for(var t=Config.AlliancebossCfg.getAllainceCfgIdList(),e=Api.allianceVoApi.getAllianceVo(),i=e.level,a=[],n=0;n<t.length;n++)Config.AlliancebossCfg.getAllianceCfgByLv(t[n]).needAllianceLv<=i&&a.push(t[n]);var o=egret.Rectangle.create();o.setTo(0,0,this.viewBg.width,690),this._scrollList=ComponentManager.getScrollList(AllianceBossScrollItem,a,o),this._scrollList.x=25,this._scrollList.y=this._topTipTF.y+30,this._nodeContainer.addChild(this._scrollList),this._scrollList.setEmptyTip(LanguageManager.getlocal("allianceApplyTip"));var s=ComponentManager.getTextField(LanguageManager.getlocal("allianceBoss_tip2"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);s.x=this.viewBg.width/2-s.width/2,s.y=this._scrollList.y+o.height+10,this._nodeContainer.addChild(s)},e.prototype.showBossLog=function(t){var e=t.data.data;0==e.ret},e.prototype.getShowHeight=function(){return 850},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([,"searchbinfowifebg","progress5","progress3_bg","alliance_effect","allianceBossbg"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ALLIANCE_GETBOSSLOG),this.showBossLog,this),this._scrollList=null,this._nodeContainer=null,this._topTipTF=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceBossPopupView.prototype,"AllianceBossPopupView");var AllianceBossRankPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this._bossId=this.param.data,App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ALLIANCE_GETBOSSRANK),this.netCallBack,this),NetManager.request(NetRequestConst.REQUEST_ALLIANCE_GETBOSSRANK,{bossId:this._bossId}),this._nodeContainer=new BaseDisplayObjectContainer,this._nodeContainer.height=800,this.addChildToContainer(this._nodeContainer);var t=20;this._topTipTF=ComponentManager.getTextField("haha",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN),this._topTipTF.x=30,this._topTipTF.y=t,this._topTipTF.visible=!1,this._nodeContainer.addChild(this._topTipTF),t+=30;var e=BaseBitmap.create("public_9_bg32");e.width=520,e.height=665,e.x=this.viewBg.width/2-e.width/2,e.y=t,this._nodeContainer.addChild(e),e.name="bg1";var i=BaseBitmap.create("public_9_bg33");i.width=e.width,i.height=40,i.x=e.x,i.y=e.y,this._nodeContainer.addChild(i),i.name="bg2";var a=BaseBitmap.create("public_9_bg1");a.width=e.width,a.height=100,a.x=e.x,a.y=e.y+e.height+9,this._nodeContainer.addChild(a),a.name="bg3"},e.prototype.initContentAfterNet=function(t){var e=this._nodeContainer.getChildByName("bg1"),i=this._nodeContainer.getChildByName("bg2"),a=this._nodeContainer.getChildByName("bg3"),n=ComponentManager.getTextField(LanguageManager.getlocal("allianceBossRank_title1"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);n.x=i.x+30,n.y=i.y+8,this._nodeContainer.addChild(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("allianceBossRank_title2"),n.size,TextFieldConst.COLOR_LIGHT_YELLOW);o.x=i.x+220,o.y=n.y,this._nodeContainer.addChild(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("allianceBossRank_title4"),n.size,TextFieldConst.COLOR_LIGHT_YELLOW);s.x=i.x+450-s.width/2,s.y=n.y,this._nodeContainer.addChild(s);var r=Config.AlliancebossCfg.getAllianceCfgByLv(this._bossId),l=LanguageManager.getlocal("allianceBoss_monsterName"+this._bossId),h=t.allianceBosskill;h.length>0?this._topTipTF.text=LanguageManager.getlocal("allianceBossRank_topTip",[h[1],l,String(r.addAsset),String(r.addExp)]):this._topTipTF.text=LanguageManager.getlocal("allianceBossRank_topTip",["",l,String(r.addAsset),String(r.addExp)]),this._topTipTF.x=this.viewBg.width/2-this._topTipTF.width/2,this._topTipTF.visible=!0;var d=t.allianceBossRank,g=Api.playerVoApi.getPlayerName(),c=[LanguageManager.getlocal("atkracedes4"),"0","0"];for(var p in d)if(d[p][0]==g){c[0]=String(Number(p)+1),c[1]=d[p][1],c[2]=d[p][2];break}var _=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);_.text=LanguageManager.getlocal("allianceBossRank_title5",[Api.playerVoApi.getPlayerName()]),_.x=a.x+20,_.y=a.y+20,this._nodeContainer.addChild(_);var u=ComponentManager.getTextField("",_.size,TextFieldConst.COLOR_LIGHT_YELLOW);
u.text=LanguageManager.getlocal("allianceBossRank_title6",[c[0]]),u.x=u.x+320,u.y=_.y,this._nodeContainer.addChild(u);var C=ComponentManager.getTextField("",_.size,TextFieldConst.COLOR_LIGHT_YELLOW);C.text=LanguageManager.getlocal("allianceBossRank_title7",[c[2]]),C.x=_.x,C.y=_.y+40,this._nodeContainer.addChild(C);var f=ComponentManager.getTextField("",_.size,TextFieldConst.COLOR_LIGHT_YELLOW);f.text=LanguageManager.getlocal("allianceBossRank_title8",[c[1]]),f.x=u.x,f.y=C.y,this._nodeContainer.addChild(f);var m=new egret.Rectangle(0,0,this.viewBg.width,e.height-60),T=ComponentManager.getScrollList(AllianceBossRankScrollItem,d,m);T.setEmptyTip(LanguageManager.getlocal("allianceBossRank_emptyTip")),T.y=i.y+50,this._nodeContainer.addChild(T)},e.prototype.netCallBack=function(t){var e=t.data.data;0==e.ret&&this.initContentAfterNet(e.data)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([,"searchbinfowifebg","progress5","progress3_bg","alliance_effect"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ALLIANCE_GETBOSSRANK),this.netCallBack,this),this._scrollList=null,this._nodeContainer=null,this._topTipTF=null,this._bossId=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceBossRankPopupView.prototype,"AllianceBossRankPopupView");var AllianceBossRankScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.height=52,this._nodeContainer=new BaseDisplayObjectContainer,this.addChild(this._nodeContainer);var i=TextFieldConst.COLOR_BROWN;e[0]==Api.playerVoApi.getPlayerName()&&(i=TextFieldConst.COLOR_WARN_YELLOW);var a=16;if(t>2){var n=ComponentManager.getTextField("",20,i);n.text=String(t+1),n.x=75-n.width/2,n.y=a,this._nodeContainer.addChild(n)}else{var o=BaseLoadBitmap.create("rank_"+String(t+1));o.width=51,o.height=47,o.x=75-o.width/2,o.y=3,this.addChild(o)}var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,i);s.text=e[0],s.x=280-s.width/2,s.y=a,this._nodeContainer.addChild(s);var r=ComponentManager.getTextField("",s.size,i);r.text=String(e[1]),r.x=475-r.width/2,r.y=a,this._nodeContainer.addChild(r);var l=BaseLoadBitmap.create("rank_line");l.width=500,l.height=2,l.x=30,l.y=50,this._nodeContainer.addChild(l)},e.prototype.getSpaceX=function(){return 0},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){this._nodeContainer=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AllianceBossRankScrollItem.prototype,"AllianceBossRankScrollItem");var AllianceBossScrollItem=function(t){function e(){var e=t.call(this)||this;return e._bossCfgData=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ALLIANCE_OPENBOSS),this.openBtnHandlerCallBack,this),this._bossId=e,this._bossCfgData=Config.AlliancebossCfg.getAllianceCfgByLv(this._bossId);var i=BaseBitmap.create("allianceBossbg");this.addChild(i);var a=BaseLoadBitmap.create("alliance_monster"+this._bossCfgData.bossPic);a.width=405,a.height=467;var n=.5;a.setScale(n),a.x=132-a.width/2*n,a.y=i.height/2-a.height/2*n,this.addChild(a);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);o.textColor=16569930,o.text=LanguageManager.getlocal("allianceBoss_monsterName"+this._bossId),o.x=265,o.y=35,this.addChild(o);var s=ComponentManager.getTextField("",18);s.text=LanguageManager.getlocal("allianceBoss_rewardTxt"),s.x=o.x,s.y=o.y+30,this.addChild(s);var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);r.text=LanguageManager.getlocal("allianceBoss_rewardTxt2",[this._bossCfgData.addAsset,this._bossCfgData.addExp]),r.x=s.x+s.width,r.y=s.y,this.addChild(r);var l=ComponentManager.getButton(ButtonConst.BTN_SMALL_RED,"allianceBoss_btn1",this.rankBtnhandler,this);l.x=i.width-143-l.width,l.y=156,this.addChild(l),this._rankBtn=l,Api.switchVoApi.checkOpenShenhe()&&this._rankBtn&&(this._rankBtn.visible=!1);var h=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"allianceBoss_btn2",this.enterBtnhandler,this);h.x=i.width-143+5,h.y=156,this.addChild(h),this._enterBtn=h;var d=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"allianceBoss_btn3",this.logBtnhandler,this);d.x=i.width-143-d.width/2,d.y=156,this.addChild(d),this._logBtn=d,Api.switchVoApi.checkOpenShenhe()&&(this._logBtn.visible=!1);var g=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"allianceBoss_btn4",this.openBtnhandler,this);g.x=d.x,g.y=d.y,this.addChild(g),this._openBtn=g,this._cdTxt=ComponentManager.getTextField("",18),this._cdTxt.text=this.getEndStr(),this._cdTxt.x=i.width-148-this._cdTxt.width/2-10,this._cdTxt.y=this._openBtn.y+57,this._cdTxt.visible=!1,this.addChild(this._cdTxt);var c=ComponentManager.getProgressBar("progress5","progress3_bg",510);c.x=5,c.setText(LanguageManager.getlocal("allianceBoss_progressTxt1",["100"])),c.y=i.height-35,this._progress=c,this.addChild(c),this._mask=BaseBitmap.create("alliance_effect"),this._mask.width=i.width,this._mask.height=i.height,this._mask.visible=!1,this.addChild(this._mask);var p=GameData.serverTime-App.DateUtil.getWeeTs(GameData.serverTime);p>84600?(g.setEnable(!1),h.setEnable(!1)):(g.setEnable(!0),h.setEnable(!0)),TimerManager.doTimer(1e3,0,this.tick,this),this.refreshUI()},e.prototype.refreshUI=function(){var t=Api.allianceVoApi.getAllianceVo();if(this._cdTxt.visible=!1,this._leftHp=0,this._bossCfgData.needAllianceLv<=t.level){var e=t.boss,i=e[this._bossCfgData.id];if(this._leftHp=i,null!=i){this._openBtn.visible=!1;var a=i/this._bossCfgData.bossHp;this._progress.setPercentage(a),0==i?(this._mask.visible=!1,Api.switchVoApi.checkOpenShenhe()||(this._logBtn.visible=!0),this._rankBtn.visible=!1,this._enterBtn.visible=!1,this._progress.setText(LanguageManager.getlocal("allianceBoss_progressTxt2"))):(this._mask.visible=!0,this._logBtn.visible=!1,Api.switchVoApi.checkOpenShenhe()||(this._rankBtn.visible=!0),this._enterBtn.visible=!0,this._progress.setText(LanguageManager.getlocal("allianceBoss_progressTxt1",[(100*a).toFixed(0)+"%"])),this._cdTxt.visible=!0)}else this._progress.setText(LanguageManager.getlocal("allianceBoss_progressTxt1",["100%"])),this._progress.setPercentage(1),this._openBtn.visible=!0,this._logBtn.visible=!1,this._rankBtn.visible=!1,this._enterBtn.visible=!1,this._mask.visible=!1}else this._logBtn.visible=!1,this._enterBtn.visible=!1,this._rankBtn.visible=!1,this._openBtn.visible=!0},e.prototype.getEndStr=function(){var t=App.DateUtil.getWeeTs(GameData.serverTime)+84600-GameData.serverTime;if(t>=0){var e=App.DateUtil.getFormatBySecond(t,8);return LanguageManager.getlocal("allianceBoss_endTimeStr",[e])}return""},e.prototype.tick=function(){var t=this.getEndStr();return""!=t&&this._leftHp>0?(this._cdTxt.text=this.getEndStr(),this._cdTxt.visible=!0,!0):(this._cdTxt.visible=!1,!1)},e.prototype.openBtnHandlerCallBack=function(t){var e=t.data.data;0==e.ret&&this.refreshUI()},e.prototype.openBtnhandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCEBOSSOPENPOPUPVIEW,this._bossId)},e.prototype.rankBtnhandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCEBOSSRANKOPUPVIEW,this._bossId)},e.prototype.enterBtnhandler=function(){ViewController.getInstance().openView(ViewConst.BATTLE.ALLIANCEBOSSBATTLEVIEW,{idx:this._bossId,f:this.refreshUI,o:this})},e.prototype.logBtnhandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCEBOSSRANKOPUPVIEW,this._bossId)},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ALLIANCE_OPENBOSS),this.openBtnHandlerCallBack,this),TimerManager.remove(this.tick,this),this._bossCfgData=null,this._bossId=null,this._mask=null,this._logBtn=null,this._enterBtn=null,this._rankBtn=null,this._openBtn=null,this._progress=null,this._cdTxt=null,this._leftHp=0,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AllianceBossScrollItem.prototype,"AllianceBossScrollItem");var AllianceBossSelectScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.recoveryHandler=function(){App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_ALLIANCE_RECOVER,this.refresh,this),NetManager.request(NetRequestConst.REQUEST_ALLIANCE_RECOVER,{servantId:this._servantInfo[0]})},e.prototype.refresh=function(t){var e=t.data;if(e.ret){if(App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_ALLIANCE_RECOVER,this.refresh,this),this._useBtn){var i=this._useBtn,a=i.x,n=i.y;this._useBtn.dispose();var o=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"gotowar",this.clickBtnHandler,this);o.setPosition(a,n),this.addChild(o),this._useBtn=o}App.CommonUtil.showTip(LanguageManager.getlocal("dailybossRecoveryBattleSuccessDesc"))}},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_ALLIANCE_RECOVER,this.refresh,this),t.prototype.dispose.call(this)},e}(BossSelectedScrollItem);__reflect(AllianceBossSelectScrollItem.prototype,"AllianceBossSelectScrollItem");var AllianceBuildPopupView=function(t){function e(){var e=t.call(this)||this;return e._index=0,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_ALLIANCE_BUILD,this.doBuy,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.checkData,this);var t=BaseBitmap.create("public_9_resbg");t.x=20,t.y=15,this.addChildToContainer(t);var e=BaseLoadBitmap.create("itemicon1");e.setScale(.5),e.x=t.x-3,e.y=t.y+t.height/2-50+25,this.addChildToContainer(e);var i=Api.playerVoApi.getPlayerGemStr();this._text1=ComponentManager.getTextField(i,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._text1.x=t.x+50,this._text1.y=t.y+t.height/2-this._text1.height/2,this.addChildToContainer(this._text1);var a=ComponentManager.getButton("mainui_btn1","",this.addGoldBtnClickHandler,this);a.x=t.x+t.width-15,a.y=t.y+t.height/2-a.height/2,this.addChildToContainer(a),Api.switchVoApi.checkClosePay()&&(a.visible=!1);var n=Api.allianceVoApi.getAllianceVo(),o=n.info.donateNum?n.info.donateNum:0;o=n.maxmn-o,0>o&&(o=0);var s=LanguageManager.getlocal("allianceBuildTime",[o,n.maxmn.toString()]);this._buildTimeTF=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK),this._buildTimeTF.x=this.viewBg.width-this._buildTimeTF.width-40,this._buildTimeTF.y=t.y+t.height/2-this._buildTimeTF.height/2,0>=o&&(this._buildTimeTF.text=LanguageManager.getlocal("allianceBuildTime2",[o,n.maxmn.toString()])),this.addChildToContainer(this._buildTimeTF);var r=BaseBitmap.create("public_9_probiginnerbg");r.width=535,r.height=555,r.x=this.viewBg.x+this.viewBg.width/2-r.width/2,r.y=75,this.addChildToContainer(r);for(var l=new Array,h=0;4>h;h++)l.push(h);this._dataList=new Array;for(var d=Config.AlliancebaseCfg.contributeList,h=1;6>h;h++)this._dataList.push(d[h.toString()]);var g=egret.Rectangle.create();g.setTo(0,0,525,555),this._scrollList=ComponentManager.getScrollList(AllianceBuildScrollItem,this._dataList,g),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(r.x+5,r.y+8)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["dinnertypepopupview"])},e.prototype.addGoldBtnClickHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.doBuy=function(t){var e=t.data;this._index=e.index,this.request(NetRequestConst.REQUEST_ALLIANCE_DONATE,{donatetype:e.key})},e.prototype.receiveData=function(t){if(0!=t.ret&&t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_DONATE){this._scrollList.refreshData(this._dataList),App.CommonUtil.showTip(LanguageManager.getlocal("allianceBuildSuccess"));var e=Api.playerVoApi.getPlayerGemStr();this._text1.text=e;var i=Config.AlliancebaseCfg.contributeList,a=i[t.data.data.donatetype],n=(LanguageManager.getlocal("allianceBuildGet",[a.exp,a.asset,a.contribution]),egret.Point.create(320,GameConfig.stageHeigth/2));t.data.data.donateMaxFlag?App.CommonUtil.playRewardFlyAction([{tipMessage:LanguageManager.getlocal("allianceBuildGet3")+"+"+a.contribution}],n):App.CommonUtil.playRewardFlyAction([{tipMessage:LanguageManager.getlocal("allianceBuildGet1")+"+"+a.exp},{tipMessage:LanguageManager.getlocal("allianceBuildGet2")+"+"+a.asset},{tipMessage:LanguageManager.getlocal("allianceBuildGet3")+"+"+a.contribution}],n)}},e.prototype.refreshHandler=function(){},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.checkData=function(){this._text1.text=Api.playerVoApi.getPlayerGemStr();var t=Api.allianceVoApi.getAllianceVo(),e=t.info.donateNum?t.info.donateNum:0;e=t.maxmn-e,0>e&&(e=0);var i=LanguageManager.getlocal("allianceBuildTime",[e,t.maxmn.toString()]);this._buildTimeTF.text=i,0>=e&&(this._buildTimeTF.text=LanguageManager.getlocal("allianceBuildTime2",[e,t.maxmn.toString()]))},e.prototype.dispose=function(){this._scrollList=null,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_ALLIANCE_BUILD,this.doBuy,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.checkData,this),this._text1=null,this._index=null,this._dataList=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceBuildPopupView.prototype,"AllianceBuildPopupView");var AllianceBuildScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this._itemIndex=t,this._itemData=e,this.width=525,this.height=126+this.getSpaceY();var i=(t+1).toString(),a=BaseBitmap.create("public_9_bg14");a.width=this.width,a.height=148,a.scaleY=126/148,this.addChild(a),this._key=i;var n=TextFieldConst.COLOR_WARN_GREEN2;"1"==i?n=TextFieldConst.COLOR_WARN_GREEN2:"2"==i?n=TextFieldConst.COLOR_QUALITY_BLUE:"3"==i?n=TextFieldConst.COLOR_QUALITY_PURPLE:"4"==i?n=TextFieldConst.COLOR_WARN_RED2:"5"==i&&(n=TextFieldConst.COLOR_WARN_YELLOW2);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_YELLOW2);o.text=LanguageManager.getlocal("allianceBuildName"+i),o.setPosition(130,10),this.addChild(o);var s=LanguageManager.getlocal("allianceBuildCost"),r=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);if(r.setPosition(o.x,o.y+o.height+7),this.addChild(r),3>t){var l=BaseBitmap.create("itembg_5");l.setPosition(15,a.height/2*a.scaleY-l.width/2),this.addChild(l);var h=BaseBitmap.create("dinner_gems_"+i);h.setPosition(18,a.height/2*a.scaleY-h.width/2),this.addChild(h);var d=BaseLoadBitmap.create("itemicon1");d.x=190,d.y=28,d.setScale(.4),this.addChild(d);var g=ComponentManager.getTextField(e.needGem.toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);g.setPosition(235,r.y),g.width=260,this.addChild(g)}else{var c=Config.ItemCfg.getItemCfgById(e.needItem),p=c.getIconContainer(!0);p.setPosition(15,a.height/2*a.scaleY-p.width/2+1),p.name="icon",this.addChild(p);var _=Api.itemVoApi.getItemNumInfoVoById(Number(e.needItem));this._numTF=ComponentManager.getTextField(_.toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL),this._numTF.setPosition(p.x+p.width-8-this._numTF.width,p.y+p.height-8-this._numTF.height),this.addChild(this._numTF);var u=ComponentManager.getTextField(c.name+"x1",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN2);u.setPosition(r.x+r.width+0,o.y+o.height+7),this.addChild(u)}var C=LanguageManager.getlocal("allianceBuildGet",[e.exp,e.asset,e.contribution]),f=ComponentManager.getTextField(C,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);if(f.setPosition(o.x,r.y+r.height+7),f.width=375,this.addChild(f),Api.allianceVoApi.getIsDonatet()){var m=Api.allianceVoApi.getMyAllianceVo();if(this._key==m.donate.id){var T=ComponentManager.getTextField(LanguageManager.getlocal("allianceBuildToday"),TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_WARN_RED);T.x=400,T.y=25,this.addChild(T)}}else{var y=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"allianceBuild",this.chooseBtnClick,this);y.x=390,y.y=10,this.addChild(y),y.setColor(TextFieldConst.COLOR_BLACK)}},e.prototype.chooseBtnClick=function(){if(this._itemIndex>2){var t=Api.itemVoApi.getItemNumInfoVoById(Number(this._itemData.needItem));if(0>=t)return void App.CommonUtil.showTip(LanguageManager.getlocal("itemNumNotEnough"))}else{var e=this._itemData.needGem.toString();if(e>Api.playerVoApi.getPlayerGem())return void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough"))}var i=Api.allianceVoApi.getAllianceVo(),a=i.info.donateNum?i.info.donateNum:0;if(a>=i.maxmn){var n=(GameData.getRewardsStr(Api.adultVoApi._refuseData),LanguageManager.getlocal("allianceBuildTip"));return void ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"dailyTaskName19",msg:n,callback:this.doBuild,handler:this,needCancel:!0})}App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_ALLIANCE_BUILD,{key:this._key,index:this._itemIndex})},e.prototype.doBuild=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_ALLIANCE_BUILD,{key:this._key,index:this._itemIndex})},e.prototype.getBtnClickHandler=function(){},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){this._key=null,this._itemData=null,this._itemIndex=null,this._numTF=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AllianceBuildScrollItem.prototype,"AllianceBuildScrollItem");var AllianceCreateAniView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getResourceList=function(){var e=t.prototype.getResourceList.call(this);return e.concat(["alliance_create_ani","alliance_joinpic","alliance_createpic"])},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getBgName=function(){return"public_9_bg8"},e.prototype.initView=function(){this.addTouchTap(this.touchTap,this,null);var t="alliance_createpic";2==this.param.data.type&&(t="alliance_joinpic"),this._lighePic=BaseBitmap.create("public_rotatelight"),this._lighePic.scaleX=1.5,this._lighePic.scaleY=1.5,this._lighePic.anchorOffsetX=this._lighePic.width/2,this._lighePic.anchorOffsetY=this._lighePic.height/2,this._lighePic.setPosition(GameConfig.stageWidth/2,GameConfig.stageHeigth/2),this.addChild(this._lighePic),this._lighePic.visible=!1,this._lighePic.blendMode=egret.BlendMode.ADD;var e=BaseBitmap.create("alliance_create_ani_1"),i=ComponentManager.getCustomMovieClip("alliance_create_ani_",6,100);i.x=GameConfig.stageWidth/2-e.width,i.y=GameConfig.stageHeigth/2-e.height,i.setScale(2),this.addChild(i),i.playWithTime(1),i.blendMode=egret.BlendMode.ADD,i.setEndCallBack(this.lightAni,this);var a=new BaseDisplayObjectContainer;this.addChild(a);var n=BaseBitmap.create(t);n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,a.x=GameConfig.stageWidth/2-a.width/2,a.y=GameConfig.stageHeigth/2-a.height/2,a.setScale(.01),a.addChild(n),egret.Tween.get(a).to({scaleX:1,scaleY:1},200)},e.prototype.lightAni=function(){this._lighePic.visible=!0,egret.Tween.get(this._lighePic,{loop:!0}).to({rotation:360},8e3)},e.prototype.touchTap=function(){this.hide()},e.prototype.dispose=function(){this._lighePic=null,t.prototype.dispose.call(this)},e}(BaseView);__reflect(AllianceCreateAniView.prototype,"AllianceCreateAniView");var AllianceCreatePopupView=function(t){function e(){var e=t.call(this)||this;return e._type="",e}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=520,t.height=525,t.x=this.viewBg.x+this.viewBg.width/2-t.width/2,t.y=25,this.addChildToContainer(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("allianceCreateNameTitle"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);e.x=50,e.y=t.y+20,this.addChildToContainer(e);var i=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,466,45,"public_9_bg5",LanguageManager.getlocal("allianceCreateNameholder"),11645361);i.x=e.x,i.y=e.y+e.height+10,this.addChildToContainer(i),this._inputName=i.getChildByName("textField"),this._inputName.maxChars=6;var a=ComponentManager.getTextField(LanguageManager.getlocal("allianceCreateWeixinTitle"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);a.x=e.x,a.y=i.y+i.height+10,this.addChildToContainer(a);var n=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,466,45,"public_9_bg5",LanguageManager.getlocal("allianceCreateWeixinholder"),11645361);n.x=e.x,n.y=a.y+a.height+10,this.addChildToContainer(n),this._inputWeixin=n.getChildByName("textField"),this._inputWeixin.maxChars=15;var o=ComponentManager.getTextField(LanguageManager.getlocal("allianceCreateQQTitle"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);o.x=e.x,o.y=n.y+n.height+10,this.addChildToContainer(o);var s=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,466,45,"public_9_bg5",LanguageManager.getlocal("allianceCreateQQholder"),11645361);s.x=e.x,s.y=o.y+o.height+10,this.addChildToContainer(s),this._inputQQ=s.getChildByName("textField"),this._inputQQ.maxChars=15;var r=ComponentManager.getTextField(LanguageManager.getlocal("allianceCreateMsgTitle"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);r.x=e.x,r.y=s.y+s.height+10,this.addChildToContainer(r);var l=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,466,134,"public_9_bg5",LanguageManager.getlocal("allianceCreateMsgholder"),11645361);l.x=e.x,l.y=r.y+r.height+15,this.addChildToContainer(l),this._inputMsg=l.getChildByName("textField"),this._inputMsg.y=10,this._inputMsg.height=130,this._inputMsg.width=456,this._inputMsg.maxChars=40,this._inputMsg.multiline=!0,this._soundText=ComponentManager.getTextField(LanguageManager.getlocal("allianceJoinTitle"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW),this._soundText.x=e.x,this._soundText.y=l.y+l.height+10,this.addChildToContainer(this._soundText),this._soundBB=BaseBitmap.create("btn_swicth"),this._soundBB.x=this._soundText.x+this._soundText.width+10,this._soundBB.y=this._soundText.y+this._soundText.height/2-this._soundBB.height/2,this.addChildToContainer(this._soundBB),this._soundBB.addTouchTap(this.sonndHander,this),this._soundState=ComponentManager.getTextField("ON",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW),this._soundState.x=this._soundBB.x+15,this._soundState.y=this._soundBB.y+this._soundBB.height/2-this._soundState.height/2,this.addChildToContainer(this._soundState);var h=TextFieldConst.COLOR_WARN_GREEN;this._type="ON",this._soundState.text=this._type,this._soundState.textColor=h;var d=BaseLoadBitmap.create("itemicon1");d.setScale(.5),d.x=230,d.y=t.y+t.height-5,this.addChildToContainer(d);var g=Config.AlliancebaseCfg.createNeedGem,c=ComponentManager.getTextField(g.toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);c.x=280,c.y=t.y+t.height+15,this.addChildToContainer(c);var p=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"allianceCreateCreateBtn",this.createHandler,this);p.x=this.viewBg.width/2-p.width/2,p.y=c.y+c.height+15,p.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(p)},e.prototype.createHandler=function(t){if(!this._inputName.bindData)return void App.CommonUtil.showTip(LanguageManager.getlocal("allianceCreateNameTip"));var e=this._inputName.text;if(!App.StringUtil.userNameCheck(e))return void App.CommonUtil.showTip(LanguageManager.getlocal("guideChangeNameTip1"));if(e.length<2||e.length>6)return void App.CommonUtil.showTip(LanguageManager.getlocal("guideChangeNameTip2"));if(0==Config.ShieldCfg.checkShield(e))return void App.CommonUtil.showTip(LanguageManager.getlocal("chatShieldTip"));var i=this._inputMsg.text;if(0==Config.ShieldCfg.checkOnlyShield(i))return void App.CommonUtil.showTip(LanguageManager.getlocal("chatShieldTip"));var a=this._inputWeixin.text,n=this._inputQQ.text;if(this._inputWeixin.bindData||(a=""),0==Config.ShieldCfg.checkOnlyShield(a))return void App.CommonUtil.showTip(LanguageManager.getlocal("chatShieldTip"));if(this._inputQQ.bindData||(n=""),0==Config.ShieldCfg.checkOnlyShield(n))return void App.CommonUtil.showTip(LanguageManager.getlocal("chatShieldTip"));this._inputMsg.bindData||(i="");var o=0;return"OFF"==this._type&&(o=1),Config.AlliancebaseCfg.createNeedGem>Api.playerVoApi.getPlayerGem()?void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough")):void this.request(NetRequestConst.REQUEST_ALLIANCE_CREATEALLIANCE,{name:e,cweixin:a,cqq:n,intro:i,"switch":o})},e.prototype.receiveData=function(t){return t.ret?1==t.data.data.nameFlag?void App.CommonUtil.showTip(LanguageManager.getlocal("allianceNamePopupTip1")):void(t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_CREATEALLIANCE&&this.param.data.callback&&(this.param.data.callback.apply(this.param.data.handler,[]),this.hide())):void 0},e.prototype.sonndHander=function(t){var e=TextFieldConst.COLOR_WARN_GREEN;""==this._type||"ON"==this._type?this._type="OFF":this._type="ON","ON"!=this._type?(this._soundBB.skewY=180,this._soundBB.x=this._soundBB.x+this._soundBB.width,this._soundState.x=this._soundBB.x-50,e=11645361):(this._soundBB.skewY=0,this._soundBB.x=this._soundText.x+this._soundText.width+10,this._soundState.x=this._soundBB.x+15),this._soundState.text=this._type,this._soundState.textColor=e},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["shield_cn"])},e.prototype.dispose=function(){this._type="",this._soundBB=null,this._soundState=null,this._inputName=null,this._inputWeixin=null,this._inputQQ=null,this._inputMsg=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceCreatePopupView.prototype,"AllianceCreatePopupView");var AllianceCreateView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_ALLIANCE_INITALLIANCE,requestData:{}}},e.prototype.initView=function(){App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.checkData,this);var t=BaseBitmap.create("alliance_bg2");t.x=0,t.y=-15,this.addChildToContainer(t);var e=BaseLoadBitmap.create("servant_full_1031");e.x=0,e.y=GameConfig.stageHeigth-this.container.y-467,this.addChildToContainer(e),this._child_wordbg=BaseBitmap.create("public_9_bg25"),this._child_wordbg.x=60,this._child_wordbg.y=e.y-100,this._child_wordbg.width=320,this._child_wordbg.height=78,PlatformManager.checkIsKRSp()&&(this._child_wordbg.height=100),this.addChildToContainer(this._child_wordbg),this._child_wordbgCor=BaseBitmap.create("public_9_bg25_tail"),this._child_wordbgCor.x=260,this._child_wordbgCor.y=this._child_wordbg.y+this._child_wordbg.height-3,this.addChildToContainer(this._child_wordbgCor);var i=LanguageManager.getlocal("allianceCreateTip1"),a=Api.allianceVoApi.getMyAllianceVo();a.nextt-GameData.serverTime>0&&(i=LanguageManager.getlocal("allianceMemberQuitNextT",[App.DateUtil.getFormatBySecond(a.nextt-GameData.serverTime,1)])),this._childWordsText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._childWordsText.text=i,this._childWordsText.x=this._child_wordbg.x+20,this._childWordsText.y=this._child_wordbg.y+20,this._childWordsText.width=280,this._childWordsText.height=80,this.addChildToContainer(this._childWordsText);var n=BaseBitmap.create("public_9_bg9");n.width=180,n.height=290,n.x=430,n.y=e.y+120,this.addChildToContainer(n);var o=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"allianceCreateCreateBtn",this.createHander,this);o.x=n.x+n.width/2-o.width/2,o.y=n.y+19,o.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(o);var s=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"allianceCreateRandomBtn",this.randomJoinHander,this);s.x=o.x,s.y=o.y+o.height+10,s.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(s);var r=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"allianceCreateSearchBtn",this.findHander,this);r.x=o.x,r.y=s.y+s.height+10,r.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(r);var l=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"allianceCreateRankBtn",this.rankHander,this);l.x=o.x,l.y=r.y+r.height+10,l.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(l)},e.prototype.tick=function(){var t=LanguageManager.getlocal("allianceCreateTip1"),e=Api.allianceVoApi.getMyAllianceVo();e.nextt-GameData.serverTime>0&&(t=LanguageManager.getlocal("allianceMemberQuitNextT",[App.DateUtil.getFormatBySecond(e.nextt-GameData.serverTime,1)])),this._childWordsText.text=t},e.prototype.checkData=function(){Api.playerVoApi.getPlayerAllianceId()>0&&NetManager.curReceiveCmd!=NetRequestConst.REQUEST_ALLIANCE_JOINRANDALLIANCE&&this.hide()},e.prototype.createHander=function(){ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCECREATEPOPUPVIEW,{callback:this.creatCallback,handler:this})},e.prototype.randomJoinHander=function(){var t=Api.allianceVoApi.getMyAllianceVo();return t.nextt-GameData.serverTime>0?void App.CommonUtil.showTip(LanguageManager.getlocal("allianceJoinTip")):void this.request(NetRequestConst.REQUEST_ALLIANCE_JOINRANDALLIANCE,{})},e.prototype.findHander=function(){ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCEFINDPOPUPVIEW,{callback:this.creatCallback,handler:this})},e.prototype.rankHander=function(){ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCERANKPOPUPVIEW,{callback:this.creatCallback,handler:this})},e.prototype.creatCallback=function(){Api.chatVoApi.clearChat(),NetManager.chatServerLogin(null,null),this.hide(),ViewController.getInstance().openView(ViewConst.COMMON.ALLIANCEVIEW,{type:1})},e.prototype.receiveData=function(t){return t.ret?4==t.data.data.allianceFlag?void App.CommonUtil.showTip(LanguageManager.getlocal("allianceErrorMsg4")):void(t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_JOINRANDALLIANCE&&(this.hide(),Api.playerVoApi.getPlayerAllianceId()>0&&(Api.chatVoApi.clearChat(),NetManager.chatServerLogin(null,null),ViewController.getInstance().openView(ViewConst.COMMON.ALLIANCEVIEW,{type:2})))):void 0},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["alliance_bg2"])},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.checkData,this),this._child_wordbg=null,this._child_wordbgCor=null,this._childWordsText=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(AllianceCreateView.prototype,"AllianceCreateView");var AllianceExPopupView=function(t){function e(){var e=t.call(this)||this;return e._index=0,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_PUNISH_EXITEM,this.doBuy,this),this._pointText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK),this._pointText.y=11,this.addChildToContainer(this._pointText);var t=egret.Rectangle.create();t.setTo(0,0,540,710);for(var e=Api.allianceVoApi.getAllianceVo(),i=new Array,a=Config.AlliancebaseCfg.allianceShop,n=1;20>n&&a[n.toString()];n++)e.level>=a[n.toString()].needAllianceLv-1&&i.push(a[n.toString()]);this._scrollList=ComponentManager.getScrollList(AllianceExScrollItem,i,t),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(23,40),this.resetPointText()},e.prototype.doBuy=function(t){var e=t.data;this._index=e.index,this.request(NetRequestConst.REQUEST_ALLIANCE_SHOPBUY,{shopkey:e.key})},e.prototype.receiveData=function(t){if(t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_SHOPBUY){if(t.data.data&&t.data.data.rewards){var e=GameData.formatRewardItem(t.data.data.rewards);
e&&e.length>0&&App.CommonUtil.playRewardFlyAction(e)}var i=this._index,a=this._scrollList.getItemByIndex(i);a.refreshData(i),this.resetPointText()}},e.prototype.resetPointText=function(){var t=Api.allianceVoApi.getMyAllianceVo();this._pointText.text=LanguageManager.getlocal("allianceBuildScore",[t.ctv+"/"+t.tctv]),this._pointText.x=this.viewBg.width/2-this._pointText.width/2},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_PUNISH_EXITEM,this.doBuy,this),this._scrollList=null,this._pointText=null,this._index=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceExPopupView.prototype,"AllianceExPopupView");var AllianceExScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=172+this.getSpaceX(),this.height=229+this.getSpaceY();var i=(t+1).toString();this._key=i,this._itemIndex=t,this._itemData=e;var a=new BaseDisplayObjectContainer,n=BaseBitmap.create("public_9_bg4");n.width=170,n.height=228,a.addChild(n);var o=BaseBitmap.create("public_9_cell_title");o.width=164,o.x=3,o.y=3,a.addChild(o);var s=(e.sell,e),r=GameData.formatRewardItem(s.content)[0],l=ComponentManager.getTextField(r.name,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);l.setPosition(n.width/2-l.width/2,7),a.addChild(l);var h=GameData.getItemIcon(r,!0);h.setPosition(n.width/2-h.width/2,35),h.name="icon",a.addChild(h),h.getChildByName("numLb").visible=!1;var d=Api.allianceVoApi.getMyAllianceVo(),g=Api.allianceVoApi.getAllianceVo(),c=g.level-e.needAllianceLv+1;1>c&&(c=1);var p=0;d.shop&&d.shop[(t+1).toString()]&&(p=d.shop[(t+1).toString()]);var _=c-p,u=TextFieldConst.COLOR_QUALITY_GREEN;0>=_&&(u=TextFieldConst.COLOR_WARN_RED);var C=LanguageManager.getlocal("todayBuyNum",[u.toString(),_.toString()]);if(this._numTF=ComponentManager.getTextField(C,TextFieldConst.FONTSIZE_CONTENT_SMALL),this._numTF.setPosition(n.width/2-this._numTF.width/2,h.y+h.height+3),a.addChild(this._numTF),this._exchangeBtn=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"exchange",this.chooseBtnClick,this),this._exchangeBtn.setText(e.needContribution+LanguageManager.getlocal("allianceBuildScore2"),!1),this._exchangeBtn.setPosition(n.width/2-this._exchangeBtn.width/2,n.height-this._exchangeBtn.height-8),this._exchangeBtn.setColor(TextFieldConst.COLOR_BLACK),a.addChild(this._exchangeBtn),g.level-e.needAllianceLv<0){var f=BaseBitmap.create("public_itemmask");f.width=170,f.height=228,a.addChild(f);var m=BaseBitmap.create("public_numbg");m.x=this.width/2-m.width/2-5,m.height=50,m.y=80,a.addChild(m);var T=ComponentManager.getTextField(LanguageManager.getlocal("allianceExchangeLock",[e.needAllianceLv]),TextFieldConst.FONTSIZE_CONTENT_SMALL);T.width=80,T.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,T.textAlign=egret.HorizontalAlign.CENTER,T.setPosition(n.width/2-T.width/2,m.y+5),a.addChild(T)}0>=_&&this._exchangeBtn.setEnable(!1),this.addChild(a)},e.prototype.chooseBtnClick=function(){var t=Api.allianceVoApi.getMyAllianceVo(),e=Api.allianceVoApi.getAllianceVo();if(e.level-this._itemData.needAllianceLv<0)return void App.CommonUtil.showTip(LanguageManager.getlocal("allianceExchangeLock",[this._itemData.needAllianceLv]));var i=e.level-this._itemData.needAllianceLv+1;1>i&&(i=1);var a=0;t.shop[(this._itemIndex+1).toString()]&&(a=t.shop[(this._itemIndex+1).toString()]);var n=i-a;return 0>=n?void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishShopTip1")):this._itemData.needContribution>t.ctv?void App.CommonUtil.showTip(LanguageManager.getlocal("allianceNoCon")):void App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_PUNISH_EXITEM,{key:this._key,index:this._itemIndex})},e.prototype.refreshData=function(t){var e=Api.allianceVoApi.getMyAllianceVo(),i=Api.allianceVoApi.getAllianceVo(),a=i.level-this._itemData.needAllianceLv+1,n=0;e.shop[(t+1).toString()]&&(n=e.shop[(t+1).toString()]);var o=a-n,s=TextFieldConst.COLOR_QUALITY_GREEN;0>=o&&(s=TextFieldConst.COLOR_WARN_RED);var r=LanguageManager.getlocal("todayBuyNum",[s.toString(),o.toString()]);this._numTF.text=r,0>=o&&this._exchangeBtn.setEnable(!1)},e.prototype.getSpaceY=function(){return 5},e.prototype.getSpaceX=function(){return 5},e.prototype.dispose=function(){this._numTF=null,this._key=null,this._itemData=null,this._itemIndex=null,this._exchangeBtn=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AllianceExScrollItem.prototype,"AllianceExScrollItem");var AllianceFindPopupView=function(t){function e(){var e=t.call(this)||this;return e._inputTextField=null,e._dinnerInfoContainer=null,e._scrollView=null,e._allianceInfo=null,e._gotoBtn=null,e}return __extends(e,t),e.prototype.getTitleStr=function(){return"allianceCreateSearchBtn"},e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=518,t.height=500,t.setPosition(this.viewBg.width/2-t.width/2,12),this.addChildToContainer(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("allianceFindId"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);e.setPosition(52,27+t.y),this.addChildToContainer(e);var i=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,466,44,"public_9_bg5",LanguageManager.getlocal("allianceFindInputHolder"),10785151);i.x=this.viewBg.width/2-i.width/2,i.y=t.y+55,this.addChildToContainer(i),this._inputTextField=i.getChildByName("textField"),this._inputTextField.restrict="0-9",this._inputTextField.maxChars=40;var a=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"find",this.findHandle,this);a.setPosition(this.viewBg.width-a.width-55,i.y+i.height+12),this.addChildToContainer(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("allianceFindIInfo"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);n.setPosition(e.x,155+t.y),this.addChildToContainer(n);var o=BaseBitmap.create("public_9_probiginnerbg");o.width=500,o.height=228,o.setPosition(this.viewBg.width/2-o.width/2,n.y+n.height+8),this.addChildToContainer(o),this._gotoBtn=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"allianceRankApply",this.gotoHandle,this),this._gotoBtn.setPosition(a.x,o.y+o.height+12),this.addChildToContainer(this._gotoBtn),this._gotoBtn.visible=!1},e.prototype.findHandle=function(){return this._inputTextField.bindData?void this.request(NetRequestConst.REQUEST_ALLIANCE_FINDALLIANCE,{aid:Number(this._inputTextField.text)}):void App.CommonUtil.showTip(LanguageManager.getlocal("allianceFindInputHolder"))},e.prototype.gotoHandle=function(){var t=Api.allianceVoApi.getMyAllianceVo();return t.nextt-GameData.serverTime>0?void App.CommonUtil.showTip(LanguageManager.getlocal("allianceJoinTip")):this._allianceInfo.mn>=this._allianceInfo.maxmn?void App.CommonUtil.showTip(LanguageManager.getlocal("alliance_joinNumMax")):void this.request(NetRequestConst.REQUEST_ALLIANCE_APPLYALLIANCE,{aid:this._allianceInfo.id})},e.prototype.receiveData=function(t){if(1==t.ret){if(2==t.data.data.allianceFlag)return void App.CommonUtil.showTip(LanguageManager.getlocal("allianceErrorMsg2"));if(3==t.data.data.allianceFlag)return void App.CommonUtil.showTip(LanguageManager.getlocal("allianceErrorMsg3"));t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_FINDALLIANCE&&(this._gotoBtn.visible=!0,this._allianceInfo=t.data.data.falliance,this.showFindInfo()),t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_APPLYALLIANCE&&App.CommonUtil.showTip(LanguageManager.getlocal("allianceApplySuccess"))}},e.prototype.showFindInfo=function(){this._scrollView&&(this.removeChildFromContainer(this._scrollView),this._scrollView=null);var t=new BaseDisplayObjectContainer,e=egret.Rectangle.create();e.setTo(0,0,500,210),this._scrollView=ComponentManager.getScrollView(t,e),this._scrollView.setPosition(50,210),this.addChildToContainer(this._scrollView);var i=LanguageManager.getlocal("allianceFindInfo1",[this._allianceInfo.name,this._allianceInfo.level]),a=ComponentManager.getTextField(i,TextFieldConst.FONTSIZE_CONTENT_COMMON);a.y=5,t.addChild(a);var n=LanguageManager.getlocal("allianceFindInfo2",[this._allianceInfo.creatorname]),o=ComponentManager.getTextField(n,TextFieldConst.FONTSIZE_CONTENT_COMMON);o.y=a.y+a.height+10,t.addChild(o);var s=Config.AllianceCfg.getAllianceCfgByLv(this._allianceInfo.level),r=LanguageManager.getlocal("allianceFindInfo3",[this._allianceInfo.exp+"/"+s.exp]),l=ComponentManager.getTextField(r,TextFieldConst.FONTSIZE_CONTENT_COMMON);l.y=o.y+o.height+10,t.addChild(l);var h=LanguageManager.getlocal("allianceFindInfo4",[this._allianceInfo.wealth]),d=ComponentManager.getTextField(h,TextFieldConst.FONTSIZE_CONTENT_COMMON);d.y=l.y+l.height+10,t.addChild(d);var g=LanguageManager.getlocal("allianceFindInfo5",[this._allianceInfo.affect]),c=ComponentManager.getTextField(g,TextFieldConst.FONTSIZE_CONTENT_COMMON);c.y=d.y+d.height+10,t.addChild(c);var p=LanguageManager.getlocal("allianceFindInfo6",[this._allianceInfo.mn+"/"+this._allianceInfo.maxmn]),_=ComponentManager.getTextField(p,TextFieldConst.FONTSIZE_CONTENT_COMMON);_.y=c.y+c.height+10,t.addChild(_);var u=LanguageManager.getlocal("allianceFindInfo7",[this._allianceInfo.cqq]),C=ComponentManager.getTextField(u,TextFieldConst.FONTSIZE_CONTENT_COMMON);C.y=_.y+_.height+10,t.addChild(C);var f=LanguageManager.getlocal("allianceFindInfo8",[this._allianceInfo.intro]),m=ComponentManager.getTextField(f,TextFieldConst.FONTSIZE_CONTENT_COMMON);m.y=C.y+C.height+10,m.width=480,t.addChild(m),t.height=t.height+10},e.prototype.dispose=function(){this._inputTextField=null,this._dinnerInfoContainer=null,this._gotoBtn=null,this._scrollView=null,this._allianceInfo=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceFindPopupView.prototype,"AllianceFindPopupView");var AllianceInfoPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=Api.allianceVoApi.getAllianceVo(),e=BaseBitmap.create("public_9_bg4");e.width=520,e.height=643,e.x=this.viewBg.x+this.viewBg.width/2-e.width/2,e.y=25,this.addChildToContainer(e);var i=LanguageManager.getlocal("allianceInfoName",[t.name]);this._nameTF=ComponentManager.getTextField(i,TextFieldConst.FONTSIZE_CONTENT_COMMON),this._nameTF.x=50,this._nameTF.y=45,this.addChildToContainer(this._nameTF),this._penIcon=BaseBitmap.create("public_pen_icon"),this._penIcon.x=this._nameTF.x+this._nameTF.width+10,this._penIcon.y=this._nameTF.y+this._nameTF.height/2-this._penIcon.height/2,this.addChildToContainer(this._penIcon),this._penIcon.addTouchTap(this.reNameCilck,this);var a=LanguageManager.getlocal("allianceFindInfo2",[t.creatorname]),n=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_COMMON);n.y=this._nameTF.y+this._nameTF.height+10,n.x=this._nameTF.x,this.addChildToContainer(n);var o=Config.AllianceCfg.getAllianceCfgByLv(t.level.toString()),s=LanguageManager.getlocal("allianceInfoLevel",[t.level.toString(),t.exp.toString(),o.exp.toString()]),r=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_COMMON);r.y=n.y+n.height+10,r.x=this._nameTF.x,this.addChildToContainer(r);var l=LanguageManager.getlocal("allianceFindInfo6",[t.mn+"/"+t.maxmn]),h=ComponentManager.getTextField(l,TextFieldConst.FONTSIZE_CONTENT_COMMON);h.y=r.y+r.height+10,h.x=this._nameTF.x,this.addChildToContainer(h);var d=LanguageManager.getlocal("allianceFindInfo4",[t.wealth.toString()]),g=ComponentManager.getTextField(d,TextFieldConst.FONTSIZE_CONTENT_COMMON);g.y=h.y+h.height+10,g.x=this._nameTF.x,this.addChildToContainer(g);var c=ComponentManager.getTextField(LanguageManager.getlocal("allianceCreateWeixinTitle"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);c.x=50,c.y=g.y+g.height+10,this.addChildToContainer(c);var p=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,466,45,"public_9_bg5",LanguageManager.getlocal("allianceCreateWeixinholder"),11645361,t.cweixin);p.x=50,p.y=c.y+c.height+10,this.addChildToContainer(p),this._inputWeixin=p.getChildByName("textField"),this._inputWeixin.maxChars=15;var _=ComponentManager.getTextField(LanguageManager.getlocal("allianceCreateQQTitle"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);_.x=50,_.y=p.y+p.height+10,this.addChildToContainer(_);var u=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,466,45,"public_9_bg5",LanguageManager.getlocal("allianceCreateQQholder"),11645361,t.cqq);u.x=50,u.y=_.y+_.height+10,this.addChildToContainer(u),this._inputQQ=u.getChildByName("textField"),this._inputQQ.maxChars=15;var C=ComponentManager.getTextField(LanguageManager.getlocal("allianceCreateNoticeTitle"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);C.x=50,C.y=u.y+u.height+10,this.addChildToContainer(C);var f=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,466,100,"public_9_probiginnerbg",LanguageManager.getlocal("allianceCreateMsgholder"),11645361,t.message);f.x=50,f.y=C.y+C.height+15,this.addChildToContainer(f),this._inputNotice=f.getChildByName("textField"),this._inputNotice.y=10,this._inputNotice.height=90,this._inputNotice.width=456,this._inputNotice.maxChars=40,this._inputNotice.multiline=!0;var m=ComponentManager.getTextField(LanguageManager.getlocal("allianceCreateMsgTitle"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);m.x=50,m.y=f.y+f.height+10,this.addChildToContainer(m);var T=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,466,100,"public_9_probiginnerbg",LanguageManager.getlocal("allianceCreateMsgholder"),11645361,t.intro);T.x=50,T.y=m.y+m.height+15,this.addChildToContainer(T),this._inputMsg=T.getChildByName("textField"),this._inputMsg.y=10,this._inputMsg.height=90,this._inputMsg.width=456,this._inputMsg.maxChars=40,this._inputMsg.multiline=!0;var y=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"allianceInfoSave",this.createHandler,this);y.x=this.viewBg.width/2-y.width/2,y.y=T.y+T.height+15,y.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(y)},e.prototype.reNameCilck=function(){ViewController.getInstance().openView(ViewConst.POPUP.NAMEPOPUPVIEW,{type:4,confirmCallback:this.reNameCallBack,handler:this})},e.prototype.reNameCallBack=function(){var t=Api.allianceVoApi.getAllianceVo(),e=LanguageManager.getlocal("allianceInfoName",[t.name]);this._nameTF.text=e,this._penIcon.x=this._nameTF.x+this._nameTF.width+10},e.prototype.createHandler=function(t){var e=this._inputMsg.text;if(0==Config.ShieldCfg.checkOnlyShield(e))return void App.CommonUtil.showTip(LanguageManager.getlocal("chatShieldTip"));var i=this._inputWeixin.text,a=this._inputQQ.text,n=this._inputNotice.text;if(0==Config.ShieldCfg.checkOnlyShield(e))return void App.CommonUtil.showTip(LanguageManager.getlocal("chatShieldTip"));if(0==Config.ShieldCfg.checkOnlyShield(a))return void App.CommonUtil.showTip(LanguageManager.getlocal("chatShieldTip"));if(0==Config.ShieldCfg.checkOnlyShield(n))return void App.CommonUtil.showTip(LanguageManager.getlocal("chatShieldTip"));this._inputNotice.bindData||(n=""),this._inputQQ.bindData||(a=""),this._inputWeixin.bindData||(i=""),this._inputMsg.bindData||(e="");this.request(NetRequestConst.REQUEST_ALLIANCE_MODINFO,{cweixin:i,cqq:a,message:n,intro:e})},e.prototype.receiveData=function(t){t.ret&&t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_MODINFO&&(this.param.data.callback,App.CommonUtil.showTip(LanguageManager.getlocal("allianceInfoSaveTip")))},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["shield_cn"])},e.prototype.getTitleStr=function(){return"allianceFindIInfo"},e.prototype.dispose=function(){this._inputWeixin=null,this._inputQQ=null,this._inputNotice=null,this._inputMsg=null,this._penIcon=null,this._nameTF=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceInfoPopupView.prototype,"AllianceInfoPopupView");var AllianceManagePopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=Api.allianceVoApi.getMyAllianceVo();if(1==t.po){var e=this.getItem(this.infoBtnClick,"allianceManageBtn1",TextFieldConst.COLOR_WHITE);this.addChildToContainer(e),e.x=this.viewBg.width/2-e.width/2,e.y=30;var i=this.getItem(this.applyBtnClick,"allianceManageBtn2",TextFieldConst.COLOR_WHITE);this.addChildToContainer(i),i.x=this.viewBg.width/2-i.width/2,i.y=e.y+e.height+15;var a=this.getItem(this.turnBtnClick,"allianceManageBtn3",TextFieldConst.COLOR_QUALITY_ORANGE);this.addChildToContainer(a),a.x=this.viewBg.width/2-a.width/2,a.y=i.y+i.height+15;var n=this.getItem(this.disBtnClick,"allianceManageBtn4",TextFieldConst.COLOR_QUALITY_ORANGE);this.addChildToContainer(n),n.x=this.viewBg.width/2-n.width/2,n.y=a.y+a.height+15;var o=Api.allianceVoApi.getAllianceVo();if(o.apply[0]){var s=BaseBitmap.create("public_dot2");s.x=i.x+i.width-s.width+5,s.y=i.y-5,this.addChildToContainer(s)}}else{var i=this.getItem(this.applyBtnClick,"allianceManageBtn2",TextFieldConst.COLOR_WHITE);this.addChildToContainer(i),i.x=this.viewBg.width/2-i.width/2,i.y=30;var o=Api.allianceVoApi.getAllianceVo();if(o.apply[0]){var s=BaseBitmap.create("public_dot2");s.x=i.x+i.width-s.width+5,s.y=i.y+10,this.addChildToContainer(s)}}},e.prototype.infoBtnClick=function(){this.hide(),ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCEINFOPOPUPVIEW,{})},e.prototype.applyBtnClick=function(){this.hide(),ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCEAPPLYPOPUPVIEW,{})},e.prototype.turnBtnClick=function(){this.hide(),ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCETURNPOPUPVIEW,{})},e.prototype.disBtnClick=function(){var t=100*Config.AlliancebaseCfg.reduceContribution+"%",e=LanguageManager.getlocal("alliance_disTip",[t]);ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"allianceManageBtn4",msg:e,callback:this.doDis,handler:this,needCancel:!0})},e.prototype.doDis=function(){ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCETIMEPOPUPVIEW,{type:2,pswd:"",title:"allianceManageBtn4"}),this.hide()},e.prototype.getItem=function(t,e,i){var a=new BaseDisplayObjectContainer,n=BaseBitmap.create("public_9_bg28");n.width=500,a.addChild(n);var o=ComponentManager.getTextField(LanguageManager.getlocal(e),TextFieldConst.FONTSIZE_TITLE_SMALL);return o.textColor=i,o.x=a.width/2-o.width/2,o.y=a.height/2-o.height/2,a.addChild(o),n.addTouch(this.eventHandler,this,[t,n,this]),a},e.prototype.eventHandler=function(t,e,i,a){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:i.texture=ResourceManager.getRes("public_9_bg28_down");break;case egret.TouchEvent.TOUCH_CANCEL:i.texture=ResourceManager.getRes("public_9_bg28");break;case egret.TouchEvent.TOUCH_END:i.texture=ResourceManager.getRes("public_9_bg28"),e.apply(a)}},e.prototype.dispose=function(){this._inputTextField=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceManagePopupView.prototype,"AllianceManagePopupView");var AllianceMemberPopupView=function(t){function e(){var e=t.call(this)||this;return e._curTabIdx=0,e._index=0,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_ALLIANCE_EXITALLIANCE,this.doQuit,this),App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_ALLIANCE_KICKALLIANCE,this.doRefresh,this),App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_ALLIANCE_EXITALLIANCE,this.quitAlliance,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_MESSAGE_ALLIANCE_BEKICK,this.quitAlliance,this),App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_ALLIANCE_DISBAND,this.quitAlliance,this),this._allianceVo=Api.allianceVoApi.getAllianceVo();var t=BaseBitmap.create("public_9_probiginnerbg");t.width=520,t.height=600,t.x=this.viewBg.width/2-t.width/2,t.y=60,this.addChildToContainer(t);var e=LanguageManager.getlocal("allianceMemberNum")+this._allianceVo.mn+"/"+this._allianceVo.maxmn;this._memberText=ComponentManager.getTextField(e,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN),this._memberText.x=30,this._memberText.y=20,this.addChildToContainer(this._memberText);var i=Api.allianceVoApi.getAllianceMemberInfoVoList(),a=egret.Rectangle.create();a.setTo(0,0,t.width-10,t.height-20),this._scrollList=ComponentManager.getScrollList(AllianceMemberScrollItem,i,a),this.addChildToContainer(this._scrollList),this._scrollList.x=t.x+5,this._scrollList.y=t.y+10,this._scrollList.setEmptyTip(LanguageManager.getlocal("allianceApplyTip"))},e.prototype.refuseAllHandler=function(){return this._scrollList.getItemByIndex(0)?void this.request(NetRequestConst.REQUEST_ALLIANCE_REFUSEALLAPPLY,{}):void App.CommonUtil.showTip(LanguageManager.getlocal("allianceApplyTip"))},e.prototype.quitAlliance=function(){this.hide()},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_ALLIANCE_GETMEMBER,requestData:{}}},e.prototype.receiveData=function(t){t.data.ret<0||(t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_GETMEMBER,t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_EXITALLIANCE&&(this.hide(),App.CommonUtil.showTip(LanguageManager.getlocal("allianceMemberQuitSuccess"))))},e.prototype.doRefresh=function(){var t=Api.allianceVoApi.getAllianceMemberInfoVoList();this._scrollList.refreshData(t);var e=LanguageManager.getlocal("allianceMemberNum")+this._allianceVo.mn+"/"+this._allianceVo.maxmn;this._memberText.text=e},e.prototype.doQuit=function(t){this.request(NetRequestConst.REQUEST_ALLIANCE_EXITALLIANCE,{})},e.prototype.rankBtnClick=function(){},e.prototype.tabBtnClickHandler=function(t){this._curTabIdx=t.index,this.refreshRankList()},e.prototype.refreshRankList=function(){},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["dinner_rankbg","dinnerrankpopupview"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_ALLIANCE_EXITALLIANCE,this.doQuit,this),App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_ALLIANCE_KICKALLIANCE,this.doRefresh,this),App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_ALLIANCE_EXITALLIANCE,this.quitAlliance,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_MESSAGE_ALLIANCE_BEKICK,this.quitAlliance,this),App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_ALLIANCE_DISBAND,this.quitAlliance,this),this._scrollList=null,this._timeTF=null,this._selectChildData=null,this._allianceVo=null,this._index=null,this._curTabIdx=0,this._memberText=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceMemberPopupView.prototype,"AllianceMemberPopupView");var AllianceMemberScrollItem=function(t){function e(){var e=t.call(this)||this;return e._applyData=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=510,this.height=156+this.getSpaceY(),this._applyData=e,this._itemIndex=t;var i=BaseBitmap.create("public_9_bg14");i.width=this.width,i.height=156,this.addChild(i);var a=e.name+"("+LanguageManager.getlocal("allianceMemberPo"+e.po)+")";if(this._nameTf=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN),this._nameTf.x=23,this._nameTf.y=15,this.addChild(this._nameTf),e.uid==Api.playerVoApi.getPlayerID()&&(this._nameTf.textColor=TextFieldConst.COLOR_WARN_YELLOW2),"0"!=e.donate){var n=TextFieldConst.COLOR_WARN_GREEN2;"1"==e.donate?n=TextFieldConst.COLOR_WARN_GREEN2:"2"==e.donate?n=TextFieldConst.COLOR_QUALITY_BLUE:"3"==e.donate?n=TextFieldConst.COLOR_QUALITY_PURPLE:"4"==e.donate?n=TextFieldConst.COLOR_WARN_RED2:"5"==e.donate&&(n=TextFieldConst.COLOR_WARN_YELLOW2);var o=LanguageManager.getlocal("allianceBuildName"+e.donate),s=ComponentManager.getTextField(o,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);s.x=this.width-s.width-25,s.textColor=n,s.y=this._nameTf.y,this.addChild(s)}var r=BaseBitmap.create("public_line1");r.x=this.width/2-r.width/2,r.y=40,this.addChild(r);var l=new BaseDisplayObjectContainer;this.addChild(l),l.x=20,l.y=50;var h=BaseBitmap.create("public_chatheadbg");l.addChild(h);var d=egret.Rectangle.create();d.setTo(0,0,136,143);var g=BaseLoadBitmap.create(Api.playerVoApi.getUserHeadImgPathById(e.pic),d);g.x=0,g.y=-7,g.setScale(2/3),l.addChild(g),App.CommonUtil.addTouchScaleEffect(l,this.clickItemHandler,this);var c=LanguageManager.getlocal("allianceMemberInfo1",[e.power.toString()]),p=ComponentManager.getTextField(c,18,TextFieldConst.COLOR_BROWN);p.x=120,p.y=this._nameTf.y+this._nameTf.height+14,this.addChild(p);var _=LanguageManager.getlocal("allianceMemberInfo2",[Api.playerVoApi.getPlayerOfficeByLevel(e.level)]),u=ComponentManager.getTextField(_,18,TextFieldConst.COLOR_BROWN);u.x=120,u.y=p.y+p.height+7,this.addChild(u);var C=LanguageManager.getlocal("allianceMemberInfo3",[e.ctv+"/"+e.tctv]),f=ComponentManager.getTextField(C,18,TextFieldConst.COLOR_BROWN);f.x=120,f.y=u.y+u.height+7,this.addChild(f);var m=GameData.serverTime-e.logindt,T=LanguageManager.getlocal("allianceMemberInfo4",[App.DateUtil.getFormatBySecond(m,4)]),y=ComponentManager.getTextField(T,18,TextFieldConst.COLOR_BROWN);y.x=120,y.y=f.y+f.height+7,this.addChild(y);var v=Api.allianceVoApi.getMyAllianceVo();if(1==v.po&&e.uid!=Api.playerVoApi.getPlayerID()){var A=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"allianceMemberChangePo",this.chooseBtnClick,this);A.x=360,A.y=95,this.addChild(A),A.setColor(TextFieldConst.COLOR_BLACK)}if(1!=v.po&&e.uid==Api.playerVoApi.getPlayerID()){var w=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"allianceMemberQuit",this.quitBtnClick,this);w.x=360,w.y=95,this.addChild(w),w.setColor(TextFieldConst.COLOR_BLACK)}var x=Api.allianceVoApi.getAllianceMemberInfoVoList().length;if(1==v.po&&e.uid==Api.playerVoApi.getPlayerID()&&1==x){var w=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"allianceManageBtn4",this.quitBtnClick2,this);w.x=360,w.y=95,this.addChild(w),w.setColor(TextFieldConst.COLOR_BLACK)}},e.prototype.userShotCallback=function(t){var e=t.data.data.data;ViewController.getInstance().openView(ViewConst.POPUP.RANKUSERINGOPOPUPVIEW,e),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_USERSHOT),this.userShotCallback,this)},e.prototype.clickItemHandler=function(t){this.showUserInfo()},e.prototype.showUserInfo=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_USERSHOT),this.userShotCallback,this),NetManager.request(NetRequestConst.REQUEST_RANK_USERSHOT,{ruid:this._applyData.uid})},e.prototype.chooseBtnClick=function(){ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCESETPOPOPUPVIEW,{allianceMemberVo:this._applyData,callback:this.refreshData,handler:this})},e.prototype.quitBtnClick=function(){ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"allianceMemberQuit",msg:LanguageManager.getlocal("allianceMemberQuitTip1"),callback:this.doQuit,handler:this,needCancel:!0})},e.prototype.quitBtnClick2=function(){var t=100*Config.AlliancebaseCfg.reduceContribution+"%",e=LanguageManager.getlocal("alliance_disTip",[t]);ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"allianceManageBtn4",msg:e,callback:this.doDis,handler:this,needCancel:!0})},e.prototype.doDis=function(){ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCETIMEPOPUPVIEW,{type:2,pswd:"",title:"allianceManageBtn4"})},e.prototype.doQuit=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_ALLIANCE_EXITALLIANCE,{})},e.prototype.doQuit2=function(){ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCETIMEPOPUPVIEW,{type:2,pswd:"",title:"allianceManageBtn4"})},e.prototype.refreshData=function(){var t=Api.allianceVoApi.getAllianceMemberInfoById(this._applyData.uid);this._applyData=t;var e=t.name+"("+LanguageManager.getlocal("allianceMemberPo"+t.po)+")";this._nameTf.text=e},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._applyData=null,this._itemIndex=null,this._nameTf=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AllianceMemberScrollItem.prototype,"AllianceMemberScrollItem");var AllianceMoreItem=function(t){function e(){var e=t.call(this)||this;return e.uid=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){var i=BaseBitmap.create("public_9_bg25");i.width=640,i.height=124,i.x=0,i.y=0,this.addChild(i),i.visible=!1;var a=BaseBitmap.create("rankinglist_line");a.y=128,a.x=15,this.addChild(a);var n=BaseBitmap.create("rankinglist_rankbg");n.x=50-n.width/2-20,n.y=15,this.addChild(n);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);o.text=String(t+1),o.x=50-o.width/2-20,o.y=20,this.addChild(o);var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);s.text=e[2],s.x=n.x+50,s.y=20,this.addChild(s);var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);r.text=App.DateUtil.getFormatBySecond(e[1],2),r.x=s.x,r.y=98,this.addChild(r);var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);l.width=450,l.x=s.x,l.y=50,l.lineSpacing=3,this.addChild(l);var h="";h=LanguageManager.getlocal("alliancelogdes"+e[0]),h=Api.allianceVoApi.getStr(e),l.text=h},e.prototype.getSpaceY=function(){return 1},e.prototype.getSpaceX=function(){return 0},e.prototype.dispose=function(){this.uid=0,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AllianceMoreItem.prototype,"AllianceMoreItem");var AlliancePswdPopupView=function(t){function e(){var e=t.call(this)||this;return e._initName="",e}return __extends(e,t),e.prototype.initView=function(){var t=this.param.data.name,e=0;t||(t="测试测试"),2==this._type&&(e=20);var i=BaseBitmap.create("public_9_bg4");i.width=520,i.height=224,i.x=this.viewBg.x+this.viewBg.width/2-i.width/2,i.y=9,this.addChildToContainer(i);var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);a.text=LanguageManager.getlocal("alliance_pswd"),a.x=105,a.y=55,this.addChildToContainer(a);var n=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,369,45,"public_9_bg5",LanguageManager.getlocal("alliance_pswdHolder"),11645361);n.x=this.viewBg.x+this.viewBg.width/2-n.width/2,n.y=i.y+i.height/2-n.height/2-e,this.addChildToContainer(n),this._inputTextField=n.getChildByName("textField"),this._inputTextField.maxChars=6,this._inputTextField.restrict="0-9",this._cancelBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"cancelBtn",this.clickCancelHandler,this),this._cancelBtn.setColor(TextFieldConst.COLOR_BLACK),this._cancelBtn.x=this.viewBg.x+this.viewBg.width/4-this._cancelBtn.width/2,this._cancelBtn.y=i.y+i.height+15,this._cancelBtn.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(this._cancelBtn)},e.prototype.clickConfirmHandler=function(t){var e=Api.allianceVoApi.getAllianceVo(),i=this._inputTextField.text;return this._inputTextField.bindData?i!=e.pswd.toString()?void App.CommonUtil.showTip(LanguageManager.getlocal("alliance_pswdError")):(ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCETIMEPOPUPVIEW,{type:2,pswd:i,title:"allianceManageBtn4"}),void this.hide()):void App.CommonUtil.showTip(LanguageManager.getlocal("alliance_pswdHolder"))},e.prototype.clickCancelHandler=function(t){this.hide()},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this),this.setConfirmBtnPosition(this.viewBg.x+this.viewBg.width/4*3-this._cancelBtn.width/2-35,this._cancelBtn.y)},e.prototype.getConfirmBtnStr=function(){return"sysConfirm"},e.prototype.getConfirmBtnName=function(){return ButtonConst.BTN_NORMAL_YELLOW},e.prototype.getTitleStr=function(){return"allianceManageBtn4"},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["shield_cn"])
},e.prototype.dispose=function(){this._type=null,this._useCallback=null,this._handler=null,this._inputTextField=null,this._cancelBtn=null,this._errorText=null,this._initName="",t.prototype.dispose.call(this)},e}(PopupView);__reflect(AlliancePswdPopupView.prototype,"AlliancePswdPopupView");var AllianceRankPopupView=function(t){function e(){var e=t.call(this)||this;return e._curTabIdx=0,e._rank=0,e._index=0,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_ALLIANCE_APPLYALLIANCE,this.doApply,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_ALLIANCE_CANCELAPPLYALLIANCE,this.doCancel,this),this._allianceVo=Api.allianceVoApi.getAllianceVo();var t=["allianceRankTab1"],e=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,t,this.tabBtnClickHandler,this);e.x=35,e.y=15,this.addChildToContainer(e);var i=BaseBitmap.create("public_9_probiginnerbg");i.width=520,i.height=555,i.x=this.viewBg.width/2-i.width/2,i.y=60,this.addChildToContainer(i);var a=BaseBitmap.create("public_9_probiginnerbg");a.width=i.width,a.height=100,a.x=i.x,a.y=i.y+i.height+9,this.addChildToContainer(a);var n="";n=0==Api.playerVoApi.getPlayerAllianceId()?LanguageManager.getlocal("allianceRankMyAlliance",[LanguageManager.getlocal("allianceRankNoAlliance")]):LanguageManager.getlocal("allianceRankMyAlliance",[Api.playerVoApi.getPlayerAllianceName()]);var o=ComponentManager.getTextField(n,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);o.x=a.x+50,o.y=a.y+a.height/2-o.height/2,this.addChildToContainer(o);var s="";s=0==Api.playerVoApi.getPlayerAllianceId()?LanguageManager.getlocal("allianceRankMyAllianceRank",[LanguageManager.getlocal("allianceRankNoRank")]):LanguageManager.getlocal("allianceRankMyAllianceRank",[this._rank.toString()]);var r=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);r.x=a.x+330,r.y=a.y+a.height/2-r.height/2,this.addChildToContainer(r);var l=this._rankData,h=egret.Rectangle.create();h.setTo(0,0,i.width-10,i.height-27),this._scrollList=ComponentManager.getScrollList(AllianceRankScrollItem,l,h),this.addChildToContainer(this._scrollList),this._scrollList.x=i.x+5,this._scrollList.y=i.y+10,this._scrollList.setEmptyTip(LanguageManager.getlocal("allianceRankNoAlliance"))},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_ALLIANCE_GETALLIANCELIST,requestData:{}}},e.prototype.receiveData=function(t){t.data;if(0!=t.ret){if(1==t.data.data.allianceFlag)return App.CommonUtil.showTip(LanguageManager.getlocal("allianceErrorMsg1")),void this.hide();if(2==t.data.data.allianceFlag)return void App.CommonUtil.showTip(LanguageManager.getlocal("allianceErrorMsg2"));if(3==t.data.data.allianceFlag)return void App.CommonUtil.showTip(LanguageManager.getlocal("allianceErrorMsg3"));if(t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_GETALLIANCELIST&&(this._rankData=t.data.data.alliancelist,this._rank=t.data.data.arank),t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_APPLYALLIANCE){var e=this._index,i=this._scrollList.getItemByIndex(e);i.refreshData(e),App.CommonUtil.showTip(LanguageManager.getlocal("allianceApplyTipSuccess"))}if(t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_CANCELAPPLY){var e=this._index,i=this._scrollList.getItemByIndex(e);i.refreshData(e),App.CommonUtil.showTip(LanguageManager.getlocal("allianceCancelApplyTip"))}}},e.prototype.doApply=function(t){var e=t.data;this._index=e.index,this.request(NetRequestConst.REQUEST_ALLIANCE_APPLYALLIANCE,{aid:t.data.aid})},e.prototype.doCancel=function(t){var e=t.data;this._index=e.index,this.request(NetRequestConst.REQUEST_ALLIANCE_CANCELAPPLY,{aid:t.data.aid})},e.prototype.rankBtnClick=function(){},e.prototype.tabBtnClickHandler=function(t){this._curTabIdx=t.index,this.refreshRankList()},e.prototype.refreshRankList=function(){},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["dinner_rankbg","dinnerrankpopupview","dinner_line","dinner_rank_titlebg"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_ALLIANCE_APPLYALLIANCE,this.doApply,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_ALLIANCE_CANCELAPPLYALLIANCE,this.doCancel,this),this._scrollList=null,this._timeTF=null,this._selectChildData=null,this._allianceVo=null,this._index=null,this._rank=0,this._curTabIdx=0,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceRankPopupView.prototype,"AllianceRankPopupView");var AllianceRankScrollItem=function(t){function e(){var e=t.call(this)||this;return e._rankData=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=510,this.height=136+this.getSpaceY(),this._rankData=e,this._itemIndex=t;var i=BaseBitmap.create("public_9_bg14");if(i.width=this.width,i.height=136,this.addChild(i),3>t){var a=BaseBitmap.create("dinner_rank"+String(t+1));a.x=42-a.width/2,a.y=10,this.addChild(a)}else{var a=BaseBitmap.create("dinner_rankbg");a.x=42-a.width/2,a.y=10,this.addChild(a);var n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);n.text=String(t+1),n.x=42-n.width/2,n.y=19,this.addChild(n),e.id==Api.playerVoApi.getPlayerAllianceId()&&(n.textColor=TextFieldConst.COLOR_WARN_RED)}var o="<font u ='true'>"+e.name+"</font>",s=ComponentManager.getTextField(o,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_YELLOW2);s.x=80,s.y=25,this.addChild(s),s.addTouchTap(this.lookAlliance,this,null);var r="("+LanguageManager.getlocal("servant_infoLv")+"："+e.level+")",l=ComponentManager.getTextField(r,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_YELLOW2);l.x=s.x+s.width+10,l.y=25,this.addChild(l);var h=BaseBitmap.create("public_line1");h.x=this.width/2-h.width/2,h.y=63,this.addChild(h);var d=LanguageManager.getlocal("allianceRankLeaderName")+e.creatorname,g=ComponentManager.getTextField(d,18,TextFieldConst.COLOR_BROWN);g.x=s.x,g.y=s.y+s.height+24,this.addChild(g);var c=LanguageManager.getlocal("allianceRankTotalPower")+e.affect,p=ComponentManager.getTextField(c,18,TextFieldConst.COLOR_BROWN);p.x=s.x,p.y=g.y+g.height+10,this.addChild(p);var _=LanguageManager.getlocal("allianceMemberTitle",[e.mn+"/"+e.maxmn]),u=ComponentManager.getTextField(_,18,TextFieldConst.COLOR_BROWN);u.x=g.x+260,u.y=g.y,this.addChild(u),e.id==Api.playerVoApi.getPlayerAllianceId()&&(s.textColor=TextFieldConst.COLOR_WARN_RED,l.textColor=TextFieldConst.COLOR_WARN_RED),this._applyBtn=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"allianceRankApply",this.applyBtnClick,this),this._applyBtn.x=375,this._applyBtn.y=10,this.addChild(this._applyBtn),this._applyBtn.setColor(TextFieldConst.COLOR_BLACK),this._cancelApplyBtn=ComponentManager.getButton(ButtonConst.BTN_SMALL_RED,"allianceRankCancelApply",this.cancelBtnClick,this),this._cancelApplyBtn.x=375,this._cancelApplyBtn.y=10,this.addChild(this._cancelApplyBtn),this._cancelApplyBtn.setColor(TextFieldConst.COLOR_BLACK),this._cancelApplyBtn.visible=!1;for(var C=Api.allianceVoApi.getMyAllianceVo(),t=0;t<C.apply.length;t++){var f=C.apply[t];e.id==f&&(this._applyBtn.visible=!1,this._cancelApplyBtn.visible=!0)}0!=Api.playerVoApi.getPlayerAllianceId()&&(this._applyBtn.visible=!1,this._cancelApplyBtn.visible=!1)},e.prototype.lookAlliance=function(){ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCESHOWINFOPOPUPVIEW,{aid:this._rankData.id})},e.prototype.refreshData=function(t){var e=Api.allianceVoApi.getMyAllianceVo();this._applyBtn.visible=!0,this._cancelApplyBtn.visible=!1;for(var t=0;t<e.apply.length;t++){var i=e.apply[t];this._rankData.id==i&&(this._applyBtn.visible=!1,this._cancelApplyBtn.visible=!0)}},e.prototype.applyBtnClick=function(){var t=Api.allianceVoApi.getMyAllianceVo();if(t.nextt-GameData.serverTime>0)return void App.CommonUtil.showTip(LanguageManager.getlocal("allianceJoinTip"));if(this._rankData.mn>=this._rankData.maxmn)return void App.CommonUtil.showTip(LanguageManager.getlocal("alliance_joinNumMax"));var e=Config.AlliancebaseCfg.personMaxApply;return t.apply.length>=e?void App.CommonUtil.showTip(LanguageManager.getlocal("alliance_joinMax",[e.toString()])):void App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_ALLIANCE_APPLYALLIANCE,{aid:this._rankData.id,index:this._itemIndex})},e.prototype.cancelBtnClick=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_ALLIANCE_CANCELAPPLYALLIANCE,{aid:this._rankData.id,index:this._itemIndex})},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._rankData=null,this._applyBtn=null,this._cancelApplyBtn=null,this._itemIndex=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AllianceRankScrollItem.prototype,"AllianceRankScrollItem");var AllianceSetPoPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this._allianceMemberVo=this.param.data.allianceMemberVo;var t=(Api.allianceVoApi.getMyAllianceVo(),""),e="";2==this._allianceMemberVo.po&&(t="alliance_changePo3",e="alliance_changePo4"),3==this._allianceMemberVo.po&&(t="alliance_changePo2",e="alliance_changePo4"),4==this._allianceMemberVo.po&&(t="alliance_changePo2",e="alliance_changePo3");var i=this.getItem(this.infoBtnClick,t,TextFieldConst.COLOR_WHITE);this.addChildToContainer(i),i.x=this.viewBg.width/2-i.width/2,i.y=30;var a=this.getItem(this.applyBtnClick,e,TextFieldConst.COLOR_WHITE);this.addChildToContainer(a),a.x=this.viewBg.width/2-a.width/2,a.y=i.y+i.height+15;var n=this.getItem(this.kickBtnClick,"alliance_changePo5",TextFieldConst.COLOR_WHITE);this.addChildToContainer(n),n.x=this.viewBg.width/2-n.width/2,n.y=a.y+a.height+15},e.prototype.infoBtnClick=function(){this.changePo(1)},e.prototype.applyBtnClick=function(){this.changePo(2)},e.prototype.kickBtnClick=function(){var t=LanguageManager.getlocal("alliance_changeKickTip",[this._allianceMemberVo.name]);ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"alliance_changePo5",msg:t,callback:this.doKick,handler:this,needCancel:!0})},e.prototype.doKick=function(){this.request(NetRequestConst.REQUEST_ALLIANCE_KICKALLIANCE,{auid:this._allianceMemberVo.uid})},e.prototype.changePo=function(t){var e=2,i=0,a=0;return 2==this._allianceMemberVo.po&&(i=3,a=4),3==this._allianceMemberVo.po&&(i=2,a=4),4==this._allianceMemberVo.po&&(i=2,a=3),e=1==t?i:a,2==e&&Api.allianceVoApi.getAlliancePo2Num()>0?void App.CommonUtil.showTip(LanguageManager.getlocal("alliance_changePoTip1")):3==e&&Api.allianceVoApi.getAlliancePo3Num()>=5?void App.CommonUtil.showTip(LanguageManager.getlocal("alliance_changePoTip2")):void this.request(NetRequestConst.REQUEST_ALLIANCE_SETPOS,{auid:this._allianceMemberVo.uid,pos:e})},e.prototype.receiveData=function(t){if(t.ret){if(1==t.data.data.allianceFlag)return void App.CommonUtil.showTip(LanguageManager.getlocal("allianceErrorMsg1"));if(2==t.data.data.allianceFlag)return void App.CommonUtil.showTip(LanguageManager.getlocal("allianceErrorMsg2"));if(3==t.data.data.allianceFlag)return void App.CommonUtil.showTip(LanguageManager.getlocal("allianceErrorMsg3"));t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_SETPOS&&this.param.data.callback&&(this.param.data.callback.apply(this.param.data.handler,[]),App.CommonUtil.showTip(LanguageManager.getlocal("alliance_changePoTip3")),this.hide()),t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_KICKALLIANCE&&(App.CommonUtil.showTip(LanguageManager.getlocal("alliance_changeKickSuccess")),this.hide())}},e.prototype.getItem=function(t,e,i){var a=new BaseDisplayObjectContainer,n=BaseBitmap.create("public_9_bg28");n.width=500,a.addChild(n);var o=ComponentManager.getTextField(LanguageManager.getlocal(e),TextFieldConst.FONTSIZE_TITLE_SMALL);return o.textColor=i,o.x=a.width/2-o.width/2,o.y=a.height/2-o.height/2,a.addChild(o),n.addTouch(this.eventHandler,this,[t,n,this]),a},e.prototype.eventHandler=function(t,e,i,a){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:i.texture=ResourceManager.getRes("public_9_bg28_down");break;case egret.TouchEvent.TOUCH_CANCEL:i.texture=ResourceManager.getRes("public_9_bg28");break;case egret.TouchEvent.TOUCH_END:i.texture=ResourceManager.getRes("public_9_bg28"),e.apply(a)}},e.prototype.getTitleStr=function(){return"allianceMemberChangePo"},e.prototype.dispose=function(){this._allianceMemberVo=null,this._inputTextField=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceSetPoPopupView.prototype,"AllianceSetPoPopupView");var AllianceShowInfoPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=(Api.allianceVoApi.getAllianceVo(),BaseBitmap.create("public_9_bg4"));t.width=520,t.height=565,t.x=this.viewBg.x+this.viewBg.width/2-t.width/2,t.y=25,this.addChildToContainer(t);var e=BaseBitmap.create("public_9_probiginnerbg");e.width=500,e.height=226,e.setPosition(this.viewBg.width/2-e.width/2,70),this.addChildToContainer(e);var i=LanguageManager.getlocal("allianceFindInfo1",[this._allianceInfo.name,this._allianceInfo.level]),a=ComponentManager.getTextField(i,TextFieldConst.FONTSIZE_CONTENT_COMMON);a.x=50,a.y=40,this.addChildToContainer(a);var n=Config.AllianceCfg.getAllianceCfgByLv(this._allianceInfo.level),o=LanguageManager.getlocal("allianceFindInfo3",[this._allianceInfo.exp+"/"+n.exp]),s=ComponentManager.getTextField(o,TextFieldConst.FONTSIZE_CONTENT_COMMON);s.y=a.y+a.height+20,s.x=a.x,this.addChildToContainer(s);var r=LanguageManager.getlocal("allianceFindInfo4",[this._allianceInfo.wealth]),l=ComponentManager.getTextField(r,TextFieldConst.FONTSIZE_CONTENT_COMMON);l.y=s.y+s.height+10,l.x=a.x,this.addChildToContainer(l);var h=LanguageManager.getlocal("allianceFindInfo5",[this._allianceInfo.affect]),d=ComponentManager.getTextField(h,TextFieldConst.FONTSIZE_CONTENT_COMMON);d.y=l.y+l.height+10,d.x=a.x,this.addChildToContainer(d);var g=LanguageManager.getlocal("allianceFindInfo7",[this._allianceInfo.cqq]),c=ComponentManager.getTextField(g,TextFieldConst.FONTSIZE_CONTENT_COMMON);c.y=d.y+d.height+10,c.x=a.x,this.addChildToContainer(c);var p=LanguageManager.getlocal("allianceFindInfo8",[this._allianceInfo.intro]),_=ComponentManager.getTextField(p,TextFieldConst.FONTSIZE_CONTENT_COMMON);_.y=c.y+c.height+10,_.x=a.x,_.width=480,_.lineSpacing=5,this.addChildToContainer(_);var u=LanguageManager.getlocal("allianceFindInfo6",[this._allianceInfo.mn+"/"+this._allianceInfo.maxmn]),C=ComponentManager.getTextField(u,TextFieldConst.FONTSIZE_CONTENT_COMMON);C.y=e.y+e.height+10,C.x=a.x,this.addChildToContainer(C);var f=BaseBitmap.create("public_9_probiginnerbg");f.width=500,f.height=250,f.setPosition(this.viewBg.width/2-f.width/2,e.y+e.height+40),this.addChildToContainer(f);var m=BaseBitmap.create("dinner_rank_titlebg");m.width=f.width,m.height=36,m.setPosition(f.x,f.y),this.addChildToContainer(m);var T=ComponentManager.getTextField(LanguageManager.getlocal("ranknickName"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);T.setPosition(120,m.y+m.height/2-T.height/2),this.addChildToContainer(T);var y=ComponentManager.getTextField(LanguageManager.getlocal("alliance_po"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);y.setPosition(387,m.y+m.height/2-y.height/2),this.addChildToContainer(y);var v=this._allianceMemberInfo,A=egret.Rectangle.create();A.setTo(0,0,e.width-10,f.height-50);var w=ComponentManager.getScrollList(AllianceShowInfoScrollItem,v,A);this.addChildToContainer(w),w.x=e.x+5,w.y=m.y+m.height+3},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_ALLIANCE_GETDETAILS,requestData:{allianceId:this.param.data.aid}}},e.prototype.receiveData=function(t){t.data.ret<0||t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_GETDETAILS&&(this._allianceInfo=t.data.data.falliance,this._allianceMemberInfo=t.data.data.falliancemember,this._allianceMemberInfo.sort(function(t,e){return Number(t.po)-Number(e.po)}))},e.prototype.getTitleStr=function(){return"allianceFindIInfo"},e.prototype.dispose=function(){this._allianceInfo=null,this._allianceMemberInfo=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceShowInfoPopupView.prototype,"AllianceShowInfoPopupView");var AllianceShowInfoScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=510,this.height=50+this.getSpaceY();var i=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_YELLOW);i.x=118-i.width/2,i.y=5,this.addChild(i);var a=LanguageManager.getlocal("allianceMemberPo"+e.po),n=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_YELLOW);n.x=368-n.width/2,n.y=5,this.addChild(n);var o=BaseBitmap.create("dinner_line");o.x=this.width/2-o.width/2,o.y=40,this.addChild(o)},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AllianceShowInfoScrollItem.prototype,"AllianceShowInfoScrollItem");var AllianceTimePopupView=function(t){function e(){var e=t.call(this)||this;return e._bgHeight=0,e._startTime=0,e._uid=null,e._type=1,e._callback=null,e}return __extends(e,t),e.prototype.initView=function(){this._uid=this.param.data.auid,this._type=this.param.data.type,this._pswd=this.param.data.pswd,this._startTime=GameData.serverTime+30;var t=BaseBitmap.create("public_9_bg4");t.width=520,t.height=150,t.x=this.viewBg.x+this.viewBg.width/2-t.width/2,t.y=9,this.addChildToContainer(t),this._bgHeight=t.height;var e=LanguageManager.getlocal("alliance_turnTime",["30"]);2==this.param.data.type&&(e=LanguageManager.getlocal("alliance_disTime",["30"])),this._msgTF=ComponentManager.getTextField(e,TextFieldConst.FONTSIZE_CONTENT_COMMON),this._msgTF.width=480,this._msgTF.setColor(TextFieldConst.COLOR_BLACK),this._msgTF.textAlign=TextFieldConst.ALIGH_CENTER,this._msgTF.x=this.viewBg.x+this.viewBg.width/2-this._msgTF.width/2,this._msgTF.y=t.y+t.height/2-this._msgTF.height/2,this._msgTF.lineSpacing=10,this.addChildToContainer(this._msgTF);var i=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"cancelBtn",this.clickConHandler,this);i.setColor(TextFieldConst.COLOR_BLACK),i.x=this.getShowWidth()/2-i.width/2,i.y=t.y+t.height+20,this.addChildToContainer(i)},e.prototype.tick=function(){var t=LanguageManager.getlocal("alliance_turnTime",[this._startTime-GameData.serverTime+""]);2==this.param.data.type&&(t=LanguageManager.getlocal("alliance_disTime",[this._startTime-GameData.serverTime+""])),this._msgTF.text=t,this._startTime-GameData.serverTime<=0&&(1==this._type&&(App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_ALLIANCE_TRANSFER,{auid:this._uid}),this.hide()),2==this._type&&(this.request(NetRequestConst.REQUEST_ALLIANCE_DISBAND,{pswd:this._pswd}),App.CommonUtil.showTip(LanguageManager.getlocal("allianceManageDisTip"))))},e.prototype.receiveData=function(t){t.data.ret<0||t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_DISBAND&&(App.CommonUtil.showTip(LanguageManager.getlocal("allianceManageDisTip")),this.hide())},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this)},e.prototype.clickConHandler=function(t){1==this._type&&App.CommonUtil.showTip(LanguageManager.getlocal("alliance_turnFail")),2==this._type&&App.CommonUtil.showTip(LanguageManager.getlocal("allianceManageDisTip2")),this.param.data.callback&&this.param.data.callback.apply(this.param.data.handler,null),this.hide()},e.prototype.clickCancelHandler=function(t){this.hide()},e.prototype.getTitleStr=function(){return this.param.data.title},e.prototype.getCloseBtnName=function(){return null},e.prototype.hide=function(){1==this._type,t.prototype.hide.call(this)},e.prototype.dispose=function(){this._bgHeight=0,this._msgTF=null,this._startTime=0,this._uid=null,this._type=1,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceTimePopupView.prototype,"AllianceTimePopupView");var AllianceTurnPopupView=function(t){function e(){var e=t.call(this)||this;return e._curTabIdx=0,e._index=0,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_ALLIANCE_TRANSFER,this.doApply,this),this._allianceVo=Api.allianceVoApi.getAllianceVo();var t=BaseBitmap.create("public_9_probiginnerbg");t.width=520,t.height=544,t.x=this.viewBg.width/2-t.width/2,t.y=60,this.addChildToContainer(t);var e=LanguageManager.getlocal("alliance_wealth",[this._allianceVo.wealth.toString()]),i=ComponentManager.getTextField(e,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);i.x=30,i.y=20,this.addChildToContainer(i);var a=LanguageManager.getlocal("alliance_turnCost",["10000"]),n=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);n.x=30,n.y=t.y+t.height+10,this.addChildToContainer(n);var o=LanguageManager.getlocal("alliance_turnObject"),s=ComponentManager.getTextField(o,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);s.x=30,s.y=n.y+n.height+10,this.addChildToContainer(s);var r=Api.allianceVoApi.getAllianceTurnVoList(),l=egret.Rectangle.create();l.setTo(0,0,t.width-10,t.height-20),this._scrollList=ComponentManager.getScrollList(AllianceTurnScrollItem,r,l),this.addChildToContainer(this._scrollList),this._scrollList.x=t.x+5,this._scrollList.y=t.y+10,this._scrollList.setEmptyTip(LanguageManager.getlocal("allianceTurnTip"))},e.prototype.refuseAllHandler=function(){return this._scrollList.getItemByIndex(0)?void this.request(NetRequestConst.REQUEST_ALLIANCE_REFUSEALLAPPLY,{}):void App.CommonUtil.showTip(LanguageManager.getlocal("allianceApplyTip"))},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_ALLIANCE_GETMEMBER,requestData:{}}},e.prototype.receiveData=function(t){if(!(t.data.ret<0)){if(1==t.data.data.allianceFlag)return App.CommonUtil.showTip(LanguageManager.getlocal("allianceErrorMsg1")),void this.hide();if(2==t.data.data.allianceFlag)return void App.CommonUtil.showTip(LanguageManager.getlocal("allianceErrorMsg2"));if(3==t.data.data.allianceFlag)return void App.CommonUtil.showTip(LanguageManager.getlocal("allianceErrorMsg3"));t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_GETMEMBER,t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_TRANSFER&&(App.CommonUtil.showTip(LanguageManager.getlocal("alliance_turnSuccess")),this.hide())}},e.prototype.doApply=function(t){var e=t.data;this._index=e.index,this.request(NetRequestConst.REQUEST_ALLIANCE_TRANSFER,{auid:t.data.auid})},e.prototype.rankBtnClick=function(){},e.prototype.tabBtnClickHandler=function(t){this._curTabIdx=t.index,this.refreshRankList()},e.prototype.refreshRankList=function(){},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["dinner_rankbg","dinnerrankpopupview"])},e.prototype.getTitleStr=function(){return"alliance_changePo1"},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_ALLIANCE_TRANSFER,this.doApply,this),this._scrollList=null,this._timeTF=null,this._selectChildData=null,this._allianceVo=null,this._index=null,this._curTabIdx=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AllianceTurnPopupView.prototype,"AllianceTurnPopupView");var AllianceTurnScrollItem=function(t){function e(){var e=t.call(this)||this;return e._applyData=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=510,this.height=156+this.getSpaceY(),this._applyData=e,this._itemIndex=t;var i=BaseBitmap.create("public_9_bg14");i.width=this.width,i.height=156,this.addChild(i);var a=e.name+"("+LanguageManager.getlocal("allianceMemberPo"+e.po)+")";this._nameTf=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN),this._nameTf.x=23,this._nameTf.y=15,this.addChild(this._nameTf),e.uid==Api.playerVoApi.getPlayerID()&&(this._nameTf.textColor=TextFieldConst.COLOR_WARN_YELLOW2);var n=BaseBitmap.create("public_line1");n.x=this.width/2-n.width/2,n.y=40,this.addChild(n);var o=BaseBitmap.create("public_chatheadbg");o.x=20,o.y=50,this.addChild(o);var s=egret.Rectangle.create();s.setTo(0,0,136,143);var r=BaseLoadBitmap.create(Api.playerVoApi.getUserHeadImgPathById(e.pic),s);r.x=20,r.y=43,r.setScale(2/3),this.addChild(r);var l=LanguageManager.getlocal("allianceMemberInfo1",[e.power.toString()]),h=ComponentManager.getTextField(l,18,TextFieldConst.COLOR_BROWN);h.x=120,h.y=this._nameTf.y+this._nameTf.height+14,this.addChild(h);var d=LanguageManager.getlocal("allianceMemberInfo2",[Api.playerVoApi.getPlayerOfficeByLevel(e.level)]),g=ComponentManager.getTextField(d,18,TextFieldConst.COLOR_BROWN);g.x=120,g.y=h.y+h.height+7,this.addChild(g);var c=LanguageManager.getlocal("allianceMemberInfo3",[e.ctv+"/"+e.tctv]),p=ComponentManager.getTextField(c,18,TextFieldConst.COLOR_BROWN);p.x=120,p.y=g.y+g.height+7,this.addChild(p);var _=GameData.serverTime-e.logindt,u=LanguageManager.getlocal("allianceMemberInfo4",[App.DateUtil.getFormatBySecond(_,4)]),C=ComponentManager.getTextField(u,18,TextFieldConst.COLOR_BROWN);C.x=120,C.y=p.y+p.height+7,this.addChild(C);var f=(Api.allianceVoApi.getMyAllianceVo(),ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"alliance_turn",this.chooseBtnClick,this));f.x=360,f.y=95,this.addChild(f),f.setColor(TextFieldConst.COLOR_BLACK)},e.prototype.chooseBtnClick=function(){var t=LanguageManager.getlocal("alliance_turnTip",["10000"]);ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"alliance_changePo1",msg:t,callback:this.doTurn,handler:this,needCancel:!0})},e.prototype.doTurn=function(){var t=Api.allianceVoApi.getAllianceVo();return t.wealth<1e4?void App.CommonUtil.showTip(LanguageManager.getlocal("alliance_turnTip1")):void ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCETIMEPOPUPVIEW,{type:1,auid:this._applyData.uid})},e.prototype.refreshData=function(){var t=Api.allianceVoApi.getAllianceMemberInfoById(this._applyData.uid),e=t.name+"("+LanguageManager.getlocal("allianceMemberPo"+t.po)+")";this._nameTf.text=e},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._applyData=null,this._itemIndex=null,this._nameTf=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AllianceTurnScrollItem.prototype,"AllianceTurnScrollItem");var AllianceView=function(t){function e(){var e=t.call(this)||this;return e._moreArrow=null,e._isShowMore=!1,e._currMaskBmp=null,e.touchBoo=!0,e.moreBg=null,e._atkraceInfoVoList=[],e.bottom=null,e.allianceVo=null,e.moveContainer=null,e.nameTxt=null,e._describeTxt=null,e._applyRedDotSp=null,e._strTxt=null,e._touchBg=null,e.bottomBtnCfg=[{id:1,btnName:"manage",btnIconImg:"alliance_manageicon",btnNameImg:"alliance_manage"},{id:2,btnName:"build",btnIconImg:"alliance_buildicon",btnNameImg:"alliance_build"},{id:3,btnName:"member",btnIconImg:"alliance_memicon",btnNameImg:"alliance_mem"},{id:4,btnName:"exchange",btnIconImg:"alliance_exicon",btnNameImg:"alliance_ex"},{id:5,btnName:"boss",btnIconImg:"alliance_bossicon",btnNameImg:"alliance_boss"},{id:6,btnName:"rank",btnIconImg:"allianc_rankicon",btnNameImg:"alliance_rank"}],e}return __extends(e,t),e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_ALLIANCE_INITALLIANCE,requestData:{}}},e.prototype.initView=function(){App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_ALLIANCE,this.checkData,this),App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_ALLIANCE_TRANSFER,this.refreshBottom,this),App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_ALLIANCE_EXITALLIANCE,this.quitAlliance,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_MESSAGE_ALLIANCE_BEKICK,this.doQuickAlliance,this),App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_ALLIANCE_DISBAND,this.quitAlliance,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_CHAT_COME,this.doRefreshChat,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.checkData,this);var t=Api.allianceVoApi.getAllianceVo();this.allianceVo=t;var e=BaseBitmap.create("alliance_bg1");e.x=0,e.y=-15,this.addChildToContainer(e);var i=BaseBitmap.create("story_npc_8");i.x=0,i.y=GameConfig.stageHeigth-this.container.y-467-150,this.addChildToContainer(i),this._wordbg=BaseBitmap.create("public_9_bg25"),this._wordbg.x=30,this._wordbg.y=i.y-100,this._wordbg.width=260,this._wordbg.height=78,this.addChildToContainer(this._wordbg),this._wordbgCor=BaseBitmap.create("public_9_bg25_tail"),this._wordbgCor.x=160,this._wordbgCor.y=this._wordbg.y+this._wordbg.height-3,this.addChildToContainer(this._wordbgCor),this._wordsText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._wordsText.text=LanguageManager.getlocal("allianceBOSSTip1"),this._wordsText.x=this._wordbg.x+20,this._wordsText.y=this._wordbg.y+20,this._wordsText.width=220,this._wordsText.height=80,this.addChildToContainer(this._wordsText);var a=BaseBitmap.create("alliance_attbg");a.width=612,a.x=15,a.y=-5,this.addChildToContainer(a),this._progressBar=ComponentManager.getProgressBar("progress9","progress9_bg",499),this._progressBar.x=a.x+91,this._progressBar.y=a.y+71,this.addChildToContainer(this._progressBar);var n=Config.AllianceCfg.getAllianceCfgByLv(t.level.toString()),o=t.exp+" / "+n.exp;this._progressBar.setPercentage(t.exp/n.exp),this._expTF=ComponentManager.getTextField(o,18,TextFieldConst.COLOR_WHITE),this._expTF.x=this._progressBar.x+this._progressBar.width/2-this._expTF.width/2,this._expTF.y=this._progressBar.y+this._progressBar.height/2-this._expTF.height/2,this.addChildToContainer(this._expTF);var s=BaseBitmap.create("public_alphabg");s.width=100,s.height=100,s.x=15,s.y=-5,this.addChildToContainer(s),s.addTouchTap(this.infoCilck,this);var r=BaseBitmap.create("alliance_level");r.x=a.x+13,r.y=a.y+30,this.addChildToContainer(r),this._levelTF=ComponentManager.getBitmapText(t.level.toString(),"recharge_fnt"),this._levelTF.x=r.x+r.width/2-this._levelTF.width/2,this._levelTF.y=r.y+r.height+5,this.addChildToContainer(this._levelTF),this._allianceNameTF=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_YELLOW),this._allianceNameTF.text=t.name,this._allianceNameTF.x=a.x+120,this._allianceNameTF.y=a.y+20,this.addChildToContainer(this._allianceNameTF);var l=LanguageManager.getlocal("allianceWealthTitle",[t.wealth.toString()]);this._moneyTF=ComponentManager.getTextField(l,18,TextFieldConst.COLOR_WHITE),this._moneyTF.x=this._allianceNameTF.x,this._moneyTF.y=a.y+50,this.addChildToContainer(this._moneyTF);var h=LanguageManager.getlocal("allianceMemberTitle",[t.mn+"/"+t.maxmn]);this._memberTF=ComponentManager.getTextField(h,18,TextFieldConst.COLOR_WHITE),this._memberTF.x=300,this._memberTF.y=this._moneyTF.y,this.addChildToContainer(this._memberTF);var d=LanguageManager.getlocal("allianceIDTitle",[t.id.toString()]),g=ComponentManager.getTextField(d,18,TextFieldConst.COLOR_WHITE);g.x=450,g.y=this._moneyTF.y,this.addChildToContainer(g);var c=BaseBitmap.create("alliance_noticebg");c.x=340,c.y=200,this.addChildToContainer(c);var p=BaseBitmap.create("alliance_notice");p.x=c.x+c.width/2-p.width/2,p.y=c.y+20,this.addChildToContainer(p);var _=t.message;""==_&&(_=LanguageManager.getlocal("allianceMessageTip")),this._messageTF=ComponentManager.getTextField(_,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this._messageTF.width=220,this._messageTF.x=c.x+c.width/2-this._messageTF.width/2,this._messageTF.y=c.y+20+40,this.addChildToContainer(this._messageTF),this._bBg=BaseBitmap.create("arena_bottom"),this._bBg.y=GameConfig.stageHeigth-this._bBg.height,this.addChild(this._bBg),this.bottom=this._bBg,this.initButtom(),this.showAni(),this.tick(),this.checkRedPoint()},e.prototype.showAni=function(){this.param&&ViewController.getInstance().openView(ViewConst.BASE.ALLIANCECREATEANIVIEW,{type:this.param.data.type})
},e.prototype.showAni2=function(){ViewController.getInstance().openView(ViewConst.BASE.ALLIANCECREATEANIVIEW,{type:2})},e.prototype.initButtom=function(){var t=Api.allianceVoApi.getMyAllianceVo();1==t.info.joinFlag&&this.showAni2(),this._bottomContiner=new BaseDisplayObjectContainer,this.addChild(this._bottomContiner);var e=BaseBitmap.create(ResourceManager.getRes("mainui_chatbg"));e.width=GameConfig.stageWidth,e.height=35,e.x=0,e.y=0,this._bottomContiner.addChild(e);var i=BaseBitmap.create("public_9_alliancebtnbg");i.width=GameConfig.stageWidth,this._bottomContiner.addChild(i),this._bottomContiner.setPosition(0,this._bBg.y-i.height+30);var a=95,n=0,o=0;1!=t.po&&2!=t.po&&(o=1);var s=o;for(this.bottomBtnCfg&&6==this.bottomBtnCfg.length&&Api.switchVoApi.checkOpenShenhe()&&this.bottomBtnCfg.pop(),s;s<this.bottomBtnCfg.length;s++){var r=this.bottomBtnCfg[s],l=BaseBitmap.create("alliance_iconbg");l.x=43+a*n,l.y=60,this._bottomContiner.addChild(l),n+=1}for(n=0,s=o;s<this.bottomBtnCfg.length;s++){var r=this.bottomBtnCfg[s],h=ComponentManager.getButton(r.btnIconImg,"",this.bottomBtnClickHandler,this,[r]);h.x=38+a*n,h.y=50,h.name=r.btnName,this._bottomContiner.addChild(h),n+=1}for(n=0,s=o;s<this.bottomBtnCfg.length;s++){var r=this.bottomBtnCfg[s],d=BaseBitmap.create(r.btnNameImg);d.x=35+a*n,d.y=120,this._bottomContiner.addChild(d),n+=1}e.touchEnabled=!0,e.addTouchTap(this.chatBgClickHandler,this);var g=BaseBitmap.create(ResourceManager.getRes("mainui_chatIcon"));g.anchorOffsetX=g.width/2,g.anchorOffsetY=g.height/2,g.x=g.width/2+10,g.y=e.y+e.height/2,this._bottomContiner.addChild(g),egret.Tween.get(g,{loop:!0}).to({scaleX:.8,scaleY:.8},1e3).to({scaleX:1,scaleY:1},1e3);var c=Api.chatVoApi.getLastMessage();c||(c="1"),this._chatTxt=ComponentManager.getTextField(c,TextFieldConst.FONTSIZE_CONTENT_SMALL),this._chatTxt.x=g.x+20,this._chatTxt.y=g.y-this._chatTxt.height/2,this._chatTxt.width=480,this._chatTxt.height=50,this._chatTxt.lineSpacing=50,this._bottomContiner.addChild(this._chatTxt),this._chatTxtPoint=ComponentManager.getTextField("...",TextFieldConst.FONTSIZE_CONTENT_SMALL),this._chatTxtPoint.x=522,this._chatTxtPoint.y=g.y-this._chatTxtPoint.height/2-5,this._chatTxtPoint.visible=!1,this._bottomContiner.addChild(this._chatTxtPoint),this.doRefreshChat();var p=ComponentManager.getButton("arena_more",null,this.showMoreHandle,this);p.setPosition(GameConfig.stageWidth-p.width-18,GameConfig.stageHeigth-this.bottom.height/2-p.height/2),this.addChild(p),this._moreArrow=BaseBitmap.create("arena_arrow"),this._moreArrow.setPosition(p.x-this._moreArrow.width-5,GameConfig.stageHeigth-this.bottom.height/2-this._moreArrow.height/2),this.addChild(this._moreArrow),this._atkraceInfoVoList=this.allianceVo.log,this.showText()},e.prototype.showMoreHandle=function(){this.touchBoo&&(this._isShowMore=!this._isShowMore,1==this._isShowMore?(this._moreArrow.scaleY=-1,this._moreArrow.y+=this._moreArrow.height,this.showList()):(this._moreArrow.scaleY=1,this._moreArrow.y-=this._moreArrow.height,this.closeList()))},e.prototype.showList=function(){if(this.moveContainer=new BaseDisplayObjectContainer,this.addChild(this.moveContainer),this.moreBg=BaseBitmap.create("arena_bottom_bg"),this.moreBg.width=640,this.moreBg.height=GameConfig.stageHeigth-330,this.moveContainer.addChild(this.moreBg),this._currMaskBmp=BaseBitmap.create("public_9_viewmask"),this._currMaskBmp.width=GameConfig.stageWidth,this._currMaskBmp.height=GameConfig.stageHeigth,this._currMaskBmp.touchEnabled=!0,this.addChild(this._currMaskBmp),this.setChildIndex(this._currMaskBmp,this.getChildIndex(this.bottom)),this._touchBg=BaseBitmap.create("public_9_bg25"),this._touchBg.width=640,this._touchBg.height=260,this._touchBg.x=0,this._touchBg.y=-240,this._touchBg.alpha=0,this._touchBg.addTouchTap(this.showMoreHandle,this),this.moveContainer.addChild(this._touchBg),this.allianceVo.log&&this.allianceVo.log.length>0){var t=egret.Rectangle.create();t.setTo(0,10,640,GameConfig.stageHeigth-340),this._scrollList=ComponentManager.getScrollList(AllianceMoreItem,this._atkraceInfoVoList,t),this.moveContainer.addChild(this._scrollList),this._scrollList.y=5}else{var e=ComponentManager.getTextField(LanguageManager.getlocal("atkracedes3"),20);e.x=250,e.y=300,this.moveContainer.addChild(e)}this.moveContainer.y=1150,this.touchBoo=!1,egret.Tween.get(this.moveContainer).to({y:260},500).call(function(){egret.Tween.removeTweens(this.moveContainer),this.touchBoo=!0},this)},e.prototype.showText=function(){if(this._atkraceInfoVoList&&this._atkraceInfoVoList.length>0){var t=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);t.text=this._atkraceInfoVoList[0][2],t.x=20,t.y=GameConfig.stageHeigth-67,this.addChild(t),this.nameTxt=t;var e=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);e.x=440,e.y=GameConfig.stageHeigth-46,e.text="...",this.addChild(e),e.visible=!1,this._strTxt=e;var i=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL),a=Api.allianceVoApi.getStr(this._atkraceInfoVoList[0]);i.x=20,i.y=GameConfig.stageHeigth-40,i.height=16,i.text=a,this._describeTxt=i,i.width>=420?(i.width=420,e.visible=!0):e.visible=!1,this.addChild(i)}},e.prototype.refreshText=function(){this.nameTxt&&this._atkraceInfoVoList.length>1&&this._describeTxt&&(this.nameTxt.text=this._atkraceInfoVoList[0][2],this._describeTxt.text=Api.allianceVoApi.getStr(this._atkraceInfoVoList[0]),this._describeTxt.width>=420?(this._describeTxt.width=420,this._strTxt.visible=!0):this._strTxt.visible=!1)},e.prototype.closeList=function(){this.touchBoo=!1,this.moveContainer&&egret.Tween.get(this.moveContainer).to({y:1150},500).call(function(){this.touchBoo=!0,egret.Tween.removeTweens(this.moveContainer)},this),this._currMaskBmp&&this._currMaskBmp.parent&&(this._currMaskBmp.parent.removeChild(this._currMaskBmp),this._currMaskBmp.dispose(),this._currMaskBmp=null),this._touchBg&&this._touchBg.parent&&(this._touchBg.parent.removeChild(this._touchBg),this._touchBg.dispose(),this._touchBg=null)},e.prototype.refreshBottom=function(){this._bottomContiner&&(this.removeChild(this._bottomContiner),this._bottomContiner=null),this.initButtom()},e.prototype.quitAlliance=function(){App.CommonUtil.showTip(LanguageManager.getlocal("allianceMemberQuitSuccess")),this.hide(),ViewController.getInstance().openView(ViewConst.COMMON.ALLIANCECREATEVIEW)},e.prototype.checkRedPoint=function(){var t=Api.allianceVoApi.getAllianceVo();if(t.apply[0])if(null==this._applyRedDotSp&&this._bottomContiner.getChildByName("manage")){this._applyRedDotSp=BaseBitmap.create("public_dot2");var e=this._bottomContiner.getChildByName("manage");this._applyRedDotSp.x=e.x+e.width-this._applyRedDotSp.width+5,this._applyRedDotSp.y=e.y+10,this._bottomContiner.addChild(this._applyRedDotSp)}else this._applyRedDotSp&&(this._applyRedDotSp.visible=!0);else this._applyRedDotSp&&(this._applyRedDotSp.visible=!1)},e.prototype.bottomBtnClickHandler=function(t){var e=t.btnName;switch(e){case"manage":ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCEMANAGEPOPUPVIEW);break;case"build":ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCEBUILDPOPUPVIEW);break;case"member":ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCEMEMBERPOPUPVIEW);break;case"exchange":ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCEEXPOPUPVIEW);break;case"boss":ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCEBOSSPOPUPVIEW);break;case"rank":ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCERANKPOPUPVIEW)}},e.prototype.chatBgClickHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.CHATVIEWTAB1)},e.prototype.doRefreshChat=function(){this._chatTxt.text=Api.chatVoApi.getLastMessage();var t=ComponentManager.getTextField(Api.chatVoApi.getLastMessage(),TextFieldConst.FONTSIZE_CONTENT_SMALL);t.width>=480?this._chatTxtPoint.visible=!0:this._chatTxtPoint.visible=!1},e.prototype.checkData=function(){var t=NetManager.curReceiveCmd;if(0==Api.playerVoApi.getPlayerAllianceId()&&t!=NetRequestConst.REQUEST_ALLIANCE_DISBAND&&t!=NetRequestConst.REQUEST_ALLIANCE_EXITALLIANCE)return ViewController.getInstance().hideAllView(),void Api.allianceVoApi.openMainView();var e=Api.allianceVoApi.getAllianceVo(),i=LanguageManager.getlocal("allianceWealthTitle",[e.wealth.toString()]),a=LanguageManager.getlocal("allianceMemberTitle",[e.mn+"/"+e.maxmn]);this._allianceNameTF.text=e.name;var n=e.message;""==n&&(n=LanguageManager.getlocal("allianceMessageTip")),this._messageTF.text=n,this._levelTF.text=e.level.toString(),this._memberTF.text=a,this._moneyTF.text=i;var o=Config.AllianceCfg.getAllianceCfgByLv(e.level.toString()),s=e.exp+" / "+o.exp;this._expTF.text=s,this._progressBar.setPercentage(e.exp/o.exp),this._atkraceInfoVoList=e.log,this._scrollList&&(this._scrollList.refreshData(this._atkraceInfoVoList),this._scrollList.y=5),this.refreshText(),this.checkRedPoint()},e.prototype.infoCilck=function(){var t=Api.allianceVoApi.getAllianceVo();ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCESHOWINFOPOPUPVIEW,{aid:t.id})},e.prototype.doQuickAlliance=function(){},e.prototype.createHander=function(){ViewController.getInstance().openView(ViewConst.POPUP.ALLIANCECREATEPOPUPVIEW)},e.prototype.doGetReward=function(t){this.request(NetRequestConst.REQUEST_ACHIEVEMENT_GETREWARDS,{aid:t.data.achId})},e.prototype.receiveData=function(t){var e=GameData.formatRewardItem(t.data.data.rewards);App.CommonUtil.playRewardFlyAction(e)},e.prototype.tick=function(){var t=Api.allianceVoApi.getAllianceVo();t.isBossOpen()?(this._wordbg.visible=!0,this._wordbgCor.visible=!0,this._wordsText.visible=!0):(this._wordbg.visible=!1,this._wordbgCor.visible=!1,this._wordsText.visible=!1)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["alliance_bg1","alliance_attbg","alliance_level","alliance_noticebg","recharge_fnt","alliance_notice","arena_bottom","arena_arrow","arena_bottom_bg","arena_more_down","arena_more","alliance_manageicon","alliance_manage","alliance_buildicon","alliance_build","alliance_memicon","alliance_mem","alliance_exicon","alliance_ex","alliance_bossicon","alliance_boss","allianc_rankicon","alliance_rank","alliance_iconbg","dinner_rank_titlebg","dinner_line","progress9","progress9_bg","rankinglist_line","rankinglist_rankbg","story_npc_8"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_CHAT_COME,this.doRefreshChat,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_ALLIANCE,this.checkData,this),App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_ALLIANCE_TRANSFER,this.refreshBottom,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_MESSAGE_ALLIANCE_BEKICK,this.doQuickAlliance,this),App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_ALLIANCE_DISBAND,this.quitAlliance,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.checkData,this),this._wordbg=null,this._wordbgCor=null,this._wordsText=null,this._progressBar=null,this._levelTF=null,this._expTF=null,this._moneyTF=null,this._memberTF=null,this._messageTF=null,this._bottomContiner=null,this._chatTxt=null,this._chatTxtPoint=null,this._allianceNameTF=null,this._scrollList=null,this._moreArrow=null,this._isShowMore=!1,this._currMaskBmp=null,this.touchBoo=!0,this.moreBg=null,this._atkraceInfoVoList=[],this.bottom=null,this._bBg=null,this.allianceVo=null,this.moveContainer=null,this._describeTxt=null,this._strTxt=null,this._touchBg=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(AllianceView.prototype,"AllianceView");var AtkraceAgreePopupDialog=function(t){function e(){var e=t.call(this)||this;return e._type=0,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["atkrace_popup_bg"])},e.prototype.getTitleStr=function(){return"atkraceViewTitle"},e.prototype.getBgExtraHeight=function(){return 0},e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT,this.doGuide,this);var t=BaseBitmap.create("atkrace_popup_bg");t.setPosition(this.viewBg.width/2-t.width/2,0),this.addChildToContainer(t),this._type=this.param.data.type;var e=this.param.data.sid,i=BaseLoadBitmap.create(Api.servantVoApi.getFullImgPathWithId(e));i.width=324,i.height=373.6,i.x=this.viewBg.width/2-i.width/2,i.y=t.height-i.height,this.addChildToContainer(i);var a=LanguageManager.getlocal("atkraceAgreeAsk"+this._type,[this.param.data.name]),n=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_COMMON);n.width=500,n.lineSpacing=5;var o=BaseBitmap.create("public_9_bg11");o.width=t.width,o.height=n.height+40,o.setPosition(this.viewBg.width/2-o.width/2,t.height-o.height),this.addChildToContainer(o),n.setPosition(this.viewBg.width/2-n.width/2,t.height-n.height-20),this.addChildToContainer(n);var s=[];1==this._type&&s.push("atkraceAgreeAnswer0"),s.push("atkraceAgreeAnswer"+this._type);for(var r=0;r<s.length;r++){var l=BaseBitmap.create("public_9_bg28");l.width=556,l.height=55,l.setPosition(GameConfig.stageWidth/2-l.width/2,GameConfig.stageHeigth/2+260+65*r),this.addChild(l),l.addTouchTap(this.btnClick,this,[r]);var h=ComponentManager.getTextField(LanguageManager.getlocal(s[r]),TextFieldConst.FONTSIZE_CONTENT_COMMON);h.setPosition(l.x+38,l.y+l.height/2-h.height/2),this.addChild(h)}Api.rookieVoApi.isGuiding||(this.touchEnabled=!1,this.y=-200,this.alpha=0,egret.Tween.get(this).to({alpha:1,y:0},500).call(this.remove,this))},e.prototype.remove=function(){this.drawblackMask(),this.touchEnabled=!0},e.prototype.isShowMask=function(){return!1},e.prototype.drawblackMask=function(){var t=BaseBitmap.create("public_9_viewmask");t.width=GameConfig.stageWidth,t.height=GameConfig.stageHeigth,t.touchEnabled=!0,this.addChild(t),this.setChildIndex(t,0)},e.prototype.btnClick=function(t,e){1==this._type&&0==e?this.request(NetRequestConst.REQUEST_ATKRACE_HANDLE,{handle:1}):this.hide()},e.prototype.doGuide=function(){this.request(NetRequestConst.REQUEST_ATKRACE_HANDLE,{handle:1})},e.prototype.receiveData=function(t){1==t.ret&&(ViewController.getInstance().openView(ViewConst.COMMON.ATKRACEARRESTVIEW),this.hide())},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT,this.doGuide,this),this._type=0,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AtkraceAgreePopupDialog.prototype,"AtkraceAgreePopupDialog");var AtkraceArrestView=function(t){function e(){var e=t.call(this)||this;return e._servantInfoArray=[],e._isShowBuy=!1,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["atkrace_arrest_bg","atkrace_enemy_bg","atkrace_my_bg","atkrace_name_bg","atkrace_one_key","atkrace_temp_property","atkrace_text_bg","atkrace_vs","progress7_bg","progress8","signin_had_get"])},e.prototype.initView=function(){this.container.y=this.getTitleButtomY();var t=GameConfig.stageHeigth-this.container.y,e=BaseBitmap.create("atkrace_arrest_bg");e.y=t/2-e.height/2,this.addChildToContainer(e);var i=BaseBitmap.create("atkrace_vs");i.setPosition(GameConfig.stageWidth/2-i.height/2+41,t/2-i.height/2),this.addChildToContainer(i);var a=Api.atkraceVoApi.getMyFightInfo(),n=BaseBitmap.create("atkrace_enemy_bg");this.addChildToContainer(n),this._scoreText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._scoreText.setPosition(22,22),this.addChildToContainer(this._scoreText);var o=Object.keys(a.sids).length,s=a.total;this._servantCount=ComponentManager.getTextField(LanguageManager.getlocal("servant_count")+"("+o+"/"+s+")",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._servantCount.setPosition(GameConfig.stageWidth-this._servantCount.width-22,this._scoreText.y),this.addChildToContainer(this._servantCount),this.resetServantInfo();var r=ComponentManager.getButton("atkrace_text_bg",null,this.tempPropertyClick,this);r.setPosition(19,295),this.addChildToContainer(r);var l=BaseBitmap.create("atkrace_temp_property");l.setPosition(r.width/2-l.width/2,r.height/2-l.height/2),r.addChild(l);var h=BaseBitmap.create("atkrace_my_bg");h.y=t-h.height,this.addChildToContainer(h);var d=BaseBitmap.create("atkrace_name_bg");d.width=270,d.height=35,d.setPosition(320,h.y+23),this.addChildToContainer(d);var g=a.mesid;this._playerScore=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_score",[Api.playerVoApi.getPlayerName(),Api.atkraceVoApi.getPoint().toString()]),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW),this._playerScore.setPosition(345,d.y+d.height/2-this._playerScore.height/2),this.addChildToContainer(this._playerScore);var c=LanguageManager.getlocal("servant_name"+g.sid),p=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_level",[c,g.lv.toString()]),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);p.setPosition(this._playerScore.x,this._playerScore.y+50),this.addChildToContainer(p);var _=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_info_1"),TextFieldConst.FONTSIZE_CONTENT_COMMON);_.setPosition(this._playerScore.x,p.y+40),this.addChildToContainer(_);var u=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_info_2"),TextFieldConst.FONTSIZE_CONTENT_COMMON);u.setPosition(this._playerScore.x,_.y+35),this.addChildToContainer(u);var C=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_info_3"),TextFieldConst.FONTSIZE_CONTENT_COMMON);C.setPosition(this._playerScore.x,u.y+35),this.addChildToContainer(C),this._infoText1=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN),this._infoText1.setPosition(_.x+_.width,_.y),this.addChildToContainer(this._infoText1),this._infoText2=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,this._infoText1.textColor),this._infoText2.setPosition(u.x+u.width,u.y),this.addChildToContainer(this._infoText2),this._infoText3=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,this._infoText1.textColor),this._infoText3.setPosition(C.x+C.width,C.y),this.addChildToContainer(this._infoText3);var f=BaseLoadBitmap.create(Api.servantVoApi.getFullImgPathWithId(g.sid));f.width=324,f.height=373.6,f.y=t-f.height-25,this.addChildToContainer(f),this._progressBar=ComponentManager.getProgressBar("progress8","progress7_bg",GameConfig.stageWidth),this._progressBar.y=t-this._progressBar.height,this.addChildToContainer(this._progressBar),this.resetInfoText()},e.prototype.resetServantInfo=function(){if(this._servantInfoArray.length>0){for(var t in this._servantInfoArray)this._servantInfoArray[t].dispose();this._servantInfoArray.length=0}var e=0,i=Api.atkraceVoApi.getMyFightInfo();for(var a in i.fids){var n=new BaseDisplayObjectContainer;this.addChildToContainer(n),this._servantInfoArray.push(n);var o=i.fids[a],s=Config.ServantCfg.getServantItemById(a),r=BaseLoadBitmap.create("servant_cardbg_"+o.clv);r.width=194,r.height=192,r.setPosition(15+(r.width+14)*e,62),n.addChild(r),e++,r.addTouchTap(this.vsClick,this,[a]);var l=BaseLoadBitmap.create(s.halfIcon);l.width=180,l.height=177,l.x=r.x+r.width/2-l.width/2,l.y=r.y+r.height/2-l.height/2-2,n.addChild(l)}},e.prototype.resetInfoText=function(){var t=Api.atkraceVoApi.getMyFightInfo(),e=t.mesid;this._infoText1.text=e.ability.toString();var i=t.tmpattr,a=0,n=0;i&&(i.atk&&(a=Math.floor(100*i.atk)),i.skill&&(n=Math.floor(100*i.skill))),this._infoText2.text=a.toString()+"%",this._infoText3.text=n.toString()+"%";var o=t.total,s=o-t.fightnum;this._servantCount.text=LanguageManager.getlocal("servant_count")+"("+s+"/"+o+")";var r=t.fname;"robot"==t.uid&&(r=LanguageManager.getlocal("atkRaceRobotName"+t.fname)),this._scoreText.text=LanguageManager.getlocal("atkrace_score",[r,t.fpoint.toString()]),this._progressBar.setText(e.attr+"/"+e.fullattr),this._progressBar.setPercentage(e.attr/e.fullattr),this._playerScore.text=LanguageManager.getlocal("atkrace_score",[Api.playerVoApi.getPlayerName(),Api.atkraceVoApi.getPoint().toString()])},e.prototype.tempPropertyClick=function(){ViewController.getInstance().openView(ViewConst.POPUP.ATKRACEBUYPOPUPVIEW,{f:this.resetInfoText,o:this})},e.prototype.oneKeyClick=function(){ViewController.getInstance().openView(ViewConst.POPUP.ATKRACEREWARDPOPUPVIEW,{})},e.prototype.vsClick=function(t,e){var i=Api.atkraceVoApi.getMyFightInfo();if(this._key=e,0==i.fightnum&&0==this._isShowBuy&&(null==i.tmpattr||0==i.tmpattr.atk&&0==i.tmpattr.blood)){this._isShowBuy=!0;Config.AtkraceCfg.getFightAdd();ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"itemUseConstPopupViewTitle",msg:LanguageManager.getlocal("atkrace_no_property"),callback:this.realFight,handler:this,needCancel:!0})}else this.realFight()},e.prototype.realFight=function(){ViewController.getInstance().openView(ViewConst.BATTLE.ATKRACEBATTLEVIEW,{f:this.resetBattleInfo,o:this,servantid:this._key,f2:this.battleEnd})},e.prototype.resetBattleInfo=function(){this.resetInfoText(),this.resetServantInfo(),this.tempPropertyClick()},e.prototype.battleEnd=function(){this.hide()},e.prototype.receiveData=function(t){},e.prototype.dispose=function(){this._infoText1=null,this._infoText2=null,this._infoText3=null,this._servantCount=null,this._servantInfoArray.length=0,this._scoreText=null,this._progressBar=null,this._isShowBuy=!1,this._key=null,this._playerScore=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(AtkraceArrestView.prototype,"AtkraceArrestView");var AtkraceBattleView=function(t){function e(){var e=t.call(this)||this;return e._isAttackWin=null,e._isEnd=!1,e._callbackF=null,e._callbackF2=null,e._obj=null,e._rewards=null,e._battleInfo=null,e._curRound=0,e._winNumber=0,e._totalNumber=0,e._oldInfo=[],e}return __extends(e,t),e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getRequestData=function(){var t=this.param.data.servantid,e=Api.atkraceVoApi.getMyFightInfo(),i=e.mesid;this._oldInfo[0]={max:i.fullattr,cur:i.attr,level:i.lv,sid:i.sid,ability:i.ability};var a=e.fids[t];return this._oldInfo[1]={max:a.fullattr,cur:a.attr,level:a.lv,sid:t,ability:a.ability,name:e.getFName()},this._winNumber=e.fightnum,this._totalNumber=e.total,{requestType:NetRequestConst.REQUEST_ATKRACE_FIGHT,requestData:{servantid:t}}},e.prototype.receiveData=function(t){1==t.ret?(this._battleInfo=t.data.data.atkreports,this._isAttackWin=1==t.data.data.win):this.hide()},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["atkrace_battle_info","atkrace_skip"])},e.prototype.getBgName=function(){return"arena_bg"},e.prototype.initBg=function(){var t=this.getBgName();if(t){var e=egret.Rectangle.create();e.setTo(0,0,832,1476.8),this.viewBg=BaseLoadBitmap.create(t,e),this.viewBg.setPosition(-96,.2*(GameConfig.stageHeigth-this.viewBg.height)),this.addChild(this.viewBg)}},e.prototype.getCloseBtnName=function(){return null},e.prototype.initView=function(){this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f,this._callbackF2=this.param.data.f2),this._isEnd=!1;var t=BaseBitmap.create("servant_mask");t.width=GameConfig.stageWidth,t.y=GameConfig.stageHeigth-t.height,this.addChildToContainer(t);var e=BaseBitmap.create("servant_mask");e.width=GameConfig.stageWidth,e.scaleY=-1,e.y=e.height,this.addChildToContainer(e),this.setTopProgress(this._oldInfo[1].cur,this._oldInfo[1].max),this.setBottomProgress(this._oldInfo[0].cur,this._oldInfo[0].max);var i=Config.ServantCfg.getServantItemById(this._oldInfo[1].sid).fullIcon,a=Config.ServantCfg.getServantItemById(this._oldInfo[0].sid).fullIcon;this.setUpHero(i,{level:this._oldInfo[1].level,name:LanguageManager.getlocal("servant_name"+this._oldInfo[1].sid),ability:this._oldInfo[1].ability}),this.setDownHero(a,{level:this._oldInfo[0].level,name:LanguageManager.getlocal("servant_name"+this._oldInfo[0].sid),ability:this._oldInfo[0].ability}),this._upHero.x=17,this._downHero.x=280,this._upPositon=egret.Point.create(this._upHero.x,this._upHero.y),this._downPositon=egret.Point.create(this._downHero.x,this._downHero.y);var n=ComponentManager.getButton("atkrace_skip",null,this.skipBattle,this);n.setPosition(GameConfig.stageWidth-n.width-12,45),this.addChild(n),this.showRound()},e.prototype.showRound=function(){if(this._battleInfo.length>this._curRound){var t=this._battleInfo[this._curRound];this.attackHandle(t[0],t[2],t[1]),this._curRound++}else this.showEndGameBefore()},e.prototype.showEndGameBefore=function(){var t;t=this._isAttackWin?this._upHero:this._downHero,egret.Tween.get(t).to({alpha:0},800).call(this.showEndGame,this)},e.prototype.skipBattle=function(){1!=this._isEnd&&this.showEndGame()},e.prototype.showEndGame=function(){this._isEnd=!0,this._isAttackWin?ViewController.getInstance().openView(ViewConst.BASE.BATTLEWIN,{f:this.endCallBack,o:this,num:this._winNumber,type:2}):ViewController.getInstance().openView(ViewConst.BASE.PROMPTVIEW,{type:4,f:this.endCallBack,o:this})},e.prototype.endCallBack=function(){if(this._isAttackWin)this._winNumber%3==2?ViewController.getInstance().openView(ViewConst.POPUP.ATKRACEREWARDPOPUPVIEW,{f:this.winHandle,o:this}):this.winHandle();else{var t=this._oldInfo[1].name,e=this._oldInfo[0].sid;this._winNumber>0?ViewController.getInstance().openView(ViewConst.POPUP.ATKRACEAGREEPOPUPVIEW,{type:3,name:t,sid:e}):ViewController.getInstance().openView(ViewConst.POPUP.ATKRACEAGREEPOPUPVIEW,{type:2,name:t,sid:e}),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_RESET_ATKRACE),this._callbackF2.apply(this._obj),this.hide()}},e.prototype.winHandle=function(){if(this._winNumber+1==this._totalNumber){var t=this._oldInfo[1].name,e=this._oldInfo[0].sid;ViewController.getInstance().openView(ViewConst.POPUP.ATKRACEAGREEPOPUPVIEW,{type:4,name:t,sid:e}),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_RESET_ATKRACE),this._callbackF2.apply(this._obj)}else this._callbackF.apply(this._obj);this.hide()},e.prototype.atkEndCallback=function(){1!=this._isEnd&&this.showRound()},e.prototype.dispose=function(){this._battleInfo=null,this._isEnd=!1,this._isAttackWin=null,this._rewards=null,this._oldInfo.length=0,this._winNumber=0,this._callbackF2=null,this._callbackF=null,this._obj=null,this._totalNumber=0,this._curRound=0,t.prototype.dispose.call(this)},e}(BaseBattleView);__reflect(AtkraceBattleView.prototype,"AtkraceBattleView");var AtkraceBuyPopupView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e._buyInfo=[],e._buyBtnTab=[],e._containerTab=[],e._clickIndex=0,e._goldText=null,e._moraleText=null,e}return __extends(e,t),e.prototype.getRequestData=function(){var t=Api.atkraceVoApi.getMyFightInfo().tmpattr,e=Api.atkraceVoApi.getMyFightInfo();return 0==e.fightnum?null:t&&t.list&&Object.keys(t.list).length>0?null:{requestType:NetRequestConst.REQUEST_ATKRACE_ATTRBUYLIST,requestData:{}}},e.prototype.initView=function(){this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f);var t=BaseBitmap.create("public_9_resbg");t.setPosition(32,12),this.addChildToContainer(t);var e=egret.Rectangle.create();e.setTo(0,0,45,45);var i=BaseLoadBitmap.create("itemicon1",e);i.setPosition(t.x-1,t.y+t.height/2-22.5),this.addChildToContainer(i),this._goldText=ComponentManager.getTextField(Api.playerVoApi.getPlayerGemStr(),TextFieldConst.FONTSIZE_CONTENT_COMMON),this._goldText.setPosition(i.x+50,t.y+t.height/2-this._goldText.height/2),this.addChildToContainer(this._goldText),t.width=this._goldText.width+70;var a=BaseBitmap.create("public_9_resbg");a.setPosition(280,12),this.addChildToContainer(a);var n=BaseBitmap.create("atkrace_morale");n.setPosition(a.x+3,a.y+a.height/2-22.5),this.addChildToContainer(n),this._moraleText=ComponentManager.getTextField(Api.atkraceVoApi.getMyInfo().morale.toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON),this._moraleText.setPosition(n.x+50,a.y+a.height/2-this._moraleText.height/2),this.addChildToContainer(this._moraleText),a.width=this._moraleText.width+70;var o=BaseBitmap.create("public_9_bg4");o.width=528,o.height=404,o.setPosition(this.viewBg.width/2-o.width/2,60),this.addChildToContainer(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_info_2"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);s.setPosition(50,o.y+o.height+18),this.addChildToContainer(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_info_3"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);r.setPosition(280,s.y),this.addChildToContainer(r);var l=Api.atkraceVoApi.getMyFightInfo(),h=l.mesid,d=l.tmpattr,g=0,c=0;d&&(d.atk&&(g=Math.floor(100*d.atk)),d.skill&&(c=Math.floor(100*d.skill)));var p=ComponentManager.getTextField(g.toString()+"%",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN2);p.setPosition(s.x+s.width,s.y),this.addChildToContainer(p);var _=ComponentManager.getTextField(c.toString()+"%",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN2);_.setPosition(r.x+r.width,r.y),this.addChildToContainer(_);var u=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_property3"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);u.setPosition(s.x,s.y+35),this.addChildToContainer(u);var C=ComponentManager.getProgressBar("progress8","progress7_bg",410);if(C.x=u.x+u.width+20,C.y=u.y-C.height/2+u.height/2,this.addChildToContainer(C),C.setText(h.attr+"/"+h.fullattr),C.setPercentage(h.attr/h.fullattr),0==l.fightnum)for(var f=1;3>=f;f++)this._buyInfo.push([Config.AtkraceCfg.getInitAtt(f.toString()),1,f.toString()]);else{var m=Api.atkraceVoApi.getMyFightInfo().tmpattr.list;this._buyInfo.push([Config.AtkraceCfg.getJuniorAtt(m[2]),2,m[2]]),this._buyInfo.push([Config.AtkraceCfg.getMediumAtt(m[3]),3,m[3]]),this._buyInfo.push([Config.AtkraceCfg.getSeniorAtt(m[4]),4,m[4]])}for(var f=1;3>=f;f++){var T=this.getBuyTypeContainer(this._buyInfo[f-1][0],f,this._buyInfo[f-1][1]);T.setPosition(this.viewBg.width/2-259+4,130*(f-1)+73),this.addChildToContainer(T),this._containerTab.push(T)}},e.prototype.getBuyTypeContainer=function(t,e,i){var a=new BaseDisplayObjectContainer,n=BaseBitmap.create("public_9_probiginnerbg");n.width=508,n.height=118,a.addChild(n);var o=LanguageManager.getlocal("atkrace_property_lv"+e,[LanguageManager.getlocal("atkrace_property"+t.att)]),s=ComponentManager.getTextField(o,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_BLUE);s.setPosition(130,15),a.addChild(s);var r=Math.floor(100*t.effect),l=LanguageManager.getlocal("atkrace_add_property",[LanguageManager.getlocal("atkrace_property"+t.att),r.toString()]),h=ComponentManager.getTextField(l,TextFieldConst.FONTSIZE_CONTENT_SMALL);h.setPosition(s.x,s.y+s.height+12),a.addChild(h);var d=ComponentManager.getTextField(LanguageManager.getlocal("adultChooseCost")+":",TextFieldConst.FONTSIZE_CONTENT_SMALL);d.setPosition(s.x,h.y+h.height+12),a.addChild(d);var g=egret.Rectangle.create();g.setTo(0,0,100,100);var c;c=1==i?"atkrace_icon_1_"+e:"atkrace_icon_"+t.att+"_"+e;var p=BaseLoadBitmap.create(c,g);p.setPosition(11,n.height/2-p.height/2),a.addChild(p);var _,u,C,f=egret.Rectangle.create();t.costGem?(_="itemicon1",f.setTo(0,0,45,45),u=t.costGem,C=BaseLoadBitmap.create(_,f)):(_="atkrace_morale",f.setTo(0,0,36,40),u=t.costPoint,C=BaseBitmap.create(_)),C.setPosition(d.x+d.width,d.y+d.height/2-C.height/2),a.addChild(C);var m=ComponentManager.getTextField(u.toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL);m.setPosition(C.x+45,d.y),a.addChild(m);var T,y=Api.atkraceVoApi.getMyFightInfo().tmpattr;if(y&&(T=y.isbuy),"0"!=T&&T){var v=T.split("_");if("1"==v[0]){if(Number(v[1])==e){var A=BaseBitmap.create("public_buy");A.setPosition(n.width-A.width-10,n.height/2-A.height/2),a.addChild(A)
}}else if(Number(v[0])==i){var A=BaseBitmap.create("public_buy");A.setPosition(n.width-A.width-10,n.height/2-A.height/2),a.addChild(A)}}else{var w=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"acPunishBuyItemBuy",this.buyClick,this,[e]);w.setPosition(n.width-w.width-10,n.height/2-w.height/2),w.setColor(TextFieldConst.COLOR_BLACK),a.addChild(w),this._buyBtnTab.push(w)}return a},e.prototype.buyClick=function(t){var e=this._buyInfo[t-1],i=e[0];if(i.costGem){if(i.costGem>Api.playerVoApi.getPlayerGem())return void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough"))}else{var a=i.costPoint,n=Api.atkraceVoApi.getMyInfo().morale;if(a>n)return void App.CommonUtil.showTip(LanguageManager.getlocal("atkRace_buy_NotEnough"))}this._clickIndex=t,this.request(NetRequestConst.REQUEST_ATKRACE_ATTRBUY,{atttype:e[1].toString(),attid:e[2]})},e.prototype.receiveData=function(t){var e=t.data;0!=t.ret&&(e.cmd==NetRequestConst.REQUEST_ATKRACE_ATTRBUYLIST||e.cmd==NetRequestConst.REQUEST_ATKRACE_ATTRBUY&&(this._obj&&this._callbackF&&this._callbackF.apply(this._obj),this.showBuyAnim(),this._goldText.text=Api.playerVoApi.getPlayerGemStr(),this._moraleText.text=Api.atkraceVoApi.getMyInfo().morale.toString()))},e.prototype.showBuyAnim=function(){for(var t in this._buyBtnTab)this._buyBtnTab[t].visible=!1;var e=BaseBitmap.create("public_buy");e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.setPosition(508-e.width/2-10,59),e.setScale(1.5),this._containerTab[this._clickIndex-1].addChild(e),egret.Tween.get(e,{loop:!1}).to({scaleX:1,scaleY:1},400).wait(300).call(this.hide,this)},e.prototype.dispose=function(){this._callbackF=null,this._obj=null,this._buyInfo.length=0,this._buyBtnTab.length=0,this._clickIndex=0,this._containerTab.length=0,this._goldText=null,this._moraleText=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AtkraceBuyPopupView.prototype,"AtkraceBuyPopupView");var AtkraceRewardPopupView=function(t){function e(){var e=t.call(this)||this;return e._backCardArray=[],e._awardIconArray=[],e._clickIdx=0,e._iconWidth=108,e._turnTime=400,e._callbackF=null,e._obj=null,e._rewardsStr=null,e}return __extends(e,t),e.prototype.getTitleStr=function(){return"atkrace_win_award"},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["atkrace_card_back","atkrace_reward_anim"])},e.prototype.getBgExtraHeight=function(){return 20},e.prototype.getCloseBtnName=function(){return null},e.prototype.initView=function(){this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f);var t=BaseBitmap.create("public_9_bg4");t.width=520,t.height=272,t.setPosition(this.viewBg.width/2-t.width/2,20),this.addChildToContainer(t);for(var e=1;6>=e;e++){var i=ComponentManager.getButton("atkrace_card_back",null,this.clickCard,this,[e]);i.setPosition(70+(e-1)%3*(i.width+46),35+Math.floor((e-1)/3)*(i.height+20)),this.addChildToContainer(i),this._backCardArray.push(i)}this._clip=ComponentManager.getCustomMovieClip("atkrace_reward_anim",7,80),this._clip.setEndCallBack(this.animEndCallback,this)},e.prototype.clickCard=function(t){for(var e in this._backCardArray)this._backCardArray[e].setEnable(!1);this._clickIdx=t,this.request(NetRequestConst.REQUEST_ATKRACE_RANDREWARD,{pos:t})},e.prototype.receiveData=function(t){t.data;if(0!=t.ret){var e;e=t.data.data.randcards;var i=GameData.formatRewardItem(e[this._clickIdx-1])[0],a=i.type;6==a&&(a=i.id),this._rewardsStr=LanguageManager.getlocal("get_item",[LanguageManager.getlocal("itemName_"+a),i.num.toString()]);for(var n=0;6>n;n++){var o=GameData.getRewardItemIcons(e[n])[0];o.setPosition(70+n%3*(o.width+46)+this._iconWidth/2,35+Math.floor(n/3)*(o.height+20)),this.addChildToContainer(o),o.scaleX=0,o.visible=!1,this._awardIconArray.push(o)}var s=this._backCardArray[this._clickIdx-1];egret.Tween.get(s).to({scaleX:0,x:s.x+this._iconWidth/2},this._turnTime).call(this.showAnim,this)}},e.prototype.showAnim=function(){var t=this._awardIconArray[this._clickIdx-1],e=BaseBitmap.create("atkrace_reward_anim1");this._clip.setPosition(t.x-e.width/2,t.y-e.height/2+this._iconWidth/2),this._clip.playWithTime(1),this.addChildToContainer(this._clip),BaseBitmap.release(e),t.visible=!0,egret.Tween.get(t).to({scaleX:1,x:t.x-this._iconWidth/2},this._turnTime).call(this.turnOtherCards,this)},e.prototype.animEndCallback=function(t){t.visible=!1},e.prototype.turnOtherCards=function(){var t=this._awardIconArray[this._clickIdx-1],e=t.x,i=t.y,a=t.x+.05*t.width,n=t.y+.05*t.height;egret.Tween.get(t,{loop:!0}).to({scaleX:.9,scaleY:.9,x:a,y:n},400).to({scaleX:1,scaleY:1,x:e,y:i},400);for(var o=0;6>o;o++)if(o+1!=this._clickIdx){var s=this._backCardArray[o],r=this._awardIconArray[o];r.visible=!0,egret.Tween.get(s).to({scaleX:0,x:s.x+this._iconWidth/2},this._turnTime),egret.Tween.get(r).wait(this._turnTime).to({scaleX:1,x:r.x-this._iconWidth/2},this._turnTime)}TimerManager.doTimer(2*this._turnTime,1,this.showTips,this)},e.prototype.showTips=function(){var t=BaseBitmap.create("public_numbg");t.width=540,t.setPosition(GameConfig.stageWidth/2-t.width/2,this.viewBg.y+this.viewBg.height+20),this.addChild(t);var e=ComponentManager.getTextField(this._rewardsStr,TextFieldConst.FONTSIZE_CONTENT_SMALL);e.setPosition(GameConfig.stageWidth/2-e.width/2,t.y+t.height/2-e.height/2),this.addChild(e),this.addTouchTap(this.closeHandle,this)},e.prototype.closeHandle=function(){var t=this._callbackF,e=this._obj;this.hide(),t&&e&&t.apply(e)},e.prototype.dispose=function(){for(var e in this._backCardArray)egret.Tween.removeTweens(this._backCardArray[e]);this._backCardArray.length=0,this._clickIdx=0;for(var i in this._awardIconArray)egret.Tween.removeTweens(this._awardIconArray[i]);this._awardIconArray.length=0,this._clip=null,this._callbackF=null,this._obj=null,this._rewardsStr=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AtkraceRewardPopupView.prototype,"AtkraceRewardPopupView");var AtkraceView=function(t){function e(){var e=t.call(this)||this;return e._moreArrow=null,e._isShowMore=!1,e._curServant=null,e._infoContainer=null,e._countDownTime=0,e._countDownText=null,e.listconditions=null,e._fightflag=null,e._atkraceInfoVoList=[],e.bottom=null,e._currMaskBmp=null,e.touchBoo=!0,e.moreBg=null,e.describeTxt=null,e.moveContainer=null,e.isData=!1,e._touchBg=null,e._nameTxt=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["rankinglist_rankbg","rankinglist_line","arena_bg","arena_servant","forpeople_bottom","arena_bottom","atkrace_morale","arena_arrow","arena_bottom_bg","arena_more_down","arena_more","arena_rank","arena_rank_text","arena_visit","arena_visit_text","servant_mask"])},e.prototype.getRuleInfo=function(){return"atkraceInfo"},e.prototype.getBgName=function(){return"arena_bg"},e.prototype.initBg=function(){var t=this.getBgName();if(t){var e=egret.Rectangle.create();e.setTo(0,0,640,1136),this.viewBg=BaseLoadBitmap.create(t,e),this.viewBg.setPosition(0,.1*(GameConfig.stageHeigth-this.viewBg.height)),this.addChild(this.viewBg)}},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_ATKRACE_INDEX,requestData:{}}},e.prototype.receiveData=function(t){0==t.data.data.fightflag?this._fightflag=!1:this._fightflag=!0,this._infoContainer&&this.resetInfo()},e.prototype.initView=function(){if(Api.rookieVoApi.checkNextStep(),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT,this.doGuide,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_RESET_ATKRACE,this.battleCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACE_CHALLENGE),this.challengeCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACE_REVENGE),this.challengeCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACE_KILL),this.challengeCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACE_REFRESH),this.refreshServant,this),this.initBottom(),this.resetInfo(),this._fightflag){var t=Api.atkraceVoApi.getRewardc();t&&t.flag&&t.flag>0&&ViewController.getInstance().openView(ViewConst.POPUP.ATKRACEREWARDPOPUPVIEW,{})}NetManager.request(NetRequestConst.REQUEST_ATKRACE_LIST,{}),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACE_LIST),this.useCallback,this)},e.prototype.resetInfo=function(){if(this._countDownTime=0,this._infoContainer&&(this.removeChildFromContainer(this._infoContainer),this._infoContainer=null),this._countDownText&&(this._countDownText=null),this._infoContainer=new BaseDisplayObjectContainer,this._infoContainer.y=GameConfig.stageHeigth-1136,this.addChildToContainer(this._infoContainer),0==this._fightflag){var t=BaseBitmap.create("public_9_bg25");t.width=260,t.height=78,t.setPosition(GameConfig.stageWidth/2-t.width/2,250),this._infoContainer.addChild(t);var e=BaseBitmap.create("public_9_bg25_tail");e.x=t.x+t.width/2+20,e.y=t.y+t.height-3,this._infoContainer.addChild(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("atkraceNoServant"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);i.width=224,i.lineSpacing=6,i.setPosition(t.x+t.width/2-i.width/2,t.y+t.height/2-i.height/2),this._infoContainer.addChild(i)}else{var a=Api.atkraceVoApi.getMyFightInfo();if(a&&a.mesid&&a.mesid.sid){var n=a.mesid.sid,o=BaseLoadBitmap.create(Api.servantVoApi.getFullImgPathWithId(n));o.width=405,o.height=467,o.x=GameConfig.stageWidth/2-o.width/2,o.y=this.viewBg.height-180-o.height,this._infoContainer.addChild(o),o.addTouchTap(this.clickServant,this);var t=BaseBitmap.create("public_9_bg25");t.width=260,t.height=78,t.setPosition(GameConfig.stageWidth/2-t.width/2,o.y-80),this._infoContainer.addChild(t);var e=BaseBitmap.create("public_9_bg25_tail");e.x=t.x+t.width/2+20,e.y=t.y+t.height-3,this._infoContainer.addChild(e);var s=void 0;s=1==a.handle||1!=a.atype?LanguageManager.getlocal("arenaServantSpeak2"):LanguageManager.getlocal("arenaServantSpeak1",[LanguageManager.getlocal("servant_name"+a.mesid.sid)]);var i=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);i.width=224,i.lineSpacing=6,i.setPosition(t.x+t.width/2-i.width/2,t.y+t.height/2-i.height/2),this._infoContainer.addChild(i)}else{var r=Config.AtkraceCfg.getDailyNum(),l=Api.atkraceVoApi.getMyInfo(),t=BaseBitmap.create("public_9_bg25");t.width=260,t.height=78,t.setPosition(GameConfig.stageWidth/2-t.width/2,250),this._infoContainer.addChild(t);var e=BaseBitmap.create("public_9_bg25_tail");e.x=t.x+t.width/2+20,e.y=t.y+t.height-3,this._infoContainer.addChild(e);var h=l.num,s=void 0;if(h>=r){var d=Api.servantVoApi.getServantCountLevel60Plus(),g=Config.AtkraceCfg.getParameter1(),c=Math.floor(d/g);l.extranum>=c?(s=LanguageManager.getlocal("arenaMaxNum"),t.addTouchTap(this.clickDialog2,this)):(s=LanguageManager.getlocal("arenaAddNum",[l.extranum.toString(),c.toString()]),t.addTouchTap(this.clickDialog,this));var i=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);i.width=224,i.lineSpacing=6,i.setPosition(t.x+t.width/2-i.width/2,t.y+t.height/2-i.height/2),this._infoContainer.addChild(i)}else{this._countDownTime=l.lasttime+Config.AtkraceCfg.getIntervalTime()-GameData.serverTime;var i=ComponentManager.getTextField(LanguageManager.getlocal("atkraceCountDowning"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);i.width=224,i.lineSpacing=6,i.setPosition(t.x+t.width/2-i.width/2,t.y+t.height/2-i.height/2-15),this._infoContainer.addChild(i),this._countDownText=ComponentManager.getTextField(this.getCountTimeStr(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_RED),this._countDownText.setPosition(t.x+t.width/2-this._countDownText.width/2,i.y+i.height+7),this._infoContainer.addChild(this._countDownText)}}}},e.prototype.getCountTimeStr=function(){var t=this._countDownTime;return 0>t&&(t=0),App.DateUtil.getFormatBySecond(t)},e.prototype.tick=function(){this._countDownText&&(this._countDownTime--,this._countDownText.text=this.getCountTimeStr(),this._countDownTime<0&&this.refreshServant())},e.prototype.refreshServant=function(){this.request(NetRequestConst.REQUEST_ATKRACE_INDEX,{})},e.prototype.initBottom=function(){var t=BaseBitmap.create("arena_bottom"),e=BaseBitmap.create("servant_mask");e.width=GameConfig.stageWidth,e.y=GameConfig.stageHeigth-t.height-e.height,this.addChild(e),this.swapChildren(e,this.container);var i=ComponentManager.getButton("forpeople_bottom",null,this.visitHandle,this,null,0);i.setPosition(24,GameConfig.stageHeigth-200),this.addChild(i);var a=BaseBitmap.create("arena_visit");a.setPosition(i.width/2-a.width/2,i.height/2-a.height/2-5),i.addChild(a);var n=BaseBitmap.create("arena_visit_text");if(n.setPosition(i.width/2-n.width/2,a.y+a.height-30),i.addChild(n),!Api.switchVoApi.checkOpenShenhe()){var o=ComponentManager.getButton("forpeople_bottom",null,this.rankHandle,this,null,0);o.setPosition(GameConfig.stageWidth-o.width-24,i.y),this.addChild(o);var s=BaseBitmap.create("arena_rank");s.setPosition(o.width/2-s.width/2,o.height/2-s.height/2-5),o.addChild(s);var r=BaseBitmap.create("arena_rank_text");r.setPosition(o.width/2-n.width/2,s.y+s.height-30),o.addChild(r)}t.y=GameConfig.stageHeigth-t.height,this.addChild(t),this.bottom=t;var l=ComponentManager.getButton("arena_more",null,this.showMoreHandle,this);l.setPosition(GameConfig.stageWidth-l.width-18,GameConfig.stageHeigth-t.height/2-l.height/2),this.addChild(l),this._moreArrow=BaseBitmap.create("arena_arrow"),this._moreArrow.setPosition(l.x-this._moreArrow.width-5,GameConfig.stageHeigth-t.height/2-this._moreArrow.height/2),this.addChild(this._moreArrow)},e.prototype.visitHandle=function(){ViewController.getInstance().openView(ViewConst.COMMON.ATKRACEVISITVIEW)},e.prototype.rankHandle=function(){ViewController.getInstance().openView(ViewConst.COMMON.ATKRACERANKLISTVIEW)},e.prototype.showMoreHandle=function(){this.touchBoo&&(this._isShowMore=!this._isShowMore,1==this._isShowMore?(this._moreArrow.scaleY=-1,this._moreArrow.y+=this._moreArrow.height,this.showList()):(this._moreArrow.scaleY=1,this._moreArrow.y-=this._moreArrow.height,this.closeList()))},e.prototype.clickServant=function(){var t=Api.atkraceVoApi.getMyFightInfo();if(1==t.handle||1!=t.atype)ViewController.getInstance().openView(ViewConst.COMMON.ATKRACEARRESTVIEW);else{var e=t.getFName();ViewController.getInstance().openView(ViewConst.POPUP.ATKRACEAGREEPOPUPVIEW,{type:1,name:e,sid:t.mesid.sid})}},e.prototype.doGuide=function(){this.clickServant()},e.prototype.battleCallback=function(){this.resetInfo(),this.describeTxt&&(this.removeChild(this.describeTxt),this.describeTxt=null),NetManager.request(NetRequestConst.REQUEST_ATKRACE_LIST,{}),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACE_LIST),this.useCallback,this)},e.prototype.clickDialog2=function(){App.CommonUtil.showTip(LanguageManager.getlocal("atkrace_extro_no_times"))},e.prototype.clickDialog=function(){var t=Config.AtkraceCfg.getFightAdd(),e=1,i=Api.itemVoApi.getItemInfoVoById(Number(t)),a=0;i&&(a=i.num);var n=LanguageManager.getlocal("atkRace_buyChallenge",[LanguageManager.getlocal("itemName_"+t)]),o={confirmCallback:this.buyChallenge,handler:this,icon:"itemicon"+t,iconBg:Config.ItemCfg.getItemCfgById(t).iconBg,num:a,useNum:e,msg:n,id:t};ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,o)},e.prototype.buyChallenge=function(){this.request(NetRequestConst.REQUEST_ATKRACE_USEEXTRA,{})},e.prototype.useCallback=function(t){t.data.ret?(this._atkraceInfoVoList=t.data.data.data.atklist,this.showText(),this.listconditions&&(this.listconditions.visible=!1),this._atkraceInfoVoList.length>0?this.isData=!0:this.isData=!1):this.isData=!1},e.prototype.showText=function(){if(this._nameTxt&&(this.removeChild(this._nameTxt),this._nameTxt=null),this._atkraceInfoVoList.length>0&&this._atkraceInfoVoList[0].info){var t=this._atkraceInfoVoList[0],e="";e=this.isData&&1==t.info.type?LanguageManager.getlocal("atkracebeat"):LanguageManager.getlocal("atkraceAnnihilation");var i=null;i=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);var a=Config.ServantCfg.getServantItemById(t.info.sid).name;t.info.streak&&t.info.streak>=3?i.text=LanguageManager.getlocal("actrackStraight",[a,e,t.info.uname2,t.info.fightnum,t.info.streak]):i.text=LanguageManager.getlocal("actrackDescription",[a,e,t.info.uname2,t.info.fightnum]),i.width=450,i.x=20,i.y=GameConfig.stageHeigth-40,this.describeTxt=i,this.addChild(i);var n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);n.text=this._atkraceInfoVoList[0].info.name,n.x=20,n.y=GameConfig.stageHeigth-67,this.addChild(n),this._nameTxt=n}},e.prototype.showList=function(){if(this.moveContainer=new BaseDisplayObjectContainer,this.addChild(this.moveContainer),this.moreBg=BaseBitmap.create("arena_bottom_bg"),this.moreBg.width=640,this.moreBg.height=GameConfig.stageHeigth-330,this.moveContainer.addChild(this.moreBg),this._currMaskBmp=BaseBitmap.create("public_9_viewmask"),this._currMaskBmp.width=GameConfig.stageWidth,this._currMaskBmp.height=GameConfig.stageHeigth,this._currMaskBmp.touchEnabled=!0,this.addChild(this._currMaskBmp),this.setChildIndex(this._currMaskBmp,this.getChildIndex(this.bottom)),this._touchBg=BaseBitmap.create("public_9_bg25"),this._touchBg.width=640,this._touchBg.height=260,this._touchBg.x=0,this._touchBg.y=-240,this._touchBg.alpha=0,this._touchBg.addTouchTap(this.showMoreHandle,this),this.moveContainer.addChild(this._touchBg),this.isData){var t=egret.Rectangle.create();t.setTo(0,10,640,GameConfig.stageHeigth-340),this._scrollList=ComponentManager.getScrollList(ActrackMoreItem,this._atkraceInfoVoList,t),this.moveContainer.addChild(this._scrollList),this._scrollList.y=5}else{var e=ComponentManager.getTextField(LanguageManager.getlocal("atkracedes3"),20);e.x=250,e.y=300,this.moveContainer.addChild(e)}this.moveContainer.y=1150,this.touchBoo=!1;var i=Config.AtkraceCfg.getbeatNum(),a=ComponentManager.getTextField(LanguageManager.getlocal("atkracelistconditions",[i+""]),20);a.x=100,a.y=GameConfig.stageHeigth-50,this.addChild(a),this.listconditions=a,this.listconditions&&(this.listconditions.visible=!1),this.describeTxt&&(this.describeTxt.visible=!1,this._nameTxt.visible=!1),egret.Tween.get(this.moveContainer).to({y:250},500).call(function(){egret.Tween.removeTweens(this.moveContainer),this.touchBoo=!0,this.listconditions&&(this.listconditions.visible=!0)},this)},e.prototype.closeList=function(){this.touchBoo=!1,this.listconditions.visible=!1,this.describeTxt&&(this.describeTxt.visible=!0,this._nameTxt.visible=!0),this.moveContainer&&egret.Tween.get(this.moveContainer).to({y:1150},500).call(function(){this.touchBoo=!0,egret.Tween.removeTweens(this.moveContainer)},this),this._currMaskBmp&&this._currMaskBmp.parent&&(this._currMaskBmp.parent.removeChild(this._currMaskBmp),this._currMaskBmp.dispose(),this._currMaskBmp=null),this._touchBg&&this._touchBg.parent&&(this._touchBg.parent.removeChild(this._touchBg),this._touchBg.dispose(),this._touchBg=null)},e.prototype.challengeCallback=function(t){t.data.ret&&(AtkraceChallengeItem.data&&1==AtkraceChallengeItem.data.type&&this.touchBoo&&(this.moveContainer.y=1150,this._currMaskBmp.visible=!1),this.refreshServant(),ViewController.getInstance().hideView(ViewConst.POPUP.ATKRACECHALLENGEVIEW),this.clickServant())},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT,this.doGuide,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_RESET_ATKRACE,this.battleCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACE_CHALLENGE),this.challengeCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACE_REVENGE),this.challengeCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACE_KILL),this.challengeCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACE_LIST),this.useCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACE_REFRESH),this.refreshServant,this),this._moreArrow=null,this._isShowMore=!1,this._curServant=null,this._infoContainer=null,this._countDownTime=0,this._countDownText=null,this._fightflag=null,this._currMaskBmp=null,this.moreBg=null,this.moveContainer=null,this.touchBoo=!0,this.listconditions=null,this.describeTxt=null,this._touchBg=null,this._nameTxt=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(AtkraceView.prototype,"AtkraceView");var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){if(App.DeviceUtil.isWXgame()&&WxGameInclude.include(),PlatformManager.checkCrossDomon()&&(egret.ImageLoader.crossOrigin="anonymous"),RES.setMaxLoadingThread(4),this.stage.maxTouches=1,PlatformManager.init(),LayerManager.initLayer(this),GameConfig.stage=egret.MainContext.instance.stage,GameConfig.stageWidth=egret.MainContext.instance.stage.stageWidth,GameConfig.stageHeigth=egret.MainContext.instance.stage.stageHeight,Api.init(),SoundManager.init(),ServerCfg.initSvrUrl(),App.LogUtil.show("size:",GameConfig.stageWidth,"x",GameConfig.stageHeigth),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),App.DeviceUtil.IsHtml5()){var e=new Date,i=window.mainJsonVersion?window.mainJsonVersion:e.getTime();RES.loadConfig("resource/default.res.json?vs="+i,"resource/")}else App.DeviceUtil.isWXgame()?RES.loadConfig("resource/default.res.json",ServerCfg.getWxGameResourceUrl()):RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),App.LoginResLoader.loadLoginBgRes(),App.LoginResLoader.isDefaultResLoaded=!0,RSDKHelper.isInit&&App.LoginResLoader.initPlatCfg()},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var BattleHero=function(t){function e(){var e=t.call(this)||this;return e._type=0,e._servantFullImg=null,e._infoContainer=null,e._textArray=[],e._picName="",e._rect=null,e._tmpMap1=null,e._tmpMap2=null,e._tmpMap3=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"tmpMap",{get:function(){return this._tmpMap3},enumerable:!0,configurable:!0}),e.prototype.init=function(t,e,i,a){null!=i&&(this._type=i);var n=egret.Rectangle.create();if(n.setTo(0,0,324,373.6),3==this._type&&n.setTo(0,0,243,280.2),this._rect=n,null==t&&(t="servant_empty"),this._picName=t,this._servantFullImg=BaseLoadBitmap.create(t,n),this.addChild(this._servantFullImg),e&&0==this._type){var o=void 0;o=BaseBitmap.create("atkrace_battle_info"),o.y=this._servantFullImg.height-o.height+10,this.addChild(o);var s=e.level,r=ComponentManager.getBitmapText(s.toString(),TextFieldConst.FONTNAME_BOSS_SCORE);r.setScale(.9),r.setPosition(48-r.width/2*r.scaleX,o.y+40),this.addChild(r);var l=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);l.setPosition(95,o.y+20),this.addChild(l);var h=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_info_1"),TextFieldConst.FONTSIZE_CONTENT_SMALL);h.setPosition(l.x,l.y+l.height+3),this.addChild(h);var d=e.ability,g=ComponentManager.getTextField(d.toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN);g.setPosition(h.x+h.width,h.y),this.addChild(g)}else if(e&&2==this._type){this._infoContainer=new BaseDisplayObjectContainer,this.addChild(this._infoContainer);var c=BaseBitmap.create("public_9_downbg");c.width=270,this._infoContainer.x=this._servantFullImg.width/2-c.width/2,this._infoContainer.addChild(c);var p=0;for(var _ in e){var u=e[_],C=ComponentManager.getTextField(u[0],TextFieldConst.FONTSIZE_CONTENT_SMALL,u[1]);C.setPosition(c.width/2-C.width/2,10+30*p),this._infoContainer.addChild(C),p++,this._textArray.push(C)}c.height=10+30*p,this._infoContainer.y=this._servantFullImg.height-c.height,"servant_empty"==t&&(this._infoContainer.visible=!1)}3!=this._type&&this.addHeroFilter(a)},e.prototype.resetHero=function(t,e){t?(this._servantFullImg.setload(t),this._picName=t,2==this._type&&(this._infoContainer&&(this._infoContainer.visible=!0),e&&this.resetInfoText(LanguageManager.getlocal("fightForce")+":"+e))):(this._infoContainer&&(this._infoContainer.visible=!1),this._picName="servant_empty",this._servantFullImg.setload("servant_empty")),this.addHeroFilter(1)},e.prototype.resetInfoText=function(t,e){void 0===e&&(e=0),this._textArray[e].text=t,this._textArray[e].x=this._infoContainer.width/2-this._textArray[e].width/2},e.prototype.setMaskOffSet=function(){this._tmpMap1.alpha=.8,this._tmpMap2.alpha=.4,this._tmpMap3.alpha=0},e.prototype.resetMaskOffSet=function(){egret.Tween.get(this._tmpMap1).to({x:0,y:0,alpha:0},100),egret.Tween.get(this._tmpMap2).to({x:0,y:0,alpha:0},150)},e.prototype.addHeroFilter=function(t){for(var e=[[0,0,0,0,0,0,1,0,0,0,0,0,1,0,50,0,0,0,1,0],[0,0,0,0,0,0,1,0,0,0,0,0,1,0,30,0,0,0,1,0],[0,0,0,0,0,0,1,0,0,0,0,0,1,0,50,0,0,0,1,0]],i=[[1,0,0,0,50,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],[1,0,0,0,30,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],[1,0,0,0,50,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]],a=1;4>a;++a){var n=this["_tmpMap"+a];if(n)n.setload(this._picName),n=null;else{var o=BaseLoadBitmap.create(this._picName);o.width=this._rect.width,o.height=this._rect.height,this.addChild(o),o.cacheAsBitmap=!0;var s=1==t?e:i,r=new egret.ColorMatrixFilter(s[a-1]);o.filters=[r],r=null,this["_tmpMap"+a]=o}}e=i=null;var l=this.numChildren;this.setChildIndex(this._tmpMap1,l);var h=this.getChildIndex(this._servantFullImg);this.setChildIndex(this._tmpMap1,Math.max(0,h-1)),this.setChildIndex(this._tmpMap2,Math.max(0,h-2)),this.setChildIndex(this._tmpMap3,h+3),this._tmpMap1.x=-20,this._tmpMap1.y=-40,this._tmpMap1.alpha=0,this._tmpMap2.x=-40,this._tmpMap2.y=-80,this._tmpMap2.alpha=0,this._tmpMap3.x=0,this._tmpMap3.y=0,this._tmpMap3.alpha=0},e.prototype.dispose=function(){egret.Tween.removeTweens(this),this._servantFullImg=null,this._type=null,this._infoContainer=null,this._textArray.length=0,this._picName="",this._rect=null;for(var e=1;4>e;++e)this["_tmpMap"+e]&&(this.removeChild(this["_tmpMap"+e]),BaseLoadBitmap.release(this["_tmpMap"+e]),this["_tmpMap"+e].filters=null,this["_tmpMap"+e]=null);t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(BattleHero.prototype,"BattleHero");var AtkraceChallengeItem=function(t){function e(){var e=t.call(this)||this;return e._needNum=0,e._itemNum=0,e._servantId="",e.haveNumber=0,e.servantid="",e}return __extends(e,t),e.prototype.initItem=function(t,i){this._needNum=1,this._servantId=i;var a=Api.servantVoApi.getServantObj(this._servantId),n=BaseBitmap.create("public_9_probiginnerbg");n.width=510,n.height=120,n.x=9,this.addChild(n);var o=.55,s=BaseLoadBitmap.create(a.qualityBoxImgPath);s.width=194,s.height=192,s.setScale(o),s.x=20,s.y=8,s.name="cardbg",this.addChild(s);var r=BaseLoadBitmap.create(a.halfImgPath);r.width=180,r.height=177,r.x=s.x+s.width/2-r.width/2-5,r.y=s.y+s.height/2-r.height/2-2,r.setScale(o),this.addChild(r);var l=ComponentManager.getTextField("",20,TextFieldConst.COLOR_QUALITY_BLUE);l.textColor=ServantScrollItem.getQualityColor(a.clv),l.text=a.servantName,l.x=140,l.y=10,this.addChild(l);var h=ComponentManager.getTextField("atkraceChallengeleve",20);h.text=LanguageManager.getlocal("atkraceChallengeleve",[a.level+""]),h.width=200,h.x=l.x,h.y=l.y+25,this.addChild(h);var d=ComponentManager.getTextField("atkraceChallengequality",20);d.text=LanguageManager.getlocal("atkraceChallengequality",[a.getTotalBookValue()+""]),d.x=h.x,d.y=h.y+25,this.addChild(d);var g=ComponentManager.getTextField("atkraceChallengeinfoAttr",20);g.text=LanguageManager.getlocal("atkraceChallengeinfoAttr",[a.total+""]),g.x=d.x,g.y=d.y+25,this.addChild(g);var c=[];c._servantId=i;var p;if(1==e.data.type?p=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"atkraceChallenge",this.challengBtnHandler,this,c):2==e.data.type?p=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"atkraceRevenge",this.challengBtnHandler,this,c):3==e.data.type&&(p=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"atkraceVisitTab3",this.challengBtnHandler,this,c)),p.setScale(.85),p.x=400,p.y=45,this.addChild(p),p.visible=this.isBattleing(i),0==p.visible){var _=ComponentManager.getTextField("gonetowar2",20,16711680);_.text=LanguageManager.getlocal("gonetowar2"),_.width=200,_.x=410,_.y=50,this.addChild(_)}},e.prototype.challengBtnHandler=function(t){var i=Api.atkraceVoApi.getMyFightInfo();if(i&&i.mesid&&i.mesid.sid){var a=LanguageManager.getlocal("atkraceHisbattledes");App.CommonUtil.showTip(a)}else if(3==e.data.type){var n=Api.itemVoApi.getItemNumInfoVoById(1553);this.haveNumber=n;var o=LanguageManager.getlocal("atkraceKillbook",["1"]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{confirmCallback:this.confirmCallbackHandler,handler:this,icon:"itemicon1553",iconBg:"itembg_1",num:n,msg:o,id:1553,useNum:1})}else{var n=Api.itemVoApi.getItemNumInfoVoById(1552);this.haveNumber=n;var o=LanguageManager.getlocal("atkraceUseChallengebook",["1"]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{confirmCallback:this.confirmCallbackHandler,handler:this,icon:"itemicon1552",iconBg:"itembg_1",num:n,msg:o,id:1552,useNum:1})}},e.prototype.confirmCallbackHandler=function(){1==e.data.type?this.haveNumber>=this._needNum?NetManager.request(NetRequestConst.REQUEST_ATKRACE_CHALLENGE,{fuid:e.data.uid,servantid:this._servantId}):App.CommonUtil.showTip(LanguageManager.getlocal("challengedes")):2==e.data.type?this.haveNumber>=this._needNum?NetManager.request(NetRequestConst.REQUEST_ATKRACE_REVENGE,{fuid:e.data.uid,servantid:this._servantId}):App.CommonUtil.showTip(LanguageManager.getlocal("challengedes")):3==e.data.type&&(Api.itemVoApi.getItemNumInfoVoById(1553)>=1?NetManager.request(NetRequestConst.REQUEST_ATKRACE_KILL,{fuid:e.data.uid,servantid:this._servantId}):App.CommonUtil.showTip(LanguageManager.getlocal("killdes")))},e.prototype.challengeCallback=function(t){},e.prototype.dispose=function(){this._needNum=0,this._itemNum=0,this._servantId="",this.servantid="",this.haveNumber=0,e.data=[],t.prototype.dispose.call(this)},e.prototype.isBattleing=function(t){var e=Api.atkraceVoApi.getMyInfo();for(var i in e.asids)if(e.asids[i]==t)return!1;return!0},e.data=[],e}(ScrollListItem);__reflect(AtkraceChallengeItem.prototype,"AtkraceChallengeItem");var AtkraceChallengeView=function(t){function e(){var e=t.call(this)||this;return e.servantList=[],e._scrollList=null,e.challengebookNum=0,e._data=[],e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([])},e.prototype.getTitleStr=function(){if(AtkraceChallengeItem.data){if(1==AtkraceChallengeItem.data.type)return"atkraceChallenge";if(2==AtkraceChallengeItem.data.type)return"atkraceRevenge";if(3==AtkraceChallengeItem.data.type)return"atkraceVisitTab3"}},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this);var e=BaseBitmap.create("public_9_bg4");e.width=528,e.height=550,e.x=55,e.y=this.titleTF.y+65,this.addChild(e);var i=ComponentManager.getTextField("atkracechallengedes",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);i.text=LanguageManager.getlocal("atkracechallengedes"),i.x=e.x+20,i.y=e.y-24,this.addChild(i),this.challengebookNum=Api.itemVoApi.getItemNumInfoVoById(1552);var a=ComponentManager.getTextField("atkracechallengebook",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);
a.text=LanguageManager.getlocal("atkracechallengebook",[this.challengebookNum+""]),a.x=i.x+400,a.y=i.y,this.addChild(a),3==AtkraceChallengeItem.data.type?(this.challengebookNum=Api.itemVoApi.getItemNumInfoVoById(1553),a.text=LanguageManager.getlocal("atkracekill",[this.challengebookNum+""])):(this.challengebookNum=Api.itemVoApi.getItemNumInfoVoById(1552),a.text=LanguageManager.getlocal("atkracechallengebook",[this.challengebookNum+""]));for(var n=Api.servantVoApi.getServantCountLevel60PlusList(),o=[],s=[],r=0;r<n.length;r++){var l=n[r];this.isBattleing(l)?s.push(l):o.push(l)}var h=o.concat(s),d=egret.Rectangle.create();d.setTo(0,0,640,e.height-15),this._scrollList=ComponentManager.getScrollList(AtkraceChallengeItem,h,d),this.addChild(this._scrollList),this._scrollList.setPosition(55,e.y+5)},e.prototype.initView=function(){},e.prototype.isBattleing=function(t){var e=Api.atkraceVoApi.getMyInfo();for(var i in e.asids)if(e.asids[i]==t)return!0;return!1},e.prototype.getShowHeight=function(){return 660},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.challengebookNum=0,this.servantList=[],this._data=null},e}(PopupView);__reflect(AtkraceChallengeView.prototype,"AtkraceChallengeView");var ActrackMoreItem=function(t){function e(){var e=t.call(this)||this;return e.uid=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){this.uid=e.info.uid;var i=BaseBitmap.create("public_9_bg25");i.width=640,i.height=124,i.x=0,i.y=0,i.visible=!1,this.addChild(i);var a=BaseBitmap.create("rankinglist_line");a.y=128,a.x=15,this.addChild(a);var n=BaseBitmap.create("rankinglist_rankbg");n.x=50-n.width/2-20,n.y=26,this.addChild(n);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);o.text=String(t+1),o.x=50-o.width/2-20,o.y=this.height/2-o.height/2-20,this.addChild(o);var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);s.text=e.info.name,s.x=n.x+50,s.y=o.y,this.addChild(s);var r="";r=1==e.info.type?LanguageManager.getlocal("atkracebeat"):LanguageManager.getlocal("atkraceAnnihilation");var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL),h=Config.ServantCfg.getServantItemById(e.info.sid).name;l.text="",e.info.streak&&e.info.streak>=3?l.text=LanguageManager.getlocal("actrackStraight",[h,r,e.info.uname2,e.info.fightnum,e.info.streak]):l.text=LanguageManager.getlocal("actrackDescription",[h,r,e.info.uname2,e.info.fightnum]),l.width=450,l.x=s.x,l.y=s.y+30,this.addChild(l);var d=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);d.text=App.DateUtil.getFormatBySecond(e.info.st,2),d.x=l.x,d.y=l.y+40,this.addChild(d);var g=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"atkraceChallenge",this.challengBtnHandler,this);g.setScale(.85),g.x=530,g.y=70,this.addChild(g),Api.playerVoApi.getPlayerID()==e.info.uid&&(g.visible=!1)},e.prototype.challengBtnHandler=function(t){var e=[];e.type=1,e.uid=this.uid,AtkraceChallengeItem.data=e,ViewController.getInstance().openView(ViewConst.POPUP.ATKRACECHALLENGEVIEW)},e.prototype.getSpaceY=function(){return 1},e.prototype.getSpaceX=function(){return 0},e.prototype.dispose=function(){this.uid=0,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ActrackMoreItem.prototype,"ActrackMoreItem");var AtkraceRankItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){if(this.width=502,this.height=52,3>t){var i=BaseBitmap.create("rankinglist_rank"+String(t+1));i.x=62-i.width/2,i.y=this.height/2-i.height/2,this.addChild(i)}else{var i=BaseBitmap.create("rankinglist_rankbg");i.x=62-i.width/2,i.y=this.height/2-i.height/2,this.addChild(i);var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);a.text=String(t+1),a.x=62-a.width/2,a.y=this.height/2-a.height/2,this.addChild(a)}var n=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_CONTENT_COMMON);n.x=220-n.width/2,n.y=this.height/2-n.height/2,this.addChild(n);var o=ComponentManager.getTextField(e.point,TextFieldConst.FONTSIZE_CONTENT_COMMON);o.x=404-o.width/2,o.y=this.height/2-n.height/2,this.addChild(o);var s=BaseBitmap.create("dinner_line");s.x=260-s.width/2,s.y=this.height,this.addChild(s)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AtkraceRankItem.prototype,"AtkraceRankItem");var AtkraceRankListView=function(t){function e(){var e=t.call(this)||this;return e._infoList=null,e._merank=0,e._mepoint=0,e.atkracedes5=null,e.isShowTextBoo=!1,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["rankinglist_line","rankinglist_rankbg","rankinglist_rank1","rankinglist_rank2","rankinglist_rank3"])},e.prototype.initView=function(){var t=["atkraceRank"],e=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,t,null,null);e.x=40,e.y=10,this.addChildToContainer(e);var i=BaseBitmap.create("public_9_probiginnerbg");i.width=520,i.height=526,i.setPosition(this.viewBg.width/2-i.width/2,e.y+e.height),this.addChildToContainer(i);var a=BaseBitmap.create("dinner_rank_titlebg");a.width=i.width,a.height=36,a.setPosition(i.x,i.y),this.addChildToContainer(a),this._scroRect=new egret.Rectangle(a.x,a.y+a.height,a.width,i.height-a.height-8),this._scrollList=ComponentManager.getScrollList(AtkraceRankItem,this._infoList,this._scroRect),this._scrollList.x=a.x,this._scrollList.y=a.y+a.height,this.addChildToContainer(this._scrollList);var n=BaseBitmap.create("public_9_probiginnerbg");n.width=516,n.height=84,n.setPosition(this.viewBg.width/2-n.width/2,i.y+i.height+8),this.addChildToContainer(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("rankorder"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);o.setPosition(65,a.y+a.height/2-o.height/2),this.addChildToContainer(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("ranknickName"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);s.setPosition(200,o.y),this.addChildToContainer(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("atkraceScore"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);r.setPosition(387,o.y),this.addChildToContainer(r);var l=ComponentManager.getTextField(LanguageManager.getlocal("ranknickName")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);l.setPosition(o.x,n.y+n.height/2-5-l.height),this.addChildToContainer(l);var h=ComponentManager.getTextField(LanguageManager.getlocal("rankorder")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);h.setPosition(o.x,n.y+n.height/2+5),this.addChildToContainer(h);var d=ComponentManager.getTextField(Api.playerVoApi.getPlayerName(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);d.setPosition(l.x+l.width+12,l.y),this.addChildToContainer(d);var g=ComponentManager.getTextField(LanguageManager.getlocal("atkracedes5"),20);g.x=250,g.y=GameConfig.stageHeigth-530,this.addChild(g),g.visible=this.isShowTextBoo;var c;c=this._merank?this._merank>300?"10000+":this._merank.toString():LanguageManager.getlocal("atkracedes4");var p=ComponentManager.getTextField(c,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_GREEN);p.setPosition(h.x+h.width+12,h.y),this.addChildToContainer(p);var _="";_=this._mepoint?this._mepoint+"":"0";var u=ComponentManager.getTextField(_,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_GREEN);u.setPosition(n.x+n.width-20-u.width,h.y),this.addChildToContainer(u);var C=ComponentManager.getTextField(LanguageManager.getlocal("atkraceScore")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);C.setPosition(u.x-20-C.width,h.y),this.addChildToContainer(C)},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_ATKRACE_RANK,requestData:{}}},e.prototype.receiveData=function(t){t.ret&&t.data.data.atkrank[0]?(this._infoList=t.data.data.atkrank,this._merank=t.data.data.merank,this._mepoint=t.data.data.mepoint,this.isShowTextBoo=!1):this.isShowTextBoo=!0},e.prototype.dispose=function(){this._scrollList=null,this._infoList=null,this._merank=0,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AtkraceRankListView.prototype,"AtkraceRankListView");var ActrackVisitTab1Item=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){var i=BaseBitmap.create("public_9_bg25");i.width=516,i.height=126,i.x=60,i.visible=!1,this.addChild(i);var a=BaseBitmap.create("public_line1");a.x=60,a.y=120,this.addChild(a);var n=BaseBitmap.create("rankinglist_rankbg");n.x=i.x+20,n.y=10,this.addChild(n);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);o.text=String(t+1),o.x=n.x+(n.width-o.width)/2,o.y=n.y+10,this.addChild(o);var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);s.text=e.name,s.x=n.x+60,s.y=n.y+10,this.addChild(s);var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);r.text=LanguageManager.getlocal("atkraceyamenscore",[e.point]),r.x=s.x+s.width,r.y=n.y+10,this.addChild(r);var l=Config.ServantCfg.getServantItemById(e.sid).name,h=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);h.text=LanguageManager.getlocal("atkracedefensedes",[l,e.num]),h.x=s.x,h.y=s.y+30,h.width=400,this.addChild(h);var d=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL),g="";e.retscore>=0?(g=LanguageManager.getlocal("atkracewardes",[e.retscore]),d.textColor=TextFieldConst.COLOR_WARN_GREEN):(g=LanguageManager.getlocal("atkracewardes2",[e.retscore+""]),d.textColor=16711680),d.text=g,d.x=h.x,d.y=h.y+42,this.addChild(d);var c=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_QUALITY_ORANGE);c.text=App.DateUtil.getFormatBySecond(GameData.serverTime-e.st,4),c.x=485,c.y=s.y,this.addChild(c)},e.prototype.getSpaceY=function(){return 0},e.prototype.getSpaceX=function(){return 0},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ActrackVisitTab1Item.prototype,"ActrackVisitTab1Item");var ActrackVisitTab2Item=function(t){function e(){var e=t.call(this)||this;return e.uid="",e}return __extends(e,t),e.prototype.initItem=function(t,e){this.uid=e.uid;var i=BaseBitmap.create("");i.width=516,i.height=126,i.x=60,this.addChild(i);var a=BaseBitmap.create("public_line1");a.x=60,a.y=120,this.addChild(a);var n=BaseBitmap.create("rankinglist_rankbg");n.x=i.x+20,n.y=10,this.addChild(n);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);o.text=String(t+1),o.x=n.x+(n.width-o.width)/2,o.y=n.y+10,this.addChild(o);var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);s.text=e.name,s.x=n.x+60,s.y=n.y+10,this.addChild(s);var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);r.text=LanguageManager.getlocal("atkraceyamenscore",[e.point]),r.x=s.x+s.width,r.y=n.y+10,this.addChild(r);var l=LanguageManager.getlocal("powerDes",[e.power]),h=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);h.text=l,h.x=s.x,h.y=s.y+30,h.width=400,this.addChild(h);var d=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);if(e.point>=0){var g=LanguageManager.getlocal("atkracewardes",[e.point]);d.text=g,d.textColor=TextFieldConst.COLOR_WARN_GREEN}else{var g=LanguageManager.getlocal("atkracewardes2",[e.point]);d.text=g,d.textColor=TextFieldConst.COLOR_QUALITY_RED}d.text=g,d.x=h.x,d.y=h.y+30,this.addChild(d);var c=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_QUALITY_ORANGE);c.text=App.DateUtil.getFormatBySecond(GameData.serverTime-e.st,4),c.x=s.x+300,c.y=s.y,this.addChild(c);var p=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"atkraceRevenge",this.revengeBtnHandler,this);p.setScale(.85),p.x=c.x,p.y=c.y+40,this.addChild(p)},e.prototype.revengeBtnHandler=function(t){var e=[];e.type=2,e.uid=this.uid,AtkraceChallengeItem.data=e,ViewController.getInstance().openView(ViewConst.POPUP.ATKRACECHALLENGEVIEW)},e.prototype.getSpaceY=function(){return 10},e.prototype.getSpaceX=function(){return 0},e.prototype.dispose=function(){AtkraceChallengeItem.data=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ActrackVisitTab2Item.prototype,"ActrackVisitTab2Item");var AtkraceVisitView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["rankinglist_rankbg","atkraceVisitbg","atkracevipbg","office_fnt"])},e.prototype.getShowHeight=function(){return 750},e.prototype.initView=function(){},e.prototype.getTabbarTextArr=function(){return["atkraceVisitTab1","atkraceVisitTab2","atkraceVisitTab3"]},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(PopupView);__reflect(AtkraceVisitView.prototype,"AtkraceVisitView");var AtkraceVisitViewTab1=function(t){function e(){var e=t.call(this)||this;return e.defenseList=[],e._scrollList=null,e.noDataTxt=null,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_probiginnerbg");t.width=516,t.height=618,t.x=25,t.y=55,this.addChild(t),e.AtkaceType=0,NetManager.request(NetRequestConst.REQUEST_ATKRACE_GETMODEL,{}),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACE_GETMODEL),this.useCallback,this)},e.prototype.useCallback=function(t){t.data.ret&&(t.data.data.data.atkrace.dinfo&&t.data.data.data.atkrace.dinfo.length>=1?(this.defenseList=t.data.data.data.atkrace.dinfo,0==e.AtkaceType&&this.showList()):(null==this.noDataTxt&&(this.noDataTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_WHITE),this.noDataTxt.text=LanguageManager.getlocal("atkracedes1"),this.noDataTxt.x=220,this.noDataTxt.y=300),this.addChild(this.noDataTxt)))},e.prototype.showList=function(){if(null==this._scrollList){var t=egret.Rectangle.create();t.setTo(0,0,640,610),this._scrollList=ComponentManager.getScrollList(ActrackVisitTab1Item,this.defenseList,t),this.addChild(this._scrollList),this._scrollList.setPosition(-35,60)}},e.prototype.dispose=function(){this.noDataTxt=null,this.defenseList=[],this._scrollList=null,App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACE_GETMODEL),this.useCallback,this),e.AtkaceType=0,t.prototype.dispose.call(this)},e.AtkaceType=0,e}(PopupViewTab);__reflect(AtkraceVisitViewTab1.prototype,"AtkraceVisitViewTab1");var AtkraceVisitViewTab2=function(t){function e(){var e=t.call(this)||this;return e.einList=[],e._scrollList=null,e._bg=null,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this._bg=BaseBitmap.create("public_9_probiginnerbg"),this._bg.width=516,this._bg.height=618,this._bg.x=25,this._bg.y=55,this.addChild(this._bg),AtkraceVisitViewTab1.AtkaceType=1,NetManager.request(NetRequestConst.REQUEST_ATKRACE_GETMODEL,{}),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACE_GETMODEL),this.useCallback,this)},e.prototype.useCallback=function(t){t.data.ret?t.data.data.data.atkrace.einfo&&(this.einList=t.data.data.data.atkrace.einfo,this.einList.length>0?(AtkraceVisitViewTab1.AtkaceType=1,1==AtkraceVisitViewTab1.AtkaceType&&this.showList()):this.shownoDataTxt()):this.shownoDataTxt()},e.prototype.shownoDataTxt=function(){var t=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_WHITE);t.text=LanguageManager.getlocal("atkracedes2"),t.x=220,t.y=300,this.addChild(t)},e.prototype.showList=function(){var t=egret.Rectangle.create();t.setTo(0,0,640,610),this._scrollList=ComponentManager.getScrollList(ActrackVisitTab2Item,this.einList,t),this.addChild(this._scrollList),this._scrollList.setPosition(-35,60)},e.prototype.dispose=function(){this.einList=[],App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACE_GETMODEL),this.useCallback,this),t.prototype.dispose.call(this),AtkraceVisitViewTab1.AtkaceType=1},e}(PopupViewTab);__reflect(AtkraceVisitViewTab2.prototype,"AtkraceVisitViewTab2");var AtkraceVisitViewTab3=function(t){function e(){var e=t.call(this)||this;return e.powerText=null,e.menkeText=null,e.yamunText=null,e.nameText=null,e.scoreRankText=null,e.bg=null,e.blackBgRect=null,e.playerContainer=null,e.bgImag2=null,e.officialRankbottom=null,e.bottomNameImag=null,e.killBtn=null,e.numLb=null,e._userIdtxt="",e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.bg=BaseBitmap.create("public_9_probiginnerbg"),this.bg.width=520,this.bg.height=502,this.bg.x=25,this.bg.y=60,this.addChild(this.bg);var t=ComponentManager.getTextField(LanguageManager.getlocal("atkraceKillText"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);t.x=62,t.y=80,this.addChild(t);var e=BaseBitmap.create("public_9_bg5");e.width=346,e.height=44,e.x=t.x,e.y=t.y+35,this.addChild(e);var i=new BaseTextField;i.type=egret.TextFieldType.INPUT,i.width=e.width,i.height=e.height,i.x=e.x,i.y=e.y+10,i.maxChars=11,i.textAlign=TextFieldConst.ALIGH_CENTER,i.restrict="0-9",i.text=LanguageManager.getlocal("inputPlayerId"),i.size=20,this.addChild(i),this.userIdInput=i,this.userIdInput.addEventListener(egret.TextEvent.CHANGE,this.callbackInput,this,!1,2),this.userIdInput.addEventListener(egret.FocusEvent.FOCUS_IN,this.foucusHandler,this),this._userIdtxt=i.text;var a=ComponentManager.getTextField(LanguageManager.getlocal("atkraceotherPartyText"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);a.x=e.x,a.y=e.height+e.y+35,this.addChild(a);var n=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"find",this.queryBtnHandler,this);n.setScale(.85),n.x=e.x+e.width+15,n.y=e.y,this.addChild(n);var o=BaseBitmap.create("atkraceVisitbg");o.x=35,o.y=220,this.addChild(o);var s=new BaseDisplayObjectContainer;this.addChild(s),this.playerContainer=s;var r=BaseBitmap.create("atkracevipbg");r.x=o.x+70,r.y=o.y+50,this.addChild(r),r.visible=!1,this.officialRankbottom=r;var l=BaseBitmap.create("public_9_bg20");l.width=490,l.height=62,l.x=o.x+5,l.y=o.y+o.height-l.height-11,this.addChild(l),this.blackBgRect=l,this.showText();var h=BaseBitmap.create("public_resnumbg");h.x=180,h.y=440,this.addChild(h),h.visible=!1,this.bottomNameImag=h;var d=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);d.x=h.x+60,d.y=h.y+5,this.nameText=d,this.addChild(d);var g=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"atkraceVisitTab3",this.killBtnHandler,this);g.x=o.width/2-g.width/2+20,g.y=o.height+o.y+30,this.addChild(g),g.visible=!1,this.killBtn=g;var c=ComponentManager.getTextField(LanguageManager.getlocal("atkraceTracingdescription"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);c.x=300,c.y=640,this.addChild(c)},e.prototype.callbackInput=function(t){this._userIdtxt=t.target.text,App.LogUtil.log("event.target.text:"+t.target.text)},e.prototype.foucusHandler=function(t){var e=LanguageManager.getlocal("inputPlayerId");this._userIdtxt==e&&(this.userIdInput.text="")},e.prototype.showText=function(){this.powerText=ComponentManager.getTextField("atkracepowerText",TextFieldConst.FONTSIZE_CONTENT_COMMON),this.powerText.text="",this.powerText.x=this.blackBgRect.x+50,this.powerText.y=this.blackBgRect.y+this.blackBgRect.height-50,this.addChild(this.powerText),this.menkeText=ComponentManager.getTextField("atkracemenkeText",TextFieldConst.FONTSIZE_CONTENT_COMMON),this.menkeText.text="",this.menkeText.x=this.powerText.x+240,this.menkeText.y=this.powerText.y,this.addChild(this.menkeText),this.yamunText=ComponentManager.getTextField("atkraceyamunText",TextFieldConst.FONTSIZE_CONTENT_COMMON),this.yamunText.text="",this.yamunText.x=this.powerText.x,this.yamunText.y=this.powerText.y+30,this.addChild(this.yamunText),this.scoreRankText=ComponentManager.getTextField("atkracescoreRankText",TextFieldConst.FONTSIZE_CONTENT_COMMON),this.scoreRankText.text="",this.scoreRankText.x=this.menkeText.x,this.scoreRankText.y=this.menkeText.y+30,this.addChild(this.scoreRankText)},e.prototype.queryBtnHandler=function(t){var e=LanguageManager.getlocal("inputPlayerId");if(this._userIdtxt.length<=0||this._userIdtxt==e){var e=LanguageManager.getlocal("atkraceErrordes2");return App.CommonUtil.showTip(e),void this.refreshView()}if(this._userIdtxt.length<7){var e=LanguageManager.getlocal("atkraceErrordes1");App.CommonUtil.showTip(e),this.refreshView()}else NetManager.request(NetRequestConst.REQUEST_ATKRACE_GETINFO,{fuid:this._userIdtxt}),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACE_GETINFO),this.useCallback,this)},e.prototype.useCallback=function(t){if(-2==t.data.data.ret){var e=LanguageManager.getlocal("atkraceErrordes3");App.CommonUtil.showTip(e),this.refreshView()}else if(t.data.data.data.atkraceinfo){this.numLb&&(this.removeChild(this.numLb),this.numLb=null),this.playerContainer&&(this.removeChild(this.playerContainer),this.playerContainer=null),this.bgImag2&&(this.removeChild(this.bgImag2),this.bgImag2=null);var i=t.data.data.data.atkraceinfo,e=LanguageManager.getlocal("officialTitle"+i.level),a=ComponentManager.getBitmapText(e+"","office_fnt");a.width=35,a.height=this.officialRankbottom.height,a.x=this.officialRankbottom.x+3,a.y=this.officialRankbottom.y,this.addChild(a),this.numLb=a,this.officialRankbottom.visible=!0,this.bottomNameImag.visible=!0,Api.playerVoApi.getPlayerID()==Number(this._userIdtxt)||0==i.iscankill?this.killBtn.visible=!1:this.killBtn.visible=!0,this.nameText.visible=!0,this.nameText.visible=!0,this.powerText&&(this.powerText.visible=!0),this.menkeText&&(this.menkeText.visible=!0),this.yamunText&&(this.yamunText.visible=!0),this.scoreRankText&&(this.scoreRankText.visible=!0),this.playerContainer=Api.playerVoApi.getPlayerPortrait(i.level,i.pic),this.playerContainer.x=110,this.playerContainer.y=220,this.addChild(this.playerContainer),this.setChildIndex(this.playerContainer,this.getChildIndex(this.blackBgRect)-1),this.bgImag2=BaseBitmap.create("atkraceVisitbg"),this.bgImag2.x=35,this.bgImag2.y=210,this.addChild(this.bgImag2),this.playerContainer.mask=this.bgImag2,this.nameText.text=i.name,this.scoreRankText&&(this.scoreRankText.text=LanguageManager.getlocal("atkracescoreRankText",[""+i.rank])),this.menkeText&&(this.menkeText.text=LanguageManager.getlocal("atkracemenkeText",[i.snum])),this.yamunText&&(this.yamunText.text=LanguageManager.getlocal("atkraceyamunText",[i.point])),this.powerText&&(this.powerText.text=LanguageManager.getlocal("atkracepowerText",[i.power]))}},e.prototype.killBtnHandler=function(t){if(this._userIdtxt.length<7){var e=LanguageManager.getlocal("atkraceErrordes3");App.CommonUtil.showTip(e)}else{var i=[];i.type=3,i.uid=this._userIdtxt,AtkraceChallengeItem.data=i,ViewController.getInstance().openView(ViewConst.POPUP.ATKRACECHALLENGEVIEW)}},e.prototype.refreshView=function(){this.officialRankbottom.visible=!1,this.bottomNameImag.visible=!1,this.killBtn.visible=!1,this.nameText&&(this.nameText.visible=!1),this.powerText&&(this.powerText.visible=!1),this.menkeText&&(this.menkeText.visible=!1),this.yamunText&&(this.yamunText.visible=!1),this.scoreRankText&&(this.scoreRankText.visible=!1),this.numLb&&(this.numLb.visible=!1),this.playerContainer&&(this.playerContainer.visible=!1)},e.prototype.dispose=function(){this.userIdInput.removeEventListener(egret.FocusEvent.FOCUS_IN,this.foucusHandler,this),this.officialRankbottom.visible=!1,this.bottomNameImag.visible=!1,this.powerText=null,this.menkeText=null,this.yamunText=null,this.scoreRankText=null,this.blackBgRect=null,this.bgImag2=null,this.numLb=null,this._userIdtxt="",t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(AtkraceVisitViewTab3.prototype,"AtkraceVisitViewTab3");var AtkracecrossActivityRewardView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_ATKRACECROSS_RANK,requestData:{}}},e.prototype.receiveData=function(t){1==t.ret&&t.data&&t.data.data.atkrank&&(e._merank=t.data.data.merank,e._mepoint=t.data.data.mepoint,e._iszonewin=t.data.data.iszonewin)},e.prototype.getTabbarTextArr=function(){return["atkracecrossActivityRewardTab1","atkracecrossActivityRewardTab2"]},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["atkracecross_rewatdbg1","atkracecross_rewatdbg2","atkracecross_rewatdbg3","wifeview_bottombg","itemeffect"])},e.prototype.initView=function(){},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e._merank=0,e._mepoint=0,e._iszonewin=0,e}(CommonView);__reflect(AtkracecrossActivityRewardView.prototype,"AtkracecrossActivityRewardView");var AtkracecrossActivityRewardViewTab1=function(t){function e(){var e=t.call(this)||this;return e._nodeContainer=null,e._countDownTime=0,e._countDownText=null,e.initView(),e}return __extends(e,t),e.prototype.getListType=function(){return 1},e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACEG_WINZIDREWARD),this.collectHandlerCallBack,this),this._nodeContainer=new BaseDisplayObjectContainer;var t=BaseBitmap.create("public_9_bg23");t.width=628,t.y=3,t.x=6,this._nodeContainer.addChild(t);var e=BaseBitmap.create("atkracecross_rewatdbg1");e.y=t.y,e.x=GameConfig.stageWidth/2-e.width/2,this._nodeContainer.addChild(e);var i=BaseBitmap.create("public_line3");i.width=480,i.x=GameConfig.stageWidth/2-i.width/2,i.y=e.y+e.height/2-i.height/2,this._nodeContainer.addChild(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossActivityRewardTxt1"),24,TextFieldConst.COLOR_LIGHT_YELLOW);a.x=GameConfig.stageWidth/2-a.width/2,a.y=e.y+e.height/2-a.height/2,this._nodeContainer.addChild(a);for(var n=Config.AcCfg.getCfgByActivityIdAndCode("crossServerAtkRace","1"),o=n.getWinServerRewards(),s=t.x+15,r=e.y+e.height+5,l=0;l<o.length;l++){var h=o[l];h.x=s,h.y=r,s+=h.width+15,s-5>=t.x+t.width&&(s=t.x+15,r+=h.height+10,h.x=s,h.y=r,s+=h.width+15),this._nodeContainer.addChild(h)}r+=120,t.height=r,r+=20;var d=BaseBitmap.create("public_9_bg23");d.width=t.width,d.y=r,d.x=t.x,this._nodeContainer.addChild(d);var g=BaseBitmap.create("atkracecross_rewatdbg1");g.y=d.y,g.x=e.x,this._nodeContainer.addChild(g);var c=BaseBitmap.create("public_line3");c.width=i.width,c.x=i.x,c.y=g.y+g.height/2-c.height/2,this._nodeContainer.addChild(c);var p=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossActivityRewardTxt2"),24,TextFieldConst.COLOR_LIGHT_YELLOW);p.x=GameConfig.stageWidth/2-p.width/2,p.y=g.y+g.height/2-p.height/2,this._nodeContainer.addChild(p);var _=n.getLossServerRewards();s=t.x+15,r=g.y+g.height+5;for(var l=0;l<_.length;l++){var h=_[l];h.x=s,h.y=r,s+=h.width+15,s-5>=t.x+t.width&&(s=t.x+15,r+=h.height+10,h.x=s,h.y=r,s+=h.width+15),this._nodeContainer.addChild(h)}r+=120,d.height=r-d.y;var u=BaseBitmap.create("wifeview_bottombg");u.y=GameConfig.stageHeigth-u.height-150,this.addChild(u);var C=ComponentManager.getTextField("",20);1==AtkracecrossActivityRewardView._iszonewin?C.text=LanguageManager.getlocal("atkracecrossActivityRewardTxt3"):C.text=LanguageManager.getlocal("atkracecrossActivityRewardTxt4"),C.x=u.x+30,C.y=u.y+25,this.addChild(C),TickManager.addTick(this.tick,this);var f=Api.acVoApi.getActivityVoByAidAndCode("crossServerAtkRace");this._countDownTime=f.et-GameData.serverTime,this._countDownText=ComponentManager.getTextField("",20),this.tick(),this._countDownText.x=C.x,this._countDownText.y=C.y+35,this.addChild(this._countDownText),this._collectBtn=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskCollect",this.collectHandler,this),this._collectBtn.x=u.x+u.width-150,this._collectBtn.y=u.y+u.height/2-this._collectBtn.height/2,this._collectBtn.setColor(TextFieldConst.COLOR_BLACK),this._collectBtn.setEnable(!1),this.addChild(this._collectBtn);var m=Api.acVoApi.getActivityVoByAidAndCode("crossServerAtkRace");1==m.getZonereward()?(this._collectBtn.visible=!1,this.createCollectFlag(),this._collectFlag.setScale(.75)):GameData.serverTime>=f.st&&GameData.serverTime<=f.et&&GameData.serverTime+86400>f.et?this._collectBtn.setEnable(!0):C.text=LanguageManager.getlocal("atkracecrossActivityRewardTxt6");var T=new egret.Rectangle(0,0,GameConfig.stageWidth,u.y-5),y=ComponentManager.getScrollView(this._nodeContainer,T);y.y=3,y.horizontalScrollPolicy="off",this.addChild(y)},e.prototype.collectHandler=function(){var t=Api.acVoApi.getActivityVoByAidAndCode("crossServerAtkRace");NetManager.request(NetRequestConst.REQUEST_ATKRACEG_WINZIDREWARD,{activeId:"crossServerAtkRace-"+t.code})},e.prototype.collectHandlerCallBack=function(t){var e=t.data.data;if(0==e.ret){this._collectBtn.visible=!1;var i=e.data.rewards,a=GameData.formatRewardItem(i);App.CommonUtil.playRewardFlyAction(a),this.createCollectFlag(),this._collectFlag.setScale(1),this._collectFlag.visible=!1,this._collectFlag.setScale(1.3),this._collectFlag.visible=!0,egret.Tween.get(this._collectFlag,{loop:!1}).to({scaleX:.75,scaleY:.75},300)}},e.prototype.tick=function(){this._countDownText&&(this._countDownTime>=86400?this._countDownText.text=LanguageManager.getlocal("atkracecrossCDTime2")+this.getCountTimeStr(this._countDownTime-86400):this._countDownTime<86400&&this._countDownTime>=0?this._countDownText.text=LanguageManager.getlocal("atkracecrossCDTime4")+this.getCountTimeStr(this._countDownTime):this._countDownText.text=LanguageManager.getlocal("atkracecrossCDTime2")+LanguageManager.getlocal("acRank_acCDEnd"),this._countDownTime--)},e.prototype.getCountTimeStr=function(t){return 0>t&&(t=0),App.DateUtil.getFormatBySecond(t)},e.prototype.createCollectFlag=function(){this._collectFlag||(this._collectFlag=BaseBitmap.create("collectflag"),this._collectFlag.anchorOffsetX=this._collectFlag.width/2,this._collectFlag.anchorOffsetY=this._collectFlag.height/2,this._collectFlag.x=this._collectBtn.x+this._collectBtn.width/2,this._collectFlag.y=this._collectBtn.y+this._collectBtn.height/2,this.addChild(this._collectFlag))},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACEG_WINZIDREWARD),this.collectHandlerCallBack,this),this._nodeContainer=null,this._collectBtn=null,this._collectFlag=null,this._countDownTime=0,this._countDownText=null,TickManager.removeTick(this.tick,this),t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(AtkracecrossActivityRewardViewTab1.prototype,"AtkracecrossActivityRewardViewTab1");var AtkracecrossActivityRewardViewTab2=function(t){function e(){var e=t.call(this)||this;return e._nodeContainer=null,e.initView(),e}return __extends(e,t),e.prototype.getListType=function(){return 2},e.prototype.initView=function(){this._nodeContainer=new BaseDisplayObjectContainer;var t=Config.AcCfg.getCfgByActivityIdAndCode("crossServerAtkRace","1"),e=t.getServerRankRewards(),i=Object.keys(e);i.sort(function(t,e){return Number(t)-Number(e)});for(var a=20,n=3,o=0;o<i.length;o++){var s=i[o],r=e[s],l=BaseBitmap.create("public_9_bg23");l.width=628,l.y=n,l.x=6,this._nodeContainer.addChild(l);var h=BaseBitmap.create("atkracecross_rewatdbg3");h.y=n,h.x=GameConfig.stageWidth/2-h.width/2,this._nodeContainer.addChild(h);var d=BaseBitmap.create("public_line3");d.width=480,d.x=GameConfig.stageWidth/2-d.width/2,d.y=h.y+h.height/2-d.height/2,this._nodeContainer.addChild(d);var g=r.reward,c=r.rank,p=ComponentManager.getTextField("",24,TextFieldConst.COLOR_LIGHT_YELLOW);Number(s)<4?p.text=LanguageManager.getlocal("acRank_rank"+s):p.text=p.text=LanguageManager.getlocal("acRank_rank4",[String(c[0]),String(c[1])]),p.x=GameConfig.stageWidth/2-p.width/2,p.y=h.y+h.height/2-p.height/2,this._nodeContainer.addChild(p);
var _=GameData.getRewardItemIcons(g,!0,!0),u=_.length,C=h.y+h.height+5;a=20,n=C;for(var f=0;u>f;f++){var m=_[f];m.x=a,m.y=n,a+=m.width+15,a>=GameConfig.stageWidth&&(a=20,n+=m.height+15,m.x=a,m.y=n,a+=m.width+8),this._nodeContainer.addChild(m)}n+=130,l.height=n-l.y,n+=10}n+=10;var T=BaseBitmap.create("wifeview_bottombg");T.y=GameConfig.stageHeigth-T.height-150,this.addChild(T);var y=ComponentManager.getTextField("",20);AtkracecrossActivityRewardView._merank?y.text=LanguageManager.getlocal("acRank_myrank1",[String(AtkracecrossActivityRewardView._merank)]):y.text=LanguageManager.getlocal("acRank_myrank1",[LanguageManager.getlocal("atkracedes4")]),y.x=T.x+30,y.y=T.y+T.height/2-y.height/2,this.addChild(y);var v=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossActivityRewardTxt5"),20,TextFieldConst.COLOR_LIGHT_YELLOW);v.x=T.x+T.width-v.width-30,v.y=y.y,this.addChild(v);var A=new egret.Rectangle(0,0,GameConfig.stageWidth,T.y-10),w=ComponentManager.getScrollView(this._nodeContainer,A);w.y=3,w.horizontalScrollPolicy="off",this.addChild(w)},e.prototype.dispose=function(){this._nodeContainer=null,this._collectBtn=null,this._collectFlag=null,t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(AtkracecrossActivityRewardViewTab2.prototype,"AtkracecrossActivityRewardViewTab2");var AtkracecrossAgreePopupDialog=function(t){function e(){var e=t.call(this)||this;return e._type=0,e._callbackF=null,e._obj=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["atkrace_popup_bg"])},e.prototype.getTitleStr=function(){return"atkraceViewTitle"},e.prototype.getBgExtraHeight=function(){return 0},e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT,this.doGuide,this);var t=BaseBitmap.create("atkrace_popup_bg");t.setPosition(this.viewBg.width/2-t.width/2,0),this.addChildToContainer(t),this._type=this.param.data.type;var e=this.param.data.sid,i=BaseLoadBitmap.create(Api.servantVoApi.getFullImgPathWithId(e));i.width=324,i.height=373.6,i.x=this.viewBg.width/2-i.width/2,i.y=t.height-i.height,this.addChildToContainer(i);var a=LanguageManager.getlocal("atkraceAgreeAsk"+this._type,[this.param.data.name]),n=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_COMMON);n.width=500,n.lineSpacing=5;var o=BaseBitmap.create("public_9_bg11");o.width=t.width,o.height=n.height+40,o.setPosition(this.viewBg.width/2-o.width/2,t.height-o.height),this.addChildToContainer(o),n.setPosition(this.viewBg.width/2-n.width/2,t.height-n.height-20),this.addChildToContainer(n);var s=[];1==this._type&&s.push("atkraceAgreeAnswer0"),s.push("atkraceAgreeAnswer"+this._type);for(var r=0;r<s.length;r++){var l=BaseBitmap.create("public_9_bg28");l.width=556,l.height=55,l.setPosition(GameConfig.stageWidth/2-l.width/2,GameConfig.stageHeigth/2+260+65*r),this.addChild(l),l.addTouchTap(this.btnClick,this,[r]);var h=ComponentManager.getTextField(LanguageManager.getlocal(s[r]),TextFieldConst.FONTSIZE_CONTENT_COMMON);h.setPosition(l.x+38,l.y+l.height/2-h.height/2),this.addChild(h)}Api.rookieVoApi.isGuiding||(this.touchEnabled=!1,this.y=-200,this.alpha=0,egret.Tween.get(this).to({alpha:1,y:0},500).call(this.remove,this))},e.prototype.remove=function(){this.drawblackMask(),this.touchEnabled=!0},e.prototype.isShowMask=function(){return!1},e.prototype.drawblackMask=function(){var t=BaseBitmap.create("public_9_viewmask");t.width=GameConfig.stageWidth,t.height=GameConfig.stageHeigth,t.touchEnabled=!0,this.addChild(t),this.setChildIndex(t,0)},e.prototype.btnClick=function(t,e){1==this._type&&0==e?this.request(NetRequestConst.REQUEST_ATKRACECROSS_HANDLE,{handle:1}):this.hide()},e.prototype.doGuide=function(){this.request(NetRequestConst.REQUEST_ATKRACECROSS_HANDLE,{handle:1})},e.prototype.receiveData=function(t){1==t.ret&&(this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f),ViewController.getInstance().openView(ViewConst.COMMON.ATKRACECROSSARRESTVIEW,{f:this._callbackF,o:this._obj}),this.hide())},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT,this.doGuide,this),this._type=0,this._callbackF=null,this._obj=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AtkracecrossAgreePopupDialog.prototype,"AtkracecrossAgreePopupDialog");var AtkracecrossArrestView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e._servantInfoArray=[],e._isShowBuy=!1,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["atkrace_arrest_bg","atkrace_enemy_bg","atkrace_my_bg","atkrace_name_bg","atkrace_one_key","atkrace_temp_property","atkrace_text_bg","atkrace_vs","progress7_bg","progress8","signin_had_get"])},e.prototype.getTitleStr=function(){return"atkraceArrestViewTitle"},e.prototype.initView=function(){this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f),this.container.y=this.getTitleButtomY();var t=GameConfig.stageHeigth-this.container.y,e=BaseBitmap.create("atkrace_arrest_bg");e.y=t/2-e.height/2,this.addChildToContainer(e);var i=BaseBitmap.create("atkrace_vs");i.setPosition(GameConfig.stageWidth/2-i.height/2+41,t/2-i.height/2),this.addChildToContainer(i);var a=Api.atkracecrossVoApi.getMyFightInfo(),n=BaseBitmap.create("atkrace_enemy_bg");this.addChildToContainer(n),this._scoreText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._scoreText.setPosition(22,22),this.addChildToContainer(this._scoreText);var o=Object.keys(a.sids).length,s=a.total;this._servantCount=ComponentManager.getTextField(LanguageManager.getlocal("servant_count")+"("+o+"/"+s+")",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._servantCount.setPosition(GameConfig.stageWidth-this._servantCount.width-22,this._scoreText.y),this.addChildToContainer(this._servantCount),this.resetServantInfo();var r=ComponentManager.getButton("atkrace_text_bg",null,this.tempPropertyClick,this);r.setPosition(19,295),this.addChildToContainer(r);var l=BaseBitmap.create("atkrace_temp_property");l.setPosition(r.width/2-l.width/2,r.height/2-l.height/2),r.addChild(l);var h=BaseBitmap.create("atkrace_my_bg");h.y=t-h.height,this.addChildToContainer(h);var d=BaseBitmap.create("atkrace_name_bg");d.width=270,d.height=35,d.setPosition(320,h.y+23),this.addChildToContainer(d);var g=a.mesid;this._playerScore=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_score",[Api.playerVoApi.getPlayerName(),Api.atkracecrossVoApi.getPoint().toString()]),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW),this._playerScore.setPosition(345,d.y+d.height/2-this._playerScore.height/2),this.addChildToContainer(this._playerScore);var c=LanguageManager.getlocal("servant_name"+g.sid),p=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_level",[c,g.lv.toString()]),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);p.setPosition(this._playerScore.x,this._playerScore.y+50),this.addChildToContainer(p);var _=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_info_1"),TextFieldConst.FONTSIZE_CONTENT_COMMON);_.setPosition(this._playerScore.x,p.y+40),this.addChildToContainer(_);var u=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_info_2"),TextFieldConst.FONTSIZE_CONTENT_COMMON);u.setPosition(this._playerScore.x,_.y+35),this.addChildToContainer(u);var C=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_info_3"),TextFieldConst.FONTSIZE_CONTENT_COMMON);C.setPosition(this._playerScore.x,u.y+35),this.addChildToContainer(C),this._infoText1=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN),this._infoText1.setPosition(_.x+_.width,_.y),this.addChildToContainer(this._infoText1),this._infoText2=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,this._infoText1.textColor),this._infoText2.setPosition(u.x+u.width,u.y),this.addChildToContainer(this._infoText2),this._infoText3=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,this._infoText1.textColor),this._infoText3.setPosition(C.x+C.width,C.y),this.addChildToContainer(this._infoText3);var f=BaseLoadBitmap.create(Api.servantVoApi.getFullImgPathWithId(g.sid));f.width=324,f.height=373.6,f.y=t-f.height-25,this.addChildToContainer(f),this._progressBar=ComponentManager.getProgressBar("progress8","progress7_bg",GameConfig.stageWidth),this._progressBar.y=t-this._progressBar.height,this.addChildToContainer(this._progressBar),this.resetInfoText()},e.prototype.resetServantInfo=function(){if(this._servantInfoArray.length>0){for(var t in this._servantInfoArray)this._servantInfoArray[t].dispose();this._servantInfoArray.length=0}var e=0,i=Api.atkracecrossVoApi.getMyFightInfo();for(var a in i.fids){var n=new BaseDisplayObjectContainer;this.addChildToContainer(n),this._servantInfoArray.push(n);var o=i.fids[a],s=Config.ServantCfg.getServantItemById(a),r=BaseLoadBitmap.create("servant_cardbg_"+o.clv);r.width=194,r.height=192,r.setPosition(15+(r.width+14)*e,62),n.addChild(r),e++,r.addTouchTap(this.vsClick,this,[a]);var l=BaseLoadBitmap.create(s.halfIcon);l.width=180,l.height=177,l.x=r.x+r.width/2-l.width/2,l.y=r.y+r.height/2-l.height/2-2,n.addChild(l)}},e.prototype.resetInfoText=function(){var t=Api.atkracecrossVoApi.getMyFightInfo(),e=t.mesid;this._infoText1.text=e.ability.toString();var i=t.tmpattr,a=0,n=0;i&&(i.atk&&(a=Math.floor(100*i.atk)),i.skill&&(n=Math.floor(100*i.skill))),this._infoText2.text=a.toString()+"%",this._infoText3.text=n.toString()+"%";var o=t.total,s=o-t.fightnum;this._servantCount.text=LanguageManager.getlocal("servant_count")+"("+s+"/"+o+")";var r=t.fname;"robot"==t.uid&&(r=LanguageManager.getlocal("atkRaceRobotName"+t.fname)),this._scoreText.text=LanguageManager.getlocal("atkrace_score",[r,t.fpoint.toString()]),this._progressBar.setText(e.attr+"/"+e.fullattr),this._progressBar.setPercentage(e.attr/e.fullattr),this._playerScore.text=LanguageManager.getlocal("atkrace_score",[Api.playerVoApi.getPlayerName(),Api.atkracecrossVoApi.getPoint().toString()])},e.prototype.tempPropertyClick=function(){ViewController.getInstance().openView(ViewConst.POPUP.ATKRACECROSSBUYPOPUPVIEW,{f:this.resetInfoText,o:this})},e.prototype.oneKeyClick=function(){ViewController.getInstance().openView(ViewConst.POPUP.ATKRACECROSSREWARDPOPUPVIEW,{})},e.prototype.vsClick=function(t,e){var i=Api.atkracecrossVoApi.getMyFightInfo();if(this._key=e,0==i.fightnum&&0==this._isShowBuy&&(null==i.tmpattr||0==i.tmpattr.atk&&0==i.tmpattr.blood)){this._isShowBuy=!0;var a=Config.AcCfg.getCfgByActivityIdAndCode("crossServerAtkRace",1);a.getFightAdd();ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"itemUseConstPopupViewTitle",msg:LanguageManager.getlocal("atkrace_no_property"),callback:this.realFight,handler:this,needCancel:!0})}else this.realFight()},e.prototype.realFight=function(){ViewController.getInstance().openView(ViewConst.BATTLE.ATKRACECROSSBATTLEVIEW,{f:this.resetBattleInfo,o:this,servantid:this._key,f2:this.battleEnd})},e.prototype.resetBattleInfo=function(){this.resetInfoText(),this.resetServantInfo(),this.tempPropertyClick()},e.prototype.battleEnd=function(){this.hide()},e.prototype.hide=function(){this._obj&&this._callbackF&&this._callbackF.apply(this._obj),t.prototype.hide.call(this)},e.prototype.receiveData=function(t){},e.prototype.dispose=function(){this._infoText1=null,this._infoText2=null,this._infoText3=null,this._servantCount=null,this._servantInfoArray.length=0,this._scoreText=null,this._progressBar=null,this._isShowBuy=!1,this._key=null,this._playerScore=null,this._callbackF=null,this._obj=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(AtkracecrossArrestView.prototype,"AtkracecrossArrestView");var AtkracecrossBattleView=function(t){function e(){var e=t.call(this)||this;return e._isAttackWin=null,e._isEnd=!1,e._callbackF=null,e._callbackF2=null,e._obj=null,e._rewards=null,e._battleInfo=null,e._curRound=0,e._winNumber=0,e._totalNumber=0,e._oldInfo=[],e}return __extends(e,t),e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getRequestData=function(){var t=this.param.data.servantid,e=Api.atkracecrossVoApi.getMyFightInfo(),i=e.mesid;this._oldInfo[0]={max:i.fullattr,cur:i.attr,level:i.lv,sid:i.sid,ability:i.ability};var a=e.fids[t];this._oldInfo[1]={max:a.fullattr,cur:a.attr,level:a.lv,sid:t,ability:a.ability,name:e.getFName()},this._winNumber=e.fightnum,this._totalNumber=e.total;var n=Api.acVoApi.getActivityVoByAidAndCode("crossServerAtkRace");return{requestType:NetRequestConst.REQUEST_ATKRACECROSS_FIGHT,requestData:{servantid:t,activeId:n.aidAndCode}}},e.prototype.receiveData=function(t){1==t.ret?(this._battleInfo=t.data.data.atkreports,this._isAttackWin=1==t.data.data.win):this.hide()},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["atkrace_battle_info","atkrace_skip"])},e.prototype.getBgName=function(){return"arena_bg"},e.prototype.initBg=function(){var t=this.getBgName();if(t){var e=egret.Rectangle.create();e.setTo(0,0,832,1476.8),this.viewBg=BaseLoadBitmap.create(t,e),this.viewBg.setPosition(-96,.2*(GameConfig.stageHeigth-this.viewBg.height)),this.addChild(this.viewBg)}},e.prototype.getCloseBtnName=function(){return null},e.prototype.initView=function(){this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f,this._callbackF2=this.param.data.f2),this._isEnd=!1,App.MessageHelper.addEventListener(MessageConst.MESSAGE_ATKRACECROSS_FIGHTEND,this.hide,this);var t=BaseBitmap.create("servant_mask");t.width=GameConfig.stageWidth,t.y=GameConfig.stageHeigth-t.height,this.addChildToContainer(t);var e=BaseBitmap.create("servant_mask");e.width=GameConfig.stageWidth,e.scaleY=-1,e.y=e.height,this.addChildToContainer(e),this.setTopProgress(this._oldInfo[1].cur,this._oldInfo[1].max),this.setBottomProgress(this._oldInfo[0].cur,this._oldInfo[0].max);var i=Config.ServantCfg.getServantItemById(this._oldInfo[1].sid).fullIcon,a=Config.ServantCfg.getServantItemById(this._oldInfo[0].sid).fullIcon;this.setUpHero(i,{level:this._oldInfo[1].level,name:LanguageManager.getlocal("servant_name"+this._oldInfo[1].sid),ability:this._oldInfo[1].ability}),this.setDownHero(a,{level:this._oldInfo[0].level,name:LanguageManager.getlocal("servant_name"+this._oldInfo[0].sid),ability:this._oldInfo[0].ability}),this._upHero.x=17,this._downHero.x=280,this._upPositon=egret.Point.create(this._upHero.x,this._upHero.y),this._downPositon=egret.Point.create(this._downHero.x,this._downHero.y);var n=ComponentManager.getButton("atkrace_skip",null,this.skipBattle,this);n.setPosition(GameConfig.stageWidth-n.width-12,45),this.addChild(n),this.showRound()},e.prototype.showRound=function(){if(this._battleInfo.length>this._curRound){var t=this._battleInfo[this._curRound];this.attackHandle(t[0],t[2],t[1]),this._curRound++}else this.showEndGameBefore()},e.prototype.showEndGameBefore=function(){var t;t=this._isAttackWin?this._upHero:this._downHero,egret.Tween.get(t).to({alpha:0},800).call(this.showEndGame,this)},e.prototype.skipBattle=function(){1!=this._isEnd&&this.showEndGame()},e.prototype.showEndGame=function(){this._isEnd=!0,this._isAttackWin?ViewController.getInstance().openView(ViewConst.BASE.BATTLEWIN,{f:this.endCallBack,o:this,num:this._winNumber,type:2}):ViewController.getInstance().openView(ViewConst.BASE.PROMPTVIEW,{type:4,f:this.endCallBack,o:this})},e.prototype.endCallBack=function(){if(this._isAttackWin)this._winNumber%3==2?ViewController.getInstance().openView(ViewConst.POPUP.ATKRACECROSSREWARDPOPUPVIEW,{f:this.winHandle,o:this}):this.winHandle();else{var t=this._oldInfo[1].name,e=this._oldInfo[0].sid;this._winNumber>0?ViewController.getInstance().openView(ViewConst.POPUP.ATKRACEAGREEPOPUPVIEW,{type:3,name:t,sid:e}):ViewController.getInstance().openView(ViewConst.POPUP.ATKRACEAGREEPOPUPVIEW,{type:2,name:t,sid:e}),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_RESET_ATKRACECROSS),this._callbackF2.apply(this._obj),this.hide()}},e.prototype.winHandle=function(){if(this._winNumber+1==this._totalNumber){var t=this._oldInfo[1].name,e=this._oldInfo[0].sid;ViewController.getInstance().openView(ViewConst.POPUP.ATKRACEAGREEPOPUPVIEW,{type:4,name:t,sid:e}),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_RESET_ATKRACECROSS),this._callbackF2.apply(this._obj)}else this._callbackF.apply(this._obj);this.hide()},e.prototype.atkEndCallback=function(){1!=this._isEnd&&this.showRound()},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_ATKRACECROSS_FIGHTEND,this.hide,this),this._battleInfo=null,this._isEnd=!1,this._isAttackWin=null,this._rewards=null,this._oldInfo.length=0,this._winNumber=0,this._callbackF2=null,this._callbackF=null,this._obj=null,this._totalNumber=0,this._curRound=0,t.prototype.dispose.call(this)},e}(BaseBattleView);__reflect(AtkracecrossBattleView.prototype,"AtkracecrossBattleView");var AtkracecrossBuyPopupView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e._buyInfo=[],e._buyBtnTab=[],e._containerTab=[],e._clickIndex=0,e._goldText=null,e._moraleText=null,e}return __extends(e,t),e.prototype.getTitleStr=function(){return"atkraceBuyPopupViewTitle"},e.prototype.getRequestData=function(){var t=Api.atkracecrossVoApi.getMyFightInfo().tmpattr,e=Api.atkracecrossVoApi.getMyFightInfo();return 0==e.fightnum?null:t&&t.list&&Object.keys(t.list).length>0?null:{requestType:NetRequestConst.REQUEST_ATKRACECROSS_ATTRBUYLIST,requestData:{}}},e.prototype.initView=function(){this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f),App.MessageHelper.addEventListener(MessageConst.MESSAGE_ATKRACECROSS_FIGHTEND,this.hide,this);var t=BaseBitmap.create("public_9_resbg");t.setPosition(32,12),this.addChildToContainer(t);var e=egret.Rectangle.create();e.setTo(0,0,45,45);var i=BaseLoadBitmap.create("itemicon1",e);i.setPosition(t.x-1,t.y+t.height/2-22.5),this.addChildToContainer(i),this._goldText=ComponentManager.getTextField(Api.playerVoApi.getPlayerGem().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON),this._goldText.setPosition(i.x+50,t.y+t.height/2-this._goldText.height/2),this.addChildToContainer(this._goldText),t.width=this._goldText.width+70;var a=BaseBitmap.create("public_9_resbg");a.setPosition(280,12),this.addChildToContainer(a);var n=BaseBitmap.create("atkrace_morale");n.setPosition(a.x+3,a.y+a.height/2-22.5),this.addChildToContainer(n),this._moraleText=ComponentManager.getTextField(Api.atkracecrossVoApi.getMyInfo().morale.toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON),this._moraleText.setPosition(n.x+50,a.y+a.height/2-this._moraleText.height/2),this.addChildToContainer(this._moraleText),a.width=this._moraleText.width+70;var o=BaseBitmap.create("public_9_bg4");o.width=528,o.height=404,o.setPosition(this.viewBg.width/2-o.width/2,60),this.addChildToContainer(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_info_2"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);s.setPosition(50,o.y+o.height+18),this.addChildToContainer(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_info_3"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);r.setPosition(280,s.y),this.addChildToContainer(r);var l=Api.atkracecrossVoApi.getMyFightInfo(),h=l.mesid,d=l.tmpattr,g=0,c=0;d&&(d.atk&&(g=Math.floor(100*d.atk)),d.skill&&(c=Math.floor(100*d.skill)));var p=ComponentManager.getTextField(g.toString()+"%",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN2);p.setPosition(s.x+s.width,s.y),this.addChildToContainer(p);var _=ComponentManager.getTextField(c.toString()+"%",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN2);_.setPosition(r.x+r.width,r.y),this.addChildToContainer(_);var u=ComponentManager.getTextField(LanguageManager.getlocal("atkrace_property3"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);u.setPosition(s.x,s.y+35),this.addChildToContainer(u);var C=ComponentManager.getProgressBar("progress8","progress7_bg",410);C.x=u.x+u.width+20,C.y=u.y-C.height/2+u.height/2,this.addChildToContainer(C),C.setText(h.attr+"/"+h.fullattr),C.setPercentage(h.attr/h.fullattr);var f=Config.AcCfg.getCfgByActivityIdAndCode("crossServerAtkRace",1);if(0==l.fightnum)for(var m=1;3>=m;m++)this._buyInfo.push([f.getInitAtt(m.toString()),1,m.toString()]);else{var T=Api.atkracecrossVoApi.getMyFightInfo().tmpattr.list;this._buyInfo.push([f.getJuniorAtt(T[2]),2,T[2]]),this._buyInfo.push([f.getMediumAtt(T[3]),3,T[3]]),this._buyInfo.push([f.getSeniorAtt(T[4]),4,T[4]])}for(var m=1;3>=m;m++){var y=this.getBuyTypeContainer(this._buyInfo[m-1][0],m,this._buyInfo[m-1][1]);y.setPosition(this.viewBg.width/2-259+4,130*(m-1)+73),this.addChildToContainer(y),this._containerTab.push(y)}},e.prototype.getBuyTypeContainer=function(t,e,i){var a=new BaseDisplayObjectContainer,n=BaseBitmap.create("public_9_probiginnerbg");n.width=508,n.height=118,a.addChild(n);var o=LanguageManager.getlocal("atkrace_property_lv"+e,[LanguageManager.getlocal("atkrace_property"+t.att)]),s=ComponentManager.getTextField(o,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_BLUE);s.setPosition(130,15),a.addChild(s);var r=Math.floor(100*t.effect),l=LanguageManager.getlocal("atkrace_add_property",[LanguageManager.getlocal("atkrace_property"+t.att),r.toString()]),h=ComponentManager.getTextField(l,TextFieldConst.FONTSIZE_CONTENT_SMALL);h.setPosition(s.x,s.y+s.height+12),a.addChild(h);var d=ComponentManager.getTextField(LanguageManager.getlocal("adultChooseCost")+":",TextFieldConst.FONTSIZE_CONTENT_SMALL);d.setPosition(s.x,h.y+h.height+12),a.addChild(d);var g=egret.Rectangle.create();g.setTo(0,0,100,100);var c;c=1==i?"atkrace_icon_1_"+e:"atkrace_icon_"+t.att+"_"+e;var p=BaseLoadBitmap.create(c,g);p.setPosition(11,n.height/2-p.height/2),a.addChild(p);var _,u,C,f=egret.Rectangle.create();t.costGem?(_="itemicon1",f.setTo(0,0,45,45),u=t.costGem,C=BaseLoadBitmap.create(_,f)):(_="atkrace_morale",f.setTo(0,0,36,40),u=t.costPoint,C=BaseBitmap.create(_)),C.setPosition(d.x+d.width,d.y+d.height/2-C.height/2),a.addChild(C);var m=ComponentManager.getTextField(u.toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL);m.setPosition(C.x+45,d.y),a.addChild(m);var T,y=Api.atkracecrossVoApi.getMyFightInfo().tmpattr;if(y&&(T=y.isbuy),"0"!=T&&T){var v=T.split("_");if("1"==v[0]){if(Number(v[1])==e){var A=BaseBitmap.create("public_buy");A.setPosition(n.width-A.width-10,n.height/2-A.height/2),a.addChild(A)}}else if(Number(v[0])==i){var A=BaseBitmap.create("public_buy");A.setPosition(n.width-A.width-10,n.height/2-A.height/2),a.addChild(A)}}else{var w=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"acPunishBuyItemBuy",this.buyClick,this,[e]);w.setPosition(n.width-w.width-10,n.height/2-w.height/2),w.setColor(TextFieldConst.COLOR_BLACK),a.addChild(w),this._buyBtnTab.push(w)}return a},e.prototype.buyClick=function(t){var e=this._buyInfo[t-1],i=e[0];if(i.costGem){if(i.costGem>Api.playerVoApi.getPlayerGem())return void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough"))}else{var a=i.costPoint,n=Api.atkracecrossVoApi.getMyInfo().morale;if(a>n)return void App.CommonUtil.showTip(LanguageManager.getlocal("atkRace_buy_NotEnough"))}this._clickIndex=t,this.request(NetRequestConst.REQUEST_ATKRACECROSS_ATTRBUY,{atttype:e[1].toString(),attid:e[2]})},e.prototype.receiveData=function(t){var e=t.data;0!=t.ret&&(e.cmd==NetRequestConst.REQUEST_ATKRACECROSS_ATTRBUYLIST||e.cmd==NetRequestConst.REQUEST_ATKRACECROSS_ATTRBUY&&(this._obj&&this._callbackF&&this._callbackF.apply(this._obj),this.showBuyAnim(),this._goldText.text=Api.playerVoApi.getPlayerGem().toString(),this._moraleText.text=Api.atkracecrossVoApi.getMyInfo().morale.toString()))},e.prototype.showBuyAnim=function(){for(var t in this._buyBtnTab)this._buyBtnTab[t].visible=!1;var e=BaseBitmap.create("public_buy");e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.setPosition(508-e.width/2-10,59),e.setScale(1.5),this._containerTab[this._clickIndex-1].addChild(e),egret.Tween.get(e,{loop:!1}).to({scaleX:1,scaleY:1},400).wait(300).call(this.hide,this)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_ATKRACECROSS_FIGHTEND,this.hide,this),this._callbackF=null,this._obj=null,this._buyInfo.length=0,this._buyBtnTab.length=0,this._clickIndex=0,this._containerTab.length=0,this._goldText=null,this._moraleText=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AtkracecrossBuyPopupView.prototype,"AtkracecrossBuyPopupView");var AtkracecrossDetailPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["atkracecross_explain_bg","atkracecross_explain_pic"])},e.prototype.getTitleStr=function(){return"atkracecrossDetailTitle"},e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=524,t.height=664,t.setPosition(this.viewBg.width/2-t.width/2,12),this.addChildToContainer(t);var e=BaseBitmap.create("atkracecross_explain_pic");e.setPosition(this.viewBg.width/2-e.width/2,t.y+4),this.addChildToContainer(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossActivityRewardTab1"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_BROWN);i.setPosition(e.x+5,e.y+e.height+8),this.addChildToContainer(i);var a=BaseBitmap.create("atkracecross_explain_bg");a.width=518,a.height=90,a.setPosition(this.viewBg.width/2-a.width/2,i.y+i.height+8),this.addChildToContainer(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossDetailDesc1"),TextFieldConst.FONTSIZE_CONTENT_SMALL);n.setPosition(a.x+20,a.y+8),n.width=a.width-40,n.lineSpacing=6,this.addChildToContainer(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("acPunishRankRewardTab1"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_BROWN);o.setPosition(i.x,a.y+a.height+12),this.addChildToContainer(o);var s=BaseBitmap.create("atkracecross_explain_bg");s.width=518,s.height=40,s.setPosition(this.viewBg.width/2-s.width/2,o.y+o.height+8),this.addChildToContainer(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossDetailDesc2"),19);r.setPosition(s.x+20,s.y+12),r.width=a.width-40,r.lineSpacing=6,this.addChildToContainer(r);var l=BaseBitmap.create("atkracecross_explain_bg");l.width=518,l.height=66,l.setPosition(this.viewBg.width/2-l.width/2,s.y+s.height+12),this.addChildToContainer(l);var h=Api.acVoApi.getActivityVoByAidAndCode("crossServerAtkRace"),d=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossTime",[h.acTimeAndHour]),TextFieldConst.FONTSIZE_CONTENT_SMALL);d.x=r.x,d.y=l.y+10,this.addChildToContainer(d);var g=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_RED);g.setPosition(d.x,d.y+d.height+10),this.addChildToContainer(g);var c=86400;h.et-GameData.serverTime<=c?g.text=LanguageManager.getlocal("atkracecrossCDTime3"):g.text=LanguageManager.getlocal("atkracecrossDetailDesc3");var p=BaseBitmap.create("public_9_bg41");p.width=492,p.height=136,p.setPosition(this.viewBg.width/2-p.width/2,l.y+l.height+12),this.addChildToContainer(p);var _=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_RED);_.setPosition(p.x+20,p.y+12),_.width=p.width-40,_.height=p.height-24,_.lineSpacing=6,_.textAlign=egret.HorizontalAlign.CENTER,_.verticalAlign=egret.VerticalAlign.MIDDLE,this.addChildToContainer(_),h.info&&1==h.info.iscanjoin?_.text=LanguageManager.getlocal("atkraceCrossOpenDesc2"):_.text=LanguageManager.getlocal("atkraceCrossOpenDesc3");var u=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"sysConfirm",this.hide,this);u.setPosition(this.viewBg.width/2-u.width/2,t.y+t.height+20),this.addChildToContainer(u)},e.prototype.getBgExtraHeight=function(){return 20},e}(PopupView);__reflect(AtkracecrossDetailPopupView.prototype,"AtkracecrossDetailPopupView");var AtkracecrossRewardPopupView=function(t){function e(){var e=t.call(this)||this;return e._backCardArray=[],e._awardIconArray=[],e._clickIdx=0,e._iconWidth=108,e._turnTime=400,e._callbackF=null,e._obj=null,e._rewardsStr=null,e}return __extends(e,t),e.prototype.getTitleStr=function(){return"atkrace_win_award"},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["atkrace_card_back","atkrace_reward_anim"])},e.prototype.getBgExtraHeight=function(){return 20},e.prototype.getCloseBtnName=function(){return null},e.prototype.initView=function(){this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f),App.MessageHelper.addEventListener(MessageConst.MESSAGE_ATKRACECROSS_FIGHTEND,this.hide,this);var t=BaseBitmap.create("public_9_bg4");t.width=520,t.height=272,t.setPosition(this.viewBg.width/2-t.width/2,20),this.addChildToContainer(t);for(var e=1;6>=e;e++){var i=ComponentManager.getButton("atkrace_card_back",null,this.clickCard,this,[e]);i.setPosition(70+(e-1)%3*(i.width+46),35+Math.floor((e-1)/3)*(i.height+20)),this.addChildToContainer(i),this._backCardArray.push(i)}this._clip=ComponentManager.getCustomMovieClip("atkrace_reward_anim",7,80),this._clip.setEndCallBack(this.animEndCallback,this)},e.prototype.clickCard=function(t){for(var e in this._backCardArray)this._backCardArray[e].setEnable(!1);this._clickIdx=t,this.request(NetRequestConst.REQUEST_ATKRACECROSS_RANDREWARD,{pos:t})},e.prototype.receiveData=function(t){t.data;if(0!=t.ret){var e;e=t.data.data.randcards;var i=GameData.formatRewardItem(e[this._clickIdx-1])[0],a=i.type;6==a&&(a=i.id),this._rewardsStr=LanguageManager.getlocal("get_item",[LanguageManager.getlocal("itemName_"+a),i.num.toString()]);for(var n=0;6>n;n++){var o=GameData.getRewardItemIcons(e[n])[0];o.setPosition(70+n%3*(o.width+46)+this._iconWidth/2,35+Math.floor(n/3)*(o.height+20)),this.addChildToContainer(o),o.scaleX=0,o.visible=!1,this._awardIconArray.push(o)}var s=this._backCardArray[this._clickIdx-1];egret.Tween.get(s).to({scaleX:0,x:s.x+this._iconWidth/2},this._turnTime).call(this.showAnim,this)}},e.prototype.showAnim=function(){var t=this._awardIconArray[this._clickIdx-1],e=BaseBitmap.create("atkrace_reward_anim1");this._clip.setPosition(t.x-e.width/2,t.y-e.height/2+this._iconWidth/2),this._clip.playWithTime(1),this.addChildToContainer(this._clip),BaseBitmap.release(e),t.visible=!0,egret.Tween.get(t).to({scaleX:1,x:t.x-this._iconWidth/2},this._turnTime).call(this.turnOtherCards,this)},e.prototype.animEndCallback=function(t){t.visible=!1},e.prototype.turnOtherCards=function(){var t=this._awardIconArray[this._clickIdx-1],e=t.x,i=t.y,a=t.x+.05*t.width,n=t.y+.05*t.height;egret.Tween.get(t,{loop:!0}).to({scaleX:.9,scaleY:.9,x:a,y:n},400).to({scaleX:1,scaleY:1,x:e,y:i},400);for(var o=0;6>o;o++)if(o+1!=this._clickIdx){var s=this._backCardArray[o],r=this._awardIconArray[o];r.visible=!0,egret.Tween.get(s).to({scaleX:0,x:s.x+this._iconWidth/2},this._turnTime),egret.Tween.get(r).wait(this._turnTime).to({scaleX:1,x:r.x-this._iconWidth/2},this._turnTime)}TimerManager.doTimer(2*this._turnTime,1,this.showTips,this)},e.prototype.showTips=function(){var t=BaseBitmap.create("public_numbg");t.width=540,t.setPosition(GameConfig.stageWidth/2-t.width/2,this.viewBg.y+this.viewBg.height+20),this.addChild(t);var e=ComponentManager.getTextField(this._rewardsStr,TextFieldConst.FONTSIZE_CONTENT_SMALL);e.setPosition(GameConfig.stageWidth/2-e.width/2,t.y+t.height/2-e.height/2),this.addChild(e),this.addTouchTap(this.closeHandle,this)
},e.prototype.closeHandle=function(){var t=this._callbackF,e=this._obj;this.hide(),t&&e&&t.apply(e)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_ATKRACECROSS_FIGHTEND,this.hide,this);for(var e in this._backCardArray)egret.Tween.removeTweens(this._backCardArray[e]);this._backCardArray.length=0,this._clickIdx=0;for(var i in this._awardIconArray)egret.Tween.removeTweens(this._awardIconArray[i]);this._awardIconArray.length=0,this._clip=null,this._callbackF=null,this._obj=null,this._rewardsStr=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AtkracecrossRewardPopupView.prototype,"AtkracecrossRewardPopupView");var AtkracecrossSummaryView=function(t){function e(){var e=t.call(this)||this;return e._countDownTime=0,e._countDownText=null,e._enterBtn=null,e._cdTimeDesc=null,e._cdType=1,e._openDesc=null,e._isCanJoin=null,e}return __extends(e,t),e.prototype.refreshInfo=function(){this.request(NetRequestConst.REQUEST_ATKRACECROSS_GETACTIVITYATK,{})},e.prototype.receiveData=function(t){var e=Api.acVoApi.getActivityVoByAidAndCode("crossServerAtkRace");e.info&&1==e.info.iscanjoin?this._openDesc.text=LanguageManager.getlocal("atkraceCrossOpenDesc2"):this._openDesc.text=LanguageManager.getlocal("atkraceCrossOpenDesc3")},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["atkracecross_bg","atkracecross_title","btn_enter_race","atkracecross_timebg"])},e.prototype.getBgName=function(){return"atkracecross_bg"},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getCloseBtnName=function(){return ButtonConst.POPUP_CLOSE_BTN_1},e.prototype.initBg=function(){var t=this.getBgName();if(t){var e=egret.Rectangle.create();e.setTo(0,0,640,1136),this.viewBg=BaseLoadBitmap.create(t,e),this.viewBg.setPosition(0,.1*(GameConfig.stageHeigth-this.viewBg.height)),this.addChild(this.viewBg)}},e.prototype.initView=function(){var t=BaseBitmap.create("atkracecross_title");t.setPosition(GameConfig.stageWidth/2-t.width/2,10),this.addChildToContainer(t),this._enterBtn=ComponentManager.getButton("btn_enter_race",null,this.enterRackHandler,this,null,0),this._enterBtn.setPosition(GameConfig.stageWidth/2-this._enterBtn.width/2,420),this.addChildToContainer(this._enterBtn);var e=BaseBitmap.create("public_9_wordbg");e.height=168,e.setPosition(GameConfig.stageWidth/2-e.width/2,GameConfig.stageHeigth-e.height),this.addChildToContainer(e);var i=Api.acVoApi.getActivityVoByAidAndCode("crossServerAtkRace"),a=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossTime",[i.acTimeAndHour]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);a.x=24,a.y=e.y+30,this.addChildToContainer(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossQualification"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);n.x=a.x,n.y=a.y+35,n.width=GameConfig.stageWidth-2*n.x,n.lineSpacing=6,this.addChildToContainer(n);var o=7200,s=86400;i.st>GameData.serverTime-o?(this._enterBtn.visible=!1,this._cdType=1,this._countDownTime=o-GameData.serverTime+i.st):i.et>GameData.serverTime+s?(this._cdType=2,this._countDownTime=i.et-GameData.serverTime-s):(this._cdType=3,this._countDownTime=i.et-GameData.serverTime);var r=BaseBitmap.create("atkracecross_timebg");r.height=128,r.setPosition(GameConfig.stageWidth/2-r.width/2,152),this.addChildToContainer(r),this._cdTimeDesc=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossCDTime"+this._cdType),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._cdTimeDesc.y=r.y+10,this.addChildToContainer(this._cdTimeDesc),this._countDownText=ComponentManager.getTextField(this.getCountTimeStr(),TextFieldConst.FONTSIZE_CONTENT_COMMON,15008772),this._cdTimeDesc.x=GameConfig.stageWidth/2-this._cdTimeDesc.width/2-this._countDownText.width/2,this._countDownText.setPosition(this._cdTimeDesc.x+this._cdTimeDesc.width,this._cdTimeDesc.y),this.addChildToContainer(this._countDownText),3==this._cdType&&(this._countDownText.visible=!1,this._cdTimeDesc.textColor=TextFieldConst.COLOR_WARN_RED,this._cdTimeDesc.x=GameConfig.stageWidth/2-this._cdTimeDesc.width/2),this._openDesc=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_GREEN),this._openDesc.width=360,this._openDesc.setPosition(GameConfig.stageWidth/2-this._openDesc.width/2,this._countDownText.y+50),this._openDesc.lineSpacing=6,this._openDesc.textAlign=egret.HorizontalAlign.CENTER,this.addChildToContainer(this._openDesc),i.st>GameData.serverTime-300?(this._openDesc.text=LanguageManager.getlocal("atkraceCrossOpenDesc1"),TimerManager.doTimer(i.st-GameData.serverTime+300,1,this.refreshInfo,this)):this.refreshInfo()},e.prototype.enterRackHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.ATKRACECROSSVIEW)},e.prototype.tick=function(){this._countDownText&&(this._countDownTime--,this._countDownText.text=this.getCountTimeStr(),this._countDownTime<0&&this.refreshEnterBtn())},e.prototype.refreshEnterBtn=function(){this._cdType+=1;var t=Api.acVoApi.getActivityVoByAidAndCode("crossServerAtkRace"),e=86400;if(2==this._cdType)this._enterBtn.visible=!0,this._countDownTime=t.et-GameData.serverTime-e;else if(3==this._cdType)this._countDownTime=t.et-GameData.serverTime,this._countDownText.visible=!1,this._cdTimeDesc.textColor=TextFieldConst.COLOR_WARN_RED,App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_ATKRACECROSS_FIGHTEND);else if(4==this._cdType)return ViewController.getInstance().hideAllView(),void App.CommonUtil.showTip(LanguageManager.getlocal("atkracecrossEndTip"));this._cdTimeDesc.text=LanguageManager.getlocal("atkracecrossCDTime"+this._cdType),this._countDownText.text=this.getCountTimeStr(),3==this._cdType&&(this._cdTimeDesc.x=GameConfig.stageWidth/2-this._cdTimeDesc.width/2)},e.prototype.getCountTimeStr=function(){var t=this._countDownTime;return 0>t&&(t=0),App.DateUtil.getFormatBySecond(t)},e.prototype.dispose=function(){TimerManager.remove(this.refreshInfo,this),this._countDownTime=0,this._countDownText=null,this._enterBtn=null,this._cdTimeDesc=null,this._openDesc=null,this._isCanJoin=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(AtkracecrossSummaryView.prototype,"AtkracecrossSummaryView");var AtkracecrossView=function(t){function e(){var e=t.call(this)||this;return e._moreArrow=null,e.bottom=null,e._isShowMore=!1,e.touchBoo=!0,e.moveContainer=null,e.listconditions=null,e.describeTxt=null,e._nameTxt=null,e._currMaskBmp=null,e._touchBg=null,e.moreBg=null,e.isData=!1,e._scrollList=null,e._atkraceInfoVoList=[],e._topBg=null,e._scoreTextTab=[],e._listconditions=null,e._rewwardTime=null,e._rewardCDTime=0,e._countDownTime=0,e._infoContainer=null,e._countDownText=null,e._fightflag=null,e._topType=0,e._serverList=null,e._isCanJoin=!1,e._isFightEnd=!1,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["atkracecross_bg2","atkracecross_award_text","atkracecross_award","atkracecross_loss","atkracecross_top","atkracecross_win","atkrace_morale","rankinglist_rankbg","arena_bottom","servant_mask","arena_visit","arena_visit_text","forpeople_bottom","arena_rank","arena_rank_text","arena_more","arena_arrow","arena_bottom_bg","atkrace_morale","atkracecross_rankbg","atkracecross_rank","atkracecross_explain","arena_bottom","servant_mask","arena_visit","arena_visit_text","forpeople_bottom","arena_rank","arena_rank_text","arena_more","arena_arrow"])},e.prototype.getBgName=function(){return"atkracecross_bg2"},e.prototype.getTitleStr=function(){return"atkracecross"},e.prototype.initBg=function(){var t=this.getBgName();if(t){var e=egret.Rectangle.create();e.setTo(0,0,640,1136),this.viewBg=BaseLoadBitmap.create(t,e),this.viewBg.setPosition(0,.1*(GameConfig.stageHeigth-this.viewBg.height)),this.addChild(this.viewBg)}},e.prototype.getRequestData=function(){var t=Api.acVoApi.getActivityVoByAidAndCode("crossServerAtkRace"),e=86400;return t.et-GameData.serverTime<=e&&(this._isFightEnd=!0),{requestType:NetRequestConst.REQUEST_ATKRACECROSS_INDEX,requestData:{activeId:t.aidAndCode}}},e.prototype.receiveData=function(t){if(0==t.data.data.fightflag?this._fightflag=!1:this._fightflag=!0,Api.atkracecrossVoApi.zonerankinfos=t.data.data.zonerankinfos,2==this._topType&&this._serverList&&Api.atkracecrossVoApi.zonerankinfos)this._serverList.refreshData(Api.atkracecrossVoApi.zonerankinfos);else if(1==this._topType&&this._scoreTextTab.length>0&&Api.atkracecrossVoApi.zonerankinfos)for(var e=0;e<this._scoreTextTab.length;e++){var i=Api.atkracecrossVoApi.zonerankinfos,a=void 0,n=void 0;String(i[0].zid)==ServerCfg.selectServer.zid?(a=i[0],n=i[1]):(a=i[1],n=i[0]),this._scoreTextTab[0].text=String(a.point),this._scoreTextTab[1].text=String(n.point)}0==t.data.data.iscanjoin?this._isCanJoin=!1:this._isCanJoin=!0,Api.atkracecrossVoApi.isCanJoin=this._isCanJoin,this._infoContainer&&this.resetInfo()},e.prototype.initView=function(){if(App.MessageHelper.addEventListener(MessageConst.MESSAGE_RESET_ATKRACECROSS,this.battleCallback,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_ATKRACECROSS_FIGHTEND,this.fightendCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_CHALLENGE),this.challengeCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_REVENGE),this.challengeCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_KILL),this.challengeCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_REFRESH),this.refreshServant,this),this.initBottom(),Api.atkracecrossVoApi.zonerankinfos.length>2?this.initTop2():this.initTop1(),this._fightflag&&this._isCanJoin&&0==this._isFightEnd){var t=Api.atkracecrossVoApi.getRewardc();t&&t.flag&&t.flag>0&&ViewController.getInstance().openView(ViewConst.POPUP.ATKRACECROSSREWARDPOPUPVIEW,{})}NetManager.request(NetRequestConst.REQUEST_ATKRACECROSS_LIST,{}),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_LIST),this.useCallback,this),this._isCanJoin||this._isFightEnd?this.resetInfo():this.initCannotJoin();var e=ComponentManager.getButton("atkracecross_explain","",this.clickDetailBtnHandler,this);e.x=12,e.y=22,this.addChild(e)},e.prototype.resetInfo=function(){if(this._countDownTime=0,this._infoContainer&&(this.removeChildFromContainer(this._infoContainer),this._infoContainer=null),this._countDownText&&(this._countDownText=null),this._infoContainer=new BaseDisplayObjectContainer,this._infoContainer.y=GameConfig.stageHeigth-1136,this.addChildToContainer(this._infoContainer),0==this._fightflag){var t=BaseBitmap.create("public_9_bg25");t.width=260,t.height=78,t.setPosition(GameConfig.stageWidth/2-t.width/2,1386-GameConfig.stageHeigth),this._infoContainer.addChild(t);var e=BaseBitmap.create("public_9_bg25_tail");e.x=t.x+t.width/2+20,e.y=t.y+t.height-3,this._infoContainer.addChild(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("atkraceNoServant"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);i.width=224,i.lineSpacing=6,i.setPosition(t.x+t.width/2-i.width/2,t.y+t.height/2-i.height/2),this._infoContainer.addChild(i)}else if(0==this._isFightEnd){var a=Api.atkracecrossVoApi.getMyFightInfo();if(a&&a.mesid&&a.mesid.sid){var n=a.mesid.sid,o=BaseLoadBitmap.create(Api.servantVoApi.getFullImgPathWithId(n));o.width=405,o.height=467,o.x=GameConfig.stageWidth/2-o.width/2,o.y=this.viewBg.height-180-o.height,this._infoContainer.addChild(o),o.addTouchTap(this.clickServant,this);var t=BaseBitmap.create("public_9_bg25");t.width=260,t.height=78,t.setPosition(GameConfig.stageWidth/2-t.width/2,o.y-80),this._infoContainer.addChild(t);var e=BaseBitmap.create("public_9_bg25_tail");e.x=t.x+t.width/2+20,e.y=t.y+t.height-3,this._infoContainer.addChild(e);var s=void 0;s=1==a.handle||1!=a.atype?LanguageManager.getlocal("arenaServantSpeak2"):LanguageManager.getlocal("arenaServantSpeak1",[LanguageManager.getlocal("servant_name"+a.mesid.sid)]);var i=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);i.width=224,i.lineSpacing=6,i.setPosition(t.x+t.width/2-i.width/2,t.y+t.height/2-i.height/2),this._infoContainer.addChild(i)}else{var r=Config.AcCfg.getCfgByActivityIdAndCode("crossServerAtkRace",1),l=r.getDailyNum(),h=Api.atkracecrossVoApi.getMyInfo(),t=BaseBitmap.create("public_9_bg25");t.width=260,t.height=78,t.setPosition(GameConfig.stageWidth/2-t.width/2,1386-GameConfig.stageHeigth),this._infoContainer.addChild(t);var e=BaseBitmap.create("public_9_bg25_tail");e.x=t.x+t.width/2+20,e.y=t.y+t.height-3,this._infoContainer.addChild(e);var d=h.num,s=void 0;if(d>=l){var g=Api.servantVoApi.getServantCountLevel60Plus(),c=Config.AcCfg.getCfgByActivityIdAndCode("crossServerAtkRace",1).getParameter1(),p=Math.floor(g/c);h.extranum>=p?(s=LanguageManager.getlocal("arenaMaxNum"),t.addTouchTap(this.clickDialog2,this)):(s=LanguageManager.getlocal("arenaAddNum",[h.extranum.toString(),p.toString()]),t.addTouchTap(this.clickDialog,this));var i=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);i.width=224,i.lineSpacing=6,i.setPosition(t.x+t.width/2-i.width/2,t.y+t.height/2-i.height/2),this._infoContainer.addChild(i)}else{this._countDownTime=h.lasttime+Config.AcCfg.getCfgByActivityIdAndCode("crossServerAtkRace",1).getIntervalTime()-GameData.serverTime;var i=ComponentManager.getTextField(LanguageManager.getlocal("atkraceCountDowning"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);i.width=224,i.lineSpacing=6,i.setPosition(t.x+t.width/2-i.width/2,t.y+t.height/2-i.height/2-15),this._infoContainer.addChild(i),this._countDownText=ComponentManager.getTextField(this.getCountTimeStr(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_RED),this._countDownText.setPosition(t.x+t.width/2-this._countDownText.width/2,i.y+i.height+7),this._infoContainer.addChild(this._countDownText)}}}else this.initResult()},e.prototype.clickDialog2=function(){App.CommonUtil.showTip(LanguageManager.getlocal("atkrace_extro_no_times"))},e.prototype.clickDialog=function(){var t=Config.AcCfg.getCfgByActivityIdAndCode("crossServerAtkRace",1).getFightAdd(),e=1,i=Api.itemVoApi.getItemInfoVoById(Number(t)),a=0;i&&(a=i.num);var n=LanguageManager.getlocal("atkRace_buyChallenge",[LanguageManager.getlocal("itemName_"+t)]),o={confirmCallback:this.buyChallenge,handler:this,icon:"itemicon"+t,iconBg:Config.ItemCfg.getItemCfgById(t).iconBg,num:a,useNum:e,msg:n,id:t};ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,o)},e.prototype.buyChallenge=function(){var t=Api.acVoApi.getActivityVoByAidAndCode("crossServerAtkRace");this.request(NetRequestConst.REQUEST_ATKRACECROSS_USEEXTRA,{activeId:t.aidAndCode})},e.prototype.clickServant=function(){var t=Api.atkracecrossVoApi.getMyFightInfo();if(1==t.handle||1!=t.atype)ViewController.getInstance().openView(ViewConst.COMMON.ATKRACECROSSARRESTVIEW,{f:this.refreshServant,o:this});else{var e=t.getFName();ViewController.getInstance().openView(ViewConst.POPUP.ATKRACECROSSAGREEPOPUPDIALOG,{type:1,name:e,sid:t.mesid.sid,f:this.refreshServant,o:this})}},e.prototype.initTop1=function(){this._topType=1,this._topBg=BaseBitmap.create("atkracecross_top"),this._topBg.y=-16,this.addChildToContainer(this._topBg);var t,e,i=Api.atkracecrossVoApi.zonerankinfos;String(i[0].zid)==ServerCfg.selectServer.zid?(t=i[0],e=i[1]):(t=i[1],e=i[0]);var a=ComponentManager.getTextField(t.zid+LanguageManager.getlocal("serverListServer"),TextFieldConst.FONTSIZE_CONTENT_COMMON);a.setPosition(56-a.width/2,this._topBg.y+46),this.addChildToContainer(a);var n=ComponentManager.getTextField(e.zid+LanguageManager.getlocal("serverListServer"),TextFieldConst.FONTSIZE_CONTENT_COMMON);n.setPosition(GameConfig.stageWidth-56-n.width/2,a.y),this.addChildToContainer(n),this._scoreTextTab.length=0;var o=ComponentManager.getBitmapText(String(t.point),TextFieldConst.FONTNAME_ITEMTIP);o.setPosition(114,this._topBg.y+67),this.addChildToContainer(o),this._scoreTextTab.push(o);var s=ComponentManager.getBitmapText(String(e.point),TextFieldConst.FONTNAME_ITEMTIP);s.setPosition(GameConfig.stageWidth-110-s.width,o.y),this.addChildToContainer(s),this._scoreTextTab.push(s)},e.prototype.initTop2=function(){this._topType=2,this._topBg=BaseBitmap.create("atkracecross_rankbg"),this._topBg.y=-16,this._topBg.height=224,this.addChildToContainer(this._topBg);var t=BaseBitmap.create("atkracecross_rank");t.setPosition(GameConfig.stageWidth/2-t.width/2,this._topBg.y+8),this.addChildToContainer(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("rankorder"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);e.setPosition(GameConfig.stageWidth/2-155-e.width/2,this._topBg.y+50),this.addChildToContainer(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("atkraceServerDesc"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);i.setPosition(GameConfig.stageWidth/2-i.width/2,e.y),this.addChildToContainer(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("pointNumber"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);a.setPosition(GameConfig.stageWidth/2+155-a.width/2,e.y),this.addChildToContainer(a);var n=Api.atkracecrossVoApi.zonerankinfos,o=egret.Rectangle.create();o.setTo(0,0,640,144),this._serverList=ComponentManager.getScrollList(AtkracecrossServerItem,n,o),this.addChildToContainer(this._serverList),this._serverList.y=this._topBg.y+80},e.prototype.initCannotJoin=function(){var t=BaseBitmap.create("public_9_downbg");t.width=410,t.height=125,t.setPosition(GameConfig.stageWidth/2-t.width/2,GameConfig.stageHeigth/2-220),this.addChildToContainer(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossNotJoin"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);e.width=t.width,e.setPosition(GameConfig.stageWidth/2-e.width/2,t.y+40),e.lineSpacing=6,e.textAlign="center",this.addChildToContainer(e)},e.prototype.initResult=function(){if(1==this._topType){var t=void 0,e=void 0,i=Api.atkracecrossVoApi.zonerankinfos;String(i[0].zid)==ServerCfg.selectServer.zid?(t="atkracecross_win",e="atkracecross_loss"):(e="atkracecross_win",t="atkracecross_loss");var a=BaseBitmap.create(t);a.setPosition(185,this._topBg.y+15),this.addChildToContainer(a);var n=BaseBitmap.create(e);n.setPosition(424,a.y),this.addChildToContainer(n)}var o=BaseBitmap.create("public_9_downbg");o.width=410,o.height=218,o.setPosition(GameConfig.stageWidth/2-o.width/2,GameConfig.stageHeigth/2-220),this.addChildToContainer(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossRewardDesc",[String(Api.atkracecrossVoApi.zonerankinfos[0].zid)]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);s.width=o.width,s.setPosition(GameConfig.stageWidth/2-s.width/2,o.y+40),s.lineSpacing=6,s.textAlign="center",this.addChildToContainer(s);var r=Api.acVoApi.getActivityVoByAidAndCode("crossServerAtkRace");this._rewardCDTime=r.et-GameData.serverTime,this._rewwardTime=ComponentManager.getTextField(LanguageManager.getlocal("atkracecrossRewardTime",[this.getCountTimeStr2()]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_RED),this._rewwardTime.setPosition(GameConfig.stageWidth/2-this._rewwardTime.width/2,s.y+s.height+30),this.addChildToContainer(this._rewwardTime)},e.prototype.getCountTimeStr=function(){var t=this._countDownTime;return 0>t&&(t=0),App.DateUtil.getFormatBySecond(t)},e.prototype.getCountTimeStr2=function(){var t=this._rewardCDTime;return 0>t&&(t=0),App.DateUtil.getFormatBySecond(t)},e.prototype.tick=function(){this._rewwardTime&&(this._rewardCDTime--,this._rewwardTime.text=LanguageManager.getlocal("atkracecrossRewardTime",[this.getCountTimeStr2()]),this._rewardCDTime<0&&this.refreshEnterBtn()),this._countDownText&&(this._countDownTime--,this._countDownText.text=this.getCountTimeStr(),this._countDownTime<0&&this.refreshServant())},e.prototype.refreshEnterBtn=function(){},e.prototype.initBottom=function(){var t=BaseBitmap.create("arena_bottom"),e=BaseBitmap.create("servant_mask");e.width=GameConfig.stageWidth,e.y=GameConfig.stageHeigth-t.height-e.height,this.addChildAt(e,this.getChildIndex(this.container)-1);var i=ComponentManager.getButton("forpeople_bottom",null,this.visitHandle,this,null,0);i.setPosition(24,GameConfig.stageHeigth-200),this.addChild(i);var a=BaseBitmap.create("arena_visit");a.setPosition(i.width/2-a.width/2,i.height/2-a.height/2-5),i.addChild(a);var n=BaseBitmap.create("arena_visit_text");n.setPosition(i.width/2-n.width/2,a.y+a.height-30),i.addChild(n);var o=ComponentManager.getButton("forpeople_bottom",null,this.rewardHandle,this,null,0);o.setPosition(24,i.y-115),this.addChild(o);var s=BaseBitmap.create("atkracecross_award");s.setPosition(o.width/2-s.width/2,o.height/2-s.height/2-5),o.addChild(s);var r=BaseBitmap.create("atkracecross_award_text");if(r.setPosition(o.width/2-r.width/2,s.y+s.height-30),o.addChild(r),!Api.switchVoApi.checkOpenShenhe()){var l=ComponentManager.getButton("forpeople_bottom",null,this.rankHandle,this,null,0);l.setPosition(GameConfig.stageWidth-l.width-24,i.y),this.addChild(l);var h=BaseBitmap.create("arena_rank");h.setPosition(l.width/2-h.width/2,l.height/2-h.height/2-5),l.addChild(h);var d=BaseBitmap.create("arena_rank_text");d.setPosition(l.width/2-n.width/2,h.y+h.height-30),l.addChild(d)}t.y=GameConfig.stageHeigth-t.height,this.addChild(t),this.bottom=t;var g=ComponentManager.getButton("arena_more",null,this.showMoreHandle,this);g.setPosition(GameConfig.stageWidth-g.width-18,GameConfig.stageHeigth-t.height/2-g.height/2),this.addChild(g),this._moreArrow=BaseBitmap.create("arena_arrow"),this._moreArrow.setPosition(g.x-this._moreArrow.width-5,GameConfig.stageHeigth-t.height/2-this._moreArrow.height/2),this.addChild(this._moreArrow)},e.prototype.useCallback=function(t){t.data.ret?(t.data.data.data.atklist&&(this._atkraceInfoVoList=t.data.data.data.atklist,this.showText()),this.listconditions&&(this.listconditions.visible=!1),this._atkraceInfoVoList.length>0?this.isData=!0:this.isData=!1):this.isData=!1},e.prototype.showText=function(){if(this._nameTxt&&(this.removeChild(this._nameTxt),this._nameTxt=null),this._atkraceInfoVoList.length>0&&this._atkraceInfoVoList[0].info){var t=this._atkraceInfoVoList[0],e="";e=this.isData&&1==t.info.type?LanguageManager.getlocal("atkracebeat"):LanguageManager.getlocal("atkraceAnnihilation");var i=null;i=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);var a=Config.ServantCfg.getServantItemById(t.info.sid).name;t.info.iskill&&1==t.info.iskill?1==t.info.type?i.text=LanguageManager.getlocal("atkraceCrossIskilldes1",[a,e,t.info.uname2,t.info.fightnum,t.info.streak]):i.text=LanguageManager.getlocal("atkraceCrossIskilldes2",[a,e,t.info.uname2,t.info.fightnum,t.info.streak]):t.info.streak&&t.info.streak>=3?i.text=LanguageManager.getlocal("actrackStraight",[a,e,t.info.uname2,t.info.fightnum,t.info.streak]):i.text=LanguageManager.getlocal("actrackDescription",[a,e,t.info.uname2,t.info.fightnum]),i.width=450,i.x=20,i.y=GameConfig.stageHeigth-40,this.describeTxt=i,this.addChild(i);var n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE),o=LanguageManager.getlocal("atkraceCrossServeDes",[t.info.zid+""]);n.text=o+this._atkraceInfoVoList[0].info.name,n.x=20,n.y=GameConfig.stageHeigth-67,this.addChild(n),this._nameTxt=n}},e.prototype.rankHandle=function(){ViewController.getInstance().openView(ViewConst.COMMON.ATKRACECROSSRANKLISTVIEW)},e.prototype.visitHandle=function(){ViewController.getInstance().openView(ViewConst.COMMON.ATKRACECROSSVISITVIEW)},e.prototype.rewardHandle=function(){ViewController.getInstance().openView(ViewConst.COMMON.ATKRACECROSSACTIVITYREWARDVIEW)},e.prototype.showMoreHandle=function(){this.touchBoo&&(this._isShowMore=!this._isShowMore,1==this._isShowMore?(this._moreArrow.scaleY=-1,this._moreArrow.y+=this._moreArrow.height,this.showList()):(this._moreArrow.scaleY=1,this._moreArrow.y-=this._moreArrow.height,this.closeList()))},e.prototype.showList=function(){if(this.moveContainer=new BaseDisplayObjectContainer,this.addChild(this.moveContainer),this.moreBg=BaseBitmap.create("arena_bottom_bg"),this.moreBg.width=640,this.moreBg.height=GameConfig.stageHeigth-330,this.moveContainer.addChild(this.moreBg),this._currMaskBmp=BaseBitmap.create("public_9_viewmask"),this._currMaskBmp.width=GameConfig.stageWidth,this._currMaskBmp.height=GameConfig.stageHeigth,this._currMaskBmp.touchEnabled=!0,this.addChild(this._currMaskBmp),this.setChildIndex(this._currMaskBmp,this.getChildIndex(this.bottom)),this._touchBg=BaseBitmap.create("public_9_bg25"),this._touchBg.width=640,this._touchBg.height=260,this._touchBg.x=0,this._touchBg.y=-240,this._touchBg.alpha=0,this._touchBg.addTouchTap(this.showMoreHandle,this),this.moveContainer.addChild(this._touchBg),this.isData){var t=egret.Rectangle.create();t.setTo(0,10,640,GameConfig.stageHeigth-340),this._scrollList=ComponentManager.getScrollList(ActrackCrossMoreItem,this._atkraceInfoVoList,t),this.moveContainer.addChild(this._scrollList),this._scrollList.y=5}else{var e=ComponentManager.getTextField(LanguageManager.getlocal("atkracedes3"),20);e.x=250,e.y=300,this.moveContainer.addChild(e)}this.moveContainer.y=1150,this.touchBoo=!1;var i=Config.AcCfg.getCfgByActivityIdAndCode("crossServerAtkRace",1).getbeatNum(),a=ComponentManager.getTextField(LanguageManager.getlocal("atkracelistconditions",[i+""]),20);a.x=100,a.y=GameConfig.stageHeigth-50,this.addChild(a),this.listconditions=a,this.listconditions&&(this.listconditions.visible=!1),this.describeTxt&&(this.describeTxt.visible=!1,this._nameTxt.visible=!1),egret.Tween.get(this.moveContainer).to({y:250},500).call(function(){egret.Tween.removeTweens(this.moveContainer),this.touchBoo=!0,this.listconditions&&(this.listconditions.visible=!0)},this)},e.prototype.closeList=function(){this.touchBoo=!1,this.listconditions.visible=!1,this.describeTxt&&(this.describeTxt.visible=!0,this._nameTxt.visible=!0),this.moveContainer&&egret.Tween.get(this.moveContainer).to({y:1150},500).call(function(){this.touchBoo=!0,egret.Tween.removeTweens(this.moveContainer)},this),this._currMaskBmp&&this._currMaskBmp.parent&&(this._currMaskBmp.parent.removeChild(this._currMaskBmp),this._currMaskBmp.dispose(),this._currMaskBmp=null),this._touchBg&&this._touchBg.parent&&(this._touchBg.parent.removeChild(this._touchBg),this._touchBg.dispose(),this._touchBg=null)},e.prototype.battleCallback=function(){this.resetInfo(),this.describeTxt&&(this.removeChild(this.describeTxt),this.describeTxt=null),NetManager.request(NetRequestConst.REQUEST_ATKRACECROSS_LIST,{}),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_LIST),this.useCallback,this)},e.prototype.fightendCallback=function(){App.CommonUtil.showTip(LanguageManager.getlocal("atkracecrossFightEndTip")),this._isFightEnd=!0,ViewController.getInstance().hideView(ViewConst.COMMON.ATKRACECROSSARRESTVIEW),ViewController.getInstance().hideView(ViewConst.POPUP.CONFIRMPOPUPVIEW),ViewController.getInstance().hideView(ViewConst.POPUP.ATKRACECROSSAGREEPOPUPDIALOG),ViewController.getInstance().hideView(ViewConst.BASE.BATTLEWIN),ViewController.getInstance().hideView(ViewConst.BASE.PROMPTVIEW);var t=Api.acVoApi.getActivityVoByAidAndCode("crossServerAtkRace");this.request(NetRequestConst.REQUEST_ATKRACECROSS_INDEX,{activeId:t.aidAndCode})},e.prototype.challengeCallback=function(t){t.data.ret&&(AtkraceCrossChallengeItem.data&&1==AtkraceChallengeItem.data.type&&this.touchBoo&&(this.moveContainer.y=1150,this._currMaskBmp.visible=!1),this.refreshServant(),ViewController.getInstance().hideView(ViewConst.POPUP.ATKRACECROSSCHALLENGEVIEW),this.clickServant())},e.prototype.refreshServant=function(){var t=Api.acVoApi.getActivityVoByAidAndCode("crossServerAtkRace");this.request(NetRequestConst.REQUEST_ATKRACECROSS_INDEX,{activeId:t.aidAndCode})},e.prototype.clickDetailBtnHandler=function(t){ViewController.getInstance().openView(ViewConst.POPUP.ATKRACECROSSDETAILPOPUPVIEW)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_RESET_ATKRACECROSS,this.battleCallback,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_ATKRACECROSS_FIGHTEND,this.fightendCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_CHALLENGE),this.challengeCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_REVENGE),this.challengeCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_KILL),this.challengeCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_LIST),this.useCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_REFRESH),this.refreshServant,this),this._moreArrow=null,this.bottom=null,this._isShowMore=!1,this.touchBoo=!0,this.moveContainer=null,this.listconditions=null,this.describeTxt=null,this._nameTxt=null,this._currMaskBmp=null,this._touchBg=null,this.moreBg=null,this.isData=!1,this._scrollList=null,this._atkraceInfoVoList.length=0,this._topBg=null,this._scoreTextTab.length=0,this._rewwardTime=null,this._countDownTime=0,this._infoContainer=null,this._countDownText=null,this._fightflag=null,this._topType=0,this._serverList=null,this._isCanJoin=!1,this._rewardCDTime=0,this._isFightEnd=!1,t.prototype.dispose.call(this)},e}(CommonView);__reflect(AtkracecrossView.prototype,"AtkracecrossView");var AtkraceCrossChallengeItem=function(t){function e(){var e=t.call(this)||this;return e._needNum=0,e._itemNum=0,e._servantId="",e.haveNumber=0,e.servantid="",e.curr_index=0,e}return __extends(e,t),e.prototype.initItem=function(t,i){this.curr_index=t,this._needNum=1,this._servantId=i;var a=Api.servantVoApi.getServantObj(this._servantId),n=BaseBitmap.create("public_9_probiginnerbg");n.width=510,n.height=120,n.x=9,this.addChild(n);var o=.55,s=BaseLoadBitmap.create(a.qualityBoxImgPath);s.width=194,s.height=192,s.setScale(o),s.x=20,s.y=8,s.name="cardbg",this.addChild(s);var r=BaseLoadBitmap.create(a.halfImgPath);r.width=180,r.height=177,r.x=s.x+s.width/2-r.width/2-5,r.y=s.y+s.height/2-r.height/2-2,r.setScale(o),this.addChild(r);var l=ComponentManager.getTextField("",20,TextFieldConst.COLOR_QUALITY_BLUE);l.textColor=ServantScrollItem.getQualityColor(a.clv),l.text=a.servantName,l.x=140,l.y=10,this.addChild(l);var h=ComponentManager.getTextField("atkraceChallengeleve",20);h.text=LanguageManager.getlocal("atkraceChallengeleve",[a.level+""]),h.width=200,h.x=l.x,h.y=l.y+25,this.addChild(h);var d=ComponentManager.getTextField("atkraceChallengequality",20);d.text=LanguageManager.getlocal("atkraceChallengequality",[a.getTotalBookValue()+""]),d.x=h.x,d.y=h.y+25,this.addChild(d);var g=ComponentManager.getTextField("atkraceChallengeinfoAttr",20);g.text=LanguageManager.getlocal("atkraceChallengeinfoAttr",[a.total+""]),g.x=d.x,g.y=d.y+25,this.addChild(g);var c=[];c._servantId=i;var p;if(1==e.data.type?p=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"atkraceChallenge",this.challengBtnHandler,this,c):2==e.data.type?p=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"atkraceRevenge",this.challengBtnHandler,this,c):3==e.data.type&&(p=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"atkraceVisitTab3",this.challengBtnHandler,this,c)),p.setScale(.85),p.x=400,p.y=45,this.addChild(p),p.visible=this.isBattleing(i),0==p.visible){var _=ComponentManager.getTextField("gonetowar2",20,16711680);
_.text=LanguageManager.getlocal("gonetowar2"),_.width=200,_.x=410,_.y=50,this.addChild(_)}},e.prototype.challengBtnHandler=function(t){var i=Api.acVoApi.getActivityVoByAidAndCode("crossServerAtkRace");if(GameData.serverTime>i.et-86400)return void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd"));if(0==Api.atkracecrossVoApi.isCanJoin){var a=LanguageManager.getlocal("atkraceNoDes");return void App.CommonUtil.showTip(a)}var n=Api.atkracecrossVoApi.getMyFightInfo();if(n&&n.mesid&&n.mesid.sid){var a=LanguageManager.getlocal("atkraceHisbattledes");App.CommonUtil.showTip(a)}else if(3==e.data.type){var o=Api.itemVoApi.getItemNumInfoVoById(1553);this.haveNumber=o;var s=LanguageManager.getlocal("atkraceKillbook",["1"]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{confirmCallback:this.confirmCallbackHandler,handler:this,icon:"itemicon1553",iconBg:"itembg_1",num:o,msg:s,id:1553,useNum:1})}else{var o=Api.itemVoApi.getItemNumInfoVoById(1552);this.haveNumber=o;var s=LanguageManager.getlocal("atkraceUseChallengebook",["1"]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{confirmCallback:this.confirmCallbackHandler,handler:this,icon:"itemicon1552",iconBg:"itembg_1",num:o,msg:s,id:1552,useNum:1})}},e.prototype.confirmCallbackHandler=function(){var t=Api.acVoApi.getActivityVoByAidAndCode("crossServerAtkRace"),i=t.aidAndCode;if(GameData.serverTime>t.et-86400)return void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd"));if(1==e.data.type)if(this.haveNumber>=this._needNum){var a=e.data.zid;NetManager.request(NetRequestConst.REQUEST_ATKRACECROSS_CHALLENGE,{fuid:e.data.uid,fzid:a+"",servantid:this._servantId,activeId:""+i})}else App.CommonUtil.showTip(LanguageManager.getlocal("challengedes"));else if(2==e.data.type)this.haveNumber>=this._needNum?(NetManager.request(NetRequestConst.REQUEST_ATKRACECROSS_REVENGE,{fuid:e.data.uid,fzid:e.data.zid+"",servantid:this._servantId,activeId:""+i}),ViewController.getInstance().hideView(ViewConst.COMMON.ATKRACECROSSVISITVIEW)):App.CommonUtil.showTip(LanguageManager.getlocal("challengedes"));else if(3==e.data.type)if(Api.itemVoApi.getItemNumInfoVoById(1553)>=1){var a=e.zid;NetManager.request(NetRequestConst.REQUEST_ATKRACECROSS_KILL,{fuid:e.data.uid,fzid:a+"",servantid:this._servantId,activeId:""+i}),ViewController.getInstance().hideView(ViewConst.COMMON.ATKRACECROSSVISITVIEW)}else App.CommonUtil.showTip(LanguageManager.getlocal("killdes"))},e.prototype.challengeCallback=function(t){},e.prototype.dispose=function(){this._needNum=0,this._itemNum=0,this._servantId="",this.servantid="",this.haveNumber=null,e.data=[],e.zid=null,t.prototype.dispose.call(this)},e.prototype.isBattleing=function(t){var e=Api.atkracecrossVoApi.getMyInfo();if(e){for(var i in e.asids)if(e.asids[i]==t)return!1;return!0}},e.data=[],e.zid=0,e}(ScrollListItem);__reflect(AtkraceCrossChallengeItem.prototype,"AtkraceCrossChallengeItem");var AtkraceCrossChallengeView=function(t){function e(){var e=t.call(this)||this;return e.servantList=[],e._scrollList=null,e.challengebookNum=0,e._data=[],e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([])},e.prototype.getTitleStr=function(){if(AtkraceCrossChallengeItem.data){if(1==AtkraceCrossChallengeItem.data.type)return"atkraceCrossChallenge";if(2==AtkraceCrossChallengeItem.data.type)return"atkraceCrossRevenge";if(3==AtkraceCrossChallengeItem.data.type)return"atkraceCrossVisitTab3"}},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this);var e=BaseBitmap.create("public_9_bg4");e.width=528,e.height=550,e.x=55,e.y=this.titleTF.y+65,this.addChild(e);var i=ComponentManager.getTextField("atkracechallengedes",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);i.text=LanguageManager.getlocal("atkracechallengedes"),i.x=e.x+20,i.y=e.y-24,this.addChild(i),this.challengebookNum=Api.itemVoApi.getItemNumInfoVoById(1552);var a=ComponentManager.getTextField("atkracechallengebook",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);a.text=LanguageManager.getlocal("atkracechallengebook",[this.challengebookNum+""]),a.x=i.x+400,a.y=i.y,this.addChild(a),3==AtkraceCrossChallengeItem.data.type?(this.challengebookNum=Api.itemVoApi.getItemNumInfoVoById(1553),a.text=LanguageManager.getlocal("atkracekill",[this.challengebookNum+""])):(this.challengebookNum=Api.itemVoApi.getItemNumInfoVoById(1552),a.text=LanguageManager.getlocal("atkracechallengebook",[this.challengebookNum+""]));for(var n=Api.servantVoApi.getServantCountLevel60PlusList(),o=[],s=[],r=0;r<n.length;r++){var l=n[r];this.isBattleing(l)?s.push(l):o.push(l)}var h=o.concat(s),d=egret.Rectangle.create();d.setTo(0,0,640,e.height-15),this._scrollList=ComponentManager.getScrollList(AtkraceCrossChallengeItem,h,d),this.addChild(this._scrollList),this._scrollList.setPosition(55,e.y+5)},e.prototype.initView=function(){},e.prototype.isBattleing=function(t){var e=Api.atkracecrossVoApi.getMyInfo();for(var i in e.asids)if(e.asids[i]==t)return!0;return!1},e.prototype.getShowHeight=function(){return 660},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.challengebookNum=0,this.servantList=[],this._data=null},e}(PopupView);__reflect(AtkraceCrossChallengeView.prototype,"AtkraceCrossChallengeView");var ActrackCrossMoreItem=function(t){function e(){var e=t.call(this)||this;return e.uid=0,e.zid=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){this.uid=e.info.uid;var i=BaseBitmap.create("public_9_bg25");i.width=640,i.height=124,i.x=0,i.y=0,i.visible=!1,this.addChild(i);var a=BaseBitmap.create("rankinglist_line");a.y=128,a.x=15,this.addChild(a);var n=BaseBitmap.create("rankinglist_rankbg");n.x=50-n.width/2-20,n.y=26,this.addChild(n);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);o.text=String(t+1),o.x=50-o.width/2-20,o.y=this.height/2-o.height/2-20,this.addChild(o);var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE),r=LanguageManager.getlocal("atkraceCrossServeDes",[e.info.zid+""]);s.text=r+e.info.name,this.zid=e.info.zid,s.x=n.x+50,s.y=o.y,this.addChild(s);var l="";l=1==e.info.type?LanguageManager.getlocal("atkracebeat"):LanguageManager.getlocal("atkraceAnnihilation");var h=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL),d=Config.ServantCfg.getServantItemById(e.info.sid).name;h.text="",e.info.iskill&&1==e.info.iskill?1==e.info.type?h.text=LanguageManager.getlocal("atkraceCrossIskilldes1",[d,e.info.uname2,e.info.fightnum]):h.text=LanguageManager.getlocal("atkraceCrossIskilldes2",[d,e.info.uname2,e.info.fightnum]):e.info.streak&&e.info.streak>=3?h.text=LanguageManager.getlocal("actrackStraight",[d,l,e.info.uname2,e.info.fightnum,e.info.streak]):h.text=LanguageManager.getlocal("actrackDescription",[d,l,e.info.uname2,e.info.fightnum]),h.width=450,h.x=s.x,h.y=s.y+30,this.addChild(h);var g=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);g.text=App.DateUtil.getFormatBySecond(e.info.st,2),g.x=h.x,g.y=h.y+40,this.addChild(g);var c=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"atkraceChallenge",this.challengBtnHandler,this);c.setScale(.85),c.x=530,c.y=70,this.addChild(c);Api.atkracecrossVoApi.zonerankinfos;(Api.playerVoApi.getPlayerID()==e.info.uid||e.info.zid==ServerCfg.selectServer.zid)&&(c.visible=!1)},e.prototype.challengBtnHandler=function(t){var e=Api.acVoApi.getActivityVoByAidAndCode("crossServerAtkRace");if(GameData.serverTime>e.et-86400)return void App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEnd"));if(0==Api.atkracecrossVoApi.isCanJoin){var i=LanguageManager.getlocal("atkraceNoDes");return void App.CommonUtil.showTip(i)}var a=[];a.type=1,a.uid=this.uid,a.zid=this.zid,AtkraceCrossChallengeItem.data=a,ViewController.getInstance().openView(ViewConst.POPUP.ATKRACECROSSCHALLENGEVIEW)},e.prototype.getSpaceY=function(){return 1},e.prototype.getSpaceX=function(){return 0},e.prototype.dispose=function(){this.uid=0,this.zid=0,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ActrackCrossMoreItem.prototype,"ActrackCrossMoreItem");var AtkraceCorssRankItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){if(this.width=502,this.height=52,3>t){var i=BaseBitmap.create("rankinglist_rank"+String(t+1));i.x=62-i.width/2,i.y=this.height/2-i.height/2,this.addChild(i)}else{var i=BaseBitmap.create("rankinglist_rankbg");i.x=62-i.width/2,i.y=this.height/2-i.height/2,this.addChild(i);var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);a.text=String(t+1),a.x=62-a.width/2,a.y=this.height/2-a.height/2,this.addChild(a)}var n=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_CONTENT_COMMON);n.x=220-n.width/2-40,n.y=this.height/2-n.height/2,this.addChild(n);var o=ComponentManager.getTextField(e.zid,TextFieldConst.FONTSIZE_CONTENT_COMMON);o.x=290,o.y=this.height/2-n.height/2,this.addChild(o);var s=ComponentManager.getTextField(e.point,TextFieldConst.FONTSIZE_CONTENT_COMMON);s.x=404-s.width/2+20,s.y=this.height/2-n.height/2,this.addChild(s);var r=BaseBitmap.create("dinner_line");r.x=260-r.width/2,r.y=this.height,this.addChild(r),Api.playerVoApi.getPlayerName()==e.name&&(n.textColor=TextFieldConst.COLOR_WARN_YELLOW,o.textColor=TextFieldConst.COLOR_WARN_YELLOW,s.textColor=TextFieldConst.COLOR_WARN_YELLOW)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AtkraceCorssRankItem.prototype,"AtkraceCorssRankItem");var AtkraceCrossRankListView=function(t){function e(){var e=t.call(this)||this;return e._infoList=null,e._merank=0,e._mepoint=0,e.atkracedes5=null,e.isShowTextBoo=!1,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["rankinglist_line","rankinglist_rankbg","rankinglist_rank1","rankinglist_rank2","rankinglist_rank3"])},e.prototype.initView=function(){var t=["atkraceRank"],e=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,t,null,null);e.x=40,e.y=10,this.addChildToContainer(e);var i=BaseBitmap.create("public_9_probiginnerbg");i.width=520,i.height=526,i.setPosition(this.viewBg.width/2-i.width/2,e.y+e.height),this.addChildToContainer(i);var a=BaseBitmap.create("dinner_rank_titlebg");a.width=i.width,a.height=36,a.setPosition(i.x,i.y),this.addChildToContainer(a),this._scroRect=new egret.Rectangle(a.x,a.y+a.height,a.width,i.height-a.height-8),this._scrollList=ComponentManager.getScrollList(AtkraceCorssRankItem,this._infoList,this._scroRect),this._scrollList.x=a.x,this._scrollList.y=a.y+a.height,this.addChildToContainer(this._scrollList);var n=BaseBitmap.create("public_9_probiginnerbg");n.width=516,n.height=84,n.setPosition(this.viewBg.width/2-n.width/2,i.y+i.height+8),this.addChildToContainer(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("rankorder"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);o.setPosition(65,a.y+a.height/2-o.height/2),this.addChildToContainer(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("ranknickName"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);s.setPosition(160,o.y),this.addChildToContainer(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("rankServer"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);r.setPosition(300,o.y),this.addChildToContainer(r);var l=ComponentManager.getTextField(LanguageManager.getlocal("atkraceScore"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);l.setPosition(407,o.y),this.addChildToContainer(l);var h=ComponentManager.getTextField(LanguageManager.getlocal("ranknickName")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);h.setPosition(o.x,n.y+n.height/2-5-h.height),this.addChildToContainer(h);var d=ComponentManager.getTextField(LanguageManager.getlocal("rankorder")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);d.setPosition(o.x,n.y+n.height/2+5),this.addChildToContainer(d);var g=ComponentManager.getTextField(Api.playerVoApi.getPlayerName(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);g.setPosition(h.x+h.width+12,h.y),this.addChildToContainer(g);var c=ComponentManager.getTextField(LanguageManager.getlocal("atkracedes5"),20);c.x=250,c.y=GameConfig.stageHeigth-530,this.addChild(c),c.visible=this.isShowTextBoo;var p;p=this._merank?this._merank>300?"10000+":this._merank.toString():LanguageManager.getlocal("atkracedes4");var _=ComponentManager.getTextField(p,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_GREEN);_.setPosition(d.x+d.width+12,d.y),this.addChildToContainer(_);var u="";u=this._mepoint?this._mepoint+"":"0";var C=ComponentManager.getTextField(u,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_GREEN);C.setPosition(n.x+n.width-20-C.width,d.y),this.addChildToContainer(C);var f=ComponentManager.getTextField(LanguageManager.getlocal("atkraceScore")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);f.setPosition(C.x-20-f.width,d.y),this.addChildToContainer(f);var m=ComponentManager.getTextField(LanguageManager.getlocal("ranserver"),TextFieldConst.FONTSIZE_CONTENT_COMMON);m.setPosition(f.x,g.y);var T=ServerCfg.selectServer.zid;m.text=LanguageManager.getlocal("ranserver",[T+""]),this.addChildToContainer(m)},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_ATKRACECROSS_RANK,requestData:{}}},e.prototype.receiveData=function(t){1==t.ret&&t.data&&t.data.data.atkrank?(this._infoList=t.data.data.atkrank,this._merank=t.data.data.merank,this._mepoint=t.data.data.mepoint,this.isShowTextBoo=!1):this.isShowTextBoo=!0},e.prototype.dispose=function(){this._scrollList=null,this._infoList=null,this._merank=0,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AtkraceCrossRankListView.prototype,"AtkraceCrossRankListView");var AtkracecrossServerItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=GameConfig.stageWidth,this.height=40;var i=ComponentManager.getTextField(String(t+1),TextFieldConst.FONTSIZE_CONTENT_COMMON);i.setPosition(GameConfig.stageWidth/2-155-i.width/2,this.height/2-i.height/2),this.addChild(i);var a=ComponentManager.getTextField(e.zid+LanguageManager.getlocal("serverListServer"),TextFieldConst.FONTSIZE_CONTENT_COMMON);a.x=GameConfig.stageWidth/2-a.width/2,a.y=i.y,this.addChild(a);var n=ComponentManager.getTextField(String(e.point),TextFieldConst.FONTSIZE_CONTENT_COMMON);n.x=GameConfig.stageWidth/2+155-n.width/2,n.y=i.y,this.addChild(n)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AtkracecrossServerItem.prototype,"AtkracecrossServerItem");var ActrackCrossVisitTab1Item=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){var i=BaseBitmap.create("public_9_bg25");i.width=516,i.height=126,i.x=60,i.visible=!1,this.addChild(i);var a=BaseBitmap.create("public_line1");a.x=60,a.y=120,this.addChild(a);var n=BaseBitmap.create("rankinglist_rankbg");n.x=i.x+20,n.y=10,this.addChild(n);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);o.text=String(t+1),o.x=n.x+(n.width-o.width)/2,o.y=n.y+10,this.addChild(o);var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);s.text=e.name,s.x=n.x+60,s.y=n.y+10,this.addChild(s);var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);r.text=LanguageManager.getlocal("atkraceyamenscore",[e.point]),r.x=s.x+s.width,r.y=n.y+10,this.addChild(r);var l=Config.ServantCfg.getServantItemById(e.sid).name,h=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);h.text=LanguageManager.getlocal("atkracedefensedes",[l,e.num]),h.x=s.x,h.y=s.y+30,h.width=400,this.addChild(h);var d=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL),g="";e.retscore>=0?(g=LanguageManager.getlocal("atkracewardes",[e.retscore]),d.textColor=TextFieldConst.COLOR_WARN_GREEN):(g=LanguageManager.getlocal("atkracewardes2",[e.retscore+""]),d.textColor=16711680),d.text=g,d.x=h.x,d.y=h.y+42,this.addChild(d);var c=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_QUALITY_ORANGE);c.text=App.DateUtil.getFormatBySecond(GameData.serverTime-e.st,4),c.x=485,c.y=s.y,this.addChild(c)},e.prototype.getSpaceY=function(){return 0},e.prototype.getSpaceX=function(){return 0},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ActrackCrossVisitTab1Item.prototype,"ActrackCrossVisitTab1Item");var ActrackCrossVisitTab2Item=function(t){function e(){var e=t.call(this)||this;return e.uid="",e.zid=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){this.uid=e.uid,this.zid=e.zid;var i=BaseBitmap.create("");i.width=516,i.height=126,i.x=60,this.addChild(i);var a=BaseBitmap.create("public_line1");a.x=60,a.y=120,this.addChild(a);var n=BaseBitmap.create("rankinglist_rankbg");n.x=i.x+20,n.y=10,this.addChild(n);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);o.text=String(t+1),o.x=n.x+(n.width-o.width)/2,o.y=n.y+10,this.addChild(o);var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);s.text=e.name,s.x=n.x+60,s.y=n.y+10,this.addChild(s);var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);r.text=LanguageManager.getlocal("atkraceyamenscore",[e.point]),r.x=s.x+s.width,r.y=n.y+10,this.addChild(r);var l=LanguageManager.getlocal("powerDes",[e.power]),h=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);h.text=l,h.x=s.x,h.y=s.y+30,h.width=400,this.addChild(h);var d=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);if(e.point>=0){var g=LanguageManager.getlocal("atkracewardes",[e.point]);d.text=g,d.textColor=TextFieldConst.COLOR_WARN_GREEN}else{var g=LanguageManager.getlocal("atkracewardes2",[e.point]);d.text=g,d.textColor=TextFieldConst.COLOR_QUALITY_RED}d.text=g,d.x=h.x,d.y=h.y+30,this.addChild(d);var c=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_QUALITY_ORANGE);c.text=App.DateUtil.getFormatBySecond(GameData.serverTime-e.st,4),c.x=s.x+300,c.y=s.y,this.addChild(c);var p=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"atkraceRevenge",this.revengeBtnHandler,this);p.setScale(.85),p.x=c.x,p.y=c.y+40,this.addChild(p)},e.prototype.revengeBtnHandler=function(t){var e=[];e.type=2,e.uid=this.uid,e.zid=this.zid,AtkraceCrossChallengeItem.data=e,ViewController.getInstance().openView(ViewConst.POPUP.ATKRACECROSSCHALLENGEVIEW)},e.prototype.getSpaceY=function(){return 10},e.prototype.getSpaceX=function(){return 0},e.prototype.dispose=function(){AtkraceCrossChallengeItem.data=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ActrackCrossVisitTab2Item.prototype,"ActrackCrossVisitTab2Item");var AtkraceCrossVisitView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["rankinglist_rankbg","atkraceVisitbg","atkracevipbg","office_fnt"])},e.prototype.getShowHeight=function(){return 750},e.prototype.initView=function(){},e.prototype.getTabbarTextArr=function(){return["atkraceVisitTab1","atkraceVisitTab2","atkraceVisitTab3"]},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(PopupView);__reflect(AtkraceCrossVisitView.prototype,"AtkraceCrossVisitView");var AtkraceCrossVisitViewTab1=function(t){function e(){var e=t.call(this)||this;return e.defenseList=[],e._scrollList=null,e.noDataTxt=null,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_probiginnerbg");t.width=516,t.height=618,t.x=25,t.y=55,this.addChild(t),AtkraceVisitViewTab1.AtkaceType=0,NetManager.request(NetRequestConst.REQUEST_ATKRACECROSS_GETMODEL,{}),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_GETMODEL),this.useCallback,this)},e.prototype.useCallback=function(t){t.data.ret?t.data.data.data.atkracecross.dinfo&&t.data.data.data.atkracecross.dinfo.length>=1?(this.defenseList=t.data.data.data.atkracecross.dinfo,0==AtkraceVisitViewTab1.AtkaceType&&this.showList()):(null==this.noDataTxt&&(this.noDataTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_WHITE),this.noDataTxt.text=LanguageManager.getlocal("atkracedes1"),this.noDataTxt.x=220,this.noDataTxt.y=300),this.addChild(this.noDataTxt)):-2==t.data.data.ret&&(null==this.noDataTxt&&(this.noDataTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_WHITE),this.noDataTxt.text=LanguageManager.getlocal("atkracedes1"),this.noDataTxt.x=220,this.noDataTxt.y=300),this.addChild(this.noDataTxt))},e.prototype.showList=function(){if(null==this._scrollList){var t=egret.Rectangle.create();t.setTo(0,0,640,610),this._scrollList=ComponentManager.getScrollList(ActrackVisitTab1Item,this.defenseList,t),this.addChild(this._scrollList),this._scrollList.setPosition(-35,60)}},e.prototype.dispose=function(){this.noDataTxt=null,this.defenseList=[],this._scrollList=null,App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_GETMODEL),this.useCallback,this),e.AtkaceType=0,t.prototype.dispose.call(this)},e.AtkaceType=0,e}(PopupViewTab);__reflect(AtkraceCrossVisitViewTab1.prototype,"AtkraceCrossVisitViewTab1");var AtkraceCrossVisitViewTab2=function(t){function e(){var e=t.call(this)||this;return e.einList=[],e._scrollList=null,e._bg=null,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this._bg=BaseBitmap.create("public_9_probiginnerbg"),this._bg.width=516,this._bg.height=618,this._bg.x=25,this._bg.y=55,this.addChild(this._bg),AtkraceVisitViewTab1.AtkaceType=1,NetManager.request(NetRequestConst.REQUEST_ATKRACECROSS_GETMODEL,{}),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_GETMODEL),this.useCallback,this)},e.prototype.useCallback=function(t){t.data.ret?t.data.data.data.atkracecross.einfo&&(this.einList=t.data.data.data.atkracecross.einfo,this.einList.length>0?(AtkraceCrossVisitViewTab1.AtkaceType=1,1==AtkraceCrossVisitViewTab1.AtkaceType&&this.showList()):this.shownoDataTxt()):this.shownoDataTxt()},e.prototype.shownoDataTxt=function(){var t=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_WHITE);t.text=LanguageManager.getlocal("atkracedes2"),t.x=220,t.y=300,this.addChild(t)},e.prototype.showList=function(){var t=egret.Rectangle.create();t.setTo(0,0,640,610),this._scrollList=ComponentManager.getScrollList(ActrackCrossVisitTab2Item,this.einList,t),this.addChild(this._scrollList),this._scrollList.setPosition(-35,60)},e.prototype.dispose=function(){this.einList=[],App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_GETMODEL),this.useCallback,this),t.prototype.dispose.call(this),AtkraceCrossVisitViewTab1.AtkaceType=1},e}(PopupViewTab);__reflect(AtkraceCrossVisitViewTab2.prototype,"AtkraceCrossVisitViewTab2");var AtkraceCrossVisitViewTab3=function(t){function e(){var e=t.call(this)||this;return e.powerText=null,e.menkeText=null,e.yamunText=null,e.nameText=null,e.scoreRankText=null,e.bg=null,e.blackBgRect=null,e.playerContainer=null,e.bgImag2=null,e.officialRankbottom=null,e.bottomNameImag=null,e.killBtn=null,e.numLb=null,e._userIdtxt="",e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.bg=BaseBitmap.create("public_9_probiginnerbg"),this.bg.width=520,this.bg.height=502,this.bg.x=25,this.bg.y=60,this.addChild(this.bg);var t=ComponentManager.getTextField(LanguageManager.getlocal("atkraceKillText"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);t.x=62,t.y=80,this.addChild(t);var e=BaseBitmap.create("public_9_bg5");e.width=346,e.height=44,e.x=t.x,e.y=t.y+35,this.addChild(e);var i=new BaseTextField;i.type=egret.TextFieldType.INPUT,i.width=e.width,i.height=e.height,i.x=e.x,i.y=e.y+10,i.maxChars=11,i.textAlign=TextFieldConst.ALIGH_CENTER,i.restrict="0-9",i.text=LanguageManager.getlocal("inputPlayerId"),i.size=20,this.addChild(i),this.userIdInput=i,this.userIdInput.addEventListener(egret.TextEvent.CHANGE,this.callbackInput,this,!1,2),this.userIdInput.addEventListener(egret.FocusEvent.FOCUS_IN,this.foucusHandler,this),this._userIdtxt=i.text;var a=ComponentManager.getTextField(LanguageManager.getlocal("atkraceotherPartyText"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);a.x=e.x,a.y=e.height+e.y+35,this.addChild(a);var n=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"find",this.queryBtnHandler,this);n.setScale(.85),n.x=e.x+e.width+15,n.y=e.y,this.addChild(n);var o=BaseBitmap.create("atkraceVisitbg");o.x=35,o.y=220,this.addChild(o);var s=new BaseDisplayObjectContainer;this.addChild(s),this.playerContainer=s;var r=BaseBitmap.create("atkracevipbg");r.x=o.x+70,r.y=o.y+50,this.addChild(r),r.visible=!1,this.officialRankbottom=r;var l=BaseBitmap.create("public_9_bg20");l.width=490,l.height=62,l.x=o.x+5,l.y=o.y+o.height-l.height-11,this.addChild(l),this.blackBgRect=l,this.showText();var h=BaseBitmap.create("public_resnumbg");h.x=180,h.y=440,this.addChild(h),h.visible=!1,this.bottomNameImag=h;var d=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);d.x=h.x+60,d.y=h.y+5,this.nameText=d,this.addChild(d);var g=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"atkraceVisitTab3",this.killBtnHandler,this);g.x=o.width/2-g.width/2+20,g.y=o.height+o.y+30,this.addChild(g),g.visible=!1,this.killBtn=g;var c=ComponentManager.getTextField(LanguageManager.getlocal("atkraceTracingdescription"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);c.x=300,c.y=640,this.addChild(c)},e.prototype.callbackInput=function(t){this._userIdtxt=t.target.text,App.LogUtil.log("event.target.text:"+t.target.text)},e.prototype.foucusHandler=function(t){var e=LanguageManager.getlocal("inputPlayerId");this._userIdtxt==e&&(this.userIdInput.text="")},e.prototype.showText=function(){this.powerText=ComponentManager.getTextField("atkracepowerText",TextFieldConst.FONTSIZE_CONTENT_COMMON),this.powerText.text="",this.powerText.x=this.blackBgRect.x+50,this.powerText.y=this.blackBgRect.y+this.blackBgRect.height-50,this.addChild(this.powerText),this.menkeText=ComponentManager.getTextField("atkracemenkeText",TextFieldConst.FONTSIZE_CONTENT_COMMON),this.menkeText.text="",this.menkeText.x=this.powerText.x+240,this.menkeText.y=this.powerText.y,this.addChild(this.menkeText),this.yamunText=ComponentManager.getTextField("atkraceyamunText",TextFieldConst.FONTSIZE_CONTENT_COMMON),this.yamunText.text="",this.yamunText.x=this.powerText.x,this.yamunText.y=this.powerText.y+30,this.addChild(this.yamunText),this.scoreRankText=ComponentManager.getTextField("atkracescoreRankText",TextFieldConst.FONTSIZE_CONTENT_COMMON),this.scoreRankText.text="",this.scoreRankText.x=this.menkeText.x,this.scoreRankText.y=this.menkeText.y+30,this.addChild(this.scoreRankText)},e.prototype.queryBtnHandler=function(t){var e=LanguageManager.getlocal("inputPlayerId");if(this._userIdtxt.length<=0||this._userIdtxt==e){var e=LanguageManager.getlocal("atkraceErrordes2");return App.CommonUtil.showTip(e),void this.refreshView()}if(this._userIdtxt.length<7){var e=LanguageManager.getlocal("atkraceErrordes1");App.CommonUtil.showTip(e),this.refreshView()}else NetManager.request(NetRequestConst.REQUEST_ATKRACECROSS_GETINFO,{fuid:this._userIdtxt}),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_GETINFO),this.useCallback,this)},e.prototype.useCallback=function(t){if(-2==t.data.data.ret){var e=LanguageManager.getlocal("atkraceErrordes3");App.CommonUtil.showTip(e),this.refreshView()}else if(-3==t.data.data.ret){var e=LanguageManager.getlocal("atkraceErrordes4");App.CommonUtil.showTip(e),this.refreshView()}else if(t.data.data.data.atkraceinfo){AtkraceCrossChallengeItem.zid=t.data.data.data.fzid,this.numLb&&(this.removeChild(this.numLb),this.numLb=null),this.playerContainer&&(this.removeChild(this.playerContainer),this.playerContainer=null),this.bgImag2&&(this.removeChild(this.bgImag2),this.bgImag2=null);var i=t.data.data.data.atkraceinfo,e=LanguageManager.getlocal("officialTitle"+i.level),a=ComponentManager.getBitmapText(e+"","office_fnt");a.width=35,a.height=this.officialRankbottom.height,a.x=this.officialRankbottom.x+3,a.y=this.officialRankbottom.y,this.addChild(a),this.numLb=a,this.officialRankbottom.visible=!0,this.bottomNameImag.visible=!0,Api.playerVoApi.getPlayerID()==Number(this._userIdtxt)||0==i.iscankill?this.killBtn.visible=!1:this.killBtn.visible=!0,this.nameText.visible=!0,this.nameText.visible=!0,this.powerText&&(this.powerText.visible=!0),this.menkeText&&(this.menkeText.visible=!0),this.yamunText&&(this.yamunText.visible=!0),this.scoreRankText&&(this.scoreRankText.visible=!0),this.playerContainer=Api.playerVoApi.getPlayerPortrait(i.level,i.pic),this.playerContainer.x=110,this.playerContainer.y=220,this.addChild(this.playerContainer),this.setChildIndex(this.playerContainer,this.getChildIndex(this.blackBgRect)-1),this.bgImag2=BaseBitmap.create("atkraceVisitbg"),this.bgImag2.x=35,this.bgImag2.y=210,this.addChild(this.bgImag2),this.playerContainer.mask=this.bgImag2,this.nameText.text=i.name,this.scoreRankText&&(this.scoreRankText.text=LanguageManager.getlocal("atkracescoreRankText",[""+i.rank])),this.menkeText&&(this.menkeText.text=LanguageManager.getlocal("atkracemenkeText",[i.snum])),this.yamunText&&(this.yamunText.text=LanguageManager.getlocal("atkraceyamunText",[i.point])),this.powerText&&(this.powerText.text=LanguageManager.getlocal("atkracepowerText",[i.power]))}},e.prototype.killBtnHandler=function(t){if(0==Api.atkracecrossVoApi.isCanJoin){var e=LanguageManager.getlocal("atkraceNoDes");return void App.CommonUtil.showTip(e)}if(this._userIdtxt.length<7){var i=LanguageManager.getlocal("atkraceErrordes3");App.CommonUtil.showTip(i)}else{var a=[];a.type=3,a.uid=this._userIdtxt,AtkraceCrossChallengeItem.data=a,ViewController.getInstance().openView(ViewConst.POPUP.ATKRACECROSSCHALLENGEVIEW)}},e.prototype.refreshView=function(){this.officialRankbottom.visible=!1,this.bottomNameImag.visible=!1,this.killBtn.visible=!1,this.nameText&&(this.nameText.visible=!1),this.powerText&&(this.powerText.visible=!1),this.menkeText&&(this.menkeText.visible=!1),this.yamunText&&(this.yamunText.visible=!1),this.scoreRankText&&(this.scoreRankText.visible=!1),this.numLb&&(this.numLb.visible=!1),this.playerContainer&&(this.playerContainer.visible=!1)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_ATKRACECROSS_GETINFO),this.useCallback,this),this.userIdInput.removeEventListener(egret.FocusEvent.FOCUS_IN,this.foucusHandler,this),this.officialRankbottom.visible=!1,this.bottomNameImag.visible=!1,this.powerText=null,this.menkeText=null,this.yamunText=null,this.scoreRankText=null,this.blackBgRect=null,this.bgImag2=null,this.numLb=null,this.playerContainer.mask=null,this.playerContainer=null,this._userIdtxt="",t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(AtkraceCrossVisitViewTab3.prototype,"AtkraceCrossVisitViewTab3");var AttentionPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=520,t.height=180,t.x=this.viewBg.x+this.viewBg.width/2-t.width/2,t.y=9,this.addChildToContainer(t);
var e=ComponentManager.getTextField(LanguageManager.getlocal("attentionDesc"),TextFieldConst.FONTSIZE_CONTENT_COMMON);e.width=480,e.setColor(TextFieldConst.COLOR_BLACK),e.textAlign=TextFieldConst.ALIGH_CENTER,e.x=this.viewBg.x+this.viewBg.width/2-e.width/2,e.y=t.y+20,this.addChildToContainer(e);for(var i=Config.GameprojectCfg.rewardFKYLC1,a=GameData.getRewardItemIcons(i,!0),n=a.length,o=new BaseDisplayObjectContainer,s=0;n>s;s++)a[s].setPosition((a[s].width+10)*s,0),o.addChild(a[s]);o.setPosition(this.viewBg.x+(this.viewBg.width-o.width)/2,e.y+e.height+10),this.addChildToContainer(o);var r="attentionBtn";PlatformManager.checkAttention()&&(r="taskCollect",Api.otherInfoVoApi.getFkFocusInfo()&&(r="candyGetAlready"));var l=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,r,this.attentionHandler,this);l.setColor(TextFieldConst.COLOR_BLACK),l.x=this.getShowWidth()/2-l.width/2,l.y=t.y+t.height+20,this.addChildToContainer(l),PlatformManager.checkAttention()&&Api.otherInfoVoApi.getFkFocusInfo()&&l.setEnable(!1)},e.prototype.attentionHandler=function(){PlatformManager.checkAttention()?this.request(NetRequestConst.REQUEST_OTHERINFO_GETFKFOCUSREWARD,{}):(PlatformManager.attention(),this.hide())},e.prototype.receiveData=function(t){t.ret&&t.data.cmd==NetRequestConst.REQUEST_OTHERINFO_GETFKFOCUSREWARD&&t.data.data.rewards&&(ViewController.getInstance().openView(ViewConst.POPUP.COMMONREWARDPOPUPVIEW,t.data.data.rewards),this.hide())},e}(PopupView);__reflect(AttentionPopupView.prototype,"AttentionPopupView");var BattleDotBar=function(t){function e(){var e=t.call(this)||this;return e._allDots=[],e}return __extends(e,t),e.prototype.init=function(t){this._totalNum=8;var e=BaseBitmap.create("public_bg6");this.addChild(e);var i=460,a=120,n=ComponentManager.getTextField(LanguageManager.getlocal("challengeSectionName"+Api.challengeVoApi.getCurMiddleChannelId()),TextFieldConst.FONTSIZE_CONTENT_COMMON);n.setPosition(30,e.height/2-n.height/2),n.textColor=TextFieldConst.COLOR_BLACK,this.addChild(n);for(var o=0;o<this._totalNum;o++){var s=BaseBitmap.create("battle_dot_none");s.setPosition(a+i/this._totalNum*(.5+o)-s.width/2,e.height/2-s.height/2),this.addChild(s);var r=BaseBitmap.create("battle_dot_full");r.setPosition(a+i/this._totalNum*(.5+o)-r.width/2,e.height/2-r.height/2),this.addChild(r),this._allDots.push(r)}},Object.defineProperty(e.prototype,"curNum",{set:function(t){this._curNum=t;for(var e=0;e<this._totalNum;e++)t>e?0==this._allDots[e].visible&&(this._allDots[e].visible=!0):1==this._allDots[e].visible&&(this._allDots[e].visible=!1)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._totalNum=null,this._curNum=null,this._allDots.length=0,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(BattleDotBar.prototype,"BattleDotBar");var BattleInfo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(t,e,i){this._totalNum=t,e?this._isHero=!0:this._isHero=!1;var a=BaseBitmap.create("battle_info_bg");this.addChild(a);var n,o,s,r,l;if(this._isHero)n=Api.playerVoApi.getAtk(),o="battle_hero_bar",s=Api.playerVoApi.getPlayerName(),r=Api.playerVoApi.getPlayerOffice();else{if(i)l=i.show,n=Math.ceil(this._totalNum/10),r=LanguageManager.getlocal("dailybossNameType1",[String(i.cid)]),s=LanguageManager.getlocal("BossName"+l);else{var h=ChallengeCfg.getChallengeCfgById(Api.challengeVoApi.getCurChannelId());l=h.show,n=h.atk,r=LanguageManager.getlocal("nothing"),s=LanguageManager.getlocal("npcName"+l)}o="battle_npc_bar"}var d,g=0;if(this._isHero)d=Api.playerVoApi.getPlayerCircleHead(Api.playerVoApi.getPlayePicId()),g=98,d.setPosition(0,0),a.scaleX=-1,a.setPosition(d.width/2+a.width,(d.height-a.height)/2-3);else{d=new BaseDisplayObjectContainer;var c=BaseBitmap.create("head_circle_bg");d.addChild(c);var p=egret.Rectangle.create();p.setTo(0,0,120,120),this._npcHead=BaseLoadBitmap.create("prison_icon"+l,p),this._npcHead.scaleX=100/this._npcHead.width,this._npcHead.scaleY=100/this._npcHead.height,this._npcHead.x=-5,this._npcHead.y=1,d.addChild(this._npcHead),g=14,a.setPosition(0,(d.height-a.height)/2-3),d.setPosition(a.width-d.width/2,0)}this.addChild(d);var _=ComponentManager.getTextField(LanguageManager.getlocal("soldier"),TextFieldConst.FONTSIZE_CONTENT_COMMON);_.x=g,_.y=64,this.addChild(_),this._progressBar=ComponentManager.getProgressBar(o,"exp_progress_bg",245),this._progressBar.x=g+_.width+5,this._progressBar.y=_.y,this._progressBar.setTextSize(18),this.addChild(this._progressBar),this._name=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_COMMON),this._name.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,this._name.x=g,this._name.y=11,this.addChild(this._name),this._force=ComponentManager.getTextField(LanguageManager.getlocal("force")+":  "+n,TextFieldConst.FONTSIZE_CONTENT_COMMON),this._force.x=g,this._force.y=37,this.addChild(this._force);var u=ComponentManager.getTextField(r,TextFieldConst.FONTSIZE_CONTENT_COMMON);u.textColor=TextFieldConst.COLOR_WARN_GREEN,u.x=g+310-u.width,u.y=this._name.y,this.addChild(u)},Object.defineProperty(e.prototype,"curNumber",{set:function(t){this._curNum=t,this._progressBar.setText(this._curNum.toString()),this._progressBar.setPercentage(t/this._totalNum)},enumerable:!0,configurable:!0}),e.prototype.resetInfo=function(t){if(this._totalNum=t,this._isHero);else{var e=ChallengeCfg.getChallengeCfgById(Api.challengeVoApi.getCurChannelId()),i=LanguageManager.getlocal("npcName"+e.show);this._name.text=i;var a=e.atk;this._force.text=LanguageManager.getlocal("force")+":  "+a,this._npcHead.setload("prison_icon"+e.show)}},e.prototype.dispose=function(){this._totalNum=null,this._curNum=null,this._progressBar=null,this._force=null,this._name=null,this._npcHead=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(BattleInfo.prototype,"BattleInfo");var BattleRattle=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(t,e,i){void 0===e&&(e=350),void 0===i&&(i=1),this._myParent=t,this._rattleBg=BaseBitmap.create("public_9_bg42"),this.addChild(this._rattleBg),this._rattleBg.width=e,this._rattleBg.height=83;var a=BaseBitmap.create("public_9_bg42_tail");1==i?(a.x=300,a.y=3,a.scaleX=-1,a.scaleY=-1):(a.x=this._rattleBg.x+30,a.y=this._rattleBg.y+this._rattleBg.height-3),this.addChild(a),this._rattleText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON),this._rattleText.width=this._rattleBg.width-30,this._rattleText.textColor=TextFieldConst.COLOR_BLACK,this._rattleText.lineSpacing=6,this.addChild(this._rattleText)},e.prototype.resetString=function(t,e,i){void 0===e&&(e=3e3),void 0===i&&(i=1),null==this.parent&&this._myParent&&this._myParent.addChild(this),t?this._rattleText.text=t:1==i?this._rattleText.text=LanguageManager.getlocal("npcRattle"+App.MathUtil.getRandom(1,34)):2==i&&(this._rattleText.text=LanguageManager.getlocal("bossRattle"+App.MathUtil.getRandom(1,12))),this._rattleText.setPosition(15,this._rattleBg.height/2-this._rattleText.height/2),e>0&&(egret.Tween.removeTweens(this),egret.Tween.get(this).wait(3e3).call(this.hidden,this))},e.prototype.hidden=function(){this.dispose()},e.prototype.dispose=function(){egret.Tween.removeTweens(this),this._rattleText=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(BattleRattle.prototype,"BattleRattle");var TabBar=function(t){function e(){var e=t.call(this)||this;return e._locked=!1,e}return __extends(e,t),e.prototype.eventHandler=function(e){if(0!=t.prototype.isEnable.call(this))switch(e.type){case egret.TouchEvent.TOUCH_BEGIN:this.setBigin(!0),t.prototype.updateButtonImage.call(this,BaseButton.BTN_STATE2);break;case egret.TouchEvent.TOUCH_END:this.isBegin()&&(this.callbackHanler([this]),this.setBigin(!1));break;case egret.TouchEvent.TOUCH_CANCEL:t.prototype.updateButtonImage.call(this,BaseButton.BTN_STATE1),this.setBigin(!1)}},e.prototype.setSelected=function(e){this._selected=e,1==e?t.prototype.updateButtonImage.call(this,BaseButton.BTN_STATE2):t.prototype.updateButtonImage.call(this,BaseButton.BTN_STATE1),this.touchEnabled=!e},e.prototype.isSelected=function(){return this._selected},e.prototype.setLocked=function(t){this._locked!=t&&(this._locked=t,1==t?this.addLockIcon():this.removeLockIcon())},e.prototype.isLocked=function(){return this._locked},e.prototype.addLockIcon=function(){null==this._lockIcon?(this._lockIcon=BaseBitmap.create("lockIcon"),App.LogUtil.log("lockIcon: "+this._lockIcon+"w:"+this.width+"w2:"+this._lockIcon.width+" h:="+this.height+"h2:="+this._lockIcon.height),this._lockIcon.x=this.width-this._lockIcon.width-5,this._lockIcon.y=this.height/2-this._lockIcon.height/2,this.addChild(this._lockIcon)):this._lockIcon.visible=!0},e.prototype.removeLockIcon=function(){this._lockIcon&&this.contains(this._lockIcon)&&(this.removeChild(this._lockIcon),this._lockIcon=null)},e.prototype.dispose=function(){this._lockIcon&&this.contains(this._lockIcon)&&(BaseBitmap.release(this._lockIcon),this.removeChild(this._lockIcon),this._lockIcon=null),this._selected=null,this._locked=null,t.prototype.dispose.call(this)},e}(BaseButton);__reflect(TabBar.prototype,"TabBar");var TabBarGroup=function(t){function e(){var e=t.call(this)||this;return e._space=12,e._selectedIndex=0,e}return __extends(e,t),e.prototype.init=function(t,i,a,n,o){if(this._callback=a,this._handler=n,this._param=o,this._align=e.ALIGN_HORIZONTAL,i.length>0){this._tbArr=new Array;for(var s=0;s<i.length;s++){var r="";r="string"==typeof t?t:t[s];var l=new TabBar;l.init(r,i[s],this.clickButtonHandler,this,null,TextFieldConst.FONTSIZE_TITLE_COMMON),this.addChild(l),this._tbArr.push(l)}this.buildTabTar(),this.updateState(this._selectedIndex)}},Object.defineProperty(e.prototype,"selectedIndex",{set:function(t){this._selectedIndex=t,this.updateState(this._selectedIndex)},enumerable:!0,configurable:!0}),e.prototype.setColor=function(t,e){this._color=t,this._selectedColor=e,this.updateState(this._selectedIndex)},e.prototype.setAligh=function(t){this._align=t,this.buildTabTar()},e.prototype.setSpace=function(t){this._space=t,this.buildTabTar()},e.prototype.addLine=function(t){for(var i=0;i<this._tbArr.length;i++){var a=this._tbArr[i];if(a){var n=BaseBitmap.create(t);this._align==e.ALIGN_HORIZONTAL?(n.x=a.x+a.width+this._space/2-n.width/2,n.y=a.y+a.height/2-n.height/2):(n.x=a.x+a.width/2-n.width/2,n.y=a.y+a.height+this._space/2-n.height/2),this.addChild(n)}}switch(this._align){case e.ALIGN_HORIZONTAL:break;case e.ALIGN_VERTICAL:}},e.prototype.addRedPoint=function(t){for(var e=this._tbArr.length,i=0;e>i;i++)i==t&&App.CommonUtil.addRedDotToBDOC(this._tbArr[i])},e.prototype.removeRedPoint=function(t){for(var e=this._tbArr.length,i=0;e>i;i++)i==t&&App.CommonUtil.removeRedDotFromBDOC(this._tbArr[i])},e.prototype.setLocked=function(t,e){for(var i=0;i<this._tbArr.length;i++)i==t&&this._tbArr[i].setLocked(e)},e.prototype.showStatusIcon=function(t,e){void 0===e&&(e="");for(var i=0;i<this._tbArr.length;i++)i==t&&this._tbArr[i].showStatusIcon(e)},e.prototype.removeStatusIcon=function(t){for(var e=0;e<this._tbArr.length;e++)e==t&&this._tbArr[e].removeStatusIcon()},e.prototype.buildTabTar=function(){var t=0,i=0;switch(this._align){case e.ALIGN_HORIZONTAL:for(var a=0;a<this._tbArr.length;a++){var n=this._tbArr[a];n&&(i=n.height,n.x=(n.width+this._space)*a,n.y=0,t+=0==a?n.width:n.width+this._space)}this.width=t,this.height=i;break;case e.ALIGN_VERTICAL:for(var a=0;a<this._tbArr.length;a++){var n=this._tbArr[a];n&&(t=n.width,n.x=0,n.y=(n.height+this._space)*a,i+=0==a?n.height:n.height+this._space)}this.width=t,this.height=i}},e.prototype.clickButtonHandler=function(t){var e;if(t){e=t;var i=this._tbArr.indexOf(e);if(i==this._selectedIndex)return void App.LogUtil.log("selected");1==e.isLocked()?e.setSelected(!1):(this._selectedIndex=i,this.updateState(i)),this._callback.call(this._handler,{param:this._param,index:i})}},e.prototype.updateState=function(t){for(var e=0;e<this._tbArr.length;e++){var i=this._tbArr[e];i&&(e==t?(i.setSelected(!0),i.setColor(this._selectedColor)):(i.setSelected(!1),i.setColor(this._color)))}},e.prototype.dispose=function(){if(this._tbArr){for(var t=0;t<this._tbArr.length;t++){var e=this._tbArr[t];e.dispose(),e=null}this._tbArr=null}this._param=null,this._callback=null,this._handler=null,this._align=null,this._space=null,this._selectedIndex=null},e.ALIGN_HORIZONTAL="horizontal",e.ALIGN_VERTICAL="vertical",e}(BaseDisplayObjectContainer);__reflect(TabBarGroup.prototype,"TabBarGroup");var FightView=function(t){function e(){var e=t.call(this)||this;return e._dotBar=void 0,e._rattle=void 0,e._countDown=void 0,e._countDownLb=void 0,e._challengeConfig=void 0,e._countDownTime=-1,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["hero_anim_1","npc_anim_1","battlebg",ButtonConst.BATTLE_START_BTN_1,"exp_progress_bg","battle_dot_boss","battle_dot_none","battle_dot_full","battle_hero_bar","battle_info_bg","battle_npc_bar","battle_luanz","promotion_officerbg1","atkrace_skip"])},e.prototype.resetGameAfterWin=function(){this.resetConfig(),this._dotBar.curNum=Api.challengeVoApi.getCurSmallChannelId();for(var t in this._leftSoldiers){var e=this._leftSoldiers[t];e.dispose()}for(var i in this._rightSoldiers){var a=this._rightSoldiers[i];a.dispose()}this._curLost.length=0,this._curLost=[0,0],this._leftSoldiers.length=0,this._rightSoldiers.length=0,this._meetPointTab.length=0,this.calculateSoldierNumber(),this.initRightSoldiers(),this.initLeftSoldiers(),this.calculateMeetPoint(),this.removeChild(this._battleInfoTab[0]),this.addChild(this._battleInfoTab[0]),this._gameBtn.touchEnabled=!0,this._gameBtn.visible=!0;for(var n in this._battleInfoTab){var o=this._battleInfoTab[n];o.resetInfo(this._totalOldNum[n]),this._battleInfoTab[n].curNumber=this._totalNum[n]}this._rattle=new BattleRattle,this._rattle.init(this),this._rattle.setPosition(280,this._battleInfoTab[1].y+110),this._rattle.resetString(),Api.playerVoApi.getSoldier()>0&&1!=Api.rookieVoApi.isInGuiding&&this.resetCountDown()},e.prototype.init=function(){t.prototype.init.call(this);for(var e=0;1>=e;e++)this._battleInfoTab[e]=new BattleInfo,this._battleInfoTab[e].init(this._totalOldNum[e],0==e),0==e?(this._battleInfoTab[e].x=15,this._battleInfoTab[e].y=GameConfig.stageHeigth-35-this._battleInfoTab[e].height):(this._battleInfoTab[e].x=GameConfig.stageWidth-13-this._battleInfoTab[e].width,this._battleInfoTab[e].y=195),this.addChild(this._battleInfoTab[e]),this._battleInfoTab[e].curNumber=this._totalNum[e];this.titleTF.text=Api.challengeVoApi.getCurBigChannelId().toString()+". "+LanguageManager.getlocal("challengeTitle"+Api.challengeVoApi.getCurBigChannelId()),this.titleTF.x=GameConfig.stageWidth/2-this.titleTF.width/2,App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_CHALLENGE_ATTACK),this.intoBattle,this),this._dotBar=new BattleDotBar,this._dotBar.init(8),this.addChildToContainer(this._dotBar),this.container.y=this.getTitleButtomY()-3,this._dotBar.curNum=Api.challengeVoApi.getCurSmallChannelId(),this._rattle=new BattleRattle,this._rattle.init(this),this._rattle.setPosition(280,this._battleInfoTab[1].y+110),this._rattle.resetString(),Api.playerVoApi.getSoldier()>0&&1!=Api.rookieVoApi.isInGuiding&&this.resetCountDown(),Api.rookieVoApi.checkNextStep(),this._skipBtn=ComponentManager.getButton("atkrace_skip",null,this.skipBattle,this),this._skipBtn.setPosition(GameConfig.stageWidth-this._skipBtn.width-12,GameConfig.stageHeigth-115),this.addChild(this._skipBtn),this._skipBtn.visible=!1},e.prototype.resetCountDown=function(){if(!this._countDown){this._countDown=new BaseDisplayObjectContainer;var t=BaseBitmap.create("promotion_officerbg1");this._countDown.addChild(t),this._countDown.setPosition(GameConfig.stageWidth/2-t.width/2+20,this._gameBtn.y+98);var e=ComponentManager.getTextField(LanguageManager.getlocal("countDown"),TextFieldConst.FONTSIZE_CONTENT_SMALL);e.setPosition(t.width/2-e.width/2+15,t.height/2-e.height/2),this._countDown.addChild(e),this._countDownLb=ComponentManager.getTextField("0",TextFieldConst.FONTSIZE_TITLE_BIG),this._countDownLb.setPosition(t.width/2-e.width/2-30,t.height/2-this._countDownLb.height/2),this._countDownLb.setColor(TextFieldConst.COLOR_LIGHT_RED),this._countDown.addChild(this._countDownLb)}this._countDownLb.text="1",this._countDownTime=1,this.addChild(this._countDown)},e.prototype.resetConfig=function(){this._challengeConfig=ChallengeCfg.getChallengeCfgById(Api.challengeVoApi.getCurChannelId()),this._totalOldNum=[Api.playerVoApi.getSoldier(),this._challengeConfig.soldier],this._totalNum=[Api.playerVoApi.getSoldier(),this._challengeConfig.soldier-Api.challengeVoApi.getCurKilledNum()]},e.prototype.btnClick=function(){return Api.playerVoApi.getSoldier()<=0?(ViewController.getInstance().openView(ViewConst.BASE.PROMPTVIEW,{type:3,f:this.hide,o:this}),void App.CommonUtil.showTip(LanguageManager.getlocal("noSoldiersTip"))):(this.closeBtn.setEnable(!1),this._countDownTime=-1,this._countDown&&(this.removeChild(this._countDown),this._countDown=null),Api.rookieVoApi.checkNextStep(),void NetManager.request(NetRequestConst.REQUEST_CHALLENGE_ATTACK,null))},e.prototype.intoBattle=function(t){if(1==t.data.ret){SoundManager.playEffect(SoundConst.EFFECT_BATTLE),SoundManager.playEffect(SoundConst.EFFECT_BATTLE_START),this._isAttackWin=t.data.data.data.battleReport.success,this._rewards=t.data.data.data.rewards;var e=this._totalNum[0]-Api.playerVoApi.getSoldier(),i=this._totalNum[1];if(this._isAttackWin?this._lostNum=[e,i]:this._lostNum=[e,Api.challengeVoApi.getCurKilledNum()-(this._challengeConfig.soldier-i)],this.calculateLostSoldierNumber(),this.calculateLostTab(),this.gameBegin(),this._gameBtn.touchEnabled=!1,this._gameBtn.visible=!1,Api.switchVoApi.checkJumpBattle()){this._skipBtn.visible=!0;var a=Api.shopVoApi.ifBuyMonthCard(),n=Api.shopVoApi.ifBuyYearCard();a||n||App.DisplayUtil.changeToGray(this._skipBtn)}var o=this._lostSoldier[0]+this._lostSoldier[1];this._deathRate=Math.ceil(3e3/(o+1)),this._deathRate>1e3&&(this._deathRate=1e3),this._lastDeathTime=egret.getTimer()+3*this._deathRate}},e.prototype.skipBattle=function(){var t=Api.shopVoApi.ifBuyMonthCard(),e=Api.shopVoApi.ifBuyYearCard();t||e?this.gameEnd(!0):App.CommonUtil.showTip(LanguageManager.getlocal("challengeSkipInfo"))},e.prototype.endCallBack=function(){if(Api.rookieVoApi.isInGuiding)return void this.hide(!0);if(this._isAttackWin){var t=Api.challengeVoApi.getCurSmallChannelId();0==t?this.hide():this.resetGameAfterWin()}else this.hide()},e.prototype.showResultView=function(){this._isAttackWin?ViewController.getInstance().openView(ViewConst.BASE.BATTLEWIN,{award:this._rewards,f:this.endCallBack,o:this,type:1}):ViewController.getInstance().openView(ViewConst.BASE.PROMPTVIEW,{type:1,f:this.endCallBack,o:this})},e.prototype.tick=function(){this._countDownTime>0?(this._countDownTime--,this._countDownLb.text=this._countDownTime.toPrecision()):0==this._countDownTime&&this.btnClick()},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_CHALLENGE_ATTACK),this.intoBattle,this),this._dotBar=null,this._rattle.dispose(),this._rattle=void 0,this._countDown&&this._countDown.dispose(),this._countDown=void 0,this._countDownLb=void 0,this._countDownTime=-1,this._challengeConfig=void 0,t.prototype.dispose.call(this)},e}(BattleView);__reflect(FightView.prototype,"FightView");var PromptView=function(t){function e(){var e=t.call(this)||this;return e._type=null,e._callbackF=null,e._obj=null,e}return __extends(e,t),e.prototype.getResourceList=function(){var e=t.prototype.getResourceList.call(this);return this.param.data&&(this._type=this.param.data.type,(1==this._type||2==this._type||4==this._type)&&e.push("battle_fail_word")),e.concat([])},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getBgName=function(){return"public_9_bg8"},e.prototype.initView=function(){},e.prototype.init=function(){if(t.prototype.init.call(this),this.addTouchTap(this.touchTap,this,null),this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f),1==this._type||2==this._type||4==this._type||5==this._type){var e=BaseBitmap.create("public_rule_bg");e.setPosition(GameConfig.stageWidth/2-e.width,GameConfig.stageHeigth-568-e.height/2),this.addChildToContainer(e);var i=BaseBitmap.create("public_rule_bg");i.scaleX=-1,i.setPosition(GameConfig.stageWidth/2+i.width-1,GameConfig.stageHeigth-568-i.height/2),this.addChildToContainer(i);var a=BaseBitmap.create("public_9_bg1");a.width=500,a.height=140,a.setPosition(GameConfig.stageWidth/2-a.width/2,e.y+e.height/2-a.height/2+20),this.addChildToContainer(a),App.DisplayUtil.changeToGray(e),App.DisplayUtil.changeToGray(i);var n=BaseBitmap.create("battle_fail_word");if(n.setPosition(GameConfig.stageWidth/2-n.width/2,GameConfig.stageHeigth-568-e.height/2-35),this.addChildToContainer(n),4==this._type){var o=ComponentManager.getTextField(LanguageManager.getlocal("atkraceScore"),TextFieldConst.FONTSIZE_CONTENT_COMMON);o.setPosition(e.width-o.width/2-20,e.y+145),o.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,this.addChildToContainer(o);var s=ComponentManager.getTextField("-1",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_RED);s.setPosition(o.x+o.width+10,o.y),this.addChildToContainer(s)}else{var o=ComponentManager.getTextField(LanguageManager.getlocal("battleFail"),TextFieldConst.FONTSIZE_CONTENT_COMMON);5==this._type&&(o.text=LanguageManager.getlocal("battleFail2")),o.setPosition(e.width-o.width/2,e.y+145),o.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,this.addChildToContainer(o)}var r=ComponentManager.getTextField(LanguageManager.getlocal("battleFailTip"),TextFieldConst.FONTSIZE_CONTENT_COMMON);r.setPosition(e.width-r.width/2,e.y+200),r.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,this.addChildToContainer(r),SoundManager.playEffect(SoundConst.EFFECT_BATTLE_FAIL),this.container.anchorOffsetX=GameConfig.stageWidth/2,this.container.anchorOffsetY=GameConfig.stageHeigth/2,this.container.setPosition(GameConfig.stageWidth/2,GameConfig.stageHeigth/2),this.container.scaleX=.1,this.container.scaleY=1,egret.Tween.get(this.container).to({scaleX:1,scaleY:1},120)}if(4!=this._type){var l=BaseBitmap.create("public_tipbg");l.height=264,l.setPosition(GameConfig.stageWidth/2-l.width/2,GameConfig.stageHeigth-l.height-30),this.addChild(l);var h=ComponentManager.getTextField(LanguageManager.getlocal("promptTip"),TextFieldConst.FONTSIZE_TITLE_SMALL);h.setPosition(GameConfig.stageWidth/2-h.width/2,l.y+22),h.textColor=TextFieldConst.COLOR_WARN_YELLOW,this.addChild(h);var d=BaseBitmap.create("public_9_tipbg");d.height=62,d.setPosition(GameConfig.stageWidth/2-d.width/2,l.y+56),this.addChild(d);var g=BaseBitmap.create("public_9_tipbg");g.height=62,g.setPosition(GameConfig.stageWidth/2-g.width/2,d.y+2*d.height),this.addChild(g);for(var c=1;3>=c;c++){var p="promptTip";5==this._type&&(p="tradepromptTip");var _=ComponentManager.getTextField(LanguageManager.getlocal(p+c),TextFieldConst.FONTSIZE_CONTENT_COMMON);_.setPosition(48,d.y+d.height*(c-.5)-_.height/2),this.addChild(_);var u=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskGoBtn",this.sureBtnClick,this,[c]);u.setPosition(463,d.y+d.height*(c-.5)-u.height/2),u.setColor(TextFieldConst.COLOR_BLACK),this.addChild(u)}}},e.prototype.sureBtnClick=function(t){var e=t;ViewController.getInstance().hideAllView(),2==e?ViewController.getInstance().openView(ViewConst.COMMON.SERVANTVIEW):1==e?ViewController.getInstance().openView(ViewConst.COMMON.MANAGEVIEW):3==e&&ViewController.getInstance().openView(ViewConst.COMMON.SHOPVIEW_TAB1)},e.prototype.touchTap=function(){this._obj&&this._callbackF&&this._callbackF.apply(this._obj),this.hide()},e.prototype.dispose=function(){this._type=null,this._callbackF=null,this._obj=null,t.prototype.dispose.call(this)},e}(BaseView);__reflect(PromptView.prototype,"PromptView");var SoldierArea;!function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT"}(SoldierArea||(SoldierArea={}));var SoldierStatus;!function(t){t[t.STANDBY=1]="STANDBY",t[t.RUNING=2]="RUNING",t[t.ATTACKING=3]="ATTACKING",t[t.GODIE=4]="GODIE"}(SoldierStatus||(SoldierStatus={}));var Soldier=function(t){function e(){var e=t.call(this)||this;return e._runFrames=[],e._deathFrames=[],e._standByFrames=[],e._attackFrames=[],e._frameRate=100,e._endFunc=null,e.targetIndex=null,e.attackerTab=[],e._slowDownValue=0,e}return __extends(e,t),e.prototype.init=function(t){this._namePre=t,this._standByFrames=[this._namePre+"_standby"],this._deathFrames=[this._namePre+"_death"],this._myClip=ComponentManager.getCustomMovieClip(),this._myClip.frameRate=this._frameRate,this._myClip.frameImages=this._standByFrames,this.addChild(this._myClip),this._myClip.playWithTime(1);for(var e=App.MathUtil.getRandom(1,6),i=e;6>=i;i++)this._runFrames.push(this._namePre+"_move_"+i);for(var i=1;e>i;i++)this._runFrames.push(this._namePre+"_move_"+i);for(var i=1;3>=i;i++)this._attackFrames.push(this._namePre+"_attack_"+i)},e.prototype.reset=function(){1==this._myClip.isPlaying&&this._myClip.stop(),this._myClip.setEndCallBack(null,null),egret.Tween.removeTweens(this)},e.prototype.run=function(t,e,i){this.reset(),this._myClip.frameImages=this._runFrames,this._myClip.playFrameRate=this._frameRate,this._myClip.playWithTime(0),this._myClip.name="soldier_"+this.area+"_"+this.myIndex,this.myStatus=SoldierStatus.RUNING;var a=App.MathUtil.getDistance(t,egret.Point.create(this.x,this.y)),n=a/this.speed*1e3+200;egret.Tween.get(this).to({x:t.x,y:t.y},n).call(this.attack,this,[e,i])},e.prototype.playAttackEnd=function(){this._endFunc&&this._endObj&&this._endFunc.apply(this._endObj,[this])},e.prototype.attack=function(t,e){this.reset(),this._myClip.frameImages=this._attackFrames,this._myClip.playFrameRate=this._frameRate,this._myClip.goToAndPlay(0),this.curMeetIndex=this.lineNumber,this._endFunc=t,this._endObj=e,this._myClip.playWithTime(1),this._myClip.setEndCallBack(this.playAttackEnd,this),this.myStatus=SoldierStatus.ATTACKING},e.prototype.standBy=function(){this.reset(),this._myClip.frameImages=[this._namePre+"_standby"],this._myClip.playFrameRate=this._frameRate,this._myClip.goToAndPlay(0),this._myClip.playWithTime(1),this.myStatus=SoldierStatus.STANDBY},e.prototype.goDie=function(){this.reset(),this._myClip.frameImages=this._deathFrames,this._myClip.playFrameRate=this._frameRate,this.area==SoldierArea.LEFT?this.x-=20:this.x+=20,this._myClip.goToAndPlay(0),this._myClip.setEndCallBack(this.disappear,this),this._myClip.playWithTime(1),this.myStatus=SoldierStatus.GODIE},e.prototype.disappear=function(){this._slowDownValue=1.5,TimerManager.doTimer(30,15,this.slowDownMove,this),egret.Tween.get(this._myClip).wait(500).to({alpha:0},1e3)},e.prototype.slowDownMove=function(){this._slowDownValue>0&&(this.area==SoldierArea.LEFT?this._myClip.x-=this._slowDownValue:this._myClip.x+=this._slowDownValue),this._slowDownValue-=.1},e.prototype.dispose=function(){this.reset(),egret.Tween.removeTweens(this._myClip),this._myClip.dispose(),this._myClip=null,this._namePre=null,this._runFrames.length=0,this._deathFrames.length=0,this._standByFrames.length=0,this._attackFrames.length=0,this._frameRate=null,this.myStatus=null,this.area=null,this.targetIndex=null,this.attackerTab.length=0,this.myIndex=null,this._endFunc=null,this._endObj=null,this.curMeetIndex=null,this._slowDownValue=0,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(Soldier.prototype,"Soldier");var BindView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this._opening=!0,this._bindState=0,App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_OTHERINFO_GETGTFBREWARD,this.rewardCallback,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_BIND,this.checkBindStateCallback,this);var t="bindViewBg",e=BaseBitmap.create(t);e.x=10,this.addChildToContainer(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("bindWay"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);i.textAlign=TextFieldConst.ALIGH_LEFT,i.x=250,i.y=120,i.width=300,i.lineSpacing=10,this.addChildToContainer(i);var a="bindBtn",n=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,a,this.bindOrGetRewardButtonHandler,this);n.x=400-n.width/2,n.y=222-n.height/2,n.name="bindOrGetRewardBtn",n.visible=!1,this.addChildToContainer(n),this._mainBtn=n;var o=Config.GameprojectCfg.rewardGT1,s=GameData.formatRewardItem(o),r=egret.Rectangle.create();r.setTo(0,0,500,110),this._scrollList=ComponentManager.getScrollList(MailRewardScrollItem,s,r),this._scrollList.x=284-Math.min(5,s.length)/2*100,this._scrollList.y=320,this.addChildToContainer(this._scrollList),this.checkBindState()},e.prototype.bindOrGetRewardButtonHandler=function(){1===this._bindState?this.request(NetRequestConst.REQUEST_OTHERINFO_GETGTFBREWARD,{}):(PlatformManager.openUserCenter(),this.hide())},e.prototype.checkBindState=function(){RSDKHelper.bindAccountStatus()},e.prototype.checkBindStateCallback=function(t){var e=t.data;console.log("checkBindStateCallback",e),this._opening&&(this._bindState=parseInt(e),1===parseInt(e)?this._mainBtn.setText("taskCollect"):this._mainBtn.setText("bindBtn"),this._mainBtn.visible||(this._mainBtn.visible=!0))},e.prototype.rewardCallback=function(t){console.log("rewardCallback");var e=t.data,i=e.ret;e.data;i&&(App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.data.rewards)),this.hide())},e.prototype.getShowHeight=function(){return 500},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["bindViewBg"])},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_OTHERINFO_GETGTFBREWARD,this.rewardCallback,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_BIND,this.checkBindStateCallback,this),this._scrollList=null,this._mainBtn=null,this._opening=!1,this._bindState=0,t.prototype.dispose.call(this)},e}(PopupView);__reflect(BindView.prototype,"BindView");var BookroomInfoItem=function(t){function e(){var e=t.call(this)||this;return e._posId=0,e}return __extends(e,t),e.prototype.init=function(t){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_BOOKROOM_STUDY),this.refreshUI,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_BOOKROOM_FINISH),this.refreshUI,this),this._tipNode=new BaseDisplayObjectContainer,this.addChild(this._tipNode),this._posId=t;var e=BaseBitmap.create("bookroom_desk");this._desk=e,this.addChild(e);var i=BaseBitmap.create("bookroom_tipbg");i.x=e.x+e.width/2-i.width/2,i.y=e.y-40,this._tipNode.addChild(i),i.name="bookroom_tipbg";var a=ComponentManager.getTextField("",20);a.text=LanguageManager.getlocal("bookRoomClickTip"),a.x=i.x+i.width/2-a.width/2,a.y=i.y+i.height/2-a.height/2-5,this._tipNode.addChild(a),this._tipTxt=a,this.addTouchTap(this.bookRoomHandler,this),this.refreshUI()},e.prototype.refreshUI=function(t){if(t&&this._bRoomInfoVo){this._bRoomInfoVo=Api.bookroomVoApi.getSeatInfoByPosId(this._posId);var e=t.data.data.data,i=t.data.data.cmd,a=e.bookroompos,n=e.bookroom_poss;if(0==a&&this._bRoomInfoVo)return;if(a>0&&a!=this._posId)return;var o=GameConfig.config.bookroomCfg;if("bookroom.finish"==i&&!this._bRoomInfoVo){var s=1;0==a&&n[this._posId]&&n[this._posId].pos?s=n[this._posId].pos:n&&n.pos&&(s=n.pos);var r=[],l=LanguageManager.getlocal("bookRoomServant_completeFly1",[String(o.getBookExp*s)]),h=LanguageManager.getlocal("bookRoomServant_completeFly2",[String(o.getSkillExp*s)]);r.push({tipMessage:l}),r.push({tipMessage:h});var d=this.localToGlobal(this._desk.x+this._desk.width/2,this._desk.y-50);App.CommonUtil.playRewardFlyAction(r,d)}}if(this._bRoomInfoVo=Api.bookroomVoApi.getSeatInfoByPosId(this._posId),this._bRoomInfoVo){this._tipTxt.visible=!1;
var g=Api.servantVoApi.getServantObj(this._bRoomInfoVo.servantid),c=BaseLoadBitmap.create(g.fullImgPath),p=.5;c.setScale(p),c.width=405,c.height=467;var _=400;c.mask=new egret.Rectangle(0,0,c.width,_),c.x=this._desk.x+this._desk.width/2-c.width/2*p,c.y=-_*p+30,this.addChildAt(c,0),c.name="servantFullImg",this._tipNode.visible=!1;var u=BaseBitmap.create("bookroom_cdbg");if(u.x=this._desk.x+this._desk.width/2-u.width/2,u.y=-40,u.name="cdBg",this.addChild(u),this._cdTxt=ComponentManager.getTextField("",20),this._cdTxt.y=u.y+10,this.addChild(this._cdTxt),this._bRoomInfoVo.et<GameData.serverTime)this._cdTxt.textColor=TextFieldConst.COLOR_QUALITY_GREEN,this._cdTxt.text=LanguageManager.getlocal("bookRoomServant_studyComplete");else{var C=this._bRoomInfoVo.et-GameData.serverTime;this._cdTxt.text=App.DateUtil.getFormatBySecond(C).toString(),TickManager.removeTick(this.tick,this),TickManager.addTick(this.tick,this)}this._cdTxt.x=u.x+u.width/2-this._cdTxt.width/2}else{var c=this.getChildByName("servantFullImg"),u=this.getChildByName("cdBg");u&&this.removeChild(u),c&&this.removeChild(c),this._tipNode.visible=!0,egret.Tween.get(this._tipNode,{loop:!0}).to({y:-10},1e3).to({y:0},1e3),this._cdTxt&&(this.removeChild(this._cdTxt),this._cdTxt=null),this._tipTxt.visible=!0}},e.prototype.tick=function(){if(this._bRoomInfoVo){if(this._bRoomInfoVo=Api.bookroomVoApi.getSeatInfoByPosId(this._posId),this._bRoomInfoVo.et>GameData.serverTime){var t=this._bRoomInfoVo.et-GameData.serverTime;this._cdTxt.textColor=TextFieldConst.COLOR_WHITE,this._cdTxt.text=App.DateUtil.getFormatBySecond(t).toString();var e=this.getChildByName("cdBg");return this._cdTxt.x=e.x+e.width/2-this._cdTxt.width/2,e=null,!0}return this._cdTxt.textColor=TextFieldConst.COLOR_QUALITY_GREEN,this._cdTxt.text=LanguageManager.getlocal("bookRoomServant_studyComplete"),!1}return!1},e.prototype.bookRoomHandler=function(){this._bRoomInfoVo&&this._bRoomInfoVo.et<GameData.serverTime&&NetManager.request(NetRequestConst.REQUEST_BOOKROOM_FINISH,{pos:this._posId,isbatch:0}),this._bRoomInfoVo||ViewController.getInstance().openView(ViewConst.POPUP.BOOKROOMSERVANTSELECTPOPUPVIEW,this._posId)},e.prototype.dispose=function(){TickManager.removeTick(this.tick,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_BOOKROOM_STUDY),this.refreshUI,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_BOOKROOM_FINISH),this.refreshUI,this),this._posId=null,this._desk=null,this._tipTxt=null,this._cdTxt=null,this._bRoomInfoVo=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(BookroomInfoItem.prototype,"BookroomInfoItem");var BookroomServantScrollItem=function(t){function e(){var e=t.call(this)||this;return e._servantId="",e}return __extends(e,t),e.prototype.initItem=function(t,e){this._servantId=e;var i=Api.servantVoApi.getServantObj(this._servantId),a=BaseBitmap.create("public_9_probiginnerbg");a.width=510,a.height=120,a.x=9,this.addChild(a);var n=.55,o=BaseLoadBitmap.create(i.qualityBoxImgPath);o.width=194,o.height=192,o.setScale(n),o.x=20,o.y=8,o.name="cardbg",this.addChild(o);var s=BaseLoadBitmap.create(i.halfImgPath);s.width=180,s.height=177,s.x=o.x+o.width/2-s.width/2-5,s.y=o.y+o.height/2-s.height/2-2,s.setScale(n),this.addChild(s);var r=ComponentManager.getTextField("",20);r.textColor=ServantScrollItem.getQualityColor(i.clv),r.text=i.servantName,r.x=140,r.y=30,this.addChild(r);var l=ComponentManager.getTextField("",20);if(l.text=LanguageManager.getlocal("bookRoomServantSkillExp",[String(i.skillExp)]),l.x=r.x,l.y=r.y+30,this.addChild(l),Api.bookroomVoApi.isStudying(this._servantId)){var h=ComponentManager.getTextField("",24);h.text=LanguageManager.getlocal("bookRoomServant_studyingTxt"),h.x=a.x+a.width-130,h.y=a.y+a.height/2-h.height/2,this.addChild(h)}else{var d=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"bookRoomServant_study",this.studyHandler,this);d.x=a.x+a.width-150,d.y=a.y+a.height/2-d.height/2,this.addChild(d)}},e.prototype.studyHandler=function(){return Api.bookroomVoApi.isStudying(this._servantId)?void App.CommonUtil.showTip(LanguageManager.getlocal("bookRoomServant_studying")):void NetManager.request(NetRequestConst.REQUEST_BOOKROOM_STUDY,{servantid:this._servantId,pos:e._posId})},e.prototype.getSpaceX=function(){return 0},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){this._servantId="",t.prototype.dispose.call(this)},e._posId=0,e}(ScrollListItem);__reflect(BookroomServantScrollItem.prototype,"BookroomServantScrollItem");var BookroomServantSelectPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_BOOKROOM_STUDY),this.studyCallBack,this),this._posId=this.param.data,this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var t=GameConfig.config.bookroomCfg,e=ComponentManager.getTextField("",20);e.textColor=TextFieldConst.COLOR_BROWN,e.text=LanguageManager.getlocal("bookRoomServantSelecttxt1",[String(t.getBookExp),String(t.getSkillExp)]),e.x=40,e.y=20,this._nodeContainer.addChild(e);var i=ComponentManager.getTextField("",20);i.textColor=e.textColor,i.text=LanguageManager.getlocal("bookRoomServantSelecttxt2",["3"+LanguageManager.getlocal("date_hour2")]),i.x=e.x,i.y=e.y+30,this._nodeContainer.addChild(i);var a=BaseBitmap.create("public_9_bg4");a.width=528,a.height=634,a.x=this.viewBg.x+this.viewBg.width/2-a.width/2,a.y=i.y+30,this._nodeContainer.addChild(a);for(var n=new egret.Rectangle(0,0,a.width,a.height-10),o=Api.servantVoApi.getServantInfoIdListWithSort(2),s=[],r=[],l=0;l<o.length;l++){var h=o[l];Api.bookroomVoApi.isStudying(h)?r.push(h):s.push(h)}var d=s.concat(r);BookroomServantScrollItem._posId=this._posId;var g=ComponentManager.getScrollList(BookroomServantScrollItem,d,n);g.x=a.x,g.y=a.y+5,this._nodeContainer.addChild(g)},e.prototype.getShowHeight=function(){return 800},e.prototype.studyCallBack=function(t){this.hide()},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_BOOKROOM_STUDY),this.studyCallBack,this),this._nodeContainer=null,this._posId=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(BookroomServantSelectPopupView.prototype,"BookroomServantSelectPopupView");var BookroomView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_BOOKROOM_BUY),this.buySeatHandlerCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_BOOKROOM_FINISH),this.refreshSeatNum,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_BOOKROOM_STUDY),this.refreshSeatNum,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer),this._nodeContainer2=new BaseDisplayObjectContainer;var t=BaseBitmap.create("bookroom_bg");this._nodeContainer.addChild(t);var e=Api.bookroomVoApi.getSeatNum(),i=ComponentManager.getTextField("",20);i.x=30,i.y=10,i.name="curPosNumTxt",this._nodeContainer2.addChild(i);var a=ComponentManager.getButton("mainui_btn1","",this.addBtnClickHandler,this);if(a.x=180,a.y=i.y-7,a.visible=!1,a.name="addBtn",this._nodeContainer2.addChild(a),5>e){var n=ComponentManager.getTextField(LanguageManager.getlocal("bookRoomServant_batchTip"),20);n.x=GameConfig.stageWidth-n.width-30,n.y=i.y,n.name="batchTipTxt",this._nodeContainer2.addChild(n)}this.makeBatchBtn(e);for(var o=0;e>o;o++)this.makeSeatItem(o);var s=GameConfig.stageHeigth-this.container.y+10,r=new egret.Rectangle(0,0,GameConfig.stageWidth,s),l=ComponentManager.getScrollView(this._nodeContainer,r);l.y=-15,l.bounces=!1,this.addChildToContainer(l);var h=BaseLoadBitmap.create("servant_mask");h.width=GameConfig.stageWidth,h.scaleY=-1,h.y=120,this.addChildToContainer(h),this.addChildToContainer(this._nodeContainer2)},e.prototype.makeSeatItem=function(t){var e=new BookroomInfoItem;e.init(t+1);var i=20;t%2==1&&(i=GameConfig.stageWidth-e.width-i);var a=500+200*Math.floor(t/2);e.x=i,e.y=a,this._nodeContainer.addChild(e)},e.prototype.makeBatchBtn=function(t){var e=GameConfig.config.bookroomCfg;if(t>=5&&!this._nodeContainer2.getChildByName("bookroom_batch")){var i=BaseBitmap.create("forpeople_bottom");i.x=GameConfig.stageWidth-i.width-20,i.y=5,this._nodeContainer2.addChild(i);var a=ComponentManager.getButton("bookroom_visitIcon","",this.batchHandler,this),n=BaseBitmap.create("bookroom_batch");n.x=i.x+i.width/2-n.width/2,n.y=i.y+i.height-n.height,a.x=i.x+i.width/2-a.width/2,a.y=i.y+i.height/2-a.height/2,a.name="bookroom_batch",this._nodeContainer2.addChild(a),this._nodeContainer2.addChild(n)}var o=this._nodeContainer2.getChildByName("batchTipTxt");t>=5&&o&&(o.visible=!1),this.refreshSeatNum(),t==e.maxPos?this._nodeContainer2.getChildByName("addBtn").visible=!1:this._nodeContainer2.getChildByName("addBtn").visible=!0},e.prototype.batchHandler=function(){var t=Api.bookroomVoApi.getPosListInStudy();if(t.length>0){if(0==Api.bookroomVoApi.isBatchenable())return void App.CommonUtil.showTip(LanguageManager.getlocal("bookRoom_batchNotEnable"));NetManager.request(NetRequestConst.REQUEST_BOOKROOM_FINISH,{isbatch:1,pos:0})}else App.CommonUtil.showTip(LanguageManager.getlocal("bookRoom_batchEmptyTip"))},e.prototype.refreshSeatNum=function(t){var e=this;if(t){var i=t.data.data.data,a=i.luckys;if(a){var n=a.length;if(n>0)var o=0,s=this,r=egret.setInterval(function(){o+=1,e.playLucky(),o>=n&&egret.clearInterval(r)},s,1500,1)}}var l=Api.bookroomVoApi.getSeatNum(),h=this._nodeContainer2.getChildByName("curPosNumTxt"),d=Api.bookroomVoApi.getPosListInStudy().length+"/"+l;h.text=LanguageManager.getlocal("bookRoom_posNUm",[d])},e.prototype.buySeatHandlerCallback=function(t){var e=t.data.data;if(0==e.ret){var i=Api.bookroomVoApi.getSeatNum();this.makeSeatItem(i-1),this.makeBatchBtn(i),App.CommonUtil.showTip(LanguageManager.getlocal("bookRoom_buySeatTip1"))}else App.CommonUtil.showTip(LanguageManager.getlocal("bookRoom_buySeatTip2"))},e.prototype.buySeatHandler=function(){NetManager.request(NetRequestConst.REQUEST_BOOKROOM_BUY,{})},e.prototype.addBtnClickHandler=function(){var t=GameConfig.config.bookroomCfg,e=t.needGem[Api.bookroomVoApi.getSeatNum()-1],i=LanguageManager.getlocal("bookRoomServant_buySeat",[String(e)]),a={confirmCallback:this.buySeatHandler,handler:this,icon:"itemicon1",iconBg:"itembg_1",num:Api.playerVoApi.getPlayerGem(),useNum:e,msg:i,id:1};ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,a)},e.prototype.playLucky=function(){var t=BaseBitmap.create("manage_boomtext");t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2;var e=500,i=250;t.setPosition(e,i),LayerManager.msgLayer.addChild(t),egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},70).to({y:i-50,alpha:.7},600).call(function(t){t.dispose()}.bind(this,t),this),App.CommonUtil.showGodbless("bookRoom")},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["bookroom_batch","bookroom_bg","bookroom_cdbg","bookroom_desk","bookroom_tipbg","bookroom_visitIcon","forpeople_bottom","bookroom_visitIcon_down"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_BOOKROOM_BUY),this.buySeatHandlerCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_BOOKROOM_FINISH),this.refreshSeatNum,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_BOOKROOM_STUDY),this.refreshSeatNum,this),this._nodeContainer=null,this._nodeContainer2=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(BookroomView.prototype,"BookroomView");var BossBattleView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e._rewards=null,e._curKey=null,e._challengeConfig=null,e._allServantInfo=null,e._dps=0,e._bossValue=0,e._heroValue=0,e._isBattling=!1,e._cid=0,e}return __extends(e,t),e.prototype.getResourceList=function(){var e=t.prototype.getResourceList.call(this);return e.concat(["bossbg",ButtonConst.BATTLE_START_BTN_1,"progress7_bg","progress8"])},e.prototype.getBgName=function(){return"bossbg"},e.prototype.getTitleStr=function(){return"bossViewTitle1"},e.prototype.resetTopKey=function(){var t=this;if(null==this._allServantInfo){this._allServantInfo={};var e=Api.servantVoApi.getServantInfoIdListWithSort(1);for(var i in e){var a=e[i];this._allServantInfo[a]=Api.servantVoApi.getServantCombatWithId(a)}}this._curKey=null,this._heroValue=0;var n=Object.keys(this._allServantInfo);n.sort(function(e,i){var a=Api.challengeVoApi.getServantInfoValue(e),n=Api.challengeVoApi.getServantInfoValue(i);return a==n?Number(t._allServantInfo[i]-t._allServantInfo[e]):Number(a-n)}),0==Api.challengeVoApi.getServantInfoValue(n[0])&&(this._curKey=n[0],this._heroValue=this._allServantInfo[this._curKey])},e.prototype.initView=function(){this.titleTF.text=Api.challengeVoApi.getCurBigChannelId().toString()+". "+LanguageManager.getlocal("challengeTitle"+Api.challengeVoApi.getCurBigChannelId()),this.titleTF.x=this.width/2-this.titleTF.width/2,this._challengeConfig=ChallengeCfg.getChallengeCfgById(Api.challengeVoApi.getCurChannelId()),this._cid=Api.challengeVoApi.getCurChannelId(),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_CHALLENGE_ATTACK),this.intoBossBattle,this),this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f),this._bossValue=this._challengeConfig.value,this.resetTopKey(),this.setTopProgress(this._bossValue-Api.challengeVoApi.getCurKilledNum(),this._bossValue,GameConfig.stageWidth-100),this._topProgress.y=10;var t="story_npc_"+this._challengeConfig.showBoss;this.setUpHero(t,[[LanguageManager.getlocal("BossName"+this._challengeConfig.showBoss),TextFieldConst.COLOR_WARN_RED2]],2),this._upHero.x=17;var e=null,i=null;if(this._curKey){e="servant_full_"+this._curKey;var a=this._allServantInfo[this._curKey];i=[[LanguageManager.getlocal("fightForce")+":"+a,TextFieldConst.COLOR_LIGHT_YELLOW],[LanguageManager.getlocal("clickChooseServant")]]}else e="servant_empty",i=[["empty",TextFieldConst.COLOR_LIGHT_YELLOW],[LanguageManager.getlocal("clickChooseServant")]];this.setDownHero(e,i,2),this._downHero.x=280,this._downHero.y=GameConfig.stageHeigth-this._downHero.height-20-10,this._upPositon=egret.Point.create(this._upHero.x,this._upHero.y),this._downPositon=egret.Point.create(this._downHero.x,this._downHero.y),this._downHero.addTouchTap(this.clickChangeHero,this),this._gameBtn=ComponentManager.getButton(ButtonConst.BATTLE_START_BTN_1,null,this.btnClick,this),this._gameBtn.setPosition(GameConfig.stageWidth/2,GameConfig.stageHeigth/2+20),this._gameBtn.anchorOffsetX=this._gameBtn.width/2,this._gameBtn.anchorOffsetY=this._gameBtn.height/2,this.addChild(this._gameBtn),this.btnAnim(),null==this._curKey&&(this._gameBtn.visible=!1)},e.prototype.clickChangeHero=function(){if(1!=this._isBattling){var t=Object.keys(this._allServantInfo),e=[];for(var i in t){var a=t[i];e.push([a,Api.challengeVoApi.getServantInfoValue(a),this._allServantInfo[a]])}e.sort(function(t,e){var i=t[1],a=e[1];return i==a?Number(e[2]-t[2]):Number(i-a)}),ViewController.getInstance().openView(ViewConst.POPUP.SERVANTSELECTEDPOPUPVIEW,{type:ServantSelectedPopupView.TYPE_BATTLE,info:e,callback:this.sendRequest,handler:this})}},e.prototype.sendRequest=function(t){var e=t.key;if(e!=this._curKey){this._curKey=e;var i=Api.servantVoApi.getServantObj(e);this._downHero.resetHero("servant_full_"+i.servantId,this._allServantInfo[e]),this._gameBtn.visible=!0}},e.prototype.btnClick=function(){NetManager.request(NetRequestConst.REQUEST_CHALLENGE_ATTACK,{servantId:this._curKey})},e.prototype.btnAnim=function(){this._gameBtn&&egret.Tween.get(this._gameBtn).to({scaleX:.9,scaleY:.9},600).to({scaleX:1,scaleY:1},600).call(this.btnAnim,this)},e.prototype.intoBossBattle=function(t){App.LogUtil.log(t.data),1==t.data.ret&&(this._rewards=t.data.data.data.rewards,SoundManager.playEffect(SoundConst.EFFECT_BATTLE_START),this._isAttackWin=t.data.data.data.battleReport.success,this._dps=t.data.data.data.battleReport.dps,this._isBattling=!0,this._gameBtn.visible=!1,this.gameBegin())},e.prototype.gameBegin=function(){this.attackHandle(1,this._dps)},e.prototype.showEndGame=function(){ViewController.getInstance().openView(ViewConst.BASE.BATTLEWIN,{award:this._rewards,f:this.hide,o:this,type:3,cid:this._cid})},e.prototype.atkEndCallback=function(){if(this._isAttackWin)egret.Tween.get(this._upHero).to({alpha:0},800).call(this.showEndGame,this);else if(this._isBattling=!1,this.closeBtn.setEnable(!0),this.resetTopKey(),this._curKey){var t=Api.servantVoApi.getServantObj(this._curKey);this._downHero.resetHero("servant_full_"+t.servantId,this._allServantInfo[this._curKey]),TimerManager.doTimer(100,1,this.showGameBtn,this)}else this._downHero.resetHero()},e.prototype.showGameBtn=function(){this._gameBtn&&(this._gameBtn.visible=null!=this._curKey)},e.prototype.hide=function(){this._obj&&this._callbackF&&this._callbackF.apply(this._obj),t.prototype.hide.call(this)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_CHALLENGE_ATTACK),this.intoBossBattle,this),this._challengeConfig=null,this._callbackF=null,this._obj=null,this._rewards=null,this._curKey=null,this._isBattling=!1,this._gameBtn=null,this._isAttackWin=null,this._allServantInfo=null,this._dps=0,this._cid=0,t.prototype.dispose.call(this)},e}(BaseBattleView);__reflect(BossBattleView.prototype,"BossBattleView");var TouchHelper;!function(t){function e(t,e,i,a){var n=new o;return n.addTouchTap(t,e,i,a),n}function i(t){t&&t.removeTouchTap()}function a(t,e,i,a,n){var o=new s;return o.addTouch(t,e,i,a,n),o}function n(t){t&&t.removeTouch()}var o=function(t){function e(){var e=t.call(this)||this;return e._target=null,e._touchTapHandler=null,e._touchTapHandlerParams=null,e._touchTapHandlerThisObj=null,e}return __extends(e,t),e.prototype.addTouchTap=function(t,e,i,a){t&&e&&(t.touchEnabled=!0,this._target=t,this._touchTapHandler=e,this._touchTapHandlerParams=a,this._touchTapHandlerThisObj=i,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchTapHandler,this))},e.prototype.touchTapHandler=function(t){if(this._touchTapHandler){var e=[t];this._touchTapHandlerParams&&(e=e.concat(this._touchTapHandlerParams)),this._touchTapHandler.apply(this._touchTapHandlerThisObj,e)}},e.prototype.removeTouchTap=function(){this.dispose()},e.prototype.dispose=function(){this._touchTapHandler=null,this._touchTapHandlerParams=null,this._touchTapHandlerThisObj=null,this._target.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchTapHandler,this),this._target=null},e}(BaseClass);t.Tap=o,__reflect(o.prototype,"TouchHelper.Tap");var s=function(t){function e(){var e=t.call(this)||this;return e._target=null,e._touchHandler=null,e._touchHandlerParams=null,e._touchHandlerThisObj=null,e._isTouching=!1,e._isMoveCancel=!1,e._eventList=[],e}return __extends(e,t),e.prototype.addTouch=function(t,e,i,a,n){t&&e&&(t.touchEnabled=!0,this._target=t,this._touchHandler=e,this._touchHandlerParams=a,this._touchHandlerThisObj=i,this._isMoveCancel=Boolean(n),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchHandler,this),egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this),t.addEventListener(egret.TouchEvent.TOUCH_END,this.touchHandler,this),t.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.touchHandler,this),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchHandler,this),egret.MainContext.instance.stage.addEventListener(egret.Event.LEAVE_STAGE,this.touchHandler,this))},e.prototype.touchHandler=function(t){var e=null,i=t,a=!1;switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._startPoint?this._startPoint.setTo(i.stageX,i.stageY):this._startPoint=egret.Point.create(i.stageX,i.stageY),this._isTouching=!0;break;case egret.TouchEvent.TOUCH_MOVE:if(!this._isTouching)return;this._curPoint?this._curPoint.setTo(i.stageX,i.stageY):this._curPoint=egret.Point.create(i.stageX,i.stageY),this._isMoveCancel&&egret.Point.distance(this._curPoint,this._startPoint)>10&&(this._isTouching=!1,a=!0);break;case egret.TouchEvent.TOUCH_END:if(!this._isTouching)return;this._isTouching=!1;break;case egret.TouchEvent.TOUCH_RELEASE_OUTSIDE:case egret.TouchEvent.TOUCH_CANCEL:case egret.Event.LEAVE_STAGE:if(!this._isTouching)return;this._isTouching=!1,a=!0}if(a?(e=egret.Event.create(egret.TouchEvent,egret.TouchEvent.TOUCH_CANCEL),e.$setTarget(this._target),e.$currentTarget=this._target,this._eventList.push(e)):e=t,this._touchHandler){var n=[e];this._touchHandlerParams&&(n=n.concat(this._touchHandlerParams)),this._touchHandler.apply(this._touchHandlerThisObj,n)}},e.prototype.removeTouch=function(){this.dispose()},e.prototype.dispose=function(){for(;this._eventList.length>0;)egret.Event.release(this._eventList.pop());this._touchHandler=null,this._touchHandlerParams=null,this._touchHandlerThisObj=null,this._target&&(this._target.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchHandler,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this),this._target.removeEventListener(egret.TouchEvent.TOUCH_END,this.touchHandler,this),this._target.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.touchHandler,this),this._target.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchHandler,this),egret.MainContext.instance.stage.removeEventListener(egret.Event.LEAVE_STAGE,this.touchHandler,this)),this._target=null},e}(BaseClass);t.Touch=s,__reflect(s.prototype,"TouchHelper.Touch"),t.addTouchTap=e,t.removeTouchTap=i,t.addTouch=a,t.removeTouch=n}(TouchHelper||(TouchHelper={}));var CatchPrisonPopupView=function(t){function e(){var e=t.call(this)||this;return e.prisonerDescribe=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return this._prisonerId=this.param.data.unlockPrison,this._showBoss=this.param.data.showBoss,t.prototype.getResourceList.call(this).concat(["prisonview_small_bg","catch_prisoner_text","prisonview_itembg","catch_prisoner_text_laoyitype"])},e.prototype.initView=function(){this.touchEnabled=!1;var t=BaseBitmap.create("prisonview_small_bg");t.x+=15,this.addChildToContainer(t);var e=BaseLoadBitmap.create("story_npc_"+this._showBoss);e.x+=100,e.y+=15,e.scaleX=.8,e.scaleY=.8,this.addChildToContainer(e);var i=BaseBitmap.create("prisonview_itembg");i.x+=15,this.addChildToContainer(i);var a=LanguageManager.getlocal("prisonerName"+this._prisonerId)+" ("+LanguageManager.getlocal("prisonerOffice"+this._prisonerId)+")";this.prisonerDescribe=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this.prisonerDescribe.setPosition(this.viewBg.width/2-this.prisonerDescribe.width/2,i.y+i.height-50),this.addChildToContainer(this.prisonerDescribe);var n=BaseBitmap.create("catch_prisoner_text");Api.switchVoApi.checkOpenNewPrison()&&(n=BaseBitmap.create("catch_prisoner_text_laoyitype")),n.setPosition(GameConfig.stageWidth/2-n.width/2,GameConfig.stageHeigth/2+260),this.addChild(n),this.y=-200,this.alpha=0,egret.Tween.get(this).to({alpha:1,y:0},800).call(this.remove,this)},e.prototype.drawblackMask=function(){var t=BaseBitmap.create("public_9_viewmask");t.width=GameConfig.stageWidth,t.height=GameConfig.stageHeigth,t.touchEnabled=!0,this.addChild(t),this.setChildIndex(t,0)},e.prototype.isShowMask=function(){return!1},e.prototype.remove=function(){this.drawblackMask(),this.touchEnabled=!0,this.addTouchTap(this.touchHandler,this)},e.prototype.touchHandler=function(){this.dispose()},e.prototype.getShowHeight=function(){return 510},e.prototype.getTitleStr=function(){return"prisonCatch"},e.prototype.dispose=function(){this.prisonerDescribe=null,this._prisonerId=null,this._showBoss=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(CatchPrisonPopupView.prototype,"CatchPrisonPopupView");var ChallengeAutoPopupView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e}return __extends(e,t),e.prototype.getTitleStr=function(){return"challengeAutoFight"},e.prototype.initView=function(){this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f);var t=BaseBitmap.create("public_9_bg4");t.width=518,t.height=180,t.setPosition(this.viewBg.width/2-t.width/2,65),this.addChildToContainer(t);var e=BaseBitmap.create("public_9_resbg");e.setPosition(t.x+12,12),this.addChildToContainer(e);var i=BaseLoadBitmap.create("itemicon4");i.setScale(.5),i.x=e.x-3,i.y=e.y+e.height/2-50+25,this.addChildToContainer(i);var a=ComponentManager.getTextField(Api.playerVoApi.getSoldier().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON);a.setPosition(e.x+50,e.y+e.height/2-a.height/2),this.addChildToContainer(a),e.width=a.width+70;var n=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"challengeAutoFightBtn",this.goToFight,this);n.setPosition(this.viewBg.width/2-n.width/2,260),this.addChildToContainer(n),n.setColor(TextFieldConst.COLOR_BLACK);for(var o=Api.challengeVoApi.getCurChannelId()-1,s=o,r=Api.playerVoApi.getSoldier(),l=o;o+40>=l;l++){var h=ChallengeCfg.getChallengeCfgById(l+1);if(1!=h.type)break;var d=h.atk,g=h.soldier;l==Api.challengeVoApi.getCurChannelId()&&(g-=Api.challengeVoApi.getCurKilledNum());var c=Api.playerVoApi.getAtk(),p=r,_=Api.conquestVoApi.getBattleResult(c,p,d,g);if(1!=_.success){r=0;break}s++,r=_.left1}var u=Api.playerVoApi.getSoldier()-r,C=ComponentManager.getTextField(LanguageManager.getlocal("challengeAutoFightConsume",[String(u)]),TextFieldConst.FONTSIZE_CONTENT_COMMON);C.setPosition(this.viewBg.width/2-C.width/2,100),this.addChildToContainer(C);var f=Math.floor(s/41)+1,m=Math.floor(s%41/8)+1;m=6==m?5:m;var T=LanguageManager.getlocal("challengeTitle"+f),y=ComponentManager.getTextField(LanguageManager.getlocal("challengeAutoFightTarget",[String(f),T,String(m)]),TextFieldConst.FONTSIZE_CONTENT_COMMON);y.setPosition(this.viewBg.width/2-y.width/2,145),this.addChildToContainer(y);var v=ComponentManager.getTextField(LanguageManager.getlocal("challengeAutoFightNoDialog"),TextFieldConst.FONTSIZE_CONTENT_COMMON);v.setPosition(this.viewBg.width/2-v.width/2,190),this.addChildToContainer(v)},e.prototype.goToFight=function(){ViewController.getInstance().openView(ViewConst.POPUP.CHALLENGEAUTOREWARDSPOPUOVIEW,{f:this._callbackF,o:this._obj}),this.hide()},e.prototype.getBgExtraHeight=function(){return 20},e.prototype.dispose=function(){this._callbackF=null,this._obj=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(ChallengeAutoPopupView.prototype,"ChallengeAutoPopupView");var ChallengeAutoRewardsPopupView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e._infoList=[],e._scrollContiner=void 0,e._fightBtn=null,e._containerTab=[],e._curShowIdx=0,e._scrollView=null,e._oldSoldier=0,e._oldCid=0,e._oldKill=0,e}return __extends(e,t),e.prototype.getTitleStr=function(){return"challengeAutoFight"},e.prototype.getRequestData=function(){return this._oldSoldier=Api.playerVoApi.getSoldier(),this._oldCid=Api.challengeVoApi.getCurChannelId(),this._oldKill=Api.challengeVoApi.getCurKilledNum(),{requestType:NetRequestConst.REQUEST_CHALLENGE_AUTOATTACK,requestData:{}}},e.prototype.receiveData=function(t){for(var e=t.data.data.rewardsArr,i=Object.keys(e),a=this._oldSoldier,n=[],o=0,s=0;s<i.length;s++){var r=i[s],l=e[r],h=Number(r),d=ChallengeCfg.getChallengeCfgById(h),g=d.atk,c=d.soldier;h==this._oldCid&&(c-=this._oldKill);var p=Api.playerVoApi.getAtk(),_=a,u=Api.conquestVoApi.getBattleResult(p,_,g,c);a=u.left1;var C=[];l&&l.length>0&&(C=GameData.formatRewardItem(l));for(var f=0;f<C.length;f++){var m=C[f],T=!1;for(var y in n){var v=n[y];if(v.id==m.id&&v.type==m.type){T=!0,v.num+=m.num;break}}0==T&&n.push(m)}o++;var A=h%41%8;if(0==A||s+1==i.length){var w=Math.floor(h/41)+1,x=Math.floor((h-1)%41/8)+1,I=n.concat();this._infoList.push({bigId:w,midId:x,fightCont:o,curSd:a,awardArray:I}),n.length=0,o=0}}},e.prototype.getCloseBtnName=function(){return null},e.prototype.initView=function(){this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f);var t=BaseBitmap.create("public_9_bg4");t.width=518,t.height=602,t.setPosition(this.viewBg.width/2-t.width/2,18),this.addChildToContainer(t),this._fightBtn=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"sysConfirm",this.confirmClick,this),this._fightBtn.setPosition(this.viewBg.width/2-this._fightBtn.width/2,t.y+t.height+20),this.addChildToContainer(this._fightBtn),this._fightBtn.setColor(TextFieldConst.COLOR_BLACK),this._fightBtn.visible=!1,this._scrollContiner=new BaseDisplayObjectContainer;var e=egret.Rectangle.create();e.setTo(30,t.y+10,this.viewBg.width,t.height-20),this._scrollView=ComponentManager.getScrollView(this._scrollContiner,e),this.addChildToContainer(this._scrollView),this._scrollView.horizontalScrollPolicy="off";for(var i=0;i<this._infoList.length;i++){var a=this.getRewardInfoContainer(this._infoList[i]);this._containerTab.push(a)}var n;n=0==Api.playerVoApi.getSoldier()?"challengeRewardEnd2":"challengeRewardEnd1";var o=new BaseDisplayObjectContainer,s=ComponentManager.getTextField(LanguageManager.getlocal(n),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_YELLOW);s.setPosition(this.viewBg.width/2-s.width/2,10),o.addChild(s),s.height=s.height+10,0==Api.playerVoApi.getSoldier()&&s.setColor(TextFieldConst.COLOR_WARN_RED),this._containerTab.push(o),this.showContainerAnim()},e.prototype.showContainerAnim=function(){if(this._containerTab.length>this._curShowIdx){var t=this._containerTab[this._curShowIdx];this._scrollContiner.addChild(t),t.y=192*this._curShowIdx,this._scrollView.setScrollTop(this._scrollView.getMaxScrollTop(),300),this._curShowIdx++,t.x=-550,egret.Tween.get(t).wait(500).to({x:-30},300),egret.Tween.get(this._scrollContiner).wait(600).call(this.showContainerAnim,this)}else this._fightBtn.visible=!0,this._scrollView.touchEnabled=!0,this._scrollContiner.touchEnabled=!0},e.prototype.getRewardInfoContainer=function(t){var e=new BaseDisplayObjectContainer,i=BaseBitmap.create("public_9_bg14");i.width=504,i.height=190,i.setPosition(this.viewBg.width/2-i.width/2,0),e.addChild(i);var a=(Api.challengeVoApi.getCurMiddleChannelId(),LanguageManager.getlocal("challengeTitle"+t.bigId)),n=ComponentManager.getTextField(LanguageManager.getlocal("challengeRewardTitle",[String(t.bigId),a,String(t.midId)]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_YELLOW2);n.setPosition(i.x+20,14),e.addChild(n);var o=BaseLoadBitmap.create("rank_line");o.width=500,o.height=2,o.x=this.viewBg.width/2-o.width/2,o.y=n.y+n.height+7,e.addChild(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("challengeRewardFight",[String(t.fightCont),String(t.curSd)]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);s.setPosition(n.x,n.y+n.height+18),e.addChild(s);var r=BaseLoadBitmap.create("rank_line");r.width=500,r.height=2,r.x=this.viewBg.width/2-r.width/2,r.y=s.y+s.height+7,e.addChild(r);var l=ComponentManager.getTextField(LanguageManager.getlocal("challengeReward"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);l.setPosition(n.x,i.height-70),e.addChild(l);var h=l.x+l.width+10;for(var d in t.awardArray){var g=t.awardArray[d],c=GameData.getItemIcon(g,!0);c.setPosition(h,i.height-100),c.setScale(.83),e.addChild(c),h+=113}return e},e.prototype.confirmClick=function(){this._obj&&this._callbackF&&this._callbackF.apply(this._obj,[]),this.hide()},e.prototype.getBgExtraHeight=function(){return 20
},e.prototype.dispose=function(){this._callbackF=null,this._obj=null,this._infoList.length=0,egret.Tween.removeTweens(this._scrollContiner),this._scrollContiner=void 0,this._fightBtn=null,this._containerTab.length=0,this._curShowIdx=0,this._scrollView=null,this._oldSoldier=0,this._oldCid=0,this._oldKill=0,t.prototype.dispose.call(this)},e}(PopupView);__reflect(ChallengeAutoRewardsPopupView.prototype,"ChallengeAutoRewardsPopupView");var ChallengeButton=function(t){function e(){var e=t.call(this)||this;return e._knife1=null,e._knife2=null,e}return __extends(e,t),e.prototype.initButton=function(e,i,a){this._idx=a;var n=Api.challengeVoApi.getCurMiddleChannelId()-1;a>=n&&(this._lightBg=BaseBitmap.create("channel_light"),this.addChild(this._lightBg),this.visible=!1),t.prototype.init.call(this,"channel_bg","",e,i),this.touchEnabled=!1,n==a&&this.showClickable()},e.prototype.showClickable=function(){var t=Api.challengeVoApi.getCurMiddleChannelId()-1;5==t?this.showBoss():this.showKnifeAnim()},e.prototype.showBoss=function(){this.visible=!0,this.touchEnabled=!0;var t=ChallengeCfg.getChallengeCfgById(41*Api.challengeVoApi.getCurBigChannelId()),e=egret.Rectangle.create();e.setTo(0,0,120,120);var i=BaseLoadBitmap.create("prison_icon"+t.showBoss,e);i.setPosition(this._lightBg.width/2-i.width/2,this._lightBg.height/2-i.height/2-2),this.addChild(i);var a=BaseBitmap.create("battle_boss");a.setPosition(this._lightBg.width/2-a.width/2,this._lightBg.height-a.height),this.addChild(a)},e.prototype.showKnifeAnim=function(){this.visible=!0,this.touchEnabled=!0,this._knife1=BaseBitmap.create("channel_knife"),this._knife1.scaleX=-1,this.addChild(this._knife1),this._knife2=BaseBitmap.create("channel_knife"),this.addChild(this._knife2),this._knife1.anchorOffsetX=this._knife1.width,this._knife1.anchorOffsetY=this._knife1.height,this._knife2.anchorOffsetX=this._knife1.width,this._knife2.anchorOffsetY=this._knife1.height,this._knife1.setPosition(20,this._lightBg.height-20),this._knife2.setPosition(this._lightBg.width-20,this._lightBg.height-20),this._knife1.rotation=-20,this._knife2.rotation=20,egret.Tween.get(this._knife1,{loop:!0}).to({rotation:40},200).wait(100).to({rotation:-40},300).wait(200),egret.Tween.get(this._knife2,{loop:!0}).to({rotation:-40},200).wait(100).to({rotation:40},300).wait(200)},e.prototype.hiddenKnifeAnim=function(){this._lightBg.visible=!1,this.touchEnabled=!1,egret.Tween.removeTweens(this),this._knife1&&(this.removeChild(this._knife1),this._knife1=null),this._knife2&&(this.removeChild(this._knife2),this._knife2=null)},e.prototype.dispose=function(){egret.Tween.removeTweens(this),this._idx=null,this._lightBg=null,this._knife1=null,this._knife2=null,t.prototype.dispose.call(this)},e}(BaseButton);__reflect(ChallengeButton.prototype,"ChallengeButton");var ChallengeStory=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e._curIdx=0,e._config=null,e._showManTab=[],e}return __extends(e,t),e.prototype.getResourceList=function(){this._callbackF=this.param.data.f,this._obj=this.param.data.o,this._config=this.param.data.dialogue.split("_");var e={},i=t.prototype.getResourceList.call(this);for(var a in this._config){var n=this._config[a],o=Config.ChallengestoryCfg.getChallengestoryCfgById(n);"0"!=o.icon&&"1"!=o.icon&&(e[o.icon]||(e[o.icon]=1))}return i=Object.keys(e),i.concat(["guideNameBg"])},e.prototype.init=function(){var t=BaseBitmap.create("public_9_viewmask");t.width=GameConfig.stageWidth,t.height=GameConfig.stageHeigth,this.addChild(t),this.width=GameConfig.stageWidth,this.height=GameConfig.stageHeigth,t.addTouchTap(this.clickPage,this,null),this._tipBB=BaseBitmap.create("public_9_wordbg"),this._tipBB.height=170,this._tipBB.setPosition(GameConfig.stageWidth/2-this._tipBB.width/2,GameConfig.stageHeigth-this._tipBB.height-0),this.addChild(this._tipBB),this._continueText=ComponentManager.getTextField(LanguageManager.getlocal("clickContinue"),20),this._continueText.setPosition(this._tipBB.x+this._tipBB.width-this._continueText.width-50,this._tipBB.y+this._tipBB.height-this._continueText.height-20),this._continueText.textColor=TextFieldConst.COLOR_WARN_GREEN,this.addChild(this._continueText),this.textAnim(this._continueText),this._titleBg=BaseBitmap.create("guideNameBg"),this._titleBg.setPosition(25,this._tipBB.y-50),this.addChild(this._titleBg),this._titleBg.visible=!1,this._titleText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL),this._titleText.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,this._titleText.setPosition(30,this._tipBB.y-42),this.addChild(this._titleText),this._descText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL),this._descText.width=GameConfig.stageWidth-60,this._descText.lineSpacing=8,this._descText.setPosition(30,this._tipBB.y+38),this.addChild(this._descText),this.clickPage()},e.prototype.textAnim=function(t){egret.Tween.removeTweens(t);var e=t.x,i=t.y,a=t.x-.1*t.width,n=t.y-.1*t.height;egret.Tween.get(t).to({scaleX:1.2,scaleY:1.2,x:a,y:n},600).to({scaleX:1,scaleY:1,x:e,y:i},600).to({scaleX:1.2,scaleY:1.2,x:a,y:n},600).to({scaleX:1,scaleY:1,x:e,y:i},600).call(this.textAnim,this,[t])},e.prototype.clickPage=function(){if(this._curIdx>=this._config.length)this.callback();else{var t=this._config[this._curIdx],e=Config.ChallengestoryCfg.getChallengestoryCfgById(t);this._descText.text=LanguageManager.getlocal("challengeStoryDesc"+t);for(var i in this._showManTab)this.removeChild(this._showManTab[i]);if(this._showManTab.length=0,"0"==e.icon);else if("1"==e.icon){var a=Api.playerVoApi.getMyPortrait();a.setPosition(GameConfig.stageWidth/2-a.width/2,GameConfig.stageHeigth-a.height-10+50+80),this.addChildAt(a,1),this._showManTab.push(a);var n=new egret.Rectangle;n.setTo(0,0,a.width,430),a.mask=n}else{var o=BaseBitmap.create(e.icon);o.setScale(.8);var s=0;"wife"==e.icon.substring(0,4)&&(o.setScale(460/o.height),s=20),o.setPosition(GameConfig.stageWidth/2-o.width/2*o.scaleX,GameConfig.stageHeigth-o.height*o.scaleY-272-s+50+80),this.addChildAt(o,1),this._showManTab.push(o)}"0"==e.name?(this._titleText.text="",this._titleBg.visible=!1):(this._titleText.text=LanguageManager.getlocal(e.name),this._titleText.x=this._titleBg.x+this._titleBg.width/2-this._titleText.width/2,this._titleBg.visible=!0),this._curIdx++}},e.prototype.callback=function(){this._obj&&this._callbackF&&this._callbackF.apply(this._obj),this.hide()},e.prototype.initView=function(){},e.prototype.dispose=function(){egret.Tween.removeTweens(this._continueText),this._continueText=null,this._callbackF=null,this._obj=null,this._curIdx=0,this._config=null,this._showManTab.length=0,t.prototype.dispose.call(this)},e}(BaseView);__reflect(ChallengeStory.prototype,"ChallengeStory");var ChallengeView=function(t){function e(){var e=t.call(this)||this;return e._topContiner=void 0,e._middleContiner=void 0,e._buttomContiner=void 0,e._scrollContiner=void 0,e._attackBtnTab=[],e._passIconTab=[],e._lineIconTab=[],e._soldierText=null,e._expProgress=null,e._bigChannel=0,e._middleChannel=0,e._officerIcon=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([this.getMiddlePic(),"challenge_pass","progress4","progress7_bg","promotion_officerbg1","channel_bg","channel_light","channel_knife","battle_boss","challenge_icon_force","challenge_arrow","challenge_icon_power","office_fnt","challenge_story_bg","challenge_top_bg","btn_challenge_auto","mainui_fg"])},e.prototype.getMiddlePic=function(){return"challenge_bg1"},e.prototype.getTitleStr=function(){return"challengeTitle"+Api.challengeVoApi.getCurBigChannelId()},e.prototype.getDescStr=function(){return"challengeDesc"+Api.challengeVoApi.getCurBigChannelId()},e.prototype.getRuleInfo=function(){return"challengeInfo"},e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_RESCHANGE_REFRESH_UI,this.refresh,this),this._bigChannel=Api.challengeVoApi.getCurBigChannelId(),this._middleChannel=Api.challengeVoApi.getCurMiddleChannelId(),this.container.y=this.getTitleButtomY(),this._scrollContiner=new BaseDisplayObjectContainer;var t=egret.Rectangle.create();t.setTo(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-this.getTitleButtomY()-20),this.addChildToContainer(this._scrollContiner),this._topContiner=new BaseDisplayObjectContainer,this._scrollContiner.addChild(this._topContiner),this.initTop(),this.initMiddle(),this.initButtom(),Api.rookieVoApi.isInGuiding&&Api.rookieVoApi.checkNextStep()},e.prototype.initTop=function(){var t=BaseBitmap.create("challenge_top_bg");this._topContiner.addChild(t),this._circleHead=Api.playerVoApi.getPlayerCircleHead(Api.playerVoApi.getPlayePicId()),this._circleHead.setPosition(2,6),this._topContiner.addChild(this._circleHead),this._circleHead.addTouchTap(this.roleHeadClickHandler,this),this._officerIcon=ComponentManager.getBitmapText(Api.playerVoApi.getPlayerOffice(),"office_fnt"),this._officerIcon.setScale(.85),this._officerIcon.setPosition(this._circleHead.x+this._circleHead.width/2-this._officerIcon.width*this._officerIcon.scaleX/2,this._circleHead.y+63),this._topContiner.addChild(this._officerIcon);var e=BaseBitmap.create("public_9_resbg");e.setPosition(105,this._circleHead.y+2),e.width=172,this._topContiner.addChild(e);var i=BaseLoadBitmap.create("challenge_icon_power");i.setPosition(e.x-3,e.y),this._topContiner.addChild(i);var a=ComponentManager.getTextField(Api.playerVoApi.getPlayerPower().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,16642792);a.setPosition(e.x+50,e.y+e.height/2-a.height/2+2),this._topContiner.addChild(a);var n=BaseBitmap.create("public_9_resbg");n.setPosition(e.x+175,e.y),n.width=e.width,this._topContiner.addChild(n);var o=BaseBitmap.create("challenge_icon_force");o.setPosition(n.x-3,n.y),this._topContiner.addChild(o);var s=ComponentManager.getTextField(Api.playerVoApi.getAtk().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,a.textColor);s.setPosition(n.x+50,n.y+n.height/2-s.height/2+2),this._topContiner.addChild(s);var r=BaseBitmap.create("public_9_resbg");r.setPosition(n.x+175,n.y),r.width=e.width,this._topContiner.addChild(r);var l=BaseBitmap.create("public_icon4");l.setPosition(r.x-3,r.y),this._topContiner.addChild(l),this._soldierText=ComponentManager.getTextField(Api.playerVoApi.getSoldier().toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this._soldierText.setPosition(r.x+50,r.y+r.height/2-this._soldierText.height/2+2),this._topContiner.addChild(this._soldierText);var h=BaseBitmap.create("public_icon5");h.setPosition(e.x-3,e.y+49),this._topContiner.addChild(h),this._expProgress=ComponentManager.getProgressBar("progress4","progress7_bg",463),this._expProgress.setPosition(h.x+55,h.y+h.height/2-this._expProgress.height/2),this._expProgress.setTextSize(TextFieldConst.FONTSIZE_CONTENT_SMALL),this._topContiner.addChild(this._expProgress),this.resetExpProgress(),this.refreshUpgradeClip()},e.prototype.roleHeadClickHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.PLAYERVIEW)},e.prototype.resetExpProgress=function(){var t=Api.playerVoApi.getPlayerExp(),e=Api.playerVoApi.getNextLevelExp();this._expProgress.setText(LanguageManager.getlocal("playerview_exp")+t.toString()+"/"+e.toString()),this._expProgress.setPercentage(t/e),this._soldierText.text=Api.playerVoApi.getSoldier().toString()},e.prototype.attAllClickHandler=function(){return Api.playerVoApi.getSoldier()<=0?void App.CommonUtil.showTip(LanguageManager.getlocal("challengeCannotAtt")):Api.challengeVoApi.getIsBossChannel()?void App.CommonUtil.showTip(LanguageManager.getlocal("challengeAutoFightForbidden")):void ViewController.getInstance().openView(ViewConst.POPUP.CHALLENGEAUTOPOPUPVIEW,{f:this.callbackHandler,o:this})},e.prototype.callbackHandler=function(){this.resetExpProgress(),this._bigChannel=Api.challengeVoApi.getCurBigChannelId(),this._attackBtnTab[this._middleChannel-1].hiddenKnifeAnim(),this._middleChannel=Api.challengeVoApi.getCurMiddleChannelId();for(var t=0;6>t;t++)if(this._middleChannel-1==t?this._attackBtnTab[t].visible=!0:this._attackBtnTab[t].visible=!1,this._middleChannel-1>t)if(this._passIconTab[t])this._passIconTab[t].visible=!0;else{var e=this._attackBtnTab[t],i=BaseBitmap.create("challenge_pass");i.setPosition(e.x,e.y),this._middleContiner.addChild(i),this._passIconTab.push(i)}for(var t=0;5>t;t++)this._middleChannel-1>t&&(this._lineIconTab[t].visible=!0,this._middleChannel-2>t&&App.DisplayUtil.changeToGray(this._lineIconTab[t]));this._attackBtnTab[this._middleChannel-1].showClickable(),this.refreshUpgradeClip()},e.prototype.initMiddle=function(){this._middleContiner=new BaseDisplayObjectContainer,this._middleContiner.y=105,this._scrollContiner.addChild(this._middleContiner),this._scrollContiner.swapChildren(this._topContiner,this._middleContiner);var t=BaseBitmap.create(this.getMiddlePic());if(t.setPosition((GameConfig.stageWidth-t.width)/2,(GameConfig.stageHeigth-195-this._middleContiner.y-t.height)/2-20),this._middleContiner.addChild(t),Api.switchVoApi.checkAutoMopup())if(Api.playerVoApi.getPlayerVipLevel()<6){var e=ComponentManager.getTextField(LanguageManager.getlocal("challengeAutoFightTip"),TextFieldConst.FONTSIZE_CONTENT_COMMON);e.setPosition(GameConfig.stageWidth-e.width-20,GameConfig.stageHeigth-403-e.height/2);var i=BaseBitmap.create("public_itemtipbg");i.scaleX=-1,i.width=e.width+55,i.height=36,i.x=GameConfig.stageWidth,i.y=e.y-7,this._middleContiner.addChild(i),this._middleContiner.addChild(e)}else{var a=ComponentManager.getButton("btn_challenge_auto",null,this.attAllClickHandler,this);a.setPosition(GameConfig.stageWidth-a.width-20,GameConfig.stageHeigth-435-a.height/2),this._middleContiner.addChild(a)}for(var n=[[150,0],[376,90],[154,180],[380,270],[149,360],[377,450]],o=(Api.challengeVoApi.getCurChannelId(),Api.challengeVoApi.getCurMiddleChannelId()-1),s=GameConfig.stageHeigth/2-195+160,r=0;6>r;r++){if(4>=r){var l=BaseBitmap.create("challenge_arrow");l.anchorOffsetX=l.width/2,l.anchorOffsetY=l.height/2,l.x=n[r][0]/2+n[r+1][0]/2+65,l.y=s-n[r][1]/2-n[r+1][1]/2+65,r%2==1?(l.scaleX=-1,l.rotation=25):l.rotation=-25,r>o-1?l.visible=!1:o-1>r&&App.DisplayUtil.changeToGray(l),this._middleContiner.addChild(l),this._lineIconTab.push(l)}var h=new ChallengeButton;if(h.initButton(this.onClickAttack,this,r),h.setPosition(n[r][0],s-n[r][1]),this._attackBtnTab.push(h),this._middleContiner.addChild(h),o>r){var d=BaseBitmap.create("challenge_pass");d.setPosition(n[r][0],s-n[r][1]),this._middleContiner.addChild(d),this._passIconTab.push(d),h.visible=!1}}},e.prototype.initButtom=function(){this._buttomContiner=new BaseDisplayObjectContainer,this._buttomContiner.y=GameConfig.stageHeigth-195-this.getTitleButtomY(),this._scrollContiner.addChild(this._buttomContiner);var t=BaseBitmap.create("challenge_story_bg");this._buttomContiner.addChild(t);var e=BaseBitmap.create("public_line3");e.width=480,e.x=GameConfig.stageWidth/2-e.width/2,e.y=t.y+24,this._buttomContiner.addChild(e),this.titleTF.text=LanguageManager.getlocal(this.getTitleStr());var i=ComponentManager.getTextField(Api.challengeVoApi.getCurBigChannelId().toString()+". "+LanguageManager.getlocal(this.getTitleStr()),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_BLACK);i.setPosition(GameConfig.stageWidth/2-i.width/2,24),this._buttomContiner.addChild(i),this.titleTF.text=i.text,this.titleTF.x=GameConfig.stageWidth/2-this.titleTF.width/2;var a=ComponentManager.getTextField(LanguageManager.getlocal(this.getDescStr()),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);a.width=GameConfig.stageWidth-100,a.lineSpacing=6,this._buttomContiner.addChild(a),a.setPosition(50,56)},e.prototype.onClickAttack=function(){for(var t in this._attackBtnTab)this._attackBtnTab[t].visible=!1;for(var e in this._passIconTab)this._passIconTab[e].visible=!1;for(var i in this._lineIconTab)this._lineIconTab[i].visible=!1;var a=ChallengeCfg.getChallengeCfgById(Api.challengeVoApi.getCurChannelId());if(a.dialogue){var n=LocalStorageConst.LOCAL_CHALLENGE_STORY+"_cId_"+Api.challengeVoApi.getCurChannelId()+"_zId_"+GameData.curZoneID+"_pId_"+Api.playerVoApi.getPlayerID(),o=LocalStorageManager.get(n);o?this.realAttackChannel():(ViewController.getInstance().openView(ViewConst.BASE.CHALLENGESTORY,{f:this.realAttackChannel,o:this,dialogue:a.dialogue}),LocalStorageManager.set(n,"1"))}else this.realAttackChannel()},e.prototype.realAttackChannel=function(){1==Api.challengeVoApi.getIsBossChannel()?ViewController.getInstance().openView(ViewConst.BATTLE.BOSSBATTLEVIEW,{f:this.refreshInfo,o:this}):ViewController.getInstance().openView(ViewConst.BATTLE.FIGHTVIEW,{f:this.refreshInfo,o:this})},e.prototype.refreshInfo=function(){if(null!=this._expProgress){var t=Api.challengeVoApi.getOpenViewMessage();if(t)return this.hide(),App.CommonUtil.showTip(t);this.resetExpProgress();for(var e=Api.challengeVoApi.getCurBigChannelId(),i=Api.challengeVoApi.getCurMiddleChannelId(),a=0;6>a;a++)this._middleChannel-1==a&&(this._attackBtnTab[a].visible=!0);for(var n in this._passIconTab)this._passIconTab[n].visible=!0;for(var a=0;5>a;a++)this._middleChannel-1>a&&(this._lineIconTab[a].visible=!0);this._bigChannel!=e?(this._middleContiner.dispose(),this._passIconTab.length=0,this._attackBtnTab.length=0,this._lineIconTab.length=0,this.initMiddle(),this._buttomContiner.dispose(),this.initButtom(),this._bigChannel=e,this._middleChannel=i):this._middleChannel!=i&&this.showPassAnim(),this.refreshUpgradeClip()}},e.prototype.showPassAnim=function(){var t=this._attackBtnTab[this._middleChannel-1];t.visible=!1;var e=this._lineIconTab[this._middleChannel-2];e&&App.DisplayUtil.changeToGray(e);var i=(BaseBitmap.create("channel_light"),BaseBitmap.create("challenge_pass")),a=egret.Point.create(t.x,t.y);i.scaleX=2,i.scaleY=2,i.setPosition(a.x-i.width/2,a.y-i.height/2),this._middleContiner.addChild(i),this._passIconTab.push(i),egret.Tween.get(i).to({x:a.x,y:a.y,scaleX:1,scaleY:1},800).call(this.setButtonStatus,this)},e.prototype.setButtonStatus=function(){var t=this._lineIconTab[this._middleChannel-1];t&&(t.visible=!0);var e=Api.challengeVoApi.getCurMiddleChannelId();this._attackBtnTab[this._middleChannel-1].hiddenKnifeAnim(),this._attackBtnTab[e-1].showClickable(),this._middleChannel=Api.challengeVoApi.getCurMiddleChannelId()},e.prototype.getButtomLineBg=function(){return null},e.prototype.refreshUpgradeClip=function(){var t=Api.playerVoApi.getPlayerLevel(),e=Config.LevelCfg.getCfgByLevel((t+1).toString());e&&Api.playerVoApi.getPlayerExp()>=e.exp?this._upgradeClip||(this._upgradeClip=ComponentManager.getCustomMovieClip("mainui_fg",10,100),this._upgradeClip.x=-16,this._upgradeClip.y=-18,this._circleHead.addChild(this._upgradeClip),this._circleHead.swapChildren(this._circleHead.getChildByName("myHead"),this._upgradeClip),this._upgradeClip.playWithTime(0)):this._upgradeClip&&(this._upgradeClip.stop(),this._circleHead.removeChild(this._upgradeClip),this._upgradeClip=null,this._officerIcon.text=Api.playerVoApi.getPlayerOffice())},e.prototype.refresh=function(){this.refreshInfo()},e.prototype.hide=function(){t.prototype.hide.call(this),Api.rookieVoApi.isInGuiding&&Api.rookieVoApi.checkNextStep()},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_RESCHANGE_REFRESH_UI,this.refresh,this),this._middleChannel=0,this._bigChannel=0;for(var e in this._attackBtnTab)this._attackBtnTab[e].dispose();this._attackBtnTab.length=0,this._soldierText=null,this._expProgress=null,this._scrollContiner=null,this._topContiner=null,this._middleContiner=null,this._buttomContiner=null,this._passIconTab.length=0,this._upgradeClip=null,this._circleHead=null,this._officerIcon=null,this._lineIconTab.length=0,t.prototype.dispose.call(this)},e}(CommonView);__reflect(ChallengeView.prototype,"ChallengeView");var ChatblockScrollItem=function(t){function e(){var e=t.call(this)||this;return e._blockData=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=GameConfig.stageWidth-30,this.height=146+this.getSpaceY(),this._blockData=e,this._itemIndex=t;var i=BaseBitmap.create("public_9_bg14");i.width=this.width,i.height=146,this.addChild(i);var a=e[4];this._nameTf=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN),this._nameTf.x=23,this._nameTf.y=15,this.addChild(this._nameTf);var n=BaseBitmap.create("public_line1");n.x=this.width/2-n.width/2,n.y=40,this.addChild(n);var o=new BaseDisplayObjectContainer;this.addChild(o),o.x=20,o.y=40;var s=BaseBitmap.create("public_chatheadbg");o.addChild(s);var r=egret.Rectangle.create();r.setTo(0,0,136,143);var l=BaseLoadBitmap.create(Api.playerVoApi.getUserHeadImgPathById(e[5]),r);l.x=0,l.y=-7,l.setScale(2/3),o.addChild(l);var h=LanguageManager.getlocal("allianceMemberInfo1",[e[3]]),d=ComponentManager.getTextField(h,18,TextFieldConst.COLOR_BROWN);d.x=120,d.y=this._nameTf.y+this._nameTf.height+14,this.addChild(d);var g=LanguageManager.getlocal("allianceMemberInfo2",[Api.playerVoApi.getPlayerOfficeByLevel(e[2])]),c=ComponentManager.getTextField(g,18,TextFieldConst.COLOR_BROWN);c.x=120,c.y=d.y+d.height+7,this.addChild(c);var p=LanguageManager.getlocal("chatblockAlliance",[e[6]]),_=ComponentManager.getTextField(p,18,TextFieldConst.COLOR_BROWN);_.x=120,_.y=c.y+c.height+7,this.addChild(_);var u=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"chatCancelShield",this.cancelBlock,this);u.x=450,u.y=65,this.addChild(u),u.setColor(TextFieldConst.COLOR_BLACK)},e.prototype.userShotCallback=function(t){var e=t.data.data.data;ViewController.getInstance().openView(ViewConst.POPUP.RANKUSERINGOPOPUPVIEW,e),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_USERSHOT),this.userShotCallback,this)},e.prototype.cancelBlock=function(){var t=(100*Config.AlliancebaseCfg.reduceContribution+"%",LanguageManager.getlocal("chatCancelBlockDesc",[this._blockData[4]]));ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"chatCancelShield",msg:t,callback:this.doShield,handler:this,needCancel:!0})},e.prototype.doShield=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_CANCEBLOCK,{uid:this._blockData[0],name:this._blockData[4]})},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._blockData=null,this._itemIndex=null,this._nameTf=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ChatblockScrollItem.prototype,"ChatblockScrollItem");var ChatblockView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){NetManager.chat.checkAndReConnect();var t=BaseBitmap.create("public_9_bg23");t.width=GameConfig.stageWidth,t.height=GameConfig.stageHeigth-160,t.x=0,t.y=-10,this.addChildToContainer(t),App.MessageHelper.addEventListener(MessageConst.MESSAGE_MESSAGE_ALLIANCE_BEKICK,this.doQuickAlliance,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_CANCEBLOCK,this.doCancel,this);var e=egret.Rectangle.create();e.setTo(0,0,GameConfig.stageWidth-30,GameConfig.stageHeigth-180),this._scrollList=ComponentManager.getScrollList(ChatblockScrollItem,this._dataList,e),this._scrollList.setEmptyTip(LanguageManager.getlocal("chatblockNoBlock")),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(15,2);var i=0;Api.chatVoApi.getChatBlockVo().info&&(i=Api.chatVoApi.getChatBlockVo().info.length,i||(i=0));var a=LanguageManager.getlocal("chatblockCount",[i+"/50"]);this._countTF=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_COMMON),this._countTF.x=this.width/2-this._countTF.width/2,this._countTF.y=t.y+t.height+15,this.addChildToContainer(this._countTF)},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_CHAT_LIST,requestData:{}}},e.prototype.receiveData=function(t){if(t.data.cmd==NetRequestConst.REQUEST_CHAT_LIST)this._dataList=t.data.data.list;else if(t.data.cmd==NetRequestConst.REQUEST_CHAT_UNBLOCK){this._dataList=t.data.data.list,this._scrollList.refreshData(this._dataList),App.CommonUtil.showTip(LanguageManager.getlocal("chatCancelBlockTip",[this._pName]));var e=0;Api.chatVoApi.getChatBlockVo().info&&(e=Api.chatVoApi.getChatBlockVo().info.length);var i=LanguageManager.getlocal("chatblockCount",[e+"/50"]);this._countTF.text=i}},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["servant_bottombg","wifeview_bottombg","shield_cn"])},e.prototype.checkTabCondition=function(t){return 1==t&&0==Api.playerVoApi.getPlayerAllianceId()?(App.CommonUtil.showTip(LanguageManager.getlocal("allianceNoAlliance")),!1):!0},e.prototype.doCancel=function(t){var e=t.data;this._pName=t.data.name,this.request(NetRequestConst.REQUEST_CHAT_UNBLOCK,{fuid:e.uid})},e.prototype.doQuickAlliance=function(){this.hide(),App.CommonUtil.showTip(LanguageManager.getlocal("alliance_beKick"))},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_MESSAGE_ALLIANCE_BEKICK,this.doQuickAlliance,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_DINNER_GUIDE,this.doCancel,this),this._scrollList=null,this._dataList=null,this._pName=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(ChatblockView.prototype,"ChatblockView");var ChatScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=590,this._chatData=e,this._posContainer=new BaseDisplayObjectContainer;var i="public_chatheadbg";e.content.headBg&&Api.switchVoApi.checkVip1Privilege()&&(i=e.content.headBg);var a=BaseBitmap.create(i);this._posContainer.addChild(a),this.addChild(this._posContainer),this._posContainer.addTouch(this.eventHandler,this,null);var n=egret.Rectangle.create();n.setTo(0,0,136,143);var o=BaseLoadBitmap.create(Api.playerVoApi.getUserHeadImgPathById(e.content.pic),n);o.x=0,o.y=-7,o.setScale(2/3),this._posContainer.addChild(o);var s="public_chatbg3";e.sender==Api.playerVoApi.getPlayerID()&&(s="public_chatbg2");var r=BaseBitmap.create(s);r.width=404,r.x=98,r.y=40,this.addChild(r);var l="<font u ='true'>"+e.sendername+"</font>";this._userName=ComponentManager.getTextField(l,TextFieldConst.FONTSIZE_TITLE_SMALL),this._userName.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,this._userName.x=r.x+10,this._userName.y=10,this.addChild(this._userName),this._userName.addTouchTap(this.showUserInfo,this,null);var h,d=0;e.content.vip&&e.content.vip>0&&!PlatformManager.checkIsKRSp()&&(h=BaseLoadBitmap.create(Api.vipVoApi.getVipCfgByLevel(e.content.vip).icon),h.setScale(.65),h.x=this._userName.x+this._userName.width+10,h.y=this._userName.y,this.addChild(h),d=73);var g;e.content.title&&e.content.title>0&&(g=BaseLoadBitmap.create("user_title_"+e.content.title+"_3"),g.x=this._userName.x+this._userName.width+d-15,g.y=this._userName.y+this._userName.height/2-33,this.addChild(g),d=d+110+5);var c=GameData.serverTime-e.ts,p=ComponentManager.getTextField(App.DateUtil.getFormatBySecond(c,4),TextFieldConst.FONTSIZE_TITLE_SMALL);p.textColor=TextFieldConst.COLOR_BROWN,p.x=this.width-p.width-5,p.y=this._userName.y,this.addChild(p);var _=ComponentManager.getTextField(e.content.message,TextFieldConst.FONTSIZE_TITLE_SMALL);_.textColor=TextFieldConst.COLOR_BLACK,_.x=r.x+20,_.y=r.y+12,this.addChild(_),_.width>370&&(_.width=370);var u=_.height+20;50>u?(r.width=_.width+30,r.height=47):(r.width=404,r.height=_.height+20),e.sender==Api.playerVoApi.getPlayerID()&&(this._posContainer.x=this.width-this._posContainer.width,r.skewY=180,r.x=this._posContainer.x-12,this._userName.x=r.x-this._userName.width-8,h&&(h.x=this._userName.x-68-10),g&&(h?g.x=this._userName.x-d-25:g.x=this._userName.x-110-25),p.x=5,_.x=r.x-_.width-20),this.cacheAsBitmap=!0},e.prototype.userShotCallback=function(t){var e=t.data.data.data;Api.switchVoApi.checkOpenShenhe()||ViewController.getInstance().openView(ViewConst.POPUP.RANKUSERINGOPOPUPVIEW,e),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_USERSHOT),this.userShotCallback,this)},e.prototype.showUserInfo=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_USERSHOT),this.userShotCallback,this),NetManager.request(NetRequestConst.REQUEST_RANK_USERSHOT,{ruid:this._chatData.sender})},e.prototype.eventHandler=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this.showUserInfo();break;case egret.TouchEvent.TOUCH_CANCEL:break;case egret.TouchEvent.TOUCH_END:}},e.prototype.getSpaceY=function(){return 0},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_USERSHOT),this.userShotCallback,this),this.cacheAsBitmap=!0,this._userName.removeTouchTap(),this._userName=null,this._posContainer.removeTouch(),this._posContainer=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ChatScrollItem.prototype,"ChatScrollItem");var ChatView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){NetManager.chat.checkAndReConnect();var t=BaseBitmap.create("servant_bottombg");t.width=GameConfig.stageWidth+14,t.height=GameConfig.stageHeigth-150,t.x=-7,t.y=-70,this.addChildToContainer(t),App.MessageHelper.addEventListener(MessageConst.MESSAGE_MESSAGE_ALLIANCE_BEKICK,this.doQuickAlliance,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_DINNER_GUIDE,this.doDinnerGuide,this)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["servant_bottombg","wifeview_bottombg","shield_cn"])},e.prototype.getTabbarTextArr=function(){var t=["chatViewTab1Title"];return Api.switchVoApi.checkOpenShenhe()||t.push("chatViewTab2Title"),t},e.prototype.checkTabCondition=function(t){return 1==t&&0==Api.playerVoApi.getPlayerAllianceId()?(App.CommonUtil.showTip(LanguageManager.getlocal("allianceNoAlliance")),!1):!0},e.prototype.doDinnerGuide=function(){this.hide()},e.prototype.doQuickAlliance=function(){this.hide(),App.CommonUtil.showTip(LanguageManager.getlocal("alliance_beKick"))},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_MESSAGE_ALLIANCE_BEKICK,this.doQuickAlliance,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_DINNER_GUIDE,this.doDinnerGuide,this),t.prototype.dispose.call(this)},e}(CommonView);__reflect(ChatView.prototype,"ChatView");var ChatViewTab1=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_CHAT_COME,this.refreshChat,this);var t=Api.chatVoApi.getWorldList(),e=BaseBitmap.create("wifeview_bottombg");e.width=GameConfig.stageWidth,e.height=96,e.x=0,e.y=GameConfig.stageHeigth-240,this.addChild(e);var i=BaseBitmap.create("public_9_bg32");i.width=GameConfig.stageWidth-30,i.height=GameConfig.stageHeigth-260,i.x=15,i.y=12,this.addChild(i);var a=egret.Rectangle.create();a.setTo(0,0,GameConfig.stageWidth-50,GameConfig.stageHeigth-263),this._scrollList=ComponentManager.getScrollList(ChatScrollItem,t,a),this._scrollList.setEmptyTip(LanguageManager.getlocal("chatNoData")),this.addChild(this._scrollList),this._scrollList.setPosition(25,12),t.length>0&&this._scrollList.setScrollTopByIndex(t.length-1);var n=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,468,48,"public_chatinputbg",LanguageManager.getlocal("chatMaxLength"),10785151);n.x=15,n.y=e.y+e.height/2-n.height/2,this.addChild(n),this._inputTextField=n.getChildByName("textField"),this._inputTextField.maxChars=40;var o=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"chatViewSend",this.sentBtnClick,this);o.x=n.x+n.width+10,o.y=e.y+e.height/2-o.height/2,o.setColor(TextFieldConst.COLOR_BLACK),Api.switchVoApi.checkVip1Privilege()?Api.playerVoApi.getPlayerLevel()<GameData.chatlevel&&Api.playerVoApi.getPlayerVipLevel()<1&&App.DisplayUtil.changeToGray(o):Api.playerVoApi.getPlayerLevel()<GameData.chatlevel&&App.DisplayUtil.changeToGray(o),this.addChild(o)
},e.prototype.refreshChat=function(){var t=Api.chatVoApi.getWorldList();this._scrollList.refreshData(t),this._scrollList.setScrollTopByIndex(t.length-1)},e.prototype.sentBtnClick=function(){if(Api.otherInfoVoApi.getBanet()-GameData.serverTime>0)return void App.CommonUtil.showTip(LanguageManager.getlocal("chatBanet",[App.DateUtil.getFormatBySecond(Api.otherInfoVoApi.getBanet(),2)]));if(Api.switchVoApi.checkVip1Privilege()){if(Api.playerVoApi.getPlayerLevel()<GameData.chatlevel&&Api.playerVoApi.getPlayerVipLevel()<1)return void App.CommonUtil.showTip(LanguageManager.getlocal("reachLvelUnlockDesc2",[Api.playerVoApi.getPlayerOfficeByLevel(GameData.chatlevel)]))}else if(Api.playerVoApi.getPlayerLevel()<GameData.chatlevel)return void App.CommonUtil.showTip(LanguageManager.getlocal("reachLvelUnlockDesc",[Api.playerVoApi.getPlayerOfficeByLevel(GameData.chatlevel)]));if(!this._inputTextField.bindData)return void App.CommonUtil.showTip(LanguageManager.getlocal("chatInputTip"));if(this._inputTextField.text.length<=0)return void App.CommonUtil.showTip(LanguageManager.getlocal("chatInputTip"));if(GameData.serverTime-Api.chatVoApi._lastTime<5){var t=String(Api.chatVoApi._lastTime-GameData.serverTime+5);return void App.CommonUtil.showTip(LanguageManager.getlocal("chatTimeTip",[t]))}if(0==Config.ShieldCfg.checkShield(this._inputTextField.text))return void App.CommonUtil.showTip(LanguageManager.getlocal("chatShieldTip"));if(App.StringUtil.checkChar(this._inputTextField.text))return void App.CommonUtil.showTip(LanguageManager.getlocal("chatShieldTip"));Api.chatVoApi._lastTime=GameData.serverTime;var e=this._inputTextField.text,i={};i.channel=1,i.message=e,this._inputTextField.text="",NetManager.requestChat(i)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_CHAT_COME,this.refreshChat,this),t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(ChatViewTab1.prototype,"ChatViewTab1");var ChatViewTab2=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_CHAT_COME,this.refreshChat,this);var t=Api.chatVoApi.getAllianceList(),e=BaseBitmap.create("wifeview_bottombg");e.width=GameConfig.stageWidth,e.height=96,e.x=0,e.y=GameConfig.stageHeigth-240,this.addChild(e);var i=BaseBitmap.create("public_9_bg32");i.width=GameConfig.stageWidth-30,i.height=GameConfig.stageHeigth-260,i.x=15,i.y=12,this.addChild(i);var a=egret.Rectangle.create();a.setTo(0,0,GameConfig.stageWidth-50,GameConfig.stageHeigth-263),this._scrollList=ComponentManager.getScrollList(ChatScrollItem,t,a),this.addChild(this._scrollList),this._scrollList.setPosition(25,12),this._scrollList.setEmptyTip(LanguageManager.getlocal("chatNoData")),t.length>0&&this._scrollList.setScrollTopByIndex(t.length-1);var n=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,468,48,"public_chatinputbg",LanguageManager.getlocal("chatMaxLength"),10785151);n.x=15,n.y=e.y+e.height/2-n.height/2,this.addChild(n),this._inputTextField=n.getChildByName("textField"),this._inputTextField.maxChars=40;var o=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"chatViewSend",this.sentBtnClick,this);o.x=n.x+n.width+10,o.y=e.y+e.height/2-o.height/2,o.setColor(TextFieldConst.COLOR_BLACK),this.addChild(o),Api.switchVoApi.checkVip1Privilege()?Api.playerVoApi.getPlayerLevel()<GameData.chatlevel&&Api.playerVoApi.getPlayerVipLevel()<1&&App.DisplayUtil.changeToGray(o):Api.playerVoApi.getPlayerLevel()<GameData.chatlevel&&App.DisplayUtil.changeToGray(o)},e.prototype.refreshChat=function(){var t=Api.chatVoApi.getAllianceList();this._scrollList.refreshData(t),this._scrollList.setScrollTopByIndex(t.length-1)},e.prototype.sentBtnClick=function(){if(Api.switchVoApi.checkVip1Privilege()){if(Api.playerVoApi.getPlayerLevel()<GameData.chatlevel&&Api.playerVoApi.getPlayerVipLevel()<1)return void App.CommonUtil.showTip(LanguageManager.getlocal("reachLvelUnlockDesc2",[Api.playerVoApi.getPlayerOfficeByLevel(GameData.chatlevel)]))}else if(Api.playerVoApi.getPlayerLevel()<GameData.chatlevel)return void App.CommonUtil.showTip(LanguageManager.getlocal("reachLvelUnlockDesc",[Api.playerVoApi.getPlayerOfficeByLevel(GameData.chatlevel)]));if(!this._inputTextField.bindData)return void App.CommonUtil.showTip(LanguageManager.getlocal("chatInputTip"));if(this._inputTextField.text.length<=0)return void App.CommonUtil.showTip(LanguageManager.getlocal("chatInputTip"));if(GameData.serverTime-Api.chatVoApi._lastTime<5){var t=String(Api.chatVoApi._lastTime-GameData.serverTime+5);return void App.CommonUtil.showTip(LanguageManager.getlocal("chatTimeTip",[t]))}if(Api.chatVoApi._lastTime=GameData.serverTime,0==Config.ShieldCfg.checkShield(this._inputTextField.text))return void App.CommonUtil.showTip(LanguageManager.getlocal("chatShieldTip"));if(App.StringUtil.checkChar(this._inputTextField.text))return void App.CommonUtil.showTip(LanguageManager.getlocal("chatShieldTip"));var e=this._inputTextField.text,i={};i.channel=Api.playerVoApi.getPlayerAllianceId(),i.message=e,this._inputTextField.text="",NetManager.requestChat(i)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_CHAT_COME,this.refreshChat,this),t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(ChatViewTab2.prototype,"ChatViewTab2");var ChildScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addTick,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeTick,this),this.width=295,this.height=133+this.getSpaceY();var i=Api.childVoApi.getChildrenVoList(),a=Api.childVoApi.getChildPosNum(),n=1;if(n=e+1<=i.length?1:e+1>i.length&&a>=e+1?2:3,1==n){var o=i[e];this._itemBg=BaseBitmap.create("childview_bg1"),this._itemBg.width=this.width,this._itemBg.height=this.height,this._itemBg.x=this.width/2-this._itemBg.width/2,this._itemBg.y=this.height/2-this._itemBg.height/2,this._itemBg.name="bg1",this.addChild(this._itemBg);var s=BaseBitmap.create("childview_itembg");s.x=10,s.y=12,s.name="bg2",this.addChild(s),this._child_Icon=BaseLoadBitmap.create(Api.childVoApi.getChildPic(o.id)),this._child_Icon.x=10,this._child_Icon.y=12,this._child_Icon.setScale(.4),this.addChild(this._child_Icon);var r=o.name,l=TextFieldConst.COLOR_BLACK;""==r&&(r=LanguageManager.getlocal("childNeedName"),l=TextFieldConst.COLOR_WARN_RED),this._nameTF=ComponentManager.getTextField(r,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._nameTF.textColor=l,this._nameTF.x=160,this._nameTF.y=17,this.addChild(this._nameTF);var h=LanguageManager.getlocal("child_sex",[LanguageManager.getlocal("child_boy")]);2==o.sex&&(h=LanguageManager.getlocal("child_sex",[LanguageManager.getlocal("child_girl")]));var d=ComponentManager.getTextField(h,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);d.x=this._nameTF.x,d.y=this._nameTF.y+this._nameTF.height+10,this.addChild(d);var g=GameConfig.config.childCfg[o.quality.toString()],c=LanguageManager.getlocal("servant_infoLv")+"："+ +o.level+"/"+g.lv;this._levelTF=ComponentManager.getTextField(c,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._levelTF.x=this._nameTF.x,this._levelTF.y=d.y+d.height+10,this.addChild(this._levelTF);var p=Api.childVoApi.getChildrenVigourById(o.id),_=Api.vipVoApi.getCurLevelVipCfg().maxVigour,u=LanguageManager.getlocal("childVigour")+"："+p+"/"+_;o.level>=g.lv&&(u=LanguageManager.getlocal("childWaitGrowup")),this._stateTF=ComponentManager.getTextField(u,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._stateTF.x=this._nameTF.x,this._stateTF.y=this._levelTF.y+this._levelTF.height+10,this.addChild(this._stateTF)}else if(2==n){this._itemBg=BaseBitmap.create("childview_bg1"),this._itemBg.width=this.width,this._itemBg.height=this.height-5,this._itemBg.x=this.width/2-this._itemBg.width/2,this._itemBg.y=this.height/2-this._itemBg.height/2,this.addChild(this._itemBg);var s=BaseBitmap.create("childview_itembg");s.x=10,s.y=12,s.name="bg2",this.addChild(s);var C=ComponentManager.getTextField(LanguageManager.getlocal("childItemPosIdle"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);C.x=200,C.y=this.height/2-C.height/2,this.addChild(C)}else{this._itemBg=BaseBitmap.create("childview_bg2"),this._itemBg.width=this.width,this._itemBg.height=this.height-10,this._itemBg.x=this.width/2-this._itemBg.width/2,this._itemBg.y=this.height/2-this._itemBg.height/2,this.addChild(this._itemBg);var f=BaseBitmap.create("childview_addicon");f.x=this.width/2-f.width/2,f.y=this.height/2-f.height/2,this.addChild(f),this._itemBg.addTouch(this.eventHandler,this,null)}},e.prototype.eventHandler=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:break;case egret.TouchEvent.TOUCH_CANCEL:break;case egret.TouchEvent.TOUCH_END:}},e.prototype.refreshData=function(t){this._childIndex=t;var e=Api.childVoApi.getChildrenVoList(),i=e[t],a=i.name,n=TextFieldConst.COLOR_BLACK;""==a&&(a=LanguageManager.getlocal("childNeedName"),n=TextFieldConst.COLOR_QUALITY_ORANGE),this._nameTF.textColor=n,this._nameTF.text=a;var o=GameConfig.config.childCfg[i.quality.toString()],s=LanguageManager.getlocal("servant_infoLv")+"："+i.level+"/"+o.lv;this._levelTF.text=s;var r=Api.childVoApi.getChildrenVigourById(i.id),l=Api.vipVoApi.getCurLevelVipCfg().maxVigour,h=LanguageManager.getlocal("childVigour")+"："+r+"/"+l;i.level>=o.lv&&(h=LanguageManager.getlocal("childWaitGrowup")),this._stateTF.text=h,this._child_Icon.setload(Api.childVoApi.getChildPic(i.id))},e.prototype.tick=function(){if(this.parent){var t=Api.childVoApi.getChildrenVoList(),e=t[this._childIndex];if(e){var i=Api.childVoApi.getChildrenVoList(),a=i[this._childIndex],n=Api.childVoApi.getChildrenVigourById(a.id),o=Api.vipVoApi.getCurLevelVipCfg().maxVigour,s=LanguageManager.getlocal("childVigour")+"："+n+"/"+o,r=GameConfig.config.childCfg[a.quality.toString()];a.level>=r.lv&&(s=LanguageManager.getlocal("childWaitGrowup")),this._stateTF.text=s}}},e.prototype.addTick=function(){TickManager.addTick(this.tick,this)},e.prototype.removeTick=function(){TickManager.removeTick(this.tick,this)},e.prototype.getSpaceX=function(){return 5},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._nameTF=null,this._levelTF=null,this._stateTF=null,this._childIndex=null,this._child_Icon=null,this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addTick,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeTick,this),this._itemBg.removeTouch(),this._itemBg=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ChildScrollItem.prototype,"ChildScrollItem");var ChildUpdView=function(t){function e(){var e=t.call(this)||this;return e._childId=null,e}return __extends(e,t),e.prototype.getResourceList=function(){var e=t.prototype.getResourceList.call(this);return this.param.data&&(this._childId=this.param.data),e.concat(["adult_updtitle","childview_getgirl"])},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getBgName=function(){return"public_9_bg8"},e.prototype.initView=function(){0==Api.adultVoApi.getAdultMarryNum()&&1==Api.adultVoApi.getAdultNum()&&(Api.rookieVoApi.curGuideKey="adult",Api.rookieVoApi.insertWaitingGuide({idx:"adult_1"},!0)),this.addTouchTap(this.touchTap,this,null),this.viewBg.touchEnabled=!0,SoundManager.playEffect(SoundConst.EFFECT_UPD);var t=this._childId,e=Api.adultVoApi.getAdultInfoVoById(t),i=BaseBitmap.create("public_rotatelight");i.scaleX=2,i.scaleY=2,i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.setPosition(GameConfig.stageWidth/2,GameConfig.stageHeigth/2),this.addChild(i),egret.Tween.get(i,{loop:!0}).to({rotation:360},3e3);var a=Api.adultVoApi.getAdultPic(t),n=BaseBitmap.create("adult_updtitle");n.setPosition(170,i.y-400),this.addChild(n);var o=BaseBitmap.create(a);o.setPosition(GameConfig.stageWidth/2-o.width/2,n.y+n.height+30),this.addChild(o);var s=BaseBitmap.create("public_get_namebg");s.x=o.x-s.width-20,s.y=o.y,this.addChild(s);var r=BaseBitmap.create("adult_q"+e.aquality);r.x=s.x+s.width/2-r.width/2,r.y=s.y+45,this.addChild(r);var l=BaseBitmap.create("public_9_wordbg");l.height=300,l.setPosition(GameConfig.stageWidth/2-l.width/2,o.y+o.height),this.addChild(l);var h=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_TITLE_SMALL);h.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,h.setPosition(265,l.y+40),this.addChild(h);var d=Api.wifeVoApi.getWifeInfoVoById(e.motherId),g=LanguageManager.getlocal("childMother",[d.name]),c=ComponentManager.getTextField(g,TextFieldConst.FONTSIZE_CONTENT_COMMON);c.setPosition(h.x,h.y+h.height+10),this.addChild(c);var p=LanguageManager.getlocal("servant_infoAttr")+e.attrVo.attTotal,_=ComponentManager.getTextField(p,TextFieldConst.FONTSIZE_CONTENT_COMMON);_.setPosition(h.x,c.y+c.height+10),this.addChild(_);var u=LanguageManager.getlocal("servantInfo_speciality1")+"："+e.attrVo.forceTotal,C=ComponentManager.getTextField(u,TextFieldConst.FONTSIZE_CONTENT_COMMON);C.setPosition(h.x,_.y+_.height+10),this.addChild(C);var f=LanguageManager.getlocal("servantInfo_speciality2")+"："+e.attrVo.brainsTotal,m=ComponentManager.getTextField(f,TextFieldConst.FONTSIZE_CONTENT_COMMON);m.setPosition(h.x,C.y+C.height+10),this.addChild(m);var T=LanguageManager.getlocal("servantInfo_speciality3")+"："+e.attrVo.politicsTotal,y=ComponentManager.getTextField(T,TextFieldConst.FONTSIZE_CONTENT_COMMON);y.setPosition(h.x,m.y+m.height+10),this.addChild(y);var v=LanguageManager.getlocal("servantInfo_speciality4")+"："+e.attrVo.charmTotal,A=ComponentManager.getTextField(v,TextFieldConst.FONTSIZE_CONTENT_COMMON);A.setPosition(h.x,y.y+y.height+10),this.addChild(A)},e.prototype.sureBtnClick=function(){ViewController.getInstance().hideAllView(),this._childId=this.param.data,ViewController.getInstance().openView(ViewConst.COMMON.CHILDVIEW,{childId:this._childId})},e.prototype.noBtnClick=function(){this.hide()},e.prototype.touchTap=function(){this.hide()},e.prototype.dispose=function(){this._childId=null,t.prototype.dispose.call(this)},e}(BaseView);__reflect(ChildUpdView.prototype,"ChildUpdView");var ChildView=function(t){function e(){var e=t.call(this)||this;return e._childId=null,e._childInfoObj=null,e._proTxtList=null,e._childProCfg=null,e._curLevel=0,e}return __extends(e,t),e.prototype.initView=function(){Api.rookieVoApi.checkNextStep();var t=BaseBitmap.create("childview_newbg");t.x=this.viewBg.width/2-t.width/2,t.y=-17,this.addChildToContainer(t);var e=BaseBitmap.create("servant_downbg");if(e.x=0,e.y=320,this.addChildToContainer(e),this._reachText=ComponentManager.getTextField(LanguageManager.getlocal("childUnlockDesc",[egret.toColorString(TextFieldConst.COLOR_QUALITY_ORANGE),"5",egret.toColorString(TextFieldConst.COLOR_QUALITY_GREEN)]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._reachText.setPosition(20,GameConfig.stageHeigth-this.container.y-this._reachText.height-30),this.addChildToContainer(this._reachText),this._childItemText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this._childItemText.setPosition(480,GameConfig.stageHeigth-this.container.y-this._reachText.height-25),this.addChildToContainer(this._childItemText),Api.childVoApi.getChildNum()>0){this._childContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._childContainer),this._child_wordbg=BaseBitmap.create("public_9_bg25"),this._child_wordbg.visible=!1,this._child_wordbg.x=420,this._child_wordbg.y=20,this._child_wordbg.width=210,this._child_wordbg.height=78,this._childContainer.addChild(this._child_wordbg),this._child_wordbgCor=BaseBitmap.create("public_9_bg25_tail"),this._child_wordbgCor.x=480,this._child_wordbgCor.y=this._child_wordbg.y+this._child_wordbg.height-3,this._childContainer.addChild(this._child_wordbgCor),this._childWordsText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK),this._childWordsText.text=LanguageManager.getlocal("childIntimacyDesc"),this._childWordsText.x=this._child_wordbg.x+20,this._childWordsText.y=this._child_wordbg.y+20,this._childWordsText.width=190,this._childWordsText.height=80,this._childContainer.addChild(this._childWordsText),this._child_Icon=BaseLoadBitmap.create(""),this._child_Icon.x=140,this._child_Icon.y=this._child_wordbgCor.y-60,this._childContainer.addChild(this._child_Icon);var i=BaseBitmap.create("servant_levebg");i.x=5,i.y=e.y,this._childContainer.addChild(i);var a=BaseBitmap.create("servant_attributemap");if(a.x=180,a.y=270,this._childContainer.addChild(a),this._childVigourText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_WARN_GREEN),this._childVigourText.text=LanguageManager.getlocal("childVigour"),this._childVigourText.x=500,this._childVigourText.y=e.y+30-this._childVigourText.height/2,this._childContainer.addChild(this._childVigourText),this._progressBar=ComponentManager.getProgressBar("progress3","progress3_bg",460),this._progressBar.x=10,this._progressBar.y=e.y+85,this._childContainer.addChild(this._progressBar),this._levelTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this._levelTxt.text=LanguageManager.getlocal("servant_infoLv"),this._levelTxt.x=this._progressBar.x+this._progressBar.width/2-this._levelTxt.width/2,this._levelTxt.y=this._progressBar.y+this._progressBar.height/2-this._levelTxt.height/2,this._childContainer.addChild(this._levelTxt),this._vigouTimeText=ComponentManager.getTextField("00:00:00",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._vigouTimeText.x=510,this._vigouTimeText.y=e.y+30-this._vigouTimeText.height/2,this._childContainer.addChild(this._vigouTimeText),this._proTxtList=[],this._childInfoVo=Api.childVoApi.getChildrenVoList()[0],this._childInfoVoList=Api.childVoApi.getChildrenVoList(),this._motherText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._motherText.x=5,this._motherText.y=-9,this._childContainer.addChild(this._motherText),this._intimacyText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._intimacyText.x=170,this._intimacyText.y=this._motherText.y,this._childContainer.addChild(this._intimacyText),Api.switchVoApi.checkOpenWifeStatus()){var n=Api.wifestatusVoApi.getWifestatusVo(),o=Config.WifestatusbaseCfg.starEffect,s=LanguageManager.getlocal("wifeStatusChildAdd",[String(n.star*o)]),r=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);r.x=360,r.y=this._motherText.y,this._childContainer.addChild(r)}this._nameBg=BaseBitmap.create("childview_namebg1"),this._nameBg.x=30,this._nameBg.y=40,this._childContainer.addChild(this._nameBg),this._childNameText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW),this._childNameText.text="",this._childNameText.width=27,this._childNameText.x=this._nameBg.x+this._nameBg.width/2-this._childNameText.width/2+3,this._childNameText.y=this._nameBg.y+125-this._childNameText.height/2,this._childContainer.addChild(this._childNameText),this._childNameText.addTouchTap(this.changeNameHandler,this,null);var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);l.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,l.text=LanguageManager.getlocal("servant_infoLv"),l.x=22,l.y=i.y+5,this._childContainer.addChild(l);for(var h=0;4>h;h++){var d=BaseBitmap.create("servant_attribute"+(h+1)),g=h%2;d.x=90+180*g,d.y=335+32*Math.floor(h/2),this._childContainer.addChild(d)}this._childProCfg=[{txt:this.getProStringWithProId(1),txtId:1},{txt:this.getProStringWithProId(2),txtId:2},{txt:this.getProStringWithProId(3),txtId:3},{txt:this.getProStringWithProId(4),txtId:4},{txt:this.getProStringWithProId(5),txtId:5},{txt:this.getProStringWithProId(6),txtId:6}];for(var c=0;c<this._childProCfg.length;c++){var p=this._childProCfg[c],_=ComponentManager.getTextField("",22,p.txtcolor);1==c?_.text=p.txt:_.text=this.getProStringWithProId(p.txtId),1==p.txtId&&(_.x=5,_.y=350,_.width=80,_.textAlign="center",_.size=42,_.textColor=TextFieldConst.COLOR_LIGHT_YELLOW),2==p.txtId&&(_.x=210,_.y=282,_.width=190,_.size=26,_.textAlign="center",_.textColor=TextFieldConst.COLOR_LIGHT_YELLOW),3==p.txtId&&(_.x=160,_.y=338,_.size=24,_.textColor=TextFieldConst.COLOR_WHITE),4==p.txtId&&(_.x=340,_.y=338,_.size=24,_.textColor=TextFieldConst.COLOR_WHITE),5==p.txtId&&(_.x=160,_.y=372,_.size=24,_.textColor=TextFieldConst.COLOR_WHITE),6==p.txtId&&(_.x=340,_.y=372,_.size=24,_.textColor=TextFieldConst.COLOR_WHITE),7==p.txtId&&(_.x=340,_.y=395,_.size=24,_.textColor=TextFieldConst.COLOR_WHITE),this._childContainer.addChild(_),this._proTxtList.push(_)}}var u=BaseBitmap.create("public_9_bg22");u.height=GameConfig.stageHeigth-this.container.y-t.height-170,u.x=0,u.y=GameConfig.stageHeigth-this.container.y-u.height-70,this.addChildToContainer(u);for(var C=Api.childVoApi.getChildPosNum()+1,f=new Array,c=0;C>c;c++)f.push(c);var m=egret.Rectangle.create();if(m.setTo(0,0,GameConfig.stageWidth-46,u.height-55),this._scrollList=ComponentManager.getScrollList(ChildScrollItem,f,m),this.addChildToContainer(this._scrollList),this._scrollList.x=u.x+u.width/2-this._scrollList.width/2,this._scrollList.y=u.y+u.height/2-this._scrollList.height/2,this._scrollList.addTouchTap(this.clickItemHandler,this),this.param&&this.param.data.childId){if(this.param.data.childId){var T=Api.childVoApi.getChildIndexVoById(this.param.data.childId);this._scrollList.setScrollTopByIndex(T,0);var y=this._childInfoVoList[T],v=y.id;this._childInfoVo=y,this.updChildAttData(y),this.setSelect(v),SoundManager.playEffect(SoundConst.EFFECT_GETCHILD)}}else if(Api.childVoApi.getChildNum()>0){var y=this._childInfoVoList[0],v=y.id;this._childInfoVo=y,this.updChildAttData(y);var T=Api.childVoApi.getChildIndexVoById(v);this.setSelect(v),this.playChildEffect(y)}this.refreshChildPos()},e.prototype.playChildEffect=function(t){var e=[SoundConst.EFFECT_DAUGHTER_3AGE,SoundConst.EFFECT_DAUGHTER_8AGE],i=[SoundConst.EFFECT_SON_3AGE,SoundConst.EFFECT_SON_8AGE],a=App.MathUtil.getRandom(0,2),n=GameConfig.config.childCfg[t.quality.toString()],o=t.level/n.lv;.4>o?SoundManager.playEffect(SoundConst.EFFECT_GETCHILD):o>=.4&&1>o&&(1==t.sex?SoundManager.playEffect(i[a]):SoundManager.playEffect(e[a]))},e.prototype.clickItemHandler=function(t){var e=Number(t.data);if(this.tick(),this._childInfoVoList){var i=this._childInfoVoList[e];if(i){var a=i.id;this._childInfoVo=i,this.updChildAttData(i),this.setSelect(a)}}var n=Api.childVoApi.getChildPosNum();if(e==n){if(n>=Config.ChildbaseCfg.maxPos)return void App.CommonUtil.showTip(LanguageManager.getlocal("childPosNumMax"));var o=Api.playerVoApi.getPlayerGem(),s=Api.childVoApi.getAddPosNeedGem(),r=LanguageManager.getlocal("childExtendGem",[App.StringUtil.toString(s)]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{useNum:s,confirmCallback:this.addChildPos,handler:this,icon:"itemicon1",iconBg:"itembg_1",num:o,msg:r,id:1})}},e.prototype.addChildPos=function(){this.request(NetRequestConst.REQUEST_CHILD_ADDPOSNUM,null)},e.prototype.setSelect=function(t){var e=Api.childVoApi.getChildIndexVoById(t);if(this._childScrollItem&&this._childScrollItem.getChildByName("select")){this._childScrollItem.removeChild(this._childScrollItem.getChildByName("select"));var i=this._childScrollItem.getChildByName("select");i=null}this._childScrollItem=this._scrollList.getItemByIndex(e);var a=this._childScrollItem.getChildIndex(this._childScrollItem.getChildByName("bg2")),n=BaseBitmap.create("childview_bg3");n.width=this._childScrollItem.width,n.height=143,n.x=0,n.y=0,n.name="select",this._childScrollItem.addChildAt(n,a)},e.prototype.updChildAttData=function(t,e){this._childProCfg=[{txt:this.getProStringWithProId(1),txtId:1},{txt:this.getProStringWithProId(2),txtId:2},{txt:this.getProStringWithProId(3),txtId:3},{txt:this.getProStringWithProId(4),txtId:4},{txt:this.getProStringWithProId(5),txtId:25},{txt:this.getProStringWithProId(6),txtId:6}],this._child_Icon.setload(Api.childVoApi.getChildPic(t.id));var i=GameConfig.config.childCfg[t.quality.toString()];t.level==i.lv?(this._child_wordbg.visible=!1,this._child_wordbgCor.visible=!1,this._childWordsText.visible=!1):(this._childWordsText.text=Api.childVoApi.getChildWord(t.id),this._child_wordbg.visible=!0,this._child_wordbgCor.visible=!0,this._childWordsText.visible=!0);var a=Api.wifeVoApi.getWifeInfoVoById(t.motherId);this._motherText.text=LanguageManager.getlocal("childMother",[a.name]),this._intimacyText.text=LanguageManager.getlocal("childIntimacy",[a.intimacy.toString()]);var n=t.name;""==n&&(n=LanguageManager.getlocal("childNeedName")),this._childNameText.text=n,this._childNameText.x=this._nameBg.x+this._nameBg.width/2-this._childNameText.width/2+3,this._childNameText.y=this._nameBg.y+125-this._childNameText.height/2,1==t.sex?this._nameBg.texture=ResourceManager.getRes("childview_namebg1"):this._nameBg.texture=ResourceManager.getRes("childview_namebg2");var o=Api.childVoApi.getChildrenVigourById(t.id),s=Api.vipVoApi.getCurLevelVipCfg().maxVigour,r=LanguageManager.getlocal("childVigour")+"："+o+"/"+s;this._childVigourText.text=r,0==o?(this._vigouTimeText.visible=!0,this._childVigourText.visible=!1):(this._vigouTimeText.visible=!1,this._childVigourText.visible=!0);var l=GameConfig.config.childCfg[t.quality.toString()],h=LanguageManager.getlocal("childExp")+t.exp+"/"+l.needExp[t.level-1];t.level>=l.lv&&(h=LanguageManager.getlocal("child_levelMax"),this._vigouTimeText.visible=!1),this._curLevel=t.level,this._levelTxt.text=h,this._levelTxt.x=this._progressBar.x+this._progressBar.width/2-this._levelTxt.width/2,this._progressBar.setPercentage(t.exp/l.needExp[t.level-1]);for(var d=0;d<this._childProCfg.length;d++){var g=this._childProCfg[d],c=this._proTxtList[d];c.text=g.txt}if((""==t.name||0>=o)&&t.level<l.lv){var p="childAddVigour";""==t.name&&(p="childGiveName"),this._childUpdBtn&&(this._childUpdBtn.visible=!1),this._childNameBtn?this._childNameBtn.visible=!0:(this._childNameBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,p,this.nameBtnClickHandler,this),this._childNameBtn.x=480,this._childNameBtn.y=375,this._childNameBtn.setColor(TextFieldConst.COLOR_BLACK),this._childContainer.addChild(this._childNameBtn)),this._childNameBtn.setText(p)}else{var p="childUpd";this._childInfoVo.level>=l.lv&&(p="examination"),this._childNameBtn&&(this._childNameBtn.visible=!1),this._childUpdBtn?this._childUpdBtn.visible=!0:(this._childUpdBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,p,this.updBtnClickHandler,this),this._childUpdBtn.x=480,this._childUpdBtn.y=375,this._childUpdBtn.setColor(TextFieldConst.COLOR_BLACK),this._childContainer.addChild(this._childUpdBtn)),this._childUpdBtn.setText(p)}if(Api.switchVoApi.checkOpenWifeStatus()){var _=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"wifeStatusGoto",this.goStatus,this);_.x=250,_.y=GameConfig.stageHeigth-this.container.y-_.height-8,_.setColor(TextFieldConst.COLOR_BLACK),this._childContainer.addChild(_)}},e.prototype.goStatus=function(){ViewController.getInstance().openView(ViewConst.COMMON.WIFESTATUSVIEW),this.hide()},e.prototype.refreshChildPos=function(){var t=Api.childVoApi.getChildPosNum(),e=Api.childVoApi.getChildNum();if(this._childItemText.text=LanguageManager.getlocal("childCurItemCount")+e+"/"+t,t<Config.ChildbaseCfg.needPos);else{this._reachText.visible=!1;var i=Api.childVoApi.getChildrenCanUpdCount(),a=Api.childVoApi.getChildrenVigourItemCount();i>0||0>=a?(this._childAddAllBtn&&(this._childAddAllBtn.visible=!1),this._childUpdAllBtn?this._childUpdAllBtn.visible=!0:(this._childUpdAllBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"childUpdAll",this.updBtnAllClickHandler,this),this._childUpdAllBtn.setPosition(20,GameConfig.stageHeigth-this.container.y-this._childUpdAllBtn.height-8),this._childUpdAllBtn.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(this._childUpdAllBtn))):(this._childUpdAllBtn&&(this._childUpdAllBtn.visible=!1),this._childAddAllBtn?this._childAddAllBtn.visible=!0:(this._childAddAllBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"childAddVigourAll",this.addBtnAllClickHandler,this),this._childAddAllBtn.setPosition(20,GameConfig.stageHeigth-this.container.y-this._childAddAllBtn.height-8),this._childAddAllBtn.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(this._childAddAllBtn)))}},e.prototype.updBtnAllClickHandler=function(){var t=Api.childVoApi.getChildrenCanUpdCount();return 0>=t?void App.CommonUtil.showTip(LanguageManager.getlocal("childNoUpdChild")):void this.request(NetRequestConst.REQUEST_CHILD_AUTOTRAIN,null)},e.prototype.addBtnAllClickHandler=function(){var t=Api.childVoApi.getChildrenVigourItemCount(),e=Api.itemVoApi.getItemNumInfoVoById(Number(Config.ChildbaseCfg.needItem)),i=Config.ItemCfg.getItemCfgById(Number(Config.ChildbaseCfg.needItem)),a=LanguageManager.getlocal("useItemMsg",[i.name+"x"+t,LanguageManager.getlocal("childVigour")]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{confirmCallback:this.useItemAllConfirmCallbackHandler,handler:this,icon:i.icon,iconBg:i.iconBg,num:e,useNum:t,msg:a,id:Number(Config.ChildbaseCfg.needItem)})},e.prototype.useItemAllConfirmCallbackHandler=function(){this.request(NetRequestConst.REQUEST_CHILD_AUTORECOVER,null)},e.prototype.changeNameHandler=function(){""!=this._childInfoVo.name&&ViewController.getInstance().openView(ViewConst.POPUP.NAMEPOPUPVIEW,{type:2,childId:this._childInfoVo.id,confirmCallback:this.reNameCallBack,handler:this})},e.prototype.nameBtnClickHandler=function(){if(""==this._childInfoVo.name)ViewController.getInstance().openView(ViewConst.POPUP.NAMEPOPUPVIEW,{type:1,childId:this._childInfoVo.id,confirmCallback:this.reNameCallBack,handler:this});else{var t=(Api.childVoApi.getChildrenVigourById(this._childInfoVo.id),Config.ItemCfg.getItemCfgById(Number(Config.ChildbaseCfg.needItem))),e=Api.itemVoApi.getItemNumInfoVoById(Number(Config.ChildbaseCfg.needItem)),i=LanguageManager.getlocal("useItemMsg",[t.name+"x1",LanguageManager.getlocal("childVigour")]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{confirmCallback:this.useItemConfirmCallbackHandler,handler:this,icon:t.icon,iconBg:t.iconBg,num:e,useNum:1,msg:i,id:Number(Config.ChildbaseCfg.needItem)})}},e.prototype.reNameCallBack=function(){this.refreshItem(),this._childInfoVo=Api.childVoApi.getChildrenInfoVoById(this._childInfoVo.id),this._childInfoVoList=Api.childVoApi.getChildrenVoList(),this.updChildAttData(this._childInfoVo),this.refreshChildPos()},e.prototype.useItemConfirmCallbackHandler=function(){this.request(NetRequestConst.REQUEST_CHILD_RECOVER,{childId:this._childInfoVo.id})},e.prototype.updBtnClickHandler=function(){var t=GameConfig.config.childCfg[this._childInfoVo.quality.toString()];LanguageManager.getlocal("servant_infoLv")+this._childInfoVo.level+"/"+t.lv;return this._childInfoVo.level>=t.lv?(this.request(NetRequestConst.REQUEST_CHILD_EXAMINATION,{childId:this._childInfoVo.id}),void(this._childId=this._childInfoVo.id)):void this.request(NetRequestConst.REQUEST_CHILD_TRAIN,{childId:this._childInfoVo.id})},e.prototype.showUpgradeEffect=function(t){var e=this,i=BaseLoadBitmap.create("servant_upgrade_word");i.x=220,i.y=170,this._childContainer.addChild(i),egret.Tween.get(i,{loop:!1}).to({y:250},800).to({alpha:0},100);var a=ComponentManager.getCustomMovieClip("servant_upgrade_frame",5,100);a.setScale(2),a.x=-30,a.y=80,this._childContainer.addChild(a),a.playWithTime(1),egret.setTimeout(function(){e._childInfoVo&&(e.updChildAttData(e._childInfoVo),e._childContainer.removeChild(a),a=null,e._childContainer.removeChild(i),i=null)
},this,500)},e.prototype.playProAni=function(){var t=GameConfig.config.childCfg[this._childInfoVo.quality.toString()],e=this._childInfoVo.exp/t.needExp[this._childInfoVo.level-1],i=0,a=this._progressBar.getPercent();0==e&&(e=1),a>e&&(i=1),this._progressBar.tweenTo(e,500,i,function(t){this.updChildAttData(this._childInfoVo)}.bind(this,this._progressBar),this)},e.prototype.receiveData=function(t){var e;this._childInfoVo&&(e=this._childInfoVo.level);var i=this._childInfoVoList;if(this._childInfoVoList=Api.childVoApi.getChildrenVoList(),this._childInfoVoList.length>0&&(this._childInfoVo=Api.childVoApi.getChildrenInfoVoById(this._childInfoVo.id)),t.data.data.lucky&&App.CommonUtil.showGodbless("child"),t.data.cmd==NetRequestConst.REQUEST_CHILD_TRAIN){SoundManager.playEffect(SoundConst.EFFECT_UPD),this.refreshItem(),this.refreshChildPos(),this.playProAni();var a=this._curLevel;this._childInfoVo.level>a?this.showUpgradeEffect(!0):this.updChildAttData(this._childInfoVo)}else if(t.data.cmd==NetRequestConst.REQUEST_CHILD_RECOVER)this.updChildAttData(this._childInfoVo),this.refreshItem(),this.refreshChildPos();else if(t.data.cmd==NetRequestConst.REQUEST_CHILD_EXAMINATION){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_FUNCTION_TXT),ViewController.getInstance().openView(ViewConst.BASE.CHILDUPDVIEW,this._childId),this._childInfoVo=Api.childVoApi.getChildrenVoList()[0],this._childInfoVoList=Api.childVoApi.getChildrenVoList();for(var n=Api.childVoApi.getChildPosNum()+1,o=new Array,s=0;n>s;s++)o.push(s);if(this._scrollList.refreshData(o),this.refreshChildPos(),this._childInfoVo?this.updChildAttData(this._childInfoVo):this._childContainer.visible=!1,Api.childVoApi.getChildNum()>0){var r=this._childInfoVoList[0],l=r.id;this.setSelect(l)}}else if(t.data.cmd==NetRequestConst.REQUEST_CHILD_ADDPOSNUM){for(var n=Api.childVoApi.getChildPosNum()+1,o=new Array,s=0;n>s;s++)o.push(s);this._scrollList.refreshData(o);var h=Api.childVoApi.getChildPosNum(),d=Api.childVoApi.getChildNum();this._childItemText.text=LanguageManager.getlocal("childCurItemCount")+d+"/"+h,this.refreshChildPos(),App.CommonUtil.showTip(LanguageManager.getlocal("child_addPosTip"))}else if(t.data.cmd==NetRequestConst.REQUEST_CHILD_AUTOTRAIN||t.data.cmd==NetRequestConst.REQUEST_CHILD_AUTORECOVER){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_FUNCTION_TXT);var n=Api.childVoApi.getChildPosNum()+1;this._childInfoVoList=Api.childVoApi.getChildrenVoList(),this._childInfoVo=Api.childVoApi.getChildrenInfoVoById(this._childInfoVo.id);for(var o=new Array,s=0;n>s;s++)o.push(s);this._scrollList.refreshData(o),this.setSelect(this._childInfoVo.id),this.refreshChildPos(),e&&e!=this._childInfoVo.level?this.showUpgradeEffect():this.updChildAttData(this._childInfoVo);for(var s=0;s<this._childInfoVoList.length;s++){var g=(Api.childVoApi.getChildIndexVoById(this._childInfoVoList[s].id),this._scrollList.getItemByIndex(s));if(this._childInfoVoList[s].lastLevel!=this._childInfoVoList[s].level){var c=BaseBitmap.create("childview_levelup");g.addChild(c),c.x=g.width/2-c.width/2,c.y=g.height/2-c.height/2,egret.Tween.get(c).to({y:g.height/2-c.height/2-30},700).call(function(t){BaseBitmap.release(t),t=null},this,[c])}else if(i[s].exp!=this._childInfoVoList[s].exp){var c=BaseBitmap.create("childview_expup");g.addChild(c),c.x=g.width/2-c.width/2,c.y=g.height/2-c.height/2,egret.Tween.get(c).to({y:g.height/2-c.height/2-30},700).call(function(t){BaseBitmap.release(t),t=null},this,[c])}}}},e.prototype.refreshItem=function(){if(null!=this._childInfoVo){var t=Api.childVoApi.getChildIndexVoById(this._childInfoVo.id),e=this._scrollList.getItemByIndex(t);e.refreshData(t)}},e.prototype.getProStringWithProId=function(t){return this._childInfoVo?1==t?this._childInfoVo.level.toString():2==t?LanguageManager.getlocal("servant_infoAttr")+this._childInfoVo.attrVo.attTotal:3==t?this._childInfoVo.attrVo.forceTotal.toString():4==t?this._childInfoVo.attrVo.brainsTotal.toString():5==t?this._childInfoVo.attrVo.politicsTotal.toString():6==t?this._childInfoVo.attrVo.charmTotal.toString():"":""},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["childview_bg","childview_girlicon","childview_boyicon","childview_mask","childview_pic_1","childview_powar","childview_power2","progress3","progress3_bg","servant_probigbg","childview_expup","childview_levelup","servant_upgrade_frame","levelup_lizi","levelup_lizi_json","childview_addicon","childview_bg1","childview_bg2","childview_bg3","childview_itembg","childview_namebg1","childview_namebg2","childview_newbg","servant_attributemap","servant_downbg","servant_levebg","servant_attribute1","servant_attribute2","servant_attribute3","servant_attribute4","servant_attributemap"])},e.prototype.tick=function(){if(!(Api.childVoApi.getChildNum()<=0)){var t=GameConfig.config.childCfg[this._childInfoVo.quality.toString()];if(!(this._childInfoVo.level>=t.lv)&&null!=this._vigouTimeText){var e=Api.childVoApi.getChildrenVigourById(this._childInfoVo.id);Api.vipVoApi.getCurLevelVipCfg().maxVigour;if(0==e){var i=Api.childVoApi.getChildrenVigourTimeById(this._childInfoVo.id);this._vigouTimeText.text=App.DateUtil.getFormatBySecond(i,1),this._vigouTimeText.visible=!0}else this._vigouTimeText.visible=!1}}},e.prototype.getRuleInfo=function(){return"child_description"},e.prototype.dispose=function(){this._scrollList=null,this._childInfoVoList=null,this._motherText=null,this._intimacyText=null,this._childWordsText=null,this._childNameText=null,this._child_Icon=null,this._childInfoVo=null,this._childUpdBtn=null,this._childNameBtn=null,this._childUpdAllBtn=null,this._childAddAllBtn=null,this._vigouTimeText=null,this._childItemText=null,this._childContainer=null,this._childId=null,this._levelTxt,this._childInfoObj=null,this._proTxtList=null,this._childProCfg=null,this._progressBar=null,this._curLevel=0,this._childScrollItem=null,this._reachText=null,this._child_wordbg=null,this._child_wordbgCor=null,this._nameBg=null,this._childVigourText=null,this._childNameText&&this._childNameText.removeTouchTap(),t.prototype.dispose.call(this)},e}(CommonView);__reflect(ChildView.prototype,"ChildView");var ConquestBatchPopupView=function(t){function e(){var e=t.call(this)||this;return e._useNum=1,e._maxNum=0,e}return __extends(e,t),e.prototype.initView=function(){this._useCallback=this.param.data.callback,this._handler=this.param.data.handler;var t=Api.conquestVoApi.getConquestVo(),e=Api.conquestVoApi.getAttNum(t.info.cid);this._maxNum=e,this._maxNum>200&&(this._maxNum=200);var i=BaseBitmap.create("mainui_topresbg");i.setPosition(40,20),this.addChildToContainer(i);var a=BaseBitmap.create("public_icon4");a.setPosition(i.x-a.width/2,i.y+i.height-a.height+5),this.addChildToContainer(a);var n=App.StringUtil.changeIntToText(Api.playerVoApi.getSoldier()),o=ComponentManager.getTextField(n,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);o.setPosition(70,i.y+i.height/2-o.height/2),this.addChildToContainer(o);var s=(LanguageManager.getlocal("effectTitle"),BaseBitmap.create("public_9_bg4"));s.width=520,s.height=220,s.x=this.viewBg.x+this.viewBg.width/2-s.width/2,s.y=70,this.addChildToContainer(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("conquestChooseAtt"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);r.setPosition(50,s.y+15),this.addChildToContainer(r);var l=BaseBitmap.create("public_9_probiginnerbg");l.width=500,l.height=150,l.x=this.viewBg.x+this.viewBg.width/2-l.width/2,l.y=s.y+50,this.addChildToContainer(l);var h=t.info.cid,d=t.info.cid+Api.conquestVoApi.getAttNum(t.info.cid)-1,g=LanguageManager.getlocal("conquestChooseNum",[h.toString(),d.toString()]);this._carNumTF=ComponentManager.getTextField(g,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._carNumTF.setPosition(50,l.y+15),this.addChildToContainer(this._carNumTF);var c=ComponentManager.getDragProgressBar("progress2","progress2_bg",this._maxNum,this.dragCallback,this);c.x=140,c.y=170,this.addChildToContainer(c);var p=App.StringUtil.changeIntToText(Api.conquestVoApi.getAttCostNum(t.info.cid,1)),_=App.StringUtil.changeIntToText(Api.playerVoApi.getSoldier()),u=LanguageManager.getlocal("conquestCostNum",[p.toString(),_.toString()]);this._costNumTF=ComponentManager.getTextField(u,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._costNumTF.setPosition(this.viewBg.width/2-this._costNumTF.width/2,c.y+c.height+10),this.addChildToContainer(this._costNumTF);var C=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"useBtn",this.useHandler,this);C.x=s.x+s.width/2-C.width/2,C.y=s.y+s.height+15,C.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(C)},e.prototype.dragCallback=function(t){this._useNum=t;var e=Api.conquestVoApi.getConquestVo(),i=e.info.cid-1+t,a=e.info.cid-1+Api.conquestVoApi.getAttNum(e.info.cid),n=LanguageManager.getlocal("conquestChooseNum",[i.toString(),a.toString()]);this._carNumTF.text=n;var o=App.StringUtil.changeIntToText(Api.conquestVoApi.getAttCostNum(e.info.cid,t)),s=App.StringUtil.changeIntToText(Api.playerVoApi.getSoldier()),r=LanguageManager.getlocal("conquestCostNum",[o.toString(),s.toString()]);this._costNumTF.text=r},e.prototype.getTitleStr=function(){return"conquestAll"},e.prototype.useHandler=function(t){this._useCallback.apply(this._handler,[this._useNum-1]),this.hide()},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["progress2_bg","progress2"])},e.prototype.dispose=function(){this._useCallback=null,this._useNum=1,this._carNumTF=null,this._costNumTF=null,this._maxNum=0,this._handler=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(ConquestBatchPopupView.prototype,"ConquestBatchPopupView");var ConquestFightView=function(t){function e(){var e=t.call(this)||this;return e._conquestConfig=void 0,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["hero_anim_1","npc_anim_1","conquest_fightbg",ButtonConst.BATTLE_START_BTN_1,"exp_progress_bg","battle_hero_bar","battle_info_bg","battle_npc_bar","battle_luanz","promotion_officerbg1"])},e.prototype.battleBgName=function(){return"conquest_fightbg"},e.prototype.getTitleStr=function(){return"conquestTitle"},e.prototype.resetConfig=function(){var t=this.param.data;this._isAttackWin=1==t.fightflag,this._rewards=t.rewards,this._conquestConfig=Config.ConquestCfg.getConquestCfgById(t.info.cid),this._totalOldNum=[t.info.oldSilder,t.info.enemySoldier],this._totalNum=this._totalOldNum},e.prototype.init=function(){t.prototype.init.call(this);for(var e=0;1>=e;e++){if(this._battleInfoTab[e]=new BattleInfo,0==e)this._battleInfoTab[e].init(this._totalOldNum[e],!0),this._battleInfoTab[e].x=15,this._battleInfoTab[e].y=GameConfig.stageHeigth-35-this._battleInfoTab[e].height;else{var i=this.param.data.info.cid,a=this.param.data.info.idx,n=Config.ConquestCfg.getConquestCfgById(i+"")["person"+a],o={show:n,cid:i,idx:a};this._battleInfoTab[e].init(this._totalOldNum[e],!1,o),this._battleInfoTab[e].x=GameConfig.stageWidth-13-this._battleInfoTab[e].width,this._battleInfoTab[e].y=130}this.addChild(this._battleInfoTab[e]),this._battleInfoTab[e].curNumber=this._totalNum[e]}this.intoBattle()},e.prototype.intoBattle=function(){SoundManager.playEffect(SoundConst.EFFECT_BATTLE),SoundManager.playEffect(SoundConst.EFFECT_BATTLE_START);var t=this._totalNum[0]-Api.playerVoApi.getSoldier(),e=this._totalNum[1];if(this._isAttackWin)this._lostNum=[t,e];else{var i=(this.param.data.info,this._totalNum[0]),a=this._totalNum[1],n=Api.playerVoApi.getAtk(),o=a/10,s=Math.ceil(i*(n+1e3)/(o+1e3));s>a&&(s=a),this._lostNum=[t,s]}this.calculateLostSoldierNumber(),this.calculateLostTab(),this.gameBegin(),this._gameBtn.touchEnabled=!1,this._gameBtn.visible=!1;var r=this._lostSoldier[0]+this._lostSoldier[1];this._deathRate=Math.ceil(3e3/(r+1)),this._deathRate>1e3&&(this._deathRate=1e3),this._lastDeathTime=egret.getTimer()+3*this._deathRate},e.prototype.endCallBack=function(){this.hide()},e.prototype.showResultView=function(){if(this._isAttackWin){var t=this.param.data.info.cid,e=this.param.data.info.idx,i=Config.ConquestCfg.getConquestCfgById(t+"")["person"+e],a={show:i,cid:t};ViewController.getInstance().openView(ViewConst.POPUP.CONQUESTWINPOPUPVIEW,{award:this._rewards,f:this.endCallBack,o:this,info:a})}else ViewController.getInstance().openView(ViewConst.BASE.PROMPTVIEW,{type:1,f:this.endCallBack,o:this})},e.prototype.getCloseBtnName=function(){return null},e.prototype.dispose=function(){this._conquestConfig=null,t.prototype.dispose.call(this)},e}(BattleView);__reflect(ConquestFightView.prototype,"ConquestFightView");var ConquestInfoPopupView=function(t){function e(){var e=t.call(this)||this;return e.scrollView=null,e._moveCountainer=null,e.rewardArrList=[],e.strArr=[],e.iconArr=[],e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["battle_win_word","fire_flake_json","battle_win_light","fire_flake"])},e.prototype.isShowMask=function(){return!0},e.prototype.getTitleStr=function(){return null},e.prototype.initView=function(){this.viewBg.visible=!1;var t=BaseBitmap.create("public_9_wordbg2");t.height=600,t.setPosition(-35,20),t.width=640,t.height=700,this.addChildToContainer(t);var e=BaseBitmap.create("battle_win_light");e.scaleY=.5,e.setPosition(50,-10),this.addChildToContainer(e),e.alpha=0,egret.Tween.get(e).wait(100).to({alpha:1},100).wait(90).to({alpha:0},10);var i=BaseBitmap.create("battle_win_word");if(i.setPosition(0,-100),this.addChildToContainer(i),i.scaleX=2.5,i.scaleY=2.5,egret.Tween.get(i).to({x:160,y:-40,scaleX:.9,scaleY:.9},120).to({x:160,y:-40,scaleX:1,scaleY:1},50),this._fire_lizi=App.ParticleUtil.getParticle("fire_flake"),this._fire_lizi.y=-150,this.addChildToContainer(this._fire_lizi),this.showAnim(),this._moveCountainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._moveCountainer),this.param&&this.param.data){var a=this.param.data.rewards,n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_WHITE);n.text=LanguageManager.getlocal("conquestInfodes",[this.param.data.fightnum+""]),n.setPosition(110,80),this.addChildToContainer(n);var o=new BaseDisplayObjectContainer,s=new BaseDisplayObjectContainer;this.rewardArrList=[],this.rewardArrList=GameData.formatRewardItem(a),this.rewardArrList.sort(function(t,e){return t.type>e.type?1:t.type==e.type?0:-1});var r=this.rewardArrList.length,l=.88,h=0;if(this.strArr=[],this.iconArr=[],this.param.data&&this.param.data.batchpoint){var d=LanguageManager.getlocal("conquestpointsdes",[this.param.data.batchpoint+""]);this.strArr.push(d)}for(var g=0;r>g;g++)if(6==this.rewardArrList[g].type)this.iconArr.push(this.rewardArrList[g]);else if(12==this.rewardArrList[g].type){var c=Config.WifeCfg.getWifeCfgById(this.rewardArrList[g].id);this.strArr.push(c.name+this.rewardArrList[g].tipMessage)}else if(14==this.rewardArrList[g].type||15==this.rewardArrList[g].type){var p=Config.ServantCfg.getServantItemById(this.rewardArrList[g].id);this.strArr.push(p.name+this.rewardArrList[g].message)}else this.strArr.push(this.rewardArrList[g].name+this.rewardArrList[g].tipMessage);if(this.strArr.length>0)for(var _=0;_<this.strArr.length;_++){var u=ComponentManager.getTextField("0",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN);u.text=this.strArr[_];var C=_%2;u.setPosition(90+260*C,(u.height+20)*Math.floor(_/2)-20),s.addChild(u)}s.setPosition(0,-10),this._moveCountainer.addChild(s),this.iconArr.sort(function(t,e){return t.id>e.id?1:t.id==e.id?0:-1});for(var g=0;g<this.iconArr.length;g++){var f=GameData.getItemIcon(this.iconArr[g],!0),C=g%4;f.setPosition((f.width+5)*C,(f.height+20)*Math.floor(g/4)),f.scaleX=l,f.scaleY=l,o.addChild(f),h=(f.height+20)*Math.floor(g/5)}o.setPosition(80,s.y+50+s.height),this._moveCountainer.addChild(o),this._moveCountainer.height=this._moveCountainer.height+100;var m=BaseBitmap.create("public_9_bg28");m.width=this._moveCountainer.width,m.height=this._moveCountainer.height,m.x=80,m.alpha=0,this._moveCountainer.addChild(m),this._moveCountainer.setChildIndex(m,0);var T=new egret.Rectangle(0,0,640,450);null==this.scrollView&&(this.scrollView=ComponentManager.getScrollView(this._moveCountainer,T),this.scrollView.x=10,this.scrollView.y=n.y+50,this.addChildToContainer(this.scrollView))}},e.prototype.showAnim=function(){if(this._fire_lizi){this._fire_lizi.start();var t=this;egret.Tween.get(this._fire_lizi,{loop:!1}).wait(500).to({alpha:0},200).call(function(){this._fire_lizi&&(t.removeChildFromContainer(this._fire_lizi),this._fire_lizi=null)})}},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this),this.closeBtn.y=this.viewBg.y,this.closeBtn.x=this.viewBg.x+this.viewBg.width-80},e.prototype.dispose=function(){this._moveCountainer=null,this.rewardArrList=[],this.scrollView=null,this.strArr=[],this.iconArr=[],this._fire_lizi=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(ConquestInfoPopupView.prototype,"ConquestInfoPopupView");var ConquestRankPopupView=function(t){function e(){var e=t.call(this)||this;return e._curTabIdx=0,e}return __extends(e,t),e.prototype.initView=function(){var t=(Api.conquestVoApi.getConquestVo(),["conquestRank"]),e=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,t,this.tabBtnClickHandler,this);e.x=35,e.y=15,this.addChildToContainer(e);var i=BaseBitmap.create("public_9_bg32");i.width=520,i.height=600,i.x=this.viewBg.width/2-i.width/2,i.y=60,this.addChildToContainer(i);var a=BaseBitmap.create("public_9_bg33");a.width=i.width,a.height=40,a.x=i.x,a.y=i.y,this.addChildToContainer(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("acRankPop_title1"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);n.x=a.x+40,n.y=a.y+8,this.addChildToContainer(n),this._titleTF=ComponentManager.getTextField(LanguageManager.getlocal("acRankPop_title2"),n.size,TextFieldConst.COLOR_LIGHT_YELLOW),this._titleTF.x=a.x+175,this._titleTF.y=n.y,this.addChildToContainer(this._titleTF);var o=ComponentManager.getTextField(LanguageManager.getlocal("conquestScore"),n.size,TextFieldConst.COLOR_LIGHT_YELLOW);o.x=a.x+430-o.width/2,o.y=n.y,this.addChildToContainer(o);var s=BaseBitmap.create("public_9_bg1");s.width=i.width,s.height=100,s.x=i.x,s.y=i.y+i.height+9,this.addChildToContainer(s),this._nickNameTF=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._nickNameTF.text=LanguageManager.getlocal("acRank_mynick")+Api.playerVoApi.getPlayerName(),this._nickNameTF.x=s.x+20,this._nickNameTF.y=s.y+20,this.addChildToContainer(this._nickNameTF);var r="10000+",l=0;this._acData.merank&&(r=String(this._acData.merank),l=this._acData.merank),this._myRankTF=ComponentManager.getTextField("",this._nickNameTF.size,TextFieldConst.COLOR_LIGHT_YELLOW),this._myRankTF.text=LanguageManager.getlocal("acRank_myrank",[r]),this._myRankTF.x=this._nickNameTF.x,this._myRankTF.y=this._nickNameTF.y+40,this.addChildToContainer(this._myRankTF),this._scoreTF=ComponentManager.getTextField("",this._nickNameTF.size,TextFieldConst.COLOR_LIGHT_YELLOW),this._scoreTF.text=LanguageManager.getlocal("conquestScore")+":"+this._acData.mepoint,this._scoreTF.x=this._myRankTF.x+240,this._scoreTF.y=this._myRankTF.y,this.addChildToContainer(this._scoreTF);var h=this._acData.conrank,d=egret.Rectangle.create();d.setTo(0,0,this.viewBg.width,i.height-70),this._scrollList=ComponentManager.getScrollList(ConquestRankScrollItem,h,d),this.addChildToContainer(this._scrollList),this._scrollList.y=a.y+50,this._scrollList.setEmptyTip(LanguageManager.getlocal("acPunishNoData"))},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_CONQUEST_RANK,requestData:{}}},e.prototype.receiveData=function(t){t.data.cmd==NetRequestConst.REQUEST_CONQUEST_RANK&&(this._acData=t.data.data)},e.prototype.rankBtnClick=function(){},e.prototype.tabBtnClickHandler=function(t){this._curTabIdx=t.index,this.refreshRankList()},e.prototype.refreshRankList=function(){var t=this._acData.rankList;if(0==this._curTabIdx){var e="10000+",i=0;this._nickNameTF.text=LanguageManager.getlocal("acRank_mynick")+Api.playerVoApi.getPlayerName(),this._titleTF.text=LanguageManager.getlocal("acRankPop_title2"),this._acData.myrank.myrank&&(e=String(this._acData.myrank.myrank),i=this._acData.myrank.value),this._myRankTF.text=LanguageManager.getlocal("acRank_myrank",[e])}else{t=this._acData.arankList,this._titleTF.text=LanguageManager.getlocal("acRankPop_titleAlliance");var a=LanguageManager.getlocal("allianceRankNoAlliance"),e=LanguageManager.getlocal("nothing"),n=LanguageManager.getlocal("nothing"),i=0;this._nickNameTF.text=LanguageManager.getlocal("acRank_myAlliancenick")+e,this._titleTF.text=LanguageManager.getlocal("acRankPop_titleAlliance"),this._acData.amyrank.myrank&&(e=String(this._acData.amyrank.myrank),n=String(this._acData.amyrank.value)),0!=Api.playerVoApi.getPlayerAllianceId()&&(a=Api.playerVoApi.getPlayerAllianceName()),this._nickNameTF.text=LanguageManager.getlocal("acRank_myAlliancenick")+a,this._scoreTF.text=LanguageManager.getlocal("acPunishScore",[n]),this._myRankTF.text=LanguageManager.getlocal("acRank_myrank",[e])}this._scrollList.refreshData(t)},e.prototype.getTitleStr=function(){return"conquestRank"},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.dispose=function(){this._scrollList=null,this._timeTF=null,this._selectChildData=null,this._titleTF=null,this._nickNameTF=null,this._myRankTF=null,this._scoreTF=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(ConquestRankPopupView.prototype,"ConquestRankPopupView");var ConquestRankScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.height=52,this._nodeContainer=new BaseDisplayObjectContainer,this.addChild(this._nodeContainer);var i=16;if(t>2){var a=ComponentManager.getTextField("",20,TextFieldConst.COLOR_BROWN);a.text=String(t+1),a.x=90-a.width/2,a.y=i,this._nodeContainer.addChild(a),e.uid==Api.playerVoApi.getPlayerID()&&(a.textColor=TextFieldConst.COLOR_WARN_YELLOW)}else{var n=BaseLoadBitmap.create("rank_"+String(t+1));n.width=51,n.height=47,n.x=90-n.width/2,n.y=3,this.addChild(n)}var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);o.text=e.name,o.x=245-o.width/2,o.y=i,this._nodeContainer.addChild(o);var s=ComponentManager.getTextField("",o.size,TextFieldConst.COLOR_BROWN);s.text=String(e.point),s.x=460-s.width/2,s.y=i,this._nodeContainer.addChild(s),(e.uid==Api.playerVoApi.getPlayerID()||e.id==Api.playerVoApi.getPlayerAllianceId())&&(o.textColor=TextFieldConst.COLOR_WARN_YELLOW,s.textColor=TextFieldConst.COLOR_WARN_YELLOW);var r=BaseLoadBitmap.create("rank_line");r.width=500,r.height=2,r.x=30,r.y=50,this._nodeContainer.addChild(r)},e.prototype.getSpaceX=function(){return 0},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ConquestRankScrollItem.prototype,"ConquestRankScrollItem");var ConquestView=function(t){function e(){var e=t.call(this)||this;return e._topContiner=void 0,e._middleContiner=void 0,e._buttomContiner=void 0,e._scrollContiner=void 0,e._soldierText=null,e._expProgress=null,e._isShowName=!1,e._officerIcon=null,e._isInited=!1,e._oldInfo=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([ProgressBarConst.IMAGE_PROGRESS_EXP,ProgressBarConst.IMAGE_PROGRESS_EXP_Bg,"conquest_cellbg","promotion_officerbg1","channel_bg","channel_light","channel_knife","challenge_icon_force","challenge_top_bg","mainui_topresbg","progress4","progress7_bg","mainui_fg"])},e.prototype.getTitleStr=function(){return"conquestTitle"},e.prototype.getDescStr=function(){return"challengeDesc"+Api.challengeVoApi.getCurBigChannelId()},e.prototype.getRuleInfo=function(){return"conquestInfo"},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_CONQUEST_INDEX,requestData:{}}},e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_RESCHANGE_REFRESH_UI,this.refresh,this),this.container.y=this.getTitleButtomY(),this._scrollContiner=new BaseDisplayObjectContainer;var t=egret.Rectangle.create();t.setTo(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-this.getTitleButtomY()-20);var e=BaseBitmap.create("public_9_bg23");e.width=GameConfig.stageWidth-10,e.height=GameConfig.stageHeigth-280,e.x=5,e.y=110,this.addChildToContainer(e),this.addChildToContainer(this._scrollContiner),this._topContiner=new BaseDisplayObjectContainer,this._scrollContiner.addChild(this._topContiner),this.initTop(),this.initMiddle(),this.initButtom(),this.refreshBottom()},e.prototype.initTop=function(){var t=BaseBitmap.create("challenge_top_bg");this._topContiner.addChild(t),this._circleHead=Api.playerVoApi.getPlayerCircleHead(Api.playerVoApi.getPlayePicId()),this._circleHead.setPosition(2,6),this._topContiner.addChild(this._circleHead),this._circleHead.addTouchTap(this.roleHeadClickHandler,this),this._officerIcon=ComponentManager.getBitmapText(Api.playerVoApi.getPlayerOffice(),"office_fnt"),this._officerIcon.setScale(.85),this._officerIcon.setPosition(this._circleHead.x+this._circleHead.width/2-this._officerIcon.width*this._officerIcon.scaleX/2,this._circleHead.y+63),this._topContiner.addChild(this._officerIcon);var e=BaseBitmap.create("public_9_resbg");e.setPosition(105,this._circleHead.y+2),e.width=172,this._topContiner.addChild(e);var i=BaseLoadBitmap.create("challenge_icon_power");i.setPosition(e.x-3,e.y),this._topContiner.addChild(i);var a=ComponentManager.getTextField(Api.playerVoApi.getPlayerPower().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,16642792);a.setPosition(e.x+50,e.y+e.height/2-a.height/2+2),this._topContiner.addChild(a);var n=BaseBitmap.create("public_9_resbg");n.setPosition(e.x+175,e.y),n.width=e.width,this._topContiner.addChild(n);var o=BaseBitmap.create("challenge_icon_force");o.setPosition(n.x-3,n.y),this._topContiner.addChild(o);var s=ComponentManager.getTextField(Api.playerVoApi.getAtk().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,a.textColor);s.setPosition(n.x+50,n.y+n.height/2-s.height/2+2),this._topContiner.addChild(s);var r=BaseBitmap.create("public_9_resbg");r.setPosition(n.x+175,n.y),r.width=e.width,this._topContiner.addChild(r);var l=BaseBitmap.create("public_icon4");l.setPosition(r.x-3,r.y),this._topContiner.addChild(l),this._soldierText=ComponentManager.getTextField(Api.playerVoApi.getSoldier().toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this._soldierText.setPosition(r.x+50,r.y+r.height/2-this._soldierText.height/2+2),this._topContiner.addChild(this._soldierText);var h=BaseBitmap.create("public_icon5");h.setPosition(e.x-3,e.y+49),this._topContiner.addChild(h),this._expProgress=ComponentManager.getProgressBar("progress4","progress7_bg",463),this._expProgress.setPosition(h.x+55,h.y+h.height/2-this._expProgress.height/2),this._expProgress.setTextSize(TextFieldConst.FONTSIZE_CONTENT_SMALL),this._topContiner.addChild(this._expProgress),this.resetExpProgress(),this.refreshUpgradeClip()},e.prototype.receiveData=function(t){if(t.data.refreshdata)return this.sendData(),void App.CommonUtil.showTip(LanguageManager.getlocal("adultMarryRequestTip4"));if(t.data.cmd==NetRequestConst.REQUEST_CONQUEST_INDEX){if(!this._isInited)return void(this._isInited=!0);this._conVo=Api.conquestVoApi.getConquestVo(),this.refreshView()}else if(t.data.cmd==NetRequestConst.REQUEST_CONQUEST_FIGHT)ViewController.getInstance().openView(ViewConst.BATTLE.CONQUESTFIGHTVIEW,{f:this.sendData,o:this,info:this._oldInfo,fightflag:t.data.data.fightflag,rewards:t.data.data.rewards});else if(t.data.cmd==NetRequestConst.REQUEST_CONQUEST_BATCHFIGHT){var e=t.data.data;e.rewards&&ViewController.getInstance().openView(ViewConst.POPUP.CONQUESTINFOPOPUPVIEW,e),this.sendData()}},e.prototype.sendData=function(){this.request(NetRequestConst.REQUEST_CONQUEST_INDEX,{})},e.prototype.refreshView=function(){this.refreshBottom(),this._middleContiner&&(this._scrollContiner.removeChild(this._middleContiner),this._middleContiner=null),this.initMiddle()},e.prototype.refreshBottom=function(){var t=Api.conquestVoApi.getConquestVo();t.tnum>=50&&(this._reachText.visible=!1,this._childUpdAllBtn?this._childUpdAllBtn.visible=!0:(this._childUpdAllBtn=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"conquestAll",this.attAllClickHandler,this),this._childUpdAllBtn.setPosition(390,GameConfig.stageHeigth-this.container.y-this._childUpdAllBtn.height-8),this._childUpdAllBtn.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(this._childUpdAllBtn)))},e.prototype.attAllClickHandler=function(){var t=Api.conquestVoApi.getConquestVo();return t.info.cid>200?void App.CommonUtil.showTip(LanguageManager.getlocal("conquestCannotAtt2")):Api.playerVoApi.getSoldier()<=0?void App.CommonUtil.showTip(LanguageManager.getlocal("conquestCannotAtt")):Api.conquestVoApi.getAttNum(t.info.cid)<=0?void App.CommonUtil.showTip(LanguageManager.getlocal("conquestCannotAtt3")):void ViewController.getInstance().openView(ViewConst.POPUP.CONQUESTBATCHPOPUPVIEW,{callback:this.callbackHandler,handler:this})},e.prototype.callbackHandler=function(t){var e=Api.conquestVoApi.getConquestVo(),i=e.info.cid+t;this.request(NetRequestConst.REQUEST_CONQUEST_BATCHFIGHT,{cid:i})},e.prototype.roleHeadClickHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.PLAYERVIEW)},e.prototype.resetExpProgress=function(){var t=Api.playerVoApi.getPlayerExp(),e=Api.playerVoApi.getNextLevelExp();this._expProgress.setText(t.toString()+"/"+e.toString()),this._expProgress.setPercentage(t/e);var i=App.StringUtil.changeIntToText(Api.playerVoApi.getSoldier());this._soldierText.text=i},e.prototype.initMiddle=function(){this._middleContiner=new BaseDisplayObjectContainer,this._middleContiner.y=105,this._scrollContiner.addChild(this._middleContiner);var t=Api.conquestVoApi.getConquestVo();if(t.info.cid>200){var e=ComponentManager.getTextField(LanguageManager.getlocal("conquestAttMax"),TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);return e.setPosition(this.width/2-e.width/2,300),e.textAlign=TextFieldConst.ALIGH_CENTER,void this._middleContiner.addChild(e)}for(var i=0;3>i;i++){var a=this.getItem(i);this._middleContiner.addChild(a),a.x=12+207*i,a.y=62}var n=BaseBitmap.create("public_line3");n.width=480,n.x=this.width/2-n.width/2,n.y=23,this._middleContiner.addChild(n);var o=LanguageManager.getlocal("conquestLevel",[t.info.cid]),s=ComponentManager.getTextField(o,TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);s.setPosition(this.width/2-s.width/2,19),this._middleContiner.addChild(s)},e.prototype.getItem=function(t){var e=Api.conquestVoApi.getConquestVo(),i=new BaseDisplayObjectContainer,a=BaseBitmap.create("conquest_cellbg");a.height=615,i.addChild(a);var n=Config.ConquestCfg.getConquestCfgById(e.info.cid+""),o=Config.ConquestCfg.getConquestCfgById(e.info.cid+"")["person"+(t+1)],s=LanguageManager.getlocal("BossName"+o),r=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);r.setPosition(a.width/2-r.width/2,9),i.addChild(r);var l=BaseLoadBitmap.create("story_npc_"+o);l.x=20,l.y=58,l.scaleX=.4,l.scaleY=.4,i.addChild(l);var h=BaseBitmap.create("public_9_resbg");h.setPosition(20,265),i.addChild(h);var d=BaseBitmap.create("public_icon4");d.setPosition(h.x-3,h.y),i.addChild(d);var g=App.StringUtil.changeIntToText(e.info.cinfo[t].soldier),c=ComponentManager.getTextField(g,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);c.setPosition(h.x+50,h.y+h.height/2-c.height/2),i.addChild(c);var p=BaseBitmap.create("public_9_managebg");p.x=15,p.y=c.y+c.height+20,p.width=170,p.height=220,i.addChild(p);
var _=ComponentManager.getTextField(LanguageManager.getlocal("taskReward"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);_.x=p.x+5,_.y=p.y+5,i.addChild(_);var u=ComponentManager.getTextField(LanguageManager.getlocal("pointNumber")+"+"+n.score,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN2);u.x=_.x,u.y=_.y+u.height+5,i.addChild(u);var C=ComponentManager.getTextField(LanguageManager.getlocal("affairtxt2")+"+"+n.reward,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN2);C.x=u.x,C.y=u.y+u.height+5,i.addChild(C);var f=ComponentManager.getTextField(LanguageManager.getlocal("conquestGetItem"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);f.x=u.x,f.y=C.y+C.height+5,i.addChild(f);for(var m=0;m<e.info.cinfo[t].rewards.length;m++){var T=e.info.cinfo[t].rewards[m],y=GameData.formatRewardItem(T),v=.45,A=GameData.getItemIcon(y[0],!0,!0),w=m%3;A.x=14+7*(w+1)+A.width*v*w,A.y=(A.height*v+5)*Math.floor(m/3)+f.y+f.height+5,A.scaleX=A.scaleY=v,i.addChild(A)}var x=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"conquestTitle",this.attBtnCilck,this,[t]);return x.x=24,x.y=p.y+p.height+10,i.addChild(x),x.setColor(TextFieldConst.COLOR_BLACK),x.bindData=t,i},e.prototype.attBtnCilck=function(t){if(Api.playerVoApi.getSoldier()<=0)return void App.CommonUtil.showTip(LanguageManager.getlocal("conquestCannotAtt"));var e=Api.conquestVoApi.getConquestVo();this._oldInfo={cid:e.info.cid,oldSilder:Api.playerVoApi.getSoldier(),enemySoldier:e.info.cinfo[t].soldier,enemyAtk:e.info.cinfo[t],idx:t+1},this.request(NetRequestConst.REQUEST_CONQUEST_FIGHT,{num:t+1})},e.prototype.initButtom=function(){if(!Api.switchVoApi.checkOpenShenhe()){var t=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"conquestRank",this.rankBtnCilck,this);t.x=85,t.y=GameConfig.stageHeigth-70,this.addChild(t),t.setColor(TextFieldConst.COLOR_BLACK)}this._reachText=ComponentManager.getTextField(LanguageManager.getlocal("conquestAllTip"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._reachText.setPosition(320,GameConfig.stageHeigth-70+30-this._reachText.height/2),this.addChild(this._reachText)},e.prototype.rankBtnCilck=function(){ViewController.getInstance().openView(ViewConst.POPUP.CONQUESTRANKPOPUPVIEW)},e.prototype.onClickAttack=function(){var t=ChallengeCfg.getChallengeCfgById(Api.challengeVoApi.getCurChannelId());if(t.dialogue){var e=LocalStorageConst.LOCAL_CHALLENGE_STORY+"_cId_"+Api.challengeVoApi.getCurChannelId()+"_zId_"+GameData.curZoneID+"_pId_"+Api.playerVoApi.getPlayerID(),i=LocalStorageManager.get(e);i?this.realAttackChannel():ViewController.getInstance().openView(ViewConst.BASE.CHALLENGESTORY,{f:this.realAttackChannel,o:this,dialogue:t.dialogue})}else this.realAttackChannel()},e.prototype.realAttackChannel=function(){},e.prototype.refreshInfo=function(){if(null!=this._expProgress){this.resetExpProgress();Api.challengeVoApi.getCurBigChannelId(),Api.challengeVoApi.getCurMiddleChannelId();this.refreshUpgradeClip()}},e.prototype.getButtomLineBg=function(){return null},e.prototype.refreshUpgradeClip=function(){var t=Api.playerVoApi.getPlayerLevel(),e=Config.LevelCfg.getCfgByLevel((t+1).toString());e&&Api.playerVoApi.getPlayerExp()>=e.exp?this._upgradeClip||(this._upgradeClip=ComponentManager.getCustomMovieClip("mainui_fg",10,100),this._upgradeClip.x=-16,this._upgradeClip.y=-18,this._circleHead.addChild(this._upgradeClip),this._circleHead.swapChildren(this._circleHead.getChildByName("myHead"),this._upgradeClip),this._upgradeClip.playWithTime(0)):this._upgradeClip&&(this._upgradeClip.stop(),this._circleHead.removeChild(this._upgradeClip),this._upgradeClip=null,this._officerIcon.text=Api.playerVoApi.getPlayerOffice())},e.prototype.refresh=function(){this.refreshInfo()},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_RESCHANGE_REFRESH_UI,this.refresh,this),this._soldierText=null,this._expProgress=null,this._scrollContiner=null,this._topContiner=null,this._middleContiner=null,this._buttomContiner=null,this._upgradeClip=null,this._circleHead=null,this._conVo=null,this._isInited=!1,this._childUpdAllBtn=null,this._reachText=null,this._oldInfo=null,this._officerIcon=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(ConquestView.prototype,"ConquestView");var ConquestWinPopupView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["battle_win_word","battle_win_light","fire_flake_json","fire_flake"])},e.prototype.initView=function(){this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f),this.addTouchTap(this.hide,this);var t=this.param.data.info,e=LanguageManager.getlocal("conquestInfoWin",[String(t.cid)]),i=ComponentManager.getTextField(e,TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_WHITE);i.textAlign=egret.HorizontalAlign.CENTER,i.width=480,i.lineSpacing=6,i.setPosition((this.viewBg.width-i.width)/2,58),this.addChildToContainer(i);var a=Config.ConquestCfg.getConquestCfgById(t.cid),n=GameData.formatRewardItem(this.param.data.award),o=[],s=[];s.push(LanguageManager.getlocal("conquestpointsdes",[String(a.score)]));for(var r=0;r<n.length;r++){var l=n[r];if(6==l.type)o.push(l);else if(12==l.type){var h=Config.WifeCfg.getWifeCfgById(l.id);s.push(h.name+l.tipMessage)}else if(14==l.type||15==l.type){var d=Config.ServantCfg.getServantItemById(l.id);s.push(d.name+l.message)}else s.push(l.name+l.tipMessage)}for(var r=0;r<s.length;r++){var g=s[r],c=ComponentManager.getTextField(g,TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_WARN_GREEN);c.setPosition(70+r%2*270,i.y+i.height+18+30*Math.floor(r/2)),this.addChildToContainer(c)}for(var p=130+30*Math.ceil(s.length/2),_=0;_<o.length;_++){var u=o[_],C=GameData.getItemIcon(u);C.setPosition(GameConfig.stageWidth/2+19+(o.length/2-_-1)*(C.width+38),p),this.addChildToContainer(C)}this._fire_lizi=App.ParticleUtil.getParticle("fire_flake"),this._fire_lizi.y=10-this._fire_lizi.height/2,this.addChildToContainer(this._fire_lizi),this.showWordAnim()},e.prototype.showWordAnim=function(){var t=0,e=BaseBitmap.create("battle_win_light");e.scaleY=.5,e.setPosition(GameConfig.stageWidth/2-e.width/2*e.scaleX,t-e.height/4-5),this.addChildToContainer(e),this._fire_lizi=App.ParticleUtil.getParticle("fire_flake"),this.addChildToContainer(this._fire_lizi);var i=BaseBitmap.create("battle_win_word"),a=2.5,n=.9,o=egret.Point.create(GameConfig.stageWidth/2-i.width/2*a,t-i.height/2*a+30),s=egret.Point.create(GameConfig.stageWidth/2-i.width/2*n,t-i.height/2*n),r=egret.Point.create(GameConfig.stageWidth/2-i.width/2,t-i.height/2);i.setScale(a),i.setPosition(o.x,o.y),this.addChildToContainer(i),egret.Tween.get(i).to({x:s.x,y:s.y,scaleX:n,scaleY:n},120).to({x:r.x,y:r.y,scaleX:1,scaleY:1},50),e.alpha=0,egret.Tween.get(e).wait(100).to({alpha:1},100).wait(90).to({alpha:0},10)},e.prototype.showAnim=function(){this._fire_lizi.start();var t=this;egret.Tween.get(this._fire_lizi,{loop:!1}).wait(500).to({alpha:0},200).call(function(){this._fire_lizi&&(t.removeChildFromContainer(this._fire_lizi),this._fire_lizi=null)})},e.prototype.getTitleStr=function(){return null},e.prototype.getCloseBtnName=function(){return null},e.prototype.isTouchMaskClose=function(){return!0},e.prototype.getBgExtraHeight=function(){return 30},e.prototype.getBgName=function(){return"public_9_wordbg"},e.prototype.hide=function(){this._obj&&this._callbackF&&this._callbackF.apply(this._obj),t.prototype.hide.call(this)},e.prototype.dispose=function(){this._callbackF=null,this._obj=null,this._fire_lizi=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(ConquestWinPopupView.prototype,"ConquestWinPopupView");var BossRecSelectedScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.recoveryHandler=function(){App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_DAILYBOSS_RECOVER,this.refresh,this),NetManager.request(NetRequestConst.REQUEST_DAILYBOSS_RECOVER,{servantId:this._servantInfo[0]})},e.prototype.refresh=function(t){var e=t.data;if(e.ret){if(App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_DAILYBOSS_RECOVER,this.refresh,this),this._useBtn){var i=this._useBtn,a=i.x,n=i.y;this._useBtn.dispose();var o=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"gotowar",this.clickBtnHandler,this);o.setPosition(a,n),this.addChild(o),this._useBtn=o}App.CommonUtil.showTip(LanguageManager.getlocal("dailybossRecoveryBattleSuccessDesc"))}},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_DAILYBOSS_RECOVER,this.refresh,this),t.prototype.dispose.call(this)},e}(BossSelectedScrollItem);__reflect(BossRecSelectedScrollItem.prototype,"BossRecSelectedScrollItem");var DailybossAttackedPopupView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["dailybosslastattackpopupview","allianceboss_fight_text"])},e.prototype.initView=function(){this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f),this.addTouchTap(this.hide,this);var t=this.param.data;if(3==t.type){var e=ComponentManager.getTextField(LanguageManager.getlocal("dailybossHasKill"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);return e.setPosition((this.viewBg.width-e.width)/2,38),void this.addChildToContainer(e)}var i,a,n=LanguageManager.getlocal("dailybossNameType2");1==t.type?(i="dailybosslastattacktitle",a=LanguageManager.getlocal("alliancebossattacked1",[n,n,String(t.damage)])):(i="allianceboss_fight_text",a=LanguageManager.getlocal("alliancebossattacked2",[n,String(t.damage)]));var o=BaseBitmap.create(i);o.setPosition((this.viewBg.width-o.width)/2,10),this.addChildToContainer(o);var s=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);s.textAlign=egret.HorizontalAlign.CENTER,s.width=480,s.lineSpacing=6,s.setPosition((this.viewBg.width-s.width)/2,o.y+o.height+18),this.addChildToContainer(s);var r=0;if(1==t.type){var l=GameData.formatRewardItem(t.rewards)[0],h=GameData.getItemIcon(l);h.setPosition((this.viewBg.width-h.width)/2,s.y+s.height+16),this.addChildToContainer(h),r=105}var d=ComponentManager.getTextField(LanguageManager.getlocal("dailybossRankValue1Desc")+App.StringUtil.formatStringColor("+"+t.exp,TextFieldConst.COLOR_WARN_GREEN),TextFieldConst.FONTSIZE_CONTENT_COMMON);d.setPosition(GameConfig.stageWidth/2-50-d.width,s.y+s.height+r+30),this.addChildToContainer(d);var g=ComponentManager.getTextField(LanguageManager.getlocal("dailybossPoint")+App.StringUtil.formatStringColor("+"+t.exp,TextFieldConst.COLOR_WARN_GREEN),TextFieldConst.FONTSIZE_CONTENT_COMMON);g.setPosition(GameConfig.stageWidth/2+50,d.y),this.addChildToContainer(g)},e.prototype.getTitleStr=function(){return null},e.prototype.getCloseBtnName=function(){return null},e.prototype.isTouchMaskClose=function(){return!0},e.prototype.getBgExtraHeight=function(){return 10},e.prototype.getBgName=function(){return"public_9_wordbg"},e.prototype.hide=function(){this._obj&&this._callbackF&&this._callbackF.apply(this._obj),t.prototype.hide.call(this)},e.prototype.dispose=function(){this._callbackF=null,this._obj=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(DailybossAttackedPopupView.prototype,"DailybossAttackedPopupView");var DailybossBattleResultPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){},e.prototype.getBattleData=function(){return this.param.data},e.prototype.getBgName=function(){return"public_rule_bg"},e}(PopupView);__reflect(DailybossBattleResultPopupView.prototype,"DailybossBattleResultPopupView");var DailybossBattleView=function(t){function e(){var e=t.call(this)||this;return e._heroRattle=null,e._attackEffect=null,e._hasKill=0,e._exp=0,e._dps=0,e._rewards=null,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_DAILYBOSS_RECOVER,this.autoSetServant,this);var t=BaseLoadBitmap.create("dailyboss_battle_soldier");if(t.setPosition(0,GameConfig.stageHeigth-760),this.addChildToContainer(t),this.initAttackRank(),2!=Api.dailybossVoApi.getBossType()||this._bossData.hp){this.initAttackBtn(),this.autoSetServant(),this.setBossUIStatus();var e=BaseBitmap.create("promotion_officerbg1");e.setPosition((GameConfig.stageWidth-e.width*e.scaleX)/2,300),this.addChildToContainer(e),this._nameBg=e;var i=ComponentManager.getTextField(this.getbossName(),TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_WARN_YELLOW);i.width=e.width*e.scaleX,i.textAlign=egret.HorizontalAlign.CENTER,i.setPosition(e.x,e.y+(e.height*e.scaleY-i.height)/2),this.addChildToContainer(i),this._nameTxt=i,this._bossData&&(this.setTopProgress(this._bossData.hp,this._bossData.totalHp,GameConfig.stageWidth-160,Api.dailybossVoApi.getBossType()),this._topProgress.y=10),this.initPao(),this.checkShowLastRankRewardView()}else this.showKillBossBattleResult()},e.prototype.getbossName=function(){var t;if(1==Api.dailybossVoApi.getBossType()){var e=this._bossData.bossLv;t=LanguageManager.getlocal("dailybossNameType1",[e.toString()]),e>15&&(e=15),t+=LanguageManager.getlocal("dailybossName"+e)}else t=LanguageManager.getlocal("dailybossNameType2");return t},e.prototype.getBossType=function(){return Api.dailybossVoApi.getBossType()},e.prototype.setBossUIStatus=function(){var t=0;this._bossData.bossLv&&1==Api.dailybossVoApi.getBossType()&&(t=(this._bossData.bossLv-1)%5+1);var e="dailyboss_lv_"+t;if(this._bossImg!=e){this._upHero?this._upHero.resetHero(e):(this.setUpHero(e,null,3),this._upHero.y=50,this._upPositon.y=this._upHero.y);var i=new BattleRattle;i.init(this.container,260,2),i.setPosition(350,this._upHero.y),i.resetString(null,3e3,2),this._nameTxt&&(this._nameTxt.text=this.getbossName())}this._bossImg=e},e.prototype.checkShowLastRankRewardView=function(){this._lastReward&&(ViewController.getInstance().openView(ViewConst.POPUP.DAILYBOSSRANKREWARDPOPUPVIEW,this._lastReward),this._lastReward=null)},e.prototype.initAttackBtn=function(){this._attackBtn=ComponentManager.getButton("boss_start_war","",this.attackHandle,this),this._attackBtn.setPosition((GameConfig.stageWidth-this._attackBtn.width)/2,this._buttomBg.y-this._attackBtn.height-20),this.addChildToContainer(this._attackBtn),this._attackBtn.visible=!1},e.prototype.initPao=function(){this._pao=new DailybossPao,this._pao.setPosition(GameConfig.stageWidth-this._pao.width,-this.container.y+GameConfig.stageHeigth-this._pao.height-this._buttomBg.height),this.addChildToContainer(this._pao)},e.prototype.initAttackRank=function(){var t=BaseBitmap.create("public_9_downbg");t.width=GameConfig.stageWidth,t.height=172,t.setPosition(0,GameConfig.stageHeigth-this.container.y-t.height),this.addChildToContainer(t),this._buttomBg=t;var e=ComponentManager.getTextField(LanguageManager.getlocal("dailybossDamageRankTitle"+Api.dailybossVoApi.getBossType()),TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_WARN_GREEN);e.lineSpacing=2,e.width=TextFieldConst.FONTSIZE_BUTTON_COMMON+4,e.height=this._buttomBg.height,e.verticalAlign=egret.VerticalAlign.MIDDLE,e.setPosition(this._buttomBg.x+20,this._buttomBg.y),this.addChildToContainer(e),this._myRankItem||(this._myRankItem=ScrollListItem.create(DailybossDamageRankListItem,-1,this._bossData.myrank),this._myRankItem.setPosition(55,this._buttomBg.y+this._buttomBg.height-this._myRankItem.height-10),this.addChildToContainer(this._myRankItem));var i=egret.Rectangle.create();if(1==Api.dailybossVoApi.getBossType())i.setTo(0,0,this._buttomBg.width-60,this._myRankItem.y-this._buttomBg.y+15),this._myRankItem.visible=!1,this._attackRankList=ComponentManager.getScrollList(DailybossRewardListItem,this._bossData.logInfo,i),this._attackRankList.setPosition(55,this._buttomBg.y+10);else{i.setTo(0,0,this._buttomBg.width-60,this._myRankItem.y-this._buttomBg.y-10),this._attackRankList=ComponentManager.getScrollList(DailybossDamageRankListItem,this._bossData.rankList,i),this._attackRankList.setPosition(55,this._buttomBg.y+10);var a=ComponentManager.getButton("dailybossbattle_more","lookMore",this.damageRankHandler,this);a.setPosition(GameConfig.stageWidth-a.width,this._buttomBg.y-a.height+95),this.addChild(a)}this._attackRankList.setEmptyTip(LanguageManager.getlocal("dinnerMsgPopupEmptyTip")),this.addChildToContainer(this._attackRankList)},e.prototype.setAttackRank=function(){this._attackRankList&&(1==Api.dailybossVoApi.getBossType()?this._attackRankList.refreshData(this._bossData.logInfo):this._attackRankList.refreshData(this._bossData.rankList)),this._myRankItem&&this._myRankItem.refresh(-1,this._bossData.myrank)},e.prototype.setDownHero=function(t,e){if(this._downHero)this._downHero.resetHero(t);else{this._downHero=new BattleHero,this._downHero.init(t,e,3,1),this._downHero.setPosition(0,-this.container.y+GameConfig.stageHeigth-this._downHero.height*this._downHero.scaleY-165),this.container.addChildAt(this._downHero,0),this._downHero.addTouchTap(this.showSelectServantHandler,this),this._downPositon=egret.Point.create(this._downHero.x,this._downHero.y);var i=BaseBitmap.create("promotion_officerbg1");i.setPosition(this._downHero.x+(this._downHero.width*this._downHero.scaleX-i.width)/2,this._downHero.y+this._downHero.height*this._downHero.scaleY-i.height-10),this.addChildToContainer(i),this._changePic=i;var a=ComponentManager.getTextField(App.StringUtil.formatStringColor(LanguageManager.getlocal("dailybossChangeServantDesc"),TextFieldConst.COLOR_WARN_YELLOW),TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_WARN_YELLOW);a.width=i.width,a.textAlign=egret.HorizontalAlign.CENTER,a.setPosition(i.x,i.y+(i.height-a.height)/2),this.addChildToContainer(a),i.addTouchTap(this.showSelectServantHandler,this),this._changeTxt=a,this._heroRattle=new BattleRattle,this._heroRattle.init(this.container,295,2),this._heroRattle.setPosition(140,this._downHero.y-30)}if(this._selectServantId){var n=Api.servantVoApi.getServantCombatWithId(String(this._selectServantId)),o=LanguageManager.getlocal("dailybossServantBattleTip",[LanguageManager.getlocal("servant_name"+this._selectServantId),n.toString()]);this._heroRattle.resetString(o,-1),this._heroRattle.visible=!0}else this._heroRattle.visible=!1},e.prototype.attackHandle=function(t,e,i){this._isMoving||(this._selectServantId?this.request(NetRequestConst.REQUEST_DAILYBOSS_ATTACK,{servantId:this._selectServantId}):App.CommonUtil.showTip(LanguageManager.getlocal("dailybossNoServantCanBattleDesc")))},e.prototype.showSelectServantHandler=function(){var t=this;if(null==this._allServantInfo){this._allServantInfo={};var e=Api.servantVoApi.getServantInfoIdListWithSort(1);for(var i in e){var a=e[i];this._allServantInfo[a]=Api.servantVoApi.getServantCombatWithId(a)}}this._curKey=null,this._leftValue=0;var n=Object.keys(this._allServantInfo);n.sort(function(e,i){var a=Api.dailybossVoApi.checkServantcanStatus(e),n=Api.dailybossVoApi.checkServantcanStatus(i);return a==n?Number(t._allServantInfo[i]-t._allServantInfo[e]):Number(a-n)}),0==Api.dailybossVoApi.checkServantcanStatus(n[0])&&(this._curKey=n[0],this._leftValue=this._allServantInfo[this._curKey]),this._rightValue;var o=[];for(var i in n){var a=n[i];o.push([a,Api.dailybossVoApi.checkServantcanStatus(a),this._allServantInfo[a]])}o.sort(function(t,e){var i=t[1],a=e[1];return i==a?Number(e[2]-t[2]):Number(i-a)}),ViewController.getInstance().openView(ViewConst.POPUP.SERVANTSELECTEDPOPUPVIEW,{type:ServantSelectedPopupView.TYPE_BATTLE_REC1,info:o,callback:this.selectServantHandler,handler:this})},e.prototype.autoSetServant=function(){this.setServant(Api.dailybossVoApi.findBestServant(this._bossData.hp))},e.prototype.setServant=function(t){this._selectServantId=t;var e=Config.ServantCfg.getServantItemById(this._selectServantId),i=e?e.fullIcon:null;this.setDownHero(i),i&&(this._attackBtn.visible=!0)},e.prototype.selectServantHandler=function(t){var e=t.key;this._selectServantId=e,this._downHero.resetHero(Config.ServantCfg.getServantItemById(e).fullIcon),this.setDownHero(Config.ServantCfg.getServantItemById(e).fullIcon)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["promotion_officerbg1","progress8","progress7_bg","boss_start_war","boss_start_war_down","dailyboss_kaopao","dailybossbattle_more","dailybossbattle_more_down"])},e.prototype.getHitAnimSources=function(){return"dailyboss_baozha"},e.prototype.getHitAnimInfo=function(){return["dailyboss_baozha_",9]},e.prototype.getTitleBgName=function(){return"commonview_titlebg"},e.prototype.getTitleStr=function(){return"dailybossTitle"},e.prototype.getBgName=function(){return"dailyboss_battle_bg"},e.prototype.playHitEffcet=function(){SoundManager.playEffect(SoundConst.EFFECT_DAILYBOSS_HIT)},e.prototype.playFireEffcet=function(){SoundManager.playEffect(SoundConst.EFFECT_DAILYBOSS_FIRE)},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_DAILYBOSS_GETDETAILS,requestData:{}}},e.prototype.receiveData=function(t){if(t.ret)if(t.data.data.bossData&&(this._bossData=t.data.data.bossData),t.data.data.lastReward&&(this._lastReward=t.data.data.lastReward),null==this._bossData.myrank&&(this._bossData.myrank={}),Object.keys(this._bossData.myrank).length<1&&(this._bossData.myrank={uid:Api.playerVoApi.getPlayerID(),title:Api.playerVoApi.getTitleid(),value:0,myrank:"10000+",name:Api.playerVoApi.getPlayerName()}),null==this._bossData.myrank.name&&(this._bossData.myrank.name=Api.playerVoApi.getPlayerName()),t.data.cmd==NetRequestConst.REQUEST_DAILYBOSS_ATTACK){if(this._hasKill=t.data.data.hasKill,1==this._hasKill)return ViewController.getInstance().openView(ViewConst.POPUP.DAILYBOSSATTACKEDPOPUPVIEW,{type:3,f:this.killBossCallback,o:this}),void NetManager.request(NetRequestConst.REQUEST_DAILYBOSS_GETDETAILS,{});this._exp=t.data.data.bossData.score,this._rewards=t.data.data.bossData.rewards,this._dps=t.data.data.bossData.damage,this.playAttackEffect()}else t.data.data.rewards&&App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.rewards))},e.prototype.killBossCallback=function(){this.refreshUIStatusByAttack()},e.prototype.playAttackEffect=function(){this._isMoving=!0,this._attackBtn.visible=!1;var t=1.06,e=egret.Point.create(this._downHero.x-(t-1)*this._downHero.width/2,this._downHero.y-(t-1)*this._downHero.height/2);egret.Tween.get(this._downHero).to({x:e.x,y:e.y,scaleX:t,scaleY:t},300).to({x:this._downHero.x,y:this._downHero.y,scaleX:1,scaleY:1},300).call(this.fireEffect,this)},e.prototype.fireEffect=function(){this._attackEffect=ComponentManager.getCustomMovieClip("dailyboss_kaopao_",8,30),this._attackEffect.setPosition(this._pao.x+48,this._pao.y+11),this._attackEffect.setEndCallBack(this.fireCallback,this),this._attackEffect.play(1),this.addChildToContainer(this._attackEffect),this.playFireEffcet(),this._pao.kaiPao();var t=this,e=(this._pao.getAngle(),BaseBitmap.create("dailybossbattle_paodan"));e.setPosition(this._pao.x+40,this._pao.y),t.addChildToContainer(e),App.DisplayUtil.addFactorFunc(BaseBitmap);var i=egret.Point.create(this._upHero.x+this._upHero.width/2-e.width/2,this._upHero.y+this._upHero.height/2-e.height/2);e.tweenMoveList=[egret.Point.create(e.x,e.y),egret.Point.create(e.x/2+i.x/2+80,e.y/2+i.y/2-80),i],egret.Tween.get(e).to({factor:1},300).call(function(e){e&&(e.tweenMoveList=void 0,e.dispose(),t.showBossBehit())},t,[e])},e.prototype.fireCallback=function(){this._attackEffect.dispose()},e.prototype.showBossBehit=function(){this._heroArray.length=0,this._damage=this._bossData.damage,this._area=1;this._heroArray=[this._downHero,this._upHero],this.showBeAttackAnim()},e.prototype.atkEndCallback=function(){this.refreshUIStatusByAttack(),this._bossData&&(this._bossData.hp||(this._bossData.killFlag?(App.MessageHelper.addEventListener(ViewConst.POPUP.DAILYBOSSLASTATTACKPOPUPVIEW,this.checkShowLastRankRewardView,this),ViewController.getInstance().openView(ViewConst.POPUP.DAILYBOSSLASTATTACKPOPUPVIEW,this._bossData)):this.checkShowLastRankRewardView()))},e.prototype.showKillBossBattleResult=function(){if(!this._killBossContainer){this._killBossContainer=new BaseDisplayObjectContainer;var t=egret.Rectangle.create();t.setTo(0,0,345,401);var e=BaseLoadBitmap.create("dailybossbattle_successbg",t);this._killBossContainer.addChild(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("dailybossKillerDesc",[this._bossData.killName]),TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);i.lineSpacing=5,i.textAlign=egret.HorizontalAlign.CENTER,i.setPosition(e.x+(e.width-i.width)/2,e.y+150),this._killBossContainer.addChild(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("dailybossPersonNumDesc",[this._bossData.joinNum.toString()]),TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);if(a.setPosition(e.x+(e.width-a.width)/2,i.y+i.height+20),this._killBossContainer.addChild(a),!Api.switchVoApi.checkOpenShenhe()){var n=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"dailybossDamageRankTitle2",this.damageRankHandler,this);n.setPosition(e.x+(e.width-n.width)/2,a.y+a.height+25),this._killBossContainer.addChild(n),this._killBossContainer.setPosition((GameConfig.stageWidth-this._killBossContainer.width)/2,-this.container.y+(GameConfig.stageHeigth-this._killBossContainer.height)/2),this.addChildToContainer(this._killBossContainer)}}},e.prototype.damageRankHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.DAILYBOSSDAMAGERANKPOPUPVIEW,{rankList:this._bossData.rankList,myrank:this._bossData.myrank})},e.prototype.refreshUIStatusByAttack=function(){this.setAttackRank(),2!=this.getBossType()||this._bossData.hp?(this.setTopProgress(this._bossData.hp,this._bossData.totalHp),this.autoSetServant()):(this._upHero&&(this._upHero.visible=!1),this._topProgress&&(this._topProgress.visible=!1),this._nameBg&&(this._nameBg.visible=!1),this._nameTxt&&(this._nameTxt.visible=!1),this._attackBtn&&(this._attackBtn.visible=!1),this._downHero&&(this._downHero.visible=!1),this._pao&&(this._pao.visible=!1),this._changePic&&(this._changePic.visible=!1),this._changeTxt&&(this._changeTxt.visible=!1),this._heroRattle&&(this._heroRattle.visible=!1),this.showKillBossBattleResult()),this.setBossUIStatus(),1==this.getBossType()&&this._bossData.isDead?ViewController.getInstance().openView(ViewConst.POPUP.DAILYBOSSTYPE1BATTLERESULTPOPUPVIEW,this._bossData):2==this.getBossType()&&(this._bossData.killFlag||ViewController.getInstance().openView(ViewConst.POPUP.DAILYBOSSATTACKEDPOPUPVIEW,{type:2,damage:this._dps,exp:this._exp}))},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_DAILYBOSS_RECOVER,this.autoSetServant,this),App.MessageHelper.removeEventListener(ViewConst.POPUP.DAILYBOSSLASTATTACKPOPUPVIEW,this.checkShowLastRankRewardView,this),this._bossData=null,this._buttomBg=null,this._attackBtn=null,this._pao=null,this._selectServantId=null,this._attackRankList=null,this._myRankItem=null,this._nameBg=null,this._nameTxt=null,this._killBossContainer=null,this._bossImg=null,this._heroRattle=null,this._attackEffect=null,this._hasKill=null,this._dps=0,this._exp=0,this._rewards=null,this._allServantInfo=null,t.prototype.dispose.call(this)},e}(BaseBattleView);__reflect(DailybossBattleView.prototype,"DailybossBattleView");var DailybossDamageRankListItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){var i=null==e.myrank?TextFieldConst.COLOR_WHITE:TextFieldConst.COLOR_LIGHT_YELLOW,a=ComponentManager.getTextField((null!=e.myrank?e.myrank:String(t+1))+"."+e.name,TextFieldConst.FONTSIZE_CONTENT_SMALL,i);this.addChild(a),this._nameTxt=a,a.y=5;var n=ComponentManager.getTextField(LanguageManager.getlocal("dailybossDamageValueDesc",[e.value.toString()]),TextFieldConst.FONTSIZE_CONTENT_SMALL,i);if(n.setPosition(360,0),this.addChild(n),this._valueTxt=n,n.y=5,e.uid==Api.playerVoApi.getPlayerID()&&(a.textColor=TextFieldConst.COLOR_WARN_YELLOW,n.textColor=TextFieldConst.COLOR_WARN_YELLOW),e.title){var o=BaseLoadBitmap.create(Config.TitleCfg.getTitleCfgById(e.title).titleIcon3);o.setScale(.6),o.setPosition(220,o.height/2-5),this.addChild(o),this._titleIcon=o}this.width=500},e.prototype.refresh=function(t,e){if(this._nameTxt&&(this._nameTxt.text=(null!=e.myrank?e.myrank:String(t+1))+"."+e.name),this._valueTxt&&(this._valueTxt.text=LanguageManager.getlocal("dailybossDamageValueDesc",[e.value.toString()])),e.title)if(this._titleIcon)this._titleIcon.setload(Config.TitleCfg.getTitleCfgById(e.title).titleIcon3);else{var i=BaseLoadBitmap.create(Config.TitleCfg.getTitleCfgById(e.title).titleIcon3);i.setScale(.6),i.setPosition(220,3),this.addChild(i),this._titleIcon=i}},e.prototype.dipose=function(){this._nameTxt=null,this._titleIcon=null,this._valueTxt=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(DailybossDamageRankListItem.prototype,"DailybossDamageRankListItem");var DailybossDamageRankPopupView=function(t){function e(){var e=t.call(this)||this;return e._rankList=null,e._myrank=null,e}return __extends(e,t),e.prototype.getTitleStr=function(){return"dailybossDamageRankTitle2"},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_DAILYBOSS_GETATTACKRANK,requestData:{}}},e.prototype.receiveData=function(t){this._rankList=t.data.data.bossData.rankList,this._myrank=t.data.data.bossData.myrank},e.prototype.initView=function(){this._nodeContainer=new BaseDisplayObjectContainer,this._nodeContainer.height=800,this.addChildToContainer(this._nodeContainer);var t=20,e=ComponentManager.getTextField(LanguageManager.getlocal("dailybossDamageRankTittle"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);e.x=30,e.y=t,this._nodeContainer.addChild(e),t+=30;var i=BaseBitmap.create("public_9_bg32");i.width=520,i.height=665,i.x=this.viewBg.width/2-i.width/2,i.y=t,this._nodeContainer.addChild(i),i.name="bg1";var a=BaseBitmap.create("public_9_bg33");a.width=i.width,a.height=40,a.x=i.x,a.y=i.y,this._nodeContainer.addChild(a),a.name="bg2";var n=BaseBitmap.create("public_9_bg1");n.width=i.width,n.height=100,n.x=i.x,n.y=i.y+i.height+9,this._nodeContainer.addChild(n),n.name="bg3";var o=ComponentManager.getTextField(LanguageManager.getlocal("allianceBossRank_title1"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);o.x=a.x+30,o.y=a.y+8,this._nodeContainer.addChild(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("allianceBossRank_title2"),o.size,TextFieldConst.COLOR_LIGHT_YELLOW);s.x=a.x+180,s.y=o.y,this._nodeContainer.addChild(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("allianceBossRank_title3"),o.size,TextFieldConst.COLOR_LIGHT_YELLOW);r.x=a.x+410-r.width/2,r.y=o.y,this._nodeContainer.addChild(r);var l=this._rankList,h=this._myrank;Object.keys(h).length<1&&(h={uid:Api.playerVoApi.getPlayerID(),title:Api.playerVoApi.getTitleid(),value:0,myrank:"10000+",name:Api.playerVoApi.getPlayerName()});var d=Api.playerVoApi.getPlayerName();for(var g in l)if(l[g][0]==d){h[0]=String(Number(g)+1),h[1]=l[g][1],h[2]=l[g][2];break}var c=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);c.text=LanguageManager.getlocal("allianceBossRank_title5",[Api.playerVoApi.getPlayerName()]),c.x=n.x+20,c.y=n.y+20,this._nodeContainer.addChild(c);var p=ComponentManager.getTextField("",c.size,TextFieldConst.COLOR_LIGHT_YELLOW);p.text=LanguageManager.getlocal("allianceBossRank_title6",[String(h.myrank)]),p.x=p.x+320,p.y=c.y,this._nodeContainer.addChild(p);var _=ComponentManager.getTextField("",c.size,TextFieldConst.COLOR_LIGHT_YELLOW);
_.text=LanguageManager.getlocal("allianceBossRank_title7",[String(h.value)]),_.x=c.x,_.y=c.y+40,this._nodeContainer.addChild(_);var u=new egret.Rectangle(0,0,this.viewBg.width,i.height-60),C=ComponentManager.getScrollList(RankPopupListItem,l,u);C.setEmptyTip(LanguageManager.getlocal("allianceBossRank_emptyTip")),C.x=25,C.y=a.y+50,this._nodeContainer.addChild(C)},e.prototype.dispose=function(){this._scrollList=null,this._nodeContainer=null,this._rankList=null,this._myrank=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(DailybossDamageRankPopupView.prototype,"DailybossDamageRankPopupView");var DailybossLastAttackPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("dailybosslastattacktitle");t.setPosition((this.viewBg.width-t.width)/2,10),this.addChildToContainer(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("dailybossType2LastAttackDesc",[Config.DailybossCfg.getBossNameByType(2)]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);e.textAlign=egret.HorizontalAlign.CENTER,e.width=450,e.lineSpacing=5,e.setPosition((this.viewBg.width-e.width)/2,t.y+t.height+30),this.addChildToContainer(e);var i=GameData.formatRewardItem(this.getBattleData().rewards)[0],a=ComponentManager.getTextField(i.name+App.StringUtil.formatStringColor("+"+i.num,TextFieldConst.COLOR_WARN_GREEN),TextFieldConst.FONTSIZE_CONTENT_COMMON);a.setPosition(e.x+30,e.y+e.height+20),this.addChildToContainer(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("dailybossRankValue1Desc")+App.StringUtil.formatStringColor("+"+this.getBattleData().score,TextFieldConst.COLOR_WARN_GREEN),TextFieldConst.FONTSIZE_CONTENT_COMMON);n.setPosition(e.x+e.width-n.width-30,a.y),this.addChildToContainer(n),this.addTouchTap(this.hide,this)},e.prototype.getTitleStr=function(){return null},e.prototype.getCloseBtnName=function(){return null},e.prototype.isTouchMaskClose=function(){return!0},e.prototype.getBattleData=function(){return this.param.data},e.prototype.getBgName=function(){return"public_9_wordbg"},e.prototype.dispose=function(){App.MessageHelper.dispatchEvent(ViewConst.POPUP.DAILYBOSSLASTATTACKPOPUPVIEW),t.prototype.dispose.call(this)},e}(PopupView);__reflect(DailybossLastAttackPopupView.prototype,"DailybossLastAttackPopupView");var DailybossPao=function(t){function e(){var e=t.call(this)||this;return e.posArr=[{x:75,y:79},{x:53,y:0},{x:0,y:81}],e.init(),e}return __extends(e,t),e.prototype.init=function(){for(var t=1;4>t;t++){var e=BaseBitmap.create("dailybossbattle_pao"+t);if(e.setPosition(this.posArr[t-1].x,this.posArr[t-1].y),2==t){this._paotong=e,this._angle=Math.atan2(this._paotong.height,this._paotong.width);var i=100,a=Math.cos(this._angle)*i,n=Math.sin(this._angle)*i;this._moveData={distance:i,x:a,y:n}}this.addChild(e)}},e.prototype.getAngle=function(){return this._angle},e.prototype.kaiPao=function(t,e){var i=this,a=this.posArr[1];egret.Tween.get(this._paotong).to({x:a.x+this._moveData.x,y:a.y+this._moveData.y,scaleX:1.02,scaleY:1.02},50).call(function(){var t=ComponentManager.getCustomMovieClip("dailyboss_kaopao_",8);t.setPosition(-74,-127),t.setEndCallBack(function(t){t&&t.dispose()}.bind(i,t,i),i),t.play(1),i.addChildAt(t,0)},this).to({x:a.x,y:a.y,scaleX:1,scaleY:1},100).call(function(t){t&&egret.Tween.removeTweens(t)},this,[this._paotong])},e.prototype.dispose=function(){this._paotong=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(DailybossPao.prototype,"DailybossPao");var DailybossRankPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"bossData",{get:function(){return this.param.data},enumerable:!0,configurable:!0}),e.prototype.getTabbarTextArr=function(){return["dailybossScoreRankTitle","dailybossKillRankTitle"]},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_DAILYBOSS_GETRANK,requestData:{}}},e.prototype.receiveData=function(t){this._acrank=t.data.data.acrank,this._killrank=t.data.data.killrank},e.prototype.getTitleValueStr=function(){return 0==this._selectedTabIndex?LanguageManager.getlocal("dailybossRankValue1Desc"):1==this._selectedTabIndex?LanguageManager.getlocal("dailybossRankValue2Desc"):void 0},e.prototype.getListItemClass=function(){return 0==this._selectedTabIndex?DailybossRankList1Item:1==this._selectedTabIndex?DailybossRankList2Item:void 0},e.prototype.getScrollDataList=function(){return 0==this._selectedTabIndex?this._acrank.rankList:1==this._selectedTabIndex?this._killrank:void 0},e.prototype.initButtomInfo=function(){if(0==this._selectedTabIndex){var t=ComponentManager.getTextField(LanguageManager.getlocal("acRank_mynick")+Api.playerVoApi.getPlayerName(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);t.x=20,t.y=20,this.buttomContainer.addChild(t);var e="10000+",i=0;this._acrank.myrank.myrank&&(e=String(this._acrank.myrank.myrank),i=this._acrank.myrank.value);var a=ComponentManager.getTextField("",t.size,TextFieldConst.COLOR_LIGHT_YELLOW);a.text=LanguageManager.getlocal("acRank_myrank",[e]),a.x=t.x,a.y=t.y+40,this.buttomContainer.addChild(a);var n=ComponentManager.getTextField("",t.size,TextFieldConst.COLOR_LIGHT_YELLOW);n.text=LanguageManager.getlocal("dailybossRankValue1Desc")+LanguageManager.getlocal("syscolonDesc")+App.StringUtil.formatStringColor(this._acrank.myrank.value?this._acrank.myrank.value:0,TextFieldConst.COLOR_WARN_GREEN),n.x=a.x+240,n.y=a.y,this.buttomContainer.addChild(n)}else if(1==this._selectedTabIndex&&this._killrank&&this._killrank[0]){var o=ComponentManager.getTextField(LanguageManager.getlocal("dailybossLastKillTimeDesc",[this._killrank[0].name]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);o.setPosition((this.buttomContainer.width-o.width)/2,(this.buttomContainer.height-o.height)/2),this.buttomContainer.addChild(o)}},e.prototype.getBgExtraHeight=function(){return 10},e}(RankPopupView);__reflect(DailybossRankPopupView.prototype,"DailybossRankPopupView");var DailybossRankList1Item=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(RankPopupListItem);__reflect(DailybossRankList1Item.prototype,"DailybossRankList1Item");var DailybossRankList2Item=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(RankPopupListItem);__reflect(DailybossRankList2Item.prototype,"DailybossRankList2Item");var DailybossRankRewardPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("dailybossranktitle");t.setPosition((this.viewBg.width-t.width)/2,10),this.addChildToContainer(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("dailybossType2RankDesc",[Config.DailybossCfg.getBossNameByType(2),this.getBattleData().myrank.toString()]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);e.textAlign=egret.HorizontalAlign.CENTER,e.lineSpacing=5,e.width=450,e.setPosition((this.viewBg.width-e.width)/2,t.y+t.height+30),this.addChildToContainer(e);var i=GameData.formatRewardItem(this.getBattleData().rewards)[0],a=ComponentManager.getTextField(i.name+App.StringUtil.formatStringColor("+"+i.num,TextFieldConst.COLOR_WARN_GREEN),TextFieldConst.FONTSIZE_CONTENT_COMMON);a.setPosition(e.x+30,e.y+e.height+20),this.addChildToContainer(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("dailybossRankValue1Desc")+App.StringUtil.formatStringColor("+"+this.getBattleData().score,TextFieldConst.COLOR_WARN_GREEN),TextFieldConst.FONTSIZE_CONTENT_COMMON);n.setPosition(e.x+e.width-n.width-30,a.y),this.addChildToContainer(n),this.addTouchTap(this.hide,this)},e.prototype.getTitleStr=function(){return null},e.prototype.getCloseBtnName=function(){return null},e.prototype.isTouchMaskClose=function(){return!0},e.prototype.getBattleData=function(){return this.param.data},e.prototype.getBgName=function(){return"public_9_wordbg"},e}(PopupView);__reflect(DailybossRankRewardPopupView.prototype,"DailybossRankRewardPopupView");var DailybossRewardListItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){var i=null==e.myrank?TextFieldConst.COLOR_WHITE:TextFieldConst.COLOR_LIGHT_YELLOW,a=ComponentManager.getTextField((null!=e.myrank?e.myrank:String(t+1))+"."+e.name,TextFieldConst.FONTSIZE_CONTENT_SMALL,i);this.addChild(a),this._nameTxt=a,a.y=5;var n=GameData.formatRewardItem(e.rewards)[0],o=n.name+"*"+n.num,s=ComponentManager.getTextField(LanguageManager.getlocal("dailybossRankReward",[e.bossLv.toString(),o]),TextFieldConst.FONTSIZE_CONTENT_SMALL,i);if(s.setPosition(230,0),this.addChild(s),this._valueTxt=s,s.y=5,e.title){var r=BaseLoadBitmap.create(Config.TitleCfg.getTitleCfgById(e.title).titleIcon3);r.setScale(.6),r.setPosition(a.x+a.width+10,3),this.addChild(r),this._titleIcon=r}this.width=500},e.prototype.refresh=function(t,e){if(this._nameTxt&&(this._nameTxt.text=(null!=e.myrank?e.myrank:String(t+1))+"."+e.name),this._valueTxt&&(this._valueTxt.text=LanguageManager.getlocal("dailybossDamageValueDesc",[e.value.toString()])),e.title)if(this._titleIcon)this._titleIcon.setload(Config.TitleCfg.getTitleCfgById(e.title).titleIcon3);else{var i=BaseLoadBitmap.create(Config.TitleCfg.getTitleCfgById(e.title).titleIcon3);i.setScale(.6),i.setPosition(220,3),this.addChild(i),this._titleIcon=i}},e.prototype.dipose=function(){this._nameTxt=null,this._titleIcon=null,this._valueTxt=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(DailybossRewardListItem.prototype,"DailybossRewardListItem");var DailybossScroePopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getScoreDataList=function(){return Config.DailybossCfg.shopList},e.prototype.initMessage=function(){App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_DAILYBOSS_BUY,this.refresh,this)},e.prototype.getOwnScoreNum=function(){return Api.dailybossVoApi.getScore()},e.prototype.getListItemClass=function(){return DailybossScroePopupListItem},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_DAILYBOSS_BUY,this.refresh,this),t.prototype.dispose.call(this)},e}(ScorePopupView);__reflect(DailybossScroePopupView.prototype,"DailybossScroePopupView");var DailybossScroePopupListItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.needScore=function(){return Api.dailybossVoApi.getShopItemNeedScore(this._data.id)},e.prototype.getOwnScoreNum=function(){return Api.dailybossVoApi.getScore()},e.prototype.canExchangeNum=function(){return this._data.limit?this._data.limit-Api.dailybossVoApi.getShopItemByNum(String(this._idx+1)):1},e.prototype.getRequestType=function(){return NetRequestConst.REQUEST_DAILYBOSS_BUY},e}(ScorePopupListItem);__reflect(DailybossScroePopupListItem.prototype,"DailybossScroePopupListItem");var DailybossType1BattleResultPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this);var e=this.getBattleData(),i=ComponentManager.getTextField(LanguageManager.getlocal("dailybossKillBoss1ResultDesc",[String(e.bossLv-1)]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);if(i.textAlign=egret.HorizontalAlign.CENTER,i.setPosition((GameConfig.stageWidth-i.width)/2,this._winBg.y+220),this.addChildToContainer(i),e.score){var a=ComponentManager.getTextField(LanguageManager.getlocal("dailybossRankValue1Desc")+App.StringUtil.formatStringColor("+"+e.score,TextFieldConst.COLOR_WARN_GREEN),TextFieldConst.FONTSIZE_CONTENT_SMALL);a.setPosition((GameConfig.stageWidth-a.width)/2,i.y+i.height+10),this.addChild(a)}var n=ComponentManager.getTextField(LanguageManager.getlocal("clickToClose"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);n.textAlign=egret.HorizontalAlign.CENTER,n.setPosition((GameConfig.stageWidth-n.width)/2,this._winBg.y+this._winBg.height),this.addChildToContainer(n),this.addTouchTap(this.hide,this)},e.prototype.getIsCountDown=function(){return!1},e.prototype.getBattleData=function(){return this.param.data},e}(BattleWin);__reflect(DailybossType1BattleResultPopupView.prototype,"DailybossType1BattleResultPopupView");var DailybossView=function(t){function e(){var e=t.call(this)||this;return e._lastStatus=0,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat()},e.prototype.initView=function(){this.container.y=this.getTitleButtomY(),this._bg=BaseLoadBitmap.create("dailybossbg"),this._bg.y=GameConfig.stageHeigth-1136,this.addChildToContainer(this._bg),this._gate=BaseLoadBitmap.create("dailybossbg_gate"),this._gate.setPosition((GameConfig.stageWidth-299)/2-6,-this.container.y+(GameConfig.stageHeigth-352)),this.addChildToContainer(this._gate),this._gate.visible=!1;var t=368,e=68,i=BaseLoadBitmap.create("dailybosstitle"+Api.dailybossVoApi.getBossType());i.setPosition((GameConfig.stageWidth-368)/2,20),this.addChildToContainer(i);var a=BaseBitmap.create("public_itemtipbg2");a.width=t,a.setPosition(i.x+(a.width-t)/2,i.y+e+3),this.addChildToContainer(a);var n=ComponentManager.getTextField(this.getStatusStr(),TextFieldConst.FONTSIZE_TITLE_SMALL);n.width=a.width,n.textAlign=egret.HorizontalAlign.CENTER,n.setPosition(a.x+(a.width-n.width)/2,a.y+(a.height-n.height)/2),this.addChildToContainer(n),this._leftTimeTxt=n;var o=BaseBitmap.create("public_9_downbg");o.width=GameConfig.stageWidth,o.height=110,o.setPosition(0,GameConfig.stageHeigth-this.container.y-o.height),this.addChildToContainer(o);var s=ComponentManager.getTextField(Api.dailybossVoApi.getBossLocalTimeStr(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);if(s.lineSpacing=10,s.setPosition(o.x+20,o.y+(o.height-s.height)/2),this.addChildToContainer(s),!Api.switchVoApi.checkOpenShenhe()){var r=ComponentManager.getButton("btn_dailyboss","",this.showRankView,this);r.setPosition(10,o.y-r.height),this.addChildToContainer(r);var l=BaseBitmap.create("dailyboss_ranktxt"),h=App.CommonUtil.getCenterX(r,l,!0);l.setPosition(h,20),r.addChild(l)}var d=ComponentManager.getButton("btn_dailyboss","",this.showScoreView,this);d.setPosition(GameConfig.stageWidth-d.width-10,o.y-d.height),this.addChildToContainer(d);var g=BaseBitmap.create("dailyboss_scoretxt"),c=App.CommonUtil.getCenterX(d,g,!0);g.setPosition(c,20),d.addChild(g),this.tick(),this.checkShowLastRankRewardView()},e.prototype.checkShowLastRankRewardView=function(){this._lastReward&&(ViewController.getInstance().openView(ViewConst.POPUP.DAILYBOSSRANKREWARDPOPUPVIEW,this._lastReward),this._lastReward=null)},e.prototype.getStatusStr=function(){var t="",e=Api.dailybossVoApi.getStatus();return t=0==e?LanguageManager.getlocal("dailybossLeftTimeDesc",[App.DateUtil.getFormatBySecond(Api.dailybossVoApi.getNextStartLeftTime(),1)]):1==e?2==Api.dailybossVoApi.getBossType()&&this._bossData.isDead?LanguageManager.getlocal("dailybossEndWithKilled",[this._bossData.killName]):LanguageManager.getlocal("dailybossTypeComeOnDesc",[LanguageManager.getlocal("dailybossTitle"+Api.dailybossVoApi.getBossType())]):this._bossData.killName?LanguageManager.getlocal("dailybossKilled",[this._bossData.killName]):LanguageManager.getlocal("dailybossUnkilled")},e.prototype.showRankView=function(){ViewController.getInstance().openView(ViewConst.POPUP.DAILYBOSSRANKPOPUPVIEW,this._bossData)},e.prototype.showScoreView=function(){ViewController.getInstance().openView(ViewConst.POPUP.DAILYBOSSSCROEPOPUPVIEW)},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_DAILYBOSS_GET,requestData:{}}},e.prototype.receiveData=function(t){t.ret&&t.data.data&&(t.data.data.bossData&&(this._bossData=t.data.data.bossData),t.data.data.lastReward&&(this._lastReward=t.data.data.lastReward))},e.prototype.tick=function(){this._leftTimeTxt&&(this._leftTimeTxt.text=this.getStatusStr());var t=Api.dailybossVoApi.getStatus();1==t?this._enterBtn||(this._enterBtn=ComponentManager.getButton("dailyboss_enter","",this.enterBattle,this,null,1),this._enterBtn.setPosition(GameConfig.stageWidth/2-12,-this.container.y+(GameConfig.stageHeigth-540)),this._enterBtn.anchorOffsetX=this._enterBtn.width/2,this._enterBtn.anchorOffsetY=this._enterBtn.height/2,this.addChildToContainer(this._enterBtn),egret.Tween.get(this._enterBtn,{loop:!0}).to({scaleX:.9,scaleY:.9},600).to({scaleX:1,scaleY:1},600),this._gate.visible=!0):(this._enterBtn&&(this._enterBtn.dispose(),this._enterBtn=null),this._gate.visible=!1),this._lastStatus=t},e.prototype.enterBattle=function(){ViewController.getInstance().openView(ViewConst.BATTLE.DAILYBOSSBATTLEVIEW)},e.prototype.getTitleStr=function(){return"dailybossTitle"},e.prototype.dispose=function(){this._bossData=null,this._enterBtn=null,this._bg=null,this._leftTimeTxt=null,this._gate=null,this._lastReward=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(DailybossView.prototype,"DailybossView");var DailyTaskScrollItem=function(t){function e(){var e=t.call(this)||this;return e._taskId="",e._lastRequestTaskId=null,e._achRedDotSp=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DAILYTASK_GET),this.collectHandlerCallBack,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_RESFESH_DAILYTASK_AFTER_SYNC,this.refreshUI,this),this._taskId=e;var i=Config.DailytaskCfg.getDailytaskCfgByTaskId(this._taskId);this._nodeContainer=new BaseDisplayObjectContainer,this.addChild(this._nodeContainer);var a=BaseBitmap.create("public_9_bg14");a.width=616,a.height=148,a.x=GameConfig.stageWidth/2-a.width/2,this._nodeContainer.addChild(a);var n=BaseLoadBitmap.create("progress6_bg");n.width=130,n.height=112,n.x=a.x+7,n.y=20,this._nodeContainer.addChild(n);var o=BaseLoadBitmap.create("achievementicon_"+i.icon);o.width=88,o.height=88,o.x=n.x+n.width/2-44,o.y=n.y+n.height/2-44,this._nodeContainer.addChild(o);var s=void 0;s=BaseLoadBitmap.create("achievementname_"+i.icon,null,{callback:function(t){s&&(s.x=n.x+n.width/2-s.width/2)},callbackThisObj:this,callbackParams:[s]}),s.y=90,this._nodeContainer.addChild(s);var r=BaseBitmap.create("public_numbg");r.x=o.x+o.width+15,r.y=o.y,this._nodeContainer.addChild(r);var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_WARN_YELLOW);l.text=LanguageManager.getlocal("dailyTaskName"+this._taskId),l.x=r.x+r.width/2-l.width/2,l.y=r.y+r.height/2-l.height/2,this._nodeContainer.addChild(l),this._taskAimTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN),this._taskAimTxt.x=r.x+10,this._taskAimTxt.y=l.y+l.height+18,this._nodeContainer.addChild(this._taskAimTxt);var h=this.splitRewardsString(i.reward,i.liveness),d=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN2);d.text=LanguageManager.getlocal("dailyTaskReward",[h]),d.x=this._taskAimTxt.x,d.y=this._taskAimTxt.y+32,this._nodeContainer.addChild(d),this._achRedDotSp=BaseBitmap.create("public_dot2"),this._achRedDotSp.x=n.x+n.width-this._achRedDotSp.width-20,this._achRedDotSp.y=n.y+2,this._achRedDotSp.visible=!1,this._nodeContainer.addChild(this._achRedDotSp),this._collectBtn=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskCollect",this.collectHandler,this),this._collectBtn.x=a.x+a.width-150,this._collectBtn.y=a.y+a.height/2-this._collectBtn.height/2,this._collectBtn.setColor(TextFieldConst.COLOR_BLACK),this._nodeContainer.addChild(this._collectBtn),this._goBtn=ComponentManager.getButton(ButtonConst.BTN_SMALL_RED,"taskGoBtn",this.collectHandler,this),this._goBtn.x=this._collectBtn.x,this._goBtn.y=this._collectBtn.y,this._nodeContainer.addChild(this._goBtn),this.refreshUI()},e.prototype.refreshUI=function(){var t=Config.DailytaskCfg.getDailytaskCfgByTaskId(this._taskId),e=Api.dailytaskVoApi.getTaskFandVByTaskId(this._taskId);this._curTaskStatus=Api.dailytaskVoApi.getTaskStatusByTaskId(this._taskId),e?this._taskAimTxt.text=LanguageManager.getlocal("dailyTaskAin",[String(e.task_v),String(t.value)]):this._taskAimTxt.text=LanguageManager.getlocal("dailyTaskAin",["0",String(t.value)]),this._curTaskStatus<2?0==this._curTaskStatus?(this._collectBtn.updateButtonImage(BaseButton.BTN_STATE3),this._achRedDotSp.visible=!1,this._goBtn.visible=!0,this._collectBtn.visible=!1):1==this._curTaskStatus&&(this._achRedDotSp.visible=!0,this._goBtn.visible=!1,this._collectBtn.visible=!0):(this._collectBtn.visible=!1,this._goBtn.visible=!1,this._achRedDotSp.visible=!1,this.createCollectFlag(),this._collectFlag.setScale(.7))},e.prototype.splitRewardsString=function(t,e){for(var i=GameData.formatRewardItem(t),a=LanguageManager.getlocal("dailyTask_liveness2",[String(e)]),n=i.length,o=0;n>o;o++){var s=i[o];a+=s.name+"+"+s.num,n-1>o&&(a+=",")}return a},e.prototype.createCollectFlag=function(){this._collectFlag||(this._collectFlag=BaseBitmap.create("collectflag"),this._collectFlag.anchorOffsetX=this._collectFlag.width/2,this._collectFlag.anchorOffsetY=this._collectFlag.height/2,this._collectFlag.x=this._collectBtn.x+this._collectBtn.width/2,this._collectFlag.y=this._collectBtn.y+this._collectBtn.height/2,this._nodeContainer.addChild(this._collectFlag))},e.prototype.collectHandlerCallBack=function(t){if(this._lastRequestTaskId&&this._lastRequestTaskId==this._taskId){this._lastRequestTaskId=null,this._collectBtn.visible=!1;var e=Config.DailytaskCfg.getDailytaskCfgByTaskId(this._taskId),i=[{icon:"itemicon6",tipMessage:"+"+e.liveness}];i.push(GameData.formatRewardItem(e.reward)[0]);var a=this._collectBtn.localToGlobal(this._collectBtn.width/2,this._collectBtn.height/2);App.CommonUtil.playRewardFlyAction(i,a),this._achRedDotSp.visible=!1,this.createCollectFlag(),this._collectFlag.setScale(1),this._collectFlag.visible=!1,this._collectFlag.setScale(1.3),this._collectFlag.visible=!0,egret.Tween.get(this._collectFlag,{loop:!1}).to({scaleX:.75,scaleY:.75},300)}},e.prototype.collectHandler=function(){if(0==this._curTaskStatus){var t=Config.DailytaskCfg.getDailytaskCfgByTaskId(this._taskId),e=t.openType,i=App.StringUtil.firstCharToUper(e);if("level"==e||"arrival"==e||""==e)ViewController.getInstance().openView(ViewConst.COMMON.PROMOTIONVIEW);else if("welfare"==e)ViewController.getInstance().openView("WelfareView|"+t.openNeed);else{if(Api[e+"VoApi"]&&Api[e+"VoApi"].isShowNpc){var a=Api[e+"VoApi"].isShowNpc();if(!a){var n=Api[e+"VoApi"].getLockedString?Api[e+"VoApi"].getLockedString():LanguageManager.getlocal("dailyTask_"+e+"Tip");return void App.CommonUtil.showTip(n?n:LanguageManager.getlocal("sysWaitOpen"))}}if("alliance"==e)return void Api.allianceVoApi.openMainView();if("studyatk"==e)return void Api.studyatkVoApi.openMainView();if(egret.getDefinitionByName(i+"View"))if(801==t.questType)ViewController.getInstance().openView(i+"View|1");else if(802==t.questType)ViewController.getInstance().openView(i+"View|2");else if(302==t.questType){var o=t.value;ViewController.getInstance().openView(ViewConst.COMMON.WIFEOPTVIEW,{cfgValue:o,handler:null})}else ViewController.getInstance().openView(i+"View");else egret.getDefinitionByName(i+"PopupView")&&ViewController.getInstance().openView(i+"PopupView")}}else this._lastRequestTaskId=this._taskId,NetManager.request(NetRequestConst.REQUEST_DAILYTASK_GET,{taskId:this._taskId})},e.prototype.getSpaceX=function(){return 0},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DAILYTASK_GET),this.collectHandlerCallBack,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_RESFESH_DAILYTASK_AFTER_SYNC,this.refreshUI,this),this._nodeContainer=null,this._collectBtn=null,this._collectFlag=null,this._taskId=null,this._lastRequestTaskId=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(DailyTaskScrollItem.prototype,"DailyTaskScrollItem");var DailyTaskView=function(t){function e(){var e=t.call(this)||this;return e._scrollList=null,e._maxLivenessValue=0,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DAILYTASK_GET),this.refreshProfress,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DAILYTASK_GETLIVENESS),this.rewardBoxClickhandlerCallBack,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var t=BaseBitmap.create("dailytask_topbg");t.y=-15,this._nodeContainer.addChild(t);var e=t.y+t.height,i=BaseBitmap.create("dailytask_liveness");i.x=40,i.y=t.y+t.height/2-i.height/2+10,this._nodeContainer.addChild(i);var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);a.text=LanguageManager.getlocal("dailyTask_todayliveness"),a.x=i.x+i.width/2-a.width/2,a.y=i.y-25,this._nodeContainer.addChild(a),this._curLivenessTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW),this._curLivenessTxt.x=80-this._curLivenessTxt.width/2,this._curLivenessTxt.y=i.y+i.height+5,this._nodeContainer.addChild(this._curLivenessTxt),this._progress=ComponentManager.getProgressBar("progress4","progress4_bg",488),this._progress.x=i.x+i.width+5,this._progress.y=i.y+i.height/2-this._progress.height/2,this._progress.setPercentage(this.getProgressPercent()),this._nodeContainer.addChild(this._progress);var n=Config.DailytaskCfg.getDailyRewardsList(),o=Object.keys(n),s=470/o.length,r=this._progress.x;this._maxLivenessValue=n[String(o.length)].needLiveness;for(var l=0;l<o.length;l++){var h=n[String(l+1)],d=r+(l+1)*s,g=BaseBitmap.create("dailytask_arrow");g.x=d-g.width/2+2,g.y=this._progress.y-g.height+4,this._nodeContainer.addChild(g);var c=this.getBoxStatusById(o[l]),p="dailytask_box1_";l>2&&(p="dailytask_box2_");var _=BaseLoadBitmap.create(p+String(c));_.anchorOffsetX=26.5,_.anchorOffsetY=25.5,_.name="boxImg"+o[l],_.x=d,_.y=this._progress.y-25.5-5;var u=BaseLoadBitmap.create("dailytask_box_light");u.anchorOffsetX=33.5,u.anchorOffsetY=32.5,u.x=d,u.name="lightImg"+o[l],u.y=this._progress.y-30,u.visible=!1,this._nodeContainer.addChild(u),this._nodeContainer.addChild(_),_.addTouchTap(this.rewardBoxClickhandler,this,[o[l]]);var C=BaseBitmap.create("dailytask_liveness_numbg");C.width=85,C.x=d-40,C.y=this._progress.y+35,this._nodeContainer.addChild(C);var f=ComponentManager.getTextField(h.needLiveness+LanguageManager.getlocal("dailyTask_liveness"),TextFieldConst.FONTSIZE_CONTENT_SMALL);f.x=d-f.width/2,f.y=this._progress.y+42,this._nodeContainer.addChild(f)}this.refreshProfress();var m=BaseBitmap.create("public_9_bg24");m.width=GameConfig.stageWidth,m.height=GameConfig.stageHeigth-e-this.container.y,m.x=0,m.y=e,this._nodeContainer.addChild(m);var T=BaseBitmap.create("public_9_bg23");T.width=GameConfig.stageWidth-4,T.height=m.height-4,T.x=2,T.y=m.y+2,this._nodeContainer.addChild(T);var y=GameConfig.stageHeigth-T.y-this.container.y-20,v=new egret.Rectangle(0,0,GameConfig.stageWidth,y),A=Api.dailytaskVoApi.getTaskIdListAfterSort();this._scrollList=ComponentManager.getScrollList(DailyTaskScrollItem,A,v),this._scrollList.y=T.y+10,this._nodeContainer.addChild(this._scrollList)},e.prototype.refreshProfress=function(){var t=this.getProgressPercent(),e=this._progress.getPercent();egret.Tween.get(this._progress,{loop:!1}).to({percent:t},5e3*(t-e)),this._curLivenessTxt.text=String(Api.dailytaskVoApi.getCurLivenessValue()),this._curLivenessTxt.x=80-this._curLivenessTxt.width/2;for(var i=Config.DailytaskCfg.getDailyRewardsList(),a=Object.keys(i),n=(this._progress.x,0);n<a.length;n++){var o=String(a[n]),s=(Config.DailytaskCfg.getDailyRewardsCfgByRewardId(o),this._nodeContainer.getChildByName("boxImg"+o)),r=this._nodeContainer.getChildByName("lightImg"+o),l=this.getBoxStatusById(o),h="dailytask_box1_";n>2&&(h="dailytask_box2_"),s instanceof BaseBitmap&&(s.texture=ResourceManager.getRes(h+l)),2==l?(r.visible=!0,egret.Tween.get(r,{loop:!0}).to({rotation:r.rotation+360},1e4),egret.Tween.get(s,{loop:!0}).to({rotation:10},50).to({rotation:-10},100).to({rotation:10},100).to({rotation:0},50).wait(500)):(r.visible=!1,egret.Tween.removeTweens(r),egret.Tween.removeTweens(s))}},e.prototype.getProgressPercent=function(){var t=Api.dailytaskVoApi.getCurLivenessValue(),e=Config.DailytaskCfg.getDailyRewardsList(),i=Object.keys(e);if(0==t)return 0;if(t>=e[String(i.length)].needLiveness)return 100;for(var a=1/i.length,n=1;n<=i.length;n++)if(t<=e[String(n)].needLiveness){var o=a*(n-1),s=0;n>1&&(s=e[String(n-1)].needLiveness);var r=e[String(n)].needLiveness;return o+=(t-s)/(r-s)*a}},e.prototype.getBoxStatusById=function(t){var e=Config.DailytaskCfg.getDailyRewardsCfgByRewardId(t),i=1;return Api.dailytaskVoApi.getTaskRewardStatusByRewardId(t)?i=3:e.needLiveness<=Api.dailytaskVoApi.getCurLivenessValue()&&(i=2),i},e.prototype.rewardBoxClickhandlerCallBack=function(t){var e=t.data.data.data,i=e.rewards,a=GameData.formatRewardItem(i),n=this._nodeContainer.getChildByName("boxImg"+this._curRewardBoxId),o=n.localToGlobal(n.width/2,50);App.CommonUtil.playRewardFlyAction(a,o),this.refreshProfress()},e.prototype.rewardBoxClickhandler=function(t,e){var i=e,a=this.getBoxStatusById(i);2==a?(this._curRewardBoxId=i,NetManager.request(NetRequestConst.REQUEST_DAILYTASK_GETLIVENESS,{liveKey:i})):ViewController.getInstance().openView(ViewConst.POPUP.DAILYTASK_REWARDPREVIEWPOPUPVIEW,{type:"Daily",id:i})},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["dailytask_topbg","dailytask_icon1","dailytask_topbg","progress4","progress4_bg","dailytask_liveness","dailytask_box1_1","dailytask_box1_2","dailytask_box1_3","dailytask_liveness_numbg","dailytask_arrow","dailytask_box2_1","dailytask_box2_2","dailytask_box2_3","progress6_bg"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DAILYTASK_GET),this.refreshProfress,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DAILYTASK_GETLIVENESS),this.rewardBoxClickhandlerCallBack,this),this._nodeContainer=null,this._scrollList=null,this._progress=null,this._curLivenessTxt=null,this._curRewardBoxId=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(DailyTaskView.prototype,"DailyTaskView");var DinnerDesk=function(t){function e(){var e=t.call(this)||this;return e._uid=0,e._dtype=0,e._numText=null,e._numBg=null,e._callbackF=null,e._obj=null,e._clickedIdx=0,e}return __extends(e,t),e.prototype.init=function(t,e,i,a){this._obj=i,this._callbackF=e,this._clickedIdx=a,this._dtype=t.dtype,this._uid=t.uid;var n="dinner_desk"+this._dtype,o="dinner_name_bg"+this._dtype,s=Config.DinnerCfg.getFeastItemCfg(this._dtype).contain,r=BaseBitmap.create(o);r.width=190,r.height=44;var l=ComponentManager.getButton(n,null,e,i,[a],1);1==this._dtype?l.setScale(175/l.width):l.setScale(195/l.width),l.x=r.width/2-l.width/2*l.scaleX+11,this.addChild(l),1==this._dtype?r.y=l.height*l.scaleY-r.height*r.scaleY:r.y=l.height*l.scaleY-r.height*r.scaleY,this.addChild(r);var h=ComponentManager.getTextField(t.name,TextFieldConst.FONTSIZE_CONTENT_COMMON);h.setPosition(r.width/2-h.width/2,r.y+r.height/2-h.height/2),this.addChild(h),1==this._dtype?h.textColor=TextFieldConst.COLOR_QUALITY_BLUE:h.textColor=TextFieldConst.COLOR_WARN_YELLOW2,this._numBg=BaseBitmap.create("public_itemtipbg2"),this._numBg.setPosition(r.width/2-this._numBg.width/2,r.y-this._numBg.height),this.addChild(this._numBg),this._numText=ComponentManager.getTextField(t.num+"/"+s,TextFieldConst.FONTSIZE_CONTENT_COMMON),this._numText.x=this._numBg.x+this._numBg.width/2-this._numText.width/2,this._numText.y=this._numBg.y+this._numBg.height/2-this._numText.height/2,this.addChild(this._numText)},e.prototype.setCurNum=function(t){var e=Config.DinnerCfg.getFeastItemCfg(this._dtype).contain;
this._numText.text=t+"/"+e,this._numText.x=this._numBg.x+this._numBg.width/2-this._numText.width/2},Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dtype",{get:function(){return this._dtype},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._uid=0,this._dtype=0,this._numText=null,this._numBg=null,this._callbackF=null,this._obj=null,this._clickedIdx=0,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(DinnerDesk.prototype,"DinnerDesk");var DinnerDetailView=function(t){function e(){var e=t.call(this)||this;return e.voApi=null,e._uid=0,e._seatText=null,e._scoreText=null,e._timeText=null,e._scrollList=null,e._scrollView=null,e._scrollContiner=null,e._intoSeatBtn=null,e._headTab=[],e._joinedDtype=0,e._clickUid=0,e._canShare=!0,e._shareCDtime=1800,e}return __extends(e,t),e.prototype.getTitleStr=function(){return"dinnerTitle"+this.voApi.getDtype()},e.prototype.getResourceList=function(){return this.voApi=new DinnerVoApi,this.voApi.formatData(this.param.data.info.dinnerdetail),this._uid=Number(this.param.data.uid),1==this.voApi.getDtype()?this._bgPreStr="dinner_scroll_":this._bgPreStr="dinner_scroll2_",t.prototype.getResourceList.call(this).concat(["dinner_head_arrow",this._bgPreStr+"1",this._bgPreStr+"2",this._bgPreStr+"3","palace_titlebg"])},e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_JOINDINNER),this.requiestCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_USEITEM),this.useItemCallback,this),this._scrollContiner=new BaseDisplayObjectContainer;var t=egret.Rectangle.create();t.setTo(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-238-this.getTitleButtomY()),this._scrollView=ComponentManager.getScrollView(this._scrollContiner,t),this._scrollView.y=-13,this._scrollView.bounces=!1,this.addChildToContainer(this._scrollView);var e=BaseBitmap.create("palace_titlebg");e.setPosition(GameConfig.stageWidth/2-e.width/2,-10),this.addChildToContainer(e);var i=ComponentManager.getTextField(this.voApi.getName(),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_BLACK);i.setPosition(e.x+e.width/2-i.width/2,e.y+30),this.addChildToContainer(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("dinnerSeat")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);a.setPosition(e.x+43,e.y+64),this.addChildToContainer(a),this._seatText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK),this._seatText.setPosition(a.x+a.width+10,a.y),this.addChildToContainer(this._seatText),this.resetSeatText();var n=ComponentManager.getTextField(LanguageManager.getlocal("playerId",[this._uid.toString()]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);n.setPosition(a.x,a.y+32),this.addChildToContainer(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("playerScore")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);o.setPosition(a.x+248,a.y),this.addChildToContainer(o),this._scoreText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN2),this._scoreText.setPosition(o.x+o.width+10,o.y),this.addChildToContainer(this._scoreText),this.resetScoreText();var s=ComponentManager.getTextField(LanguageManager.getlocal("adultMarryTime"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);s.setPosition(o.x,n.y),this.addChildToContainer(s),this._timeText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK),this._timeText.setPosition(s.x+s.width,s.y),this.addChildToContainer(this._timeText);var r=BaseBitmap.create(this._bgPreStr+"2");this._scrollContiner.addChild(r);for(var l=Config.DinnerCfg.getFeastItemCfg(this.voApi.getDtype()).contain,h=r.height,d=(l-4)/2,g=1;d>=g;g++){var c=BaseBitmap.create(this._bgPreStr+"1");c.y=h,this._scrollContiner.addChild(c),h+=c.height}var p=BaseBitmap.create(this._bgPreStr+"3");p.y=h,this._scrollContiner.addChild(p),this.initBottom(),this.initPlayerInfo(),this.param.data.info.resReport&&this.param.data.info.resReport.length>0&&ViewController.getInstance().openView(ViewConst.POPUP.DINNERMESSAGEPOPUPVIEW,{info:this.param.data.info.resReport}),this.param.data.needOpen&&ViewController.getInstance().openView(ViewConst.BASE.DINNEROPENEDVIEW,{type:this.param.data.needOpen.type}),this.tick()},e.prototype.resetSeatText=function(){var t=this.voApi.getNum(),e=Config.DinnerCfg.getFeastItemCfg(this.voApi.getDtype()).contain;this._seatText.text=t+"/"+e},e.prototype.resetScoreText=function(){this._scoreText.text=this.voApi.getPoint().toString()},e.prototype.tick=function(){var t=this.voApi.getEndTime()-GameData.serverTime;if(0>t&&(t=0),this._timeText.text=App.DateUtil.getFormatBySecond(t),this._uid==Api.playerVoApi.getPlayerID()){var e=Api.dinnerVoApi.getShareTime();GameData.serverTime-e>=this._shareCDtime?0==this._canShare&&(this._canShare=!0,App.DisplayUtil.changeToNormal(this._intoSeatBtn)):1==this._canShare&&(this._canShare=!1,App.DisplayUtil.changeToGray(this._intoSeatBtn))}},e.prototype.setBottomButton=function(){this._intoSeatBtn&&(this.removeChildFromContainer(this._intoSeatBtn),this._intoSeatBtn=null);var t,e;if(this._uid==Api.playerVoApi.getPlayerID())t="dinner_share",e=ButtonConst.BTN_NORMAL_BLUE;else{var i=Api.dinnerVoApi.getDayNum(),a=Config.DinnerCfg.getGoToFeastNum();i>=a?(t="manageRecoveryBtn",e=ButtonConst.BTN_NORMAL_RED):(t="intoSeat",e=ButtonConst.BTN_NORMAL_BLUE)}this._intoSeatBtn=ComponentManager.getButton(e,t,this.intoSeat,this),this._intoSeatBtn.setPosition(GameConfig.stageWidth/2-this._intoSeatBtn.width/2,GameConfig.stageHeigth-238-this.getTitleButtomY()-12-20-this._intoSeatBtn.height),this.addChildToContainer(this._intoSeatBtn)},e.prototype.initBottom=function(){var t=new BaseDisplayObjectContainer;t.y=GameConfig.stageHeigth-238-this.getTitleButtomY()-12,this.addChildToContainer(t),this.setBottomButton();var e=BaseBitmap.create("public_9_bg22");e.setPosition(0,0),e.width=GameConfig.stageWidth,e.height=238,t.addChild(e);var i=BaseBitmap.create("public_line3");i.width=480,i.x=GameConfig.stageWidth/2-i.width/2,i.y=35,t.addChild(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("dinnerInfo"),TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_BLACK);a.setPosition(GameConfig.stageWidth/2-a.width/2,32),t.addChild(a);var n=BaseBitmap.create("public_9_bg21");n.width=590,n.height=150,n.setPosition(GameConfig.stageWidth/2-n.width/2,60),t.addChild(n),this._scroRect=new egret.Rectangle(n.x,0,n.width,n.height-10),this._scrollList=ComponentManager.getScrollList(DinnerInfoItem,this.voApi.getJinfo(),this._scroRect),this._scrollList.x=n.x,this._scrollList.y=n.y+5,this._scrollList.setEmptyTip(LanguageManager.getlocal("dinnerMsgPopupEmptyTip")),t.addChild(this._scrollList)},e.prototype.initPlayerInfo=function(){var t=this.getPlayerInfo(this.voApi.getName(),this.voApi.getPic(),this._uid,this.voApi.getPhototitle());t.setPosition(GameConfig.stageWidth/2-t.width/2+4,205),this._scrollContiner.addChild(t);var e;e=1==this.voApi.getDtype()?180:153;var i=310;PlatformManager.checkIsKRSp()&&(i=i+e+10);var a=this.voApi.getJinfo();for(var n in a){var o=a[n],s=this.getPlayerInfo(o.name,o.pic,o.uid,o.phototitle);s.setPosition(70+Number(n)%2*344,i+Math.floor(Number(n)/2)*e),this._scrollContiner.addChild(s),this._headTab.push(s),o.uid==Api.playerVoApi.getPlayerID()&&(this._intoSeatBtn.visible=!1,this._scrollView.setScrollTop(s.y-180))}},e.prototype.resetPlayerInfo=function(){var t,e=this.voApi.getJinfo();t=1==this.voApi.getDtype()?180:153;var i=310;PlatformManager.checkIsKRSp()&&(i=i+t+10);for(var a=this._headTab.length;a<e.length;a++){var n=e[a],o=this.getPlayerInfo(n.name,n.pic,n.uid,n.phototitle);o.setPosition(70+Number(a)%2*344,i+Math.floor(Number(a)/2)*t),this._scrollContiner.addChild(o),this._headTab.push(o),egret.Tween.get(o).to({scaleX:1.2,scaleY:1.2},300).to({scaleX:1,scaleY:1},200).to({scaleX:1.2,scaleY:1.2},300).to({scaleX:1,scaleY:1},200),this._scrollView.setScrollTop(o.y-180),n.uid==Api.playerVoApi.getPlayerID()&&(this._intoSeatBtn.visible=!1)}},e.prototype.getPlayerInfo=function(t,e,i,a){var n=new BaseDisplayObjectContainer,o=BaseBitmap.create("public_numbg");o.width=160,n.addChild(o),i==Api.playerVoApi.getPlayerID()?a="-1":null==a&&(a="0");var s=Api.playerVoApi.getPlayerCircleHead(e,a);s.x=o.width/2-s.width/2,n.addChild(s),o.y=s.height;var r=BaseBitmap.create("dinner_head_arrow");r.setPosition(s.x+45-r.width/2,s.height-14),n.addChild(r);var l=ComponentManager.getTextField(t,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_YELLOW);return l.setPosition(o.width/2-l.width/2,o.y+o.height/2-l.height/2),n.addChild(l),n.addTouchTap(this.clickHead,this,[i]),n},e.prototype.clickHead=function(t,e){this._clickUid=e,App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_USERSHOT),this.userShotCallback,this),NetManager.request(NetRequestConst.REQUEST_RANK_USERSHOT,{ruid:e})},e.prototype.userShotCallback=function(t){if(!Api.switchVoApi.checkOpenShenhe()){var e=t.data.data.data;this._uid==this._clickUid&&(e.isDinnerHost=!0),e.isFromDinner=!0,ViewController.getInstance().openView(ViewConst.POPUP.RANKUSERINGOPOPUPVIEW,e)}App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_USERSHOT),this.userShotCallback,this)},e.prototype.shareCallback=function(){this.tick()},e.prototype.intoSeat=function(){if(this._uid==Api.playerVoApi.getPlayerID()){var t=Api.dinnerVoApi.getShareTime();if(GameData.serverTime-t>=this._shareCDtime)ViewController.getInstance().openView(ViewConst.POPUP.DINNERSHAREPOPUPVIEW,{f:this.shareCallback,o:this});else{var e=App.DateUtil.getFormatBySecond(this._shareCDtime-GameData.serverTime+t);App.CommonUtil.showTip(LanguageManager.getlocal("dinner_share_time",[e]))}}else{var i=this.voApi.getNum(),a=Config.DinnerCfg.getFeastItemCfg(this.voApi.getDtype()).contain;if(i>=a)return void App.CommonUtil.showTip(LanguageManager.getlocal("dinnerSeatFull"));var n=Api.dinnerVoApi.getDayNum(),o=Config.DinnerCfg.getGoToFeastNum();if(n>=o){var s=Api.dinnerVoApi.getNeedItem(),r=Api.itemVoApi.getItemNumInfoVoById(Number(s));if(r>0){var l=Api.itemVoApi.getItemInfoVoById(Number(s)),h=LanguageManager.getlocal("dinnerTimesExtra",[l.name]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{title:"itemUseConstPopupViewTitle",msg:h,icon:l.icon,iconBg:l.iconBg,num:l.num,confirmCallback:this.useItemExtra,handler:this,needCancel:!0,id:Number(s),useNum:1})}else App.CommonUtil.showTip(LanguageManager.getlocal("dinnerTimesFull"));return}ViewController.getInstance().openView(ViewConst.POPUP.DINNERTYPEPOPUPVIEW,{o:this,f:this.joinDinnerRequest})}},e.prototype.useItemExtra=function(){NetManager.request(NetRequestConst.REQUEST_DINNER_USEITEM,{})},e.prototype.useItemCallback=function(t){1==t.data.ret&&(App.CommonUtil.showTip(LanguageManager.getlocal("recoverLeftSuccess")),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_DINNER),this.setBottomButton())},e.prototype.joinDinnerRequest=function(t){this._joinedDtype=t,NetManager.request(NetRequestConst.REQUEST_DINNER_JOINDINNER,{joinuid:this._uid,dtype:t})},e.prototype.getRewardCallback=function(){this.resetPlayerInfo(),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_DINNER)},e.prototype.requiestCallback=function(t){if(1==t.data.ret){this.voApi.formatData(t.data.data.data.joindetail),this.resetSeatText(),this.resetScoreText(),this._scrollList.refreshData(this.voApi.getJinfo());var e=Config.DinnerCfg.getGoToFeastItemCfg(this._joinedDtype).getScore,i=t.data.data.data.reward;ViewController.getInstance().openView(ViewConst.COMMON.DINNERREWARDVIEW,{o:this,f:this.getRewardCallback,reward:i,name:this.voApi.getName(),pic:this.voApi.getPic(),level:this.voApi.getLevel(),title:this.voApi.getTitle(),point:e})}else App.CommonUtil.showTip(LanguageManager.getlocal("dinner_is_over")),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_DINNER),this.hide()},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_JOINDINNER),this.requiestCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_USEITEM),this.useItemCallback,this),this._intoSeatBtn&&App.DisplayUtil.changeToNormal(this._intoSeatBtn),this.voApi.dispose(),this.voApi=null,this._seatText=null,this._scoreText=null,this._timeText=null,this._scroRect=null,this._uid=0,this._scrollContiner=null,this._intoSeatBtn=null,this._headTab.length=0,this._bgPreStr=null,this._joinedDtype=0,this._scrollView=null,this._clickUid=0,this._canShare=!0,t.prototype.dispose.call(this)},e}(CommonView);__reflect(DinnerDetailView.prototype,"DinnerDetailView");var DinnerExchangePopupView=function(t){function e(){var e=t.call(this)||this;return e._scrollContainer=null,e._itemsContainerTab=[],e._isLoading=!1,e._buyClickId=null,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_SHOPITEM),this.shopItemCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_FEFRESHITEM),this.gemsRefreshCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_SCOREDINNER),this.buyItemCallback,this),this._pointText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK),this._pointText.y=11,this.addChildToContainer(this._pointText);var t=egret.Rectangle.create();t.setTo(0,0,this.viewBg.width,720),this._scrollContainer=new BaseDisplayObjectContainer;var e=ComponentManager.getScrollView(this._scrollContainer,t);this.addChildToContainer(e),this._scrollContainer.setPosition(0,40),this.resetPointText();var i=BaseBitmap.create("public_9_probiginnerbg");i.width=528,i.height=82,i.setPosition(this.viewBg.width/2-i.width/2,t.height+10),this.addChildToContainer(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("gemRefresh")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);a.setPosition(i.x+20,i.y+i.height/2-5-a.height),this.addChildToContainer(a),this._gemRefreshText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN),this._gemRefreshText.setPosition(a.x+a.width+12,a.y),this.addChildToContainer(this._gemRefreshText),this.resetGemRefreshtText();var n=ComponentManager.getTextField(LanguageManager.getlocal("autoRefresh")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);n.setPosition(i.x+20,i.y+i.height/2+5),this.addChildToContainer(n),this._autoRefreshText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN),this._autoRefreshText.setPosition(n.x+n.width+12,n.y),this.addChildToContainer(this._autoRefreshText);var o=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"refresh",this.refreshHandle,this);o.setPosition(this.viewBg.width-o.width-30,i.y+i.height/2-o.height/2),o.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(o),Api.dinnerVoApi.getShopLastTime()-GameData.serverTime+Config.DinnerCfg.getShopReTime()<=0?this.tick():(this.resetAutoRefreshtText(),this.refreshShowItems())},e.prototype.shopItemCallback=function(t){this._isLoading=!1,1==t.data.ret&&this.refreshShowItems()},e.prototype.refreshShowItems=function(){if(this._itemsContainerTab.length>0){for(var t in this._itemsContainerTab)this._scrollContainer.removeChild(this._itemsContainerTab[t]);this._itemsContainerTab.length=0}var e=Api.dinnerVoApi.getShopInfo();for(var t in e){var i=Number(t),a=this.getShopItemContainer(i);a.setPosition(21+178*(i%3),225*Math.floor(i/3)),this._scrollContainer.addChild(a),this._itemsContainerTab.push(a)}},e.prototype.getShopItemContainer=function(t){var e=new BaseDisplayObjectContainer,i=BaseBitmap.create("public_9_bg4");i.width=170,i.height=218,e.addChild(i);var a=Api.dinnerVoApi.getShopInfo()[t],n=Config.DinnerCfg.getShopItemCfg(a),o=GameData.formatRewardItem(n.content)[0],s=ComponentManager.getTextField(o.name,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);s.setPosition(i.width/2-s.width/2,7),e.addChild(s);var r=GameData.getItemIcon(o,!0);r.setPosition(i.width/2-r.width/2,30),r.name="icon",e.addChild(r),r.getChildByName("numLb").visible=!1;var l=ComponentManager.getTextField(n.cost+LanguageManager.getlocal("pointNumber"),TextFieldConst.FONTSIZE_CONTENT_SMALL);l.setPosition(i.width/2-l.width/2,r.y+r.height+3),e.addChild(l);var h=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"exchange",this.buyItem,this,[t]);return h.setPosition(i.width/2-h.width/2,i.height-h.height-8),h.setColor(TextFieldConst.COLOR_BLACK),e.addChild(h),1==Api.dinnerVoApi.getBuyInfo()[t+1]&&(App.DisplayUtil.changeToGray(r),App.DisplayUtil.changeToGray(h)),e},e.prototype.buyItem=function(t){if(1==Api.dinnerVoApi.getBuyInfo()[t+1])return void App.CommonUtil.showTip(LanguageManager.getlocal("buyItemTimesOver"));var e=Api.dinnerVoApi.getShopInfo()[t],i=Config.DinnerCfg.getShopItemCfg(e);return Api.dinnerVoApi.getTotalScore()<i.cost?void App.CommonUtil.showTip(LanguageManager.getlocal("pointNumberLess")):(this._buyClickId=t,void NetManager.request(NetRequestConst.REQUEST_DINNER_SCOREDINNER,{posId:t+1}))},e.prototype.refreshHandle=function(){var t=Api.dinnerVoApi.getShopNum(),e=Config.DinnerCfg.getShopReset();if(t>=e)App.CommonUtil.showTip(LanguageManager.getlocal("gemRefreshTimesOver"));else{var i=Config.DinnerCfg.getShopNeedGem()[Api.dinnerVoApi.getShopNum()],a=LanguageManager.getlocal("dinnerGemsRefresh",[App.StringUtil.toString(i)]),n=Api.playerVoApi.getPlayerGem();ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{confirmCallback:this.gemsRefreshItem,handler:this,icon:"itemicon1",iconBg:"itembg_1",num:n,msg:a,id:1,useNum:i})}},e.prototype.gemsRefreshItem=function(){var t=Config.DinnerCfg.getShopNeedGem()[Api.dinnerVoApi.getShopNum()];return t>Api.playerVoApi.getPlayerGem()?void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough")):void NetManager.request(NetRequestConst.REQUEST_DINNER_FEFRESHITEM,{})},e.prototype.gemsRefreshCallback=function(t){1==t.data.ret&&(this.refreshShowItems(),this.resetGemRefreshtText())},e.prototype.buyItemCallback=function(t){if(1==t.data.ret){var e=Api.dinnerVoApi.getShopInfo()[this._buyClickId],i=Config.DinnerCfg.getShopItemCfg(e),a=GameData.formatRewardItem(i.content);App.CommonUtil.playRewardFlyAction(a),this.resetPointText(),this.refreshShowItems()}},e.prototype.resetPointText=function(){this._pointText.text=LanguageManager.getlocal("dinnerPoint",[Api.dinnerVoApi.getTotalScore().toString()]),this._pointText.x=this.viewBg.width/2-this._pointText.width/2},e.prototype.resetGemRefreshtText=function(){var t=Config.DinnerCfg.getShopReset()-Api.dinnerVoApi.getShopNum();0>t&&(t=0),this._gemRefreshText.text=t+"/"+Config.DinnerCfg.getShopReset()},e.prototype.resetAutoRefreshtText=function(){var t=Api.dinnerVoApi.getShopLastTime()-GameData.serverTime+Config.DinnerCfg.getShopReTime();0>t&&(t=0),this._autoRefreshText.text=App.DateUtil.getFormatBySecond(t)},e.prototype.tick=function(){0==this._isLoading&&Api.dinnerVoApi.getShopLastTime()-GameData.serverTime+Config.DinnerCfg.getShopReTime()<=0&&(this._isLoading=!0,NetManager.request(NetRequestConst.REQUEST_DINNER_SHOPITEM,{})),this.resetAutoRefreshtText()},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_SHOPITEM),this.shopItemCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_FEFRESHITEM),this.gemsRefreshCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_SCOREDINNER),this.buyItemCallback,this),this._pointText=null,this._itemsContainerTab.length=0,this._isLoading=!1,this._buyClickId=null,this._scrollContainer=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(DinnerExchangePopupView.prototype,"DinnerExchangePopupView");var DinnerFindPopupView=function(t){function e(){var e=t.call(this)||this;return e._inputTextField=null,e._dinnerInfoContainer=null,e._dinnerInfo=null,e._gotoBtn=null,e._timeCountDown=null,e}return __extends(e,t),e.prototype.getTitleStr=function(){return"codeToDinner"},e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=518,t.height=500,t.setPosition(this.viewBg.width/2-t.width/2,12),this.addChildToContainer(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("playerIdFind"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);e.setPosition(52,27+t.y),this.addChildToContainer(e);var i=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,466,44,"public_9_bg5",LanguageManager.getlocal("inputPlayerId"),10785151);i.x=this.viewBg.width/2-i.width/2,i.y=t.y+55,this.addChildToContainer(i),this._inputTextField=i.getChildByName("textField"),this._inputTextField.restrict="0-9",this._inputTextField.maxChars=40;var a=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"find",this.findHandle,this);a.setPosition(this.viewBg.width-a.width-55,i.y+i.height+12),this.addChildToContainer(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("dinnerInfo")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);n.setPosition(e.x,155+t.y),this.addChildToContainer(n);var o=BaseBitmap.create("public_9_probiginnerbg");o.width=500,o.height=228,o.setPosition(this.viewBg.width/2-o.width/2,n.y+n.height+8),this.addChildToContainer(o),this._gotoBtn=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskGoBtn",this.gotoHandle,this),this._gotoBtn.setPosition(a.x,o.y+o.height+12),this.addChildToContainer(this._gotoBtn),this._gotoBtn.visible=!1},e.prototype.findHandle=function(){return this._inputTextField.text.length<5?void App.CommonUtil.showTip(LanguageManager.getlocal("playerIdError")):Number(this._inputTextField.text)==Api.playerVoApi.getPlayerID()?void App.CommonUtil.showTip(LanguageManager.getlocal("dinnerCannotSelf")):void this.request(NetRequestConst.REQUEST_DINNER_GETDINNER,{getuid:Number(this._inputTextField.text)})},e.prototype.gotoHandle=function(){var t=this._dinnerInfo;ViewController.getInstance().openView(ViewConst.BASE.GOTODINNEREDVIEW,{info:t}),this.hide()},e.prototype.receiveData=function(t){if(1==t.ret){if(t.data.data.dinnerinfo&&!t.data.data.dinnerinfo.dtype)return void App.CommonUtil.showTip(LanguageManager.getlocal("playerIdIsNoDinner"));if(1==t.data.data.proflag)return void App.CommonUtil.showTip(LanguageManager.getlocal("adultMarryRequestTip2"));this._gotoBtn.visible=!0,this._dinnerInfo=t.data.data.dinnerinfo,this._dinnerInfo.uid=Number(this._inputTextField.text),this.showFindInfo()}},e.prototype.showFindInfo=function(){this._dinnerInfoContainer&&(this.removeChildFromContainer(this._dinnerInfoContainer),this._dinnerInfoContainer=null),this._dinnerInfoContainer=new BaseDisplayObjectContainer,this._dinnerInfoContainer.setPosition(50,215),this.addChildToContainer(this._dinnerInfoContainer);var t=ComponentManager.getTextField(LanguageManager.getlocal("dinnerHost"),TextFieldConst.FONTSIZE_CONTENT_COMMON);this._dinnerInfoContainer.addChild(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("dinnerType"),TextFieldConst.FONTSIZE_CONTENT_COMMON);e.y=33,this._dinnerInfoContainer.addChild(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("dinnerSeat")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);i.y=66,this._dinnerInfoContainer.addChild(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("dinnerCountDown"),TextFieldConst.FONTSIZE_CONTENT_COMMON);a.y=99,this._dinnerInfoContainer.addChild(a);var n=ComponentManager.getTextField(this._dinnerInfo.name,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN);n.x=t.width+10,this._dinnerInfoContainer.addChild(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("dinnerType"+this._dinnerInfo.dtype),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN);o.setPosition(e.width+10,e.y),this._dinnerInfoContainer.addChild(o);var s=this._dinnerInfo.join_num,r=Config.DinnerCfg.getFeastItemCfg(this._dinnerInfo.dtype).contain,l=ComponentManager.getTextField(s+"/"+r,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN);l.setPosition(i.width+10,i.y),this._dinnerInfoContainer.addChild(l),this._timeCountDown=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN),this._timeCountDown.setPosition(a.width+10,a.y),this._dinnerInfoContainer.addChild(this._timeCountDown),this.tick()},e.prototype.tick=function(){if(this._dinnerInfo&&this._timeCountDown){var t=this._dinnerInfo.end_time-GameData.serverTime;0>t&&(t=0),this._timeCountDown.text=App.DateUtil.getFormatBySecond(t)}},e.prototype.dispose=function(){this._inputTextField=null,this._dinnerInfoContainer=null,this._gotoBtn=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(DinnerFindPopupView.prototype,"DinnerFindPopupView");var DinnerFinishItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=582,this.height=50;var i=BaseBitmap.create("dinner_rankbg");i.x=68-i.width/2,i.y=this.height/2-i.height/2,this.addChild(i);var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);a.text=String(t+1),a.x=68-a.width/2,a.y=this.height/2-a.height/2,this.addChild(a);var n,o=0;if(999==e.dtype)o=50,n="+"+o;else{var s=Config.DinnerCfg.getGoToFeastItemCfg(e.dtype);o=Number(s.getPoint),n=s.getPoint>0?"+"+s.getPoint:s.getPoint.toString()}var r=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_CONTENT_COMMON);r.x=270-r.width/2,r.y=this.height/2-r.height/2,this.addChild(r);var l=ComponentManager.getTextField(n,TextFieldConst.FONTSIZE_CONTENT_COMMON);l.x=480-l.width/2,l.y=this.height/2-r.height/2,this.addChild(l),o>0?(r.textColor=TextFieldConst.COLOR_WARN_GREEN,l.textColor=TextFieldConst.COLOR_WARN_GREEN):(r.textColor=TextFieldConst.COLOR_WARN_RED2,l.textColor=TextFieldConst.COLOR_WARN_RED2);var h=BaseBitmap.create("dinner_line");h.x=this.width/2-h.width/2,h.y=this.height,this.addChild(h)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(DinnerFinishItem.prototype,"DinnerFinishItem");var DinnerFinishView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["dinner_finish_word","dinner_finish_word2","dinner_finish_type1","dinner_finish_type2","dinner_finish_line","dinner_list_title_bg","dinner_list_bg","dinner_rankbg"])},e.prototype.getBgName=function(){return"public_9_bg8"},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.initView=function(){var t=this.param.data.info,e=BaseBitmap.create("public_9_wordbg");e.width=GameConfig.stageWidth,e.height=728,e.setPosition(0,GameConfig.stageHeigth/2-413),this.addChildToContainer(e);var i=BaseBitmap.create("dinner_finish_word");i.setPosition(GameConfig.stageWidth/2-i.width/2,e.y-i.height/2),this.addChildToContainer(i);var a=BaseBitmap.create("dinner_finish_word2"),n=BaseBitmap.create("dinner_finish_type"+t.dtype),o=a.width+n.width;a.setPosition(GameConfig.stageWidth/2-o/2,e.y+61),this.addChildToContainer(a),n.setPosition(a.x+a.width+8,a.y),this.addChildToContainer(n);var s=ComponentManager.getTextField(LanguageManager.getlocal("dinnerTotalGuest",[t.num.toString()]),TextFieldConst.FONTSIZE_TITLE_SMALL);s.setPosition(GameConfig.stageWidth/2-s.width/2,e.y+115),this.addChildToContainer(s);var r=BaseBitmap.create("dinner_finish_line");r.scaleX=582/r.width,r.setPosition(GameConfig.stageWidth/2-291,e.y+160),this.addChildToContainer(r);var l=ComponentManager.getTextField(LanguageManager.getlocal("dinnerReward"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_WARN_YELLOW);l.setPosition(66,e.y+183),this.addChildToContainer(l);var h=ComponentManager.getTextField(LanguageManager.getlocal("playerScore")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);h.setPosition(l.x,l.y+36),this.addChildToContainer(h);var d=ComponentManager.getTextField(t.point,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN);d.setPosition(h.x+h.width+10,h.y),this.addChildToContainer(d);var g=ComponentManager.getTextField(LanguageManager.getlocal("dinnerGetScore")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);g.setPosition(l.x+320,d.y),this.addChildToContainer(g);var c=ComponentManager.getTextField(t.score,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN);c.setPosition(g.x+g.width+10,g.y),this.addChildToContainer(c);var p=ComponentManager.getTextField(LanguageManager.getlocal("dinnerRecord"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_WARN_YELLOW);p.setPosition(l.x,e.y+270),this.addChildToContainer(p);var _=BaseBitmap.create("dinner_list_bg");_.width=584,_.height=418,_.setPosition(GameConfig.stageWidth/2-_.width/2,e.y+304),this.addChildToContainer(_);var u=BaseBitmap.create("dinner_list_title_bg");u.width=582,u.height=46,u.setPosition(GameConfig.stageWidth/2-u.width/2,_.y+1),this.addChildToContainer(u);var C=ComponentManager.getTextField(LanguageManager.getlocal("orderNumber"),TextFieldConst.FONTSIZE_CONTENT_COMMON);C.setPosition(l.x+10,u.y+u.height/2-C.height/2),this.addChildToContainer(C);var f=ComponentManager.getTextField(LanguageManager.getlocal("ranknickName"),TextFieldConst.FONTSIZE_CONTENT_COMMON);f.setPosition(C.x+175,C.y),this.addChildToContainer(f);var m=ComponentManager.getTextField(LanguageManager.getlocal("dinnerScore"),TextFieldConst.FONTSIZE_CONTENT_COMMON);m.setPosition(f.x+218,C.y),this.addChildToContainer(m);var T=0;if(this.param.data.baodi)T=Number(this.param.data.baodi);else{Config.DinnerCfg.getFeastItemCfg(t.dtype).contain}var y=[];t.jinfo.length>0&&(y=t.jinfo);for(var v=0;T>v;v++)y.push({dtype:999,name:LanguageManager.getlocal("dinnerGuest")});this._scroRect=new egret.Rectangle(0,0,_.width,_.height-u.height-8),this._scrollList=ComponentManager.getScrollList(DinnerFinishItem,y,this._scroRect),this._scrollList.x=_.x,this._scrollList.y=_.y+u.height,this.addChildToContainer(this._scrollList);var A=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"sysConfirm",this.hide,this);A.setPosition(GameConfig.stageWidth/2-A.width/2,e.y+e.height+40),this.addChildToContainer(A)},e.prototype.dispose=function(){this._scroRect=null,this._scrollList=null,t.prototype.dispose.call(this)},e}(BaseView);__reflect(DinnerFinishView.prototype,"DinnerFinishView");var DinnerInfoItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=590,this.height=32;var i=ComponentManager.getTextField(t+1+". "+e.name,TextFieldConst.FONTSIZE_CONTENT_SMALL);i.x=17,i.y=this.height/2-i.height/2,this.addChild(i);var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);a.x=170,a.y=this.height/2-i.height/2,this.addChild(a);var n,o=Config.DinnerCfg.getGoToFeastItemCfg(e.dtype).getPoint;if(n=Config.DinnerCfg.getGoToFeastItemCfg(e.dtype).needGem?Config.DinnerCfg.getGoToFeastItemCfg(e.dtype).needGem+LanguageManager.getlocal("gemName"):LanguageManager.getlocal("itemName_"+Config.DinnerCfg.getGoToFeastItemCfg(e.dtype).needItem),4!=e.dtype){i.textColor=TextFieldConst.COLOR_BLACK;var s="+"+o;a.text=LanguageManager.getlocal("dinnerJoinDesc1",[n,s])}else i.textColor=TextFieldConst.COLOR_WARN_RED,a.text=LanguageManager.getlocal("dinnerJoinDesc2",[n,o.toString()]);a.textColor=i.textColor},e.prototype.dispose=function(){t.prototype.dispose.call(this)
},e}(ScrollListItem);__reflect(DinnerInfoItem.prototype,"DinnerInfoItem");var DinnerMessageItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=498,this.height=54;var i=Config.DinnerCfg.getGoToFeastItemCfg(e.dtype),a=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_CONTENT_COMMON);a.x=125-a.width/2,a.y=this.height/2-a.height/2,this.addChild(a);var n;n=i.getPoint>0?"+"+i.getPoint:i.getPoint.toString();var o=ComponentManager.getTextField(n,TextFieldConst.FONTSIZE_CONTENT_COMMON);o.x=372-o.width/2,o.y=this.height/2-a.height/2,this.addChild(o),i.getPoint>0?(a.textColor=TextFieldConst.COLOR_WARN_GREEN,o.textColor=TextFieldConst.COLOR_WARN_GREEN):(a.textColor=TextFieldConst.COLOR_WARN_RED2,o.textColor=TextFieldConst.COLOR_WARN_RED2);var s=BaseBitmap.create("dinner_line");s.x=this.width/2-s.width/2,s.y=this.height,this.addChild(s)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(DinnerMessageItem.prototype,"DinnerMessageItem");var DinnerMessagePopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=this.param.data.info,e=0,i=0,a=0;for(var n in t){var o=t[n],s=Config.DinnerCfg.getGoToFeastItemCfg(o.dtype);s.getPoint<0&&(i+=1),a+=s.getPoint,e+=1}var r="";r=a>=0?LanguageManager.getlocal("dinnerMessage1",[e.toString(),i.toString(),a.toString()]):LanguageManager.getlocal("dinnerMessage2",[e.toString(),i.toString(),a.toString()]);var l=BaseBitmap.create("public_9_bg4");l.width=526,l.height=426,l.setPosition(this.viewBg.width/2-l.width/2,12),this.addChildToContainer(l);var h=ComponentManager.getTextField(r,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);h.width=this.viewBg.width-104,h.lineSpacing=6,h.setPosition(52,14+l.y),this.addChildToContainer(h);var d=BaseBitmap.create("public_9_probiginnerbg");d.width=498,d.height=340,d.setPosition(this.viewBg.width/2-d.width/2,l.y+69),this.addChildToContainer(d);var g=BaseBitmap.create("dinner_rank_titlebg");g.width=d.width,g.height=36,g.setPosition(d.x,d.y),this.addChildToContainer(g);var c=ComponentManager.getTextField(LanguageManager.getlocal("dinnerPlayerName"),TextFieldConst.FONTSIZE_CONTENT_COMMON);c.setPosition(120,g.y+g.height/2-c.height/2),this.addChildToContainer(c);var p=ComponentManager.getTextField(LanguageManager.getlocal("playerScore"),TextFieldConst.FONTSIZE_CONTENT_COMMON);p.setPosition(370,c.y),this.addChildToContainer(p);var _=new egret.Rectangle(g.x,g.y+g.height,g.width,d.height-g.height-8);this._scrollList=ComponentManager.getScrollList(DinnerMessageItem,t,_),this._scrollList.x=g.x,this._scrollList.y=g.y+g.height,this.addChildToContainer(this._scrollList)},e.prototype.dispose=function(){this._scrollList=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(DinnerMessagePopupView.prototype,"DinnerMessagePopupView");var DinnerMsgPopupScollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=502,this.height=124;var i=BaseBitmap.create("dinner_rankbg");i.x=37-i.width/2,i.y=20,this.addChild(i);var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);a.text=String(t+1),a.x=i.x+i.width/2-a.width/2,a.y=i.y+i.height/2-a.height/2,this.addChild(a);var n=LanguageManager.getlocal("dinnerTitle"+e.dtype),o=LanguageManager.getlocal("dinnerMsgDesc",[n,e.num,e.enemy_num]),s=ComponentManager.getTextField(o,TextFieldConst.FONTSIZE_CONTENT_SMALL);s.x=70,s.y=20,this.addChild(s);var r=LanguageManager.getlocal("dinnerMsgTime",[App.DateUtil.getFormatBySecond(e.start_time,2)]),l=ComponentManager.getTextField(r,TextFieldConst.FONTSIZE_CONTENT_SMALL);l.textColor=TextFieldConst.COLOR_QUALITY_ORANGE,l.x=s.x,l.y=s.y+s.height+13,this.addChild(l);var h=e.point,d=e.score;h>=0&&(h="+"+h),d>=0&&(d="+"+d);var g=LanguageManager.getlocal("dinnerMsgInfo",[h,d]),c=ComponentManager.getTextField(g,TextFieldConst.FONTSIZE_CONTENT_SMALL);c.x=s.x,c.textColor=TextFieldConst.COLOR_WARN_GREEN,c.y=l.y+l.height+13,this.addChild(c);var p=BaseBitmap.create("dinner_line");p.x=260-p.width/2,p.y=this.height,this.addChild(p)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(DinnerMsgPopupScollItem.prototype,"DinnerMsgPopupScollItem");var DinnerMsgPopupView=function(t){function e(){var e=t.call(this)||this;return e._infoList=null,e._merank=0,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["rank_line","dinner_rankbg"])},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_DINNER_HISTORY,requestData:{}}},e.prototype.receiveData=function(t){this._infoList=t.data.data.historydinfo},e.prototype.initView=function(){App.LogUtil.show("initView");var t=["dinnerMsgPopupViewTitle"],e=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,t,null,null);e.x=40,e.y=10,this.addChildToContainer(e);var i=BaseBitmap.create("public_9_probiginnerbg");i.width=520,i.height=618,i.setPosition(this.viewBg.width/2-i.width/2,e.y+e.height),this.addChildToContainer(i);var a=egret.Rectangle.create();a.setTo(0,0,508,i.height-20),this._scrollList=ComponentManager.getScrollList(DinnerMsgPopupScollItem,this._infoList,a),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(i.x+5,i.y+10),this._scrollList.setEmptyTip(LanguageManager.getlocal("dinnerMsgPopupEmptyTip"))},e.prototype.dispose=function(){this._scrollList=null,this._scroRect=null,this._infoList=null,this._merank=0,t.prototype.dispose.call(this)},e}(PopupView);__reflect(DinnerMsgPopupView.prototype,"DinnerMsgPopupView");var DinnerOpenedView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return["dinner_flower","dinner_open_word"]},e.prototype.getBgName=function(){return"public_9_bg8"},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getCloseBtnName=function(){return null},e.prototype.initView=function(){this._obj=this.param.data.o,this._callbackF=this.param.data.f;var t=BaseBitmap.create("dinner_flower");t.setPosition(GameConfig.stageWidth/2-t.width/2,GameConfig.stageHeigth/2-t.height),this.addChildToContainer(t);var e=BaseBitmap.create("dinner_open_word");e.setPosition(GameConfig.stageWidth/2-e.width/2,GameConfig.stageHeigth/2-t.height/2-e.height/2),this.addChildToContainer(e);var i=BaseBitmap.create("public_9_wordbg");i.width=GameConfig.stageWidth,i.height=222,i.setPosition(0,GameConfig.stageHeigth/2-60),this.addChildToContainer(i);var a=LanguageManager.getlocal("dinnerTitle"+this.param.data.type),n=ComponentManager.getTextField(LanguageManager.getlocal("openSuccessDesc",[a]),TextFieldConst.FONTSIZE_TITLE_SMALL);n.width=585,n.lineSpacing=6,n.setPosition(GameConfig.stageWidth/2-n.width/2,i.y+35),this.addChild(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("playerId",[Api.playerVoApi.getPlayerID().toString()]),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_WARN_GREEN);o.setPosition(GameConfig.stageWidth/2-o.width/2,i.y-52+i.height),this.addChild(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("shareDinnerDesc"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);s.setPosition(GameConfig.stageWidth/2-s.width/2,i.y+50+i.height),this.addChild(s);var r=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"sysConfirm",this.hide,this);r.setPosition(GameConfig.stageWidth/2-r.width/2,i.y+86+i.height),this.addChildToContainer(r)},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.dispose=function(){this._callbackF=null,this._obj=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(DinnerOpenedView.prototype,"DinnerOpenedView");var DinnerRankItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=502,this.height=52;var i;if(3>t){var a=BaseBitmap.create("dinner_rank"+String(t+1));a.x=62-a.width/2,a.y=this.height/2-a.height/2,this.addChild(a)}else{var a=BaseBitmap.create("dinner_rankbg");a.x=62-a.width/2,a.y=this.height/2-a.height/2,this.addChild(a),i=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON),i.text=String(t+1),i.x=62-i.width/2,i.y=this.height/2-i.height/2,this.addChild(i)}var n=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_CONTENT_COMMON);n.x=220-n.width/2,n.y=this.height/2-n.height/2,this.addChild(n);var o=ComponentManager.getTextField(e.total_point,TextFieldConst.FONTSIZE_CONTENT_COMMON);o.x=404-o.width/2,o.y=this.height/2-n.height/2,this.addChild(o),e.uid==Api.playerVoApi.getPlayerID()&&(i&&(i.textColor=TextFieldConst.COLOR_WARN_YELLOW),n.textColor=TextFieldConst.COLOR_WARN_YELLOW,o.textColor=TextFieldConst.COLOR_WARN_YELLOW);var s=BaseBitmap.create("dinner_line");s.x=260-s.width/2,s.y=this.height,this.addChild(s)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(DinnerRankItem.prototype,"DinnerRankItem");var DinnerRankPopupView=function(t){function e(){var e=t.call(this)||this;return e._infoList=null,e._merank=0,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["rank_line","dinner_rankbg"])},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_DINNER_TOP,requestData:{}}},e.prototype.receiveData=function(t){this._infoList=t.data.data.dinnertop,this._merank=t.data.data.merank},e.prototype.initView=function(){var t=["dinnerRank"],e=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,t,null,null);e.x=40,e.y=10,this.addChildToContainer(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("dinnerRankDesc"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);i.setPosition(this.viewBg.width-40-i.width,22),this.addChildToContainer(i);var a=BaseBitmap.create("public_9_probiginnerbg");a.width=520,a.height=526,a.setPosition(this.viewBg.width/2-a.width/2,e.y+e.height),this.addChildToContainer(a);var n=BaseBitmap.create("dinner_rank_titlebg");n.width=a.width,n.height=36,n.setPosition(a.x,a.y),this.addChildToContainer(n),this._scroRect=new egret.Rectangle(n.x,n.y+n.height,n.width,a.height-n.height-8),this._scrollList=ComponentManager.getScrollList(DinnerRankItem,this._infoList,this._scroRect),this._scrollList.x=n.x,this._scrollList.y=n.y+n.height,this._scrollList.setEmptyTip(LanguageManager.getlocal("allianceBossRank_emptyTip")),this.addChildToContainer(this._scrollList);var o=BaseBitmap.create("public_9_probiginnerbg");o.width=516,o.height=84,o.setPosition(this.viewBg.width/2-o.width/2,a.y+a.height+8),this.addChildToContainer(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("rankorder"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);s.setPosition(65,n.y+n.height/2-s.height/2),this.addChildToContainer(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("ranknickName"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);r.setPosition(200,s.y),this.addChildToContainer(r);var l=ComponentManager.getTextField(LanguageManager.getlocal("dinnerScore"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);l.setPosition(387,s.y),this.addChildToContainer(l);var h=ComponentManager.getTextField(LanguageManager.getlocal("ranknickName")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);h.setPosition(s.x,o.y+o.height/2-5-h.height),this.addChildToContainer(h);var d=ComponentManager.getTextField(LanguageManager.getlocal("rankorder")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);d.setPosition(s.x,o.y+o.height/2+5),this.addChildToContainer(d);var g=ComponentManager.getTextField(Api.playerVoApi.getPlayerName(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);g.setPosition(h.x+h.width+12,h.y),this.addChildToContainer(g);var c;c=this._merank>300?"10000+":this._merank.toString();var p=ComponentManager.getTextField(c,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_GREEN);p.setPosition(d.x+d.width+12,d.y),this.addChildToContainer(p);var _=ComponentManager.getTextField(Api.dinnerVoApi.getTotalPoint().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_GREEN);_.setPosition(o.x+o.width-20-_.width,d.y),this.addChildToContainer(_);var u=ComponentManager.getTextField(LanguageManager.getlocal("playerScore")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);u.setPosition(_.x-20-u.width,d.y),this.addChildToContainer(u)},e.prototype.dispose=function(){this._scrollList=null,this._scroRect=null,this._infoList=null,this._merank=0,t.prototype.dispose.call(this)},e}(PopupView);__reflect(DinnerRankPopupView.prototype,"DinnerRankPopupView");var DinnerRewardView=function(t){function e(){var e=t.call(this)||this;return e._isOpend=!1,e._callbackF=null,e._obj=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return["dinner_reward_box","promotion_officerbg1"]},e.prototype.getBgName=function(){return"public_9_bg8"},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getCloseBtnName=function(){return null},e.prototype.touchTap=function(){this._isOpend&&(this._obj&&this._callbackF&&this._callbackF.apply(this._obj),this.hide())},e.prototype.initView=function(){this._isOpend=!1,this.addTouchTap(this.touchTap,this,null),this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f);var t=Api.playerVoApi.getPlayerPortrait(this.param.data.level,this.param.data.pic);t.setScale(1.3),t.setPosition(GameConfig.stageWidth/2-t.width/2*t.scaleX,GameConfig.stageHeigth/2-230),this.addChildToContainer(t);var e=BaseBitmap.create("promotion_officerbg1");e.setPosition(GameConfig.stageWidth/2-e.width/2,GameConfig.stageHeigth/2+360),this.addChildToContainer(e);var i=ComponentManager.getTextField(this.param.data.name,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);i.setPosition(e.x+e.width/2-i.width/2,e.y+e.height/2-i.height/2),this.addChildToContainer(i),this.container.alpha=0,egret.Tween.get(this.container).to({alpha:1},300).wait(500).call(this.showView,this)},e.prototype.showView=function(){this._isOpend=!0;var t=BaseBitmap.create("public_9_bg25");t.width=504,t.height=104,t.setPosition(GameConfig.stageWidth/2-t.width/2,GameConfig.stageHeigth/2-380),this.addChildToContainer(t);var e=BaseBitmap.create("public_9_bg25_tail");e.x=t.x+t.width/2+120,e.y=t.y+t.height-3,this.addChildToContainer(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("dinnerRewardTip"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);i.width=466,i.lineSpacing=6,i.setPosition(t.x+t.width/2-i.width/2,t.y+t.height/2-i.height/2),this.addChildToContainer(i);var a=BaseBitmap.create("dinner_reward_box");a.setPosition(GameConfig.stageWidth/2-a.width/2,GameConfig.stageHeigth/2+5),this.addChildToContainer(a);var n=egret.Point.create(GameConfig.stageWidth/2,a.y+a.height/2-30),o=[];if(o.push({tipMessage:LanguageManager.getlocal("dinnerGetScore")+"+"+this.param.data.point}),Api.switchVoApi.checkCloseDinnerNewFunc()||o.push({tipMessage:LanguageManager.getlocal("dinnerScore")+"+"+this.param.data.point}),this.param.data.reward&&"string"==typeof this.param.data.reward&&""!=this.param.data.reward){var s=GameData.formatRewardItem(this.param.data.reward);for(var r in s){var l=s[r];o.push({icon:l.icon,tipMessage:"+"+l.num})}}App.CommonUtil.playRewardFlyAction(o,n)},e.prototype.dispose=function(){this._isOpend=!1,this._callbackF=null,this._obj=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(DinnerRewardView.prototype,"DinnerRewardView");var DinnerSharePopupView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e}return __extends(e,t),e.prototype.getTitleStr=function(){return"dinner_share"},e.prototype.initView=function(){this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f);var t=["share_to_world"];Api.playerVoApi.getPlayerAllianceId()>0&&t.push("share_to_alliance");for(var e=0;e<t.length;e++){var i=this.getItem(t[e],e);i.setPosition(this.viewBg.width/2-i.width/2,40+82*e),this.addChildToContainer(i)}},e.prototype.getItem=function(t,e){var i=new BaseDisplayObjectContainer,a=BaseBitmap.create("public_9_bg28");a.width=500,i.addChild(a);var n=ComponentManager.getTextField(LanguageManager.getlocal(t),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);return n.x=i.width/2-n.width/2,n.y=i.height/2-n.height/2,i.addChild(n),a.addTouch(this.eventHandler,this,[e,a]),i},e.prototype.doShareDinner=function(t){if(GameData.serverTime-Api.dinnerVoApi.lastShareTime[t]<5)return void App.CommonUtil.showTip(LanguageManager.getlocal("chatTimeTip"));Api.dinnerVoApi.lastShareTime[t]=GameData.serverTime;var e={};0==t?e.channel=1:e.channel=Api.playerVoApi.getPlayerAllianceId();var i=LanguageManager.getlocal("dinnerTitle"+[Api.dinnerVoApi.getDtype().toString()]);e.message=LanguageManager.getlocal("dinner_share_text",[Api.playerVoApi.getPlayerName(),i]),NetManager.requestChat(e),App.CommonUtil.showTip(LanguageManager.getlocal("share_success")),NetManager.request(NetRequestConst.REQUEST_DINNER_SHAREDINNER,{}),this._obj&&this._callbackF&&this._callbackF.apply(this._obj),this.hide()},e.prototype.eventHandler=function(t,e,i){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:i.texture=ResourceManager.getRes("public_9_bg28_down");break;case egret.TouchEvent.TOUCH_CANCEL:i.texture=ResourceManager.getRes("public_9_bg28");break;case egret.TouchEvent.TOUCH_END:i.texture=ResourceManager.getRes("public_9_bg28"),this.doShareDinner(e)}},e.prototype.dispose=function(){this._callbackF=null,this._obj=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(DinnerSharePopupView.prototype,"DinnerSharePopupView");var DinnerTypePopupView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e._scrollContainer=null,e}return __extends(e,t),e.prototype.initView=function(){this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f);var t=BaseBitmap.create("public_9_resbg");t.setPosition(32,12),this.addChildToContainer(t);var e=BaseLoadBitmap.create("itemicon1");e.setScale(.5),e.x=t.x-3,e.y=t.y+t.height/2-50+25,this.addChildToContainer(e);var i=ComponentManager.getTextField(Api.playerVoApi.getPlayerGem().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON);i.setPosition(t.x+50,t.y+t.height/2-i.height/2),this.addChildToContainer(i),t.width=i.width+70;var a=BaseBitmap.create("public_9_bg4");a.width=528,a.height=626,a.setPosition(this.viewBg.width/2-a.width/2,60),this.addChildToContainer(a);var n=egret.Rectangle.create();n.setTo(0,0,this.viewBg.width,a.height+a.y),this._scrollContainer=new BaseDisplayObjectContainer;var o=ComponentManager.getScrollView(this._scrollContainer,n);this.addChildToContainer(o),this._scrollContainer.setPosition(0,a.y);var s=Config.DinnerCfg.getFeastItemList();for(var r in s){var l=Number(r),h=this.getDinnerTypeContainer(l);h.setPosition(this.viewBg.width/2-259+4,155*(l-1)+10),this._scrollContainer.addChild(h)}},e.prototype.getDinnerTypeContainer=function(t){var e=new BaseDisplayObjectContainer,i=BaseBitmap.create("public_9_probiginnerbg");i.width=508,i.height=145,e.addChild(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("dinnerType"+t),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);a.setPosition(130,15),e.addChild(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("expend"),TextFieldConst.FONTSIZE_CONTENT_COMMON);n.setPosition(a.x,a.y+a.height+12),e.addChild(n);var o=Config.DinnerCfg.getGoToFeastItemCfg(t);if(o.needGem){var s=BaseBitmap.create("itembg_5");s.setPosition(11,i.height/2-s.height/2),e.addChild(s);var r=BaseBitmap.create("dinner_gems_"+t);r.setPosition(s.x+s.width/2-r.width/2,s.y+s.height/2-r.height/2),e.addChild(r);var l=egret.Rectangle.create();l.setTo(0,0,45,45);var h=BaseLoadBitmap.create("itemicon1",l);h.setPosition(n.x+n.width+10,n.y+n.height/2-22.5),e.addChild(h);var d=ComponentManager.getTextField(o.needGem.toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_YELLOW);d.setPosition(h.x+50,n.y),e.addChild(d)}else{var g=Config.ItemCfg.getItemCfgById(Number(o.needItem)),r=GameData.getItemIcon(g);r.setPosition(11,i.height/2-r.height/2),e.addChild(r);var d=ComponentManager.getTextField(g.name+"x1",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_YELLOW);d.setPosition(n.x+n.width+10,n.y),e.addChild(d)}var c=ComponentManager.getTextField(LanguageManager.getlocal("effectTitle"),TextFieldConst.FONTSIZE_CONTENT_COMMON);c.setPosition(n.x,n.y+n.height+23),e.addChild(c);var p=ComponentManager.getTextField(LanguageManager.getlocal("dinnerEffect1",["+"+o.getScore.toString()]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN);if(p.setPosition(c.x+c.width,n.y+n.height+10),e.addChild(p),o.getPoint>0){var _=ComponentManager.getTextField(LanguageManager.getlocal("dinnerEffect2",["+"+o.getPoint.toString()]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN);_.setPosition(c.x+c.width,n.y+n.height+35),e.addChild(_);var u=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"dinnerFeast",this.touchTap,this,[t]);u.setPosition(i.width-u.width-10,20),u.setColor(TextFieldConst.COLOR_BLACK),e.addChild(u)}else{var _=ComponentManager.getTextField(LanguageManager.getlocal("dinnerEffect2",[o.getPoint.toString()]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_RED3);_.setPosition(c.x+c.width,n.y+n.height+35),e.addChild(_);var u=ComponentManager.getButton(ButtonConst.BTN_SMALL_RED,"dinnerType4",this.touchTap,this,[t]);u.setPosition(i.width-u.width-10,20),u.setColor(TextFieldConst.COLOR_BLACK),e.addChild(u)}return e},e.prototype.touchTap=function(t){var e=Config.DinnerCfg.getGoToFeastItemCfg(t);if(e.needGem){if(e.needGem>Api.playerVoApi.getPlayerGem())return void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough"))}else{var i=e.needItem,a=Api.itemVoApi.getItemNumInfoVoById(Number(i));if(1>a)return void App.CommonUtil.showTip(LanguageManager.getlocal("goodsNotEnough"))}Config.DinnerCfg.getFeastItemCfg(t);this._obj&&this._callbackF&&this._callbackF.apply(this._obj,[t]),this.hide()},e.prototype.dispose=function(){this._callbackF=null,this._obj=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(DinnerTypePopupView.prototype,"DinnerTypePopupView");var DinnerView=function(t){function e(){var e=t.call(this)||this;return e._scrollContainer=null,e._dinnerTimeText=null,e._enterDinnerText=null,e._isHasMyDinner=!1,e._deskTab={},e._needShowOpenedType=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["dinner_bg","dinner_black_circle","dinner_desk1","dinner_desk2","dinner_drum","dinner_exchange","dinner_message","dinner_name_bg1","dinner_name_bg2","dinner_rank","dinner_tip","dinner_waitress","dinner_roof","wifeview_bottombg","dinner_rank_titlebg","dinner_line"])},e.prototype.getRequestData=function(){return null},e.prototype.receiveData=function(t){},e.prototype.initView=function(){var t=this;Api.rookieVoApi.checkNextStep(),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT,this.doGuide,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_CANVIEWDINNER),this.requiestCallback,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_DINNER,this.resetDeskAndText,this),Api.dinnerVoApi.getEndTime()>0&&Api.dinnerVoApi.getEndTime()>0?this._isHasMyDinner=!0:this._isHasMyDinner=!1,this.container.y=this.getTitleButtomY(),this._scrollContainer=new BaseDisplayObjectContainer;var e=BaseBitmap.create("wifeview_bottombg"),i=egret.Rectangle.create();i.setTo(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-this.getTitleButtomY()-e.height);var a=ComponentManager.getScrollView(this._scrollContainer,i);a.bounces=!1,this.addChildToContainer(a);var n=BaseBitmap.create("dinner_bg");this._scrollContainer.addChild(n);var o=BaseBitmap.create("public_9_bg8");o.width=240,o.height=240,o.setPosition(GameConfig.stageWidth/2-o.width/2,120),this._scrollContainer.addChild(o),o.addTouchTap(this.enterDinnerHandler,this),o.alpha=0;var s=ComponentManager.getButton("dinner_roof",null,this.enterDinnerHandler,this,null,1);s.setPosition(GameConfig.stageWidth/2-s.width/2+7,309),this._scrollContainer.addChild(s);var r=new BaseDisplayObjectContainer;this._scrollContainer.addChild(r);var l=BaseBitmap.create("dinner_tip");l.setPosition(GameConfig.stageWidth/2-l.width/2,256),r.addChild(l);var h=r.y,d=function(){egret.Tween.get(r).to({y:h+5},1e3).to({y:h-5},1e3).call(d,t)};if(d(),this._enterDinnerText=ComponentManager.getTextField(LanguageManager.getlocal(""),TextFieldConst.FONTSIZE_CONTENT_COMMON),this._enterDinnerText.y=l.y+10,r.addChild(this._enterDinnerText),this.resetTextInfo(),!Api.switchVoApi.checkOpenShenhe()){var g=BaseBitmap.create("dinner_black_circle");g.setPosition(12,10),this._scrollContainer.addChild(g);var c=ComponentManager.getButton("dinner_rank",null,this.rankClickHandler,this);c.setPosition(g.x+8,g.y),this._scrollContainer.addChild(c)}var p=ComponentManager.getButton("dinner_drum",null,this.exchangeClickHandler,this,null,1);p.setPosition(106,338),this._scrollContainer.addChild(p);var _=BaseBitmap.create("dinner_exchange");_.setPosition(p.width/2-_.width/2-2,18),p.addChild(_);var u=ComponentManager.getButton("dinner_drum",null,this.messageClickHandler,this,null,1);u.setPosition(GameConfig.stageWidth-106-u.width,p.y),this._scrollContainer.addChild(u);var C=BaseBitmap.create("dinner_message");C.setPosition(u.width/2-C.width/2-2,30),u.addChild(C),PlatformManager.checkIsKRSp()&&(_.y=_.y+17,C.y=C.y+17,_.x=_.x+2,C.x=C.x+2);var f=new BaseDisplayObjectContainer;f.y=i.height,this.addChildToContainer(f),f.addChild(e);var m=ComponentManager.getTextField(LanguageManager.getlocal("dinnerTimes"),TextFieldConst.FONTSIZE_CONTENT_COMMON);m.setPosition(25,e.height/2-m.height/2),f.addChild(m),this._dinnerTimeText=ComponentManager.getTextField(this.getDinnerTimesStr(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN),this._dinnerTimeText.setPosition(m.x+m.width+15,e.height/2-this._dinnerTimeText.height/2),f.addChild(this._dinnerTimeText);var T=ComponentManager.getTextField(LanguageManager.getlocal("codeInquireDinner"),TextFieldConst.FONTSIZE_CONTENT_COMMON);T.setPosition(455-T.width,e.height/2-T.height/2),f.addChild(T);var y=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"codeToDinner",this.inquirClickHandler,this);y.setPosition(GameConfig.stageWidth-18-y.width,e.height/2-y.height/2),y.setColor(TextFieldConst.COLOR_BLACK),f.addChild(y),this.showAllDesk(),Api.dinnerVoApi.getListInfoLength()>0?TimerManager.doTimer(300,1,this.sendRequiest,this):this.sendRequiest()},e.prototype.sendRequiest=function(){NetManager.request(NetRequestConst.REQUEST_DINNER_CANVIEWDINNER,{})},e.prototype.requiestCallback=function(t){1==t.data.ret&&(Api.dinnerVoApi.setListInfo(t.data.data.data.vdinfo),this.showAllDesk(),1==this._isHasMyDinner&&(App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_GETDINNERDETAIL),this.getDetailCallback,this),NetManager.request(NetRequestConst.REQUEST_DINNER_GETDINNERDETAIL,{getuid:Api.playerVoApi.getPlayerID()})))},e.prototype.getDetailCallback=function(t){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_GETDINNERDETAIL),this.getDetailCallback,this),1==t.data.ret&&(t.data.data.data.dinnerReport&&(Api.dinnerVoApi.formatData(t.data.data.data.dinnerdetail),ViewController.getInstance().openView(ViewConst.BASE.DINNERFINISHVIEW,{info:t.data.data.data.dinnerReport,baodi:t.data.data.data.baodiNum}),this.resetTextInfo()),t.data.data.data.resReport&&t.data.data.data.resReport.length>0&&ViewController.getInstance().openView(ViewConst.POPUP.DINNERMESSAGEPOPUPVIEW,{info:t.data.data.data.resReport}))},e.prototype.requiestCallback2=function(t){if(App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_GETDINNERDETAIL),this.requiestCallback2,this),1==t.data.ret)if(t.data.data.data.dinnerReport)Api.dinnerVoApi.formatData(t.data.data.data.dinnerdetail),ViewController.getInstance().openView(ViewConst.BASE.DINNERFINISHVIEW,{info:t.data.data.data.dinnerReport,baodi:t.data.data.data.baodiNum}),this.resetTextInfo();else{var e={info:t.data.data.data,uid:Api.playerVoApi.getPlayerID()};null!=this._needShowOpenedType&&(e.needOpen={type:this._needShowOpenedType},this._needShowOpenedType=null),ViewController.getInstance().openView(ViewConst.COMMON.DINNERDETAILVIEW,e)}},e.prototype.showAllDesk=function(){for(var t=0,e=0;6>e;e++){var i=Api.dinnerVoApi.getListInfo(e),a=this._deskTab[e];i&&!a?t+=this.showDesk(e,1,i):!i&&a?t+=this.showDesk(e,3):i&&a&&(i.uid==a.uid&&i.dtype==a.dtype?a.setCurNum(i.num):t+=this.showDesk(e,2,i))}t>0&&App.CommonUtil.showTip(LanguageManager.getlocal("dinner_refreshed"))},e.prototype.showDesk=function(t,e,i){if(1==e)return this.initDesk(t,i),0;if(2==e){var a=250;t%2==0&&(a=-250);var n=this._deskTab[t];egret.Tween.get(n).to({x:n.x+a},200).call(this.delCallback,this,[n]);var o=this.initDesk(t,i);return o.x+=a,egret.Tween.get(o).wait(200).to({x:o.x-a},200),1}if(3==e){var a=250;t%2==0&&(a=-250);var s=this._deskTab[t];return egret.Tween.get(s).to({x:s.x+a},200).call(this.delCallback2,this,[t]),1}},e.prototype.delCallback2=function(t){var e=this._deskTab[t];this._scrollContainer.removeChild(e),this._deskTab[t]=null},e.prototype.delCallback=function(t){this._scrollContainer.removeChild(t)},e.prototype.initDesk=function(t,e){var i=new DinnerDesk;return i.init(e,this.clickDesk,this,t),2>t?(i.setScale(.86),i.y=708-i.height,i.x=95+300*(t%2)):4>t?(i.setScale(.93),i.y=894-i.height,i.x=55+360*(t%2)):(i.y=1080-i.height,i.x=15+421*(t%2)),this._scrollContainer.addChild(i),this._deskTab[t]=i,i},e.prototype.getDinnerTimesStr=function(){var t=Config.DinnerCfg.getGoToFeastNum()-Api.dinnerVoApi.getDayNum();return 0>t&&(t=0),t+"/"+Config.DinnerCfg.getGoToFeastNum()},e.prototype.enterDinnerHandler=function(){this._isHasMyDinner?(App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_GETDINNERDETAIL),this.requiestCallback2,this),NetManager.request(NetRequestConst.REQUEST_DINNER_GETDINNERDETAIL,{getuid:Api.playerVoApi.getPlayerID()})):ViewController.getInstance().openView(ViewConst.POPUP.HOLDDINNERPOPUPVIEW,{f:this.createDinnerCallback,o:this})},e.prototype.inquirClickHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.DINNERFINDPOPUPVIEW,{})},e.prototype.rankClickHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.DINNERRANKPOPUPVIEW,{})},e.prototype.exchangeClickHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.DINNEREXCHANGEPOPUPVIEW,{})},e.prototype.doGuide=function(){this.exchangeClickHandler()},e.prototype.messageClickHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.DINNERMSGPOPUPVIEW,null)},e.prototype.clickDesk=function(t){var e=Api.dinnerVoApi.getListInfo(t);ViewController.getInstance().openView(ViewConst.BASE.GOTODINNEREDVIEW,{info:e})},e.prototype.createDinnerCallback=function(t){Api.dinnerVoApi.getEndTime()>0&&Api.dinnerVoApi.getEndTime()>0?this._isHasMyDinner=!0:this._isHasMyDinner=!1,this.resetTextInfo(),this._needShowOpenedType=t,this.enterDinnerHandler()},e.prototype.resetDeskAndText=function(){this.sendRequiest(),this.resetTextInfo(),this._dinnerTimeText.text=this.getDinnerTimesStr()},e.prototype.resetTextInfo=function(){Api.dinnerVoApi.getEndTime()>0&&Api.dinnerVoApi.getDtype()>0?this._isHasMyDinner=!0:this._isHasMyDinner=!1,1==this._isHasMyDinner?this._enterDinnerText.text=LanguageManager.getlocal("interDinner"):this._enterDinnerText.text=LanguageManager.getlocal("clickHoldDinner"),this._enterDinnerText.x=GameConfig.stageWidth/2-this._enterDinnerText.width/2
},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT,this.doGuide,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_CANVIEWDINNER),this.requiestCallback,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_DINNER,this.resetDeskAndText,this),this._scrollContainer=null,this._dinnerTimeText=null,this._enterDinnerText=null,this._isHasMyDinner=!1,this._deskTab={},this._needShowOpenedType=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(DinnerView.prototype,"DinnerView");var GotoDinnerView=function(t){function e(){var e=t.call(this)||this;return e._netInfo=null,e._isWaiting=!1,e._isDinnerEnd=!1,e}return __extends(e,t),e.prototype.getResourceList=function(){return["goto_dinner_bg","goto_dinner_namebg"]},e.prototype.getBgName=function(){return"public_9_bg8"},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getCloseBtnName=function(){return null},e.prototype.initView=function(){ViewController.getInstance().hideView(ViewConst.COMMON.DINNERDETAILVIEW),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_GETDINNERDETAIL),this.requiestCallback,this);var t=BaseBitmap.create("goto_dinner_bg");this.addChildToContainer(t);var e=BaseBitmap.create("goto_dinner_namebg");e.width=422,e.height=85,e.setPosition(GameConfig.stageWidth/2-e.width/2,GameConfig.stageHeigth/2-e.height/2+300),this.addChildToContainer(e);var i=this.param.data.info,a=BaseBitmap.create("public_9_bg8");a.width=352,a.height=40,a.setPosition(GameConfig.stageWidth/2-a.width/2,e.y+e.height/2-a.height/2),this.addChildToContainer(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("gotoDinner",[i.name]),TextFieldConst.FONTSIZE_CONTENT_COMMON);n.setPosition(e.x+e.width/2-n.width/2,e.y+e.height/2-n.height/2),this.addChildToContainer(n),this._isWaiting=!0,NetManager.request(NetRequestConst.REQUEST_DINNER_GETDINNERDETAIL,{getuid:Number(i.uid)}),this.container.alpha=0,egret.Tween.get(this.container).to({alpha:1},300).wait(500).call(this.showView,this)},e.prototype.showView=function(){this._isWaiting=!1,1==this._isDinnerEnd?(App.CommonUtil.showTip(LanguageManager.getlocal("dinner_is_over")),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_DINNER),this.hide()):this._netInfo&&egret.Tween.get(this.container).to({alpha:1},300).call(this.realShowView,this)},e.prototype.realShowView=function(){var t=this.param.data.info;ViewController.getInstance().openView(ViewConst.COMMON.DINNERDETAILVIEW,{info:this._netInfo,uid:t.uid}),this.hide()},e.prototype.requiestCallback=function(t){1==t.data.ret?(this._netInfo=t.data.data.data,0==this._isWaiting&&this.showView()):(this._isDinnerEnd=!0,0==this._isWaiting&&this.showView())},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_GETDINNERDETAIL),this.requiestCallback,this),this._netInfo=null,this._isWaiting=!1,this._isDinnerEnd=!1,t.prototype.dispose.call(this)},e}(CommonView);__reflect(GotoDinnerView.prototype,"GotoDinnerView");var HoldDinnerPopupView=function(t){function e(){var e=t.call(this)||this;return e._isOpen=!1,e._nikeIcon=null,e._callbackF=null,e._obj=null,e._clickedIdx=0,e}return __extends(e,t),e.prototype.getResourceList=function(){var e=["hold_dinner_bg1","hold_dinner_bg2","hold_dinner_box","hold_dinner_check","hold_title_bg1","dinner_open_bg","hold_title_bg2"];return t.prototype.getResourceList.call(this).concat(e)},e.prototype.initView=function(){this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_CREATDINNER),this.requiestCallback,this);var t=BaseBitmap.create("public_9_bg8");t.width=518,t.height=540,t.setPosition(this.viewBg.width/2-t.width/2,20),this.addChildToContainer(t);var e=BaseBitmap.create("public_9_resbg");e.setPosition(t.x+12,t.y+12),this.addChildToContainer(e);var i=BaseLoadBitmap.create("itemicon1");i.setScale(.5),i.x=e.x-3,i.y=e.y+e.height/2-50+25,this.addChildToContainer(i);var a=ComponentManager.getTextField(Api.playerVoApi.getPlayerGemStr(),TextFieldConst.FONTSIZE_CONTENT_COMMON);a.setPosition(e.x+50,e.y+e.height/2-a.height/2),this.addChildToContainer(a),e.width=a.width+70;var n=this.getHoldDinnerInfoContainer(1);n.setPosition(this.viewBg.width/2-n.width/2,80),this.addChildToContainer(n);var o=this.getHoldDinnerInfoContainer(2);o.setPosition(n.x,70+n.height+10),this.addChildToContainer(o)},e.prototype.getHoldDinnerInfoContainer=function(t){var e=new BaseDisplayObjectContainer,i=BaseBitmap.create("hold_dinner_bg"+t);e.addChild(i);var a=BaseBitmap.create("hold_title_bg"+t);a.setPosition(5,5),e.addChild(a);var n=Config.DinnerCfg.getFeastItemCfg(t),o=ComponentManager.getTextField(LanguageManager.getlocal("holdDinnerTitle",[LanguageManager.getlocal("dinnerTitle"+t),n.contain.toString()]),TextFieldConst.FONTSIZE_TITLE_SMALL);o.setPosition(a.x+17,a.y+a.height/2-o.height/2),e.addChild(o);var s=BaseBitmap.create("public_numbg");s.setPosition(372,8),e.addChild(s);var r=egret.Rectangle.create();r.setTo(0,0,35,35);var l=BaseLoadBitmap.create("itemicon1",r);l.setPosition(s.x,s.y+3),e.addChild(l);var h=ComponentManager.getTextField(n.needGem.toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL);h.setPosition(l.x+l.width+5,s.y+s.height/2-h.height/2),e.addChild(h);var d=ComponentManager.getTextField(LanguageManager.getlocal("holdDinnerCondition"),TextFieldConst.FONTSIZE_CONTENT_SMALL);d.setPosition(20,64),e.addChild(d);var g=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"holdDinner",this.holdDinner,this,[t]);g.setPosition(370,i.height-g.height-20),g.setColor(TextFieldConst.COLOR_BLACK),e.addChild(g);var c=d.x;for(var p in n.needItem){var _=GameData.getItemIcon(Config.ItemCfg.getItemCfgById(Number(p)),!0);_.setPosition(c,d.y+d.height+8),_.setScale(75/_.width),e.addChild(_);var u=n.needItem[p],C=ComponentManager.getTextField(u.toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL);C.setPosition(_.width-3-C.width,_.height-3-C.height),_.addChild(C);var f=Api.itemVoApi.getItemNumInfoVoById(Number(p)),m=ComponentManager.getTextField("("+f+"/"+u+")",TextFieldConst.FONTSIZE_CONTENT_SMALL);m.setPosition(c+37.5-m.width/2,_.y+78),u>f?m.textColor=TextFieldConst.COLOR_WARN_RED3:m.textColor=TextFieldConst.COLOR_WARN_GREEN,e.addChild(m),c+=85}if(1==t){var T=BaseBitmap.create("dinner_open_bg");T.setPosition(200,155),e.addChild(T);var y=ComponentManager.getTextField(LanguageManager.getlocal("openDinner"),TextFieldConst.FONTSIZE_CONTENT_SMALL);y.setPosition(T.x+15,T.y+T.height/2-y.height/2),e.addChild(y);var v=ComponentManager.getButton("hold_dinner_box",null,this.openDinnerClick,this,null,3);v.setPosition(T.x+100,T.y+T.height/2-v.height/2),e.addChild(v),this._nikeIcon=BaseBitmap.create("hold_dinner_check"),this._nikeIcon.setPosition(v.x,v.y),e.addChild(this._nikeIcon),this.openDinnerClick()}return e},e.prototype.openDinnerClick=function(){this._isOpen=!this._isOpen,this._nikeIcon.visible=this._isOpen},e.prototype.holdDinner=function(t){var e=Config.DinnerCfg.getFeastItemCfg(t);if(e.needGem>Api.playerVoApi.getPlayerGem())return void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough"));for(var i in e.needItem){var a=e.needItem[i],n=Api.itemVoApi.getItemNumInfoVoById(Number(i));if(a>n)return void App.CommonUtil.showTip(LanguageManager.getlocal("goodsNotEnough"))}this._clickedIdx=t,NetManager.request(NetRequestConst.REQUEST_DINNER_CREATDINNER,{dtype:t,isopen:this._isOpen?1:0})},e.prototype.requiestCallback=function(t){1==t.data.ret&&(this._obj&&this._callbackF&&this._callbackF.apply(this._obj,[this._clickedIdx]),this.hide())},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_DINNER_CREATDINNER),this.requiestCallback,this),this._nikeIcon=null,this._isOpen=!1,this._callbackF=null,this._obj=null,this._clickedIdx=0,t.prototype.dispose.call(this)},e}(PopupView);__reflect(HoldDinnerPopupView.prototype,"HoldDinnerPopupView");var AnnouncementScrollItem=function(t){function e(){var e=t.call(this)||this;return e.bg1=null,e.bg2=null,e.itemListType=!1,e.touchNum=0,e._titleText=null,e._contentText=null,e.currData={},e}return __extends(e,t),e.prototype.initItem=function(t,e){this.currData=e,this.bg1=BaseBitmap.create("public_9_bg35"),this.bg1.width=506,this.bg1.height=60,this.addChild(this.bg1),this.itemListType?GameAnnouncementView.currNum==t&&(this.touchNum+=1,this.showDes()):this.closeDes(),this.showText()},e.prototype.showText=function(){this._titleText=ComponentManager.getTextField(this.currData.title,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN),this._titleText.x=this.bg1.x+30,this._titleText.y=this.bg1.y+20,this.addChild(this._titleText)},e.prototype.showDes=function(){this.bg2=BaseBitmap.create("public_9_probiginnerbg"),this.bg2.width=502,this.bg2.height=220,this.bg2.x=this.bg2.x+2,this.bg2.y=this.bg1.height-12,this.addChild(this.bg2),this.setChildIndex(this.bg2,0),this._contentText=ComponentManager.getTextField(this.currData.content,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this._contentText.x=this.bg1.x+20,this._contentText.y=this.bg1.y+65,this._contentText.lineSpacing=6,this._contentText.width=this.bg2.width-30,this.addChild(this._contentText),this.bg2.height=this._contentText.textHeight+30},e.prototype.closeDes=function(){this.bg2=null,this._contentText=null},e.prototype.getSpaceY=function(){return 10},e.prototype.getSpaceX=function(){return 0},e.prototype.dispose=function(){this.bg1=null,this.bg2=null,this._titleText=null,this._contentText=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(AnnouncementScrollItem.prototype,"AnnouncementScrollItem");var GameAnnouncementView=function(t){function e(){var e=t.call(this)||this;return e._announcementList=[],e._notice=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["public_9_bg4","uncompress"])},e.prototype.initView=function(){this.showBg(),this.showList()},e.prototype.resetBgSize=function(){this.viewBg.height=590,this.viewBg.x=30,this.viewBg.y=210,this.closeBtn.y=this.viewBg.y-50,this.closeBtn.x=this.viewBg.x+this.viewBg.width-80,this.titleTF.y=this.viewBg.y+15},e.prototype.showBg=function(){var t=BaseBitmap.create("public_9_bg4");t.width=518,t.height=496,t.x=55,t.y=this.viewBg.y+220,this.addChildToContainer(t)},e.prototype.showList=function(){"login"==this.param.data.name?this.param.data&&this.param.data.notice?(this._notice=this.param.data.notice,this._announcementList=this._notice,e.NOTICE_LIST=this._announcementList):this._announcementList=e.NOTICE_LIST:this._announcementList=this.param.data;var t=egret.Rectangle.create();t.setTo(0,0,518,468),this._scrollList=ComponentManager.getScrollList(AnnouncementScrollItem,this._announcementList,t),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(60,240),this._scrollList.addTouchTap(this.clickItemHandler,this);var i=this._scrollList.getItemByIndex(0);i.itemListType=!0,i.touchNum+=1,this._scrollList.refreshData(this._announcementList)},e.prototype.clickItemHandler=function(t){e.currNum=t.data;var i=this._scrollList.getItemByIndex(t.data);i.touchNum+=1,i.touchNum%2==0?i.itemListType=!1:i.itemListType=!0,this._scrollList.refreshData(this._announcementList)},e.prototype.getSheepType=function(){return 1},e.prototype.dispose=function(){this._announcementList=[],t.prototype.dispose.call(this)},e.currNum=0,e.NOTICE_LIST=null,e}(PopupView);__reflect(GameAnnouncementView.prototype,"GameAnnouncementView");var GuideBackground=function(t){function e(){var e=t.call(this)||this;return e._bgs=null,e._stageWidth=0,e._stageHeight=0,e._bgalpha=.3,e}return __extends(e,t),e.prototype.init=function(t,e,i){this._bgs=new Array,this._handle=e,this._Function=t,this._bgalpha=i||.3,this.touchEnabled=!0,this._stageWidth=GameConfig.stageWidth,this._stageHeight=GameConfig.stageHeigth},e.prototype.draw=function(t,e){void 0===e&&(e=0),this.removeAllChild();for(var i in this._bgs)this._bgs[i]&&this._bgs[i].dispose();this._bgs.length=0;var a=e;t.fromBottom&&(t.y=GameConfig.stageHeigth-t.fromBottom);var n=Math.max(t.x,0),o=Math.max(t.y,0),s=Math.min(t.x+t.w,this._stageWidth),r=Math.min(t.y+t.h,this._stageHeight);this.addBg(a,0,0,this._stageWidth,o),this.addBg(a,0,o,n,t.h),this.addBg(a,s,o,this._stageWidth-s,t.h),this.addBg(a,0,r,this._stageWidth,this._stageHeight-r),this.width=this._stageWidth,this.height=this._stageHeight},e.prototype.drawScreen=function(t){void 0===t&&(t=0),this.removeAllChild();for(var e in this._bgs)this._bgs[e]&&this._bgs[e].dispose();this._bgs.length=0,this.addBg(t,0,0,this._stageWidth,this._stageHeight),this.width=this._stageWidth,this.height=this._stageHeight},e.prototype.addBg=function(t,e,i,a,n){var o;this._bgs.length?(o=this._bgs.pop(),o.graphics.clear()):(o=new BaseShape,o.addTouchTap(this.clickFunc,this,null)),o.graphics.beginFill(0),o.graphics.drawRect(e,i,a,n),o.graphics.endFill(),o.alpha=t,this.addChild(o)},e.prototype.clickFunc=function(){this._Function.apply(this._handle)},e.prototype.removeAllChild=function(){for(;this.numChildren;){var t=this.removeChildAt(0);t.touchEnabled=!1,this._bgs.push(t)}},e.prototype.dispose=function(){this.removeChildren();for(var e in this._bgs)this._bgs[e].dispose();this._bgs.length=0,this._Function=null,this._handle=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(GuideBackground.prototype,"GuideBackground");var GuideCreateUserView=function(t){function e(){var e=t.call(this)||this;return e._index=0,e._userNameCount=0,e._curSex=1,e._picNum=0,e._sextype=0,e}return __extends(e,t),e.prototype.getResourceList=function(){var e=["guide_createuserbg","user_body_full_3001","user_head1","guide_namebg","guide_uesrheadbg","user_head2","user_head3","user_head4","user_head5","shield_cn","user_head6","user_head7","user_head8","user_head9","user_head10","user_hair6","user_hair7","user_hair8","user_hair9","user_hair10","guide_manicon_1","guide_manicon_2","guide_womanicon_1","guide_womanicon_2","guide_bottom"];return t.prototype.getResourceList.call(this).concat(e)},e.prototype.getCloseBtnName=function(){return this.param?t.prototype.getCloseBtnName.call(this):null},e.prototype.getBgName=function(){return"guide_createuserbg"},e.prototype.initView=function(){PlatformManager.analyticsNewGuide(2);var t=1;if(this.param&&this.param.data.changeImg&&(t=Api.playerVoApi.getPlayePicId()),this._container=Api.playerVoApi.getPlayerPortrait(3001,t),this.addChild(this._container),this._myBody=this._container.getChildByName("myBody"),this._myHead=this._container.getChildByName("myHead"),this._myHair=this._container.getChildByName("myHair"),this._container.x=this.viewBg.x+this.viewBg.width/2-191+5,this._container.y=160,!this.param){var e=BaseBitmap.create("guide_namebg");e.x=this.viewBg.x+this.viewBg.width/2-e.width/2,e.y=GameConfig.stageHeigth-200,this.addChild(e);var i=ComponentManager.getInputTextField(TextFieldConst.COLOR_WARN_YELLOW,TextFieldConst.FONTSIZE_TITLE_SMALL,200,45,"public_9_bg5");i.x=this.viewBg.x+this.viewBg.width/2-i.width/2,i.y=e.y+e.height/2-i.height/2,this.addChild(i),this._inputTextField=i.getChildByName("textField"),this._inputTextField.maxChars=this.getNameLength(1);var a=ComponentManager.getButton("btn_random","",this.clickRanomHandler,this);a.x=420,a.y=e.y+e.height/2-a.height/2,a.setColor(TextFieldConst.COLOR_BLACK),this.addChild(a)}this._manIcon=BaseBitmap.create("guide_manicon_2"),this._manIcon.x=30,this._manIcon.y=200,this.addChild(this._manIcon),this._womanIcon=BaseBitmap.create("guide_womanicon_2"),this._womanIcon.x=541,this._womanIcon.y=200,this.addChild(this._womanIcon),PlatformManager.checkIsKRSp()&&(this._manIcon.visible=!1,this._womanIcon.visible=!1);var n="guideCreateUserViewTitle";this.param&&this.param.data.changeImg&&(n="sysConfirm");var o=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,n,this.clickCreateHandler,this);o.x=this.viewBg.x+this.viewBg.width/2-o.width/2,o.y=GameConfig.stageHeigth-100,o.setColor(TextFieldConst.COLOR_BLACK),this.addChild(o),this._posContainer=new BaseDisplayObjectContainer,this.addChild(this._posContainer),this._selectBg=BaseBitmap.create("itembg_selected"),this._selectBg.width=108,this._selectBg.height=106,this._selectBg.scaleX=.76,this._selectBg.scaleY=.76,this._selectBg.x=28,this._selectBg.y=270,this.addChild(this._selectBg),this.reFreshUserContainer(),this.param?Api.playerVoApi.getPlayePicId()>5&&this.womanIconClick():this.clickRanomHandler();var s=BaseBitmap.create("guide_bottom");s.setPosition(15,100),this.addChildToContainer(s),s.height=510;var r=BaseBitmap.create("guide_bottom");r.setPosition(525,100),this.addChildToContainer(r),r.height=510,2==this._curSex?this._sextype=2:this._sextype=1},e.prototype.manIconClick=function(){1!=this._curSex&&(this._curSex=1,this.reFreshUserContainer())},e.prototype.womanIconClick=function(){2!=this._curSex&&(this._curSex=2,this.reFreshUserContainer())},e.prototype.reFreshUserContainer=function(){this._headContainer&&(this._posContainer.removeChild(this._headContainer),this._headContainer=null),this.changeHead(),this._headContainer=new BaseDisplayObjectContainer,this._posContainer.addChild(this._headContainer);var t=0;1==this._curSex||2==this._curSex&&(t=0);for(var e=0;10>e;e++){var i=BaseBitmap.create("guide_uesrheadbg");if(i.x=28,e>=5){i.x=536;var a=e-5;i.y=270+(.67*i.height+18)*a,i.name="2"}else i.name="1",i.y=270+(.67*i.height+18)*e;var n="user_head"+(e+1+t),o=BaseBitmap.create(n);if(o.scaleX=.67,o.scaleY=.67,o.x=i.x+i.width/2-o.width/2*.67-12,o.y=i.y+i.height/2-o.height/2*.67-15,i.addTouchTap(this.changeHeadHandler,this,[e]),i.scaleX=.76,i.scaleY=.76,this._headContainer.addChild(i),this._headContainer.addChild(o),this.param&&this.param.data.changeImg){var s=Api.playerVoApi.getPlayePicId();this._picNum=s,s>5&&(s-=5),s==e+1&&(2==this._curSex?this._selectBg.x=536:this._selectBg.x=i.x,this._index=e,this._selectBg.y=i.y)}}},e.prototype.changeHeadHandler=function(t,e){if("2"==t.currentTarget.name?this._sextype=2:this._sextype=1,e!=this._index||6==this._picNum||4==e){this._selectBg.x=t.target.x,this._selectBg.y=t.target.y;var i=-1;e-this._index>0&&(i=1),this._index=e;var a=this.viewBg.x+this.viewBg.width/2-191+5,n=140;egret.Tween.get(this._container).to({x:-500*i+n},200).to({x:500*i+n},0).call(this.changeHead,this).to({x:a},200)}},e.prototype.changeHead=function(){var t=0,e="user_head"+(this._index+1+t),i="user_hair"+(this._index+1+t);this._myHead.texture=ResourceManager.getRes(e),this._myHair.texture=ResourceManager.getRes(i)},e.prototype.clickCreateHandler=function(){var t=this._index+1;if(1==t&&6==this._picNum&&2==this._sextype)return App.CommonUtil.showTip(LanguageManager.getlocal("changeImgTip2")),void this.hide();if(2==this._sextype&&this._index<5&&(t+=5),this.param&&this.param.data.changeImg)return void(t==Api.playerVoApi.getPlayePicId()?(App.CommonUtil.showTip(LanguageManager.getlocal("changeImgTip2")),this.hide()):this.request(NetRequestConst.REQUEST_USER_CHANGEPIC,{pic:t}));var e=this._inputTextField.text;return App.StringUtil.userNameCheck(e)?e.length<2||e.length>this.getNameLength()?void App.CommonUtil.showTip(LanguageManager.getlocal("guideChangeNameTip2")):void(0!=Config.ShieldCfg.checkShield(e)&&this.request(NetRequestConst.REQUEST_USER_CREATEUSER,{name:this._inputTextField.text,pic:t})):void App.CommonUtil.showTip(LanguageManager.getlocal("guideChangeNameTip1"))},e.prototype.getNameLength=function(t){return void 0===t&&(t=0),PlatformManager.checkIsEnSp()?GameData.nameLength:1==t?8:6},e.prototype.clickRanomHandler=function(){this._userNameCount=0,this.randomName()},e.prototype.randomName=function(){var t=LanguageManager.getlocal("userName_firstName"+App.MathUtil.getRandom(1,604)),e=LanguageManager.getlocal("userName_secondName"+App.MathUtil.getRandom(1,3763));this._userName=t+e,this._userNameCount++,this._userNameCount>=5?this._inputTextField.text=this._userName:this.request(NetRequestConst.REQUEST_USER_CHECKNAME,{name:this._userName})},e.prototype.receiveData=function(t){if(t.data.cmd==NetRequestConst.REQUEST_USER_CHECKNAME)0==t.data.data.nameflag?this._inputTextField.text=this._userName:this.randomName();else if(t.data.cmd==NetRequestConst.REQUEST_USER_CREATEUSER){if(0!=t.data.data.nameflag)return void App.CommonUtil.showTip(LanguageManager.getlocal("guideCreateUserError"+t.data.data.nameflag));null!=GameData.wbrewards?ViewController.getInstance().openView(ViewConst.POPUP.GETGIFTPOPUPVIEW,{rewards:GameData.wbrewards,f:this.startRookieGuide,o:this}):"501"==PlatformManager.getGiftId()||"502"==PlatformManager.getGiftId()?GameData.wbrewardsFlag?PlatformManager.giftExchange(this.exchangeCallback,this):ViewController.getInstance().openView(ViewConst.POPUP.BUYGIFTPOPUPVIEW,{rewards:GameData.wbrewards,code:"2003"}):this.startRookieGuide()}else t.data.cmd==NetRequestConst.REQUEST_USER_CHANGEPIC&&(App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_CHANGE_IMG),App.CommonUtil.showTip(LanguageManager.getlocal("changeImgTip1")),this.hide());t.data.cmd==NetRequestConst.REQUEST_OTHERINFO_GETWBSCOREREWARD&&t.data.data&&t.data.data.rewards&&ViewController.getInstance().openView(ViewConst.POPUP.BUYGIFTPOPUPVIEW,{rewards:t.data.data.rewards,f:this.startRookieGuide,o:this,code:"0"})},e.prototype.exchangeCallback=function(t,e){"0"==String(t)?this.request(NetRequestConst.REQUEST_OTHERINFO_GETWBSCOREREWARD,{giftId:PlatformManager.getGiftId()}):ViewController.getInstance().openView(ViewConst.POPUP.BUYGIFTPOPUPVIEW,{rewards:GameData.wbrewards,code:String(e.ret)})},e.prototype.startRookieGuide=function(){PlatformManager.analyticsNewGuide(3),this.hide(),Api.rookieVoApi.isInGuiding=!0,ViewController.getInstance().openView(ViewConst.BASE.ROOKIEVIEW,{idx:"1",f:this.completeGuideLoginGame,o:this})},e.prototype.completeGuideLoginGame=function(){LoginManager.completeGuideForLogin()},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.dispose=function(){this._inputTextField=null,this._container=null,this._myBody=null,this._myHead=null,this._selectBg=null,this._index=0,this._headContainer=null,this._manIcon=null,this._womanIcon=null,this._curSex=1,this._picNum=0,t.prototype.dispose.call(this)},e}(CommonView);__reflect(GuideCreateUserView.prototype,"GuideCreateUserView");var RookieView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e._curIdx="",e._curConfig=null,e._curBgId=0,e._isCodon=!1,e._codonLength=0,e._iconList=[],e._isPlayMySound=!1,e._fogBg=null,e._shakeOffset=0,e}return __extends(e,t),e.prototype.getResourceList=function(){this._curIdx=this.param.data.idx,this._callbackF=this.param.data.f,this._obj=this.param.data.o;var t=[];this._curConfig=RookieCfg.getRookieCfg(this._curIdx);var e=(Number(this._curIdx),{}),i=this._curIdx;do{var a=RookieCfg.getRookieCfg(i);a.personPic&&1!=a.personPic&&999!=a.personPic,a.bgId&&("5"!=a.bgId&&"6"!=a.bgId?e["story_bg"+a.bgId]||(e["story_bg"+a.bgId]=1):"6"==a.bgId?e.homescene||(e.homescene=1):e.cityscene||(e.cityscene=1)),i=a.nextId}while(i);return t=Object.keys(e),t.concat(["skip_btn1","skip_btn2","guide_circle","guide_hand","guide_rect","guideGrayBg","guideNameBg","story_fog"])},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getCloseBtnName=function(){return null},e.prototype.getBgName=function(){return null},e.prototype.isShowMask=function(){return!1},e.prototype.preInit=function(){this._iconList.length>0?ResourceManager.loadItem(this._iconList.shift(),this.preInit,this):t.prototype.preInit.call(this)},e.prototype.init=function(){t.prototype.init.call(this),Api.rookieVoApi.isGuiding=!0,App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_ROOKIE_NEXT_STEP,this.noticeNextStep,this),this._blackBg=BaseBitmap.create("public_9_black"),this._blackBg.height=GameConfig.stageHeigth,this._blackBg.width=GameConfig.stageWidth,this.addChild(this._blackBg),this._blackBg.visible=!1,this.container=new BaseDisplayObjectContainer,this.addChild(this.container),this.width=GameConfig.stageWidth,this.height=GameConfig.stageHeigth,this._myBg=BaseBitmap.create(),this._myBg.width=GameConfig.stageWidth,this.addChildToContainer(this._myBg),this._guideBg=new GuideBackground,this._guideBg.init(this.clickPage,this),this.addChildToContainer(this._guideBg),this._guideTipContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._guideTipContainer),this._tipBB=BaseBitmap.create("public_9_wordbg"),this._tipBB.height=170,this._tipBB.setPosition(GameConfig.stageWidth/2-this._tipBB.width/2,GameConfig.stageHeigth-this._tipBB.height-0),this._guideTipContainer.addChild(this._tipBB),this._skipBtnBg=BaseBitmap.create("public_9_wordbg"),this._skipBtnBg.skewX=180,this._skipBtnBg.height=66,this._skipBtnBg.setPosition(GameConfig.stageWidth/2-this._skipBtnBg.width/2,66),this.addChildToContainer(this._skipBtnBg),this._grayBB=BaseBitmap.create("guideGrayBg"),this._grayBB.setPosition(0,66),this._grayBB.height=GameConfig.stageHeigth-this._grayBB.y,this._grayBB.width=GameConfig.stageWidth,this.addChildToContainer(this._grayBB),this._continueText=ComponentManager.getTextField(LanguageManager.getlocal("clickContinue"),20),this._continueText.setPosition(this._tipBB.x+this._tipBB.width-this._continueText.width-50,this._tipBB.y+this._tipBB.height-this._continueText.height-20),this._continueText.textColor=TextFieldConst.COLOR_WARN_GREEN,this._guideTipContainer.addChild(this._continueText),this.textAnim(this._continueText),this._titleBg=BaseBitmap.create("guideNameBg"),this._titleBg.setPosition(25,this._tipBB.y-50),this._guideTipContainer.addChild(this._titleBg),this._titleBg.visible=!1,this._titleText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON),this._titleText.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,this._titleText.setPosition(30,this._tipBB.y-42),this._guideTipContainer.addChild(this._titleText),this._descText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL),this._descText.width=GameConfig.stageWidth-60,this._descText.lineSpacing=8,this._descText.setPosition(30,this._tipBB.y+38),this._guideTipContainer.addChild(this._descText),this._clickRect=BaseBitmap.create("guide_rect"),this.addChildToContainer(this._clickRect),this._circleContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._circleContainer),this._circle1=BaseBitmap.create("guide_circle"),this._circle1.anchorOffsetX=this._circle1.width/2,this._circle1.anchorOffsetY=this._circle1.height/2,this._circle1.alpha=.5,this._circle1.scaleX=1.5,this._circle1.scaleY=1.5,egret.Tween.get(this._circle1,{loop:!0}).to({scaleX:2,scaleY:2,alpha:0},1e3),this._circle2=BaseBitmap.create("guide_circle"),this._circle2.anchorOffsetX=this._circle2.width/2,this._circle2.anchorOffsetY=this._circle2.height/2,this._circle2.alpha=1,this._circle2.scaleX=.5,this._circle2.scaleY=.5,egret.Tween.get(this._circle2,{loop:!0}).to({scaleX:2,scaleY:2,alpha:0},1e3),this._circleContainer.addChild(this._circle1),this._circleContainer.addChild(this._circle2),this.addChildToContainer(this._circleContainer),this._cliclTextBg=BaseBitmap.create("public_9_bg42"),this.addChildToContainer(this._cliclTextBg),this._clickHand=BaseBitmap.create("guide_hand"),this.addChildToContainer(this._clickHand),egret.Tween.get(this._clickHand,{loop:!0}).to({scaleX:.9,scaleY:.9},500).to({scaleX:1,scaleY:1},500),this._cliclText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL),this._cliclText.textColor=TextFieldConst.COLOR_BLACK,this.addChildToContainer(this._cliclText);var e;e=Number(this._curIdx)<=Number(RookieCfg.getRookieCfg("storyEndId"))?"skip_btn1":"skip_btn2",this._skipBtn=ComponentManager.getButton(e,null,this.skipAnim,this),this._skipBtn.setPosition(GameConfig.stageWidth-this._skipBtn.width-10,10),this.addChildToContainer(this._skipBtn),this._skipBtn2=ComponentManager.getButton("skip_btn2",null,this.skipAnim,this),this._skipBtn2.setPosition(GameConfig.stageWidth-this._skipBtn.width-10,10),this._skipBtn2.visible=!1,Number(this._curIdx)<=Number(RookieCfg.getRookieCfg("storyEndId"))?(this._skipBtn.visible=!0,this._skipBtnBg.visible=!0,this._grayBB.visible=!0):(this._skipBtn.visible=!1,this._skipBtnBg.visible=!1,this._grayBB.visible=!1),this._curConfig=RookieCfg.getRookieCfg(this._curIdx),this.showPage()},e.prototype.clickPage=function(){(!this._curConfig||!this._curConfig.clickRect&&!this._curConfig.branch||this._curConfig.touchAll)&&(1==this._isCodon?(this._isCodon=!1,this._descText.text=this._descContent):this.doNextStep())},e.prototype.doNextStep=function(t){var e=null;t?e=t:this._curConfig&&this._curConfig.nextId&&(e=this._curConfig.nextId),this._curConfig&&null==e&&null==this._curConfig.waitNext&&(Api.rookieVoApi.isInGuiding=!1),this._curConfig&&null==e?(this._curConfig.waitNext&&Api.rookieVoApi.insertWaitingGuide({idx:this._curConfig.waitNext}),this.hide()):(this._curIdx=e,this._curConfig=RookieCfg.getRookieCfg(this._curIdx),this.showPage()),Number(this._curIdx)==Number(RookieCfg.getRookieCfg("storyStartId2"))?this._skipBtn&&!this._skipBtn.visible&&(this._skipBtn.visible=!0,this._skipBtnBg.visible=!0,this._grayBB.visible=!0):Number(this._curIdx)<=Number(RookieCfg.getRookieCfg("storyEndId"))||this._skipBtn&&this._skipBtn.visible&&(this._skipBtn.visible=!1,this._skipBtnBg.visible=!1,this._grayBB.visible=!1)},e.prototype.showPage=function(){this._curConfig.needPush&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT),this._curConfig.guideId?(Api.rookieVoApi.guideId=this._curConfig.guideId,PlatformManager.analyticsNewGuide(this._curConfig.guideId),this._curConfig.guideId==RookieCfg.getRookieCfg("guideSteps")&&this.request(NetRequestConst.REQUEST_USER_NEWERGUILD,{step:9999})):this.request(NetRequestConst.REQUEST_USER_STEPGUILD,{step:this._curConfig.otherId}),Api.rookieVoApi.curStep=this._curIdx,App.LogUtil.log("QAZ showPage step ",this._curIdx),this._curConfig.checkNpc&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_CHECKNPC_SHOW,{key:this._curConfig.checkNpc}),this.doStepHandle(),this._showManTab&&(this._guideTipContainer.removeChild(this._showManTab),this._showManTab=null);var t=!1;if(this._curConfig.descId){if(this._curConfig.clickContinue?(this._continueText.visible=!0,this._isCodon=!0,this._codonLength=0,this._descText.text="",this._descContent=LanguageManager.getlocal("rookieStoryDesc"+this._curConfig.descId),t=!0):(this._descText.text=LanguageManager.getlocal("rookieStoryDesc"+this._curConfig.descId),this._continueText.visible=!1),1==this._curConfig.personPic||999==this._curConfig.personPic){var e=void 0;e=999==this._curConfig.personPic?999:Api.playerVoApi.getPlayerLevel();var i=Api.playerVoApi.getPlayerPortrait(e,Api.playerVoApi.getPlayePicId());i.setPosition(170,GameConfig.stageHeigth-i.height-10+110);var a=new egret.Rectangle;a.setTo(0,0,i.width,430),this._guideTipContainer.addChildAt(i,0),this._showManTab=i}else if(this._curConfig.personPic){var n=new BaseDisplayObjectContainer;this._guideTipContainer.addChild(n);var o=egret.Rectangle.create();o.setTo(0,0,405,467),"wife"==this._curConfig.personPic.substring(0,4)&&o.setTo(0,0,332,467);var s=BaseLoadBitmap.create(this._curConfig.personPic,o);s.setPosition(GameConfig.stageWidth-s.width*s.scaleX-120,GameConfig.stageHeigth-s.height*s.scaleY-272+50+80),n.addChild(s),this._guideTipContainer.addChildAt(n,0),this._showManTab=n}this._curConfig.nameId?(this._titleText.text=LanguageManager.getlocal(this._curConfig.nameId),this._titleText.x=this._titleBg.x+this._titleBg.width/2-this._titleText.width/2,this._titleBg.visible=!0):(this._titleText.text="",this._titleBg.visible=!1),this._guideTipContainer.visible=!0}else this._guideTipContainer.visible=!1;var r=0;if(this._curConfig.bgId){if(this.container.alpha=1,this._curConfig.bgId!=this._curBgId){var l=350;
egret.Tween.removeTweens(this.container),this._descText.visible=!1,this._titleText.visible=!1,this._titleBg.visible=!1,0==this._curBgId?(this.container.alpha=1,this._curBgId=this._curConfig.bgId,this.changeBgCallBack(),r=0):(this._showManTab&&(this._showManTab.alpha=0),this._curBgId=this._curConfig.bgId,egret.Tween.get(this.container).to({alpha:0},l).call(this.changeBgCallBack,this).to({alpha:1},l),r=2*l)}}else this._myBg.texture=null,this._curBgId=0;if(t&&egret.Tween.get(this).wait(r).call(this.textShootAnim,this),this._curConfig.clickRect){this._blackBg.visible=!1;var h={x:this._curConfig.clickRect.x,y:this._curConfig.clickRect.y,w:this._curConfig.clickRect.w,h:this._curConfig.clickRect.h},d=void 0;if(this._curConfig.handPos&&(d=egret.Point.create(this._curConfig.handPos.x,this._curConfig.handPos.y)),this._curConfig.clickRect.fromBottom&&(h.y=GameConfig.stageHeigth-this._curConfig.clickRect.fromBottom,this._curConfig.handPos&&this._curConfig.handPos.fromBottom&&(d.y=GameConfig.stageHeigth-this._curConfig.handPos.fromBottom)),this._curConfig.clickRect.fromCenter&&(h.y+=(GameConfig.stageHeigth-960)*this._curConfig.clickRect.fromCenter,this._curConfig.handPos&&this._curConfig.handPos.fromCenter&&(d.y+=(GameConfig.stageHeigth-960)*this._curConfig.handPos.fromCenter)),this._curConfig.needLocalPos&&Api.rookieVoApi.waitingPosY&&(h.y=Api.rookieVoApi.waitingPosY,Api.rookieVoApi.waitingPosY=null),this._curConfig.isScenePos){var g=Config.SceneCfg.getSceneCfgBySceneName(this._curConfig.isScenePos);h.x=g.posCfg[this._curConfig.sceneKey].x-10,h.y=g.posCfg[this._curConfig.sceneKey].y-(1136-GameConfig.stageHeigth)-10,g.posCfg[this._curConfig.sceneKey].w&&(h.w=g.posCfg[this._curConfig.sceneKey].w,h.h=g.posCfg[this._curConfig.sceneKey].h)}if(this._guideBg.draw(h,.7),this._clickRect.visible=!0,this._clickRect.width=h.w+10,this._clickRect.height=h.h+10,this._clickRect.x=h.x-5,this._clickRect.y=h.y-5,this._circleContainer.visible=!1,this._curConfig.handPos){if(this._clickHand.visible=!0,this._clickHand.x=d.x,this._clickHand.y=d.y,this._curConfig.isScenePos){var g=Config.SceneCfg.getSceneCfgBySceneName(this._curConfig.isScenePos);h.x=g.posCfg[this._curConfig.sceneKey].x-10,h.y=g.posCfg[this._curConfig.sceneKey].y-(1136-GameConfig.stageHeigth)-10,g.posCfg[this._curConfig.sceneKey].w&&(this._clickHand.x=h.x+h.w/2-10,this._clickHand.y=h.y+h.h/2-10,d.x=this._clickHand.x,d.y=this._clickHand.y)}this._circleContainer.visible=!0,this._circleContainer.x=d.x+15,this._circleContainer.y=d.y+20,this._curConfig.handPos.flip?(this._clickHand.skewY=180,this._circleContainer.x=d.x-10,this._circleContainer.y=d.y+10):this._curConfig.handPos.flipXY?(this._clickHand.skewX=180,this._clickHand.skewY=180,this._circleContainer.x=d.x-10,this._circleContainer.y=d.y-5):(this._clickHand.skewX=0,this._clickHand.skewY=0)}else this._clickHand.visible=!1;this._curConfig.tipId?(this._cliclText.visible=!0,this._cliclText.text=LanguageManager.getlocal("rookieTip"+this._curConfig.tipId),this._cliclText.width=450,this._cliclText.lineSpacing=5,this._cliclText.x=this.width/2-this._cliclText.width/2,this._cliclText.y=this._curConfig.tipPos.y,this._cliclTextBg.visible=!0,this._cliclTextBg.width=this._cliclText.width+40,this._cliclTextBg.height=this._cliclText.height+25,this._cliclTextBg.x=this._cliclText.x-20,this._cliclTextBg.y=this._cliclText.y-13,this._curConfig.tipPos.fromBottom&&(this._cliclText.y=GameConfig.stageHeigth-this._curConfig.tipPos.fromBottom,this._cliclTextBg.y=this._cliclText.y-13)):this._cliclTextBg.visible=!1}else this._blackBg.visible=!0,this._guideBg.drawScreen(),this._clickRect.visible=!1,this._clickHand.visible=!1,this._cliclText.visible=!1,this._cliclTextBg.visible=!1,this._circleContainer.visible=!1;if(this._curConfig.isCallback){var c=this._obj,p=this._callbackF;c&&p&&p.apply(c),this._obj=null,this._callbackF=null}if(this._branchContainer&&(this.removeChild(this._branchContainer),this._branchContainer=null),this._curConfig.branch){this._branchContainer=new BaseDisplayObjectContainer,this.addChild(this._branchContainer);for(var _=Object.keys(this._curConfig.branch),u=110*_.length,C=0;C<_.length;C++){var f=(LanguageManager.getlocal("rookieStoryBranch"+_[C]),BaseBitmap.create("loginres_9_serverbg"));f.width=440,f.setPosition(GameConfig.stageWidth/2-f.width/2,GameConfig.stageHeigth/2-u/2+110*C+f.height/2),this._branchContainer.addChild(f),f.addTouch(this.clickSelectedHandler,this,[f,this._curConfig.branch[_[C]]]);var m=ComponentManager.getTextField(LanguageManager.getlocal("rookieStoryBranch"+_[C]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);m.setPosition(f.x+f.width/2-m.width/2+15,f.y+f.height/2-m.height/2),this._branchContainer.addChild(m)}}this._curConfig.touchAll?this._clickRect.addTouchTap(this.clickPage,this):(this._clickRect.removeTouchTap(),this._clickRect.touchEnabled=!1)},e.prototype.clickSelectedHandler=function(t,e,i){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:e.texture=ResourceManager.getRes("loginres_9_serverbg_down");break;case egret.TouchEvent.TOUCH_CANCEL:e.texture=ResourceManager.getRes("loginres_9_serverbg");break;case egret.TouchEvent.TOUCH_END:e.texture=ResourceManager.getRes("loginres_9_serverbg"),this.doNextStep(i)}},e.prototype.changeBgCallBack=function(){this._descText.visible=!0,this._titleText.visible=!0,""==this._titleText.text?this._titleBg.visible=!1:this._titleBg.visible=!0,this._fogBg&&(this.removeChildFromContainer(this._fogBg),this._fogBg=null),this._showManTab&&(this._showManTab.alpha=1);var t="story_bg"+this._curBgId;5==this._curBgId?t="cityscene":6==this._curBgId&&(t="homescene"),egret.Tween.removeTweens(this._myBg),this._myBg.texture=ResourceManager.getRes(t),this._myBg.y=GameConfig.stageHeigth-this._myBg.height,this._myBg.x=0,this._myBg.anchorOffsetX=0,this._myBg.setScale(1),this._curIdx==RookieCfg.getRookieCfg("fogId")?this.showFogAnim():this._curIdx==RookieCfg.getRookieCfg("shakeId")&&this.showShakeAnim()},e.prototype.showShakeAnim=function(){this._myBg.setScale((this._myBg.width+40)/this._myBg.width),this._myBg.x=-20,this._myBg.y=GameConfig.stageHeigth-this._myBg.height-30,this._shakeOffset=16,this.shakeScreen()},e.prototype.shakeScreen=function(){if(this._shakeOffset>0){var t=-this._shakeOffset/2-App.MathUtil.getRandom(0,this._shakeOffset),e=GameConfig.stageHeigth-this._myBg.height-this._shakeOffset/2-App.MathUtil.getRandom(0,this._shakeOffset);e*=1.5,this._myBg.setPosition(t,e),egret.Tween.get(this._myBg).wait(50).call(this.shakeScreen,this),this._shakeOffset-=1}},e.prototype.showFogAnim=function(){this._myBg.y=0,this._myBg.x=-this._myBg.width/4,this._myBg.anchorOffsetX=.5,this._myBg.setScale(1.5),this._fogBg=BaseBitmap.create("story_fog"),this.addChildToContainer(this._fogBg),this._skipBtn&&this.addChildToContainer(this._skipBtn),egret.Tween.get(this._myBg).to({scaleX:1,scaleY:1,x:0},7e3)},e.prototype.textShootAnim=function(){0!=this._isCodon&&(this._codonLength+=1,this._codonLength>this._descContent.length?(this._isCodon=!1,this._descText.text=this._descContent):(this._descText.text=this._descContent.substr(0,this._codonLength),egret.Tween.get(this._descText).wait(100).call(this.textShootAnim,this)))},e.prototype.textAnim=function(t){egret.Tween.removeTweens(t);var e=t.x,i=t.y,a=t.x-.1*t.width,n=t.y-.1*t.height;egret.Tween.get(t).to({scaleX:1.2,scaleY:1.2,x:a,y:n},600).to({scaleX:1,scaleY:1,x:e,y:i},600).to({scaleX:1.2,scaleY:1.2,x:a,y:n},600).to({scaleX:1,scaleY:1,x:e,y:i},600).call(this.textAnim,this,[t])},e.prototype.skipAnim=function(){if(Number(this._curIdx)<=Number(RookieCfg.getRookieCfg("storyEndId2"))){var t=this._obj,e=this._callbackF;t&&e&&e.apply(t),this._curConfig=RookieCfg.getRookieCfg(RookieCfg.getRookieCfg("storyEndId2")),this.doNextStep()}else if(Number(this._curIdx)<=Number(RookieCfg.getRookieCfg("storyEndId"))){var t=this._obj,e=this._callbackF;t&&e&&e.apply(t),this._curConfig=RookieCfg.getRookieCfg(RookieCfg.getRookieCfg("storyEndId")),this.doNextStep()}else Api.rookieVoApi.isInGuiding=!1,this.hide();this._fogBg&&(this.removeChildFromContainer(this._fogBg),this._fogBg=null)},e.prototype.noticeNextStep=function(){this.doNextStep()},e.prototype.initView=function(){},e.prototype.getParent=function(){return LayerManager.maskLayer},e.prototype.hide=function(e){var i=this._obj,a=this._callbackF;Api.rookieVoApi.isGuiding=!1,e||i&&a&&a.apply(i),t.prototype.hide.call(this)},e.prototype.doStepHandle=function(){"1"==this._curIdx?SoundManager.playBg(SoundConst.MUSIC_PALACE):this._curIdx==RookieCfg.getRookieCfg("storyMusicStart")?SoundManager.playBg(SoundConst.MUSIC_ROOKIE_STORY):this._curIdx==RookieCfg.getRookieCfg("storyMusicEnd")&&SoundManager.playBg(SoundConst.MUSIC_HOME)},e.prototype.dispose=function(){this._curConfig.showCloseHand&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_GUIDE_SHOWHAND),Api.rookieVoApi.curGuideKey=null,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_ROOKIE_NEXT_STEP,this.noticeNextStep,this),egret.Tween.removeTweens(this._continueText),this._continueText=null,this._callbackF=null,this._obj=null,this._curIdx="",this._showManTab=null,this._curBgId=0,this._tipBB=null,this._descContent=null,this._isCodon=!1,this._codonLength=0,this._descText&&egret.Tween.removeTweens(this._descText),this._descText=null,this._skipBtn=null,this._myBg=null,this._circleContainer=null,this._circle1&&egret.Tween.removeTweens(this._circle1),this._circle1=null,this._circle2&&egret.Tween.removeTweens(this._circle2),this._circle2=null,this._blackBg=null,this._iconList.length=0,this._cliclTextBg=null,this._isPlayMySound=!1,this._skipBtn2=null,this._branchContainer=null,egret.Tween.removeTweens(this.container),egret.Tween.removeTweens(this),this._clickHand&&egret.Tween.removeTweens(this._clickHand),this.visible=!0,this._skipBtnBg=null,this._titleBg=null,this._grayBB=null,this._fogBg=null,this._shakeOffset=0,t.prototype.dispose.call(this)},e}(CommonView);__reflect(RookieView.prototype,"RookieView");var InviteView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){console.log("InviteView.initView"),Api.inviteVoApi.processDataOnOpenDialog();var t=BaseBitmap.create("invite_bg");t.x=0,t.y=-10,this.addChildToContainer(t);var e=BaseBitmap.create("servant_bottombg");e.x=0,e.y=t.y+t.height,e.height=GameConfig.stageHeigth-e.y-this.container.y,this.addChildToContainer(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("inviteDesc"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);i.x=6,i.y=t.y+t.height-28,this.addChildToContainer(i);var a=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"inviteButton",this.inviteButtonHandler,this);a.x=477,a.y=155,a.name="goInviteBtn",this.addChildToContainer(a),console.log("InviteView.initView over")},e.prototype.inviteButtonHandler=function(){console.log("inviteButtonHandler"),PlatformManager.checkIsWanbaSp()||PlatformManager.checkIs4399Sp()?RSDKHelper.share(function(t,e){}):this.showHand()},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["servant_bottombg","invite_bg","nobodyIcon","signin_had_get","rank_1","rank_2","rank_3","rank_line","guide_hand","public_9_viewmask"])},e.prototype.getContainerY=function(){return 260},e.prototype.getTitleButtomY=function(){var t;return this.titleBg?t=this.titleBg.y+this.titleBg.height:this.titleTF&&(t=this.titleTF.y+this.titleTF.height),t},e.prototype.getTabbarGroupY=function(){return 225},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_INVITE_GETINFO,requestData:{}}},e.prototype.getTabbarTextArr=function(){return["inviteViewTab1Title","inviteViewTab2Title","inviteViewTab3Title","inviteViewTab4Title"]},e.prototype.showHand=function(){if(!this._handContainer){this._handContainer=new BaseDisplayObjectContainer,this.addChild(this._handContainer);var t=BaseBitmap.create("public_9_viewmask");t.width=GameConfig.stageWidth,t.height=GameConfig.stageHeigth,t.touchEnabled=!0,this._handContainer.addChild(t),t.addTouchTap(this.hideMask,this);var e=BaseBitmap.create("guide_hand");e.skewY=180,e.x=590,e.y=10,this._handContainer.addChild(e),egret.Tween.get(e,{loop:!0}).to({y:60},500).to({y:10},500);var i=ComponentManager.getTextField(LanguageManager.getlocal("fkylcGetMsgTip"),TextFieldConst.FONTSIZE_TITLE_COMMON);i.textAlign=TextFieldConst.ALIGH_CENTER,i.x=GameConfig.stageWidth/2-i.width/2,i.y=GameConfig.stageHeigth/2-i.height/2,i.lineSpacing=10,this._handContainer.addChild(i)}},e.prototype.hideMask=function(){this._handContainer&&(this.removeChild(this._handContainer),this._handContainer.dispose(),this._handContainer=null)},e.prototype.dispose=function(){this._handContainer&&(this._handContainer.dispose(),this._handContainer=null),t.prototype.dispose.call(this)},e}(CommonView);__reflect(InviteView.prototype,"InviteView");var InviteViewTab1=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){console.log("InviteViewTab1.initView"),this.friendNumList=Api.inviteVoApi.getFriendNumList();var t=egret.Rectangle.create();t.setTo(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-350-80),this._scrollList=ComponentManager.getScrollList(InviteViewTab1ScrollItem,this.friendNumList,t),this.addChild(this._scrollList),this._scrollList.y=80,console.log("InviteViewTab1.initView over")},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(InviteViewTab1.prototype,"InviteViewTab1");var InviteViewTab1ScrollItem=function(t){function e(){var e=t.call(this)||this;return e.getBtn=null,e._selectedIndex=0,e.senderIsMe=!1,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_INVITE_GETINVITEREWARD,this.doGetRewardCallback,this),this.data=e,this._selectedIndex=t;var i=GameConfig.stageWidth,a=BaseBitmap.create("public_9_bg21");a.width=i-50,a.height=100,a.x=i/2-a.width/2,a.y=36,this.addChild(a);var n=Config.InvitefriendCfg.friendNum[e.cfgId].needNum,o=ComponentManager.getTextField(LanguageManager.getlocal("inviteFriendCount",[String(n)]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);o.x=i/2-o.width/2,o.y=a.y-22-o.height/2,this.addChild(o);var s=BaseBitmap.create("public_line3");s.width=s.width+o.width+20,s.x=i/2-s.width/2,s.y=o.y,this.addChild(s);var r;if(e.userPid){var l=Api.inviteVoApi.getUserHeadByPid(e.userPid);if("http"===l.substr(0,4)){r=new BaseDisplayObjectContainer,r.width=80,r.height=80;var h=BaseLoadBitmap.create(l);h.width=80,h.height=80,r.addChild(h);var d=new egret.Shape;d.graphics.beginFill(255),d.graphics.drawCircle(40,40,40),d.graphics.endFill(),r.addChild(d),h.mask=d,r.cacheAsBitmap=!0}else{r=new BaseDisplayObjectContainer;var g="public_chatheadbg",c=BaseBitmap.create(g);r.addChild(c);var p=egret.Rectangle.create();p.setTo(0,0,136,143);var _=BaseLoadBitmap.create(Api.playerVoApi.getUserHeadImgPathById(l),p);_.x=0,_.y=-7,_.setScale(2/3),r.addChild(_)}}else r=BaseBitmap.create("nobodyIcon");r.x=i/2-a.width/2+10,r.y=a.y+a.height/2-r.height/2,this.addChild(r);var u;u=e.userPid?String(Api.inviteVoApi.getUserNicknameByPid(e.userPid)):LanguageManager.getlocal("inviteNoName");var C=ComponentManager.getTextField(u,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);C.x=r.x+r.width+10,C.y=a.y+7,this.addChild(C);for(var f=.6,m=GameData.formatRewardItem(Config.InvitefriendCfg.friendNum[e.cfgId].content),T=0;T<m.length;T++){var y=GameData.getItemIcon(m[T],!0,!0);y.x=r.x+r.width+10+7*(T+1)+y.width*f*T,y.y=a.y+33,y.scaleX=y.scaleY=f,this.addChild(y)}var v=ComponentManager.getTextField(LanguageManager.getlocal("inviteProgress",[String(Math.min(n,Api.inviteVoApi.getInvitedNum())),String(n)]),TextFieldConst.FONTSIZE_CONTENT_SMALL,Api.inviteVoApi.getInvitedNum()<n?TextFieldConst.COLOR_BROWN:TextFieldConst.COLOR_QUALITY_GREEN);v.x=a.x+a.width-70-v.width/2,v.y=a.y+10,this.addChild(v);var A;Api.inviteVoApi.getInviteNumGettedReward(e.cfgId)?A=BaseBitmap.create("signin_had_get"):(A=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskCollect",this.getRewardButtonHandler,this),this.getBtn=A,A.name="getRewardBtn",e.userPid||App.DisplayUtil.changeToGray(A)),A.x=v.x+v.width/2-A.width/2,A.y=a.y+a.height-A.height-10,this.addChild(A)},e.prototype.getRewardButtonHandler=function(t){console.log("getRewardButtonHandler"),!Api.inviteVoApi.getInviteNumGettedReward(this.data.cfgId)&&this.data.userPid&&(NetManager.request(NetRequestConst.REQUEST_INVITE_GETINVITEREWARD,{ikey:this.data.cfgId}),this.senderIsMe=!0)},e.prototype.doGetRewardCallback=function(t){console.log("doGetRewardCallback");var e=t.data,i=e.ret;e.data;if(i&&this.senderIsMe&&(this.senderIsMe=!1,App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.data.rewards)),this.getBtn)){var a=this.getBtn.x+this.getBtn.width/2,n=this.getBtn.y+this.getBtn.height/2;this.getBtn.dispose();var o=void 0;o=BaseBitmap.create("signin_had_get"),o.x=a-o.width/2,o.y=n-o.height/2,this.addChild(o)}},e.prototype.dispose=function(){this._rewardList=null,this.getBtn=null,App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_INVITE_GETINVITEREWARD,this.doGetRewardCallback,this),t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(InviteViewTab1ScrollItem.prototype,"InviteViewTab1ScrollItem");var InviteViewTab2=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.friendPowerList=Api.inviteVoApi.getFriendPowerList();var t=egret.Rectangle.create();t.setTo(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-350-80),this._scrollList=ComponentManager.getScrollList(InviteViewTab2ScrollItem,this.friendPowerList,t),this.addChild(this._scrollList),this._scrollList.y=80},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(InviteViewTab2.prototype,"InviteViewTab2");var InviteViewTab2ScrollItem=function(t){function e(){var e=t.call(this)||this;return e.getBtn=null,e._selectedIndex=0,e.senderIsMe=!1,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_INVITE_GETPOWERREWARD,this.doGetRewardCallback,this),this.data=e;var i=Config.InvitefriendCfg.friendPower[e.cfgId];this._selectedIndex=t;var a=GameConfig.stageWidth,n=BaseBitmap.create("public_9_bg21");n.width=a-50,n.height=100,n.x=a/2-n.width/2,n.y=36,this.addChild(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("inviteFriendPower",[String(i.needPower)]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);o.x=a/2-o.width/2,o.y=n.y-22-o.height/2,this.addChild(o);var s=BaseBitmap.create("public_line3");s.width=s.width+o.width+20,s.x=a/2-s.width/2,s.y=o.y,this.addChild(s);for(var r=.6,l=GameData.formatRewardItem(i.content),h=0;h<l.length;h++){var d=GameData.getItemIcon(l[h],!0,!0);d.x=n.x+10+7*(h+1)+d.width*r*h,d.y=n.y+20,d.scaleX=d.scaleY=r,this.addChild(d)}var g=ComponentManager.getTextField(LanguageManager.getlocal("invitePowerProgress",[String(Math.min(i.limit,i.limit-Api.inviteVoApi.getInvitePowerGettedReward(e.cfgId))),String(i.limit)]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);g.x=n.x+n.width-70-g.width/2,g.y=n.y+10,this.addChild(g),this.progressLabel=g;var c;Api.inviteVoApi.getInvitePowerGettedReward(e.cfgId)>=i.limit?c=BaseBitmap.create("signin_had_get"):(c=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskCollect",this.getRewardButtonHandler,this),this.getBtn=c,c.name="getRewardBtn",Api.inviteVoApi.getInvitePowerGettedReward(e.cfgId)>=e.arriveCount&&App.DisplayUtil.changeToGray(c)),c.x=g.x+g.width/2-c.width/2,c.y=n.y+n.height-c.height-10,this.addChild(c)},e.prototype.getRewardButtonHandler=function(t){console.log("getRewardButtonHandler"),Api.inviteVoApi.getInvitePowerGettedReward(this.data.cfgId)<Config.InvitefriendCfg.friendPower[this.data.cfgId].limit&&Api.inviteVoApi.getInvitePowerGettedReward(this.data.cfgId)<this.data.arriveCount&&(NetManager.request(NetRequestConst.REQUEST_INVITE_GETPOWERREWARD,{ikey:this.data.cfgId}),this.senderIsMe=!0)},e.prototype.doGetRewardCallback=function(t){console.log("doGetRewardCallback");var e=t.data,i=e.ret;e.data;if(i&&this.senderIsMe){this.senderIsMe=!1;var a=Config.InvitefriendCfg.friendPower[this.data.cfgId];if(App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.data.rewards)),Api.inviteVoApi.getInvitePowerGettedReward(this.data.cfgId)>=a.limit){var n=this.getBtn.x+this.getBtn.width/2,o=this.getBtn.y+this.getBtn.height/2;this.getBtn.dispose();var s=void 0;s=BaseBitmap.create("signin_had_get"),s.x=n-s.width/2,s.y=o-s.height/2,this.addChild(s)}else Api.inviteVoApi.getInvitePowerGettedReward(this.data.cfgId)>=this.data.arriveCount&&App.DisplayUtil.changeToGray(this.getBtn);this.progressLabel.text=LanguageManager.getlocal("invitePowerProgress",[String(Math.min(a.limit,a.limit-Api.inviteVoApi.getInvitePowerGettedReward(this.data.cfgId))),String(a.limit)])}},e.prototype.dispose=function(){this.getBtn=null,this._rewardList=null,this.data=null,this.progressLabel=null,App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_INVITE_GETPOWERREWARD,this.doGetRewardCallback,this),t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(InviteViewTab2ScrollItem.prototype,"InviteViewTab2ScrollItem");var InviteViewTab3=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.friendRechargeList=Api.inviteVoApi.getFriendRechargeList();var t=egret.Rectangle.create();t.setTo(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-350-80),this._scrollList=ComponentManager.getScrollList(InviteViewTab3ScrollItem,this.friendRechargeList,t),this.addChild(this._scrollList),this._scrollList.y=80},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(InviteViewTab3.prototype,"InviteViewTab3");var InviteViewTab3ScrollItem=function(t){function e(){var e=t.call(this)||this;return e.getBtn=null,e._selectedIndex=0,e.senderIsMe=!1,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_INVITE_GETRECHARGEREWARD,this.doGetRewardCallback,this),this.data=e;var i=Config.InvitefriendCfg.friendRecharge[e.cfgId];this._selectedIndex=t;var a=GameConfig.stageWidth,n=BaseBitmap.create("public_9_bg21");n.width=a-50,n.height=100,n.x=a/2-n.width/2,n.y=36,this.addChild(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("inviteFriendRecharge",[String(i.needRecharge)]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);o.x=a/2-o.width/2,o.y=n.y-22-o.height/2,this.addChild(o);var s=BaseBitmap.create("public_line3");s.width=s.width+o.width+20,s.x=a/2-s.width/2,s.y=o.y,this.addChild(s);for(var r=.6,l=GameData.formatRewardItem(i.content),h=0;h<l.length;h++){var d=GameData.getItemIcon(l[h],!0,!0);d.x=n.x+10+7*(h+1)+d.width*r*h,d.y=n.y+20,d.scaleX=d.scaleY=r,this.addChild(d)}var g=ComponentManager.getTextField(LanguageManager.getlocal("invitePowerProgress",[String(Math.min(i.limit,i.limit-Api.inviteVoApi.getInviteRechargeGettedReward(e.cfgId))),String(i.limit)]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);g.x=n.x+n.width-70-g.width/2,g.y=n.y+10,this.addChild(g),this.progressLabel=g;var c;Api.inviteVoApi.getInviteRechargeGettedReward(e.cfgId)>=i.limit?c=BaseBitmap.create("signin_had_get"):(c=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskCollect",this.getRewardButtonHandler,this),this.getBtn=c,c.name="getRewardBtn",Api.inviteVoApi.getInviteRechargeGettedReward(e.cfgId)>=e.arriveCount&&App.DisplayUtil.changeToGray(c)),c.x=g.x+g.width/2-c.width/2,c.y=n.y+n.height-c.height-10,this.addChild(c)},e.prototype.getRewardButtonHandler=function(t){console.log("getRewardButtonHandler"),Api.inviteVoApi.getInviteRechargeGettedReward(this.data.cfgId)<Config.InvitefriendCfg.friendRecharge[this.data.cfgId].limit&&Api.inviteVoApi.getInviteRechargeGettedReward(this.data.cfgId)<this.data.arriveCount&&(NetManager.request(NetRequestConst.REQUEST_INVITE_GETRECHARGEREWARD,{ikey:this.data.cfgId}),this.senderIsMe=!0)},e.prototype.doGetRewardCallback=function(t){console.log("doGetRewardCallback");var e=t.data,i=e.ret;e.data;if(i&&this.senderIsMe){this.senderIsMe=!1;var a=Config.InvitefriendCfg.friendRecharge[this.data.cfgId];if(App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.data.rewards)),Api.inviteVoApi.getInviteRechargeGettedReward(this.data.cfgId)>=a.limit){var n=this.getBtn.x+this.getBtn.width/2,o=this.getBtn.y+this.getBtn.height/2;this.getBtn.dispose();var s=void 0;s=BaseBitmap.create("signin_had_get"),s.x=n-s.width/2,s.y=o-s.height/2,this.addChild(s)}else Api.inviteVoApi.getInviteRechargeGettedReward(this.data.cfgId)>=this.data.arriveCount&&App.DisplayUtil.changeToGray(this.getBtn);this.progressLabel.text=LanguageManager.getlocal("invitePowerProgress",[String(Math.min(a.limit,a.limit-Api.inviteVoApi.getInviteRechargeGettedReward(this.data.cfgId))),String(a.limit)])}},e.prototype.dispose=function(){this.getBtn=null,this._rewardList=null,this.data=null,App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_INVITE_GETRECHARGEREWARD,this.doGetRewardCallback,this),t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(InviteViewTab3ScrollItem.prototype,"InviteViewTab3ScrollItem");var InviteViewTab4=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg32");t.height=GameConfig.stageHeigth-350-80,t.width=590,t.x=GameConfig.stageWidth/2-t.width/2,t.y=80,this.addChild(t);var e=BaseBitmap.create("public_9_bg33");e.width=t.width,e.height=50,e.x=t.x,e.y=t.y,this.addChild(e);var i=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);i.text=LanguageManager.getlocal("rankorder"),i.x=e.x+20,i.y=e.y+e.height/2-i.height+15,this.addChild(i);var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);a.text=LanguageManager.getlocal("ranknickName"),a.x=i.x+110,a.y=i.y,this.addChild(a);var n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);n.text=LanguageManager.getlocal("serverListServer2"),n.x=a.x+200,n.y=i.y,this.addChild(n);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);o.text=LanguageManager.getlocal("rankpower"),o.x=n.x+150,o.y=i.y,this.addChild(o);var s=Api.inviteVoApi.sortedByPower,r=egret.Rectangle.create();r.setTo(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-500),this._scrollList=ComponentManager.getScrollList(InviteViewTab4ScrollItem,s,r),this._scrollList.y=e.y+e.height+10,this.addChild(this._scrollList)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(InviteViewTab4.prototype,"InviteViewTab4");var InviteViewTab4ScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){if(this.width=602,this.height=75,3>t){var i=BaseBitmap.create("rank_"+String(t+1));i.x=70-i.width/2,i.y=this.height/2-i.height/2,this.addChild(i)}else{var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);a.text=String(t+1),a.x=70-a.width/2,a.y=this.height/2-a.height/2,this.addChild(a)}var n,o=Api.inviteVoApi.getUserHeadByPid(e);if("http"===o.substr(0,4)){n=new BaseDisplayObjectContainer,n.width=80,n.height=80;var s=BaseLoadBitmap.create(o);s.width=80,s.height=80,n.addChild(s);var r=new egret.Shape;r.graphics.beginFill(255),r.graphics.drawCircle(40,40,40),r.graphics.endFill(),n.addChild(r),s.mask=r,n.cacheAsBitmap=!0,n.setScale(60/n.width)}else{n=new BaseDisplayObjectContainer;var l="public_chatheadbg",h=BaseBitmap.create(l);n.addChild(h);var d=egret.Rectangle.create();d.setTo(0,0,136,143);var g=BaseLoadBitmap.create(Api.playerVoApi.getUserHeadImgPathById(o),d);g.x=0,g.y=-7,g.setScale(2/3),n.addChild(g),n.setScale(60/h.width)}n.x=170-n.width*n.scaleX,n.y=this.height/2-n.height/2*n.scaleY,this.addChild(n);var c=ComponentManager.getTextField(Api.inviteVoApi.getUserNicknameByPid(e),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);c.x=n.x+n.width*n.scaleX+10,c.y=this.height/2-c.height/2,this.addChild(c);var p=ComponentManager.getTextField(LanguageManager.getlocal("ranserver2",[Api.inviteVoApi.getUserServerByPid(e)]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);p.x=368-p.width/2,p.y=this.height/2-p.height/2,this.addChild(p);var _=ComponentManager.getTextField(Api.inviteVoApi.getUserPowerByPid(e),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);_.x=520-_.width/2,_.y=this.height/2-_.height/2,this.addChild(_);var u=BaseBitmap.create("rank_line");u.width=this.width-20,u.x=GameConfig.stageWidth/2-u.width/2,u.y=this.height,this.addChild(u),this.cacheAsBitmap=!0},e.prototype.getSpaceX=function(){return 10},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){this.cacheAsBitmap=!1,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(InviteViewTab4ScrollItem.prototype,"InviteViewTab4ScrollItem");var ComposePopupView=function(t){function e(){var e=t.call(this)||this;return e._numTxtArr=[],e}return __extends(e,t),e.prototype.initView=function(){this._itemCfg=Config.ComposeCfg.getItemCfgById(this.getId(),Api.itemVoApi.getComposeVersion());var t=BaseBitmap.create("public_9_bg4");t.width=528,t.height=292,t.setPosition((this.viewBg.width-t.width)/2,10),this.addChildToContainer(t);var e=BaseBitmap.create("public_9_probiginnerbg");e.width=502,e.height=142,e.setPosition(t.x+(t.width-e.width)/2,t.y+10),this.addChildToContainer(e);var i=this._itemCfg.getIconContainer();i.setPosition(e.x+10,e.y+(e.height-i.height)/2),this.addChildToContainer(i);var a=this._itemCfg.nameTxt;if(a.setPosition(i.x+i.width+10,i.y),this.addChildToContainer(a),this._itemCfg.timeLimit){var n=Api.itemVoApi.getComposeLimitLeft(this._itemCfg.id);this._leftTimeTxt=ComponentManager.getTextField(LanguageManager.getlocal("endTimeDesc",[App.DateUtil.getFormatBySecond(n,1)]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN),this._leftTimeTxt.setPosition(e.x+e.width-200,a.y+(a.height-this._leftTimeTxt.height)/2),this.addChildToContainer(this._leftTimeTxt),0>=n&&(this._leftTimeTxt.text=LanguageManager.getlocal("composeLimitTimeEndDesc"))}var o=a.y+a.height;this._itemCfg.composeLimit&&(this._composeLimitTxt=ComponentManager.getTextField(LanguageManager.getlocal("composeItemMaxNumDesc",[Api.itemVoApi.getComposeNumById(this._itemCfg.id)+"/"+this._itemCfg.composeLimit]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this._composeLimitTxt.setPosition(a.x,a.y+a.height+10),this.addChildToContainer(this._composeLimitTxt),o=this._composeLimitTxt.y+this._composeLimitTxt.height);var s=this._itemCfg.getDescTxt(!0);s.width=e.width-i.x+e.x-i.width-10-10,s.setPosition(a.x,o+10),this.addChildToContainer(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("composeCostDesc"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);r.setPosition(i.x+20,e.y+e.height+10),this.addChildToContainer(r);for(var l=this._itemCfg.needItemCfgList,h=l.length,d=0;h>d;d++){var g=l[d].getIconContainer(!0);g.setPosition(r.x+r.width+10+(g.width+5)*d,e.y+e.height+5),this.addChildToContainer(g);var c=Api.itemVoApi.getItemNumInfoVoById(l[d].id),p=ComponentManager.getTextField(this.getComposeItemNumLocalStr(l[d].id),TextFieldConst.FONTSIZE_CONTENT_SMALL);p.width>g.width+10&&(p.scaleX=(g.width+10)/p.width),p.textAlign=egret.HorizontalAlign.CENTER,p.setPosition(g.x+(g.width-p.width*p.scaleX)/2,g.y+g.height+2),p.bindData=l[d].id,this.addChildToContainer(p),this._numTxtArr.push(p)}if(this._itemCfg.needGem){var _=GameData.getRewardItemIconByIdAndType(ItemEnums.gem,null,!0);
_.setPosition(r.x+r.width+10+(_.width+5)*l.length,e.y+e.height+5),this.addChildToContainer(_);var c=Api.playerVoApi.getPlayerGem(),u="",C=c,f=this._itemCfg.needGem;u="("+C+"/"+f+")",u=C>=f?App.StringUtil.formatStringColor(u,TextFieldConst.COLOR_WARN_GREEN):App.StringUtil.formatStringColor(u,TextFieldConst.COLOR_WARN_RED);var p=ComponentManager.getTextField(u,TextFieldConst.FONTSIZE_CONTENT_SMALL);p.width>_.width+10&&(p.scaleX=(_.width+10)/p.width),p.textAlign=egret.HorizontalAlign.CENTER,p.setPosition(_.x+(_.width-p.width*p.scaleX)/2,_.y+_.height+2),p.bindData=ItemEnums.gem,this.addChildToContainer(p),this._numTxtArr.push(p)}var m=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"composeBtn",this.composeHandler,this);m.setPosition(t.x+(t.width-m.width)/2,t.y+t.height+10),this.addChildToContainer(m)},e.prototype.tick=function(){var t=Api.itemVoApi.getComposeLimitLeft(this._itemCfg.id);t>0?this._leftTimeTxt&&(this._leftTimeTxt.text=LanguageManager.getlocal("endTimeDesc",[App.DateUtil.getFormatBySecond(t,1)])):this._leftTimeTxt&&(this._leftTimeTxt.dispose(),this._leftTimeTxt.text=LanguageManager.getlocal("composeLimitTimeEndDesc"))},e.prototype.composeHandler=function(){var t=this.checkNeedItemName();if(t)return void App.CommonUtil.showTip(LanguageManager.getlocal("resNotEnoughDesc",[t]));if(this._itemCfg.composeLimit&&Api.itemVoApi.getComposeNumById(this._itemCfg.id)>=this._itemCfg.composeLimit)return void App.CommonUtil.showTip(LanguageManager.getlocal("composeMaxNumDesc"));if(this._itemCfg.timeLimit){var e=Api.itemVoApi.getComposeLimitLeft(this._itemCfg.id);if(0>=e)return void App.CommonUtil.showTip(LanguageManager.getlocal("composeLimitTimeEndDesc"))}var i=Api.itemVoApi.getComposeVersion();this.request(NetRequestConst.REQUEST_ITEM_DOCOMPOSE,{version:i,composeid:this._itemCfg.id})},e.prototype.receiveData=function(t){t.ret&&(t.data.data.rewards&&App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.rewards)),App.MessageHelper.dispatchNetMessage(NetRequestConst.REQUEST_ITEM_DOCOMPOSE+this._itemCfg.id),this.refresh(),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICR_ITEM_COMPOUND,{}))},e.prototype.refresh=function(){if(this._numTxtArr)for(var t=this._numTxtArr.length,e=0;t>e;e++)if(1==Number(this._numTxtArr[e].bindData)){var i=Api.playerVoApi.getPlayerGem(),a="",n=i,o=this._itemCfg.needGem;a="("+n+"/"+o+")",a=n>=o?App.StringUtil.formatStringColor(a,TextFieldConst.COLOR_WARN_GREEN):App.StringUtil.formatStringColor(a,TextFieldConst.COLOR_WARN_RED),this._numTxtArr[e].text=a}else this._numTxtArr[e].text=this.getComposeItemNumLocalStr(this._numTxtArr[e].bindData);this._composeLimitTxt&&(this._composeLimitTxt.text=LanguageManager.getlocal("composeItemMaxNumDesc",[Api.itemVoApi.getComposeNumById(this._itemCfg.id)+"/"+this._itemCfg.composeLimit]))},e.prototype.checkNeedItemName=function(){for(var t=this._itemCfg.needItemCfgList,e=t.length,i="",a=0;e>a;a++){var n=t[a].id,o=Api.itemVoApi.getItemNumInfoVoById(n),s=this._itemCfg.getNeedItemNumById(n);s>o&&(i+=""==i?t[a].name:","+t[a].name)}if(this._itemCfg.needGem){var o=Api.playerVoApi.getPlayerGem(),s=this._itemCfg.needGem;s>o&&(i+=""==i?Config.RewardCfg.getNameByTypeAndId(ItemEnums.gem):","+Config.RewardCfg.getNameByTypeAndId(ItemEnums.gem))}return i},e.prototype.getComposeItemNumLocalStr=function(t){var e="",i=Api.itemVoApi.getItemNumInfoVoById(t),a=this._itemCfg.getNeedItemNumById(t);return e="("+i+"/"+a+")",e=i>=a?App.StringUtil.formatStringColor(e,TextFieldConst.COLOR_WARN_GREEN):App.StringUtil.formatStringColor(e,TextFieldConst.COLOR_WARN_RED)},e.prototype.getId=function(){return this.param.data},e.prototype.dispose=function(){if(this._itemCfg.timeLimit){var e=Api.itemVoApi.getComposeLimitLeft(this._itemCfg.id);0>=e&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_ITEMVIEWTAB2)}this._itemCfg=null,this._numTxtArr.length=0,this._leftTimeTxt=null,this._composeLimitTxt=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(ComposePopupView.prototype,"ComposePopupView");var ItemScrollItem=function(t){function e(){var e=t.call(this)||this;return e._numTF=null,e._itemInfoVo=null,e._isGray=!1,e._equipedIcon=null,e._shinneIcon=null,e._itembg=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){this._itemInfoVo=e;var i=BaseBitmap.create(e.iconBg);i.x=i.y=5,this.addChild(i),this._itembg=i;var a=BaseLoadBitmap.create(e.icon);a.x=i.x+i.width/2-50,a.y=i.y+i.height/2-50,this.addChild(a),this._numTF=ComponentManager.getTextField(String(e.num),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this._numTF.x=i.x+i.width-this._numTF.width-5,this._numTF.y=i.y+i.height-this._numTF.height-5,this.addChild(this._numTF),3==this._itemInfoVo.type&&(this.setIsGray(-1==this._itemInfoVo.num),this._numTF.visible=!1,0==this._itemInfoVo.num?(this._shinneIcon=BaseBitmap.create("itemicon_shinne"),this._shinneIcon.x=this._shinneIcon.y=5,this.addChild(this._shinneIcon),egret.Tween.get(this._shinneIcon,{loop:!0}).to({alpha:.2},500).to({alpha:1},500)):2==this._itemInfoVo.num&&(this._equipedIcon=BaseBitmap.create("itemicon_equiped"),this._equipedIcon.x=this._equipedIcon.y=5,this.addChild(this._equipedIcon)))},e.prototype.setIsGray=function(t){t!=this._isGray&&(t?App.DisplayUtil.changeToGray(this):App.DisplayUtil.changeToNormal(this),this._isGray=t)},e.prototype.update=function(){this._numTF&&(this._numTF.text=String(this._itemInfoVo.num),this._numTF.x=this._itembg.x+this._itembg.width-this._numTF.width-5),3==this._itemInfoVo.type&&(this.setIsGray(-1==this._itemInfoVo.num),this._itemInfoVo.num>0&&this._shinneIcon?(egret.Tween.removeTweens(this._shinneIcon),this.removeChild(this._shinneIcon),this._shinneIcon=null):1==this._itemInfoVo.num&&this._equipedIcon?(this.removeChild(this._equipedIcon),this._equipedIcon=null):2==this._itemInfoVo.num&&null==this._equipedIcon&&(this._equipedIcon=BaseBitmap.create("itemicon_equiped"),this._equipedIcon.x=this._equipedIcon.y=5,this.addChild(this._equipedIcon)))},e.prototype.getSpaceX=function(){return 13},e.prototype.getSpaceY=function(){return 18},e.prototype.dispose=function(){this._isGray&&App.DisplayUtil.changeToNormal(this),this._isGray=!1,this._numTF&&(this.removeChild(this._numTF),this._numTF.dispose(),this._numTF=null),this._itemInfoVo=null,this._equipedIcon=null,this._shinneIcon&&egret.Tween.removeTweens(this._shinneIcon),this._shinneIcon=null,this._itembg=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ItemScrollItem.prototype,"ItemScrollItem");var ItemUseSuccessView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=this.param.data[0],e=this.param.data[1],i=this.param.data[2],a=i.name;this._nodeContainer=new BaseDisplayObjectContainer,this.addChild(this._nodeContainer);var n=BaseBitmap.create("public_9_wordbg");n.height=GameConfig.stageHeigth-200,n.y=GameConfig.stageHeigth-n.height-2,this._nodeContainer.addChild(n);var o=ComponentManager.getButton("popupview_closebtn1","",this.hide,this);o.x=this.viewBg.width-o.width+20,o.y=n.y-o.height/2,this._nodeContainer.addChild(o);var s=BaseBitmap.create("itemuse_succeed");s.x=n.x+n.width/2-s.width/2,s.y=n.y-s.height/2-15,this._nodeContainer.addChild(s);var r=ComponentManager.getTextField("",20);r.text=LanguageManager.getlocal("itemUse_speciatTip",[e,a]),r.x=n.x+n.width/2-r.width/2,r.y=n.y+45,this._nodeContainer.addChild(r);for(var l=n.height-100,h=new egret.Rectangle(0,0,GameConfig.stageWidth,l),d=new BaseDisplayObjectContainer,g=20,c=50,p={},_=t.length,u=0;_>u;u++)p[String(u)]=t[u];var C=!1;(1361==i.id||1362==i.id)&&(C=!0);for(var f=Object.keys(p),m=0;f.length>0;){var T=f[App.MathUtil.getRandom(0,f.length)],y=BaseBitmap.create("studyatk_servant_bg");y.y=g,m%2==0?y.x=c:(y.x=GameConfig.stageWidth-c-y.width,g+=C?270:230),d.addChild(y);var v=BaseBitmap.create("studyatk_booklv_circle");v.anchorOffsetX=v.width/2,v.anchorOffsetY=v.height/2,v.setScale(.5),v.x=y.x+y.width/2,v.y=y.y+y.height/2;var A=BaseBitmap.create("studyatk_booklv_light1");A.anchorOffsetX=A.width/2,A.anchorOffsetY=A.height/2,A.x=y.x+y.width/2,A.y=y.y+y.height/2,A.setScale(1.18),d.addChild(A);var w=BaseBitmap.create("studyatk_booklv_light2");w.anchorOffsetX=w.width/2,w.anchorOffsetY=w.height/2,w.x=A.x,w.y=A.y,w.setScale(A.scaleX),d.addChild(w),d.addChild(v),egret.Tween.get(v,{loop:!0}).to({scaleX:1.25,scaleY:1.25},1e3).to({scaleX:2,scaleY:2,alpha:0},1e3).set({scaleX:.5,scaleY:.5,alpha:1}),egret.Tween.get(A,{loop:!0}).to({rotation:360},15e3),egret.Tween.get(w,{loop:!0}).to({rotation:-360},15e3);var x=null,I="";for(var L in p[T])I=L,x=p[T][L];var E="servant_full_"+I;C&&(E="wife_full_"+I);var B=BaseLoadBitmap.create(E),S=egret.Rectangle.create();C?(E="wife_full_"+I,B.width=540,B.height=760,S.setTo(0,0,540,500)):(B.width=405,B.height=467,S.setTo(0,0,405,400)),B.mask=S,B.anchorOffsetX=B.width/2,B.anchorOffsetY=B.height/2,B.setScale(.4),B.x=y.x+y.width/2,B.y=y.y+y.height/2-10,d.addChild(B);var N=BaseBitmap.create("bookroom_cdbg");N.scaleY=1.7,N.x=y.x+y.width/2-N.width/2,N.y=y.y+y.height-95,C&&(N.y-=10),d.addChild(N);for(var M=N.y+12,b=0;b<x.length;b++){var O=GameData.formatRewardItem(x[b])[0],V=(t[I],ComponentManager.getTextField("",20,TextFieldConst.COLOR_QUALITY_GREEN));V.text=O.message,V.x=N.x+N.width/2-V.width/2,1==x.length?V.y=N.y+N.height/2*N.scaleY-V.height/2:(V.y=M,M+=25),d.addChild(V)}m++,delete p[T],f=Object.keys(p)}var R=ComponentManager.getScrollView(d,h);R.y=n.y+80,R.bounces=!1,this._nodeContainer.addChild(R)},e.prototype.clickHandler=function(){t.prototype.hide.call(this)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["studyatk_servant_bg","itemuse_succeed","bookroom_cdbg","popupview_closebtn1","studyatk_booklv_circle","studyatk_booklv_light1","studyatk_booklv_light2"])},e.prototype.dispose=function(){this._nodeContainer=null,t.prototype.dispose.call(this)},e}(BaseView);__reflect(ItemUseSuccessView.prototype,"ItemUseSuccessView");var ItemView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this.checkRedPoint()},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_ITEM_GETMODEL,requestData:{}}},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["common_shopmark"])},e.prototype.getTabbarTextArr=function(){return["itemBtn","composeBtn","fashionBtn"]},e.prototype.checkRedPoint=function(){Api.itemVoApi.checkRedPoint()?this.tabbarGroup.addRedPoint(1):this.tabbarGroup.removeRedPoint(1),App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_ITEM_DOCOMPOSE,this.checkRedPoint,this),App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_ITEM_GETCOMPOSE,this.checkRedPoint,this)},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_ITEM_DOCOMPOSE,this.checkRedPoint,this),App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_ITEM_GETCOMPOSE,this.checkRedPoint,this),t.prototype.dispose.call(this)},e.MAX_NUM=5,e}(CommonView);__reflect(ItemView.prototype,"ItemView");var ItemViewTab1=function(t){function e(){var e=t.call(this)||this;return e._selectedIndex=null,e._selectedItemInfoVo=null,e._selectedBg=null,e._selectedNameTextF=null,e._selectedNumTextF=null,e._selectedIcon=null,e._selectedIconBg=null,e._selectedDescTextF=null,e._selectedDropTextF=null,e._useBtn=null,e._itemInfoVoList=null,e._errorTF=null,e._lastUseNum=0,e.initView(),e}return __extends(e,t),e.prototype.getListType=function(){return 1},e.prototype.getNetRequestConst=function(){return NetRequestConst.REQUEST_USE_ITEM},e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(this.getNetRequestConst()),this.useCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USER_CHANGENAME),this.useCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USER_CHANGEPIC),this.useCallback,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_CHANGE_IMG,this.changeImgNotify,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICR_ITEM_COMPOUND,this.refreshItemsAfterCompound,this),this._itemInfoVoList=Api.itemVoApi.getItemVoListByType(this.getListType()),this._itemInfoVoList.length>0&&this._itemInfoVoList[0]?(this._selectedIndex=0,this._selectedItemInfoVo=this._itemInfoVoList[0]):this._selectedIndex=-1;var t=BaseBitmap.create("public_9_bg23");t.width=GameConfig.stageWidth-20,t.x=10,t.height=GameConfig.stageHeigth-445,t.name="bg1",this.addChild(t);var e=egret.Rectangle.create();e.setTo(0,0,610,t.height-30),this._scrollList=ComponentManager.getScrollList(ItemScrollItem,this._itemInfoVoList,e),this.addChild(this._scrollList),this._scrollList.setPosition(20,t.y+10),this._scrollList.addTouchTap(this.clickItemHandler,this),this._errorTF=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._errorTF.x=t.x+t.width/2-this._errorTF.width/2,this._errorTF.y=t.y+t.height/2-this._errorTF.height/2,this.addChild(this._errorTF),this._selectedItemInfoVo?this.initButtomContainer(t):this.noItemTip()},e.prototype.initButtomContainer=function(t){this._buttomContainer=new BaseDisplayObjectContainer,this._buttomContainer.y=t.y+t.height+8,this.addChild(this._buttomContainer),this._bottomBg=BaseBitmap.create("public_9_bg22"),this._bottomBg.height=GameConfig.stageHeigth-t.height-160,this._bottomBg.y=0,this._buttomContainer.addChild(this._bottomBg);var e=BaseBitmap.create("public_line3");e.width=480,e.x=GameConfig.stageWidth/2-e.width/2,e.y=this._bottomBg.y+35,this._buttomContainer.addChild(e),this._selectedNameTextF=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_BLACK),this._buttomContainer.addChild(this._selectedNameTextF),this._selectedItemInfoVo.iconBg&&this._selectedItemInfoVo.icon&&(this._selectedIconBg=BaseBitmap.create(this._selectedItemInfoVo.iconBg),this._selectedIconBg.x=45,this._selectedIconBg.y=this._bottomBg.y+75,this._buttomContainer.addChild(this._selectedIconBg),this._selectedIcon=BaseLoadBitmap.create(this._selectedItemInfoVo.icon),this._selectedIcon.x=50,this._selectedIcon.y=this._bottomBg.y+78,this._buttomContainer.addChild(this._selectedIcon),this._selectedIcon.visible=!1);var i=BaseBitmap.create("public_9_bg21");i.y=this._bottomBg.y+70,i.x=180,i.width=430,i.height=123,this._buttomContainer.addChild(i),this._selectedNumTextF=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN),this._buttomContainer.addChild(this._selectedNumTextF),this._selectedDescTextF=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN),this._selectedDescTextF.x=i.x+10,this._selectedDescTextF.width=i.width-40,this._selectedDescTextF.y=i.y+10,this._buttomContainer.addChild(this._selectedDescTextF),this._selectedDropTextF=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN),this._selectedDropTextF.x=i.x+10,this._selectedDropTextF.width=i.width-40,this._selectedDropTextF.y=i.y+70,this._buttomContainer.addChild(this._selectedDropTextF),this._useBtn=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"useBtn",this.clickUseBtnHandler,this),this._useBtn.x=GameConfig.stageWidth/2-this._useBtn.width/2,this._useBtn.y=GameConfig.stageHeigth-this._useBtn.height-175,this._useBtn.setColor(TextFieldConst.COLOR_BLACK),this.addChild(this._useBtn),this._useBtn.visible=!1,this.updateItem(this._selectedIndex)},e.prototype.clickItemHandler=function(t){var e=Number(t.data);this.updateItem(e)},e.prototype.updateItem=function(t,e){return void 0===e&&(e=!1),-1==this._selectedIndex?(this._buttomContainer.visible=!1,this.noItemTip(),this._selectedNameTextF.text="",this._selectedNumTextF.text="",this._selectedDescTextF.text="",this._selectedDropTextF.text="",this._useBtn.visible=!1,this._selectedIcon.visible=!1,void(this._selectedIconBg.visible=!1)):(this._buttomContainer.visible=!0,this._selectedIndex&&this._selectedIndex==t&&this._selectedItemInfoVo&&0==e?(this._selectedBg&&this._curItemScrollItem&&!this._curItemScrollItem.contains(this._selectedBg)&&this._curItemScrollItem.addChild(this._selectedBg),this._selectedNumTextF.text=LanguageManager.getlocal("numTitle")+String(this._selectedItemInfoVo.num),void(1950==this._selectedItemInfoVo.id&&(Api.servantVoApi.isOwnServantDailyBoss()?this._useBtn.visible=!1:this._useBtn.visible=!0))):(null==this._selectedBg?(this._selectedBg=BaseBitmap.create("itembg_selected"),this._selectedBg.x=4,this._selectedBg.y=4):this._curItemScrollItem&&this._curItemScrollItem.contains(this._selectedBg)&&this._curItemScrollItem.removeChild(this._selectedBg),this._selectedIndex=t,this._selectedItemInfoVo=this._itemInfoVoList[this._selectedIndex],this._curItemScrollItem=this._scrollList.getItemByIndex(this._selectedIndex),this._curItemScrollItem&&!this._curItemScrollItem.contains(this._selectedBg)&&this._curItemScrollItem.addChild(this._selectedBg),this._selectedItemInfoVo&&this._selectedItemInfoVo.name&&(this._selectedNameTextF.text=this._selectedItemInfoVo.name,this._selectedNumTextF.text=LanguageManager.getlocal("numTitle")+String(this._selectedItemInfoVo.num),this._selectedDescTextF.text=LanguageManager.getlocal("effectTitle")+this._selectedItemInfoVo.desc,this._selectedDropTextF.text=LanguageManager.getlocal("dropTitle")+this._selectedItemInfoVo.dropDesc,this._useBtn.visible=this._selectedItemInfoVo.isShowUseBtn),1950==this._selectedItemInfoVo.id&&(Api.servantVoApi.isOwnServantDailyBoss()?this._useBtn.visible=!1:this._useBtn.visible=!0),this._selectedIconBg.visible=!0,this._selectedItemInfoVo&&this._selectedItemInfoVo.iconBg&&(this._selectedIconBg.texture=ResourceManager.getRes(this._selectedItemInfoVo.iconBg),this._selectedIcon.visible=!0,this._selectedIcon.setload(this._selectedItemInfoVo.icon)),this._selectedNumTextF.x=50,this._selectedNumTextF.y=190,this._selectedNameTextF.x=this._bottomBg.width/2-this._selectedNameTextF.width/2,void(this._selectedNameTextF.y=this._bottomBg.y+30)))},e.prototype.clickUseBtnHandler=function(t){var e=1;if(this._selectedItemInfoVo){var i=this._selectedItemInfoVo.id;if(1021==i||1029==i||1361==i||1362==i||2103==i||2104==i||2105==i||2106==i){if((1361==i||1362==i)&&0==Api.wifeVoApi.getWifeNum())return void App.CommonUtil.showTip(LanguageManager.getlocal("itemUse_noWifeTip"));if(2103==i||2104==i||2105==i||2106==i){if(1==Api.itemVoApi.isEnd(i))return void App.CommonUtil.showTip(LanguageManager.getlocal("acspringTouchdes2"));if(0==Api.itemVoApi.isStart(i))return void App.CommonUtil.showTip(LanguageManager.getlocal("acspringTouchdes"))}return void(this._selectedItemInfoVo.num>=ItemView.MAX_NUM?ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSEPOPUPVIEW,{itemId:this._selectedItemInfoVo.id,callback:this.sendRequest,handler:this}):this.sendRequest(e,this._selectedItemInfoVo.id))}this._selectedItemInfoVo instanceof ItemInfoVo&&2==this._selectedItemInfoVo.target?ViewController.getInstance().openView(ViewConst.POPUP.SERVANTSELECTEDPOPUPVIEW,{type:ServantSelectedPopupView.TYPE_USE_ITEM,itemId:this._selectedItemInfoVo.id,callback:this.sendRequest,handler:this}):1902==this._selectedItemInfoVo.id?ViewController.getInstance().openView(ViewConst.COMMON.GUIDECREATEUSERVIEW,{changeImg:!0,callBack:this.sendRequest,obj:this}):this._selectedItemInfoVo instanceof ItemInfoVo&&1901==this._selectedItemInfoVo.id?ViewController.getInstance().openView(ViewConst.POPUP.USERNAMEPOPUPVIEW):this._selectedItemInfoVo.num>=ItemView.MAX_NUM&&1950!=this._selectedItemInfoVo.id?ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSEPOPUPVIEW,{itemId:this._selectedItemInfoVo.id,callback:this.sendRequest,handler:this}):this.sendRequest(e,this._selectedItemInfoVo.id)}},e.prototype.changeImgNotify=function(){this.updateItem(this._selectedIndex,!0),this._selectedItemInfoVo.num>0&&this._curItemScrollItem&&this._curItemScrollItem.update()},e.prototype.refreshItemsAfterCompound=function(){var t=!1;this._selectedItemInfoVo.num>0?(this._curItemScrollItem&&this._curItemScrollItem.update(),this._itemInfoVoList=Api.itemVoApi.getItemVoListByType(1),this._curItemScrollItem&&this._curItemScrollItem.contains(this._selectedBg)&&this._curItemScrollItem.removeChild(this._selectedBg),this._scrollList.refreshData(this._itemInfoVoList),t=!0):(t=!0,this._itemInfoVoList=Api.itemVoApi.getItemVoListByType(1),this._curItemScrollItem&&this._curItemScrollItem.contains(this._selectedBg)&&this._curItemScrollItem.removeChild(this._selectedBg),this._scrollList.refreshData(this._itemInfoVoList),this._itemInfoVoList.length>this._selectedIndex?this._selectedItemInfoVo=this._itemInfoVoList[this._selectedIndex]:this._selectedIndex>0?(this._selectedIndex-=1,this._selectedItemInfoVo=this._itemInfoVoList[this._selectedIndex]):(this._selectedIndex=-1,this._selectedItemInfoVo=null)),this.updateItem(this._selectedIndex,t)},e.prototype.sendRequest=function(t,e,i){this._lastUseNum=t;var a={itemNum:t,itemId:e};i&&(a.servantId=i),NetManager.request(this.getNetRequestConst(),a)},e.prototype.useCallback=function(t){var e=t.data.data.data,i=!1,a=!1;if(e&&e.rewards){for(var n=GameData.formatRewardItem(e.rewards),o=0;o<n.length;o++){var s=n[o];if(6==s.type){a=!0;break}}App.CommonUtil.playRewardFlyAction(n)}var r=this._selectedItemInfoVo.id;e&&e.servantArr&&(1021==r||1029==r)&&ViewController.getInstance().openView(ViewConst.BASE.ITEMUSESUCCESSVIEW,[e.servantArr,this._lastUseNum,this._selectedItemInfoVo]),e&&e.wifeArr&&(1361==r||1362==r)&&ViewController.getInstance().openView(ViewConst.BASE.ITEMUSESUCCESSVIEW,[e.wifeArr,this._lastUseNum,this._selectedItemInfoVo]),this._selectedItemInfoVo.num>0&&0==a?this._curItemScrollItem&&this._curItemScrollItem.update():(i=!0,this._itemInfoVoList=Api.itemVoApi.getItemVoListByType(1),this._curItemScrollItem&&this._curItemScrollItem.contains(this._selectedBg)&&this._curItemScrollItem.removeChild(this._selectedBg),this._scrollList.refreshData(this._itemInfoVoList),this._itemInfoVoList.length>this._selectedIndex?this._selectedItemInfoVo=this._itemInfoVoList[this._selectedIndex]:this._selectedIndex>0?(this._selectedIndex-=1,this._selectedItemInfoVo=this._itemInfoVoList[this._selectedIndex]):(this._selectedIndex=-1,this._selectedItemInfoVo=null)),this.updateItem(this._selectedIndex,i)},e.prototype.noItemTip=function(){this._itemInfoVoList.length<=0?(this._errorTF.text=LanguageManager.getlocal("itemNotHasDesc"),this._errorTF.x=GameConfig.stageWidth/2-this._errorTF.width/2,this._errorTF.y=GameConfig.stageHeigth-610,this.getChildByName("bg1")&&(this.getChildByName("bg1").height=GameConfig.stageHeigth-170)):this._errorTF.text=""},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(this.getNetRequestConst()),this.useCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USER_CHANGENAME),this.useCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USER_CHANGEPIC),this.useCallback,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_CHANGE_IMG,this.changeImgNotify,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICR_ITEM_COMPOUND,this.refreshItemsAfterCompound,this),this._selectedIndex=null,this._selectedItemInfoVo&&(this._selectedItemInfoVo=null),this._selectedBg&&(this._selectedBg.parent&&this._selectedBg.parent.contains(this._selectedBg)&&this._selectedBg.parent.removeChild(this._selectedBg),BaseBitmap.release(this._selectedBg),this._selectedBg=null),this._selectedNameTextF&&(this._buttomContainer.removeChild(this._selectedNameTextF),this._selectedNameTextF.dispose(),this._selectedNameTextF=null),this._selectedNumTextF&&(this._buttomContainer.removeChild(this._selectedNumTextF),this._selectedNumTextF.dispose(),this._selectedNumTextF=null),this._selectedIcon&&(this._buttomContainer.removeChild(this._selectedIcon),BaseBitmap.release(this._selectedIcon),this._selectedIcon=null),this._selectedIconBg&&(this._buttomContainer.removeChild(this._selectedIconBg),BaseBitmap.release(this._selectedIconBg),this._selectedIconBg=null),this._selectedDescTextF&&(this._buttomContainer.removeChild(this._selectedDescTextF),this._selectedDescTextF.dispose(),this._selectedDescTextF=null),this._selectedDropTextF&&(this._buttomContainer.removeChild(this._selectedDropTextF),this._selectedDropTextF.dispose(),this._selectedDropTextF=null),this._useBtn&&(this.removeChild(this._useBtn),this._useBtn.dispose(),this._useBtn=null),this._curItemScrollItem&&(this._curItemScrollItem=null),this._scrollList&&(this.removeChild(this._scrollList),this._scrollList.dispose(),this._scrollList=null),this._errorTF&&(this.removeChild(this._errorTF),this._errorTF.dispose(),this._errorTF=null),this._buttomContainer&&(this.removeChild(this._buttomContainer),this._buttomContainer.dispose(),this._buttomContainer=null),this._itemInfoVoList=null,this._lastUseNum=0,t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(ItemViewTab1.prototype,"ItemViewTab1");var ItemViewTab2=function(t){function e(){var e=t.call(this)||this;return App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_ITEM_GETCOMPOSE,e.initView,e),NetManager.request(NetRequestConst.REQUEST_ITEM_GETCOMPOSE,{}),e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_REFRESH_ITEMVIEWTAB2,this.refreshList,this);var t=BaseBitmap.create("public_9_bg23");t.width=GameConfig.stageWidth-20,t.height=GameConfig.stageHeigth-this.getViewTitleButtomY(),t.x=10,this.addChild(t);var e=egret.Rectangle.create();e.setTo(0,0,563,t.height-20),this._scrollList=ComponentManager.getScrollList(ComposeListItem,Api.itemVoApi.getComposeItemList(),e),this.addChild(this._scrollList),this._scrollList.setPosition(t.x+(t.width-e.width)/2,t.y+10)},e.prototype.refreshList=function(){this._scrollList&&this._scrollList.refreshData(Api.itemVoApi.getComposeItemList())},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_ITEM_GETCOMPOSE,this.initView,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_REFRESH_ITEMVIEWTAB2,this.refreshList,this),t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(ItemViewTab2.prototype,"ItemViewTab2");var ComposeListItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_ITEM_DOCOMPOSE,this.checkRedPoint,this);var i=e;this._itemCfg=i;var a=BaseBitmap.create("public_9_probiginnerbg");a.width=156,a.height=222,a.setPosition(3,3),this.addChild(a);var n=i.nameTxt;n.setPosition(a.x+(a.width-n.width)/2,a.y+10),this.addChild(n);var o=i.getIconContainer(!0);if(o.setPosition(a.x+(a.width-o.width)/2,a.y+n.y+n.height+5),this.addChild(o),this.width=a.width+this.getSpaceX(),i.timeLimit){var s=BaseBitmap.create("common_shopmark");this.addChild(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("composeTimeLimitDesc"),12);r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,r.rotation=-45,r.setPosition(s.width/3+1,s.height/3+1),this.addChild(r)}var l=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"composeBtn",this.composeHandler,this);l.setPosition(a.x+(a.width-l.width)/2,a.y+a.height-l.height-10),this.addChild(l),this._composeBtn=l,this.checkRedPoint()},e.prototype.checkRedPoint=function(){this._composeBtn&&(Api.itemVoApi.checkCanComposeById(this._itemCfg.id)?App.CommonUtil.addRedDotToBDOC(this._composeBtn):App.CommonUtil.removeRedDotFromBDOC(this._composeBtn))},e.prototype.composeHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.COMPOSEPOPUPVIEW,this._itemCfg.id)},e.prototype.getSpaceX=function(){return 46},e.prototype.getSpaceY=function(){return 20},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_ITEM_DOCOMPOSE,this.checkRedPoint,this),this._itemCfg=null,this._composeBtn=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ComposeListItem.prototype,"ComposeListItem");var ItemViewTab3=function(t){function e(){var e=t.call(this)||this;return e._selectedIndex=null,e._selectedItemInfoVo=null,e._selectedBg=null,e._selectedNameTextF=null,e._selectedIcon=null,e._selectedIconBg=null,e._selectedDescTextF=null,e._selectedDropTextF=null,e._useBtn=null,e._itemInfoVoList=null,e._errorTF=null,e.initView(),e}return __extends(e,t),e.prototype.getListType=function(){return 3},e.prototype.getNetRequestConst=function(){return NetRequestConst.REQUEST_ITEM_TITLE},e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(this.getNetRequestConst()),this.useCallback,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_ITEM,this.refresh,this),this._itemInfoVoList=Api.itemVoApi.getTitleVoListByType(this.getListType()),this._selectedIndex=0,this._selectedItemInfoVo=this._itemInfoVoList[0];var t=BaseBitmap.create("public_9_bg23");t.width=GameConfig.stageWidth-20,t.x=10,t.height=GameConfig.stageHeigth-445,t.name="bg1",this.addChild(t);var e=egret.Rectangle.create();e.setTo(0,0,610,t.height-30),this._scrollList=ComponentManager.getScrollList(ItemScrollItem,this._itemInfoVoList,e),this.addChild(this._scrollList),this._scrollList.setPosition(20,t.y+10),this._scrollList.addTouchTap(this.clickItemHandler,this),this._errorTF=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._errorTF.x=t.x+t.width/2-this._errorTF.width/2,this._errorTF.y=t.y+t.height/2-this._errorTF.height/2,this.addChild(this._errorTF),this.initButtomContainer(t)},e.prototype.initButtomContainer=function(t){this._buttomContainer=new BaseDisplayObjectContainer,this._buttomContainer.y=t.y+t.height+8,this.addChild(this._buttomContainer),this._bottomBg=BaseBitmap.create("public_9_bg22"),this._bottomBg.height=GameConfig.stageHeigth-t.height-160,this._bottomBg.y=0,this._buttomContainer.addChild(this._bottomBg);var e=BaseBitmap.create("public_line3");e.width=480,e.x=GameConfig.stageWidth/2-e.width/2,e.y=this._bottomBg.y+35,this._buttomContainer.addChild(e),this._selectedNameTextF=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_BLACK),this._buttomContainer.addChild(this._selectedNameTextF),this._selectedIconBg=BaseBitmap.create(this._selectedItemInfoVo.iconBg),this._selectedIconBg.x=45,this._selectedIconBg.y=this._bottomBg.y+75,this._buttomContainer.addChild(this._selectedIconBg),this._selectedIcon=BaseLoadBitmap.create(this._selectedItemInfoVo.icon),this._selectedIcon.x=50,this._selectedIcon.y=this._bottomBg.y+78,this._buttomContainer.addChild(this._selectedIcon),this._selectedIcon.visible=!1;var i=BaseBitmap.create("public_9_bg21");if(i.y=this._bottomBg.y+70,i.x=180,i.width=430,i.height=123,this._buttomContainer.addChild(i),this._selectedDescTextF=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN),this._selectedDescTextF.x=i.x+10,this._selectedDescTextF.width=i.width-40,this._selectedDescTextF.y=i.y+10,this._buttomContainer.addChild(this._selectedDescTextF),this._selectedDropTextF=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN),this._selectedDropTextF.x=i.x+10,this._selectedDropTextF.width=i.width-40,this._selectedDropTextF.y=i.y+70,this._buttomContainer.addChild(this._selectedDropTextF),this._useBtn=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"useBtn",this.clickUseBtnHandler,this),this._useBtn.x=GameConfig.stageWidth/2-this._useBtn.width/2,this._useBtn.y=GameConfig.stageHeigth-this._useBtn.height-175,this._useBtn.setColor(TextFieldConst.COLOR_BLACK),this.addChild(this._useBtn),this._useBtn.visible=!1,0!=Api.playerVoApi.getTitleid()){var a=Api.itemVoApi.getCurTitleIndex();this._curChooseScrollItem=this._scrollList.getItemByIndex(a)}this.updateItem(this._selectedIndex)
},e.prototype.clickItemHandler=function(t){var e=Number(t.data);this.updateItem(e)},e.prototype.refreshWhenSwitchBack=function(){this._itemInfoVoList=Api.itemVoApi.getTitleVoListByType(this.getListType()),this._scrollList.refreshData(this._itemInfoVoList),this._selectedItemInfoVo=this._itemInfoVoList[this._selectedIndex],this._selectedBg=null,this.updateItem(this._selectedIndex)},e.prototype.refresh=function(){this.refreshWhenSwitchBack(),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_CHANGE_IMG)},e.prototype.updateItem=function(t){this._buttomContainer.visible=!0,null==this._selectedBg&&(this._selectedBg=BaseBitmap.create("itembg_selected"),this._selectedBg.x=4,this._selectedBg.y=4),this._selectedIndex&&this._selectedIndex==t&&this._selectedItemInfoVo&&this._selectedBg&&this._curItemScrollItem&&!this._curItemScrollItem.contains(this._selectedBg)&&this._curItemScrollItem.addChild(this._selectedBg),this._selectedIndex=t,this._selectedItemInfoVo=this._itemInfoVoList[this._selectedIndex],this._curItemScrollItem=this._scrollList.getItemByIndex(this._selectedIndex),this._curItemScrollItem&&!this._curItemScrollItem.contains(this._selectedBg)&&this._curItemScrollItem.addChild(this._selectedBg),this._selectedNameTextF.text=this._selectedItemInfoVo.name,this._selectedDescTextF.text=LanguageManager.getlocal("effectTitle")+this._selectedItemInfoVo.desc,this._selectedDropTextF.text=LanguageManager.getlocal("dropTitle")+this._selectedItemInfoVo.dropDesc,this._useBtn.visible=0==this._selectedItemInfoVo.num||1==this._selectedItemInfoVo.num,0==this._selectedItemInfoVo.num?this._useBtn.setText("useBtn"):1==this._selectedItemInfoVo.num&&this._useBtn.setText("titleEquip"),this._selectedIconBg.visible=!0,this._selectedIconBg.texture=ResourceManager.getRes(this._selectedItemInfoVo.iconBg),this._selectedIcon.visible=!0,this._selectedIcon.setload(this._selectedItemInfoVo.icon),this._selectedNameTextF.x=this._bottomBg.width/2-this._selectedNameTextF.width/2,this._selectedNameTextF.y=this._bottomBg.y+30},e.prototype.clickUseBtnHandler=function(t){this._selectedItemInfoVo&&this.sendRequest(this._selectedItemInfoVo)},e.prototype.sendRequest=function(t){var e={titleid:t.id,status:t.num+1};NetManager.request(this.getNetRequestConst(),e)},e.prototype.useCallback=function(t){var e=t.data.data.data;if(e&&e.rewards){var i=GameData.formatRewardItem(e.rewards);App.CommonUtil.playRewardFlyAction(i)}if(0!=Api.playerVoApi.getTitleid()){this._curChooseScrollItem&&this._curChooseScrollItem.update();var a=Api.itemVoApi.getCurTitleIndex();this._curChooseScrollItem=this._scrollList.getItemByIndex(a)}this._selectedItemInfoVo.num>=0?(1==this._selectedItemInfoVo.num?App.CommonUtil.showTip(LanguageManager.getlocal("recoverLeftSuccess")):2==this._selectedItemInfoVo.num&&App.CommonUtil.showTip(LanguageManager.getlocal("equipSuccess")),this._curItemScrollItem&&this._curItemScrollItem.update()):(this._itemInfoVoList=Api.itemVoApi.getTitleVoListByType(1),this._curItemScrollItem&&this._curItemScrollItem.contains(this._selectedBg)&&this._curItemScrollItem.removeChild(this._selectedBg),this._scrollList.refreshData(this._itemInfoVoList),this._selectedItemInfoVo=this._itemInfoVoList[this._selectedIndex]),this.updateItem(this._selectedIndex)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(this.getNetRequestConst()),this.useCallback,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_ITEM,this.refresh,this),this._selectedIndex=null,this._selectedItemInfoVo&&(this._selectedItemInfoVo=null),this._selectedBg&&(this._selectedBg.parent&&this._selectedBg.parent.contains(this._selectedBg)&&this._selectedBg.parent.removeChild(this._selectedBg),BaseBitmap.release(this._selectedBg),this._selectedBg=null),this._selectedNameTextF&&(this._buttomContainer.removeChild(this._selectedNameTextF),this._selectedNameTextF.dispose(),this._selectedNameTextF=null),this._selectedIcon&&(this._buttomContainer.removeChild(this._selectedIcon),BaseBitmap.release(this._selectedIcon),this._selectedIcon=null),this._selectedIconBg&&(this._buttomContainer.removeChild(this._selectedIconBg),BaseBitmap.release(this._selectedIconBg),this._selectedIconBg=null),this._selectedDescTextF&&(this._buttomContainer.removeChild(this._selectedDescTextF),this._selectedDescTextF.dispose(),this._selectedDescTextF=null),this._selectedDropTextF&&(this._buttomContainer.removeChild(this._selectedDropTextF),this._selectedDropTextF.dispose(),this._selectedDropTextF=null),this._useBtn&&(this.removeChild(this._useBtn),this._useBtn.dispose(),this._useBtn=null),this._curItemScrollItem&&(this._curItemScrollItem=null),this._scrollList&&(this.removeChild(this._scrollList),this._scrollList.dispose(),this._scrollList=null),this._errorTF&&(this.removeChild(this._errorTF),this._errorTF.dispose(),this._errorTF=null),this._buttomContainer&&(this.removeChild(this._buttomContainer),this._buttomContainer.dispose(),this._buttomContainer=null),this._itemInfoVoList=null,this._curChooseScrollItem=null,t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(ItemViewTab3.prototype,"ItemViewTab3");var KRAgreementView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getResourceList=function(){var e=t.prototype.getResourceList.call(this);return e.concat(["public_9_wordbg","public_line3"])},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getBgName=function(){return"public_9_bg8"},e.prototype.initView=function(){var t=BaseBitmap.create("public_9_wordbg");t.height=750,t.setPosition(GameConfig.stageWidth/2-t.width/2,GameConfig.stageHeigth/2-t.height/2),this.addChild(t);var e=ComponentManager.getTextField("이용약관 및 개인정보 취급방침 동의",TextFieldConst.FONTSIZE_BUTTON_COMMON);e.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,e.x=GameConfig.stageWidth/2-e.width/2,e.y=t.y+30,this.addChild(e);var i=BaseBitmap.create("public_9_bg30");i.width=600,i.height=250,i.setPosition(20,t.y+70),this.addChild(i);var a=BaseBitmap.create("public_line3");a.width=480,a.x=GameConfig.stageWidth/2-a.width/2,a.y=i.y+20,this.addChild(a);var n=ComponentManager.getTextField("게임 이용 약관",TextFieldConst.FONTSIZE_BUTTON_COMMON);n.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,n.x=GameConfig.stageWidth/2-n.width/2,n.y=a.y-3,this.addChild(n),this._checkBox1=ComponentManager.getCheckBox("게임 이용 약관 동의"),this._checkBox1.setPosition(200,i.y+i.height+10),this._checkBox1.name="onekeyCheckBox",this.addChild(this._checkBox1),this._checkBox1.addTouchTap(this.selectHandler1,this);var o=BaseBitmap.create("public_9_bg30");o.width=600,o.height=250,o.setPosition(20,i.y+i.height+50),this.addChild(o);var s=BaseBitmap.create("public_line3");s.width=480,s.x=GameConfig.stageWidth/2-s.width/2,s.y=o.y+20,this.addChild(s);var r=ComponentManager.getTextField("개인 정보 취급 방침",TextFieldConst.FONTSIZE_BUTTON_COMMON);r.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,r.x=GameConfig.stageWidth/2-r.width/2,r.y=s.y-3,this.addChild(r),this._checkBox2=ComponentManager.getCheckBox("개인 정보 취급 방침 동의"),this._checkBox2.setPosition(200,o.y+o.height+10),this._checkBox2.name="onekeyCheckBox",this.addChild(this._checkBox2),this._checkBox2.addTouchTap(this.selectHandler2,this);var l=ResourceManager.getRes("kragreement").text1_1,h=ResourceManager.getRes("kragreement").text2,d=new BaseDisplayObjectContainer,g=ComponentManager.getTextField(l,TextFieldConst.FONTSIZE_CONTENT_SMALL);g.y=3,g.width=540,g.lineSpacing=5,d.addChild(g);var c=ResourceManager.getRes("kragreement").text1_2,p=ComponentManager.getTextField(c,TextFieldConst.FONTSIZE_CONTENT_SMALL);p.y=g.y+g.height+5,p.width=540,p.lineSpacing=5,d.addChild(p);var _=ResourceManager.getRes("kragreement").text1_3,u=ComponentManager.getTextField(_,TextFieldConst.FONTSIZE_CONTENT_SMALL);u.y=p.y+p.height+5,u.width=540,u.lineSpacing=5,d.addChild(u);var C=10,f=egret.Rectangle.create();f.setTo(0,0,g.width,180+C+5);var m=ComponentManager.getScrollView(d,f);this.addChild(m),m.setPosition((GameConfig.stageWidth-m.width)/2,i.y+40);var T=new BaseDisplayObjectContainer,y=ComponentManager.getTextField(h,TextFieldConst.FONTSIZE_CONTENT_SMALL);y.y=3,y.width=540,y.lineSpacing=5,T.addChild(y),T.height=y.height+6;var v=egret.Rectangle.create();v.setTo(0,0,y.width,180+C+5);var A=ComponentManager.getScrollView(T,v);this.addChild(A),A.setPosition((GameConfig.stageWidth-A.width)/2,o.y+40),this._callBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"callBtn",this.clickCallBtn,this),this._callBtn.x=GameConfig.stageWidth/2-this._callBtn.width/2,this._callBtn.y=this._checkBox2.y+this._checkBox2.height+10,this._callBtn.setText("확인",!1),this.addChild(this._callBtn),this._callBtn.setColor(TextFieldConst.COLOR_BLACK),this._callBtn.setEnable(!1)},e.prototype.selectHandler1=function(){this._checkBox1.checkSelected()&&this._checkBox2.checkSelected()?this._callBtn.setEnable(!0):this._callBtn.setEnable(!1)},e.prototype.selectHandler2=function(){this._checkBox1.checkSelected()&&this._checkBox2.checkSelected()?this._callBtn.setEnable(!0):this._callBtn.setEnable(!1)},e.prototype.clickCallBtn=function(){LocalStorageManager.set("isShowKRAgreement","true"),this.param.data.confirmCallback&&this.param.data.confirmCallback.apply(this.param.data.handler,[]),this.dispose()},e.prototype.touchTap=function(){this.hide()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseView);__reflect(KRAgreementView.prototype,"KRAgreementView");var MailDetailPopupView=function(t){function e(){var e=t.call(this)||this;return e._collectFlag=null,e._index=0,e._txtCountainer=null,e}return __extends(e,t),e.prototype.initView=function(){this._txtCountainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._txtCountainer),this._mailInfoVo=Api.mailVoApi.getMailInfoVoById(this.param.data.mid),this._index=Number(this.param.data.index);var t=40,e=BaseBitmap.create("public_9_bg4");e.width=520,e.height=600,e.x=this.viewBg.x+this.viewBg.width/2-e.width/2,e.y=10,this.addChildToContainer(e),this._bg=e;var i=ComponentManager.getTextField(LanguageManager.getlocal("title")+"："+this._mailInfoVo.title,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);i.x=t,i.y=30,this.addChildToContainer(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("time")+"："+this._mailInfoVo.timeStr,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);a.x=t,a.y=60,this.addChildToContainer(a);var n=410,o=this._mailInfoVo.touch;""==o&&(e.height=660,n=568);var s=BaseBitmap.create("public_9_bg1");s.width=496,s.height=n,s.x=this.viewBg.x+this.viewBg.width/2-s.width/2,s.y=a.y+a.height+10,this.addChildToContainer(s);var r;if(this._mailInfoVo.content){r=ComponentManager.getTextField(this._mailInfoVo.content,TextFieldConst.FONTSIZE_CONTENT_SMALL-2),r.x=0,r.y=5,r.width=s.width-20,r.lineSpacing=5,r.cacheAsBitmap=!0,r.touchEnabled=!0,this._txtCountainer.addChild(r);var l=new egret.Rectangle(0,0,s.width-20,390),h=ComponentManager.getScrollView(this._txtCountainer,l);h.x=50,h.y=100,this.addChildToContainer(h),h.height=n-20}if(""!=o){var d=GameData.formatRewardItem(this._mailInfoVo.touch);App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MAIL_GET_REWARDS),this.useCallback,this);var g=egret.Rectangle.create();d.length>5?(s.height-=100,g.setTo(0,0,s.width,200)):g.setTo(0,0,s.width,110);var c=new BaseDisplayObjectContainer;c.width=g.width,c.height=g.height,c.x=s.x+2,c.y=s.y+s.height+5,this.addChildToContainer(c),this._scrollList=ComponentManager.getScrollList(MailRewardScrollItem,d,g),c.addChild(this._scrollList)}if(1==this._mailInfoVo.istouch)if(0==this._mailInfoVo.hadget);else{var p=BaseBitmap.create("collectflag");p.setScale(.6),p.x=this.width/2-p.width/2*.6,p.y=GameConfig.stageHeigth/2+this.getShowHeight()/2-.6*p.height-10,this.addChild(p)}},e.prototype.clickConfirmHandler=function(t){NetManager.request(NetRequestConst.REQUEST_MAIL_GET_REWARDS,{mailId:this.param.data.mid})},e.prototype.getShowHeight=function(){return 750},e.prototype.getBgExtraHeight=function(){return""==this._mailInfoVo.touch?30:86},e.prototype.getConfirmBtnName=function(){return ButtonConst.BTN_NORMAL_YELLOW},e.prototype.getConfirmBtnStr=function(){return 1==this._mailInfoVo.istouch&&0==this._mailInfoVo.hadget?"taskCollect":""},e.prototype.useCallback=function(t){this._mailInfoVo=Api.mailVoApi.getMailInfoVoById(this.param.data.mid),this._mailInfoVo&&1==this._mailInfoVo.hadget&&this.playGetRewardAni()},e.prototype.playGetRewardAni=function(){this.setConfirmBtnVisible(!1),null==this._collectFlag&&(this._collectFlag=BaseBitmap.create("collectflag"),this._collectFlag.anchorOffsetX=this._collectFlag.width/2,this._collectFlag.anchorOffsetY=this._collectFlag.height/2,this._collectFlag.x=this.width/2,this._collectFlag.y=GameConfig.stageHeigth/2+this.getShowHeight()/2-.6*this._collectFlag.height*.5-10,this.addChild(this._collectFlag)),this._collectFlag.setScale(1.2),egret.Tween.get(this._collectFlag,{loop:!1}).to({scaleX:.6,scaleY:.6},400).wait(600);var t=GameData.formatRewardItem(this._mailInfoVo.touch);if(t){var e=new egret.Point(this._collectFlag.x,this._collectFlag.y-40);App.CommonUtil.playRewardFlyAction(t,e)}App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_MAIL_REFRESH,null)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MAIL_GET_DETAIL),this.useCallback,this),this._collectFlag=null,this._mailInfoVo=null,this._bg=null,this._scrollList=null,this._index=0,this._txtCountainer=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(MailDetailPopupView.prototype,"MailDetailPopupView");var MailPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_MAIL_DETAIL,this.clickItemHandler,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_MAIL_REFRESH,this.refreshList,this);var t=BaseBitmap.create("public_9_bg3");t.width=300,t.x=this.viewBg.x+this.viewBg.width/2-t.width/2,t.y=10,this.addChildToContainer(t);var e=BaseBitmap.create("public_9_bg4");if(e.width=520,e.height=612,e.x=this.viewBg.x+this.viewBg.width/2-e.width/2,e.y=t.y+t.height+10,this.addChildToContainer(e),this._mailNumTF=ComponentManager.getTextField(LanguageManager.getlocal("curMailNum",[Api.mailVoApi.getUnreadNum().toString(),Api.mailVoApi.getTotalNum().toString()]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._mailNumTF.x=this.viewBg.x+this.viewBg.width/2-this._mailNumTF.width/2,this._mailNumTF.y=t.y+t.height/2-this._mailNumTF.height/2,this.addChildToContainer(this._mailNumTF),this._mailInfoVoList=Api.mailVoApi.getMailInfoVoList(),this._mailInfoVoList&&this._mailInfoVoList.length>=1){var i=egret.Rectangle.create();i.setTo(0,0,e.width-10,e.height-20),this._scrollList=ComponentManager.getScrollList(MailScrollItem,this._mailInfoVoList,i),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(35,e.y+10)}else{var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_WHITE);a.text=LanguageManager.getlocal("mailNoDes"),a.x=230,a.y=300,this.addChildToContainer(a)}},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["mail_icon","mail_iconbg","mail_rewardicon"])},e.prototype.clickItemHandler=function(t){this._index=Number(t.data.index),this._mailId=Number(t.data.mailId);var e=Api.mailVoApi.getMailInfoVoById(this._mailId);e&&e.content&&e.isread?this.openMailDetail():(App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MAIL_GET_DETAIL),this.useCallback,this),NetManager.request(NetRequestConst.REQUEST_MAIL_GET_DETAIL,{mailId:this._mailId}))},e.prototype.refreshList=function(){var t=this._scrollList.getItemByIndex(this._index);t&&t.updateMailState()},e.prototype.useCallback=function(t){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MAIL_GET_DETAIL),this.useCallback,this);var e=this._scrollList.getItemByIndex(this._index);e.updateMailState(),this.openMailDetail()},e.prototype.openMailDetail=function(){ViewController.getInstance().openView(ViewConst.POPUP.MAILDETAILPOPUPVIEW,{mid:this._mailId,index:this._index})},e.prototype.getBgExtraHeight=function(){return 15},e.prototype.dispose=function(){this._mailInfoVoList=null,this._scrollList=null,this._mailNumTF=null,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_MAIL_REFRESH,this.refreshList,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_MAIL_DETAIL,this.clickItemHandler,this),t.prototype.dispose.call(this)},e}(PopupView);__reflect(MailPopupView.prototype,"MailPopupView");var MailRewardScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){var i=95,a=94,n=GameData.getItemIcon(e,!0);n.scaleX=i/n.width,n.scaleY=a/n.height,this.addChild(n),this.width=i+this.getSpaceX(),this.height=a+this.getSpaceY()},e.prototype.getSpaceX=function(){return 4.1},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(MailRewardScrollItem.prototype,"MailRewardScrollItem");var MailScrollItem=function(t){function e(){var e=t.call(this)||this;return e._selectedSp=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){this._selectedIndex=t,this._mailInfoVo=e;var i=498,a=144,n=BaseBitmap.create("public_9_bg35");this._bg=n,n.width=i,n.height=a,this.addChild(n),this._selectedSp=BaseBitmap.create("public_9_bg16"),this._selectedSp.width=i,this._selectedSp.height=a,this._selectedSp.x=this._bg.x+this._bg.width/2-this._selectedSp.width/2,this._selectedSp.y=this._bg.y+this._bg.height/2-this._selectedSp.height/2,this.addChild(this._selectedSp);var o=BaseBitmap.create("mail_iconbg");o.x=20,o.y=a/2-o.height/2,this.addChild(o);var s;s=this._mailInfoVo.istouch?BaseBitmap.create("mail_rewardicon"):BaseBitmap.create("mail_icon"),s.x=o.x+o.width/2-s.width/2,s.y=a/2-s.height/2,this.addChild(s),this._icon=s;var r=ComponentManager.getTextField(this._mailInfoVo.title,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);r.x=o.x+o.width+10,r.y=30,this.addChild(r),this._mailTitleTF=r;var l=ComponentManager.getTextField(this._mailInfoVo.timeStr,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);l.x=r.x,l.y=r.y+r.height+20,this.addChild(l),this.controlSelectedState(2),this.updateMailState(),this.addTouch(this.clickItemHandler,this,null,!0)},e.prototype.clickItemHandler=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._isBegin=!0,this.controlSelectedState(1),SoundManager.playEffect(SoundConst.EFFECT_CLICK);break;case egret.TouchEvent.TOUCH_END:this._isBegin&&(this._isBegin=!1,this.callbackHanler(),this.controlSelectedState(2));break;case egret.TouchEvent.TOUCH_CANCEL:this._isBegin=!1,this.controlSelectedState(2)}},e.prototype.controlSelectedState=function(t){if(this._bg){switch(t){case 1:this._selectedSp&&(this._selectedSp.visible=!0);break;case 2:this._selectedSp&&(this._selectedSp.visible=!1)}}},e.prototype.updateMailState=function(){this._mailInfoVo=Api.mailVoApi.getMailInfoVoById(this._mailInfoVo.mid),this._mailInfoVo.isread?this._icon&&(App.DisplayUtil.changeToGray(this._icon),this._mailTitleTF.setColor(TextFieldConst.COLOR_BROWN)):this._mailTitleTF.setColor(TextFieldConst.COLOR_WARN_GREEN2)},e.prototype.callbackHanler=function(t){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_MAIL_DETAIL,{mailId:this._mailInfoVo.mid,index:this._selectedIndex})},e.prototype.getSpaceY=function(){return 4},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.TYPE_UNREAD=1,e.TYPE_READ=2,e}(ScrollListItem);__reflect(MailScrollItem.prototype,"MailScrollItem");var AutoResPopupView=function(t){function e(){var e=t.call(this)||this;return e.typeCfg={1:"onhookDesc",2:"offlieDesc"},e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([])},e.prototype.getTypeLocalKey=function(){return this.typeCfg[this.param.data.type]},e.prototype.getTitleParams=function(){return[LanguageManager.getlocal(this.getTypeLocalKey())]},e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=520,t.height=224,t.setPosition((this.viewBg.width-t.width)/2,t.y+15),this.addChildToContainer(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("autoResPopupViewDesc",this.getTitleParams()),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);e.setPosition(t.x+(t.width-e.width)/2,t.y+20),this.addChildToContainer(e);var i=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"sysConfirm",this.hide,this);i.setPosition(t.x+(t.width-i.width)/2,t.y+t.height+20),this.addChildToContainer(i);var a=0;0!=Api.manageVoApi.getAutoGold()&&(this.getResIcon("gold",a),a++),0!=Api.manageVoApi.getAutoFood()&&(this.getResIcon("food",a),a++),0!=Api.manageVoApi.getAutoSoldier()&&(this.getResIcon("soldier",a),a++)},e.prototype.getResIcon=function(t,e){var i=BaseBitmap.create("public_resnumbg");i.setPosition(200,80+50*e),this.addChildToContainer(i);var a,n;"gold"==t?(a="public_icon2",n=Api.manageVoApi.getAutoGold()):"food"==t?(a="public_icon3",n=Api.manageVoApi.getAutoFood()):"soldier"==t&&(a="public_icon4",n=Api.manageVoApi.getAutoSoldier());var o=BaseBitmap.create(a);o.setPosition(i.x,i.y+(i.height-o.height)/2-3),this.addChildToContainer(o);var s=ComponentManager.getTextField(n.toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL);s.setPosition(o.x+o.width,i.y+(i.height-s.height)/2),this.addChildToContainer(s)},e}(PopupView);__reflect(AutoResPopupView.prototype,"AutoResPopupView");var ManageView=function(t){function e(){var e=t.call(this)||this;return e._manageItemList=[],e._isFirstRequest=!0,e.isRefreshing=!1,e._luckBoo=!1,e._luckysArr=[],e.posCfg={},e._num1=0,e._num2=0,e._num3=0,e._manageSoldierNums=[],e._isCfgInit=!1,e}return __extends(e,t),e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_MANAGE_GETAUTOANDFINANCE,requestData:{}}},e.prototype.receiveData=function(t){t.data&&t.data.cmd==NetRequestConst.REQUEST_MANAGE_GETAUTOANDFINANCE&&(this.isRefreshing=!1,t.data.data&&t.data.data.autoRes?Api.manageVoApi.formatAutoRes(t.data.data.autoRes):Api.manageVoApi.resetAutoRes(),this._isFirstRequest&&Api.switchVoApi.checkAutoResManage()&&Api.manageVoApi.checkAndShowAutoReward("1"),this.isLoaded&&this.refresh()),this._isFirstRequest&&(this._isFirstRequest=!1)},e.prototype.initCfg=function(){if(0==this._isCfgInit){var t=Config.SceneCfg.getSceneCfgBySceneName("manageScene");this._isCfgInit=!0,t&&t.posCfg&&(this.posCfg=t.posCfg)}},e.prototype.initView=function(){this.initCfg(),e.ONEKEY_BOO=!1,App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_SHOWHAND,this.showHand,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_DEALFINANCE),this.refreshBtn,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_ADDFINANCE),this.refreshBtn,this),SoundManager.playEffect("effect_servant_1001"),Api.rookieVoApi.checkNextStep(),this.container.setPosition(this.container.x,this.getTitleButtomY());var t=BaseBitmap.create("managebg");t.setPosition(0,GameConfig.stageHeigth-t.height),this.addChildAt(t,this.getChildIndex(this.container));var i=BaseBitmap.create("public_bg6");this.addChildToContainer(i);var a=Api.manageVoApi.getManageItemsVo(),n=a.length;if(Api.practiceVoApi.isPlayerPracticeEnable()){var o=BaseBitmap.create("manage_buildingpractice"),s=this.posCfg.practice;o.setPosition(t.x+s.x,t.y+s.y),this.addChildAt(o,this.getChildIndex(t)+1),Api.practiceVoApi.isPracticeBuildingUnlock()&&(n=4)}for(var r=0;n>r;r++)this.getResIcons(r,this.container,i);var l=i.y+i.height+10+20;if(Number(Config.ManageCfg.getCrit[0])*Config.ManageCfg.getCrit[1]>0){var h=100*Config.ManageCfg.getCrit[0]+"%",d=[h,Config.ManageCfg.getCrit[1].toString()],g=ComponentManager.getTextField(LanguageManager.getlocal("manageViewDesc1",d),TextFieldConst.FONTSIZE_CONTENT_SMALL);g.setPosition(10,i.y+i.height+10),this.addChildToContainer(g),l=g.y+g.height}var c=new BaseDisplayObjectContainer,p=0;c.setPosition(0,l+5);for(var _=void 0,r=0;n>r;r++){var u=new ManageItem(r);u.setPosition(this.posCfg[u.getType()].x,this.posCfg[u.getType()].y-c.y-this.container.y+t.y),u.bindCallback(this.updateResNum,this,[r]),0==r&&(_=u),r==n-1?c.addChildAt(u,c.getChildIndex(_)):c.addChild(u),p=u.y+u.height,this._manageItemList.push(u),Api.rookieVoApi.isInGuiding||Api.mainTaskVoApi.getCurMainTaskId()!=(r+1).toString()||Api.mainTaskVoApi.isCurTaskReach()||(e._taskHand=BaseBitmap.create("guide_hand"),e._taskHand.x=u.x+100,e._taskHand.y=u.y+70,c.addChild(e._taskHand),egret.Tween.get(e._taskHand,{loop:!0}).to({y:e._taskHand.y+35,scaleX:1.3,scaleY:1.3},500).to({y:e._taskHand.y,scaleX:1,scaleY:1},500))}this.addChildToContainer(c);var C=BaseBitmap.create("arena_bottom");if(C.y=GameConfig.stageHeigth-this.container.y-C.height,this.addChildToContainer(C),Api.switchVoApi.checkAutoResManage()){var f=BaseBitmap.create("public_9_bg23");this.addChildToContainer(f);var m=ComponentManager.getTextField(LanguageManager.getlocal("manageReachUnlockDesc",[egret.toColorString(TextFieldConst.COLOR_QUALITY_ORANGE),LanguageManager.getlocal("vipDesc")+Config.ManageCfg.needVip,egret.toColorString(TextFieldConst.COLOR_WARN_GREEN2),LanguageManager.getlocal("officialTitle"+Config.ManageCfg.needLv)]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);if(m.setPosition(20,GameConfig.stageHeigth-this.container.y-m.height-30),this.addChildToContainer(m),f.width=GameConfig.stageWidth-20,f.height=m.height+20,f.setPosition(m.x-10,m.y-10),0==Api.manageVoApi.checkAutoRes()){var T=ComponentManager.getButton(ButtonConst.BTN_RECHARGE,"sysRecharge",function(){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},this);T.setPosition(c.width-T.width-70,m.y+(m.height-T.height)/2),this.addChildToContainer(T),m.width=T.x-2*m.x,f.width=m.width+20,Api.switchVoApi.checkClosePay()&&(T.visible=!1)}}if(Api.playerVoApi.getPlayerLevel()>=Config.ManageCfg.autoNeedLv){var y=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"onekeymanageBtn",this.onekeyManageHandler,this);y.setPosition(GameConfig.stageWidth-y.width-20,GameConfig.stageHeigth-155),this._onekeyManage_btn=y,this.addChildToContainer(y)}else{var v=ComponentManager.getTextField("0",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);v.text=LanguageManager.getlocal("manageDes"),this.addChildToContainer(v),v.setPosition(380,GameConfig.stageHeigth-140)}this.refreshBtn()},e.prototype.refreshBtn=function(){var t=Api.manageVoApi.isOnekeyManage();this._onekeyManage_btn&&(0==t?App.DisplayUtil.changeToNormal(this._onekeyManage_btn):App.DisplayUtil.changeToGray(this._onekeyManage_btn))},e.prototype.onekeyManageHandler=function(){var t=Api.manageVoApi.isOnekeyManage();if(0==t)App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_BATCHDEALFINANCE),this.refreshHandler,this),NetManager.request(NetRequestConst.REQUEST_MANAGE_BATCHDEALFINANCE,{});else if(1==t){if(Api.manageVoApi.getReapSoldier()<1)return void App.CommonUtil.showTip(LanguageManager.getlocal("manageNoEnoughFoodMsg"))}else App.CommonUtil.showTip(LanguageManager.getlocal("manageDes2"))},e.prototype.refreshHandler=function(t){if(t.data.data.data){e.ONEKEY_BOO=!0;var i=t.data.data.data,a=void 0;if(i.luckys&&i.luckys[0]?(this._luckBoo=!0,this._luckysArr=i.luckys):this._luckBoo=!1,i.type1Num>0){a="public_icon2";var n=0;this._num1=i.type1Num,this.playManageAnimation(i.type1Num,a,n)}if(i.type2Num>0){this._num2=i.type2Num,a="public_icon3";var n=1;this.playManageAnimation(i.type2Num,a,n)}if(i.type3Num>0){this._num3=i.type3Num,this._manageSoldierNums=i.manageSoldierNums,a="public_icon4";var n=2;Api.manageVoApi.getReapSoldier().toString();this.playManageAnimation(i.type3Num,a,n)}this.refresh()}},e.prototype.playManageAnimation=function(t,i,a){void 0===i&&(i=""),void 0===a&&(a=0);var n=this._manageItemList[a].getManageBtnPoint();App.CommonUtil.showCollectEffect(i,n,e.flyEndPoint[a],function(){0==a?this.updateResNum(a,t,this._luckBoo,!0):this.updateResNum(a,t,this._luckBoo,!1)},this)},e.prototype.playLucky=function(){var t=BaseBitmap.create("manage_boomtext");t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2;var e=500,i=250;t.setPosition(e,i),LayerManager.msgLayer.addChild(t),egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},70).to({y:i-50,alpha:.7},600).call(function(t){t.dispose()}.bind(this,t),this),App.CommonUtil.showGodbless("manage")},e.prototype.getResIcons=function(t,i,a){var n="public_resnumbg",o=220;Api.practiceVoApi.isPlayerPracticeEnable()&&(n="public_9_resbg",o=160);var s=BaseBitmap.create(n);s.setPosition(20+t*o,a.y+(a.height-s.height)/2),i.addChild(s);var r,l,h;0==t?(r="public_icon2",l=Api.playerVoApi.getPlayerGold(),h="gold"):1==t?(r="public_icon3",l=Api.playerVoApi.getFood(),h="food"):2==t?(r="public_icon4",l=Api.playerVoApi.getSoldier(),h="soldier"):3==t&&(r="public_icon12",l=Api.practiceVoApi.geExp(),h="practice");var d=BaseBitmap.create(r);d.setPosition(s.x,s.y+(s.height-d.height)/2-3),i.addChild(d);var g=ComponentManager.getTextField(l.toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL);g.setPosition(d.x+d.width,s.y+(s.height-g.height)/2),i.addChild(g),this["_"+h+"NumText"]=g,e.flyEndPoint.length<1&&egret.callLater(function(){e.flyEndPoint.push(s.localToGlobal(0,0))},this)},e.prototype.updateResNum=function(t,i,a,n){var o=this;if(this._foodNumText){if(isNaN(t))this._goldNumText.text=Api.playerVoApi.getPlayerGold().toString(),this._soldierNumText.text=Api.playerVoApi.getSoldier().toString();else{var s="practoce";if(3!=t){var r=Api.manageVoApi.getManageItemsVo();s=r[t].type}var l=this["_"+s+"NumText"];if(l){var h=void 0;0==t?h="itemicon2":1==t?h="itemicon3":2==t?h="itemicon4":3==t&&(h="public_icon12");var d=Number(l.text);"practice"==s&&(l.text=""+Api.practiceVoApi.geExp()),"gold"==s?l.text=Api.playerVoApi.getPlayerGold().toString():l.text=Api.playerVoApi["get"+App.StringUtil.firstCharToUper(s)]().toString();var g=0;if(g=isNaN(i)?Number(l.text)-d:i,a&&(g=Math.floor(g/Config.DailyluckCfg.getManageTimes()),n&&this._luckysArr.length>=1))var c=0,p=this,_=egret.setInterval(function(){c+=1,o.playLucky(),c>=o._luckysArr.length&&egret.clearInterval(_)},p,1500,1);var u=Number(g)>0?"+"+g:String(g),C=new Array;if(a&&0==t){C=[];var f=Api.manageVoApi.getReapGold().toString();if(this._luckysArr&&this._luckysArr.length>=1){for(var t=0;t<this._luckysArr.length;t++)for(var m=0;m<this._luckysArr[t];m++)C.push({icon:h,tipMessage:f});for(var T=0;T<this._num1;T++)C.push({icon:h,tipMessage:f})}else if(a){C=[];for(var y=Api.manageVoApi.getReapGold().toString(),m=0;10>m;m++)C.push({icon:h,tipMessage:y})}}else if(C=[],1==e.ONEKEY_BOO){var v="";if(0==t){v=Api.manageVoApi.getReapGold().toString();for(var m=0;m<this._num1;m++)C.push({icon:h,tipMessage:v})}if(1==t){v=Api.manageVoApi.getReapFood().toString();for(var m=0;m<this._num2;m++)C.push({icon:h,tipMessage:v})}else if(2==t)for(var m=0;m<this._num3;m++)this._manageSoldierNums[m]&&(v=this._manageSoldierNums[m].toString()),C.push({icon:h,tipMessage:v});else 3==t&&(v=""+i,C.push({icon:h,tipMessage:v}))}else C.push({icon:h,tipMessage:u});App.CommonUtil.playRewardFlyAction(C,l.localToGlobal(l.width/2,0),600)}}this._foodNumText.text=Api.playerVoApi.getFood().toString()}},e.prototype.refresh=function(){this.updateResNum();for(var t=this._manageItemList.length,e=0;t>e;e++)this._manageItemList[e].refresh();Api.manageVoApi.isOnekeyManage();this._onekeyManage_btn&&this.refreshBtn()},e.prototype.tick=function(){for(var t=this._manageItemList.length,e=0;t>e;e++){var i=this._manageItemList[e].tick();if(i&&0==this.isRefreshing){this.isRefreshing=!0;
var a=this.getRequestData();this.request(a.requestType,a.requestType)}}},e.prototype.hide=function(){Api.rookieVoApi.isInGuiding&&Api.rookieVoApi.checkNextStep(),t.prototype.hide.call(this)},e.prototype.showHand=function(){this._clickHand=BaseBitmap.create("guide_hand"),this._clickHand.skewY=180,this._clickHand.x=620,this._clickHand.y=50,this.addChild(this._clickHand),egret.Tween.get(this._clickHand,{loop:!0}).to({scaleX:.9,scaleY:.9},500).to({scaleX:1,scaleY:1},500)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["guide_hand","manage_foodname","manage_goldname","manage_namebg","manage_soldiername","btn_manage_normal_down","manage_boomtext","btn_manage_normal","btn_manage_red","btn_manage_red_down","arena_bottom","guide_hand","manage_recoverytxt","manage_managetxt","manage_waittime","managebg","manage_buildingpractice","manage_practicename","public_icon12","manage_practice_collect","manage_practice_full"])},e.prototype.dispose=function(){this._clickHand&&(egret.Tween.removeTweens(this._clickHand),this._clickHand=null),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_SHOWHAND,this.showHand,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_BATCHDEALFINANCE),this.refreshHandler,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_DEALFINANCE),this.refreshBtn,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_ADDFINANCE),this.refreshBtn,this),this._soldierNumText=null,this._goldNumText=null,this._foodNumText=null,this._isFirstRequest=!0,this.isRefreshing=!1,this._manageItemList.length=0,this._onekeyManage_btn=null,this._luckBoo=!1,this._luckysArr=[],this._num3=0,this._num2=0,this._num1=0,this._manageSoldierNums=[],e._taskHand=null,this._clickHand=null,this._isCfgInit=!1,t.prototype.dispose.call(this)},e.flyEndPoint=[],e.ONEKEY_BOO=!1,e}(CommonView);__reflect(ManageView.prototype,"ManageView");var ManageItem=function(t){function e(e){var i=t.call(this)||this;return i.init(e),i}return __extends(e,t),e.prototype.bindCallback=function(t,e,i){this._bindCallback=t,this._bindCallbackThisObj=e,this._bindCallbackParams=i},e.prototype.init=function(t){if(this.addTouch(this.onNPCTouchHandler,this,null,!0),this._index=t,3==this._index)App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_COLLECT),this.refresh,this);else{App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_DEALFINANCE),this.refresh,this);var e=NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_ADDFINANCE);App.MessageHelper.addEventListener(e,this.refresh,this)}this._manageItemVo||(this._index<3?this._manageItemVo=Api.manageVoApi.getManageItemsVo()[t]:(this._manageItemVo=new ManageItemVo,this._manageItemVo.type="practice",this._manageItemVo.num=Api.practiceVoApi.getStorageInfo().num));var i=BaseLoadBitmap.create("managenpc"+this._manageItemVo.type);i.setScale(4),i.alpha=0,i.addTouchTap,this.addChild(i),this._npc=i;var a=BaseBitmap.create("public_9_manageinfo");a.setPosition(0,130),2==t&&a.setPosition(-40,120),3==t&&a.setPosition(20,100),this.addChild(a);var n=BaseBitmap.create("manage_namebg");n.setPosition(a.x-5,a.y-2),this.addChild(n);var o="manage_"+this._manageItemVo.type+"name",s=BaseBitmap.create(o);s.setPosition(n.x+(n.width-s.width)/2,n.y+(n.height-s.height)/2-5),this.addChild(s);var r=10;a.height=76;var l,h=0;0==t?l=Api.playerVoApi.getInte().toString():1==t?l=Api.playerVoApi.getPolitics().toString():2==t?l=Api.playerVoApi.getCharm().toString():3==t&&(l="");var d=ComponentManager.getTextField(LanguageManager.getlocal("manage"+this._manageItemVo.type+"CurName",[l]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);d.setPosition(a.x+n.width,a.y+r+5),this.addChild(d),d.width>h&&(h=d.width),this._curText=d;var g,c=[];0==t?(c.push(Api.manageVoApi.getReapGold().toString()),g=LanguageManager.getlocal("manageWillGetRes",c)):1==t?(c.push(Api.manageVoApi.getReapFood().toString()),g=LanguageManager.getlocal("manageWillGetRes",c)):2==t?(c.push(Api.manageVoApi.getReapSoldier().toString()),g=LanguageManager.getlocal("manageWillGetSoldier",c)):3==t&&(c.push(""),g=""+Api.practiceVoApi.getspd());var p=ComponentManager.getTextField(g,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN);if(p.setPosition(d.x,d.y+d.height+r),this.addChild(p),this._willText=p,p.width>h&&(h=p.width),2==t){var _=ComponentManager.getTextField(LanguageManager.getlocal("manageCostFood",[Api.manageVoApi.getNeedFood().toString()]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_RED);_.setPosition(d.x,p.y+p.height+r),this.addChild(_),this._needText=_,_.width>h&&(h=_.width),a.height=105}3==t&&(p.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,p.x=d.x+d.width/2-p.width/2),a.width=h+n.width+15;var u=ComponentManager.getButton("btn_manage_normal","",function(){},this,[t]);this._manageBtn=u;var C=new BaseDisplayObjectContainer;C.addChild(u),u.setPosition(-u.width/2,-u.height),C.setPosition(a.x+a.width/2,30),this.addChild(C),this._btnContainer=C;var f=BaseBitmap.create("manage_waittime");f.setPosition(C.x-u.width/2-30,u.y+u.height+20),this.addChild(f),this._waitTimeBg=f,this._leftTimeText=ComponentManager.getTextField(this._manageItemVo.num+"/"+this._manageItemVo.maxNum,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this._leftTimeText.setPosition(f.x+55,f.y+(f.height-this._leftTimeText.height)/2+1),this.addChild(this._leftTimeText),this.setManageStatus(),this.tick()},e.prototype.setManageStatus=function(){if(3==this._index){this._waitTimeBg.visible=!1,this._leftTimeText.visible=!1,this._btnContainer&&"add"!=this._btnContainer.name&&(egret.Tween.removeTweens(this._btnContainer),this._btnContainer.name="add",this._btnContainer.setScale(1),this._btnContainer.rotation=0,egret.Tween.get(this._btnContainer,{loop:!0}).to({rotation:10},100).to({rotation:-8},200).to({rotation:5},130).to({rotation:-3},80).to({rotation:0},30).wait(500));var t="manage_practice_collect";return Api.practiceVoApi.isStoregeFull()&&(t="manage_practice_full"),void(this._manageStatusBmp||(this._manageStatusBmp=BaseBitmap.create(t),this._manageStatusBmp.x=this._manageBtn.width/2-this._manageStatusBmp.width/2,this._manageStatusBmp.y=this._manageBtn.height/2-this._manageStatusBmp.height/2-5,this._manageBtn.addChild(this._manageStatusBmp)))}var e;this._manageItemVo.num>0?(this._btnContainer&&"add"!=this._btnContainer.name&&(egret.Tween.removeTweens(this._btnContainer),this._btnContainer.name="add",this._btnContainer.setScale(1),this._btnContainer.rotation=0,egret.Tween.get(this._btnContainer,{loop:!0}).to({rotation:10},100).to({rotation:-8},200).to({rotation:5},130).to({rotation:-3},80).to({rotation:0},30).wait(500)),e="manage_managetxt",this._waitTimeBg&&(this._waitTimeBg.visible=!1,this._leftTimeText.visible=!1),this._btnRedBtn&&(this._btnRedBtn.visible=!1)):(ManageView._taskHand&&(ManageView._taskHand.visible=!1),this._btnContainer&&"scale"!=this._btnContainer.name&&(egret.Tween.removeTweens(this._btnContainer),this._btnContainer.name="scale",this._btnContainer.setScale(1),this._btnContainer.rotation=0,egret.Tween.get(this._btnContainer,{loop:!0}).to({scaleX:1.05,scaleY:1.05},500).to({scaleX:.95,scaleY:.95},1e3).to({scaleX:1,scaleY:1},300)),this._waitTimeBg&&(this._waitTimeBg.visible=!0,this._leftTimeText.visible=!0),e="manage_recoverytxt",this._btnRedBtn?this._btnRedBtn.visible=!0:(this._btnRedBtn=ComponentManager.getButton("btn_manage_red","",function(){},this),this._manageBtn.addChildAt(this._btnRedBtn,1))),this._manageStatusBmp?this._manageStatusBmp.texture=ResourceManager.getRes(e):(this._manageStatusBmp=BaseBitmap.create(e),this._manageBtn.addChild(this._manageStatusBmp)),this._manageItemVo.num>0?this._manageStatusBmp.setPosition((this._manageBtn.width-this._manageStatusBmp.width)/2+2,45):this._manageStatusBmp.setPosition((this._manageBtn.width-this._manageStatusBmp.width)/2+2,30),this._leftNumText?this._leftNumText.text=this._manageItemVo.num+"/"+this._manageItemVo.maxNum:(this._leftNumText=ComponentManager.getTextField(this._manageItemVo.num+"/"+this._manageItemVo.maxNum,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN),this._manageBtn.addChild(this._leftNumText)),this._leftNumText.setPosition((this._manageBtn.width-this._leftNumText.width)/2+2,this._manageStatusBmp.y-this._leftNumText.height+2),this._leftNumText.visible=this._manageItemVo.num>0},e.prototype.onNPCTouchHandler=function(t){(t.type==egret.TouchEvent.TOUCH_BEGIN||t.type==egret.TouchEvent.TOUCH_CANCEL||t.type==egret.TouchEvent.TOUCH_END)&&(t.type==egret.TouchEvent.TOUCH_BEGIN?this._npc.alpha=.3:t.type==egret.TouchEvent.TOUCH_CANCEL&&(this._npc.alpha=0),t.type==egret.TouchEvent.TOUCH_END&&(this._npc.alpha=0,this.manageHandler(this._index)))},e.prototype.getManageBtnPoint=function(){var t=new egret.Point;return this._manageBtn&&(t=this._manageBtn.localToGlobal(this._manageBtn.width/2,this._manageBtn.height/2)),t},e.prototype.tick=function(){if(3==this._index){if(this._manageStatusBmp){var t="manage_practice_collect";Api.practiceVoApi.isStoregeFull()&&(t="manage_practice_full"),this._manageStatusBmp.texture=ResourceManager.getRes(t)}return!0}if(this._manageItemVo.need_time>0){if(this._manageItemVo.num<1){var e=Math.max(0,this._manageItemVo.need_time+this._manageItemVo.st-GameData.serverTime);e>=0&&(this._leftTimeText.text=App.DateUtil.getFormatBySecond(e))}if(GameData.serverTime-this._manageItemVo.need_time-this._manageItemVo.st>=0){var i=!1;return i=this._manageItemVo.num>=this._manageItemVo.maxNum?Api.manageVoApi.checkAutoRes()?!0:!1:!0}}return!1},e.prototype.refresh=function(t){if(t)if(t.type==NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_DEALFINANCE)&&e._selectIndex==this._index){Api.rookieVoApi.checkNextStep();var i=void 0,a=500,n=0;0==this._index?(i="public_icon2",n=350):1==this._index?(i="public_icon3",n=580):2==this._index&&(i="public_icon4",n=820);var o=t.data?t.data.data:null;o&&o.data&&(o=o.data);var s=[];if(this._bindCallbackParams&&(s=s.concat(this._bindCallbackParams),o&&s.push(o.typeNum)),o&&o.lucky){s.push(!0);var r=BaseBitmap.create("manage_boomtext");r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,r.setPosition(a,n),LayerManager.msgLayer.addChild(r),egret.Tween.get(r).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},70).to({y:n-50,alpha:.7},600).call(function(t){t.dispose()}.bind(this,r),this),App.CommonUtil.showGodbless("manage")}App.CommonUtil.showCollectEffect(i,this._manageBtn.localToGlobal(this._manageBtn.width/2,this._manageBtn.height/2),ManageView.flyEndPoint[this._index],this._bindCallback,this._bindCallbackThisObj,s)}else if(t.type==NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_ADDFINANCE));else if(t.type==NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_COLLECT)){egret.log("practice collect >>>>>>>>>");var i="public_icon12",s=[];this._bindCallbackParams&&(s=s.concat(this._bindCallbackParams));var l=t.data.data.expnum;s.push(l),App.CommonUtil.showCollectEffect(i,this._manageBtn.localToGlobal(this._manageBtn.width/2,this._manageBtn.height/2),ManageView.flyEndPoint[this._index],this._bindCallback,this._bindCallbackThisObj,s)}var h=(t?t.data:{ret:!0}).ret,d=t?t.type:null;if(h&&3!=this._index){if(d!=NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_DEALFINANCE)){var l=Api.manageVoApi["getAuto"+App.StringUtil.firstCharToUper(Api.manageVoApi.getManageItemsVo()[this._index].type)]();if(l>0){var i=void 0;0==this._index?i="public_icon2":1==this._index?i="public_icon3":2==this._index&&(i="public_icon4");var s=[];this._bindCallbackParams&&(s=s.concat(this._bindCallbackParams)),s.push(l),App.CommonUtil.showCollectEffect(i,this._manageBtn.localToGlobal(this._manageBtn.width/2,this._manageBtn.height/2),ManageView.flyEndPoint[this._index],this._bindCallback,this._bindCallbackThisObj,s)}}if(this._manageItemVo.num>0)this._leftTimeText.text=this._manageItemVo.num+"/"+this._manageItemVo.maxNum;else{var g=Math.max(0,this._manageItemVo.need_time+this._manageItemVo.st-GameData.serverTime);this._leftTimeText.text=App.DateUtil.getFormatBySecond(g)}var c="";0==this._index?c=Api.playerVoApi.getInte().toString():1==this._index?c=Api.playerVoApi.getPolitics().toString():2==this._index&&(c=Api.playerVoApi.getCharm().toString()),this._curText.text=LanguageManager.getlocal("manage"+this._manageItemVo.type+"CurName",[c]);var p=void 0,_=[];if(0==this._index?(_.push(Api.manageVoApi.getReapGold().toString()),p=LanguageManager.getlocal("manageWillGetRes",_)):1==this._index?(_.push(Api.manageVoApi.getReapFood().toString()),p=LanguageManager.getlocal("manageWillGetRes",_)):2==this._index&&(_.push(Api.manageVoApi.getReapSoldier().toString()),p=LanguageManager.getlocal("manageWillGetSoldier",_)),this._willText.text=p,this._needText){var u=Math.min(Api.manageVoApi.getNeedFood(),Api.playerVoApi.getFood());this._needText.text=LanguageManager.getlocal("manageCostFood",[u.toString()])}this.setManageStatus()}},e.prototype.recoveryHandler=function(t){var e=Api.manageVoApi.getNeedItem(),i=Api.itemVoApi.getItemNumInfoVoById(Number(e));if(i>0)if(5>i)NetManager.request(NetRequestConst.REQUEST_MANAGE_ADDFINANCE,{type:this._index+1,num:1});else{var a=this._manageItemVo.maxNum;ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSEPOPUPVIEW,{itemId:e,maxNum:a,callback:this.usePropHandler,handler:this})}else ViewController.getInstance().openView(ViewConst.POPUP.ITEMJUMPPOPUPVIEW,{itemId:e,callback:null,handler:this})},e.prototype.usePropHandler=function(t){NetManager.request(NetRequestConst.REQUEST_MANAGE_ADDFINANCE,{type:this._index+1,num:t})},e.prototype.manageHandler=function(t){if(3==this._index)return void(Api.practiceVoApi.isCollectEnable()&&NetManager.request(NetRequestConst.REQUEST_REQUEST_COLLECT,{}));if(this._manageItemVo.num<1)this.recoveryHandler(t);else{if(2==t&&Api.manageVoApi.getReapSoldier()<1)return void App.CommonUtil.showTip(LanguageManager.getlocal("manageNoEnoughFoodMsg"));e._selectIndex=t,ManageView.ONEKEY_BOO=!1,NetManager.request(NetRequestConst.REQUEST_MANAGE_DEALFINANCE,{type:t+1})}},e.prototype.getType=function(){return this._manageItemVo?this._manageItemVo.type:null},e.prototype.dispose=function(){this._manageItemVo=null,this._leftTimeText=null,this._curText=null,this._willText=null,this._needText=null,this._manageBtn=null,this._index=0/0,this._bindCallback=null,this._bindCallbackThisObj=null,this._bindCallbackParams=null,App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_DEALFINANCE),this.refresh,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_MANAGE_ADDFINANCE),this.refresh,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_COLLECT),this.refresh,this),ManageView.ONEKEY_BOO=!1,this._manageStatusBmp=null,this._leftNumText=null,this._npc=null,this._waitTimeBg=null,this._btnContainer=null,this._btnRedBtn=null,t.prototype.dispose.call(this)},e._selectIndex=-1,e}(BaseDisplayObjectContainer);__reflect(ManageItem.prototype,"ManageItem");var PalaceCrossView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initPosCfg=function(){this._posList=[{x:141,y:281,width:280,heigh:200,shadowId:6,flagId:5},{x:78,y:579,width:170,heigh:100,shadowId:7,flagId:5},{x:372,y:579,width:170,heigh:100,shadowId:7,flagId:5},{x:64,y:742,width:170,heigh:100,shadowId:7,flagId:5},{x:389,y:742,width:170,heigh:100,shadowId:7,flagId:5},{x:49,y:890,width:170,heigh:100,shadowId:7,flagId:5},{x:407,y:890,width:170,heigh:100,shadowId:7,flagId:5}]},e.prototype.getStartIdx=function(){return 0},e.prototype.getCorssBtnPath=function(){return"palacve_backBtn"},e.prototype.crossBtnHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.PALACEVIEW),this.hide()},e.prototype.getBgRes=function(){return"palace_bg3"},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["palace_bg3","palace_shadow6","palace_shadow7","palace_building_flag5"])},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_PALACE_GETCROSSPALACE,requestData:{}}},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(PalaceView);__reflect(PalaceCrossView.prototype,"PalaceCrossView");var PalaceHouseGroupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var t=this.param.data.buildingId,e=GameConfig.config.buildingCfg[t].title,i=[];for(var a in e){var n=e[a];Api.palaceVoApi.getRoleInfoByTitleId(n)&&i.push(n)}var o=new egret.Rectangle(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-this.container.y),s=ComponentManager.getScrollList(PalaceRoleInfoItem2,i,o);s.y=-10,this._nodeContainer.addChild(s)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["palace_perbg"])},e.prototype.getTitleStr=function(){return"palace_buildingName"+this.param.data.buildingId},e.prototype.dispose=function(){this._nodeContainer=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(PalaceHouseGroupView.prototype,"PalaceHouseGroupView");var PalaceHouseView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getTitleStr=function(){return"palace_buildingName"+this.param.data.buildingId},e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_PALACE_GETSALARY),this.collectBtnClickHandlerCallback,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer),this._curTitleId=this.param.data.titleId;var t=BaseBitmap.create("palace_bg");t.y=GameConfig.stageHeigth-this.container.y-t.height,this._nodeContainer.addChild(t),this._curRoleImg=new PalaceRoleInfoItem,this._curRoleImg.y=50,this._curRoleImg.x=GameConfig.stageWidth/2-this._curRoleImg.width/2,this._curRoleImg.visible=!1,this._nodeContainer.addChild(this._curRoleImg);var e=GameConfig.stageHeigth-110-this.container.y;if(!Api.switchVoApi.checkOpenShenhe()){var i=ComponentManager.getButton(this.getHisBtnPath(),"",this.hisBtnClickHandler,this);i.x=-5,i.y=e-30,this._nodeContainer.addChild(i)}var a=BaseBitmap.create("palace_rewardbg");a.width=300,a.x=GameConfig.stageWidth/2-a.width/2,a.y=e,this._nodeContainer.addChild(a),this._palace_rewardbg=a;var n=ComponentManager.getTextField("",22,TextFieldConst.COLOR_LIGHT_YELLOW),o=Config.LevelCfg.getCfgByLevel(String(Api.playerVoApi.getPlayerLevel())).gem;if(n.text=LanguageManager.getlocal("palace_reward",[String(o)]),n.x=GameConfig.stageWidth/2-n.width/2,n.y=a.y+a.height/2-n.height/2,this._nodeContainer.addChild(n),0==Api.otherInfoVoApi.getPalaceFlag()){var s=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"",this.collectBtnClickHandler,this);s.x=GameConfig.stageWidth/2-s.width/2,s.y=a.y-s.height/2-40,this._nodeContainer.addChild(s),this._collectBtn=s}else{var r=BaseBitmap.create("palace_collectflag");r.setScale(.7),r.anchorOffsetX=r.width/2,r.x=GameConfig.stageWidth/2,r.y=a.y-r.height/2-30,this._nodeContainer.addChild(r)}this._editBtn=ComponentManager.getButton("palace_editBtn","",this.editBtnClickHandler,this),this._editBtn.x=GameConfig.stageWidth-this._editBtn.width-20,this._editBtn.y=e-15,this._editBtn.visible=!1,this._nodeContainer.addChild(this._editBtn),this.palaceInfoHandlerCallback()},e.prototype.getHisBtnPath=function(){var t=Number(this._curTitleId),e=Config.TitleCfg.getTitleCfgById(t);return 1==e.isCross?"palace_hisBtn1":"palace_hisBtn2"},e.prototype.palaceInfoHandlerCallback=function(){var t=this._curTitleId,e=Api.palaceVoApi.getRoleInfoByTitleId(t);this._curRoleImg.refreshUIWithData(e),this._curRoleImg.visible=!0;var i="palace_collect",a=e.uid,n=Config.TitleCfg.getTitleCfgById(t).isOnly;1==n&&a==Api.playerVoApi.getPlayerID()?(this._editBtn.visible=!0,i="palace_collect2"):this._editBtn.visible=!1,this._collectBtn&&this._collectBtn.setText(i)},e.prototype.editBtnClickHandler=function(){Api.palaceVoApi.getRoleInfoByTitleId(this._curTitleId).name;ViewController.getInstance().openView(ViewConst.POPUP.PALACEEDITSIGNPOPUPVIEW,this._curTitleId)},e.prototype.collectBtnClickHandlerCallback=function(t){this._collectBtn.visible=!1;var e=(t.data.data.data,BaseBitmap.create("palace_collectflag"));e.setScale(.7),e.anchorOffsetX=e.width/2,e.x=GameConfig.stageWidth/2,e.y=this._palace_rewardbg.y-e.height/2-30,e.setScale(1.3),e.visible=!0,this._nodeContainer.addChild(e),egret.Tween.get(e,{loop:!1}).to({scaleX:.7,scaleY:.7},300);var i=Config.LevelCfg.getCfgByLevel(String(Api.playerVoApi.getPlayerLevel())).gem,a="1_0_"+String(i),n=GameData.formatRewardItem(a),o=e.localToGlobal(30,-50);o.x=GameConfig.stageWidth/2,App.CommonUtil.playRewardFlyAction(n,o)},e.prototype.collectBtnClickHandler=function(){NetManager.request(NetRequestConst.REQUEST_PALACE_GETSALARY,{})},e.prototype.hisBtnClickHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.PALACEHISTORYPOPUPVIEW,{titleId:this._curTitleId})},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["palace_bg","palace_titlebg","palace_role_shadow","palace_role_empty","palace_historyBtn","palace_historyBtn_down","wifeview_bottombg","user_title_3000","user_title_3000_2","user_title_3001","user_title_3001_2","user_title_3002","user_title_3002_2","user_title_3003","user_title_3003_2","user_title_3004","user_title_3004_2","user_title_3005","user_title_3005_2","palace_title_bg","palace_title_bg_1","palace_rewardbg","servant_attributemap","palace_editBtn_down","palace_editBtn","palace_collectflag"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_PALACE_GETSALARY),this.collectBtnClickHandlerCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_PALACE_GETPALACEINFO),this.palaceInfoHandlerCallback,this),this._nodeContainer=null,this._curRoleImg=null,this._editBtn=null,this._palace_rewardbg=null,this._collectBtn=null,this._curTitleId=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(PalaceHouseView.prototype,"PalaceHouseView");var PalaceRoleInfoItem=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_USERSHOT),this.userShotCallback,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_REFRESHSIGN_AFTER_EDIT,this.showSignAfterEdit,this),this.width=GameConfig.stageWidth;var t=BaseLoadBitmap.create("servant_attributemap");t.width=265,t.height=52,t.name="nameBg",t.scaleX=.8,t.x=this.width/2-t.width/2*.8,t.y=0,this.addChild(t),this._nameBg=t;var e=ComponentManager.getTextField("1",24,TextFieldConst.COLOR_WARN_YELLOW);this._nameTxt=e,this._nameTxt.anchorOffsetX=this._nameTxt.width/2,e.x=GameConfig.stageWidth/2,e.y=t.y+t.height/2-e.height/2+2,this.addChild(e);var i=BaseLoadBitmap.create("palace_role_empty");i.width=382,i.height=712,i.x=this.width/2-i.width/2,i.y=60,i.visible=!1,i.addTouchTap(this.roleImgClickHandler,this),this.addChild(i),this._roleImg=i;var a=BaseBitmap.create("public_9_bg25");a.x=this.width/2+110,a.height=100,a.width=200,this._topTxtBg=a,this._topTxtBg.alpha=0,this.addChild(a);var n=BaseBitmap.create("public_9_bg42_tail");n.x=a.x+20,n.y=a.y+a.height-4,this.addChild(n),this._tailImg=n,this._tailImg.alpha=0;var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);o.multiline=!0,o.lineSpacing=5,o.width=a.width-40,o.x=a.x+20,o.y=a.y+20,this._signTxt=o,this._signTxt.alpha=0,this.addChild(o);var s=BaseBitmap.create("palace_role_shadow");s.x=i.x+i.width/2-s.width/2,s.y=i.y+i.height-s.height/2-40,this.addChildAt(s,0),this._shadowImg=s;var r=BaseLoadBitmap.create("user_title_3000_2");r.width=47,r.height=103,r.x=this.width/2-235,this.addChild(r),this._titleImg=r},e.prototype.refreshUIWithData=function(t){this._roleTitleId=t.titleId;var e=Config.TitleCfg.getTitleCfgById(this._roleTitleId),i=e.isCross,a=this.getChildByName("roleNode"),n=this.getChildByName("nameBg");if(n.width=265,a&&this.removeChild(a),t instanceof PalaceRoleInfoVo&&t.uid>0){this.showRoleSign(t.sign),this._roleUid=t.uid;var o=Api.playerVoApi.getPlayerPortrait(Number(t.titleId),t.pic);o.name="roleNode",o.y=40,o.x=this.width/2-o.width/2;var s=this.getChildIndex(this._nameBg);this.addChildAt(o,s),this._nameTxt.visible=!0,this._shadowImg.visible=!0,this._roleImg.visible=!1,this._titleImg.setload("user_title_"+t.titleId+"_2"),this._nameTxt.text=t.name,1==i&&(n.width=300),this._nameTxt.anchorOffsetX=this._nameTxt.width/2,this._nameTxt.y=this._nameBg.y+this._nameBg.height/2-this._nameTxt.height/2}else this._roleUid=0,this._shadowImg.visible=!1,this._roleImg.y=60,this._roleImg.visible=!0,this._nameTxt.text=LanguageManager.getlocal("palace_titleTip_"+t.titleId),this._nameTxt.anchorOffsetX=this._nameTxt.width/2,this._titleImg.setload("user_title_"+t.titleId+"_2")},e.prototype.showRoleSign=function(t){""!=t&&(egret.Tween.removeTweens(this._topTxtBg),egret.Tween.removeTweens(this._signTxt),egret.Tween.removeTweens(this._tailImg),this._topTxtBg.alpha=1,this._signTxt.alpha=1,this._tailImg.alpha=1,this._signTxt.text=t,egret.Tween.get(this._topTxtBg,{loop:!1}).wait(3e3).to({alpha:0},1e3),egret.Tween.get(this._signTxt,{loop:!1}).wait(3e3).to({alpha:0},1e3),egret.Tween.get(this._tailImg,{loop:!1}).wait(3e3).to({alpha:0},1e3))},e.prototype.showSignAfterEdit=function(t){var e=t.data;if(this._roleTitleId==e){var i=Api.palaceVoApi.getRoleInfoByTitleId(this._roleTitleId).sign;this.showRoleSign(i)}},e.prototype.userShotCallback=function(t){var e=t.data.data.data;e.ruid==this._roleUid&&ViewController.getInstance().openView(ViewConst.POPUP.RANKUSERINGOPOPUPVIEW,e)},e.prototype.getHeight=function(){return 832},e.prototype.roleImgClickHandler=function(){0!=this._roleUid&&NetManager.request(NetRequestConst.REQUEST_RANK_USERSHOT,{ruid:this._roleUid})},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_USERSHOT),this.userShotCallback,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_REFRESHSIGN_AFTER_EDIT,this.showSignAfterEdit,this),this._roleImg=null,this._titleImg=null,this._nameBg=null,this._nameTxt=null,this._shadowImg=null,this._headImg=null,this._roleUid=null,this._topTxtBg=null,this._signTxt=null,this._roleTitleId=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(PalaceRoleInfoItem.prototype,"PalaceRoleInfoItem");var PalaceRoleInfoItem2=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this._curTitleId=e;var i=BaseBitmap.create("palace_perbg");this.addChild(i);var a=Api.palaceVoApi.getRoleInfoByTitleId(this._curTitleId),n=ComponentManager.getTextField("",20);a.name?(n.text=a.name,n.size=20,n.y=12):(n.text=LanguageManager.getlocal("palace_titleTip_"+this._curTitleId),n.size=14,n.y=15),n.x=i.width/2-n.width/2,this.addChild(n);var o=void 0;a.name?(o=Api.playerVoApi.getPlayerPortrait(Number(this._curTitleId),a.pic),o.anchorOffsetX=o.width/2,o.setScale(.35)):(o=BaseLoadBitmap.create("palace_role_empty"),o.width=382,o.height=712,o.anchorOffsetX=o.width/2,o.setScale(.35)),o.x=i.width/2,o.y=45,this.addChild(o);var s=BaseLoadBitmap.create("user_title_"+this._curTitleId+"_2");s.width=47,s.height=103,s.x=15,s.y=o.y,this.addChild(s);var r=ComponentManager.getButton("palace_hisBtn3","",this.hisBtnHandler,this);r.x=i.width-r.width-10,r.y=i.height-r.height-10,this.addChild(r)},e.prototype.detailHandler=function(){},e.prototype.hisBtnHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.PALACEHISTORYPOPUPVIEW,{titleId:this._curTitleId})},e.prototype.getSpaceX=function(){return 3},e.prototype.getSpaceY=function(){return 3},e.prototype.dispose=function(){this._curTitleId=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(PalaceRoleInfoItem2.prototype,"PalaceRoleInfoItem2");var ScrollList=function(t){function e(){var e=t.call(this)||this;return e._scrollListItemArr=[],e._scrollListHeightArr=[],e._scrollRect=void 0,e._lastPos=null,e._curShowItem=null,e._widthCount=-1,e._dataList=[],e.horizontalScrollPolicy="off",e}return __extends(e,t),e.prototype.init=function(t,e,i){this._listItemClass=t,this._scrollRect=i;var a=new BaseDisplayObjectContainer;if(this.content=a,this.setContent(this.content),null==e||!e.length||e.length<1)return this.width=i.width,this.height=i.height,this.addEventListener(egret.Event.CHANGE,this.changeHandler,this),void this.addEventListener(egret.Event.COMPLETE,this.moveCompleteHandler,this);this._dataList=e;for(var n=e.length,o=void 0,s=void 0,r=0,l=0,h=0;n>h;h++){o=e[h],s=ScrollListItem.create(t,h,o),l+s.width-s.getSpaceX()>this._scrollRect.width&&(this._widthCount<0&&(this._widthCount=h>0?h:1),h>0&&(l=0,r+=this._scrollListItemArr.length>0?this._scrollListItemArr[this._scrollListItemArr.length-1].height:s.height)),s.setPosition(l,r),this._scrollListItemArr.push(s);var d=s.getBounds();d.x+=s.x,d.y+=s.y,this._scrollListHeightArr.push(d),l+s.width-s.getSpaceX()<=this._scrollRect.width&&(l+=s.width),h==n-1&&(r+=s.height)}a.width=s.width,a.height=r,this.addEventListener(egret.Event.CHANGE,this.changeHandler,this),this.addEventListener(egret.Event.COMPLETE,this.moveCompleteHandler,this),this.width=i.width,this.height=i.height},e.prototype.setEmptyTip=function(t,e){var i=this.content;if(i&&i instanceof egret.DisplayObjectContainer){var a=i.getChildByName("emptyTxt");a?(a.text=t,a.visible=!0):(0==this._ScrV_Props_._scrollStarted&&this.setScrollTop(0),a=ComponentManager.getTextField(t,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),i.addChild(a),a.name="emptyTxt",this._dataList&&this._dataList.length>0&&(a.visible=!1)),e&&(a.textColor=e),a.setPosition((this._scrollRect.width-a.width)/2,(this._scrollRect.height-a.height)/2)}},e.prototype.checkEmptyTip=function(t){var e=this.content;if(e&&e instanceof egret.DisplayObjectContainer){(this._ScrV_Props_._scrollStarted=!1)&&this.setScrollTop(0);var i=e.getChildByName("emptyTxt");i&&(i.visible=t)}},e.prototype.moveCompleteHandler=function(t){},e.prototype.getItemByIndex=function(t){return this._scrollListItemArr[t]},e.prototype.refreshData=function(t){this._onScrollFinished(),this._dataList=t;for(var e=this._scrollListItemArr.length,i=e-1;i>=0;i--)ScrollListItem.release(this._scrollListItemArr.pop());if(this._scrollListHeightArr.length=0,null==this._dataList||!this._dataList.length||this._dataList.length<1)return void this.checkEmptyTip(!0);this.checkEmptyTip(!1),e=this._dataList.length;for(var a=void 0,n=void 0,o=0,s=0,i=0;e>i;i++){a=t[i],n=ScrollListItem.create(this._listItemClass,i,a),s+n.width-n.getSpaceX()>this._scrollRect.width&&(this._widthCount<0&&(this._widthCount=i>0?i:1),i>0&&(s=0,o+=this._scrollListItemArr.length>0?this._scrollListItemArr[this._scrollListItemArr.length-1].height:n.height)),n.setPosition(s,o),this._scrollListItemArr.push(n);var r=n.getBounds();r.x+=n.x,r.y+=n.y,this._scrollListHeightArr.push(r),s+n.width-n.getSpaceX()<=this._scrollRect.width&&(s+=n.width),i==e-1&&(o+=n.height)}n&&(this.content.width=n.width),this.content.height=o,this.width=this._scrollRect.width,this.height=this._scrollRect.height,this._lastPos=null,this._curShowItem=null,this.setScrollTop(this.scrollTop),this.changeHandler(null)},e.prototype.changeHandler=function(t){if(null==this._lastPos||this.scrollRect.y!=this._lastPos.y){var e=this._curShowItem?this._curShowItem.min:-1,i=this._curShowItem?this._curShowItem.max:-1,a=0/0,n=0/0,o=!1,s=this._scrollListItemArr.length,r=egret.Rectangle.create();
r.copyFrom(this.scrollRect),r.width=this._scrollRect.width,r.height=this._scrollRect.height;var l=!0;if(null==this._lastPos||this.scrollRect.y>this._lastPos.y){l=!0;for(var h=-1==e?0:e,d=h;s>d;d++){var g=this._scrollListHeightArr[d];if(r.intersects(g))isNaN(a)&&(a=d),o=!0;else if(o&&isNaN(n)){n=d+this._widthCount-1;break}}}else{l=!1;for(var c=this._curShowItem.max>=s?s-1:this._curShowItem.max,d=c;d>=0;d--){var g=this._scrollListHeightArr[d];if(r.intersects(g))isNaN(n)&&(n=d),o=!0;else if(o&&isNaN(a)){a=d-this._widthCount+1;break}}}if(isNaN(n)&&(n=s-1),isNaN(a)&&(a=0),0>a&&(a=0),n>s-1&&(n=s-1),this._curShowItem?(this._curShowItem.min=a,this._curShowItem.max=n):this._curShowItem={min:a,max:n},-1==e&&-1==i)for(var d=a;n>=d;d++)this.showItem(d);else{if(e!=a){var p=e>a?e:a,_=a>e?e:a,u=null;u=l?a>e?this.hideItem:this.showItem:a>e?this.hideItem:this.showItem;for(var d=_;p>d;d++)u.call(this,d)}if(i!=n){var p=i>n?i:n,_=n>i?i:n,u=i>n?this.hideItem:this.showItem;u=l?i>n?this.hideItem:this.showItem:n>i?this.hideItem:this.showItem;for(var d=_;p>=d;d++)u.call(this,d)}}this._lastPos?this._lastPos.setTo(this.scrollRect.x,this.scrollRect.y):this._lastPos=egret.Point.create(this.scrollRect.x,this.scrollRect.y)}},e.prototype.hideItem=function(t){if(this.content instanceof egret.DisplayObjectContainer){var e=this._scrollListItemArr[t];this.content.contains(e)&&this.content.removeChild(e)}},e.prototype.showItem=function(t){if(this.content instanceof egret.DisplayObjectContainer){var e=this._scrollListItemArr[t];e&&this.content&&0==this.content.contains(e)&&this.content.addChild(e)}},e.prototype.addTouchTap=function(t,e,i){var a=this;if(null==this._touchTapHelper){var n=function(i){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(i.type==egret.TouchEvent.TOUCH_END){for(var s=a.scrollRect,r=(s?s.x:0,s?s.y:0,a._curShowItem?a._curShowItem.min:0),l=a._curShowItem?a._curShowItem.max:a._scrollListItemArr.length-1,h=egret.Rectangle.create(),d=a.content.globalToLocal(i.stageX,i.stageY),g=d.x,c=d.y,p=r;l>=p;p++){var _=a._scrollListItemArr[p],u=a._scrollListHeightArr[p].x,C=a._scrollListHeightArr[p].y,f=a._scrollListItemArr[p].getBounds(a._scrollListHeightArr[p]);if(f.x=u,f.y=C,h.setTo(f.x,f.y,f.width-_.getSpaceX(),f.height-_.getSpaceY()),h.contains(g,c)){for(var m=this.findBtn(_),T=m.length,y=0;T>y;y++){var v=m[y].getBounds();if(v.x=f.x+m[y].x,v.y=f.y+m[y].y,v.contains(g,c))return}if(i.data=p,t){var A=[i];n&&n.length>0&&A.concat(n),t.apply(e,A)}break}}egret.Rectangle.release(h)}};this._touchTapHelper=TouchHelper.addTouch(this.content,n,this,i,!0)}},e.prototype.findBtn=function(t){for(var e=[],i=t.numChildren,a=0;i>a;a++){var n=t.getChildAt(a);n instanceof BaseButton?e.push(n):n instanceof egret.DisplayObjectContainer&&this.findBtn(n)}return e},e.prototype.setScrollTopByIndex=function(t,e){var i=this._scrollListHeightArr[t].y+this._scrollListHeightArr[t].height/2,a=this._scrollListHeightArr[this._scrollListHeightArr.length-1],n=a.y+a.height;i=i<this._scrollRect.height/2?0:i>n-this._scrollRect.height/2?n-this._scrollRect.height:this._scrollListHeightArr[t].y+this._scrollListHeightArr[t].height/2-this._scrollRect.height/2,this.setScrollTop(i,e)},e.prototype.dispose=function(){this.removeTouchTap(),this.removeTouch(),t.prototype.dispose.call(this),this._scrollListItemArr.length=0,this._scrollListHeightArr.length=0,this._scrollRect&&(this._scrollRect=null),this._lastPos&&(egret.Point.release(this._lastPos),this._lastPos=null),this._curShowItem=null,this._widthCount=-1},e}(ScrollView);__reflect(ScrollList.prototype,"ScrollList");var PlayerBottomUI=function(t){function e(){var e=t.call(this)||this;return e._btnList=[],e._openIdx=0,e.show(),e}return __extends(e,t),e.prototype.show=function(e){t.prototype.show.call(this,e)},e.prototype.init=function(){if(this.height=0,Api.practiceVoApi.isPlayerPracticeEnable()){var t=BaseBitmap.create("wifeskin_barbg");t.x=0,t.y=GameConfig.stageHeigth-t.height,this.addChild(t);for(var e=1;3>=e;e++){var i="practice_btn",a="practice_bottomBtnTxt"+e,n=ComponentManager.getButton(i,a,this.btnHandler,this,[e]);n.x=t.width/2+200*(e-2)-n.width/2,n.y=t.y+t.height/2-n.height/2,this.addChild(n),this._btnList.push(n)}this.height=t.height,this.checkRedPoints()}this.btnHandler(1)},e.prototype.checkRedPoints=function(){Api.practiceVoApi.isShowRedForPBottom()?App.CommonUtil.addRedDotToBDOC(this._btnList[1]):App.CommonUtil.removeRedDotFromBDOC(this._btnList[1])},e.prototype.btnHandler=function(t){var e="",i=[ViewConst.COMMON.PLAYERVIEW,ViewConst.COMMON.PRACTICEVIEW,ViewConst.COMMON.PRESTIGEVIEW];1==t?e=ViewConst.COMMON.PLAYERVIEW:2==t?e=ViewConst.COMMON.PRACTICEVIEW:3==t&&(e=ViewConst.COMMON.PRESTIGEVIEW),ViewController.getInstance().openView(e);for(var a in i)i[a]!=e&&ViewController.getInstance().hideView(i[a]);for(var n=0;n<this._btnList.length;n++)n==t-1?this._btnList[n].updateButtonImage(BaseButton.BTN_STATE2):this._btnList[n].updateButtonImage(BaseButton.BTN_STATE1)},e.prototype.dispose=function(){this._btnList=[],this._openIdx=0,t.prototype.dispose.call(this)},e.prototype.getResourceList=function(){return["wifeskin_barbg","practice_btn_down.","practice_btn"]},e.prototype.hide=function(e){e&&t.prototype.hide.call(this)},e.prototype.getParent=function(){return LayerManager.maskLayer},Object.defineProperty(e.prototype,"showHeight",{get:function(){return this.height},enumerable:!0,configurable:!0}),e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e}(BaseLoadDisplayObjectContiner);__reflect(PlayerBottomUI.prototype,"PlayerBottomUI");var PlayerView=function(t){function e(){var e=t.call(this)||this;return e._changeVTxtList=[],e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_RESCHANGE_REFRESH_UI,this.refreshUpgradeClip,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USER_UPGRADE),this.refreshInfoAfterUpgrade,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer),this._bottomnodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._bottomnodeContainer);var t=BaseBitmap.create("playerview_bg2");t.y=-20,this._nodeContainer.addChild(t);var e=BaseBitmap.create("playerview_name_bg");e.x=GameConfig.stageWidth-e.width-20,e.y=200,this._nodeContainer.addChild(e);var i=e.x+100,a=e.y,n=ComponentManager.getTextField(Api.playerVoApi.getPlayerName(),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);n.stroke=1,n.borderColor=TextFieldConst.COLOR_BLACK,n.x=i-n.width/2,n.y=a+7,this._nodeContainer.addChild(n);var o=LanguageManager.getlocal("uidTitle")+":"+Api.playerVoApi.getPlayerID(),s=ComponentManager.getTextField(o,20,TextFieldConst.COLOR_LIGHT_YELLOW);s.x=n.x,s.y=n.y+n.height+5,this._nodeContainer.addChild(s);var r=Api.playerVoApi.getPlayerAllianceName();""==r&&(r=LanguageManager.getlocal("allianceRankNoAlliance"));var l=LanguageManager.getlocal("acRank_myAlliancenick"),h=ComponentManager.getTextField(l+r,20,TextFieldConst.COLOR_WARN_YELLOW);h.x=n.x,h.y=s.y+s.height+5,this._nodeContainer.addChild(h);var d=LanguageManager.getlocal("playerview_Nopo"),g=Api.allianceVoApi.getMyAllianceVo().po;g>0&&(d=LanguageManager.getlocal("allianceMemberPo"+g));var c=ComponentManager.getTextField(LanguageManager.getlocal("alliance_po")+": "+d,20,TextFieldConst.COLOR_WARN_YELLOW);if(c.x=n.x,c.y=h.y+h.height+5,this._nodeContainer.addChild(c),Api.playerVoApi.getPlayerVipLevel()>0){var p=BaseBitmap.create("playerview_wipbg");p.x=n.x,p.y=e.y-37,p.scaleY=1.3,this._nodeContainer.addChild(p);var _=BaseLoadBitmap.create(Api.vipVoApi.getCurLevelVipCfg().icon);_.width=80,_.height=35,_.x=p.x,_.y=p.y+2,this._nodeContainer.addChild(_)}var u=Api.playerVoApi.getPlayerLevel(),C=20;Api.playerVoApi.getTitleid()>0&&(u=Api.playerVoApi.getTitleid(),C=-10);var f=Api.playerVoApi.getMyPortrait();if(f.x=C,f.name="userContainer",this._nodeContainer.addChild(f),Api.switchVoApi.checkOpenPrestige()&&!Api.practiceVoApi.isPlayerPracticeEnable()){var m=ComponentManager.getButton("btn_prestige","",this.clickPrestigeHandler,this);if(m.setPosition(5,-7),this._nodeContainer.addChild(m),m.name="prestige",Api.prestigeVoApi.isShowRedDot){App.CommonUtil.addRedDotToBDOC(m);var T=m.getChildByName("reddot");T&&(T.x-=7,T.y+=7)}}var y=0,v="playerview_probg",A="playerview_power_img",w=GameConfig.stageHeigth-this.container.y-466-10,x=0;Api.practiceVoApi.isPlayerPracticeEnable()&&(y=30,A="player_power1",x=PlayerBottomUI.getInstance().showHeight,w=GameConfig.stageHeigth-this.container.y-426-x);t.y+t.height;this._bottomnodeContainer.y=w;var I=BaseBitmap.create("playerview_powerbg");I.x=30,I.y=this._bottomnodeContainer.y-60,this._nodeContainer.addChild(I);var L=BaseBitmap.create(A);L.x=I.x+50,L.y=I.y+20,this._nodeContainer.addChild(L);var E=ComponentManager.getTextField(""+Api.playerVoApi.getPlayerPower(),24,TextFieldConst.COLOR_LIGHT_YELLOW);E.name="powerTxt",E.x=L.x+L.width+15,E.y=L.y+L.height/2-E.height/2,this._nodeContainer.addChild(E);var B=(t.x+29,0),S=BaseBitmap.create(v);S.x=0,S.y=B;var N=BaseBitmap.create("servant_mask");N.width=GameConfig.stageWidth,N.y=S.y+S.height-N.height,this._bottomnodeContainer.addChild(N),this._bottomnodeContainer.addChild(S);for(var M=S.y+15,b=GameConfig.stageWidth/2,O=1;6>=O;O++){var V=ComponentManager.getTextField("",20,TextFieldConst.COLOR_LIGHT_YELLOW);V.name="proText"+O;var R=0;1==O||4==O?R=-1:(3==O||6==O)&&(R=1),b=GameConfig.stageWidth/2+180*R,O%4==0&&(M+=25);var k=BaseBitmap.create("playerview_pro"+O);k.x=b-k.width-5,k.y=M,this._bottomnodeContainer.addChild(k),V.x=b,V.y=k.y+2,this._bottomnodeContainer.addChild(V)}this.refreshProTxt();var P=BaseBitmap.create("public_9_bg22");P.x=0,P.y=S.y+75,P.height=GameConfig.stageHeigth-this._bottomnodeContainer.y-this.container.y-x,this._bottomnodeContainer.addChild(P);var F=BaseBitmap.create("public_9_bg43");F.width=600,F.height=P.height-40,F.x=20,F.y=P.y+20,this._bottomnodeContainer.addChild(F);var D=BaseBitmap.create("playerview_pro_inmg2");D.x=GameConfig.stageWidth/2-D.width,D.y=F.y+8,this._bottomnodeContainer.addChild(D);var G=ComponentManager.getBitmapText(Api.playerVoApi.getPlayerOffice(),"office_fnt");G.name="officeTF",G.x=GameConfig.stageWidth/2+5,G.y=D.y+D.height/2-G.height/2-5,this._bottomnodeContainer.addChild(G),B=F.y+40,B=this.refreshLvCfg(B),B+=10;var H=BaseBitmap.create("playerview_infobg");H.width=600,H.height=60,H.x=GameConfig.stageWidth/2-H.width/2,H.y=B,this._bottomnodeContainer.addChild(H),this._progressBar=ComponentManager.getProgressBar("progress3","progress3_bg",460),this._progressBar.x=50,this._progressBar.y=H.y+15,this._bottomnodeContainer.addChild(this._progressBar),this._expTipTxt=ComponentManager.getTextField("",18),this.refreshProgressAndTxt(),this._expTipTxt.x=this._progressBar.x+this._progressBar.width/2-this._expTipTxt.width/2,this._expTipTxt.y=this._progressBar.y+this._progressBar.height/2-this._expTipTxt.height/2,this._bottomnodeContainer.addChild(this._expTipTxt);var U=ComponentManager.getButton("playerview_lvupBtn","",this.clickUpgradeHandler,this);U.x=this._progressBar.x+this._progressBar.width+10,U.y=H.y-40,this._bottomnodeContainer.addChild(U),this._upgradeOfficeBtn=U,this._playerview_lvup_word=BaseBitmap.create("playerview_lvup_word"),this._playerview_lvup_word.x=U.x+U.width/2-this._playerview_lvup_word.width/2,this._playerview_lvup_word.y=U.y+U.height-this._playerview_lvup_word.height,this._bottomnodeContainer.addChild(this._playerview_lvup_word);var W=BaseBitmap.create("playerview_pro7");W.x=this._progressBar.x-20,W.y=this._progressBar.y+this._progressBar.height/2-W.height/2,this._bottomnodeContainer.addChild(W),this.refreshUpgradeClip()},e.prototype.refreshProTxt=function(){for(var t=[{txt:LanguageManager.getlocal("playerview_force"),proValue:App.StringUtil.changeIntToText(Api.playerVoApi.getAtk()),proIcon:""},{txt:LanguageManager.getlocal("playerview_inte"),proValue:App.StringUtil.changeIntToText(Api.playerVoApi.getInte()),proIcon:""},{txt:LanguageManager.getlocal("playerview_wife"),proValue:Api.wifeVoApi.getWifeNum(),proIcon:""},{txt:LanguageManager.getlocal("playerview_policy"),proValue:App.StringUtil.changeIntToText(Api.playerVoApi.getPolitics()),proIcon:""},{txt:LanguageManager.getlocal("playerview_charm"),proValue:App.StringUtil.changeIntToText(Api.playerVoApi.getCharm()),proIcon:""},{txt:LanguageManager.getlocal("playerview_child"),proValue:Api.wifeVoApi.getChildrenNum(),proIcon:""}],e=0;6>e;e++){var i=this._bottomnodeContainer.getChildByName("proText"+(e+1));i.text=String(t[e].proValue)}},e.prototype.refreshLvCfg=function(t){var e=Api.playerVoApi.getPlayerLevel(),i=Config.LevelCfg.getCfgByLevel(e.toString()),a=Config.LevelCfg.getCfgByLevel((e+1).toString()),n=[];n=[[LanguageManager.getlocal("promotion_privilege6_1"),LanguageManager.getlocal("servant_name"+i.servant)]],n=n.concat([[LanguageManager.getlocal("promotion_privilege1"),"gold"],[LanguageManager.getlocal("promotion_privilege2"),"food"],[LanguageManager.getlocal("promotion_privilege3"),"soldier"],[LanguageManager.getlocal("promotion_privilege4"),"affair"],[LanguageManager.getlocal("promotion_privilege7",[""]),"gem"]]);var o=20,s=40,r=45;if(Api.practiceVoApi.isPlayerPracticeEnable()){var l=Api.playerVoApi.getPlayerLevel(),h=GameConfig.config.practicebaseCfg.level,d=h[l-1],g=h[l];d||(d=h[h.length-1]),g||(g=d),o=18,s=30,r=30,n=n.concat([[LanguageManager.getlocal("promotion_privilege8"),d,g]])}for(var c=0,p=0;p<n.length;p++){var _=n[p];if(p%2==0&&t){var u=BaseBitmap.create("playerview_infobg");u.width=600,u.scaleY=r/45,u.x=GameConfig.stageWidth/2-u.width/2,u.y=t,this._bottomnodeContainer.addChild(u)}var C=void 0,f=void 0,m=void 0,T=void 0;C=this._changeVTxtList[c++],C||(C=ComponentManager.getTextField(p+1+"."+_[0],o,TextFieldConst.COLOR_LIGHT_YELLOW),C.x=50,C.y=t+r/2-C.height/2,this._bottomnodeContainer.addChild(C),this._changeVTxtList.push(C)),C.text=p+1+"."+_[0],T=this._bottomnodeContainer.getChildByName("proArrow"+p),T||(T=BaseBitmap.create("playerview_arrow"),T.x=GameConfig.stageWidth-180,T.y=C.y+C.height/2-T.height/2,this._bottomnodeContainer.addChild(T),T.name="proArrow"+p),f=this._changeVTxtList[c++],f||(f=ComponentManager.getTextField(i[_[1]],18),this._changeVTxtList.push(f),this._bottomnodeContainer.addChild(f)),f.text=i[_[1]],6==p&&(f.text=_[1]),0==p&&(f.text=""),f.anchorOffsetX=f.width,f.x=T.x-10,f.y=T.y+T.height/2-f.height/2,m=this._changeVTxtList[c++],m||(m=ComponentManager.getTextField("",18,TextFieldConst.COLOR_WARN_GREEN),m.x=T.x+T.width+10,m.y=f.y,this._bottomnodeContainer.addChild(m),this._changeVTxtList.push(m)),a?(0==p&&a.servant?(m.text=LanguageManager.getlocal("servant_name"+a.servant),m.x=T.x+T.width/2-m.width/2,T.visible=!1):(m.text=a[_[1]],6==p&&(m.text=_[2])),m.y=T.y+T.height/2-m.height/2):(m.visible=!1,T.visible=!1),t+=s}return t},e.prototype.refreshProgressAndTxt=function(){var t=Api.playerVoApi.getPlayerLevel(),e=Config.LevelCfg.getCfgByLevel((t+1).toString());e?(this._progressBar.setPercentage(Api.playerVoApi.getPlayerExp()/e.exp),this._expTipTxt.text=LanguageManager.getlocal("playerview_exp")+Api.playerVoApi.getPlayerExp()+" / "+e.exp):(this._progressBar.setPercentage(1),this._expTipTxt.text=LanguageManager.getlocal("promotion_topLevel"),this._expTipTxt.x=GameConfig.stageWidth/2-this._expTipTxt.width/2);var i=this._nodeContainer.getChildByName("powerTxt");i.text=""+Api.playerVoApi.getPlayerPower()},e.prototype.refreshUpgradeClip=function(){var t=Api.playerVoApi.getPlayerLevel(),e=Config.LevelCfg.getCfgByLevel((t+1).toString());if(e&&Api.playerVoApi.getPlayerExp()>=e.exp){if(!this._upgradeClip){this._upgradeClip=ComponentManager.getCustomMovieClip("player_frame",10,100),this._upgradeClip.x=this._upgradeOfficeBtn.x+this._upgradeOfficeBtn.width/2-85,this._upgradeClip.y=this._upgradeOfficeBtn.y+this._upgradeOfficeBtn.height/2-90;var i=this._bottomnodeContainer.getChildIndex(this._playerview_lvup_word);this._bottomnodeContainer.addChildAt(this._upgradeClip,i),this._upgradeClip.playWithTime(0)}}else this._upgradeClip&&(this._upgradeClip.stop(),this._bottomnodeContainer.removeChild(this._upgradeClip),this._upgradeClip=null)},e.prototype.refreshInfoAfterUpgrade=function(t){var e=t.data.data;if(0==e.ret){ViewController.getInstance().openView(ViewConst.COMMON.PROMOTIONSUCCESSVIEW);var i=this._nodeContainer.getChildByName("userContainer"),a=i.getChildByName("myBody");a.setload("user_body"+Api.playerVoApi.getPlayerLevel());var n=this._bottomnodeContainer.getChildByName("officeTF");n.text=Api.playerVoApi.getPlayerOffice(),this.refreshLvCfg(),this.refreshProgressAndTxt(),this.refreshProTxt()}},e.prototype.clickPrestigeHandler=function(t){ViewController.getInstance().openView(ViewConst.COMMON.PRESTIGEVIEW);var e=this._nodeContainer.getChildByName("prestige");App.CommonUtil.removeRedDotFromBDOC(e)},e.prototype.clickUpgradeHandler=function(t){var e=Api.playerVoApi.getPlayerLevel(),i=Config.LevelCfg.getCfgByLevel((e+1).toString());return i?Api.playerVoApi.getPlayerExp()<i.exp?void App.CommonUtil.showTip(LanguageManager.getlocal("promotion_upgradeTip2")):(NetManager.request(NetRequestConst.REQUEST_USER_UPGRADE,{}),void App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_FUNCTION_TXT)):void App.CommonUtil.showTip(LanguageManager.getlocal("promotion_upgradeTip1"))},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["playerview_bg2","playerview_btn1_txt","playerview_btn1","playerview_btn1_down","playerview_fan","playerview_btn1_bg","player_frame","playerview_wipbg","playerview_name_bg","playerview_powerbg","playerview_probg","playerview_pro1","playerview_pro2","playerview_pro3","playerview_pro4","playerview_pro5","playerview_pro6","playerview_pro_inmg2","playerview_infobg","playerview_arrow","playerview_pro7","progress3","progress3_bg","playerview_lvupBtn","playerview_lvupBtn_down","playerview_power_img","office_fnt","playerview_lvup_word","servant_mask","servant_downbg","player_power1","player_power2"])},e.prototype.closeHandler=function(){PlayerBottomUI.getInstance().hide(!0),t.prototype.hide.call(this)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_RESCHANGE_REFRESH_UI,this.refreshUpgradeClip,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USER_UPGRADE),this.refreshInfoAfterUpgrade,this),this._nodeContainer=null,this._bottomnodeContainer=null,this._progressBar=null,this._expTipTxt=null,this._changeVTxtList=[],this._playerview_lvup_word=null,this._upgradeClip&&(this._upgradeClip.stop(),this._upgradeClip.dispose(),this._upgradeClip=null),t.prototype.dispose.call(this)},e}(CommonView);__reflect(PlayerView.prototype,"PlayerView");var PlayerViewTab1=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t="hello world",e="Jack 1",i=new BaseTextField;i.text=App.StringUtil.firstCharToUper(t),i.x=10,i.y=20,this.addChild(i);var a=new BaseTextField;a.text=App.StringUtil.firstCharToLower(e),a.x=10,a.y=120,this.addChild(a)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(PlayerViewTab1.prototype,"PlayerViewTab1");var PlayerViewTab2=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t="hello world",e="Jack 2",i=new BaseTextField;i.text=App.StringUtil.firstCharToUper(t),i.x=10,i.y=20,this.addChild(i);var a=new BaseTextField;a.text=App.StringUtil.firstCharToLower(e),a.x=10,a.y=120,this.addChild(a)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(PlayerViewTab2.prototype,"PlayerViewTab2");var AcRankListPopupView=function(t){function e(){var e=t.call(this)||this;return e._aid="",e._code="",e._acRankInfoVo=null,e._allirank=null,e}return __extends(e,t),e.prototype.initView=function(){var t=Config.AcCfg.getCfgByActivityIdAndCode(this._aid,String(this._code));this._nodeContainer=new BaseDisplayObjectContainer,this._nodeContainer.height=800,this.addChildToContainer(this._nodeContainer);var e=20,i=BaseBitmap.create("public_9_bg32");i.width=520,i.height=695,i.x=this.viewBg.width/2-i.width/2,this._nodeContainer.addChild(i);var a=LanguageManager.getlocal("acRankPop_title2");if(12==t.type||13==t.type||14==t.type){a=LanguageManager.getlocal("acRankPop_titleAlliance");var n=30;i.height-=n,e+=n;var o=["acRankListTab1","acRankListTab2"],s=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,o,this.tabBtnClickHandler,this);s.setSpace(2),s.x=30,s.y=9,this._nodeContainer.addChild(s)}var r=BaseBitmap.create("public_9_bg33");r.width=i.width,r.height=40,i.y=e,r.x=i.x,r.y=i.y,this._nodeContainer.addChild(r);var l=ComponentManager.getTextField(LanguageManager.getlocal("acRankPop_title1"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);l.x=r.x+40,l.y=r.y+8,this._nodeContainer.addChild(l);var h=ComponentManager.getTextField(a,l.size,TextFieldConst.COLOR_LIGHT_YELLOW);h.name="titleTxt2",h.x=r.x+175,h.y=l.y,this._nodeContainer.addChild(h);var d;d=LanguageManager.getlocal("acRankPop_title3_"+t.type),(13==t.type||14==t.type)&&(d=LanguageManager.getlocal("acRankPop_title3_"+t.type));var g=ComponentManager.getTextField(d,l.size,TextFieldConst.COLOR_LIGHT_YELLOW);g.x=r.x+430-g.width/2,g.y=l.y,this._nodeContainer.addChild(g),g.name="titleTxt3";var c=BaseBitmap.create("public_9_bg1");c.width=i.width,c.height=100,c.x=i.x,c.y=i.y+i.height+9,this._nodeContainer.addChild(c);var p=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);if(p.text=LanguageManager.getlocal("acRank_mynick")+Api.playerVoApi.getPlayerName(),p.x=c.x+20,p.y=c.y+20,this._nodeContainer.addChild(p),11==t.type||12==t.type){var _=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);11==t.type?_.text=LanguageManager.getlocal("acRankActive19",[t.rankLimit]):_.text=LanguageManager.getlocal("acRankList_allianceTip"),_.x=c.x+220,_.y=c.y+20,this._nodeContainer.addChild(_)}var u="10000+",C=0;this._acRankInfoVo.myrank.myrank&&(u=String(this._acRankInfoVo.myrank.myrank),C=this._acRankInfoVo.myrank.value);var f=ComponentManager.getTextField("",p.size,TextFieldConst.COLOR_LIGHT_YELLOW);f.text=LanguageManager.getlocal("acRank_myrank",[u]),f.x=p.x,f.y=p.y+40,f.name="myRankTxt",this._nodeContainer.addChild(f);var m=ComponentManager.getTextField("",p.size,TextFieldConst.COLOR_LIGHT_YELLOW);m.text=LanguageManager.getlocal("acRank_myaddV",[d,String(C)]),m.x=f.x+240,m.y=f.y,m.name="addvalueTxt",this._nodeContainer.addChild(m);var T=new egret.Rectangle(0,0,this.viewBg.width,i.height-60),y=this._acRankInfoVo.rankList,v=ComponentManager.getScrollList(AcRankListScrollItem,y,T);v.y=r.y+50,this._nodeContainer.addChild(v),v.setEmptyTip(LanguageManager.getlocal("acPunishNoData")),this._scrollView=v},e.prototype.getRequestData=function(){return this._aid=String(this.param.data.aid),this._code=String(this.param.data.code),""==this._aid||""==this._code?null:{requestType:NetRequestConst.REQUEST_ACTIVITY_GETRANKACTIVE,requestData:{activeId:this._aid+"-"+this._code}}},e.prototype.receiveData=function(t){this._acRankInfoVo=Api.acRankVoApi.getAcRankInfoVoByAidAndCode(this._aid,this._code),this._allirank=t.data.data.allirank},e.prototype.tabBtnClickHandler=function(t){var e=this._nodeContainer.getChildByName("titleTxt2"),i=this._nodeContainer.getChildByName("titleTxt3"),a=this._nodeContainer.getChildByName("addvalueTxt"),n=this._nodeContainer.getChildByName("myRankTxt"),o=t.index,s=[],r="",l="",h=0,d="10000+";if(0==o){r=LanguageManager.getlocal("acRankPop_titleAlliance"),s=this._acRankInfoVo.rankList,l=LanguageManager.getlocal("acRankPop_title3_12"),this._acRankInfoVo.myrank.myrank&&(h=this._acRankInfoVo.myrank.value,d=String(this._acRankInfoVo.myrank.myrank));var g=Config.AcCfg.getCfgByActivityIdAndCode(this._aid,String(this._code));(13==g.type||14==g.type)&&(l=LanguageManager.getlocal("acRankPop_title3_"+g.type))}else r=LanguageManager.getlocal("acRankPop_title2"),s=this._allirank.rankList,l=LanguageManager.getlocal("acRankPop_title3_12_1"),this._allirank.myrank&&this._allirank.myrank.myrank&&(h=this._allirank.myrank.value,d=String(this._allirank.myrank.myrank));e.text=r,i.text=l,a.text=LanguageManager.getlocal("acRank_myaddV",[l,String(h)]),n.text=LanguageManager.getlocal("acRank_myrank",[d]),this._scrollView.refreshData(s)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([])},e.prototype.dispose=function(){this._aid="",this._code="",this._nodeContainer=null,this._acRankInfoVo=null,this._scrollView=null,this._allirank=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(AcRankListPopupView.prototype,"AcRankListPopupView");var CandyGetPopupView=function(t){function e(){var e=t.call(this)||this;return e._bgHeight=0,e._candyList=["100","100","100","150","150","150","200"],e}return __extends(e,t),e.prototype.initView=function(){var t=ComponentManager.getTextField(LanguageManager.getlocal("candyGetTitleTip"),TextFieldConst.FONTSIZE_CONTENT_COMMON);t.textColor=TextFieldConst.COLOR_BROWN,this.addChildToContainer(t),t.x=30,t.y=15;var e=BaseBitmap.create("public_9_bg4");e.width=520,e.height=300,e.x=this.viewBg.x+this.viewBg.width/2-e.width/2,e.y=47,this.addChildToContainer(e),this._bgHeight=e.height;var i=BaseBitmap.create("candyline");i.width=450,i.x=60,i.y=130,this.addChildToContainer(i);for(var a=0;7>a;a++){var n=BaseBitmap.create("candynumbg");n.x=(n.width+3)*a+33,n.y=e.y+20,this.addChildToContainer(n);var o=BaseBitmap.create("candyicon2");o.x=n.x+5,o.y=n.y+3,this.addChildToContainer(o);var s=ComponentManager.getTextField(this._candyList[a],18);this.addChildToContainer(s),s.x=n.x+31,s.y=n.y+7;var r=BaseBitmap.create("candybg");r.x=n.x+12,r.y=n.y+45,this.addChildToContainer(r);var l=ComponentManager.getTextField((a+1).toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON);l.textColor=TextFieldConst.COLOR_BLACK,this.addChildToContainer(l),l.x=n.x+31,l.y=n.y+100}this._getBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"taskCollect",this.clickConHandler,this),this._getBtn.setColor(TextFieldConst.COLOR_BLACK),this._getBtn.x=this.getShowWidth()/2-this._getBtn.width/2,this._getBtn.y=e.y+e.height-120,this.addChildToContainer(this._getBtn);var h=Api.otherInfoVoApi.getCandyGetInfo();h.today==App.DateUtil.getWeeTs(GameData.serverTime)&&(this._getBtn.setEnable(!1),this._getBtn.setText("candyGetAlready"));var d=ComponentManager.getTextField(LanguageManager.getlocal("candyGetTitleMsg"),TextFieldConst.FONTSIZE_CONTENT_COMMON);d.textColor=TextFieldConst.COLOR_WARN_RED,this.addChildToContainer(d),d.x=e.x+e.width/2-d.width/2,d.y=this._getBtn.y+this._getBtn.height+20,this.setState()},e.prototype.setState=function(){this._stateContanier&&(this.removeChildFromContainer(this._stateContanier),this._stateContanier=null),this._stateContanier=new BaseDisplayObjectContainer,this.addChildToContainer(this._stateContanier);for(var t=Api.otherInfoVoApi.getCandyGetInfo(),e=t.get,i=0;7>i;i++){var a="candybox";e>i&&(a="candycheck");var n=BaseBitmap.create(a);n.x=72*i+46,n.y=117,this._stateContanier.addChild(n)}t.today==App.DateUtil.getWeeTs(GameData.serverTime)&&(this._getBtn.setEnable(!1),this._getBtn.setText("candyGetAlready"))},e.prototype.receiveData=function(t){t.data.ret<0||t.data.cmd==NetRequestConst.REQUEST_OTHERINFO_GETCANDYREWARD&&(App.CommonUtil.showTip(LanguageManager.getlocal("candyGetTip")),this.setState())},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this)},e.prototype.clickConHandler=function(t){var e=Api.otherInfoVoApi.getCandyGetInfo(),i=e.get;if(!(i>=7)){var a=this._candyList[i];PlatformManager.sendCandy(a,this.sendCallback,this)}},e.prototype.sendCallback=function(t){"0"==String(t)?this.request(NetRequestConst.REQUEST_OTHERINFO_GETCANDYREWARD,null):"-2"==String(t)?App.CommonUtil.showTip(LanguageManager.getlocal("candyGetTip1")):App.CommonUtil.showTip(LanguageManager.getlocal("candyGetTip2"))},e.prototype.clickCancelHandler=function(t){this.hide()},e.prototype.getTitleStr=function(){return"candyGetTitle"},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["candybg","candybox","candycheck","candyicon2","candyline","candynumbg"])},e.prototype.dispose=function(){this._bgHeight=0,this._stateContanier=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(CandyGetPopupView.prototype,"CandyGetPopupView");var CommonRewardPopupView=function(t){function e(){var e=t.call(this)||this;return e.rewardArrList=[],e}return __extends(e,t),e.prototype.getBgName=function(){return"public_9_wordbg"},e.prototype.getCloseBtnName=function(){return null},e.prototype.isTouchMaskClose=function(){return!0},e.prototype.initView=function(){this.titleTF.visible=!1;var t=this.param.data;t&&("string"==typeof t?this.rewardArrList=GameData.formatRewardItem(t):this.rewardArrList=t);for(var e=new BaseDisplayObjectContainer,i=this.rewardArrList.length,a=.88,n=0,o=0;i>o;o++){var s=GameData.getItemIcon(this.rewardArrList[o]),r=o%5;s.setPosition((s.width+20)*r,(s.height+20)*Math.floor(o/5)),s.scaleX=a,s.scaleY=a,e.addChild(s),n=(s.height+20)*Math.floor(o/5)}e.setPosition(this.viewBg.x+(this.viewBg.width-e.width)/2,50),this.addChildToContainer(e)},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this);var e=BaseBitmap.create("common_reward");e.setPosition(this.viewBg.x+(this.viewBg.width-e.width)/2,this.viewBg.y-e.height/2),this.addChild(e)},e.prototype.touchHandler=function(){ViewController.getInstance().hideView(ViewConst.POPUP.COMMONREWARDPOPUPVIEW)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["common_reward"])},e.prototype.dispose=function(){this._scrollList=null,this.rewardArrList=[],t.prototype.dispose.call(this)},e}(PopupView);__reflect(CommonRewardPopupView.prototype,"CommonRewardPopupView");var BaseLoadBitmap=function(t){function e(i,a,n){var o=t.call(this)||this;if(o._resurl=void 0,o._rect=void 0,o._groupName=void 0,o._isloaded=!1,o._isloading=!1,!e.isCanBaseLoadBitmapNew&&"BaseLoadBitmap"==o.getClassName()){var s="请使用BaseLoadBitmap.create创建";throw App.LogUtil.error(s),new Error(s)}return o.init(i,a,n),o}return __extends(e,t),e.prototype.setload=function(t,e,i){t&&this._resurl!=t&&((this._isloading||this._isloaded)&&this.removeUseCount(),this.init(t,e,i))},e.prototype.isLoaded=function(){return this._isloaded},e.prototype.init=function(t,e,i){this._resurl=t,this._rect=e,this._loadCompleteCallback=i,this._rect&&(this.width=this._rect.width,this.height=this._rect.height),this._isloading=!0,this.loadRes()},e.prototype.loadRes=function(){this.addUseCount(),ResourceManager.getRes(this._resurl)&&1!=e._LoadNum[this._resurl]?this.dalyLoadComplete():RES.hasRes(this._resurl)?this._groupName=ResourceManager.loadResources([this._resurl],[],this.dalyLoadComplete,null,this):this._resurl.indexOf(".")>-1&&ResourceManager.loadItemByUrl(this._resurl,this.loadComplete,this,RES.ResourceItem.TYPE_IMAGE)},e.prototype.dalyLoadComplete=function(){egret.callLater(this.loadComplete,this)},e.prototype.loadComplete=function(t){this._isloading=!1,this._isloaded=!0,t?this.texture=t:this.texture=ResourceManager.getRes(this._resurl),this._loadCompleteCallback&&(this._loadCompleteCallback.callback.apply(this._loadCompleteCallback.callbackThisObj,this._loadCompleteCallback.callbackParams),this.clearCallback())},e.prototype.addUseCount=function(){"itemicon2001"==this._resurl&&App.LogUtil.log(this._resurl),null==e._LoadNum[this._resurl]&&(e._LoadNum[this._resurl]=0),e._LoadNum[this._resurl]++},e.prototype.removeUseCount=function(){"itemicon2001"==this._resurl&&App.LogUtil.log(this._resurl),e._LoadNum[this._resurl]>0&&e._LoadNum[this._resurl]--,0==e._LoadNum[this._resurl]&&(this._groupName?(ResourceManager.destroyRes(this._groupName),this._groupName=null):RES.hasRes(this._resurl)&&(ResourceManager.destroyRes(this._resurl),this._resurl=null)),this._isloading=!1,this._isloaded=!1
},e.prototype.clearCallback=function(){this._loadCompleteCallback&&(this._loadCompleteCallback.callback=null,this._loadCompleteCallback.callbackThisObj=null,this._loadCompleteCallback.callbackParams=null,this._loadCompleteCallback=null)},e.prototype.dispose=function(){(this._isloading||this._isloaded)&&this.removeUseCount(),this._rect&&(egret.Rectangle.release(this._rect),this._rect=null),this.clearCallback(),this._resurl=null,t.prototype.dispose.call(this)},e.create=function(t,i,a){var n=e.baseLoadBitmapPool.pop();return n?n.init(t,i,a):(e.isCanBaseLoadBitmapNew=!0,n=new e(t,i,a),e.isCanBaseLoadBitmapNew=!1),n},e.release=function(t){t&&(t.dispose(),t.texture&&(t.texture=null),egret.Tween.removeTweens(t),t.setPosition(0,0),t.setScale(1),t.rotation=0,t.alpha=1,t.width=0/0,t.height=0/0,t.mask=null,t.scrollRect=null,t.filters=null,t.anchorOffsetX=0,t.anchorOffsetY=0,t.visible=!0,t.name=null,t.touchEnabled=!1,t.skewX=t.skewY=0,t.blendMode=egret.BlendMode.NORMAL,e.baseLoadBitmapPool.indexOf(t)<0&&e.baseLoadBitmapPool.push(t))},e.baseLoadBitmapPool=[],e.isCanBaseLoadBitmapNew=!1,e._LoadNum={},e}(BaseBitmap);__reflect(BaseLoadBitmap.prototype,"BaseLoadBitmap");var CostGemBuyItemPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=this.param.data,e=t.id;t.cancelCallback&&(this._cancelCallback=t.cancelCallback),this._confirmCallback=t.confirmCallback,this._handler=t.handler;var i=t.msg,a=t.num,n=(t.useNum||0,BaseBitmap.create("public_9_bg4"));n.width=520,n.height=224,n.x=this.viewBg.x+this.viewBg.width/2-n.width/2,n.y=9,this.addChildToContainer(n);var o=(this.viewBg.x+this.viewBg.width/2-50,29),s=100,r=Config.ItemCfg.getItemCfgById(Number(e));r||(r=GameData.getRewardItemVoByIdAndType(e));var l=LanguageManager.getlocal("itemUseNewTip",[r.name,App.StringUtil.toString(a)]);i+="\n\n\n"+l;var h=ComponentManager.getTextField(i,TextFieldConst.FONTSIZE_CONTENT_SMALL);h.width=480,h.setColor(TextFieldConst.COLOR_BLACK),h.textAlign=TextFieldConst.ALIGH_CENTER,h.x=this.viewBg.x+this.viewBg.width/2-h.width/2,h.y=o+s-45,h.lineSpacing=20,this.addChildToContainer(h),this._cancelBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"cancelBtn",this.clickCancelHandler,this),this._cancelBtn.x=this.viewBg.x+this.viewBg.width/4-this._cancelBtn.width/2,this._cancelBtn.y=n.y+n.height+15,this._cancelBtn.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(this._cancelBtn)},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this),this.setConfirmBtnPosition(this.viewBg.x+this.viewBg.width/4*3-this._cancelBtn.width/2-35,this._cancelBtn.y)},e.prototype.clickConfirmHandler=function(t){return this.param.data.useNum&&this.param.data.useNum>this.param.data.num?(App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough")),void this.hide()):(App.LogUtil.log("clickConfirmHandler"),this._confirmCallback&&this._confirmCallback.apply(this._handler,[]),void this.hide())},e.prototype.getConfirmBtnStr=function(){return"sysConfirm"},e.prototype.clickCancelHandler=function(t){this._cancelCallback&&this._cancelCallback.apply(this._handler,[]),this.hide()},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([])},e.prototype.getTitleStr=function(){return"itemUseConstPopupViewTitle"},e.prototype.getConfirmBtnName=function(){return ButtonConst.BTN_NORMAL_YELLOW},e.prototype.dispose=function(){this._cancelCallback=null,this._confirmCallback=null,this._handler=null,this._cancelBtn=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(CostGemBuyItemPopupView.prototype,"CostGemBuyItemPopupView");var DailyTaskRewardPreviewPopuiView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var t=this.param.data,e=t.id,i=null,a=0,n="",o=null;if(t.type==AcMayDayView.AID){var s=Config.AcCfg.getCfgByActivityIdAndCode(AcMayDayView.AID,AcMayDayView.CODE);i=s.getBoxRewardById(e),a=i.needNum,n=i.getReward}else{i=Config.DailytaskCfg.getDailyRewardsCfgByRewardId(e),a=i.needLiveness;var r=i.mustReward;n=r[0]+"_"+r[1]+"_0",o=i.canReward}var l=51,h=BaseBitmap.create("public_9_bg4");h.width=520,h.height=205,h.x=this.viewBg.x+this.viewBg.width/2-h.width/2,h.y=116-l,this._nodeContainer.addChild(h);var d=BaseBitmap.create("public_9_bg3");d.width=272,d.x=this.viewBg.x+this.viewBg.width/2-d.width/2,d.y=65-l,this._nodeContainer.addChild(d);var g=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);g.text=LanguageManager.getlocal("Daily"==t.type?"dailyTask_rewardCase":"acMayDayBoxDesc",[String(a)]),g.x=d.x+d.width/2-g.width/2,g.y=d.y+d.height/2-g.height/2,this._nodeContainer.addChild(g);var c=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);c.text=LanguageManager.getlocal("Daily"==t.type?"dailyTask_rewardTip":"acMayDayBoxDesc1"),c.x=h.x+10,c.y=h.y+20,this._nodeContainer.addChild(c),o||(o=[]);for(var p=n,_=0;_<o.length;_++)p=p+"|"+o[_];var u=GameData.formatRewardItem(p),C=Math.ceil(u.length/4),f=BaseBitmap.create("public_9_bg1");f.width=h.width-20,f.height=120*C,f.x=this.viewBg.x+this.viewBg.width/2-f.width/2,f.y=c.y+c.height+10,this._nodeContainer.addChild(f),h.height=f.height+90;for(var m=f.x+(t.type==AcMayDayView.AID?(500-108*u.length-10*(u.length-1))/2:10),T=f.y+10,_=0;_<u.length;_++){var y=GameData.getItemIcon(u[_],!0),v=y.getChildByName("numLb");v&&(v.visible=!1),_>0&&(m+=y.width+10,_%4==0&&(m=m=f.x+(t.type==AcMayDayView.AID?(500-108*u.length-10*(u.length-1))/2:10),T+=y.height+5)),y.x=m,y.y=T,this._nodeContainer.addChild(y)}},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([])},e.prototype.dispose=function(){this._nodeContainer=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(DailyTaskRewardPreviewPopuiView.prototype,"DailyTaskRewardPreviewPopuiView");var DownloadPackagePopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getTitleStr=function(){return"downloadPackage"},e.prototype.getCloseBtnName=function(){return null},e.prototype.initView=function(){0==App.DeviceUtil.isIOS()?this.initViewAndroid():this.initViewIos()},e.prototype.initViewIos=function(){var t=BaseBitmap.create("public_9_bg4");t.width=520,t.height=240,t.x=this.viewBg.x+this.viewBg.width/2-t.width/2,t.y=10,this.addChildToContainer(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("copyUrlDesc2",[this.getDownloadUrl()]),TextFieldConst.FONTSIZE_CONTENT_COMMON);e.width=480,e.setColor(TextFieldConst.COLOR_BLACK),e.textAlign=TextFieldConst.ALIGH_CENTER,e.x=this.viewBg.x+this.viewBg.width/2-e.width/2,e.y=t.y+t.height/2-e.height/2-20,e.lineSpacing=10,this.addChildToContainer(e);var i=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"copyUrl",this.clickCopyHandler,this);i.setColor(TextFieldConst.COLOR_BLACK),i.x=t.x+t.width/2-i.width/2,i.y=t.y+t.height+20,this.addChildToContainer(i)},e.prototype.initViewAndroid=function(){var t=BaseBitmap.create("public_9_bg4");t.width=520,t.height=120,t.x=this.viewBg.x+this.viewBg.width/2-t.width/2,t.y=9,this.addChildToContainer(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("downloadPackageDesc"),TextFieldConst.FONTSIZE_CONTENT_COMMON);e.width=480,e.setColor(TextFieldConst.COLOR_BLACK),e.textAlign=TextFieldConst.ALIGH_CENTER,e.x=this.viewBg.x+this.viewBg.width/2-e.width/2,e.y=t.y+t.height/2-e.height/2,e.lineSpacing=10,this.addChildToContainer(e);var i=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"downloadPackage",this.clickConHandler,this);i.setColor(TextFieldConst.COLOR_BLACK),i.x=t.x+t.width/2-i.width/2,i.y=t.y+t.height+20,this.addChildToContainer(i);var a=BaseBitmap.create("public_9_bg4");a.width=520,a.height=240,a.x=this.viewBg.x+this.viewBg.width/2-t.width/2,a.y=i.y+80,this.addChildToContainer(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("copyUrlDesc",[this.getDownloadUrl()]),TextFieldConst.FONTSIZE_CONTENT_COMMON);n.width=480,n.setColor(TextFieldConst.COLOR_BLACK),n.textAlign=TextFieldConst.ALIGH_CENTER,n.x=this.viewBg.x+this.viewBg.width/2-n.width/2,n.y=a.y+a.height/2-n.height/2-20,n.lineSpacing=10,this.addChildToContainer(n);var o=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"copyUrl",this.clickCopyHandler,this);o.setColor(TextFieldConst.COLOR_BLACK),o.x=t.x+t.width/2-o.width/2,o.y=a.y+a.height+20,this.addChildToContainer(o)},e.prototype.clickConHandler=function(t){App.DeviceUtil.IsHtml5()&&window.open(this.getDownloadUrl())},e.prototype.clickCopyHandler=function(t){var e=this.getDownloadUrl(),i=document.createElement("input");i.value=e,document.body.appendChild(i),i.select(),i.setSelectionRange(0,i.value.length),document.execCommand("Copy"),document.body.removeChild(i),App.CommonUtil.showTip(LanguageManager.getlocal("copyUrlSuccessed"))},e.prototype.getDownloadUrl=function(){var t;return t=0==App.DeviceUtil.isIOS()?"http://yxfile.gowan8.com/apk/lyjd/zjwl_lyjd_ly_gwhf.apk":"https://itunes.apple.com/cn/app/id1330534234"},e.prototype.getBgExtraHeight=function(){return 20},e}(PopupView);__reflect(DownloadPackagePopupView.prototype,"DownloadPackagePopupView");var ErrorPopupView=function(t){function e(){var e=t.call(this)||this;return e._callback=null,e}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=520,t.height=124,t.x=this.viewBg.x+this.viewBg.width/2-t.width/2,t.y=9,this.addChildToContainer(t);var e=this.param.data.msg,i=new BaseTextField;i.text=e,i.size=TextFieldConst.FONTSIZE_CONTENT_COMMON,i.x=this.getShowWidth()/2-i.width/2,i.y=30,this.height=200,this.addChildToContainer(i)},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this),this.setConfirmBtnPosition(this.viewBg.x+this.viewBg.width/2-86-27,70)},e.prototype.getConfirmBtnStr=function(){return"sysConfirm"},e.prototype.getConfirmBtnName=function(){return ButtonConst.BTN_NORMAL_YELLOW},e.prototype.getTitleStr=function(){return"loginFail"},e.prototype.getCloseBtnName=function(){return null},e.prototype.hide=function(){this.param.data.callback&&this.param.data.callback.apply(),t.prototype.hide.call(this)},e.prototype.dispose=function(){this._callback=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(ErrorPopupView.prototype,"ErrorPopupView");var ItemInfoPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=390,t.height=170,t.x=158,t.y=70-this.getContainerY(),this.addChildToContainer(t);var e=null;if("string"==typeof this.param.data||"number"==typeof this.param.data){if(e=Config.ItemCfg.getItemCfgById(Number(this.param.data)),!e)return void App.LogUtil.show("调用道具详情界面清传入道具id或者传入RewardItemVo")}else if(this.param.data instanceof RewardItemVo)e=this.param.data;else{if(!this.param.data.dType||"json"!=this.param.data.dType)return void App.LogUtil.show("调用道具详情界面清传入道具id或者传入RewardItemVo");e=this.param.data}var i=e.name,a=(e.icon,e.desc),n=e.dropDesc,o=LanguageManager.getlocal("effectTitle"),s=LanguageManager.getlocal("dropTitle");this.titleTF.text=i;var r=GameData.getItemIcon(e,!1),l=r.getChildByName("numLb");l&&(l.visible=!1),r.x=40,r.y=95-this.getContainerY(),this.addChildToContainer(r);var h=ComponentManager.getTextField(o,TextFieldConst.FONTSIZE_CONTENT_SMALL);h.setColor(TextFieldConst.COLOR_LIGHT_YELLOW),h.x=171,h.y=37,this.addChildToContainer(h);var d=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_SMALL);d.x=h.x+h.width,d.y=h.y,d.width=310,this.addChildToContainer(d);var g=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_SMALL);g.setColor(TextFieldConst.COLOR_LIGHT_YELLOW),g.x=171,g.y=109,this.addChildToContainer(g);var c=ComponentManager.getTextField(n,TextFieldConst.FONTSIZE_CONTENT_SMALL);c.x=g.x+g.width,c.y=g.y,c.width=310,this.addChildToContainer(c)},e.prototype.isTouchMaskClose=function(){return!0},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([])},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(PopupView);__reflect(ItemInfoPopupView.prototype,"ItemInfoPopupView");var ItemJumpPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this.param.data.cancelCallback&&(this._cancelCallback=this.param.data.cancelCallback),this._confirmCallback=this.param.data.confirmCallback,this._handler=this.param.data.handler;var t=Config.ItemCfg.getItemCfgById(Number(this.param.data.itemId)),e=(t.icon,t.iconBg),i=LanguageManager.getlocal("itemJumpDesc",[t.name]),a=BaseBitmap.create("public_9_bg4");a.width=520,a.height=224,a.x=this.viewBg.x+this.viewBg.width/2-a.width/2,a.y=9,this.addChildToContainer(a);var n=this.viewBg.x+this.viewBg.width/2-50,o=29,s=100,r=BaseBitmap.create(e);r.x=n,r.y=o,this.addChildToContainer(r);var l=GameData.getItemIcon(t,!0);l.x=n,l.y=o,this.addChildToContainer(l);var h=ComponentManager.getTextField(i,TextFieldConst.FONTSIZE_CONTENT_SMALL);h.width=480,h.setColor(TextFieldConst.COLOR_BLACK),h.textAlign=TextFieldConst.ALIGH_CENTER,h.x=this.viewBg.x+this.viewBg.width/2-h.width/2,h.y=o+s+25,this.addChildToContainer(h),this._cancelBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"cancelBtn",this.clickCancelHandler,this),this._cancelBtn.x=this.viewBg.x+this.viewBg.width/4-this._cancelBtn.width/2,this._cancelBtn.y=a.y+a.height+15,this._cancelBtn.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(this._cancelBtn)},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this),this.setConfirmBtnPosition(this.viewBg.x+this.viewBg.width/4*3-this._cancelBtn.width/2-35,this._cancelBtn.y)},e.prototype.clickConfirmHandler=function(t){ViewController.getInstance().openView(ViewConst.COMMON.SHOPVIEW_TAB1),this.hide()},e.prototype.getConfirmBtnStr=function(){return"sysConfirm"},e.prototype.clickCancelHandler=function(t){this._cancelCallback&&this._cancelCallback.apply(this._handler,[]),this.hide()},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([])},e.prototype.getTitleStr=function(){return"itemUseConstPopupViewTitle"},e.prototype.getConfirmBtnName=function(){return ButtonConst.BTN_NORMAL_YELLOW},e.prototype.dispose=function(){this._cancelCallback=null,this._confirmCallback=null,this._handler=null,this._cancelBtn=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(ItemJumpPopupView.prototype,"ItemJumpPopupView");var ItemUseConstPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=this.param.data,e=t.id;t.cancelCallback&&(this._cancelCallback=t.cancelCallback),this._confirmCallback=t.confirmCallback,this._handler=t.handler;var i=(t.icon,t.iconBg),a=t.msg,n=t.num,o=t.useNum||0,s=BaseBitmap.create("public_9_bg4");s.width=520,s.height=224,s.x=this.viewBg.x+this.viewBg.width/2-s.width/2,s.y=9,this.addChildToContainer(s);var r=this.viewBg.x+this.viewBg.width/2-50,l=29,h=100,d=BaseBitmap.create(i);d.x=r,d.y=l,this.addChildToContainer(d);var g=Config.ItemCfg.getItemCfgById(Number(e));g||(g=GameData.getRewardItemVoByIdAndType(e));var c=GameData.getItemIcon(g,!0);c.x=r,c.y=l,this.addChildToContainer(c);var p=ComponentManager.getTextField(o.toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL);p.x=r+98-p.width,p.y=l+98-p.height,this.addChildToContainer(p);var _=LanguageManager.getlocal(n>=o?"itemUseNewTip":"itemUseNewTip2",[g.name,App.StringUtil.toString(n)]);a+="\n"+_;var u=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_SMALL);u.width=480,u.setColor(TextFieldConst.COLOR_BLACK),u.textAlign=TextFieldConst.ALIGH_CENTER,u.x=this.viewBg.x+this.viewBg.width/2-u.width/2,u.y=l+h+25,u.lineSpacing=20,this.addChildToContainer(u),this._cancelBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"cancelBtn",this.clickCancelHandler,this),this._cancelBtn.x=this.viewBg.x+this.viewBg.width/4-this._cancelBtn.width/2,this._cancelBtn.y=s.y+s.height+15,this._cancelBtn.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(this._cancelBtn)},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this),this.setConfirmBtnPosition(this.viewBg.x+this.viewBg.width/4*3-this._cancelBtn.width/2-35,this._cancelBtn.y)},e.prototype.clickConfirmHandler=function(t){return this.param.data.useNum&&this.param.data.useNum>this.param.data.num?("itemicon1"==this.param.data.icon?App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough")):App.CommonUtil.showTip(LanguageManager.getlocal("itemNumNotEnough")),void this.hide()):(App.LogUtil.log("clickConfirmHandler"),this._confirmCallback&&this._confirmCallback.apply(this._handler,[]),void this.hide())},e.prototype.getConfirmBtnStr=function(){return"sysConfirm"},e.prototype.clickCancelHandler=function(t){this._cancelCallback&&this._cancelCallback.apply(this._handler,[]),this.hide()},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([])},e.prototype.getConfirmBtnName=function(){return ButtonConst.BTN_NORMAL_YELLOW},e.prototype.dispose=function(){this._cancelCallback=null,this._confirmCallback=null,this._handler=null,this._cancelBtn=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(ItemUseConstPopupView.prototype,"ItemUseConstPopupView");var ItemUsePopupView=function(t){function e(){var e=t.call(this)||this;return e._useNum=1,e._maxNum=0,e}return __extends(e,t),e.prototype.initView=function(){var t=this.param.data.itemId,e=Api.itemVoApi.getItemInfoVoById(t);this._useCallback=this.param.data.callback,this._handler=this.param.data.handler;var i=e.name;e.icon,e.desc;this._maxNum=e.num,this.param.data.maxNum&&(this._maxNum=Math.min(this.param.data.maxNum,Api.itemVoApi.getItemNumInfoVoById(t))),this._maxNum>100&&(this._maxNum=100);var a=(LanguageManager.getlocal("effectTitle"),BaseBitmap.create("public_9_bg4"));a.width=520,a.height=224,a.x=this.viewBg.x+this.viewBg.width/2-a.width/2,a.y=9,this.addChildToContainer(a);var n=35,o=23,s=100,r=100,l=BaseBitmap.create(e.iconBg);l.x=n,l.y=o,this.addChildToContainer(l);var h=Config.ItemCfg.getItemCfgById(Number(t));h||(h=GameData.getRewardItemVoByIdAndType(t));var d=GameData.getItemIcon(h,!0);d.x=n,d.y=o,this.addChildToContainer(d);var g=ComponentManager.getTextField(e.num.toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL);g.x=n+l.width-g.width-5,g.y=o+l.height-g.height-5,this.addChildToContainer(g);var c=BaseBitmap.create("public_9_bg1");c.width=387,c.height=r,c.x=n+s+10,c.y=o,this.addChildToContainer(c);var p=ComponentManager.getTextField(i,TextFieldConst.FONTSIZE_CONTENT_COMMON);p.setColor(TextFieldConst.COLOR_LIGHT_RED),p.x=c.x+8,p.y=c.y+8,this.addChildToContainer(p);var _=e.getDescTxt(!0);_.x=p.x,_.y=p.y+p.height+5,_.width=366,this.addChildToContainer(_);var u=ComponentManager.getDragProgressBar("progress2","progress2_bg",this._maxNum,this.dragCallback,this);u.x=n+55,u.y=c.y+c.height+27,this.addChildToContainer(u),this._numBg=BaseBitmap.create("public_9_bg5"),this._numBg.width=90,this._numBg.x=a.x+a.width-10-this._numBg.width,this._numBg.y=c.y+c.height+20,this.addChildToContainer(this._numBg),this._selectedNumTF=ComponentManager.getTextField(this._useNum+"",TextFieldConst.FONTSIZE_CONTENT_SMALL),this._selectedNumTF.textAlign=TextFieldConst.ALIGH_LEFT,this._selectedNumTF.setColor(TextFieldConst.COLOR_WARN_YELLOW),this._selectedNumTF.y=this._numBg.y+this._numBg.height/2-this._selectedNumTF.height/2,this.addChildToContainer(this._selectedNumTF),this._maxNumTF=ComponentManager.getTextField("/"+this._maxNum.toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL),this._maxNumTF.textAlign=TextFieldConst.ALIGH_RIGHT,this._maxNumTF.y=this._numBg.y+this._numBg.height/2-this._maxNumTF.height/2,this.addChildToContainer(this._maxNumTF);var C=this._selectedNumTF.width+this._maxNumTF.width;this._selectedNumTF.x=this._numBg.x+(this._numBg.width-C)/2,this._maxNumTF.x=this._selectedNumTF.x+this._selectedNumTF.width;var f=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"useBtn",this.useHandler,this);f.x=a.x+a.width/2-f.width/2,f.y=a.y+a.height+15,f.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(f)},e.prototype.dragCallback=function(t){this._useNum=t,this._selectedNumTF.text=this._useNum+"";var e=this._selectedNumTF.width+this._maxNumTF.width;this._selectedNumTF.x=this._numBg.x+(this._numBg.width-e)/2,this._maxNumTF.x=this._selectedNumTF.x+this._selectedNumTF.width},e.prototype.useHandler=function(t){this._useCallback.apply(this._handler,[this._useNum,this.param.data.itemId]),this.hide()},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["progress2_bg","progress2"])},e.prototype.dispose=function(){this._useCallback=null,this._useNum=1,this._selectedNumTF&&(this.removeChildFromContainer(this._selectedNumTF),this._selectedNumTF.dispose(),this._selectedNumTF=null),this._maxNumTF&&(this.removeChildFromContainer(this._maxNumTF),this._maxNumTF.dispose(),this._maxNumTF=null),this._maxNum=0,this._numBg&&(this.removeChildFromContainer(this._numBg),this._numBg.dispose(),this._numBg=null),this._handler=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(ItemUsePopupView.prototype,"ItemUsePopupView");var MainTaskPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_TASK_GETMAINTASK),this.doCollectCallback,this),Api.rookieVoApi.checkNextStep(),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var t=BaseBitmap.create("public_9_bg4");t.width=520,t.height=290,t.x=this.viewBg.x+this.viewBg.width/2-t.width/2,t.y=9,this._nodeContainer.addChild(t);var e=BaseBitmap.create("public_9_bg1");e.width=t.width-20,e.height=120,e.x=this.viewBg.x+this.viewBg.width/2-e.width/2,this._nodeContainer.addChild(e),this._rewardContainer=new BaseDisplayObjectContainer,this._nodeContainer.addChild(this._rewardContainer);var i=35,a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_YELLOW);a.x=60,a.y=25,this._nodeContainer.addChild(a),this._taskNameTxt=a;var n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);n.x=a.x,n.y=a.y+i,this._nodeContainer.addChild(n),this._taskDescTxt=n;var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);o.x=a.x,o.y=n.y+i,this._nodeContainer.addChild(o),this._taskAimTxt=o;var s=ComponentManager.getTextField(LanguageManager.getlocal("taskReward"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);s.x=a.x,s.y=o.y+i,this._nodeContainer.addChild(s),this._rewardContainer.y=s.y+i+5,this._rewardContainer.x=a.x,e.y=this._rewardContainer.y-10;var r=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"taskGoBtn",this.goHandler,this);r.x=t.x+t.width/2-r.width/2,r.y=t.y+t.height+15,r.setColor(TextFieldConst.COLOR_BLACK),this._nodeContainer.addChild(r),this._goBtn=r,this.refreshUIInfo()},e.prototype.refreshUIInfo=function(){this._taskId=Api.mainTaskVoApi.getCurMainTaskId();var t=Config.MaintaskCfg.getTaskCfgByTaskId(this._taskId);if(this._taskId&&t){this._collectFlag&&(this._collectFlag.visible=!1),this._goBtn.visible=!0;var e=Api.mainTaskVoApi.getCurTaskNameAndDescTxt();this._taskDescTxt.text=e[1],this._taskNameTxt.text=e[0];var i=TextFieldConst.COLOR_WARN_RED;Api.mainTaskVoApi.isCurTaskReach()&&(i=TextFieldConst.COLOR_QUALITY_GREEN),this._taskAimTxt.text=LanguageManager.getlocal("taskAim",[String(i),String(Api.mainTaskVoApi.getCurMainTaskValue())+"/"+String(t.value)]);var a=GameData.formatRewardItem(t.reward);this._rewardContainer.removeChildren();for(var n=0;n<a.length;n++){var o=GameData.getItemIcon(a[n],!0,!0);o.x=n*(o.width+10),this._rewardContainer.addChild(o)}Api.mainTaskVoApi.getCurMainTaskValue()>=t.value?(this._goBtn.setText("taskCollect"),this._collectEnable=!0):(this._goBtn.setText("taskGoBtn"),this._collectEnable=!1)}},e.prototype.doCollectCallback=function(){this._goBtn.visible=!1;var t=Config.MaintaskCfg.getTaskCfgByTaskId(this._taskId),e=GameData.formatRewardItem(t.reward);App.CommonUtil.playRewardFlyAction(e),null==this._collectFlag&&(this._collectFlag=BaseBitmap.create("collectflag"),this._collectFlag.anchorOffsetX=this._collectFlag.width/2,this._collectFlag.anchorOffsetY=this._collectFlag.height/2,this._collectFlag.x=this._goBtn.x+this._collectFlag.anchorOffsetX,this._collectFlag.y=this._goBtn.y+this._collectFlag.anchorOffsetY-30,this._nodeContainer.addChild(this._collectFlag)),this._collectFlag.setScale(1.3),this._collectFlag.visible=!0;var i=this;egret.Tween.get(this._collectFlag,{loop:!1}).to({scaleX:.8,scaleY:.8},400).wait(600).call(function(){i.refreshUIInfo()})},e.prototype.goHandler=function(){if("1"==String(this._taskId)){var t="mtask_"+this._taskId+"_1";StatisticsHelper.reportLoadData(t)}if(this._collectEnable)return void NetManager.request(NetRequestConst.REQUEST_TASK_GETMAINTASK,{taskId:this._taskId});var e=Config.MaintaskCfg.getTaskCfgByTaskId(this._taskId),i=e.questType;e.value;switch(i){case 105:ViewController.getInstance().openView(ViewConst.COMMON.PROMOTIONVIEW);break;case 201:ViewController.getInstance().openView(ViewConst.COMMON.SERVANTINFOVIEW,e.need);break;case 302:case 305:case 306:ViewController.getInstance().openView(ViewConst.COMMON.WIFEOPTVIEW,{id:"101",handler:null});break;default:var a=e.openType;if("alliance"==a)Api.allianceVoApi.openMainView();else if("studyatk"==a)Api.studyatkVoApi.openMainView();else if("welfare"==a)ViewController.getInstance().openView("WelfareView|"+e.openNeed);else if("level"==a||"arrival"==a||""==a)ViewController.getInstance().openView(ViewConst.COMMON.PROMOTIONVIEW);else{var n=App.StringUtil.firstCharToUper(a);egret.getDefinitionByName(n+"View")?ViewController.getInstance().openView(n+"View"):egret.getDefinitionByName(n+"PopupView")&&ViewController.getInstance().openView(n+"PopupView")}}this.hide()},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["itemeffect"])},e.prototype.closeHandler=function(){if("1"==String(this._taskId)){var t="mtask_"+this._taskId+"_0";StatisticsHelper.reportLoadData(t)}this.hide()},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_TASK_GETMAINTASK),this.doCollectCallback,this),this._nodeContainer=null,this._rewardContainer=null,this._taskId=null,this._taskDescTxt=null,this._taskAimTxt=null,this._taskNameTxt=null,this._goBtn=null,this._collectEnable=!1,this._collectFlag=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(MainTaskPopupView.prototype,"MainTaskPopupView");var NamePopupView=function(t){function e(){var e=t.call(this)||this;return e._initName="",e}return __extends(e,t),e.prototype.initView=function(){var t=this.param.data.name,e=0;t||(t="测试测试"),2==this._type&&(e=20);var i=BaseBitmap.create("public_9_bg4");i.width=520,i.height=224,i.x=this.viewBg.x+this.viewBg.width/2-i.width/2,i.y=9,this.addChildToContainer(i);var a=BaseBitmap.create("public_pen_icon");a.x=100,a.y=i.y+i.height/2-a.height/2-e,this.addChildToContainer(a);var n=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,200,45,"public_9_bg5");if(n.x=this.viewBg.x+this.viewBg.width/2-n.width/2,n.y=i.y+i.height/2-n.height/2-e,this.addChildToContainer(n),this._inputTextField=n.getChildByName("textField"),this._inputTextField.maxChars=6,this._randomBtn=ComponentManager.getButton("btn_random","",this.clickRanomHandler,this),this._randomBtn.x=400,this._randomBtn.y=i.y+i.height/2-this._randomBtn.height/2-e,this._randomBtn.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(this._randomBtn),1==this._type)this.clickRanomHandler();else if(2==this._type){var o=Api.childVoApi.getChildrenInfoVoById(this.param.data.childId);this._inputTextField.text=o.name,this._initName=o.name;var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);s.text=LanguageManager.getlocal("namePopupChangeName1"),s.x=140,s.y=170,this.addChildToContainer(s);var r=BaseBitmap.create("public_icon1");r.x=s.x+s.width+20,r.y=s.y-10,this.addChildToContainer(r);var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN);l.text=Config.ChildbaseCfg.renameGem.toString(),l.x=r.x+r.width+20,l.y=s.y,this.addChildToContainer(l);var h=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);h.text=LanguageManager.getlocal("namePopupChangeName2"),h.x=l.x+l.width+20,h.y=s.y,this.addChildToContainer(h)}else if(3==this._type){var d=Api.adultVoApi.getAdultInfoVoById(this.param.data.childId);this._inputTextField.text=d.name,this._initName=d.name;var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);s.text=LanguageManager.getlocal("namePopupChangeName1"),s.x=140,s.y=170,this.addChildToContainer(s);var r=BaseBitmap.create("public_icon1");r.x=s.x+s.width+20,r.y=s.y-10,this.addChildToContainer(r);var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN);l.text=Config.ChildbaseCfg.renameGem.toString(),l.x=r.x+r.width+20,l.y=s.y,this.addChildToContainer(l);var h=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);h.text=LanguageManager.getlocal("namePopupChangeName2"),h.x=l.x+l.width+20,h.y=s.y,this.addChildToContainer(h)}else if(4==this._type){var g=Api.allianceVoApi.getAllianceVo();this._inputTextField.text=g.name,this._initName=g.name;var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);s.text=LanguageManager.getlocal("namePopupChangeName1"),s.x=140,s.y=170,this.addChildToContainer(s);var r=BaseBitmap.create("public_icon1");r.x=s.x+s.width+20,r.y=s.y-10,this.addChildToContainer(r);var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN);l.text=Config.AlliancebaseCfg.renameNeedGem.toString(),l.x=r.x+r.width+20,l.y=s.y,this.addChildToContainer(l);var h=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);h.text=LanguageManager.getlocal("namePopupChangeName3"),h.x=l.x+l.width+20,h.y=s.y,this.addChildToContainer(h),this._randomBtn.visible=!1}this._cancelBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"cancelBtn",this.clickCancelHandler,this),this._cancelBtn.x=this.viewBg.x+this.viewBg.width/4-this._cancelBtn.width/2,this._cancelBtn.y=i.y+i.height+15,this._cancelBtn.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(this._cancelBtn)},e.prototype.clickRanomHandler=function(){var t="";t=1==this._type||2==this._type||3==this._type?Api.playerVoApi.getPlayerName().substring(0,1):LanguageManager.getlocal("userName_firstName"+App.MathUtil.getRandom(1,604));var e=LanguageManager.getlocal("userName_secondName"+App.MathUtil.getRandom(1,3763));this._inputTextField.text=t+e},e.prototype.clickConfirmHandler=function(t){var e=this._inputTextField.text;if(e.length>8)return this._errorText="名字不能超过8位字符",void App.CommonUtil.showTip(this._errorText);if(e.length<=0)return this._errorText="名字不能为空",void App.CommonUtil.showTip(this._errorText);if(!App.StringUtil.userNameCheck(e))return void App.CommonUtil.showTip(LanguageManager.getlocal("guideChangeNameTip1"));if(e.length<2||e.length>6)return void App.CommonUtil.showTip(LanguageManager.getlocal("guideChangeNameTip2"));if(0!=Config.ShieldCfg.checkShield(e)){if(Config.ChildbaseCfg.renameGem>Api.playerVoApi.getPlayerGem()&&2==this._type)return void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough"));if(Config.AlliancebaseCfg.renameNeedGem>Api.playerVoApi.getPlayerGem()&&4==this._type)return void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough"));
if(this._initName==this._inputTextField.text)return void App.CommonUtil.showTip(LanguageManager.getlocal("nameUnChanged"));(1==this._type||2==this._type||3==this._type)&&this.request(NetRequestConst.REQUEST_CHILD_RENAME,{childId:this.param.data.childId,name:this._inputTextField.text}),4==this._type&&this.request(NetRequestConst.REQUEST_ALLIANCE_RENAME,{name:this._inputTextField.text})}},e.prototype.receiveData=function(t){if(t.data.cmd==NetRequestConst.REQUEST_CHILD_RENAME){if(1==t.data.data.samename)return void App.CommonUtil.showTip(LanguageManager.getlocal("namePopupTip1"));this.param.data.confirmCallback&&(this.param.data.confirmCallback.apply(this.param.data.handler,[]),App.CommonUtil.showTip(LanguageManager.getlocal("child_nameTip"))),this.hide()}if(t.data.cmd==NetRequestConst.REQUEST_ALLIANCE_RENAME){if(1==t.data.data.samename)return void App.CommonUtil.showTip(LanguageManager.getlocal("namePopupTip1"));this.param.data.confirmCallback&&this.param.data.confirmCallback.apply(this.param.data.handler,[]),App.CommonUtil.showTip(LanguageManager.getlocal("alliance_nameTip")),this.hide()}},e.prototype.clickCancelHandler=function(t){this.hide()},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this),this.setConfirmBtnPosition(this.viewBg.x+this.viewBg.width/4*3-this._cancelBtn.width/2-35,this._cancelBtn.y)},e.prototype.getConfirmBtnStr=function(){return"sysConfirm"},e.prototype.getConfirmBtnName=function(){return ButtonConst.BTN_NORMAL_YELLOW},e.prototype.getTitleStr=function(){return this._type=this.param.data.type,"namePopupTitle"+this._type},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["shield_cn"])},e.prototype.dispose=function(){this._type=null,this._useCallback=null,this._handler=null,this._inputTextField=null,this._cancelBtn=null,this._errorText=null,this._randomBtn=null,this._initName="",t.prototype.dispose.call(this)},e}(PopupView);__reflect(NamePopupView.prototype,"NamePopupView");var NetErrorPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=520,t.height=124,t.x=this.viewBg.x+this.viewBg.width/2-t.width/2,t.y=9,this.addChildToContainer(t);var e=new BaseTextField;e.text=this.getMessage(),e.size=TextFieldConst.FONTSIZE_CONTENT_COMMON,e.x=this.getShowWidth()/2-e.width/2,e.y=30,this.height=200,this.addChildToContainer(e)},e.prototype.getMessage=function(){return LanguageManager.getlocal("netErrorDesc")},e.prototype.getResourceList=function(){return[]},e.prototype.getParent=function(){return LayerManager.msgLayer},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this),this.setConfirmBtnPosition(this.viewBg.x+this.viewBg.width/2-86-27,70)},e.prototype.getConfirmBtnStr=function(){return"sysConfirm"},e.prototype.getConfirmBtnName=function(){return ButtonConst.BTN_NORMAL_YELLOW},e.prototype.getTitleStr=function(){return"itemUseConstPopupViewTitle"},e.prototype.getCloseBtnName=function(){return null},e.prototype.clickConfirmHandler=function(t){this.hide(),NetManager.socket.checkAndReConnect(),NetManager.chat.checkAndReConnect()},e}(PopupView);__reflect(NetErrorPopupView.prototype,"NetErrorPopupView");var OfflineView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(ConfirmPopupView);__reflect(OfflineView.prototype,"OfflineView");var PalaceEditSignPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_PALACE_SIGN),this.editBtnhandlerCallback,this);this.param.data;this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var t=520,e=100,i=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_CONTENT_SMALL,t,e,"public_9_bg4",LanguageManager.getlocal("palace_editTip"),TextFieldConst.COLOR_WHITE);i.x=this.viewBg.x+this.viewBg.width/2-t/2,i.y=9;var a=i.getChildByName("textField");a.y-=30,this._nodeContainer.addChild(i),this._inputTextField=i.getChildByName("textField"),this._inputTextField.height=e,this._inputTextField.width=t,this._inputTextField.maxChars=20;var n=ComponentManager.getTextField(LanguageManager.getlocal("palace_editTip2"),20,TextFieldConst.COLOR_BROWN);n.x=this.viewBg.x+this.viewBg.width/2-n.width/2,n.y=i.y+e+9,this._nodeContainer.addChild(n);var o=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"sysConfirm",this.editBtnhandler,this);o.x=i.x+t/2-o.width/2,o.y=n.y+n.height+15,o.setColor(TextFieldConst.COLOR_BLACK),this._nodeContainer.addChild(o)},e.prototype.editBtnhandlerCallback=function(t){var e=this.param.data;Api.palaceVoApi.updateRoleSign(e,this._inputTextField.text),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_REFRESHSIGN_AFTER_EDIT,e),App.CommonUtil.showTip(LanguageManager.getlocal("palace_edit_succeed")),this.hide()},e.prototype.editBtnhandler=function(){return this._inputTextField.bindData||(this._inputTextField.bindData="",this._inputTextField.text=""),0==Config.ShieldCfg.checkOnlyShield(this._inputTextField.text)?void App.CommonUtil.showTip(LanguageManager.getlocal("chatShieldTip")):void NetManager.request(NetRequestConst.REQUEST_PALACE_SIGN,{sign:this._inputTextField.text,titleId:this.param.data})},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["shield_cn"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_PALACE_SIGN),this.editBtnhandlerCallback,this),this._nodeContainer=null,this._inputTextField=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(PalaceEditSignPopupView.prototype,"PalaceEditSignPopupView");var PalaceHistoryPopupView=function(t){function e(){var e=t.call(this)||this;return e._rankData=[],e}return __extends(e,t),e.prototype.initView=function(){this._nodeContainer=new BaseDisplayObjectContainer;var t=this.param.data.titleId,e=Config.TitleCfg.getTitleCfgById(t),i=e.isCross,a=e.isOnly,n=10,o=BaseBitmap.create("public_9_probiginnerbg");o.width=520,o.height=640,o.x=this.viewBg.width/2-o.width/2,o.y=n,this.addChildToContainer(o);var s=BaseBitmap.create("public_9_bg37");s.width=o.width,s.height=40,s.x=o.x,s.y=o.y,this.addChildToContainer(s);var r=this._rankData;if(0==r.length||0==Object.keys(r).length){var l=ComponentManager.getTextField(LanguageManager.getlocal("palace_history_empty"),20,TextFieldConst.COLOR_LIGHT_YELLOW);l.x=o.x+o.width/2-l.width/2,l.y=o.y+o.height/2-l.height/2+10,this.addChildToContainer(l)}var h=ComponentManager.getTextField(LanguageManager.getlocal("palace_history_title1"),20,TextFieldConst.COLOR_LIGHT_YELLOW);h.x=s.x+20,h.y=s.y+s.height/2-h.height/2,this.addChildToContainer(h);var d=ComponentManager.getTextField(LanguageManager.getlocal("palace_history_title2"),h.size,TextFieldConst.COLOR_LIGHT_YELLOW);d.x=s.x+150,d.y=h.y,this.addChildToContainer(d);var g=ComponentManager.getTextField(LanguageManager.getlocal("palace_history_title3"),h.size,TextFieldConst.COLOR_LIGHT_YELLOW);0==a&&(g.text=LanguageManager.getlocal("rankpower")),g.x=s.x+380,g.y=h.y,this.addChildToContainer(g);var c;1==i&&(d.x-=30,g.x+=20,c=ComponentManager.getTextField(LanguageManager.getlocal("atkraceServerDesc"),h.size,TextFieldConst.COLOR_LIGHT_YELLOW),c.x=s.x+260,c.y=h.y,this.addChildToContainer(c)),n=5;for(var p=r.length,_=TextFieldConst.COLOR_WHITE,u=0;p>u;u++){r[u][0]==Api.playerVoApi.getPlayerID()&&(_=TextFieldConst.COLOR_LIGHT_YELLOW);var C=ComponentManager.getTextField(String(u+1),h.size,_);C.x=h.x+h.width/2-C.width/2,C.y=n,this._nodeContainer.addChild(C);var f=ComponentManager.getTextField(r[u][1],h.size,_);f.width=600,f.textAlign=egret.HorizontalAlign.CENTER,f.anchorOffsetX=f.width/2,f.x=d.x+d.width/2,f.y=n,this._nodeContainer.addChild(f);var m=ComponentManager.getTextField("",h.size,_);if(0==a?m.text=r[u][2]:m.text=App.DateUtil.getFormatBySecond(r[u][2],2),m.x=g.x+g.width/2-m.width/2,m.y=n,this._nodeContainer.addChild(m),1==i){var T=ComponentManager.getTextField("",h.size);T.text=LanguageManager.getlocal("palace_history_title4",[r[u][3]]),T.x=c.x+c.width/2-T.width/2,T.y=n,this._nodeContainer.addChild(T)}var y=BaseBitmap.create("public_line1");y.x=this.viewBg.width/2-y.width/2,y.y=n+30,this._nodeContainer.addChild(y),n+=45}this._nodeContainer.height+=20;var v=new egret.Rectangle(0,10,this.viewBg.width,o.height-+s.height-5),A=ComponentManager.getScrollView(this._nodeContainer,v);A.horizontalScrollPolicy="off",A.y=o.y+s.height+5,this.addChildToContainer(A)},e.prototype.getShowHeight=function(){return 760},e.prototype.getRequestData=function(){var t=this.param.data.titleId;return{requestType:NetRequestConst.REQUEST_PALACE_GETPALACERANK,requestData:{titleId:t}}},e.prototype.receiveData=function(t){1==t.ret&&(this._rankData=t.data.data.palacerank)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([])},e.prototype.getTitleStr=function(){return"palaceHistoryPopupViewTitle2"},e.prototype.getTitleParams=function(){return[LanguageManager.getlocal("palace_titleName"+this.param.data.titleId)]},e.prototype.dispose=function(){this._nodeContainer=null,this._rankData=[],t.prototype.dispose.call(this)},e.titleId="",e}(PopupView);__reflect(PalaceHistoryPopupView.prototype,"PalaceHistoryPopupView");var SocketStateConst;!function(t){t.SOCKET_CONNECTED="socket_connect",t.SOCKET_RECONNECTED="socket_reconnect",t.SOCKET_START_RECONNECT="socket_start_reconnect",t.SOCKET_CLOSE="socket_close",t.SOCKET_DATA="socket_data",t.SOCKET_NOCONNECT="socket_noconnect"}(SocketStateConst||(SocketStateConst={}));var SocketStateEnum;!function(t){t[t.STATE_INIT=0]="STATE_INIT",t[t.STATE_CONNECTING=1]="STATE_CONNECTING",t[t.STATE_CONNECTED=2]="STATE_CONNECTED",t[t.STATE_RECONNECTING=3]="STATE_RECONNECTING",t[t.STATE_RECONNECTED=4]="STATE_RECONNECTED",t[t.STATE_NOCONNECT=5]="STATE_NOCONNECT"}(SocketStateEnum||(SocketStateEnum={}));var RankUserinfoPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=this.param.data;this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer),this._bottomnodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._bottomnodeContainer);var e=550,i=BaseBitmap.create("playerview_bg2");i.setScale(e/i.width),i.x=10,this._nodeContainer.addChild(i);var a=BaseBitmap.create("playerview_name_bg");a.scaleX=.85,a.x=GameConfig.stageWidth-a.width-40,a.y=240,this._nodeContainer.addChild(a);var n=a.x+100,o=a.y,s=ComponentManager.getTextField(t.name,TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);s.stroke=1,s.borderColor=TextFieldConst.COLOR_BLACK,s.x=n-s.width/2,s.y=o+7,this._nodeContainer.addChild(s);var r=LanguageManager.getlocal("uidTitle")+":"+t.ruid,l=ComponentManager.getTextField(r,20,TextFieldConst.COLOR_LIGHT_YELLOW);l.x=s.x,l.y=s.y+s.height+5,this._nodeContainer.addChild(l);var h=t.gname;""==h&&(h=LanguageManager.getlocal("allianceRankNoAlliance"));var d=LanguageManager.getlocal("acRank_myAlliancenick"),g=ComponentManager.getTextField(d+h,20,TextFieldConst.COLOR_WARN_YELLOW);g.x=s.x,g.y=l.y+l.height+5,this._nodeContainer.addChild(g);var c=LanguageManager.getlocal("playerview_Nopo"),p=t.po;p>0&&(c=LanguageManager.getlocal("allianceMemberPo"+p));var _=ComponentManager.getTextField(LanguageManager.getlocal("alliance_po")+": "+c,20,TextFieldConst.COLOR_WARN_YELLOW);if(_.x=s.x,_.y=g.y+g.height+5,this._nodeContainer.addChild(_),t.vip>0){var u=BaseBitmap.create("playerview_wipbg");u.x=s.x,u.y=a.y-37,u.scaleY=1.3,this._nodeContainer.addChild(u);var C=BaseLoadBitmap.create(Api.vipVoApi.getVipCfgByLevel(t.vip).icon);C.width=80,C.height=35,C.x=u.x,C.y=u.y+2,this._nodeContainer.addChild(C)}var f=t.level,m=20;""!=t.title&&(f=t.title,m=-10);var T=Api.playerVoApi.getPlayerPortrait(f,t.pic);T.mask=egret.Rectangle.create().setTo(0,0,T.width,500),T.x=m,T.y=40,T.name="userContainer",this._nodeContainer.addChild(T);var y=0;this._bottomnodeContainer.y=410;var v=(i.y+i.height,BaseBitmap.create("playerview_powerbg"));v.x=50,v.y=this._bottomnodeContainer.y-60,this._nodeContainer.addChild(v);var A=BaseBitmap.create("playerview_power_img");A.x=v.x+30,A.y=v.y+20,this._nodeContainer.addChild(A);var w=ComponentManager.getTextField(App.StringUtil.changeIntToText(t.power),24,TextFieldConst.COLOR_LIGHT_YELLOW);w.name="powerTxt",w.x=A.x+A.width+2,w.y=A.y+A.height/2-w.height/2,this._nodeContainer.addChild(w);var x=BaseBitmap.create("palace_rewardbg");x.width=260,x.height=40,x.x=v.x-10,x.y=A.y-55,this._nodeContainer.addChild(x);var I=ComponentManager.getTextField(LanguageManager.getlocal("mainui_officer"),24,TextFieldConst.COLOR_LIGHT_YELLOW);I.name="powerTxt",I.x=A.x,I.y=x.y+x.height/2-I.height/2,this._nodeContainer.addChild(I);var L=ComponentManager.getBitmapText(Api.playerVoApi.getPlayerOfficeByLevel(t.level),"office_fnt");L.name="officeTF",L.setScale(.9),L.x=I.x+I.width-5,L.y=I.y+I.height/2-L.height/2-2,this._nodeContainer.addChild(L);var E=BaseBitmap.create("playerview_probg");E.x=10,E.height=106,E.scaleX=e/E.width,E.y=y;var B=BaseBitmap.create("servant_mask");B.width=e,B.x=10;var S=BaseBitmap.create("public_9_bg22");S.scaleX=e/S.width,S.height=182,S.x=10,S.y=E.y+E.height-10,B.y=S.y-B.height,this._bottomnodeContainer.addChild(B),this._bottomnodeContainer.addChild(S),this._bottomnodeContainer.addChild(E);for(var N=E.y+15,M=GameConfig.stageWidth/2,b=1;8>=b;b++){var O=ComponentManager.getTextField("",20,TextFieldConst.COLOR_LIGHT_YELLOW);O.name="proText"+b;var V=0;1==b||4==b||7==b?V=-1:(3==b||6==b||8==b)&&(V=1),M=GameConfig.stageWidth/2+180*V-30,b>1&&b%3==1&&(N+=25);var R=b;b>=7&&(R+=1);var k=BaseBitmap.create("playerview_pro"+R);k.x=M-k.width-20,k.y=N,this._bottomnodeContainer.addChild(k),O.x=M-15,O.y=k.y+2,this._bottomnodeContainer.addChild(O)}this.refreshProTxt();var P=BaseBitmap.create("public_line3");P.width=500,P.x=e/2-P.width/2,P.y=S.y+30,this._bottomnodeContainer.addChild(P);var F=ComponentManager.getTextField(LanguageManager.getlocal("playerRank_title"),22,2565927);F.x=e/2-F.width/2,F.y=P.y+P.height/2-F.height/2,this._bottomnodeContainer.addChild(F);var D=BaseBitmap.create("public_9_bg21");D.width=500,D.height=138,D.x=e/2-D.width/2+S.x,D.y=P.y+30,this._bottomnodeContainer.addChild(D);var G=t.titleinfo,H=D.x+10,U=D.y+10,W=0,Y=0;for(var q in G)if(G[q]>=1){Number(q)<4001&&Y++;var j=BaseLoadBitmap.create("user_title_"+q+"_3"),Q=.8;j.width=155*Q,j.height=59*Q,H>D.x+D.width-100&&(H=D.x+10,U+=40,W+=40),j.x=H,j.y=U,this._bottomnodeContainer.addChild(j),H+=120}if(0==Y){var K=ComponentManager.getTextField(LanguageManager.getlocal("rankUserinfo_noTitle"),20,TextFieldConst.COLOR_BROWN);K.x=e/2-K.width/2,K.y=D.y+D.height/2-K.height/2,this._bottomnodeContainer.addChild(K)}this.cacheAsBitmap=!0;var Z=ComponentManager.getButton(ButtonConst.BTN_SMALL_BLUE,"dinner_shotJoin",this.dinerBtnHandler,this);Z.x=this.viewBg.x+this.viewBg.width-Z.width-10,Z.y=S.y+S.height+15,t.ruid==Api.playerVoApi.getPlayerID()||this.param.data.isDinnerHost?Z.visible=!1:Z.visible=!0,this._bottomnodeContainer.addChild(Z),this._shieldBtn=ComponentManager.getButton(ButtonConst.BTN_SMALL_RED,"chatShield",this.shieldBtnHandler,this),this._shieldBtn.x=this.viewBg.x+10,this._shieldBtn.y=S.y+S.height+15,t.ruid==Api.playerVoApi.getPlayerID()?this._shieldBtn.visible=!1:this._shieldBtn.visible=!0,Api.chatVoApi.getIsBlock(t.ruid)?this._shieldBtn.setText("chatCancelShield"):this._shieldBtn.setText("chatShield"),this._bottomnodeContainer.addChild(this._shieldBtn)},e.prototype.refreshProTxt=function(){for(var t=this.param.data,e=Api.challengeVoApi.getBigChannelIdByCid(t.cid),i=[{txt:LanguageManager.getlocal("playerview_force"),proValue:App.StringUtil.changeIntToText(t.atk),proIcon:""},{txt:LanguageManager.getlocal("playerview_inte"),proValue:App.StringUtil.changeIntToText(t.inte),proIcon:""},{txt:LanguageManager.getlocal("playerview_wife"),proValue:t.wifenum,proIcon:""},{txt:LanguageManager.getlocal("playerview_policy"),proValue:App.StringUtil.changeIntToText(t.politics),proIcon:""},{txt:LanguageManager.getlocal("playerview_charm"),proValue:App.StringUtil.changeIntToText(t.charm),proIcon:""},{txt:LanguageManager.getlocal("playerview_child"),proValue:t.childnum,proIcon:""},{txt:LanguageManager.getlocal("rank_challenge")+": ",proValue:e+"."+LanguageManager.getlocal("challengeTitle"+e),proIcon:"public_icon4"},{txt:LanguageManager.getlocal("rank_imacy2"),proValue:t.imacy,proIcon:"public_icon3"}],a=0;a<i.length;a++){var n=this._bottomnodeContainer.getChildByName("proText"+(a+1));n.text=String(i[a].proValue)}},e.prototype.shieldBtnHandler=function(){var t=this.param.data;if(Api.chatVoApi.getIsBlock(t.ruid)){var e=LanguageManager.getlocal("chatCancelBlockDesc",[t.name]);return void ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"chatCancelShield",msg:e,callback:this.doShield,handler:this,needCancel:!0})}var i=LanguageManager.getlocal("chatShieldDesc",[t.name]);ViewController.getInstance().openView(ViewConst.POPUP.CONFIRMPOPUPVIEW,{title:"chatShield",msg:i,callback:this.doShield,handler:this,needCancel:!0})},e.prototype.doShield=function(){var t=this.param.data;if(Api.chatVoApi.getIsBlock(t.ruid))this.request(NetRequestConst.REQUEST_CHAT_UNBLOCK,{fuid:t.ruid});else{var e=0;if(Api.chatVoApi.getChatBlockVo().info&&(e=Api.chatVoApi.getChatBlockVo().info.length,e||(e=0)),e>=50)return void App.CommonUtil.showTip(LanguageManager.getlocal("chatblockCountMax"));this.request(NetRequestConst.REQUEST_CHAT_BLOCK,{fuid:t.ruid})}},e.prototype.receiveData=function(t){t.data.cmd==NetRequestConst.REQUEST_CHAT_BLOCK?App.CommonUtil.showTip(LanguageManager.getlocal("chatShieldMsg2")):t.data.cmd==NetRequestConst.REQUEST_CHAT_UNBLOCK&&App.CommonUtil.showTip(LanguageManager.getlocal("chatShieldMsg3")),Api.chatVoApi.getIsBlock(this.param.data.ruid)?this._shieldBtn.setText("chatCancelShield"):this._shieldBtn.setText("chatShield")},e.prototype.dinerBtnHandler=function(){return Api.playerVoApi.getPlayerLevel()<Config.DinnerCfg.getNeedLv()?void App.CommonUtil.showTip(Api.dinnerVoApi.getLockedString()):0==this.param.data.ishavedinner?void App.CommonUtil.showTip(LanguageManager.getlocal("dinner_shotJoinTip")):"dinner"==Api.rookieVoApi.curGuideKey?(this.hide(),void App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_DINNER_GUIDE)):(ViewController.getInstance().openView(ViewConst.BASE.GOTODINNEREDVIEW,{info:{uid:this.param.data.ruid,name:this.param.data.name}}),void(this.param.data.isFromDinner&&this.hide()))},e.prototype.getShowHeight=function(){return 795},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["playerview_bg2","playerview_fan","playerview_wipbg","playerview_name_bg","playerview_powerbg","playerview_probg","playerview_pro1","playerview_pro2","playerview_pro3","playerview_pro4","playerview_pro5","playerview_pro6","playerview_pro_inmg2","playerview_infobg","playerview_arrow","playerview_pro7","playerview_pro8","playerview_pro9","progress3","progress3_bg","playerview_lvupBtn","playerview_lvupBtn_down","playerview_power_img","office_fnt","playerview_lvup_word","palace_rewardbg","servant_mask"])},e.prototype.dispose=function(){this._nodeContainer=null,this._bottomnodeContainer=null,this.cacheAsBitmap=!0,t.prototype.dispose.call(this)},e}(PopupView);__reflect(RankUserinfoPopupView.prototype,"RankUserinfoPopupView");var RealnamePopupView=function(t){function e(){var e=t.call(this)||this;return e.rewardArrList=[],e._goBtn=null,e.touchBoo=!1,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_OTHERINFO_GETCERTIFICATION),this.refreshUIInfo,this);var t=BaseBitmap.create("public_9_bg4");t.width=528,t.height=230,t.x=this.viewBg.x+this.viewBg.width/2-t.width/2,t.y=20,this.addChildToContainer(t);var e=Config.GameprojectCfg.rewardFKYLC3;this.rewardArrList=GameData.formatRewardItem(e);for(var i=new BaseDisplayObjectContainer,a=this.rewardArrList.length,n=1,o=0,s=0;a>s;s++){var r=GameData.getItemIcon(this.rewardArrList[s]),l=s%5;r.setPosition((r.width+30)*l,(r.height+20)*Math.floor(s/5)),r.scaleX=n,r.scaleY=n,i.addChild(r),o=(r.height+20)*Math.floor(s/5)}i.setPosition(this.viewBg.x+(this.viewBg.width-i.width)/2,80),this.addChildToContainer(i),this._goBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"realnameBtn",this.collectHandler,this),this._goBtn.x=t.x+t.width/2-this._goBtn.width/2,this._goBtn.y=t.y+t.height-this._goBtn.height/2+55,this.addChildToContainer(this._goBtn),this.restBtnType()},e.prototype.restBtnType=function(){if(Api.otherInfoVoApi.certification()){var t=BaseBitmap.create("collectflag");t.x=this._goBtn.x+20,t.y=this._goBtn.y,t.scaleX=.6,t.scaleY=.6,this.addChildToContainer(t),this._goBtn.visible=!1}},e.prototype.checkRealName=function(){RSDKHelper.getRealNameAuth(function(t){("0"==t||"2"==t)&&(NetManager.request(NetRequestConst.REQUEST_OTHERINFO_GETCERTIFICATION,null),NetManager.request(MessageConst.MESSAGE_REALNAME,null))})},e.prototype.collectHandler=function(t){this.checkRealName()},e.prototype.refreshUIInfo=function(t){t.data.ret&&(this.restBtnType(),App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.data.rewards)))},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_OTHERINFO_GETCERTIFICATION),this.refreshUIInfo,this),this.touchBoo=!1,this._goBtn=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(RealnamePopupView.prototype,"RealnamePopupView");var RuleInfoPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=this.param.data,e=new BaseDisplayObjectContainer,i=ComponentManager.getTextField(t,TextFieldConst.FONTSIZE_CONTENT_SMALL);i.y=3,i.width=510,i.lineSpacing=5,e.addChild(i),e.height=i.height+6;var a=10,n=egret.Rectangle.create();n.setTo(0,0,i.width,200+a+5);var o=ComponentManager.getScrollView(e,n);this.addChildToContainer(o),o.setPosition((GameConfig.stageWidth-o.width)/2,75-a)},e.prototype.isTouchMaskClose=function(){return!0},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["popupview_ruletitle"])},e.prototype.getBgName=function(){return"public_rule_bg"},e.prototype.getCloseBtnName=function(){return null},e.prototype.getShowWidth=function(){return 594},e.prototype.getTitleBgName=function(){return"popupview_ruletitle"},e.prototype.getTitleStr=function(){return""},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(PopupView);__reflect(RuleInfoPopupView.prototype,"RuleInfoPopupView");var ServantAttrDetailPopupView=function(t){function e(){var e=t.call(this)||this;return e._servantId=null,e._servantInfoObj=null,e}return __extends(e,t),e.prototype.initView=function(){this._servantId=this.param.data;var t=Api.servantVoApi.getServantObj(this._servantId);this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer),this._servantInfoObj=t;var e=51,i=BaseBitmap.create("public_9_bg4");i.width=520,i.height=625,i.x=this.viewBg.x+this.viewBg.width/2-i.width/2,i.y=116-e,this._nodeContainer.addChild(i);var a=BaseBitmap.create("public_9_bg3");a.width=272,a.x=this.viewBg.x+this.viewBg.width/2-a.width/2,a.y=65-e,this._nodeContainer.addChild(a);var n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_YELLOW);n.text=LanguageManager.getlocal("servant_attrComplex")+t.total,n.x=a.x+a.width/2-n.width/2,n.y=a.y+a.height/2-n.height/2,this._nodeContainer.addChild(n);for(var o=[{txt1:LanguageManager.getlocal("playerview_force")+t.attrVo.forceTotal,txt1Color:TextFieldConst.COLOR_WARN_YELLOW,txt2:LanguageManager.getlocal("servantAttr_add1")+t.attrVo.forceAdd_1,txt2Color:TextFieldConst.COLOR_BLACK,txt3:LanguageManager.getlocal("servantAttr_add2")+t.attrVo.forceAdd_2,txt4:LanguageManager.getlocal("servantAttr_add3")+t.attrVo.forceAdd_3,txt5:LanguageManager.getlocal("servantAttr_add4")+t.attrVo.forceAdd_4},{txt1:LanguageManager.getlocal("playerview_inte")+t.attrVo.brainsTotal,txt1Color:TextFieldConst.COLOR_WARN_YELLOW,txt2:LanguageManager.getlocal("servantAttr_add1")+t.attrVo.brainsAdd_1,txt2Color:TextFieldConst.COLOR_BLACK,txt3:LanguageManager.getlocal("servantAttr_add2")+t.attrVo.brainsAdd_2,txt4:LanguageManager.getlocal("servantAttr_add3")+t.attrVo.brainsAdd_3,txt5:LanguageManager.getlocal("servantAttr_add4")+t.attrVo.brainsAdd_4},{txt1:LanguageManager.getlocal("playerview_policy")+t.attrVo.politicsTotal,txt1Color:TextFieldConst.COLOR_WARN_YELLOW,txt2:LanguageManager.getlocal("servantAttr_add1")+t.attrVo.politicsAdd_1,txt2Color:TextFieldConst.COLOR_BLACK,txt3:LanguageManager.getlocal("servantAttr_add2")+t.attrVo.politicsAdd_2,txt4:LanguageManager.getlocal("servantAttr_add3")+t.attrVo.politicsAdd_3,txt5:LanguageManager.getlocal("servantAttr_add4")+t.attrVo.politicsAdd_4},{txt1:LanguageManager.getlocal("playerview_charm")+t.attrVo.charmTotal,txt1Color:TextFieldConst.COLOR_WARN_YELLOW,txt2:LanguageManager.getlocal("servantAttr_add1")+t.attrVo.charmAdd_1,txt2Color:TextFieldConst.COLOR_BLACK,txt3:LanguageManager.getlocal("servantAttr_add2")+t.attrVo.charmAdd_2,txt4:LanguageManager.getlocal("servantAttr_add3")+t.attrVo.charmAdd_3,txt5:LanguageManager.getlocal("servantAttr_add4")+t.attrVo.charmAdd_4}],s=135-e,r=0;r<o.length;r++){var l=o[r],h=ComponentManager.getTextField("",18);h.text=l.txt1,h.textColor=l.txt1Color,h.x=60,h.y=s,this._nodeContainer.addChild(h);var d=ComponentManager.getTextField("",18);d.text=l.txt2,d.textColor=l.txt2Color,d.x=h.x,d.y=s+27,this._nodeContainer.addChild(d);var g=ComponentManager.getTextField("",18);g.text=l.txt3,g.textColor=l.txt2Color,g.x=d.x+250,g.y=d.y,this._nodeContainer.addChild(g);var c=ComponentManager.getTextField("",18);c.text=l.txt4,c.textColor=l.txt2Color,c.x=h.x,c.y=d.y+27,this._nodeContainer.addChild(c);var p=ComponentManager.getTextField("",18);p.text=l.txt5,p.textColor=l.txt2Color,p.x=g.x,p.y=c.y,this._nodeContainer.addChild(p);var _=BaseBitmap.create("public_line1");_.x=30,_.y=p.y+27,this._nodeContainer.addChild(_),s+=100}var u=ComponentManager.getTextField("",20);u.text=LanguageManager.getlocal("servant_storyTxt"),u.textColor=TextFieldConst.COLOR_BLACK,u.x=60,u.y=s,this._nodeContainer.addChild(u);var C=BaseBitmap.create("public_9_bg40");C.width=494,C.height=166,C.x=i.x+i.width/2-C.width/2,C.y=u.y+u.height+5,this._nodeContainer.addChild(C);var f=ComponentManager.getTextField("",18);f.text=LanguageManager.getlocal("servant_story"+this._servantId),f.multiline=!0,f.lineSpacing=5,f.width=C.width-20;var m=new BaseDisplayObjectContainer;f.y=7,m.height=f.height+15,m.addChild(f);var T=new egret.Rectangle(0,0,C.width,C.height-15),y=ComponentManager.getScrollView(m,T);y.x=C.x+10,y.y=C.y+8,this._nodeContainer.addChild(y);var v=ComponentManager.getTextField("",18);v.text=LanguageManager.getlocal("servant_storyTip"),v.x=this.viewBg.x+this.viewBg.width-v.width-10,v.y=C.y+C.height+45,this._nodeContainer.addChild(v)},e.prototype.getShowHeight=function(){return 770},e.prototype.dispose=function(){this._nodeContainer=null,this._servantId=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(ServantAttrDetailPopupView.prototype,"ServantAttrDetailPopupView");var ServantSelectedPopupView=function(t){function e(){var e=t.call(this)||this;return e._itemId=0,e._nameTF=null,e._scrollList=null,e._callback=null,e._handler=null,e._selectedServantId=0,e._type=0,e}return __extends(e,t),e.prototype.getType=function(){return Number(this.param.data.type)},e.prototype.getResourceList=function(){var i=[];return(this.getType()==e.TYPE_BATTLE||this.getType()==e.TYPE_BATTLE_REC1||this.getType()==e.TYPE_ALLIANCE)&&i.push("boss_gotowar"),t.prototype.getResourceList.call(this).concat(i)},e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_SELECTED_SERVANT,this.clickItemHandler,this),this._callback=this.param.data.callback,this._handler=this.param.data.handler;var t=Number(this.param.data.type);this._type=t;var i="",a="";if(t==e.TYPE_USE_ITEM){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USE_ITEM),this.useCallback,this),this._itemId=Number(this.param.data.itemId),e.USE_TYOE_ITEMID=this._itemId;var n=Api.itemVoApi.getItemInfoVoById(this._itemId);i=n.name+"x"+n.num,a=n.desc}else t==e.TYPE_BATTLE||t==e.TYPE_BATTLE_REC1||t==e.TYPE_STUDY||t==e.TYPE_ALLIANCE;if(i&&(this._nameTF=ComponentManager.getTextField(i,TextFieldConst.FONTSIZE_CONTENT_SMALL),this._nameTF.x=35,this._nameTF.y=15,this._nameTF.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(this._nameTF)),a){var o=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_SMALL);o.textAlign=TextFieldConst.ALIGH_RIGHT,o.x=this.viewBg.width-35-o.width,o.y=15,o.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(o)}var s=BaseBitmap.create("public_9_bg4");s.width=520,s.height=640,s.x=this.viewBg.x+this.viewBg.width/2-s.width/2,s.y=45,this.addChildToContainer(s),i||a||(s.height+=30,s.y-=30);var r=Api.servantVoApi.getServantInfoListWithSort(2),l=egret.Rectangle.create();l.setTo(0,0,s.width-10,s.height-20),t==e.TYPE_BATTLE?this._scrollList=ComponentManager.getScrollList(BossSelectedScrollItem,this.param.data.info,l):t==e.TYPE_BATTLE_REC1?this._scrollList=ComponentManager.getScrollList(BossRecSelectedScrollItem,this.param.data.info,l):t==e.TYPE_ALLIANCE?this._scrollList=ComponentManager.getScrollList(AllianceBossSelectScrollItem,this.param.data.info,l):this._scrollList=ComponentManager.getScrollList(ServantSelectedScrollItem,r,l),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(s.x+10,s.y+10)},e.prototype.useCallback=function(t){if(this._type==e.TYPE_USE_ITEM){var i=Api.itemVoApi.getItemInfoVoById(this._itemId);this._nameTF.text=i.name+"x"+i.num;var a=this._scrollList.getItemByIndex(this._index);a.update()}},e.prototype.clickItemHandler=function(t){var i=t.data;if(this._index=Number(i.index),this._selectedServantId=Number(i.id),this._type==e.TYPE_USE_ITEM){var a=Api.itemVoApi.getItemInfoVoById(this._itemId);a.num>=ItemView.MAX_NUM?ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSEPOPUPVIEW,{itemId:a.id,callback:this.callbackHandler,handler:this}):a.num<=0?App.CommonUtil.showTip(LanguageManager.getlocal("itemNumNotEnough")):this.callbackHandler(1,this._itemId)}else this._type==e.TYPE_BATTLE||this._type==e.TYPE_BATTLE_REC1||this._type==e.TYPE_ALLIANCE?(this._callback.apply(this._handler,[i]),this.hide()):this._type==e.TYPE_STUDY&&this._callback.apply(this._handler,i)},e.prototype.callbackHandler=function(t,i){var a={};this._type==e.TYPE_USE_ITEM&&(a=[t,i,this._selectedServantId]),this._callback.apply(this._handler,a)},e.prototype.getBgExtraHeight=function(){return 40},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_SELECTED_SERVANT,this.clickItemHandler,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USE_ITEM),this.useCallback,this),this._itemId=0,this._nameTF=null,this._scrollList=null,this._callback=null,this._handler=null,this._selectedServantId=0,this._index=0,this._type=0,t.prototype.dispose.call(this)},e.TYPE_USE_ITEM=1,e.TYPE_BATTLE=2,e.TYPE_STUDY=3,e.TYPE_BATTLE_REC1=4,e.TYPE_ALLIANCE=5,e.USE_TYOE_ITEMID=0,e}(PopupView);__reflect(ServantSelectedPopupView.prototype,"ServantSelectedPopupView");var SetPasswordPopupView=function(t){function e(){var e=t.call(this)||this;return e._inputTextField=null,e._inputTextField2=null,e._urlPre=null,e._gameId=null,e._userId=null,e}return __extends(e,t),e.prototype.getTitleStr=function(){return"setPasswordTitle"},e.prototype.getCloseBtnName=function(){return null},e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=518,t.height=435,t.setPosition(this.viewBg.width/2-t.width/2,12),this.addChildToContainer(t);
var e=ComponentManager.getTextField(LanguageManager.getlocal("setPasswordDesc"),TextFieldConst.FONTSIZE_CONTENT_COMMON);e.setPosition(52,27+t.y),e.width=468,e.lineSpacing=6,this.addChildToContainer(e);var i=BaseBitmap.create("public_9_probiginnerbg");i.width=500,i.height=240,i.setPosition(this.viewBg.width/2-i.width/2,t.y+105),this.addChildToContainer(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("setPasswordPlayer"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);a.setPosition(e.x+12,i.y+24),this.addChildToContainer(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("setPasswordAccount"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);n.setPosition(a.x,a.y+52),this.addChildToContainer(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("setPassword1"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);o.setPosition(a.x,n.y+52),this.addChildToContainer(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("setPassword2"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);s.setPosition(a.x,o.y+52),this.addChildToContainer(s);var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);r.setPosition(a.x+a.width+12,a.y),this.addChildToContainer(r);var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);l.setPosition(n.x+n.width+12,n.y),this.addChildToContainer(l);var h=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,304,44,"public_9_bg5",null,10785151);h.x=o.x+o.width,h.y=o.y-15,this.addChildToContainer(h),this._inputTextField=h.getChildByName("textField"),this._inputTextField.restrict="A-Z a-z 0-9",this._inputTextField.maxChars=20;var d=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,304,44,"public_9_bg5",null,10785151);d.x=s.x+s.width,d.y=s.y-15,this.addChildToContainer(d),this._inputTextField2=d.getChildByName("textField"),this._inputTextField2.restrict="A-Z a-z 0-9",this._inputTextField2.maxChars=20;var g=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"confirmBtn",this.gotoHandle,this);g.setPosition(this.viewBg.width/2-g.width/2,i.y+i.height+14),this.addChildToContainer(g),this._userId=PlatformManager.userId.split("_")[1];var c=this;this._gameId="403",1==App.DeviceUtil.isAndroid()&&(this._gameId="402"),this._urlPre="http://gt-cn-in.raygame3.com/tank-global/index.php",NetLoading.show(),NetManager.http.get(this._urlPre,{t:"3kolduserget",ct:"import",ac:"getinfo",userid:this._userId,gameid:this._gameId,service_id:GameData.curZoneID},function(t){NetLoading.hide(),t&&t.data&&(c._userId=t.data.userid,r.text=t.data.username,l.text=t.data.userid,1==t.data.changePassowrd&&ViewController.getInstance().openView(ViewConst.POPUP.DOWNLOADPACKAGEPOPUPVIEW))},function(){NetLoading.hide()},PlatformManager)},e.prototype.gotoHandle=function(){var t=this._inputTextField.text,e=this._inputTextField2.text;return t&&e?t!=e?void App.CommonUtil.showTip(LanguageManager.getlocal("setPasswordError2")):t.length<6?void App.CommonUtil.showTip(LanguageManager.getlocal("setPasswordError3")):(NetLoading.show(),void NetManager.http.get(this._urlPre,{t:"3koldusersetpwd",ct:"import",ac:"ChangePassword",userid:this._userId,gameid:this._gameId,password:t,service_id:GameData.curZoneID},function(t){NetLoading.hide(),t&&0==t.code?ViewController.getInstance().openView(ViewConst.POPUP.DOWNLOADPACKAGEPOPUPVIEW):t&&-1==t.code&&t.msg&&App.CommonUtil.showTip(t.msg)},function(){NetLoading.hide()},PlatformManager)):void App.CommonUtil.showTip(LanguageManager.getlocal("setPasswordError1"))},e.prototype.getBgExtraHeight=function(){return 10},e.prototype.dispose=function(){this._inputTextField=null,this._inputTextField2=null,this._urlPre=null,this._gameId=null,this._userId=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(SetPasswordPopupView.prototype,"SetPasswordPopupView");var UserNamePopupView=function(t){function e(){var e=t.call(this)||this;return e._initName="",e}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=520,t.height=144,t.x=this.viewBg.x+this.viewBg.width/2-t.width/2,t.y=9,this.addChildToContainer(t);var e=BaseBitmap.create("public_pen_icon");e.x=100,e.y=t.y+t.height/2-e.height/2,this.addChildToContainer(e);var i=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,200,45,"public_9_bg5");i.x=this.viewBg.x+this.viewBg.width/2-i.width/2,i.y=t.y+t.height/2-i.height/2,this.addChildToContainer(i),this._inputTextField=i.getChildByName("textField"),this._inputTextField.text=Api.playerVoApi.getPlayerName(),this._inputTextField.maxChars=6,this._cancelBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"cancelBtn",this.clickCancelHandler,this),this._cancelBtn.x=this.viewBg.x+this.viewBg.width/4-this._cancelBtn.width/2,this._cancelBtn.y=t.y+t.height+15,this._cancelBtn.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(this._cancelBtn)},e.prototype.clickConfirmHandler=function(t){var e=this._inputTextField.text;return e==Api.playerVoApi.getPlayerName()?void this.hide():e.length>8?(this._errorText="名字不能超过8位字符",void App.CommonUtil.showTip(this._errorText)):e.length<=0?(this._errorText="名字不能为空",void App.CommonUtil.showTip(this._errorText)):App.StringUtil.userNameCheck(e)?e.length<2||e.length>6?void App.CommonUtil.showTip(LanguageManager.getlocal("guideChangeNameTip2")):void(0!=Config.ShieldCfg.checkShield(e)&&this.request(NetRequestConst.REQUEST_USER_CHANGENAME,{name:this._inputTextField.text})):void App.CommonUtil.showTip(LanguageManager.getlocal("guideChangeNameTip1"))},e.prototype.receiveData=function(t){if(t.data.cmd==NetRequestConst.REQUEST_USER_CHANGENAME){if(0!=t.data.data.nameflag)return void App.CommonUtil.showTip(LanguageManager.getlocal("guideCreateUserError"+t.data.data.nameflag));App.CommonUtil.showTip(LanguageManager.getlocal("user_changeName")),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_RESCHANGE_REFRESH_UI),this.hide()}},e.prototype.clickCancelHandler=function(t){this.hide()},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this),this.setConfirmBtnPosition(this.viewBg.x+this.viewBg.width/4*3-this._cancelBtn.width/2-35,this._cancelBtn.y)},e.prototype.getConfirmBtnStr=function(){return"sysConfirm"},e.prototype.getConfirmBtnName=function(){return ButtonConst.BTN_NORMAL_YELLOW},e.prototype.getTitleStr=function(){return"namePopupTitle2"},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["shield_cn"])},e.prototype.dispose=function(){this._type=null,this._useCallback=null,this._handler=null,this._inputTextField=null,this._cancelBtn=null,this._errorText=null,this._randomBtn=null,this._initName="",t.prototype.dispose.call(this)},e}(PopupView);__reflect(UserNamePopupView.prototype,"UserNamePopupView");var WeiduanUpgradePopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=new BaseShape;t.graphics.beginFill(0,.7),t.graphics.drawRect(0,0,GameConfig.stageWidth,GameConfig.stageHeigth),this.addChildAt(t,0),t.touchEnabled=!0;var e="更新";this.titleTF.text=e,this.titleTF.x=(this.width-this.titleTF.width)/2;var i=ComponentManager.getTextField("发现新版本，请更新",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_BROWN);i.setPosition((this.viewBg.width-i.width)/2,30),this.addChildToContainer(i);var a=ComponentManager.getButton("btn_upgrade_yellow","",this.clickConfirmHandler,this);a.setText("更新",!1),a.setPosition((this.viewBg.width-a.width)/2,i.y+i.height+20),this.addChildToContainer(a)},e.prototype.getCloseBtnName=function(){return null},e.prototype.clickConfirmHandler=function(t){App.DeviceUtil.IsHtml5()&&window.open(this.param.data)},e.prototype.hide=function(){},e.prototype.dispose=function(){},e}(PopupView);__reflect(WeiduanUpgradePopupView.prototype,"WeiduanUpgradePopupView");var WifeORServantInfoPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=390,t.height=200,t.x=158,t.y=70-this.getContainerY(),this.addChildToContainer(t);var e=this.param.data.wifeId,i=this.param.data.servantId,a="",n="",o="",s="",r=LanguageManager.getlocal("practice_descTxt"),l=LanguageManager.getlocal("dropTitle");if(e){var h=Config.WifeCfg.getWifeCfgById(e);a=h.name,n=h.icon,o=h.desc,s=LanguageManager.getlocal("wifeDropDesc_"+e)}else if(i){var d=Config.ServantCfg.getServantItemById(i);a=d.name,n=d.halfIcon,o=d.desc,s=LanguageManager.getlocal("servantDropDesc_"+i)}var g=BaseBitmap.create("itembg_3");g.x=30,g.y=25,this.addChildToContainer(g);var c=BaseLoadBitmap.create(n);c.width=100,c.height=100,c.x=g.x+g.width/2-c.width/2,c.y=g.y+g.height/2-c.height/2-2,this.addChildToContainer(c),this.titleTF.text=a;var p=ComponentManager.getTextField(r,TextFieldConst.FONTSIZE_CONTENT_SMALL);p.setColor(TextFieldConst.COLOR_LIGHT_YELLOW),p.x=171,p.y=37,this.addChildToContainer(p);var _=ComponentManager.getTextField(o,TextFieldConst.FONTSIZE_CONTENT_SMALL);_.x=p.x+p.width,_.y=p.y,_.width=310,this.addChildToContainer(_);var u=ComponentManager.getTextField(l,TextFieldConst.FONTSIZE_CONTENT_SMALL);u.setColor(TextFieldConst.COLOR_LIGHT_YELLOW),u.x=171,u.y=129,this.addChildToContainer(u);var C=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_SMALL);C.x=u.x+u.width,C.y=u.y,C.width=310,this.addChildToContainer(C)},e.prototype.isTouchMaskClose=function(){return!0},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat([])},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(PopupView);__reflect(WifeORServantInfoPopupView.prototype,"WifeORServantInfoPopupView");var LayerManager;!function(t){function e(e){t.bgLayer=new BaseDisplayObjectContainer,t.uiLayer=new BaseDisplayObjectContainer,t.panelLayer=new BaseDisplayObjectContainer,t.maskLayer=new BaseDisplayObjectContainer,t.msgLayer=new BaseDisplayObjectContainer,e.addChild(t.bgLayer),e.addChild(t.uiLayer),e.addChild(t.panelLayer),e.addChild(t.maskLayer),e.addChild(t.msgLayer)}t.bgLayer=void 0,t.uiLayer=void 0,t.panelLayer=void 0,t.maskLayer=void 0,t.msgLayer=void 0,t.initLayer=e}(LayerManager||(LayerManager={}));var LocalStorageManager;!function(t){function e(t,e){return egret.localStorage.setItem(t,e)}function i(t){var e=egret.localStorage.getItem(t);return null==e&&(e=""),e}function a(t){egret.localStorage.removeItem(t)}function n(){egret.localStorage.clear()}t.set=e,t.get=i,t.remove=a,t.clear=n}(LocalStorageManager||(LocalStorageManager={}));var PracticeAbilityDetailsPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this._nodeContainer=new BaseDisplayObjectContainer;var t=10,e=BaseBitmap.create("public_9_probiginnerbg");e.width=520,e.height=666,e.x=this.viewBg.x+this.viewBg.width/2-e.width/2,e.y=this.viewBg.y+t,this.addChildToContainer(e);for(var i=this.param.data.taskId,a=Api.practiceVoApi.getPracticeTaskInfo(i),n=Config.PracticeCfg.getPracticeListById(i),o=Object.keys(n.conditionList),s=0;s<o.length;s++){var r=o[s],l=Number(r),h=n.conditionList[r],d=BaseBitmap.create("dinner_rankbg");d.x=e.x+20,d.y=t,this._nodeContainer.addChild(d);var g=ComponentManager.getTextField(r,20);g.x=d.x+d.width/2-g.width/2,g.y=d.y+d.height/2-g.height/2,this._nodeContainer.addChild(g);var c=ComponentManager.getTextField("",20);c.text=this.getDescTxtWithInfo(s,h,n.servantId,n.wifeId),c.x=d.x+d.width+15,c.y=t,this._nodeContainer.addChild(c),t+=30;var p=ComponentManager.getTextField("",20);p.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,p.x=c.x+c.width+10,p.y=c.y,this._nodeContainer.addChild(p);var _=ComponentManager.getTextField("",20,TextFieldConst.COLOR_WARN_GREEN);_.text=LanguageManager.getlocal("servantInfo_attrTxt"+n.type+"_1")+"+"+String(h.effect),this.getDescTxtWithInfo(s,h,n.servantId,n.wifeId),_.x=c.x,_.y=t,this._nodeContainer.addChild(_),t+=45;var u=BaseBitmap.create("public_line1");u.x=this.viewBg.x+this.viewBg.width/2-u.width/2,u.y=t,this._nodeContainer.addChild(u),t+=20;var C="",f=0;if(a.stage>l||a.stage==l&&2==a.f?(C="practice_unlock_flag",f=h.needNum):a.stage==l&&a.f<=1&&(C="achievement_state1"),p.text="("+f+"/"+h.needNum+")",""!=C){var m=BaseBitmap.create(C);m.x=e.x+e.width-m.width-10,m.y=d.y-7,this._nodeContainer.addChild(m)}}this._nodeContainer.height=t+40;var T=new egret.Rectangle(0,0,this.viewBg.width,e.height-10),y=ComponentManager.getScrollView(this._nodeContainer,T);y.x=0,y.y=e.y+5,this.addChildToContainer(y)},e.prototype.getDescTxtWithInfo=function(t,e,i,a){var n="",o="",s="";return i&&""!=i&&(o=LanguageManager.getlocal("servant_name"+i),n=0==t?LanguageManager.getlocal("practice_contionType1_1",[o]):LanguageManager.getlocal("practice_contionType"+e.conditionType,[e.needNum])),a&&""!=a&&(s=LanguageManager.getlocal("wifeName_"+a),n=0==t?LanguageManager.getlocal("practice_contionType1_2",[s]):LanguageManager.getlocal("practice_contionType"+e.conditionType,[e.needNum])),n},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["dinner_rankbg","practice_unlock_flag","achievement_state1"])},e.prototype.getParent=function(){return PlayerBottomUI.getInstance().parent},e.prototype.getShowHeight=function(){return 758},e.prototype.dispose=function(){this._nodeContainer=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(PracticeAbilityDetailsPopupView.prototype,"PracticeAbilityDetailsPopupView");var PracticeAbilityScrollItem=function(t){function e(){var e=t.call(this)||this;return e._expProgress=null,e._isBtnEnable=!1,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_UNLOCK),this.unlockCallBackHandler,this),this.width=600,this._nodeContainer=new BaseDisplayObjectContainer,this.addChild(this._nodeContainer),this._curCfg=e;var i=(this._curCfg.servantId,this._curCfg.wifeId,BaseBitmap.create("public_9_bg14"));i.width=this.width,i.height=148,i.touchEnabled=!0,this.addChild(i),i.addTouchTap(this.showDetails,this);var a=BaseBitmap.create("itembg_3"),n=1;a.setScale(n),a.x=10,a.y=i.y+i.height/2-a.height/2,this.addChild(a);var o="";this._curCfg.servantId?o="servant_half_"+this._curCfg.servantId:this._curCfg.wifeId&&(o="wife_half_"+this._curCfg.wifeId);var s=BaseLoadBitmap.create(o);s.width=100,s.height=100,s.x=a.x+a.width/2*n-s.width/2,s.y=a.y+a.height/2*n-s.height/2-2,this.addChild(s),s.addTouchTap(this.showWifeOrServantInfo,this),this._conditionTxt=ComponentManager.getTextField("1234",20,TextFieldConst.COLOR_BROWN),this._conditionTxt.x=a.x+a.width*n+10,this._conditionTxt.y=20,this.addChild(this._conditionTxt);var r=ComponentManager.getTextField("1234",20,TextFieldConst.COLOR_BROWN);r.x=this._conditionTxt.x,r.y=this._conditionTxt.y+27,this.addChild(r),this._attrTxt=r;var l=ComponentManager.getTextField("1234",20,TextFieldConst.COLOR_BROWN);l.x=r.x,l.y=r.y+27,this.addChild(l),this._attrAddTxt=l,this._expProgress=ComponentManager.getProgressBar("progress5","progress3_bg",280),this._expProgress.setPosition(this._attrAddTxt.x,l.y+30),this._expProgress.setTextSize(TextFieldConst.FONTSIZE_CONTENT_SMALL),this.addChild(this._expProgress);var h=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"practice_upgrateBtn",this.btnHandler,this);h.x=this.width-h.width-15,h.y=this.height/2-h.height/2,h.name="btn",h.visible=!1,this.addChild(h);var d=ComponentManager.getButton(ButtonConst.BTN_SMALL_RED,"practice_goBtnTxt",this.goBtnHandler,this);d.x=this.width-h.width-15,d.y=this.height/2-h.height/2,d.name="goBtn",d.visible=!1,this.addChild(d),this.refreshUI()},e.prototype.goBtnHandler=function(){if(this._curCfg.servantId){if(!Api.servantVoApi.getServantObj(this._curCfg.servantId))return void App.CommonUtil.showTip(LanguageManager.getlocal("practice_noServantTip"));ViewController.getInstance().openView(ViewConst.COMMON.SERVANTINFOVIEW,this._curCfg.servantId)}else{var t=this._curCfg.wifeId;if(!Api.wifeVoApi.getWifeInfoVoById(t))return void App.CommonUtil.showTip(LanguageManager.getlocal("practice_noWifeTip"));ViewController.getInstance().openView(ViewConst.COMMON.WIFEOPTVIEW,{id:t,handler:null})}},e.prototype.refreshUI=function(){this._isBtnEnable=!1;var t=Api.practiceVoApi.getPracticeTaskInfo(this._curCfg.id),e=Api.practiceVoApi.getPracticeTaskAccumulation(t),i=this._curCfg.conditionList[t.stage],a=e.conditionV,n=this._curCfg.type;if(e.isComp){this._conditionTxt.text=LanguageManager.getlocal("practice_compTxt"),this._attrAddTxt.text="";var o=LanguageManager.getlocal("servantInfo_attrTxt"+n+"_1")+"+"+String(e.curV);if(this._attrTxt.text=LanguageManager.getlocal("practice_curV",[o]),this._expProgress.visible=!1,this.getChildByName("btn").visible=!1,this.getChildByName("goBtn").visible=!1,!this.getChildByName("compFlag")){var s=BaseBitmap.create("practice_comp_flag");s.x=this.width-s.width-20,s.y=30,this.addChild(s)}}else{if(a>=e.conditionNeed&&(a=e.conditionNeed,this._isBtnEnable=!0),1==t.stage){if(this._curCfg.servantId){var r=LanguageManager.getlocal("servant_name"+this._curCfg.servantId);this._conditionTxt.text=LanguageManager.getlocal("practice_contionType1_1",[r])}else if(this._curCfg.wifeId){var l=LanguageManager.getlocal("wifeName_"+this._curCfg.wifeId);this._conditionTxt.text=LanguageManager.getlocal("practice_contionType1_2",[l])}}else this._conditionTxt.text=LanguageManager.getlocal("practice_contionType"+i.conditionType,[String(e.conditionNeed)]);var h=LanguageManager.getlocal("servantInfo_attrTxt"+n+"_1")+"+"+String(e.nextV);this._attrAddTxt.text=LanguageManager.getlocal("practice_addV",[h]),this._expProgress.setPercentage(a/e.conditionNeed),this._expProgress.setText(a+"/"+e.conditionNeed);var o=LanguageManager.getlocal("servantInfo_attrTxt"+n+"_1")+"+"+String(e.curV);this._attrTxt.text=LanguageManager.getlocal("practice_curV",[o]),this._isBtnEnable?(this.getChildByName("btn").visible=!0,this.getChildByName("goBtn").visible=!1):(this.getChildByName("btn").visible=!1,this.getChildByName("goBtn").visible=!1,t.stage>1&&(Api.servantVoApi.getServantObj(this._curCfg.servantId)||Api.wifeVoApi.getWifeInfoVoById(this._curCfg.wifeId))&&(this.getChildByName("goBtn").visible=!0))}},e.prototype.unlockCallBackHandler=function(t){var e=t.data.data;0==e.ret&&this.refreshUI()},e.prototype.btnHandler=function(){return 0==this._isBtnEnable?void App.CommonUtil.showTip(LanguageManager.getlocal("practice_collectTip")):void NetManager.request(NetRequestConst.REQUEST_REQUEST_UNLOCK,{taskId:this._curCfg.id})},e.prototype.showDetails=function(){ViewController.getInstance().openView(ViewConst.POPUP.PRACTICEABILITYDETAILSPOPUPVIEW,{taskId:this._curCfg.id})},e.prototype.showWifeOrServantInfo=function(){ViewController.getInstance().openView(ViewConst.POPUP.WIFEORSERVANTINFOPOPUPVIEW,{wifeId:this._curCfg.wifeId,servantId:this._curCfg.servantId})},e.prototype.getSpaceX=function(){return 5},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_UNLOCK),this.unlockCallBackHandler,this),this._nodeContainer=null,this._expProgress=null,this._attrAddTxt=null,this._attrTxt=null,this._curCfg=null,this._conditionTxt=null,this._isBtnEnable=!1,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(PracticeAbilityScrollItem.prototype,"PracticeAbilityScrollItem");var PracticeAbilityView=function(t){function e(){var e=t.call(this)||this;return e._attrType=0,e._refreshTxtList=[],e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_UNLOCK),this.refreshTxt,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer),this._attrType=this.param.data.type;var t=BaseBitmap.create("playerpromo_abitopbg");t.y=-15,t.height=140,this._nodeContainer.addChild(t);var e=ComponentManager.getTextField("",20,TextFieldConst.COLOR_LIGHT_YELLOW);e.text=LanguageManager.getlocal("servantInfo_title",["100"]),e.x=t.x+t.width/2,e.y=t.y+15,this._nodeContainer.addChild(e),this._refreshTxtList.push(e);for(var i=1;4>=i;i++){var a=ComponentManager.getTextField("",20,TextFieldConst.COLOR_LIGHT_YELLOW);a.text=LanguageManager.getlocal("servantInfo_attrTxt"+i),a.x=80,a.y=t.y+60,i%2==0&&(a.x=GameConfig.stageWidth/2+100),i>2&&(a.y=t.y+90),this._nodeContainer.addChild(a),this._refreshTxtList.push(a)}var n=PlayerBottomUI.getInstance().showHeight,o=BaseBitmap.create("servant_bottombg");o.x=GameConfig.stageWidth/2-o.width/2,o.y=t.y+t.height,o.height=GameConfig.stageHeigth-o.y-this.container.y-n+10,this._nodeContainer.addChild(o);var s=BaseBitmap.create("public_9_bg32");s.width=GameConfig.stageWidth-30,s.height=o.height-100,s.x=15,s.y=o.y+80,this._nodeContainer.addChild(s);var r=["servantInfo_speciality1","servantInfo_speciality2","servantInfo_speciality3","servantInfo_speciality4"],l=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,r,this.tabBtnClickHandler,this);l.setSpace(2),l.x=25,l.y=o.y+24,this._nodeContainer.addChild(l),this._tabbarGroup=l;var h=new egret.Rectangle(0,0,o.width,o.height-10);this._scrollList=ComponentManager.getScrollList(PracticeAbilityScrollItem,[],h),this._scrollList.setPosition(20,o.y+80),this._nodeContainer.addChild(this._scrollList),this.tabBtnClickHandler({index:this._attrType}),l.selectedIndex=this._attrType,this.refreshTxt()},e.prototype.refreshTxt=function(){this.checkRedPoints(),PlayerBottomUI.getInstance().checkRedPoints();var t=Api.practiceVoApi.geAttrValues(),e=String(t[0]+t[1]+t[2]+t[3]);this._refreshTxtList[0].text=LanguageManager.getlocal("servantInfo_title",[e]),this._refreshTxtList[1].text=LanguageManager.getlocal("servantInfo_attrTxt1")+String(t[0]),this._refreshTxtList[2].text=LanguageManager.getlocal("servantInfo_attrTxt2")+String(t[1]),this._refreshTxtList[3].text=LanguageManager.getlocal("servantInfo_attrTxt3")+String(t[2]),this._refreshTxtList[4].text=LanguageManager.getlocal("servantInfo_attrTxt4")+String(t[3]),this._refreshTxtList[0].anchorOffsetX=this._refreshTxtList[0].width/2},e.prototype.tabBtnClickHandler=function(t){this._attrType=t.index;var e=Config.PracticeCfg.getPracticeShowListByType(this._attrType+1);this.refreshList(e)},e.prototype.refreshList=function(t){this._scrollList.refreshData(t)},e.prototype.checkRedPoints=function(){var t=Api.practiceVoApi.practiceAttrRedList();for(var e in t)t[e]?this._tabbarGroup.addRedPoint(Number(e)-1):this._tabbarGroup.removeRedPoint(Number(e)-1)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["playerpromo_abitopbg","servant_bottombg","progress5","progress3_bg","practice_comp_flag"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_UNLOCK),this.refreshTxt,this),this._nodeContainer=null,this._scrollList=null,this._attrType=0,this._refreshTxtList=[],t.prototype.dispose.call(this)},e}(CommonView);__reflect(PracticeAbilityView.prototype,"PracticeAbilityView");var PracticeBatchBuyPopupView=function(t){function e(){var e=t.call(this)||this;return e._maxNum=0,e._useNum=0,e._costNum=0,e}return __extends(e,t),e.prototype.initView=function(){var t="practice_icon",e="itembg_1";this._maxNum=100,this._useNum=0;var i=BaseBitmap.create("public_9_bg4");i.width=520,i.height=240,i.x=this.viewBg.x+this.viewBg.width/2-i.width/2,i.y=9,this.addChildToContainer(i);var a=this.viewBg.x+this.viewBg.width/2,n=24,o=BaseBitmap.create(e);o.x=a-o.width/2,o.y=n,this.addChildToContainer(o),o.touchEnabled=!0,o.addTouchTap(function(){var t={dType:"json",iconBg:"itembg_1",name:LanguageManager.getlocal("practice_name"),icon:"practice_icon",desc:LanguageManager.getlocal("itemDesc_6"),dropDesc:LanguageManager.getlocal("itemDropDesc_6")};ViewController.getInstance().openView(ViewConst.POPUP.ITEMINFOPOPUPVIEW,t)},this);var s=BaseBitmap.create(t);s.x=o.x+o.width/2-s.width/2,s.y=o.y+o.height/2-s.height/2,this.addChildToContainer(s);var r=ComponentManager.getTextField("",18);this._numTF=r,this._numTF.text=LanguageManager.getlocal("practice_batchbuyTxt2",["1"]),r.anchorOffsetX=r.width,r.x=o.x+o.width-5,r.y=n+98-r.height,this.addChildToContainer(r);var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);l.text=LanguageManager.getlocal("practice_batchbuyTxt",["",""]),l.anchorOffsetX=l.width/2,l.x=a,l.y=o.y+o.height+10,this.addChildToContainer(l),this._costTxt=l;var h=ComponentManager.getDragProgressBar("progress2","progress2_bg",this._maxNum,this.dragCallback,this);h.x=a-h.width/2,h.y=o.y+o.height+50,this.addChildToContainer(h),this._dragProgressBar=h;var d=BaseBitmap.create("public_9_bg5");d.width=90,d.x=i.x+i.width-10-d.width,d.y=h.y+h.height/2-d.height/2,this.addChildToContainer(d),this._numBg=d,this._selectedNumTF=ComponentManager.getTextField(this._useNum+"",TextFieldConst.FONTSIZE_CONTENT_SMALL),this._selectedNumTF.textAlign=TextFieldConst.ALIGH_LEFT,this._selectedNumTF.setColor(TextFieldConst.COLOR_WARN_YELLOW),this._selectedNumTF.y=d.y+d.height/2-this._selectedNumTF.height/2,this.addChildToContainer(this._selectedNumTF),this._maxNumTF=ComponentManager.getTextField("/"+this._maxNum.toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL),this._maxNumTF.textAlign=TextFieldConst.ALIGH_RIGHT,this._maxNumTF.y=d.y+d.height/2-this._maxNumTF.height/2,this.addChildToContainer(this._maxNumTF);var g=this._selectedNumTF.width+this._maxNumTF.width;this._selectedNumTF.x=d.x+(d.width-g)/2,this._maxNumTF.x=this._selectedNumTF.x+this._selectedNumTF.width,this._cancelBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"cancelBtn",this.hide,this),this._cancelBtn.x=a-this._cancelBtn.width/2-100,this._cancelBtn.y=i.y+i.height+15,this.addChildToContainer(this._cancelBtn);var c=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"sysConfirm",this.clickOkBtnHandler,this);c.x=a-c.width/2+100,c.y=i.y+i.height+15,this.addChildToContainer(c),this.dragCallback(1)},e.prototype.dragCallback=function(t){var e=0;if(this._useNum!=t){var i=Api.practiceVoApi.getbuyNum(),a=GameConfig.config.practicebaseCfg.getCost,n=a[a.length-1];if(i>=a.length-1)e=n*t;else{for(var o=i+t,s=o<a.length?o:a.length,r=i;s>r;r++)e+=a[r];s>=a.length&&(e+=n*(s-a.length+1))}}this._useNum=t,this._numTF.text=LanguageManager.getlocal("practice_batchbuyTxt2",[""+this._useNum]),this._numTF.anchorOffsetX=this._numTF.width,this._selectedNumTF.text=this._useNum+"";var l=this._selectedNumTF.width+this._maxNumTF.width;this._selectedNumTF.x=this._numBg.x+(this._numBg.width-l)/2,this._maxNumTF.x=this._selectedNumTF.x+this._selectedNumTF.width,this._costTxt.text=LanguageManager.getlocal("practice_batchbuyTxt",[""+e,""+this._useNum]),this._costTxt.anchorOffsetX=this._costTxt.width/2,this._costNum=e},e.prototype.clickOkBtnHandler=function(t){return Api.playerVoApi.getPlayerGem()<this._costNum?void App.CommonUtil.showTip(LanguageManager.getlocal("practice_batchBuyNotenoughdes")):(NetManager.request(NetRequestConst.REQUEST_REQUEST_BUY,{num:this._useNum}),void this.hide())},e.prototype.getResourceList=function(){var e=t.prototype.getResourceList.call(this).concat(["practice_icon","progress2","progress2_bg"]);return e},e.prototype.getTitleStr=function(){return"itemUseConstPopupViewTitle"},e.prototype.dispose=function(){this._cancelBtn=null,this._maxNum=0,this._useNum=0,this._numBg=null,this._selectedNumTF=null,this._maxNumTF=null,this._costTxt=null,this._numTF=null,this._dragProgressBar=null,this._costNum=0,t.prototype.dispose.call(this)},e}(PopupView);__reflect(PracticeBatchBuyPopupView.prototype,"PracticeBatchBuyPopupView");var PracticeGetView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=this.param.data.pnum,e=GameConfig.config.practicebaseCfg,i=BaseBitmap.create("public_9_wordbg");i.width=GameConfig.stageWidth,i.height=560,i.setPosition(0,GameConfig.stageHeigth/2-180);var a=BaseBitmap.create("tailor_get_light");a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,a.x=GameConfig.stageWidth/2,a.y=i.y-30,egret.Tween.get(a,{loop:!0}).to({rotation:360},15e3),this.addChildToContainer(a),this.addChildToContainer(i);var n=BaseBitmap.create("practice_get_word");n.setPosition(GameConfig.stageWidth/2-n.width/2,i.y-n.height),this.addChildToContainer(n);var o=i.y+40,s=i.x+30,r=ComponentManager.getTextField("",24,TextFieldConst.COLOR_WARN_YELLOW);r.text=LanguageManager.getlocal("practice_getTxt1",[String(t)]),r.x=s,r.y=o,this.addChildToContainer(r),o+=40;var l=ComponentManager.getTextField("",24,TextFieldConst.COLOR_WARN_YELLOW);l.text=LanguageManager.getlocal("practice_getTxt2",[""]),l.x=s,l.y=o,this.addChildToContainer(l),o+=35;var h=BaseBitmap.create("dinner_list_bg");h.width=584,h.height=320,h.setPosition(GameConfig.stageWidth/2-h.width/2,o),this.addChildToContainer(h),s+=90,o+=50;var d=Api.playerVoApi.getPlayerVipLevel(),g=Api.playerVoApi.getPlayerLevel(),c=e.vip[d-1],p=e.vip[d],_=e.level[g-1],u=e.level[g],C=void 0;g<Config.LevelCfg.getMaxLevel()&&(C=[Api.playerVoApi.getPlayerOfficeByLevel(g+1),String(u)]);var f=void 0;d<Config.VipCfg.getMaxLevel()&&(f=[String(d+1),(100*p).toFixed(0)+"%"]);for(var m=[{node1:ComponentManager.getBitmapText(Api.playerVoApi.getPlayerOffice(),"office_fnt"),textKey:"practice_officeAdd",textKey2:"practice_officeAdd2",textV:[Api.playerVoApi.getPlayerOffice(),String(_)],textV2:C},{node1:BaseLoadBitmap.create(Api.vipVoApi.getCurLevelVipCfg().icon),textKey:"practice_vipAdd",textKey2:"practice_vipAdd3",textV:[String(d),String((100*c).toFixed(0))+"%"],textV2:f},{node1:BaseBitmap.create("monthcard_icon"),textKey:"practice_monthCardAdd",textKey2:void 0,textV:[100*e.monthCard+"%"],textV2:void 0},{node1:BaseBitmap.create("yearcard_icon"),textKey:"practice_yearCardAdd",textKey2:void 0,textV:[100*e.yearCard+"%"],textV2:void 0}],T=0;T<m.length;T++){var y=m[T],v=y.node1;1==T&&(v.width=80,v.height=35),v.anchorOffsetX=v.width/2,v.anchorOffsetY=v.height/2,v.x=s,v.y=o;var A="practice_getBtnTxt1";T>1&&(v.setScale(.8),A="practice_getBtnTxt2"),this.addChildToContainer(v);var w=ComponentManager.getTextField("",20,TextFieldConst.COLOR_LIGHT_YELLOW);if(w.text=LanguageManager.getlocal(y.textKey,[].concat(y.textV)),w.anchorOffsetY=w.height/2,w.x=s+80,w.y=o,this.addChildToContainer(w),y.textV2){w.y-=25;var x=ComponentManager.getTextField("",20,TextFieldConst.COLOR_QUALITY_GRAY);x.text=LanguageManager.getlocal(y.textKey2,[].concat(y.textV2)),x.anchorOffsetY=w.height/2,x.x=w.x,x.y=w.y+30,this.addChildToContainer(x)}var I=!1;if(0==T?I=Api.playerVoApi.getPlayerLevel()<Config.LevelCfg.getMaxLevel():1==T?I=Api.playerVoApi.getPlayerVipLevel()<Config.VipCfg.getMaxLevel():2==T?I=!Api.shopVoApi.ifBuyMonthCard():3==T&&(I=!Api.shopVoApi.ifBuyYearCard()),I){var L=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,A,this.btnHandler,this,[T]);L.anchorOffsetY=L.height/2,L.x=s+370,L.y=o,L.setScale(.8),this.addChildToContainer(L)}var E=BaseBitmap.create("public_line1");E.width=i.width-20,E.x=i.x+i.width/2-E.width/2,E.y=o+25,this.addChildToContainer(E),o+=74}var B=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"sysConfirm",this.hide,this);B.setPosition(GameConfig.stageWidth/2-B.width/2,h.y+h.height+40),this.addChildToContainer(B)},e.prototype.btnHandler=function(t){0==t?ViewController.getInstance().openView(ViewConst.COMMON.CHALLENGEVIEW):1==t?ViewController.getInstance().openView(ViewConst.COMMON.VIPVIEW):2==t?ViewController.getInstance().openView(ViewConst.COMMON.WELFAREVIEWMONTHCARD):3==t&&ViewController.getInstance().openView(ViewConst.COMMON.WELFAREVIEWYEARCARD),this.hide()},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["dinner_list_bg","tailor_get_light","office_fnt","monthcard_icon","yearcard_icon","public_line1","practice_get_word"])
},e.prototype.getBgName=function(){return"public_9_bg8"},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseView);__reflect(PracticeGetView.prototype,"PracticeGetView");var PracticeView=function(t){function e(){var e=t.call(this)||this;return e._isLvupEnable=!1,e._refreshTxtList=[],e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_UPGRADE),this.levelupCallBackHandler,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_UNLOCK),this.levelupCallBackHandler,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_BUY),this.levelupCallBackHandler,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var t=BaseBitmap.create("servant_infobg");t.y=-20,this._nodeContainer.addChild(t);var e=Api.playerVoApi.getMyPortrait();e.x=GameConfig.stageWidth/2-e.width/2,e.name="userContainer",this._nodeContainer.addChild(e),this._bottomnodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._bottomnodeContainer);var i=PlayerBottomUI.getInstance().showHeight,a=BaseBitmap.create("servant_mask");a.width=GameConfig.stageWidth;var n=BaseBitmap.create("playerview_probg");n.x=0,n.y=0;var o=BaseBitmap.create("public_9_bg22");o.height=390,o.x=0,o.y=n.y+n.height-10;var s=BaseBitmap.create("public_9_bg43");s.height=225,s.width=600,s.x=o.x+o.width/2-s.width/2,s.y=o.y+85;var r=GameConfig.stageHeigth-this.container.y-i-s.y-s.height;this._bottomnodeContainer.y=r-15,this._bottomnodeContainer.addChild(a),this._bottomnodeContainer.addChild(o),this._bottomnodeContainer.addChild(s),this._bottomnodeContainer.addChild(n);var l=BaseBitmap.create("playerview_powerbg");l.x=GameConfig.stageWidth/2-l.width/2,l.y=-60,this._bottomnodeContainer.addChild(l);var h=BaseBitmap.create("playerview_power_img");h.x=l.x+50,h.y=l.y+20,this._bottomnodeContainer.addChild(h);var d=ComponentManager.getTextField(""+Api.playerVoApi.getPlayerPower(),24,TextFieldConst.COLOR_LIGHT_YELLOW);d.name="powerTxt",d.x=h.x+h.width+15,d.y=h.y+h.height/2-d.height/2,this._bottomnodeContainer.addChild(d);var g=BaseBitmap.create("servant_levebg");g.x=5,g.y=n.y,this._bottomnodeContainer.addChild(g);var c=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);c.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,c.text=LanguageManager.getlocal("servant_infoLv"),c.x=g.x+17,c.y=g.y+10,this._bottomnodeContainer.addChild(c);var p=ComponentManager.getTextField("123",42);p.name="lvValueText",p.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,p.text="12",p.anchorOffsetX=p.width/2,p.x=g.x+g.width/2,p.y=c.y+25,this._bottomnodeContainer.addChild(p);for(var _=[{icon:"playerview_pro2",value:"100"},{icon:"playerview_pro1",value:"100"},{icon:"playerview_pro5",value:"100"},{icon:"playerview_pro4",value:"100"}],u=0;4>u;u++){var C=_[u].icon,f=BaseBitmap.create(C);f.x=120,u%2==0&&(f.x=GameConfig.stageWidth/2+50),f.y=g.y+15+25*Math.floor(u/2),this._bottomnodeContainer.addChild(f);var m=ComponentManager.getTextField("",22,TextFieldConst.COLOR_LIGHT_YELLOW);m.text="100",m.x=f.x+f.width+5,m.y=f.y+f.height/2-m.height/2,this._bottomnodeContainer.addChild(m),this._refreshTxtList.push(m)}this._progressBar=ComponentManager.getProgressBar("progress3","progress3_bg",440),this._progressBar.x=22,this._progressBar.y=o.y+35,this._progressBar.setTextSize(18),this._bottomnodeContainer.addChild(this._progressBar);var T=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"servant_clvUpBtn",this.levelupBtnClickHandler,this);T.x=this._progressBar.x+this._progressBar.width+10,T.y=this._progressBar.y+this._progressBar.height/2-T.height/2,T.setColor(TextFieldConst.COLOR_BLACK),this._bottomnodeContainer.addChild(T),this._levelupBtn=T;var y=new ServantInfoBookItems;y.y=o.y+15,y.init("",s.height+110,!0),this._bottomnodeContainer.addChild(y),this.refreshTxtValue()},e.prototype.refreshTxtValue=function(){Api.practiceVoApi.isPracticeLvupEnable()?App.CommonUtil.addRedDotToBDOC(this._levelupBtn):App.CommonUtil.removeRedDotFromBDOC(this._levelupBtn),PlayerBottomUI.getInstance().checkRedPoints();var t=this._bottomnodeContainer.getChildByName("powerTxt"),e=this._bottomnodeContainer.getChildByName("lvValueText");t.text=""+Api.playerVoApi.getPlayerPower(),e.text=""+Api.practiceVoApi.getLevel(),e.anchorOffsetX=e.width/2;var i=Api.practiceVoApi.geAttrValues();this._refreshTxtList[0].text=""+i[0],this._refreshTxtList[1].text=""+i[1],this._refreshTxtList[2].text=""+i[2],this._refreshTxtList[3].text=""+i[3];var a=Api.practiceVoApi.getProgressValue();this._progressBar.setText(LanguageManager.getlocal("practice_expV",[a.v1])),this._progressBar.setPercentage(a.v2),this._isLvupEnable=!1;var n="acPunishBuyItemBuy";a.v2>=1&&(this._isLvupEnable=!0,n="servant_clvUpBtn"),this._levelupBtn.setText(n)},e.prototype.levelupCallBackHandler=function(t){var e=t.data.data;0==e.ret&&(e.cmd==NetRequestConst.REQUEST_REQUEST_BUY&&App.CommonUtil.showTip(LanguageManager.getlocal("practice_batchBuySuccessTip")),this.refreshTxtValue())},e.prototype.levelupBtnClickHandler=function(){if(0==this._isLvupEnable)ViewController.getInstance().openView(ViewConst.POPUP.PRACTICEBATCHBUYPOPUPVIEW);else{if(Api.practiceVoApi.getLevel==GameConfig.config.practicebaseCfg.maxLv)return void App.CommonUtil.showTip(LanguageManager.getlocal("practice_topLvTip"));NetManager.request(NetRequestConst.REQUEST_REQUEST_UPGRADE,{})}},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_REQUEST_INDEX,requestData:{}}},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["playerpromo_abitopbg","servant_infobg","playerview_probg","public_9_bg22","servant_levebg","servant_infoLv","servant_attribute1","servant_attribute2","servant_attribute3","servant_attribute4","progress3","progress3_bg","playerview_pro1","playerview_pro2","playerview_pro4","playerview_pro5","public_9_bg44","public_9_bg43","playerview_powerbg","playerview_power_img","servant_infoPro1","servant_infoPro2","servant_infoPro3","servant_infoPro4"])},e.prototype.closeHandler=function(){PlayerBottomUI.getInstance().hide(!0),t.prototype.hide.call(this)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_UPGRADE),this.levelupCallBackHandler,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_UNLOCK),this.levelupCallBackHandler,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_BUY),this.levelupCallBackHandler,this),this._nodeContainer=null,this._bottomnodeContainer=null,this._scrollList=null,this._progressBar=null,this._levelupBtn=null,this._isLvupEnable=!1,this._refreshTxtList=[],t.prototype.dispose.call(this)},e}(CommonView);__reflect(PracticeView.prototype,"PracticeView");var PrestigeInfoPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["atkracecross_explain_bg","prestige_info_bg"])},e.prototype.getTitleStr=function(){return"prestigeInfo"},e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=524,t.height=441,t.setPosition(this.viewBg.width/2-t.width/2,12),this.addChildToContainer(t);var e=BaseBitmap.create("prestige_info_bg");e.setPosition(this.viewBg.width/2-e.width/2,t.y+4),this.addChildToContainer(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("prestigeInfoReward"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_BROWN);i.setPosition(e.x+5,e.y+e.height+8),this.addChildToContainer(i);var a=BaseBitmap.create("atkracecross_explain_bg");a.width=518,a.setPosition(this.viewBg.width/2-a.width/2,i.y+i.height+8),this.addChildToContainer(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("prestigeInfoRewardDesc"),TextFieldConst.FONTSIZE_CONTENT_SMALL);n.setPosition(a.x+20,a.y+8),n.width=a.width-40,n.lineSpacing=6,this.addChildToContainer(n),a.height=n.height+20;var o=ComponentManager.getTextField(LanguageManager.getlocal("prestigeInfoRule"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_BROWN);o.setPosition(i.x,a.y+a.height+12),this.addChildToContainer(o);var s=BaseBitmap.create("atkracecross_explain_bg");s.width=518,s.setPosition(this.viewBg.width/2-s.width/2,o.y+o.height+8),this.addChildToContainer(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("prestigeInfoRuleDesc"),TextFieldConst.FONTSIZE_CONTENT_SMALL);r.setPosition(s.x+20,s.y+12),r.width=a.width-40,r.lineSpacing=6,this.addChildToContainer(r),s.height=r.height+20;var l=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"sysConfirm",this.hide,this);l.setPosition(this.viewBg.width/2-l.width/2,t.y+t.height+20),this.addChildToContainer(l)},e.prototype.getBgExtraHeight=function(){return 20},e}(PopupView);__reflect(PrestigeInfoPopupView.prototype,"PrestigeInfoPopupView");var PrestigeItemPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getTitleStr=function(){return"prestigeItemName"+this.param.data.itemId},e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=390,t.height=170,t.x=158,t.y=70-this.getContainerY(),this.addChildToContainer(t);var e=this.param.data.itemId,i=BaseBitmap.create("itembg_7");i.setPosition(30,t.y+t.height/2-i.height/2),this.addChildToContainer(i);var a=BaseBitmap.create("prestige_prerogative"+e);a.setPosition(i.x+i.width/2-a.width/2,i.y+i.height/2-a.height/2),this.addChildToContainer(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("prestigeItemDesc"+e),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);n.setPosition(25+t.x,t.y+20),n.width=310,n.lineSpacing=6,this.addChildToContainer(n)},e.prototype.getBgExtraHeight=function(){return 20},e}(PopupView);__reflect(PrestigeItemPopupView.prototype,"PrestigeItemPopupView");var PrestigeLogPopupScollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=526,this.height=75;var i=BaseBitmap.create("public_9_probiginnerbg");i.width=526,i.height=71,this.addChild(i);var a;a=0==e.dtype?LanguageManager.getlocal("dailyTaskViewTitle"):LanguageManager.getlocal("acRankActive-"+e.dtype+"_Title");var n=ComponentManager.getTextField(LanguageManager.getlocal("prestigeLogDesc",[a,String(e.v)]),TextFieldConst.FONTSIZE_CONTENT_COMMON);n.x=13,n.y=10,n.width=500,n.lineSpacing=5,this.addChild(n);var o=ComponentManager.getTextField(App.DateUtil.getFormatBySecond(e.st,2),TextFieldConst.FONTSIZE_CONTENT_SMALL);o.x=i.width-o.width-10,o.y=43,this.addChild(o)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(PrestigeLogPopupScollItem.prototype,"PrestigeLogPopupScollItem");var PrestigeLogPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getTitleStr=function(){return"prestigeLog"},e.prototype.getRuleInfo=function(){return"prestigeRuleInfo"},e.prototype.initView=function(){var t=egret.Rectangle.create();t.setTo(0,0,526,530);var e=BaseBitmap.create("public_9_bg11");e.height=t.height,e.width=t.width,e.setPosition(21,10),this.addChildToContainer(e),e.alpha=0;for(var i=Api.prestigeVoApi.getLog(),a=[],n=i.length-1;n>=0;n--)a.push(i[n]);var o=ComponentManager.getScrollList(PrestigeLogPopupScollItem,a,t);this.addChildToContainer(o),o.setPosition(21,10),o.setEmptyTip(LanguageManager.getlocal("acPunishNoData"))},e.prototype.getBgExtraHeight=function(){return 10},e}(PopupView);__reflect(PrestigeLogPopupView.prototype,"PrestigeLogPopupView");var PrestigeView=function(t){function e(){var e=t.call(this)||this;return e._scrollContiner=null,e._pillar=null,e}return __extends(e,t),e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_PRESTIGE_INDEX,requestData:{}}},e.prototype.receiveData=function(t){t.ret&&t.data.data.rewards&&(App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.rewards)),"11_4003_1"==t.data.data.rewards&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_CHANGE_IMG))},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["wifeskin_barbg","prestige_pillar_base","prestige_pillar1","prestige_pillar2","prestige_bg","prestige_black_bg","prestige_chair","prestige_circle_bg","prestige_circle","prestige_cur","prestige_flag1","prestige_flag2","prestige_light","prestige_fnt","prestige_prerogative1","prestige_prerogative2","prestige_prerogative3"])},e.prototype.initView=function(){this.container.y=this.getTitleButtomY(),this._scrollContiner=new BaseDisplayObjectContainer;var t=PlayerBottomUI.getInstance().showHeight,e=egret.Rectangle.create();e.setTo(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-this.getTitleButtomY()-45-t);var i=ComponentManager.getScrollView(this._scrollContiner,e);this.addChildToContainer(i);var a=BaseBitmap.create("prestige_bg");this._scrollContiner.addChild(a),i.bounces=!1;var n=BaseBitmap.create("prestige_pillar1");n.x=0,n.y=42,this._scrollContiner.addChild(n);var o=BaseBitmap.create("prestige_pillar_base");o.height=n.height+o.height-10,this._scrollContiner.addChild(o);var s=n.height,r=Config.PrestigeCfg.getPrestigeCfgById(3),l=Api.prestigeVoApi.getInfo().v;l>r.prestige&&(l=r.prestige),this._pillar=BaseBitmap.create("prestige_pillar2"),this._pillar.setPosition(n.x,n.y),this._scrollContiner.addChild(this._pillar);var h=egret.Rectangle.create(),d=l/r.prestige;h.setTo(0,(1-d)*s,this._pillar.width,s*d),this._pillar.mask=h;var g=BaseBitmap.create("prestige_light");g.setPosition(0,n.y+h.y-g.height/2),this._scrollContiner.addChild(g);var c=ComponentManager.getBitmapText(String(Api.prestigeVoApi.getInfo().v),"prestige_fnt");c.setPosition(g.x+g.width/2-c.width/2,g.y-c.height+20),this._scrollContiner.addChild(c);var p=BaseBitmap.create("prestige_cur");p.x=g.x+g.width/2-p.width/2,l/r.prestige>.9?p.y=g.y+g.height/2:p.y=c.y-p.height,this._scrollContiner.addChild(p);var _=n.y-10,u=_+.3*s,C=_+.6*s,f=_+.8*s,m=BaseBitmap.create(this.getFlagPicStr(l,r.prestige));m.setPosition(142,_),this._scrollContiner.addChild(m);var T=ComponentManager.getTextField(LanguageManager.getlocal("prestigeLevelName4",[String(r.prestige)]),TextFieldConst.FONTSIZE_CONTENT_COMMON);T.setPosition(m.x+m.width/2-T.width/2,m.y+18),this._scrollContiner.addChild(T),l<r.prestige&&(T.textColor=10592673);var y=BaseBitmap.create("prestige_circle_bg");y.setPosition(m.x+m.width/2-y.width/2,m.y+m.height),this._scrollContiner.addChild(y);var v=BaseBitmap.create("prestige_chair");v.setPosition(y.x+v.width/2-v.width/2,y.y+v.height/2-v.height/2),this._scrollContiner.addChild(v);var A=BaseBitmap.create("prestige_black_bg");A.setPosition(y.x+y.width/2-A.width/2,y.y+v.height-A.height+2),this._scrollContiner.addChild(A);var w=ComponentManager.getTextField(LanguageManager.getlocal("restige_qualification"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_YELLOW);w.setPosition(A.x+A.width/2-w.width/2,A.y+A.height/2-w.height/2),this._scrollContiner.addChild(w);var x=BaseBitmap.create("prestige_black_bg");x.setPosition(m.x,220),x.width=m.width,x.height=84,this._scrollContiner.addChild(x);var I=ComponentManager.getTextField(LanguageManager.getlocal("prestigeLevelDesc4"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);I.textAlign=egret.HorizontalAlign.CENTER,I.lineSpacing=5,I.setPosition(x.x+100-I.width/2,x.y+x.height/2-I.height/2),this._scrollContiner.addChild(I);for(var L=1;3>=L;L++){var E=BaseBitmap.create("prestige_circle");E.setPosition(x.x+55+105*L,x.y),this._scrollContiner.addChild(E);var B=ComponentManager.getButton("prestige_prerogative"+L,null,this.prerogativeHandle,this,[L],3);B.setPosition(E.x+E.width/2-B.width/2,E.y+E.height/2-B.height/2),this._scrollContiner.addChild(B)}var S=Config.PrestigeCfg.getPrestigeCfgById(2),N=BaseBitmap.create(this.getFlagPicStr(l,S.prestige));N.setPosition(m.x,u),this._scrollContiner.addChild(N);var M=ComponentManager.getTextField(LanguageManager.getlocal("prestigeLevelName3",[String(S.prestige)]),TextFieldConst.FONTSIZE_CONTENT_COMMON);M.setPosition(N.x+N.width/2-M.width/2,N.y+18),this._scrollContiner.addChild(M),l<S.prestige&&(M.textColor=10592673),this.setAwardsBgStr(S.getReward,N.y,l,S.prestige);var b=Config.PrestigeCfg.getPrestigeCfgById(1),O=BaseBitmap.create(this.getFlagPicStr(l,b.prestige));O.setPosition(m.x,C),this._scrollContiner.addChild(O);var V=ComponentManager.getTextField(LanguageManager.getlocal("prestigeLevelName2",[String(b.prestige)]),TextFieldConst.FONTSIZE_CONTENT_COMMON);V.setPosition(O.x+O.width/2-V.width/2,O.y+18),this._scrollContiner.addChild(V),l<b.prestige&&(V.textColor=10592673),this.setAwardsBgStr(b.getReward,O.y,l,b.prestige);var R=Config.PrestigeCfg.getPrestigeCfgById(0),k=BaseBitmap.create(this.getFlagPicStr(l,R.prestige));k.setPosition(m.x,f),this._scrollContiner.addChild(k);var P=ComponentManager.getTextField(LanguageManager.getlocal("prestigeLevelName1",[String(R.prestige)]),TextFieldConst.FONTSIZE_CONTENT_COMMON);P.setPosition(k.x+k.width/2-P.width/2,k.y+18),this._scrollContiner.addChild(P),l<R.prestige&&(P.textColor=10592673),this.setAwardsBgStr(R.getReward,k.y,l,R.prestige);var F=BaseBitmap.create("wifeskin_barbg");F.y=GameConfig.stageHeigth-this.container.y-F.height-t,this.addChildToContainer(F);var D=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"prestigeInfo",this.prestigeInfoHandle,this);D.setPosition(GameConfig.stageWidth/2-D.width/2-180,F.y+F.height/2-D.height/2),this.addChildToContainer(D);var G=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"prestigeLog",this.prestigeLogHandle,this);G.setPosition(GameConfig.stageWidth/2-G.width/2+180,D.y),this.addChildToContainer(G)},e.prototype.prerogativeHandle=function(t){ViewController.getInstance().openView(ViewConst.POPUP.PRESTIGEITEMPOPUPVIEW,{itemId:t})},e.prototype.getFlagPicStr=function(t,e){return t>=e?"prestige_flag2":"prestige_flag1"},e.prototype.setAwardsBgStr=function(t,e,i,a){for(var n=GameData.getRewardItemIcons(t,!0),o=GameData.formatRewardItem(t),s=n.length,r=new BaseDisplayObjectContainer,l=0;s>l;l++){n[l].setPosition((n[l].width+10)*l,0),r.addChild(n[l]);var h=ComponentManager.getTextField(o[l].name,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);h.setPosition(n[l].x+n[l].width/2-h.width/2,n[l].y+n[l].height+4),r.addChild(h)}if(r.setPosition(327,e+50),this._scrollContiner.addChild(r),i>=a)for(var l=0;s>l;l++){var d=BaseBitmap.create("public_9_bg11");d.height=n[l].height,d.width=n[l].width,n[l].addChild(d);var g=ComponentManager.getTextField(LanguageManager.getlocal("candyGetAlready"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_RED);g.setPosition(n[l].x+n[l].width/2-g.width/2,n[l].y+n[l].height/2-g.height/2),r.addChild(g)}},e.prototype.prestigeInfoHandle=function(){ViewController.getInstance().openView(ViewConst.POPUP.PRESTIGEINFOPOPUPVIEW,{})},e.prototype.prestigeLogHandle=function(){ViewController.getInstance().openView(ViewConst.POPUP.PRESTIGELOFPOPUPVIEW,{})},e.prototype.closeHandler=function(){PlayerBottomUI.getInstance().hide(!0),t.prototype.hide.call(this)},e.prototype.dispose=function(){this._scrollContiner=null,this._pillar=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(PrestigeView.prototype,"PrestigeView");var PrisonDetailsPopupView=function(t){function e(){var e=t.call(this)||this;return e.prisonPenaltyConsumptionTxt=null,e.prisonPunishmentOnlineTxt=null,e.prisonProbabilityTxt=null,e.dropTxt=null,e.nameArr=[],e.itemNameStr="",e.PrisonItemCfg=null,e.index=0,e.prisonNameTex=null,e.officeTex=null,e}return __extends(e,t),e.prototype.getTitleStr=function(){return Api.switchVoApi.checkOpenNewPrison()?"prisonDetailsPopupViewTitle_laoyiType":"prisonDetailsPopupViewTitle"},e.prototype.initView=function(){var t=this.param.data-20;this.PrisonItemCfg=Config.PrisonCfg.getIndexPrisonItemCfg(t),this.index=this.param.data;var e=BaseBitmap.create("public_9_bg4");e.x=e.x+25,e.y=e.y+20,e.width=520,e.height=300,this.addChildToContainer(e);var i=BaseLoadBitmap.create("searchbinfowifebg");i.x=i.x+35,i.y=i.y+55,this.addChildToContainer(i);var a=BaseLoadBitmap.create("story_npc_"+this.param.data);a.x+=35,a.y+=25,a.scaleX=.5,a.scaleY=.5,this.addChildToContainer(a);var n=BaseBitmap.create("public_9_probiginnerbg");if(n.width=256,n.height=258,n.x=270,n.y=45,this.addChildToContainer(n),this.prisonPenaltyConsumptionTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this.prisonPenaltyConsumptionTxt.text=LanguageManager.getlocal("prisonPenaltyConsumption",[this.PrisonItemCfg.cost+""]),this.prisonPenaltyConsumptionTxt.setPosition(n.x+10,n.height/4+10),this.addChildToContainer(this.prisonPenaltyConsumptionTxt),this.prisonPunishmentOnlineTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),0==this.PrisonItemCfg.num){var o=LanguageManager.getlocal("prisonerInfinite");this.prisonPunishmentOnlineTxt.text=LanguageManager.getlocal("prisonPunishmentOnline",[o])}else this.prisonPunishmentOnlineTxt.text=LanguageManager.getlocal("prisonPunishmentOnline",[this.PrisonItemCfg.num]);this.prisonPunishmentOnlineTxt.setPosition(this.prisonPenaltyConsumptionTxt.x,n.height/4+40),this.addChildToContainer(this.prisonPunishmentOnlineTxt),this.prisonProbabilityTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this.prisonProbabilityTxt.text=LanguageManager.getlocal("dailyTask_rewardTip"),this.prisonProbabilityTxt.setPosition(this.prisonPenaltyConsumptionTxt.x,this.prisonPunishmentOnlineTxt.y+40),this.addChildToContainer(this.prisonProbabilityTxt),this.dropTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN),this.nameArr=[],this.dropTxt.width=n.width-11,this.dropTxt.height=n.height,this.dropTxt.text=this.getItemStr(),this.dropTxt.setPosition(this.prisonPenaltyConsumptionTxt.x,this.prisonPunishmentOnlineTxt.y+70),this.addChildToContainer(this.dropTxt);var s=BaseLoadBitmap.create("prisonview_namebg");s.width=200,s.height=52,s.x=i.x+10,s.y=260,this.addChildToContainer(s),this.prisonNameTex=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this.prisonNameTex.text=LanguageManager.getlocal("prisonerName"+t),this.prisonNameTex.setPosition(s.width/2+s.x-this.prisonNameTex.width/2,s.y+6),this.addChildToContainer(this.prisonNameTex),this.officeTex=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this.officeTex.text=LanguageManager.getlocal("prisonerOffice"+t),this.officeTex.setPosition(s.width/2+s.x-this.officeTex.width/2,s.y+30),this.addChildToContainer(this.officeTex)},e.prototype.getItemStr=function(){this.nameArr=[],this.itemNameStr="";for(var t=0;t<this.PrisonItemCfg.drop.length;t++){var e=GameData.getRewardItemVoByIdAndType(this.PrisonItemCfg.drop[t]);-1==this.nameArr.indexOf(e.name)&&this.nameArr.push(e.name)}for(var i=0;i<this.nameArr.length;i++)this.itemNameStr=this.itemNameStr.concat(this.nameArr[i]+".");return this.itemNameStr},e.prototype.getShowHeight=function(){return 400},e.prototype.dispose=function(){this.prisonPenaltyConsumptionTxt=null,this.prisonPunishmentOnlineTxt=null,this.dropTxt=null,this.nameArr=[],this.itemNameStr="",this.PrisonItemCfg=null,this.index=0,t.prototype.dispose.call(this)},e}(PopupView);__reflect(PrisonDetailsPopupView.prototype,"PrisonDetailsPopupView");var PrisonHeadView=function(t){function e(){var e=t.call(this)||this;return e.prisonHeadImage=null,e.redCrossImage=null,e.id=0,e.headIcon=null,e}return __extends(e,t),e.prototype.initView=function(){},e.prototype.showHead=function(t,e){var i=this;void 0===t&&(t=0),void 0===e&&(e=0);var a=BaseLoadBitmap.create("mainui_bottombtnbg");a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,a.x=a.x-35,a.y=a.y-25,this.headIcon=a,this.addChild(a);var n=t+21;this.prisonHeadImage=BaseLoadBitmap.create("prison_icon"+n),this.prisonHeadImage.anchorOffsetX=60,this.prisonHeadImage.anchorOffsetY=60,this.prisonHeadImage.scaleX=.6,this.prisonHeadImage.scaleY=.6,this.prisonHeadImage.y+=10;var o=0;if(o=Api.prisonVoApi.getCurrPrisonId()+20,n==o){var s=function(){egret.Tween.get(i.prisonHeadImage).to({scaleX:.7,scaleY:.7},1e3).to({scaleX:.6,scaleY:.6},1e3).call(s,i)};s()}this.addChild(this.prisonHeadImage),this.prisonHeadImage.name=n+"",this.prisonHeadImage.addTouchTap(this.touchPrisonHandler,this),this.redCrossImage=BaseBitmap.create("prisonview_redx"),this.redCrossImage.width=63,this.redCrossImage.anchorOffsetX=this.redCrossImage.width/2,this.redCrossImage.anchorOffsetY=this.redCrossImage.height/2,this.redCrossImage.y=this.prisonHeadImage.y,this.addChild(this.redCrossImage),0==e?(App.DisplayUtil.changeToGray(this.prisonHeadImage),App.DisplayUtil.changeToGray(this.headIcon)):this.redCrossImage.visible=!1},e.prototype.touchPrisonHandler=function(t){var e=Number(t.currentTarget.name);ViewController.getInstance().openView(ViewConst.POPUP.PRISONDETAILSPOPUPVIEW,e)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.prisonHeadImage=null,this.redCrossImage=null,this.id=0,this.headIcon=null},e}(CommonView);__reflect(PrisonHeadView.prototype,"PrisonHeadView");var PrisonPopView=function(t){function e(){var e=t.call(this)||this;return e.prisonerDescribe=null,e.currContainer=null,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_CLOSE_POPUPVIEW,this.hide,this),this.touchEnabled=!1;var t=BaseBitmap.create("prisonview_small_bg");t.x+=13,this.addChildToContainer(t);var e=Api.prisonVoApi.getCurrPrisonId()+20,i=BaseLoadBitmap.create("story_npc_"+e);i.x+=100,i.y+=15,i.scaleX=.8,i.scaleY=.8,this.addChildToContainer(i);var a=BaseBitmap.create("prisonview_itembg");a.x+=15,this.addChildToContainer(a),this.prisonerDescribe=ComponentManager.getTextField("0",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this.prisonerDescribe.text=LanguageManager.getlocal("prisonerDescription"+Api.prisonVoApi.getCurrPrisonId()),this.prisonerDescribe.setPosition(a.x+20,a.y+a.height-60),this.prisonerDescribe.width=t.width-30,this.addChildToContainer(this.prisonerDescribe),this.y=-200,this.alpha=0,egret.Tween.get(this).to({alpha:1,y:0},800).call(this.remove,this)},e.prototype.hide=function(){1==this.touchEnabled&&(t.prototype.hide.call(this),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_CLOSE_BLACKPANEL))},e.prototype.isShowMask=function(){return!1},e.prototype.remove=function(){this.touchEnabled=!0,this.addTouchTap(this.hide,this)},e.prototype.getShowHeight=function(){return 510},e.prototype.getTitleStr=function(){return Api.prisonVoApi.getPrisonTitleStr()},e.prototype.dispose=function(){this.prisonerDescribe=null,this.currContainer=null,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_CLOSE_POPUPVIEW,this.hide,this),t.prototype.dispose.call(this)},e}(PopupView);__reflect(PrisonPopView.prototype,"PrisonPopView");var PrisonView=function(t){function e(){var e=t.call(this)||this;return e.prisonDesBg=null,e.prisonDesBgcorner=null,e.punishprisoners=null,e._prisonerTxt=null,e._PrisonInfoVoList=[],e._progressBar=null,e._nameTxt=null,e._renownTxt=null,e._dailyoutputTxt=null,e._prisonDesc=null,e.prisonDesTxt=null,e.prisonId=0,e._scrollContainer=null,e.dailypreNum=0,e.getMaxpreNum=0,e.getMypreNum=0,e.getPrisonInfoArr=[],e._bubbleContainer=null,e.dialogueContainer=null,e.isOpenOnekey=!1,e.prisonerImage=null,e.currPrisonNumber=0,e.listContainerArr=[],e.hold_dinner_check=null,e.touchIndex=0,e.currIcon=null,e.currIconArr=[],e.hold_dinner_box=null,e._punishmentputTxt=null,e.prisonerHeadImage=null,e.retBoo=!1,e.nameBg=null,e._PrisonPopView=null,e.curr_maskBmp=null,e._dialogueBg=null,e._dialogueBg2=null,e.rewardsData=null,e._newPrisonBoo=Api.switchVoApi.checkOpenNewPrison(),e._hexieType="",e.death=!1,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["prisonview_bg","prisonview_progress","progress3_bg","prisonview_font","prisonview_redx","prisonview_itembg","prisonview_small_bg","searchbinfowifebg","prisonview_namebg","prison_head1","prison_head2","prison_body","prison_bottom","tokenAnimation","punish_ani1","punish_ani2","punish_ani3","punish_ani4","punish_light","prisonview_bg_2","prison_head1_2","prison_head2_2","forpeople_top","prisonview_font_2"])},e.prototype.getRuleInfo=function(){return t.prototype.getRuleInfo.call(this)+this._hexieType},e.prototype.getBgName=function(){return 0==this._newPrisonBoo?"prisonview_bg":"prisonview_bg_2"},e.prototype.getTitleStr=function(){return this._newPrisonBoo?"prisonViewTitle_laoyiType":"prisonViewTitle"},e.prototype.initView=function(){if(Api.rookieVoApi.checkNextStep(),this.refresh(),this._bubbleContainer=new BaseDisplayObjectContainer,this.addChild(this._bubbleContainer),this.dialogueContainer=new BaseDisplayObjectContainer,this.addChild(this.dialogueContainer),this._newPrisonBoo){var t=BaseBitmap.create("forpeople_top");t.setPosition(0,-30),t.height=108,this.addChildToContainer(t)}if(this._prisonerTxt=ComponentManager.getTextField("0",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._prisonerTxt.text=LanguageManager.getlocal("prisonerTxtDesc"+this._hexieType,[this.currPrisonNumber+"",this.getPrisonInfoArr.length+""]),this._prisonerTxt.setPosition(20,0),this.addChildToContainer(this._prisonerTxt),this.showList(),this.refreshHead(),10!=this.prisonId){var e=ComponentManager.getProgressBar("prisonview_progress","progress3_bg",410);e.setPosition(110,GameConfig.stageHeigth-275),this.addChildToContainer(e),this._progressBar=e,0!=this.prisonId&&this.showProgress()}var i=BaseBitmap.create("public_infobg2");this._newPrisonBoo?i.setPosition(240,GameConfig.stageHeigth-300):i.setPosition(240,700),i.rotation=-90,this.addChildToContainer(i),this.nameBg=i,this._nameTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);var a=LanguageManager.getlocal("prisonPrisoner"+this._hexieType);this._nameTxt.text=a+LanguageManager.getlocal(Api.prisonVoApi.getPrisonName()),this._nameTxt.setPosition(i.x+i.width/2-this._nameTxt.width/2+40,i.y-50),this.addChildToContainer(this._nameTxt);var n=BaseBitmap.create("prison_bottom");n.y=GameConfig.stageHeigth-220,this.addChildToContainer(n),this._prisonDesc=ComponentManager.getTextField("0",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._prisonDesc.text=LanguageManager.getlocal("prisonDesc"+this._hexieType),this._prisonDesc.setPosition(50,GameConfig.stageHeigth-130),this.addChildToContainer(this._prisonDesc);var o=BaseBitmap.create("public_9_bg5");o.width=540,o.x=this._prisonDesc.x,o.y=GameConfig.stageHeigth-200,this.addChildToContainer(o),this._renownTxt=ComponentManager.getTextField("0",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._renownTxt.text=LanguageManager.getlocal("renownTxtDesc",[this.getMypreNum+"",this.getMaxpreNum+""]),this._renownTxt.setPosition(80,GameConfig.stageHeigth-190),this.addChildToContainer(this._renownTxt),this._dailyoutputTxt=ComponentManager.getTextField("0",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._dailyoutputTxt.text=LanguageManager.getlocal("dailyoutputDesc",[this.dailypreNum+""]),this._dailyoutputTxt.setPosition(this._renownTxt.x+300,GameConfig.stageHeigth-190),this.addChildToContainer(this._dailyoutputTxt),this.getPrisonInfoArr.length>=4&&this.showOnekeypenalty(),this.showTxt(),this.showDialogue(),this.showDead()},e.prototype.refreshHead=function(){this._newPrisonBoo?(this.prisonerImage=BaseBitmap.create("prison_head1_2"),this.prisonerImage.setPosition(90,this._scrollContainer.y+202)):(this.prisonerImage=BaseBitmap.create("prison_body"),this.prisonerImage.setPosition(200,this._scrollContainer.y+50)),this.prisonerImage.touchEnabled=!0,this.addChildToContainer(this.prisonerImage),this.prisonerImage.addTouchTap(this.touchPunishHandler,this,null),this._newPrisonBoo?(this.prisonerImage.alpha=0,this.prisonerHeadImage=BaseBitmap.create("prison_head1_2"),this.prisonerHeadImage.setPosition(80,this._scrollContainer.y+202),this.prisonerHeadImage.touchEnabled=!1,this.addChildToContainer(this.prisonerHeadImage)):(this.prisonerImage.alpha=1,this.prisonerHeadImage=BaseBitmap.create("prison_head1"),this.prisonerHeadImage.setPosition(this.prisonerImage.x+55,this.prisonerImage.y+152),this.addChildToContainer(this.prisonerHeadImage))
},e.prototype.showDead=function(){if(0==Api.prisonVoApi.getcurrPrisonNumber()){this.nameBg.visible=!1,this.prisonerHeadImage.visible=!1,this.prisonerImage.visible=!1,this._nameTxt.visible=!1,this._progressBar.visible=!1,this.prisonDesTxt.visible=!0;var t=ComponentManager.getTextField("0",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);t.text=LanguageManager.getlocal("prisondes"),t.width=this.punishprisoners.width,t.x=245,t.y=235,this.prisonDesBg.height=t.textHeight+30,(this.prisonDesBg.width<200||this.prisonDesBg.height<76)&&(this.prisonDesBg.width=200,this.prisonDesBg.height=76),this.prisonDesBgcorner.y=this.prisonDesBg.y+this.prisonDesBg.height-3,this._bubbleContainer.addChild(t),this.punishprisoners.visible=!1,this._bubbleContainer.visible=!0}},e.prototype.showDialogue=function(){this._dialogueBg=BaseBitmap.create("public_9_bg42"),this.dialogueContainer.addChild(this._dialogueBg),this._dialogueBg.width=220,this._dialogueBg.height=83,this._dialogueBg.x=50,this._dialogueBg.y=300,this._dialogueBg2=BaseBitmap.create("public_9_bg42_tail"),this.dialogueContainer.addChild(this._dialogueBg2),this._dialogueBg2.scaleX=-1,this._dialogueBg2.x=this._dialogueBg.x+this._dialogueBg.width,this._dialogueBg2.y=this._dialogueBg.y+this._dialogueBg.height-5,this.prisonDesTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN),this.prisonDesTxt.text=LanguageManager.getlocal("PrisonDesTxt"+App.MathUtil.getRandom(1,5)+this._hexieType),this.prisonDesTxt.width=this._dialogueBg.width-15,this.prisonDesTxt.setPosition(this._dialogueBg.x+10,this._dialogueBg.y+15),this.dialogueContainer.addChild(this.prisonDesTxt),this.dialogueContainer.visible=!1},e.prototype.showOnekeypenalty=function(){var t=BaseLoadBitmap.create("hold_dinner_box");t.x=580,t.y=GameConfig.stageHeigth-255,this.addChildToContainer(t),t.addTouchTap(this.holdHandler,this),this.hold_dinner_check=BaseLoadBitmap.create("hold_dinner_check"),this.hold_dinner_check.x=t.x,this.hold_dinner_check.y=t.y,this.addChildToContainer(this.hold_dinner_check),this.hold_dinner_check.visible=!1,this._punishmentputTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._punishmentputTxt.text=LanguageManager.getlocal("prisonPunishment"),this._punishmentputTxt.setPosition(480,GameConfig.stageHeigth-245),this.addChildToContainer(this._punishmentputTxt)},e.prototype.holdHandler=function(t){this.touchIndex+=1,this.touchIndex%2==0?(this.hold_dinner_check.visible=!1,this.isOpenOnekey=!1):(this.hold_dinner_check.visible=!0,this.isOpenOnekey=!0)},e.prototype.showTxt=function(){var t=this;this.prisonDesBg=BaseBitmap.create("public_9_bg25"),this.prisonDesBg.x=230,this.prisonDesBg.y=220,this.prisonDesBg.width=200,this.prisonDesBg.height=76,this.addChildToContainer(this.prisonDesBg),this._bubbleContainer.addChild(this.prisonDesBg),this.prisonDesBgcorner=BaseBitmap.create("public_9_bg25_tail"),this.prisonDesBgcorner.x=this.prisonDesBg.x,this.prisonDesBgcorner.y=this.prisonDesBg.y+this.prisonDesBg.height-3,this.addChildToContainer(this.prisonDesBgcorner),this._bubbleContainer.addChild(this.prisonDesBgcorner),this._newPrisonBoo&&(this.prisonDesBgcorner.scaleX=-1,this.prisonDesBgcorner.x=this.prisonDesBg.x+this.prisonDesBg.width/2+this.prisonDesBgcorner.width/2),this._newPrisonBoo?this.punishprisoners=BaseBitmap.create("prisonview_font_2"):this.punishprisoners=BaseBitmap.create("prisonview_font"),this.punishprisoners.x=this.prisonDesBg.x+15,this.punishprisoners.y=this.prisonDesBg.y+this.prisonDesBg.height/4,this.addChildToContainer(this.punishprisoners),this._bubbleContainer.addChild(this.punishprisoners);var e=this._scrollContainer.y+50-130;this._newPrisonBoo&&(e=this._scrollContainer.y+50-100),this._bubbleContainer.y=e;var i=function(){egret.Tween.get(t._bubbleContainer).to({y:e+5},1e3).to({y:e-5},1e3).call(i,t)};i();var a=this.getChildIndex(this._bubbleContainer);this.curr_maskBmp&&this.setChildIndex(this.curr_maskBmp,a+1)},e.prototype.clearListContainerArr=function(){for(var t=this.listContainerArr.length;t>=0;t--)this.listContainerArr[t]&&this.listContainerArr[t].parent&&(this.listContainerArr[t].parent.removeChild(this.listContainerArr[t]),this.listContainerArr.splice(t,1));this.listContainerArr=[]},e.prototype.touchPunishHandler=function(t){if(this.getMypreNum=0,this.getMypreNum=Api.prisonVoApi.getMypre(),this.prisonerImage.touchEnabled=!1,0!=this.prisonId)var e=Config.PrisonCfg.getIndexPrisonItemCfg(this.prisonId);if(e)if(this.getMypreNum>=e.cost){var i=0;i=this.isOpenOnekey?1:0,NetManager.request(NetRequestConst.REQUEST_PRISON_PUNISH,{prisonId:this.prisonId+"",isbatch:i}),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_PRISON_PUNISH),this.useCallback,this)}else App.CommonUtil.showTip(LanguageManager.getlocal("prison_token")),this.prisonerImage.touchEnabled=!0},e.prototype.playAnimation=function(){SoundManager.playEffect(SoundConst.EFFECT_PRISON_HIT);var t=App.MathUtil.getRandom(1,4),e=new BaseDisplayObjectContainer,i=BaseBitmap.create("punish_ani"+t);e.setScale(2.5),this.addChildToContainer(e),e.addChild(i),e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2;var a=[280,320,280,340],n=[400,400,380,440];e.x=a[t-1],e.y=n[t-1],egret.Tween.get(e).to({scaleX:1,scaleY:1},200).call(function(t){t&&(this.nextAni2(t),this.clipCallback())}.bind(this,e),this)},e.prototype.nextAni2=function(t){var e=BaseBitmap.create("punish_light");t.addChildAt(e,0),egret.Tween.removeTweens(t),egret.Tween.get(t).wait(200).to({alpha:0},500).call(function(t){t&&(egret.Tween.removeTweens(t),t.dispose())}.bind(this,t),this)},e.prototype.clipCallback=function(){this.retBoo&&(this._newPrisonBoo?this.prisonerHeadImage.texture=ResourceManager.getRes("prison_head2_2"):this.prisonerHeadImage.texture=ResourceManager.getRes("prison_head2"),this.prisonDesTxt&&(this.prisonDesTxt.text=LanguageManager.getlocal("PrisonDesTxt"+App.MathUtil.getRandom(1,5))),this._bubbleContainer&&(this._bubbleContainer.visible=!1),this.dialogueContainer&&(this.dialogueContainer.visible=!0),this.rewardsData&&(App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(this.rewardsData.rewards)),this.showRewards(this.rewardsData)))},e.prototype.onComplete2=function(){},e.prototype.useCallback=function(t){var e=this;if(App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_PRISON_PUNISH),this.useCallback,this),0!=t.data.data.ret||1!=t.data.data.data.prisonFlag)if(1==t.data.ret){this.rewardsData=t.data.data.data,this.retBoo=!0,this._newPrisonBoo?this.clipCallback():this.playAnimation();var i=this,a=egret.setTimeout(function(){if(!i.isInit())return void egret.clearTimeout(a);if(0!=e.prisonId&&0==Api.prisonVoApi.getIndexPrisonNum(e.prisonId)){e.death=!0,e.prisonerImage.visible=!1,e.prisonerHeadImage.visible=!1,e._nameTxt.visible=!1,e._progressBar.visible=!1,e.nameBg.visible=!1,e.dialogueContainer.visible=!1;var n=egret.setTimeout(function(){if(!i.isInit())return void egret.clearTimeout(n);if(i.currPrisonNumber<=1&&1!=t.data.prisonFlag){i.refresh(),i.prisonDesTxt.visible=!0;var a=ComponentManager.getTextField("0",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);a.text=LanguageManager.getlocal("prisondes"),a.width=e.punishprisoners.width,a.x=245,a.y=235,e._bubbleContainer.addChild(a),e.prisonDesBg.width=a.textWidth,e.prisonDesBg.height=a.textHeight,(e.prisonDesBg.width<200||e.prisonDesBg.height<76)&&(e.prisonDesBg.width=200,e.prisonDesBg.height=76),i.punishprisoners.visible=!1,e._bubbleContainer.visible=!0}else i.prisonerImage.visible=!0,i.prisonerHeadImage.visible=!0,e._newPrisonBoo?i.prisonerHeadImage.texture=ResourceManager.getRes("prison_head1_2"):i.prisonerHeadImage.texture=ResourceManager.getRes("prison_head1"),i._nameTxt.visible=!0,i._progressBar.visible=!0,i.nameBg.visible=!0,i.refresh()},i,1300,1)}else i.death=!1,i.refresh()},i,800,1)}else this.retBoo=!1;else{var n=this;if(n.prisonerImage.visible=!0,n.prisonerHeadImage.visible=!0,n._nameTxt&&(n._nameTxt.visible=!0),n.nameBg&&(n.nameBg.visible=!0),n.refresh(),n.death=!1,this.restPrisonView(),10!=this.prisonId){var o=ComponentManager.getProgressBar("prisonview_progress","progress3_bg",410);o.setPosition(110,GameConfig.stageHeigth-275),this.addChildToContainer(o),this._progressBar=o,0!=this.prisonId&&this.showProgress()}}},e.prototype.showRewards=function(t){this.currIconArr=[];for(var e=GameData.formatRewardItem(t.rewards),i=0;i<e.length;i++){var a=GameData.getItemIcon(e[i],!0);a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,a.scaleX=.5,a.scaleY=.5,a.x=300,a.y=GameConfig.stageHeigth/2-70,this.addChild(a),App.DisplayUtil.addFactorFunc(BaseDisplayObjectContainer);var n=App.MathUtil.getRandom(500);this._newPrisonBoo?(a.y=GameConfig.stageHeigth-300,a.x=180,a.tweenMoveList=[egret.Point.create(a.x,a.y),egret.Point.create(n,400),egret.Point.create(n,900)]):a.tweenMoveList=[egret.Point.create(a.x,a.y),egret.Point.create(n,200),egret.Point.create(n,800)],egret.Tween.get(a).to({}).call(this.onComplete,this,[a]),this.addChild(a),this.currIconArr.push(a)}},e.prototype.onComplete=function(t){void 0===t&&(t=null);for(var e=this.currIconArr.length,i=e-1;i>=0;i--)egret.Tween.removeTweens(this.currIconArr[i]),egret.Tween.get(this.currIconArr[i]).wait(100).to({factor:1},700).call(function(t){var e=this,a=egret.setTimeout(function(){return e.isInit()?(e.restPrisonView(),t.dispose(),t.tweenMoveList=void 0,void e.currIconArr.splice(i,1)):void egret.clearTimeout(a)},this,800)}.bind(this,this.currIconArr[i]))},e.prototype.restPrisonView=function(){this.death||(this.dialogueContainer&&(this.dialogueContainer.visible=!0),this.prisonerHeadImage&&(this._newPrisonBoo?this.prisonerHeadImage.texture=ResourceManager.getRes("prison_head1_2"):this.prisonerHeadImage.texture=ResourceManager.getRes("prison_head1")),this.prisonerImage&&(this.prisonerImage.visible=!0)),this._bubbleContainer&&(this._bubbleContainer.visible=!0),this.dialogueContainer&&(this.dialogueContainer.visible=!1),this.prisonDesTxt&&(this.prisonDesTxt.text=""),this.prisonerImage&&(this.prisonerImage.touchEnabled=!0)},e.prototype.getRandom=function(){return App.MathUtil.getRandom(100,540)},e.prototype.showList=function(){this.clearListContainerArr(),this._scrollContainer=null,this._scrollContainer=new BaseDisplayObjectContainer;for(var t=0;t<this.getPrisonInfoArr.length;t++){var e=new PrisonHeadView;e.showHead(t,this.getPrisonInfoArr[t]),e.x=80*t+4,this.listContainerArr.push(e),this._scrollContainer.addChild(e)}this.addChild(this._scrollContainer);var i=egret.Rectangle.create();i.setTo(120,-10,470,400);var a=ComponentManager.getScrollView(this._scrollContainer,i);this.getPrisonInfoArr.length>=6&&this.prisonId>6&&a.setScrollLeft(500),this.addChildToContainer(a),this._scrollContainer.setPosition(30,30),this.listContainerArr.push(a)},e.prototype.showProgress=function(){if(0!=this.prisonId&&10!=this.prisonId){var t=Config.PrisonCfg.getIndexPrisonItemCfg(this.prisonId),e=Api.prisonVoApi.getIndexPrisonNum(this.prisonId),i=0;i=e/t.num;var a=LanguageManager.getlocal("prisonOutput")+": ";this._progressBar.setPercentage(i,a+Math.floor(100*i)+"%")}else this._progressBar&&this._progressBar.parent&&(this._progressBar.parent.removeChild(this._progressBar),this._progressBar.dispose(),this._progressBar=null)},e.prototype.refresh=function(){if(this.retBoo=!1,this.dailypreNum=Api.prisonVoApi.getDailypre(),this.getMaxpreNum=Api.prisonVoApi.getMaxpre(),this.getMypreNum=Api.prisonVoApi.getMypre(),this.getPrisonInfoArr=Api.prisonVoApi.getPrisonInfo(),this.prisonId=Api.prisonVoApi.getCurrPrisonId(),this.currPrisonNumber=Api.prisonVoApi.getcurrPrisonNumber(),0!=this.prisonId)var t=Api.prisonVoApi.getIndexPrisonNum(this.prisonId),i=Config.PrisonCfg.getIndexPrisonItemCfg(this.prisonId),a=t/i.num;if(1==a){if(Api.rookieVoApi.isGuiding)return;this.drawblackMask(),0==e.INFINITE_NUM&&1==this.prisonId?ViewController.getInstance().openView(ViewConst.POPUP.PRISONPOPVIEW):ViewController.getInstance().openView(ViewConst.POPUP.PRISONPOPVIEW),this._PrisonPopView=ViewController.getInstance().getView(ViewConst.POPUP.PRISONPOPVIEW),App.MessageHelper.addEventListener(MessageConst.MESSAGE_CLOSE_BLACKPANEL,this._closeHandler,this)}if(this._renownTxt&&(this._renownTxt.text=LanguageManager.getlocal("renownTxtDesc",[this.getMypreNum+"",this.getMaxpreNum+""])),this._progressBar&&this.showProgress(),this._prisonerTxt&&(this._prisonerTxt.text=LanguageManager.getlocal("prisonerTxtDesc"+this._hexieType,[this.currPrisonNumber+"",this.getPrisonInfoArr.length+""])),this._nameTxt){var n=LanguageManager.getlocal("prisonPrisoner"+this._hexieType);this._nameTxt.text=n+LanguageManager.getlocal(""+Api.prisonVoApi.getPrisonName())}this.showList()},e.prototype.drawblackMask=function(){this.curr_maskBmp=BaseBitmap.create("public_9_viewmask"),this.curr_maskBmp.width=GameConfig.stageWidth,this.curr_maskBmp.height=GameConfig.stageHeigth,this.curr_maskBmp.touchEnabled=!0,this.curr_maskBmp.addTouchTap(this.closePrisonHead,this),this.addChild(this.curr_maskBmp)},e.prototype.closePrisonHead=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_CLOSE_POPUPVIEW)},e.prototype._closeHandler=function(){this.curr_maskBmp&&this.curr_maskBmp.parent&&(this.removeChild(this.curr_maskBmp),this.curr_maskBmp=null),null!=this._PrisonPopView&&this._PrisonPopView.removeEventListener("closeEvent",this._closeHandler,this)},e.prototype.getShowHeight=function(){return 200},e.prototype.dispose=function(){e.INFINITE_NUM=0,this.touchIndex=0,this.prisonDesBg=null,this.prisonDesBgcorner=null,this.punishprisoners=null,this._prisonerTxt=null,this._PrisonInfoVoList=[],this._progressBar=null,this._nameTxt=null,this._renownTxt=null,this._dailyoutputTxt=null,this._prisonDesc=null,this.prisonId=0,this.dailypreNum=0,this.getMaxpreNum=0,this.getMypreNum=0,this.getPrisonInfoArr=[],this.isOpenOnekey=!1,this.prisonerHeadImage=null,this.prisonerImage.removeTouch(),this._scrollContainer.dispose(),this._PrisonInfoVoList=[],this._scrollContainer=null,this._bubbleContainer.dispose(),this._bubbleContainer=null,this.prisonerImage=null,this.getPrisonInfoArr=[],this.currIconArr=[],this._punishmentputTxt=null,this.curr_maskBmp=null,this.dialogueContainer=null,this.rewardsData=null,App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_PRISON_PUNISH),this.useCallback,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_CLOSE_BLACKPANEL,this._closeHandler,this),t.prototype.dispose.call(this)},e.INFINITE_NUM=0,e}(CommonView);__reflect(PrisonView.prototype,"PrisonView");var PromotionSuccessView=function(t){function e(){var e=t.call(this)||this;return e._temW=45,e._num=1,e._totalTime=600,e._repeatCount=20,e}return __extends(e,t),e.prototype.initView=function(){var t=TextFieldConst.COLOR_WHITE,e=BaseBitmap.create("promotion_bg1");e.scaleX=e.scaleY=1.2,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=GameConfig.stageWidth/2,e.y=420,this.addChildToContainer(e),this._bgTween=egret.Tween.get(e,{loop:!0}),this._bgTween.to({rotation:360},16e3);var i=BaseBitmap.create("promotion_sucess");i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.x=GameConfig.stageWidth/2,i.y=i.height/2+20,i.setScale(1.3),this.addChildToContainer(i),this._titleTween=egret.Tween.get(i),this._titleTween.to({scaleX:1,scaleY:1},100).call(this.onChange,this);var a=BaseBitmap.create("public_get_namebg");a.x=50,a.y=180,this.addChildToContainer(a);var n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_COMMON);n.multiline=!0,n.width=26,n.text=Api.playerVoApi.getPlayerOffice(),n.x=a.x+a.width/2-n.width/2,n.y=a.y+80-n.height/2,this.addChildToContainer(n);var o=Api.playerVoApi.getPlayerPortrait(Api.playerVoApi.getPlayerLevel(),Api.playerVoApi.getPlayePicId());o.x=this.viewBg.width/2-o.width/2,o.y=180,this.addChildToContainer(o);var s=new BaseDisplayObjectContainer,r=App.CommonUtil.getContainerByLeftHalfRes("public_rule_bg");s.y=GameConfig.stageHeigth-r.height,this.addChildToContainer(s),s.addChild(r);var l=BaseBitmap.create("promotion_officerbg1");l.x=GameConfig.stageWidth/2-l.width/2,l.y=s.y-30,this.addChildToContainer(l);var h=ComponentManager.getTextField(LanguageManager.getlocal("officeUpgradeTitle",[Api.playerVoApi.getPlayerOffice()]),TextFieldConst.FONTSIZE_BUTTON_COMMON);h.x=r.width/2-h.width/2,h.y=l.y+l.height/2-h.height/2,h.setColor(TextFieldConst.COLOR_LIGHT_YELLOW),this.addChildToContainer(h);var d=ComponentManager.getTextField(LanguageManager.getlocal("promotion_privilege"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);d.x=GameConfig.stageWidth/2-d.width/2,d.y=60,s.addChild(d);var g=Api.playerVoApi.getPlayerLevel(),c=ComponentManager.getTextField(Api.playerVoApi.getCurLevelPrivilegeTxtStr(g),TextFieldConst.FONTSIZE_CONTENT_SMALL,t);c.x=GameConfig.stageWidth/2-c.width/2,c.y=d.y+30,c.lineSpacing=5,s.addChild(c),this._scrollRight=BaseBitmap.create("promotion_scroll"),this._scrollRight.y=s.y+2,this.addChildToContainer(this._scrollRight),s.x=this.viewBg.width/2-this._temW,this._scrollRight.x=this.viewBg.width/2;var p=egret.Rectangle.create();p.setTo(-s.width/2+this._scrollRight.width,0,r.width/2,r.height),s.mask=p,this._scrollContainer=s,this.addTouchTap(this.tapHandler,this,null)},e.prototype.tapHandler=function(){this.hide();var t=Api.wifeVoApi.getWaitShowWife();t&&ViewController.getInstance().openView(ViewConst.BASE.WIFEGETVIEW,{wifeIdList:t.unlockWife,servantId:t.unlockServant});var e=Api.servantVoApi.getWaitShowData();e&&ViewController.getInstance().openView(ViewConst.BASE.SERVANTGETVIEW,e.unlockServant)},e.prototype.getBgName=function(){return"public_9_black"},e.prototype.doTimerHandler=function(){var t=this._scrollContainer.mask,e=(this._scrollContainer.width/2-this._temW)/this._repeatCount*this._num;this._scrollContainer.x=this.viewBg.width/2-this._temW-e,t.setTo(-this._scrollContainer.width/2+this._scrollRight.width+e,0,297+e,449),this._scrollContainer.mask=t,this._scrollRight.x=this.viewBg.width/2+e-this._temW,this._num+=1},e.prototype.complateHandler=function(){var t=this._scrollContainer.mask;egret.Rectangle.release(t),this._scrollContainer.mask=null,this.removeChildFromContainer(this._scrollRight),this._scrollRight.dispose(),this._scrollRight=null,TimerManager.removeAll(this)},e.prototype.onChange=function(){this._titleTween&&(egret.Tween.removeTweens(this._titleTween),this._titleTween=null,TimerManager.doTimer(this._totalTime/this._repeatCount,this._repeatCount,this.doTimerHandler,this,this.complateHandler,this)),this._levelTween&&(egret.Tween.removeTweens(this._levelTween),this._levelTween=null)},e.prototype.getParent=function(){return PlayerBottomUI.getInstance().parent},e.prototype.getResourceList=function(){return["promotion_bg1","promotion_sucess","promotion_scroll"]},e.prototype.getTitleStr=function(){return null},e.prototype.getButtomLineBg=function(){return null},e.prototype.getCloseBtnName=function(){return null},e.prototype.getTitleBgName=function(){return null},e.prototype.dispose=function(){this.onChange(),this._bgTween&&(egret.Tween.removeTweens(this._bgTween),this._bgTween=null),TimerManager.isExists(this.doTimerHandler,this)&&TimerManager.removeAll(this),this._levelTF=null,this._scrollContainer=null,this._scrollRight=null,this._temW=45,this._num=1,t.prototype.dispose.call(this)},e}(CommonView);__reflect(PromotionSuccessView.prototype,"PromotionSuccessView");var PromotionView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USER_UPGRADE),this.refreshInfoAfterUpgrade,this),this._nodeContainer=new BaseDisplayObjectContainer,this._nodeContainer.y=-20,this.addChildToContainer(this._nodeContainer);var t=BaseBitmap.create("playerview_bg2");t.y=0,this._nodeContainer.addChild(t);var e=BaseBitmap.create("promotion_arrow");e.x=t.width/2-e.width/2,e.y=t.height/2-e.height/2,this._nodeContainer.addChild(e);var i=BaseBitmap.create("public_9_bg22");i.height=480,i.y=GameConfig.stageHeigth-this.container.y-i.height+20,i.x=0;var a=Api.playerVoApi.getPlayerLevel(),n=Config.LevelCfg.getCfgByLevel(a.toString()),o=Config.LevelCfg.getCfgByLevel((a+1).toString());this._leftRoleContainer=Api.playerVoApi.getPlayerPortrait(a,Api.playerVoApi.getPlayePicId()),this._leftRoleContainer.scaleX=.85,this._leftRoleContainer.scaleY=.85,this._leftRoleContainer.x=40;var s=i.y-this._leftRoleContainer.height*this._leftRoleContainer.scaleY;s=15,this._leftRoleContainer.y=s,this._nodeContainer.addChild(this._leftRoleContainer),o?(this._rightRoleContainer=Api.playerVoApi.getPlayerPortrait(a+1,Api.playerVoApi.getPlayePicId()),this._rightRoleContainer.scaleX=this._leftRoleContainer.scaleX,this._rightRoleContainer.scaleY=this._leftRoleContainer.scaleY,this._rightRoleContainer.x=340,this._rightRoleContainer.y=this._leftRoleContainer.y,this._nodeContainer.addChild(this._rightRoleContainer)):(e.visible=!1,this._leftRoleContainer.x=GameConfig.stageWidth/2-this._leftRoleContainer.width*this._leftRoleContainer.scaleX/2),this._nodeContainer.addChild(i);for(var r=[{lvData:n,lv:a,roleImgPosX:40,roleImgPosY:41,officerbgX:35,officerbgY:i.y-60,probgPosX:27,probgPosY:i.y+30},{lvData:o,lv:a+1,roleImgPosX:372,roleImgPosY:41,officerbgX:340,officerbgY:i.y-60,probgPosX:324,probgPosY:i.y+30}],l=[{lvData:n,lv:a,roleImgPosX:206,roleImgPosY:41,officerbgX:187,officerbgY:i.y-60,probgPosX:27,probgPosY:i.y+30,roleImg:"user_body1"}],h=!1,d=0;d<r.length;d++){var g=r[d],c=g.lvData;o||(0==d?g=l[0]:h=!0);var p=void 0,_=void 0;0==h&&(_=BaseBitmap.create("promotion_officerbg1"),_.x=g.officerbgX,_.y=g.officerbgY,this._nodeContainer.addChild(_),p=ComponentManager.getTextField("",24,TextFieldConst.COLOR_LIGHT_YELLOW),p.text=LanguageManager.getlocal("officialTitle"+g.lv),p.x=_.x+_.width/2-p.width/2,p.y=_.y+_.height/2-p.height/2,this._nodeContainer.addChild(p));var u=BaseBitmap.create("public_9_probiginnerbg");u.width=290,u.height=270,u.x=g.probgPosX,u.y=g.probgPosY,this._nodeContainer.addChild(u);var C=ComponentManager.getTextField(LanguageManager.getlocal("promotion_privilege"),24,TextFieldConst.COLOR_LIGHT_YELLOW);C.x=u.x+20,C.y=u.y+20,this._nodeContainer.addChild(C);var f=ComponentManager.getTextField("",20,TextFieldConst.COLOR_WHITE);f.multiline=!0,f.lineSpacing=13,0==d?(f.text=Api.playerVoApi.getCurLevelPrivilegeTxtStr(a),this._leftOfficerTxt=p,this._leftPrivilegeTxt=f,this._leftofficerbg=_):(f.text=Api.playerVoApi.getCurLevelPrivilegeTxtStr(a+1),this._rightOfficerTxt=p,this._rightPrivilegeTxt=f,this._rightPrivilegeTxt.textColor=TextFieldConst.COLOR_WARN_GREEN,this._rightofficerbg=_),c?(f.x=C.x,f.y=C.y+35):(f.x=u.x+u.width/2-f.width/2,f.y=u.y+u.height/2-f.height/2),this._nodeContainer.addChild(f)}var m=ComponentManager.getTextField(LanguageManager.getlocal("promptLevelTip"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);m.x=this._nodeContainer.width/2-m.width/2,m.y=i.y+330,this._nodeContainer.addChild(m),this._progressBar=ComponentManager.getProgressBar("progress3","progress3_bg",566),this._progressBar.x=32,this._progressBar.y=m.y+25,this._nodeContainer.addChild(this._progressBar),this._expTipTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this.refreshProgressAndTxt(),this._expTipTxt.x=GameConfig.stageWidth/2-this._expTipTxt.width/2,this._expTipTxt.y=this._progressBar.y+this._progressBar.height/2-this._expTipTxt.height/2,this._nodeContainer.addChild(this._expTipTxt);var T=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"promotionViewUpd",this.levelupBtnClickHandler,this);T.x=GameConfig.stageWidth/2-T.width/2,T.y=this._progressBar.y+40,T.setColor(TextFieldConst.COLOR_BLACK),this._nodeContainer.addChild(T)},e.prototype.levelupBtnClickHandler=function(){var t=Api.playerVoApi.getPlayerLevel(),e=Config.LevelCfg.getCfgByLevel((t+1).toString());return e?Api.playerVoApi.getPlayerExp()<e.exp?void App.CommonUtil.showTip(LanguageManager.getlocal("promotion_upgradeTip2")):void NetManager.request(NetRequestConst.REQUEST_USER_UPGRADE,{}):void App.CommonUtil.showTip(LanguageManager.getlocal("promotion_upgradeTip1"))},e.prototype.refreshProgressAndTxt=function(){var t=Api.playerVoApi.getPlayerLevel(),e=Config.LevelCfg.getCfgByLevel((t+1).toString());e?(this._progressBar.setPercentage(Api.playerVoApi.getPlayerExp()/e.exp),this._expTipTxt.text=LanguageManager.getlocal("playerview_exp")+Api.playerVoApi.getPlayerExp()+" / "+e.exp):(this._progressBar.setPercentage(1),this._expTipTxt.text=LanguageManager.getlocal("promotion_topLevel"),this._expTipTxt.x=GameConfig.stageWidth/2-this._expTipTxt.width/2)},e.prototype.refreshInfoAfterUpgrade=function(t){var e=t.data.data;if(0==e.ret){ViewController.getInstance().openView(ViewConst.COMMON.PROMOTIONSUCCESSVIEW);var i=Api.playerVoApi.getPlayerLevel(),a=Config.LevelCfg.getCfgByLevel((i+1).toString());if(this.refreshProgressAndTxt(),this._leftOfficerTxt.text=LanguageManager.getlocal("officialTitle"+i),this._leftPrivilegeTxt.text=Api.playerVoApi.getCurLevelPrivilegeTxtStr(i),this._rightPrivilegeTxt.text=Api.playerVoApi.getCurLevelPrivilegeTxtStr(i+1),a){this._rightOfficerTxt.text=LanguageManager.getlocal("officialTitle"+(i+1)),this._rightOfficerTxt.textColor=TextFieldConst.COLOR_WHITE;var n=this._leftRoleContainer.getChildByName("myBody"),o=this._rightRoleContainer.getChildByName("myBody");o.setload("user_body"+String(i+1)),n.setload("user_body"+i)}else{this._rightRoleContainer&&(this._rightRoleContainer.visible=!1,this._rightOfficerTxt.visible=!1,this._rightofficerbg.visible=!1,this._rightPrivilegeTxt.y=564,this._rightPrivilegeTxt.x=399);var n=this._leftRoleContainer.getChildByName("myBody");n.setload("user_body"+i),this._leftRoleContainer.x=GameConfig.stageWidth/2-this._leftRoleContainer.width*this._leftRoleContainer.scaleX/2,this._leftOfficerTxt.x=GameConfig.stageWidth/2-this._leftOfficerTxt.width/2,this._leftofficerbg.x=GameConfig.stageWidth/2-this._leftofficerbg.width/2}}},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["playerview_bg2","promotion_officerbg1","promotion_arrow","progress3","progress3_bg"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USER_UPGRADE),this.refreshInfoAfterUpgrade,this),this._nodeContainer=null,this._rightRoleContainer=null,this._leftRoleContainer=null,this._progressBar=null,this._expTipTxt=null,this._leftPrivilegeTxt=null,this._leftOfficerTxt=null,this._leftofficerbg=null,this._rightPrivilegeTxt=null,this._rightOfficerTxt=null,this._rightofficerbg=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(PromotionView.prototype,"PromotionView");var RankScrollItem=function(t){function e(){var e=t.call(this)||this;return e._rowIdx=0,e._uiData=void 0,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICR_REFRESH_RANKITEM,this.refreshSelectStatus,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_USERSHOT),this.userShotCallback,this),this._rowIdx=t,this._uiData=e,this.width=602,this.height=52,this.addTouch(this.eventHandler,this,null,!0);var i=TextFieldConst.COLOR_BROWN;if(this._uiData.uid==Api.playerVoApi.getPlayerID()&&(i=TextFieldConst.COLOR_WARN_YELLOW),this._rowIdx<3){var a=BaseBitmap.create("rank_"+String(this._rowIdx+1));a.x=70-a.width/2,a.y=this.height/2-a.height/2,this.addChild(a)}else{var n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,i);n.text=String(this._rowIdx+1),n.x=70-n.width/2,n.y=this.height/2-n.height/2,this.addChild(n)}var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,i);if(o.text=this._uiData.name,o.y=this.height/2-o.height/2,this.addChild(o),this._uiData.total_imacy){o.x=235-o.width/2;var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,i);s.text=this._uiData.total_imacy,s.x=495-s.width/2,s.y=o.y,this.addChild(s)}else if(this._uiData.cid){o.x=235-o.width/2;var r=Api.challengeVoApi.getBigChannelIdByCid(this._uiData.cid),l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,i);l.text=r+"."+LanguageManager.getlocal("challengeTitle"+r),l.x=430,l.y=o.y,this.addChild(l)}else{if(o.x=205-o.width/2,""!=this._uiData.title){var h=BaseLoadBitmap.create("user_title_"+this._uiData.title+"_3"),d=.8;h.width=155*d,h.height=59*d,h.x=320,h.y=o.y+o.height/2-h.height/2,this.addChild(h)}else{var g=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,i);g.text=LanguageManager.getlocal("officialTitle"+this._uiData.level),g.x=380-g.width/2,g.y=o.y,this.addChild(g)}var c=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,i);c.text=App.StringUtil.changeIntToText(Number(this._uiData.power)),c.x=530-c.width/2,c.y=o.y,this.addChild(c)}var p=BaseBitmap.create("rank_line");p.x=GameConfig.stageWidth/2-p.width/2,p.y=this.height,this.addChild(p);var _=BaseBitmap.create("rank_select_mask");_.x=GameConfig.stageWidth/2-_.width/2,_.y=0,_.visible=!1,this._maskImg=_,this.addChild(_),this.cacheAsBitmap=!0},e.prototype.eventHandler=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._maskImg.visible=!0;break;case egret.TouchEvent.TOUCH_CANCEL:this._maskImg.visible=!1;break;case egret.TouchEvent.TOUCH_END:this._maskImg.visible=!1,App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICR_REFRESH_RANKITEM,this._rowIdx),NetManager.request(NetRequestConst.REQUEST_RANK_USERSHOT,{ruid:this._uiData.uid})}},e.prototype.refreshSelectStatus=function(t){var e=t.data;this._rowIdx!=e&&(this._maskImg.visible=!1)},e.prototype.userShotCallback=function(t){var e=t.data.data.data;String(e.ruid)==this._uiData.uid&&ViewController.getInstance().openView(ViewConst.POPUP.RANKUSERINGOPOPUPVIEW,e)},e.prototype.getSpaceX=function(){return 10},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICR_REFRESH_RANKITEM,this.refreshSelectStatus,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_USERSHOT),this.userShotCallback,this),this._maskImg=null,this._rowIdx=null,this._uiData=null,this.cacheAsBitmap=!1,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(RankScrollItem.prototype,"RankScrollItem");var RankView=function(t){function e(){var e=t.call(this)||this;return e._curTabIdx=0,e._listPosY=0,e._redList=[],e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_VISIT),this.worshipCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_INDEX),this.refreshRankList,this),NetManager.request(NetRequestConst.REQUEST_RANK_INDEX,{}),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var t=BaseBitmap.create("wifeview_bottombg");t.x=0,t.y=GameConfig.stageHeigth-t.height-this.container.y,this._nodeContainer.addChild(t);var e=BaseBitmap.create("servant_bottombg");e.width=GameConfig.stageWidth+18,e.x=-9,e.y=-35,e.height=t.y-e.y+20,this._nodeContainer.addChildAt(e,0);var i=["rankTab1","rankTab2","rankTab3"],a=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,i,this.tabBtnClickHandler,this);a.x=15,a.y=e.y+24,this._nodeContainer.addChild(a);for(var n=a.x,o=0;o<i.length;o++){var s=BaseBitmap.create("public_dot2");0==o&&(s.x=n+122),1==o&&(s.x=n+280),2==o&&(s.x=n+437),s.y=a.y,s.visible=!Api.otherInfoVoApi.isRankVisited(o),this._nodeContainer.addChild(s),this._redList.push(s)}var r=BaseBitmap.create("public_9_bg32");r.height=e.height-95,r.width=624,r.x=GameConfig.stageWidth/2-r.width/2,r.y=e.y+80,this._nodeContainer.addChild(r);var l=BaseBitmap.create("public_9_bg33");l.width=r.width,l.height=50,l.x=r.x,l.y=r.y,this._nodeContainer.addChild(l),this._listPosY=l.y+l.height+5,this._scroRect=new egret.Rectangle(l.x,0,l.width,r.height-l.height-90);
var h=BaseBitmap.create("public_9_bg34");h.width=r.width,h.height=74,h.x=r.x,h.y=r.y+r.height-h.height-10,this._nodeContainer.addChild(h);var d=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_ORANGE);d.text=LanguageManager.getlocal("rankworship_tip"),d.x=h.x+30,d.y=h.y+h.height/2-d.height/2,this._nodeContainer.addChild(d);var g=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"rankworship",this.worshipBtnHandler,this);g.x=h.x+h.width-g.width-30,g.y=h.y+h.height/2-g.height/2,g.visible=!1,this._nodeContainer.addChild(g),this._worshipBtn=g,this._worshipFlag=BaseBitmap.create("rank_visited"),this._worshipFlag.anchorOffsetX=this._worshipFlag.width/2,this._worshipFlag.anchorOffsetY=this._worshipFlag.height/2,this._worshipFlag.setScale(.7),this._worshipFlag.x=g.x+60,this._worshipFlag.y=g.y+20,this._worshipFlag.visible=!1,this._nodeContainer.addChild(this._worshipFlag);var c=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);c.text=LanguageManager.getlocal("rankorder"),c.x=d.x+10,c.y=l.y+l.height/2-c.height+15,this._nodeContainer.addChild(c),this._title_rankTxt=c;var p=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);p.text=LanguageManager.getlocal("ranknickName"),p.x=c.x+110,p.y=c.y,this._nodeContainer.addChild(p),this._title_nameTxt=p;var _=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);_.text=LanguageManager.getlocal("rankofficer"),_.x=p.x+200,_.y=c.y,this._nodeContainer.addChild(_),this._title_officerTxt=_;var u=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);u.text=LanguageManager.getlocal("rankpower"),u.x=_.x+150,u.y=c.y,this._nodeContainer.addChild(u),this._title_powerTxt=u;var C=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);C.text=LanguageManager.getlocal("ranknickName2",[Api.playerVoApi.getPlayerName()]),C.x=d.x,C.y=t.y+20,this._nodeContainer.addChild(C);var f=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);f.x=C.x+300,f.y=C.y,this._nodeContainer.addChild(f),this._rankTxt=f;var m=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);m.text=LanguageManager.getlocal("rankofficer2",[Api.playerVoApi.getPlayerOffice()]),m.x=C.x,m.y=C.y+35,this._nodeContainer.addChild(m);var T=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);T.x=f.x,T.y=m.y,this._nodeContainer.addChild(T),this._powerTxt=T},e.prototype.refreshTopTitle=function(){if(0==this._curTabIdx)this._title_officerTxt.text=LanguageManager.getlocal("rankofficer"),this._title_powerTxt.text=LanguageManager.getlocal("rankpower"),this._powerTxt.text=LanguageManager.getlocal("rankpower2",[String(Api.playerVoApi.getPlayerPower())]),this._rankTxt.text=LanguageManager.getlocal("rankorder2",[String(Api.rankVoApi.getprank())]),this._title_nameTxt.x=this._title_rankTxt.x+110,this._title_officerTxt.x=this._title_nameTxt.x+200,this._title_powerTxt.x=this._title_officerTxt.x+150;else if(1==this._curTabIdx){var t=Api.rankVoApi.getcid(),e=Api.challengeVoApi.getBigChannelIdByCid(t),i=String(e)+"."+LanguageManager.getlocal("challengeTitle"+e);this._powerTxt.text=LanguageManager.getlocal("rankchallenge",[i]),this._rankTxt.text=LanguageManager.getlocal("rankorder2",[String(Api.rankVoApi.getcRank())]),this._title_officerTxt.text=LanguageManager.getlocal("rank_challenge"),this._title_powerTxt.text="",this._title_nameTxt.x=this._title_rankTxt.x+140,this._title_officerTxt.x=this._title_nameTxt.x+270}else 2==this._curTabIdx&&(this._powerTxt.text=LanguageManager.getlocal("rankimacy",[String(Api.rankVoApi.getimacy())]),this._rankTxt.text=LanguageManager.getlocal("rankorder2",[String(Api.rankVoApi.getirank())]),this._title_officerTxt.text=LanguageManager.getlocal("rank_imacy"),this._title_powerTxt.text="",this._title_nameTxt.x=this._title_rankTxt.x+140,this._title_officerTxt.x=this._title_nameTxt.x+270)},e.prototype.worshipCallback=function(t){for(var e=0;e<this._redList.length;e++)this._redList[e].visible=!Api.otherInfoVoApi.isRankVisited(e);var i=t.data;1==i.ret&&i.data.data.lucky&&App.CommonUtil.showGodbless("rank"),this._worshipBtn.visible=!1,this._worshipFlag.setScale(1.3),this._worshipFlag.visible=!0,egret.Tween.get(this._worshipFlag,{loop:!1}).to({scaleX:.7,scaleY:.7},400).wait(600).call(function(){ViewController.getInstance().openView(ViewConst.BASE.RANKWORSHIPVIEW,i)})},e.prototype.worshipBtnHandler=function(){NetManager.request(NetRequestConst.REQUEST_RANK_VISIT,{dtype:this._curTabIdx+1})},e.prototype.tabBtnClickHandler=function(t){this._curTabIdx=t.index,this.refreshRankList()},e.prototype.refreshRankList=function(){this.refreshTopTitle(),Api.otherInfoVoApi.isRankVisited(this._curTabIdx)?(this._worshipFlag.visible=!0,this._worshipBtn.visible=!1):(this._worshipFlag.visible=!1,this._worshipBtn.visible=!0);var t=Api.rankVoApi.getRankListByTabIdx(this._curTabIdx);this._scrollList?this._scrollList.refreshData(t):(this._scrollList=ComponentManager.getScrollList(RankScrollItem,t,this._scroRect),this._scrollList.y=this._listPosY,this._nodeContainer.addChild(this._scrollList))},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["rank_1","rank_2","rank_3","rank_display_namebg","rank_line","rank_select_mask","servant_bottombg","wifeview_bottombg","rank_visited"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_VISIT),this.worshipCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_RANK_INDEX),this.refreshRankList,this),this._curTabIdx=0,this._nodeContainer=null,this._scrollList=null,this._title_nameTxt=null,this._title_officerTxt=null,this._title_powerTxt=null,this._title_rankTxt=null,this._rankTxt=null,this._powerTxt=null,this._redList=[],t.prototype.dispose.call(this)},e}(CommonView);__reflect(RankView.prototype,"RankView");var RankWorshipView=function(t){function e(){var e=t.call(this)||this;return e._clickNum=0,e._hideSt=null,e._rewardStr="",e}return __extends(e,t),e.prototype.initView=function(){var t=this.param.data.data.data;this._nodeContainer=new BaseDisplayObjectContainer,this._nodeContainer.alpha=0,this.addChild(this._nodeContainer),this.touchEnabled=!1,this.addTouchTap(this.clickHandler,this);var e=BaseBitmap.create("public_9_bg25");e.width=490,e.height=130,e.x=GameConfig.stageWidth/2-245,e.y=80,this._nodeContainer.addChild(e);var i=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);i.multiline=!0,i.lineSpacing=5,i.width=e.width-40,i.x=e.x+20,i.y=e.y+20,this._nodeContainer.addChild(i);var a=BaseBitmap.create("public_numbg");a.x=e.x+330,a.y=e.y+80,this._nodeContainer.addChild(a);var n=BaseLoadBitmap.create("itemicon1");n.setScale(.5),n.x=a.x+10,n.y=a.y+a.height/2-n.height/2-25,this._nodeContainer.addChild(n),this._rewardStr="1_0_"+t.gem;var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);o.text=String(t.gem),o.x=n.x+50,o.y=a.y+a.height/2-o.height/2,this._nodeContainer.addChild(o);var s=1,r=Api.playerVoApi.getPlayerPortrait(t.level,t.pic);r.setScale(s),r.x=GameConfig.stageWidth/2-r.width/2*s,r.y=GameConfig.stageHeigth-r.height*s;var l=GameConfig.stageHeigth-a.y-a.height;if(r.y=a.y+a.height+(l-r.height*s)/2,this._nodeContainer.addChild(r),""!=t.title){var h=BaseLoadBitmap.create("user_title_"+t.title+"_2");h.x=GameConfig.stageWidth-120,h.y=r.y+30,this._nodeContainer.addChild(h)}if(Number(t.vip)>0){var d=BaseLoadBitmap.create(Api.vipVoApi.getVipCfgByLevel(t.vip).icon);d.x=GameConfig.stageWidth/2-40,d.y=GameConfig.stageHeigth-150,this._nodeContainer.addChild(d)}var g=BaseBitmap.create("rank_display_namebg");g.x=GameConfig.stageWidth/2-g.width/2,g.y=GameConfig.stageHeigth-110,this._nodeContainer.addChild(g);var c=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_WHITE);c.text=t.name,c.x=GameConfig.stageWidth/2-c.width/2,c.y=g.y+g.height/2-c.height/2,this._nodeContainer.addChild(c);var p=this;egret.Tween.get(this._nodeContainer,{loop:!1}).to({alpha:1},700).call(function(){var t=App.MathUtil.getRandom(1,11),e=LanguageManager.getlocal("rankDialogue"+t);p.typerEffect(i,e),p.touchEnabled=!1})},e.prototype.typerEffect=function(t,e,i,a){void 0===e&&(e=""),void 0===i&&(i=200),void 0===a&&(a=null);for(var n=e.split(""),o=n.length,s=0;o>s;s++)egret.setTimeout(function(){t.appendText(n[Number(this)]),Number(this)>=o-1&&null!=a&&a()},s,i*s)},e.prototype.clickHandler=function(){if(0==this._clickNum){var t=GameData.formatRewardItem(this._rewardStr);App.CommonUtil.playRewardFlyAction(t)}else 1==this._clickNum&&(this._hideSt=egret.setTimeout(this.hideSelf,this,500));this._clickNum++},e.prototype.hideSelf=function(){egret.clearTimeout(this._hideSt),t.prototype.hide.call(this)},e.prototype.dispose=function(){this._nodeContainer=null,this._clickNum=0,this._hideSt=null,this._rewardStr="",t.prototype.dispose.call(this)},e}(BaseView);__reflect(RankWorshipView.prototype,"RankWorshipView");var RechargeVipView=function(t){function e(){var e=t.call(this)||this;return e._greenarrow=null,e._currMaxVip=0,e.public_dot2=null,e}return __extends(e,t),e.prototype.getTabbarGroupY=function(){return 40},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["recharge_fnt","rechargeview_greenarrow","rechargevie_topbar","common_left_bg","common_9_bg","rechargevie_close","rechargevie_down","rechargevie_open","achievement_state3","servant_topresbg","rechargedoubletip2","recharge_gift_tip","progress7","progress7_bg","itemeffect","rechargevie_btn","rechargevie_btn_down","rechargevie_receivebtn_down","rechargevie_receivebtn","rechargevie_received","rechargevie_receiveImg","rechargevie_effects","recharge_discount_left","recharge_discount_right","btn_small_orange_down","btn_small_orange","recharge2big","recharge4","rechargelistimg","rechargetitlenewbg","recharge2_fnt","rechargetitlle","welfare_hasbuy","rechargevie_give"])},e.prototype.hideAndShowVip=function(){this.hide(),ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEWTAB2)},e.prototype.initView=function(){var t=BaseBitmap.create("public_dot2");this.addChild(t),t.x=295,t.y=this.tabbarGroup.y,this.public_dot2=t,App.MessageHelper.addEventListener(NetManager.getMessageName(NetPushConst.PUSH_PAY),this.receivePushData,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_VIP_VIPWELFARE),this.useVipCallback,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_RECHARFGE_RE,this.rechargeHandler,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_REFRESH_RECHARGE_VIEW,this.hideAndShowVip,this);var e=BaseBitmap.create("servant_topresbg");e.width=100,e.x=50,e.y=55+(App.DeviceUtil.isWXgame()?35:0),this.addChild(e);var i=BaseLoadBitmap.create("itemicon1");i.setPosition(e.x-42,e.y-20),i.setScale(.6),this.addChild(i);var a=ComponentManager.getTextField(Api.playerVoApi.getPlayerGem().toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);a.setPosition(i.x+100*i.scaleX,i.y+(100*i.scaleY-a.height)/2+5),this.addChild(a),this._gemTxt=a;var n=BaseBitmap.create("public_9_viewmask");n.width=640,n.height=30,n.setPosition(0,90),this.addChild(n),this.setChildIndex(n,this.getChildIndex(this.closeBtn)-1);var o=ComponentManager.getTextField("1",TextFieldConst.FONTSIZE_CONTENT_SMALL);o.setPosition(.5*(GameConfig.stageWidth-o.width),95),this.addChild(o),this._upTxt=o;var s=ComponentManager.getProgressBar("progress7","progress7_bg",316);s.setPosition(160+.5*(GameConfig.stageWidth-s.width),o.y+o.height+40),this.addChild(s),this._progressBar=s;var r=null;if(0!=Api.vipVoApi.getCurLevelVipCfg().level){var l=Api.vipVoApi.getCurLevelVipCfg().icon;r=BaseLoadBitmap.create(l),r.setPosition(380,s.y-29),this.addChild(r),r.bindData=l,this._leftVip=r,this._greenarrow=BaseBitmap.create("rechargeview_greenarrow"),this._greenarrow.setPosition(this._leftVip.x+this._leftVip.width+80,this._leftVip.y+5),this.addChild(this._greenarrow);var h=Api.vipVoApi.getVipCfgByLevel(Api.playerVoApi.getPlayerNextVipLevel()).icon,d=BaseLoadBitmap.create(h);d.setPosition(this._leftVip.x+110,this._leftVip.y),this.addChild(d),d.bindData=h,this._rightVip=d}else{r=BaseLoadBitmap.create(""),r.setPosition(380,s.y-32),this.addChild(r),this._leftVip=r,this._greenarrow?this._greenarrow.setPosition(430,s.y-27):(this._greenarrow=BaseBitmap.create("rechargeview_greenarrow"),this._greenarrow.setPosition(420,s.y-27),this.addChild(this._greenarrow)),this._greenarrow.visible=!1;var d=BaseLoadBitmap.create(Api.vipVoApi.getVipCfgByLevel(Api.playerVoApi.getPlayerNextVipLevel()).icon);d.bindData=h,this.addChild(d),this._rightVip=d}var g=BaseLoadBitmap.create("rechargevie_topbar");g.setPosition(0,this._progressBar.y+30),this.addChild(g),this.refresh()},e.prototype.rechargeHandler=function(){var t=[];t.index=0,this.clickTabbarHandler(t),this.tabbarGroup.selectedIndex=t.index},e.prototype.refresh=function(){if(this.public_dot2.visible=Api.vipVoApi.getReddot(),this._currMaxVip=Api.playerVoApi.getPlayerMaxVip(),this._progressBar){var t=Api.vipVoApi.getNextVipNeedGemNum(),e=Api.vipVoApi.getNextVipLvNeedRechargeGemNum(),i=t-e,a=Math.min(Config.VipCfg.getMaxLevel(),Api.playerVoApi.getPlayerVipLevel()+1);if(Api.playerVoApi.getPlayerVipLevel()==this._currMaxVip?(this._upTxt.text=LanguageManager.getlocal("rechargeRecahVipMaxDesc"),this._progressBar.setPercentage(1,t+"/"+t)):(this._upTxt.text=LanguageManager.getlocal("rechargeRecahVipDesc",[e.toString(),a.toString(),Api.playerVoApi.getPlayerVipLevel()+""]),this._progressBar.setPercentage(i/t,i+"/"+t)),this._upTxt.setPosition(.5*(GameConfig.stageWidth-this._upTxt.width),95),this._gemTxt&&(this._gemTxt.text=Api.playerVoApi.getPlayerGem().toString()),0!=Api.vipVoApi.getCurLevelVipCfg().level&&Api.playerVoApi.getPlayerVipLevel()!=this._currMaxVip){var n=Api.vipVoApi.getCurLevelVipCfg().icon;this._greenarrow.visible=!0,this._leftVip.bindData!=n&&(this._leftVip.setload(n),this._leftVip.bindData=n),this._greenarrow&&this._greenarrow.setPosition(460,this._leftVip.y+5);var o=Api.vipVoApi.getVipCfgByLevel(Api.playerVoApi.getPlayerNextVipLevel()).icon;this._rightVip&&(this._rightVip.bindData==o?this._rightVip.setPosition(this._leftVip.x+110,this._leftVip.y):(this._rightVip.setload(o),this._rightVip.bindData=o),this._rightVip.setPosition(this._leftVip.x+110,this._leftVip.y))}else Api.playerVoApi.getPlayerVipLevel()==this._currMaxVip?(this._leftVip.visible=!1,this._greenarrow.visible=!1,this._rightVip.setPosition(this._leftVip.x+60,this._leftVip.y+3)):this._rightVip.setPosition(this._leftVip.x+60,this._leftVip.y+3)}},e.prototype.receivePushData=function(t){var e=t.data;e.data.cmd==NetPushConst.PUSH_PAY&&this.refresh()},e.prototype.useVipCallback=function(t){t.data.ret&&(this.public_dot2.visible=Api.vipVoApi.getReddot())},e.prototype.getTabbarTextArr=function(){return["rechargeVipViewTitle","vipBtn"]},e.prototype.tick=function(){this.getSelectedTab()&&this.getSelectedTab().tick&&this.getSelectedTab().tick.call(this.getSelectedTab())},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_VIP_VIPWELFARE),this.useVipCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetPushConst.PUSH_PAY),this.receivePushData,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_RECHARFGE_RE,this.rechargeHandler,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_REFRESH_RECHARGE_VIEW,this.hideAndShowVip,this),this._progressBar=null,this._rightVip=null,this._upTxt=null,this._gemTxt=null,this._leftVip=null,this._greenarrow=null,this._currMaxVip=0,this.public_dot2=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(RechargeVipView.prototype,"RechargeVipView");var RechargeVipViewScrollltem=function(t){function e(){var e=t.call(this)||this;return e.collectBtn=null,e._data=null,e._recharge2=null,e._recharge4=null,e._iconBg=null,e._functionBg=null,e._multiple=0,e._fourStr=null,e._msgTF=null,e._fourContainer=null,e._twoContainer=null,e._two2Container=null,e._gtContainer=null,e._acerTxt=null,e._acerImg=null,e._currId=0,e.isnewThanksgiving=!1,App.MessageHelper.addNetMessage(NetPushConst.PUSH_PAY,e.receivePushData,e),e}return __extends(e,t),e.prototype.initItem=function(t,e){this._data=e;var i=null;i=BaseBitmap.create("rechargelistimg"),this.addChild(i),this._functionBg=i;var a=null;if(this.checkIsBigMonthYearCard()){var n=9==e.sortId?2:6;a=BaseLoadBitmap.create("recharge_new_itemicon"+n)}else a=BaseLoadBitmap.create("recharge_new_itemicon"+e.sortId);a.x=i.x+25,a.y=i.y+5,this.addChild(a),this._iconBg=a;var o=LanguageManager.getlocal("rechargeAcerdes"),s=ComponentManager.getBitmapText((e.gemCost?e.gemCost:e.firstGet)+o,"recharge2_fnt");s.y=i.y+15,s.x=i.x+180,this.addChild(s),this._acerImg=s;var r=Api.rechargeVoApi.checkFirstRecharge(),l=Api.switchVoApi.checknewRecharge(),h=LanguageManager.getlocal("rechargeAcerdes"),d=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);if(d.text=String(e.gemCost+h),d.x=i.x+180,d.y=this._acerImg.y+60,this.addChild(d),this._acerTxt=d,this.checkIsBigMonthYearCard()){var g=LanguageManager.getlocal(9==this._data.sortId?"monthcarddesc":"yearcarddesc");this._acerTxt.text=String(""+d.text+g),this._acerTxt.textAlign=egret.HorizontalAlign.LEFT}else{var c=Config.FirstchargeCfg.getneedRecharge(e.id);if(l&&0==r&&1==Api.shopVoApi.getfourRateCharge()&&c){var p=BaseBitmap.create("recharge4");p.x=i.x,p.y=i.y,this.addChild(p),this._recharge4=p,this._multiple=4,this.isnewThanksgiving=!0}else if(l&&r&&c){this.isnewThanksgiving=!1;var p=BaseBitmap.create("recharge4");p.x=i.x,p.y=i.y,this.addChild(p),this._recharge4=p,this._multiple=4}else if(Api.shopVoApi.getPayInfoById(e.id))e.secondGet?this._multiple=e.secondGet:this._multiple=0;else{var _=BaseBitmap.create("recharge2big");_.x=i.x,_.y=i.y,this.addChild(_),this._recharge2=_,this._multiple=2}if(l&&0==r&&1==Api.shopVoApi.getfourRateCharge()&&c)this.showFourTxt();else if(l&&r&&c)this.showFourTxt();else if(Api.shopVoApi.getPayInfoById(e.id))e.secondGet&&this.showGT();else{this._twoContainer=new BaseDisplayObjectContainer,this.addChild(this._twoContainer);var u=BaseBitmap.create("rechargevie_give");u.x=d.x+d.width+5,u.y=d.y-10,this._twoContainer.addChild(u);var h=LanguageManager.getlocal("rechargeAcerdes"),C=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);C.text=String(e.firstGet+h),C.x=u.x+u.width+10,C.y=this._acerImg.y+60,this._twoContainer.addChild(C)}}var f=ComponentManager.getButton("btn_small_orange","",this.eventCollectHandler,this);f.x=i.width-f.width-10,f.y=i.y+.5*f.height+10;var m=LanguageManager.getlocal("elementStr");if(PlatformManager.checkIsTWBSp()){var T=PlatformManager.getMoneySign();f.setText(T+e.cost,!1)}else if(PlatformManager.checkIsKRSp()){var T=PlatformManager.getMoneySign();App.DeviceUtil.isAndroid()?f.setText(e.cost+m,!1):f.setText(T+e.cost,!1)}else f.setText(e.cost+m,!1);if(this.addChild(f),this.collectBtn=f,this.checkIsBigMonthYearCard()){var y=Api.shopVoApi.ifBuyMonthCard(),v=Api.shopVoApi.ifBuyYearCard();(y&&9==this._data.sortId||v&&10==this._data.sortId)&&this.hideBuyBtn()}},e.prototype.hideBuyBtn=function(){if(this.collectBtn.visible){this.collectBtn.visible=!1;var t=BaseBitmap.create("welfare_hasbuy");t.x=this.collectBtn.x+this.collectBtn.width/2-t.width/2,t.y=this.collectBtn.y+this.collectBtn.height/2-t.height/2,this.addChild(t)}},e.prototype.receivePushData=function(t){var e=t.data;if(e.data.cmd==NetPushConst.PUSH_PAY){if(this._data.id!=this._currId&&!this._recharge4)return;if(this.checkIsBigMonthYearCard()){var i=Api.shopVoApi.ifBuyMonthCard(),a=Api.shopVoApi.ifBuyYearCard();(i&&9==this._data.sortId||a&&10==this._data.sortId)&&this.hideBuyBtn()}var n=Api.rechargeVoApi.checkFirstRecharge(),o=Api.switchVoApi.checknewRecharge();if(1==this.isnewThanksgiving)return o&&0==Api.shopVoApi.getfourRateCharge()?(this.updata4(),this.updata2(),this.updata1(),void 0):void this.updata1();0==n&&(this.updata4(),this.updata2()),e.data.data.payment&&this.updata1()}},e.prototype.updata4=function(){this._recharge4&&(this._recharge4.visible=!1,this._fourContainer?(this._fourContainer.visible=!1,this._multiple=0):this._data.secondGet&&(this.showGT(),this._multiple=this._data.secondGet))},e.prototype.updata1=function(){Api.shopVoApi.getPayInfoById(this._data.id)&&this._recharge2&&(this._recharge2.visible=!1,this._data.secondGet?(this.showGT(),this._multiple=this._data.secondGet):this._multiple=0,this._twoContainer&&(this._twoContainer.visible=!1),this._two2Container&&(this._two2Container.visible=!1))},e.prototype.updata2=function(){if(!Api.shopVoApi.getPayInfoById(this._data.id))if(this._recharge2)this._multiple=2;else{var t=this._functionBg,e=BaseBitmap.create("recharge2big");e.x=t.x,e.y=t.y,this.addChild(e),this._recharge2=e,this._two2Container=new BaseDisplayObjectContainer,this.addChild(this._two2Container);var i=this._acerTxt,a=BaseBitmap.create("rechargevie_give");a.x=i.x+i.width+5,a.y=i.y-10,this._two2Container.addChild(a);var n=LanguageManager.getlocal("rechargeAcerdes"),o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);o.text=String(this._data.firstGet+n),o.x=a.x+a.width+10,o.y=this._acerTxt.y,this._two2Container.addChild(o),this._multiple=2}},e.prototype.showGT=function(){if(this._data.secondGet){this._gtContainer&&this.removeChild(this._gtContainer),this._gtContainer=null,null==this._gtContainer&&(this._gtContainer=new BaseDisplayObjectContainer,this.addChild(this._gtContainer));var t=BaseBitmap.create("rechargevie_give");t.x=this._acerTxt.x+this._acerTxt.width+5,t.y=this._acerTxt.y-10,this._gtContainer.addChild(t);var e=LanguageManager.getlocal("rechargeAcerdes"),i=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);i.text=String(this._data.secondGet+e),i.x=t.x+t.width+10,i.y=this._acerImg.y+60,this._gtContainer.addChild(i)}},e.prototype.showFourTxt=function(){this._fourContainer=null,null==this._fourContainer&&(this._fourContainer=new BaseDisplayObjectContainer,this.addChild(this._fourContainer));var t=LanguageManager.getlocal("rechargeAcerdes");this._fourStr=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_RED),this._fourStr.text=LanguageManager.getlocal("rechargef"),this._fourStr.x=this._acerImg.x+this._acerImg.width+10,this._fourStr.y=this._functionBg.y+20,this._fourContainer.addChild(this._fourStr);var e=BaseBitmap.create("rechargevie_give");e.x=this._acerTxt.x+this._acerTxt.width+5,e.y=this._acerTxt.y-10,this._fourContainer.addChild(e);var i=3,a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);a.text=String(this._data.gemCost*i+t),a.x=e.x+e.width+10,a.y=this._acerImg.y+60,this._fourContainer.addChild(a)},e.prototype.eventCollectHandler=function(t){this._currId=this._data.id,e.MULTIPLE=this._multiple,PlatformManager.pay(this._data.id)},e.prototype.checkIsBigMonthYearCard=function(){var t=this._data;return PlatformManager.checkIsShenHeYiWan()&&(9==t.sortId||10==t.sortId)},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(NetPushConst.PUSH_PAY,this.receivePushData,this),this._fourContainer=null,this._twoContainer=null,this._two2Container=null,this._data=null,this._recharge2=null,this._recharge4=null,this._iconBg=null,this._functionBg=null,this._multiple=0,e.MULTIPLE=0,this._fourStr=null,this._msgTF=null,this._acerTxt=null,this._acerImg=null,this._currId=0,this._gtContainer=null,this.isnewThanksgiving=!1,this.collectBtn=null,t.prototype.dispose.call(this)},e.MULTIPLE=0,e}(ScrollListItem);__reflect(RechargeVipViewScrollltem.prototype,"RechargeVipViewScrollltem");var RechargeVipViewTab1=function(t){function e(){var e=t.call(this)||this;return e._rechargetitlle=null,e.initView(),e}return __extends(e,t),e.prototype.getListType=function(){return 1},e.prototype.initView=function(){App.MessageHelper.addNetMessage(NetPushConst.PUSH_PAY,this.receivePushData,this);var t=BaseBitmap.create("rechargetitlenewbg");this.addChild(t),t.y=-30;var e=Api.rechargeVoApi.checkFirstRecharge(),i=Api.switchVoApi.checknewRecharge();if(i&&0==e&&1==Api.shopVoApi.getfourRateCharge()){var a=BaseBitmap.create("rechargetitlle");a.x=640-a.width,a.y=t.height-2*a.height,this.addChild(a),this._rechargetitlle=a}else if(i&&e){var a=BaseBitmap.create("rechargetitlle");a.x=640-a.width,a.y=t.height-2*a.height,this.addChild(a),this._rechargetitlle=a}var n=Config.RechargeCfg.getNormalRechargeCfg();n.length;n=this.sortArr(n);var o=egret.Rectangle.create();o.setTo(0,0,640,GameConfig.stageHeigth-380),this._scrollList=ComponentManager.getScrollList(RechargeVipViewScrollltem,n,o),this.addChild(this._scrollList),this._scrollList.setPosition(10,150)},e.prototype.sortArr=function(t){void 0===t&&(t=null);for(var e=Api.rechargeVoApi.checkFirstRecharge(),i=Api.switchVoApi.checknewRecharge(),a=t,n=[],o=[],s=0;s<a.length;s++){var r=Config.FirstchargeCfg.getneedRecharge(a[s].id);i&&0==e&&1==Api.shopVoApi.getfourRateCharge()&&r?n.push(a[s]):i&&e&&r?n.push(a[s]):o.push(a[s])}return a=[],a=n.concat(o)},e.prototype.receivePushData=function(t){var e=t.data;if(e.data.cmd==NetPushConst.PUSH_PAY&&e.data.data.payment){var i=Api.rechargeVoApi.checkFirstRecharge();!i&&this._rechargetitlle&&(this._rechargetitlle.visible=!1);var a=e.data.data.payment.itemId,n="";if(0!=RechargeVipViewScrollltem.MULTIPLE)if(RechargeVipViewScrollltem.MULTIPLE>4){var o=Number(e.data.data.payment.num+RechargeVipViewScrollltem.MULTIPLE);App.CommonUtil.showTip(o+LanguageManager.getlocal("itemName_1")+n)}else n="x"+RechargeVipViewScrollltem.MULTIPLE,App.CommonUtil.showTip(e.data.data.payment.num+LanguageManager.getlocal("itemName_1")+n);else App.CommonUtil.showTip(e.data.data.payment.num+LanguageManager.getlocal("itemName_1")+n);PlatformManager.analyticsPay(a,e.data.data.payment.orderId)}},e.prototype.dispose=function(){this._scrollList=null,this._rechargetitlle=null,App.MessageHelper.removeNetMessage(NetPushConst.PUSH_PAY,this.receivePushData,this)},e}(CommonViewTab);__reflect(RechargeVipViewTab1.prototype,"RechargeVipViewTab1");var RechargeVipViewTab2=function(t){function e(){var e=t.call(this)||this;return e._receiveItemBtn=null,e._curShowVipLevel=-1,e._vipBtnList=[],e.currLevel=-1,e.isTouch=!1,e.newCurrIndex=-1,e.nextVipCfg=null,e.titleTxt=null,e.txt=null,e.downBg=null,e.upBg=null,e.boo=!1,e.currCountainer=null,e.groupArr=[],e.scrollView=null,e._receiveItemBtnType=0,e.receiveImg=null,e.rechargevie_effects=null,e._light=null,e._light2=null,e._slideCountainer=null,e._scrollRect1=null,e._vipNum="1_privilege",e._vip1Boo=!1,e._openDialogDiscountEnabled=!1,e.initView(),e}return __extends(e,t),e.prototype.refreshWhenSwitchBack=function(){var t=Api.playerVoApi.getPlayerVipLevel();this.currLevel=t,e.lastVipLevel!=t&&(e.currNum=-1,e.lastVipLevel=t,this.showBtn(),this.refresh(),this.newCurrIndex=Api.playerVoApi.getPlayerVipLevel(),this.refreshView(),this._vip1Boo&&1==e.lastVipLevel?this.upBg.setload("vip_details_"+this._vipNum):this.upBg.setload("vip_details_"+e.lastVipLevel),this.showItemList())},e.prototype.refresh=function(){this.currLevel=Api.playerVoApi.getPlayerVipLevel(),-1==this.newCurrIndex&&(this.newCurrIndex=this.currLevel)},e.prototype.initView=function(){this._vip1Boo=Api.switchVoApi.checkVip1Privilege(),this._slideCountainer=new BaseDisplayObjectContainer,this._slideCountainer.y=30,this.addChild(this._slideCountainer),e.lastVipLevel=Api.playerVoApi.getPlayerVipLevel(),this.refresh(),this.refreshView();var t=BaseBitmap.create("common_left_bg");t.x=0,t.y=-30,t.height=GameConfig.stageHeigth-200,this.addChild(t);var i=egret.Rectangle.create();i.setTo(0,0,492,549),0==this.currLevel&&(this.currLevel=1),this._vip1Boo&&1==this.currLevel?this.upBg=BaseLoadBitmap.create("vip_details_"+this._vipNum,i):this.upBg=BaseLoadBitmap.create("vip_details_"+this.currLevel,i),this.upBg.x=0,this._slideCountainer.addChild(this.upBg),this.upBg.y=-30;var a=BaseBitmap.create("common_9_bg");a.width=400,a.setPosition(this.upBg.x,this.upBg.y+this.upBg.height),this._slideCountainer.addChild(a);var n=BaseBitmap.create("public_line3");if(n.width=a.width-60,n.setPosition(a.x+(a.width-n.width)/2,a.y+32),this._slideCountainer.addChild(n),-1==e.currNum)var o=this.currLevel+"";else var o=(e.currNum+1).toString();var s=ComponentManager.getTextField(LanguageManager.getlocal("wifeUnlock_3",[o]),TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_BLACK),r=App.CommonUtil.getCenterPos(n,s,!1);s.setPosition(r.x,r.y),this._slideCountainer.addChild(s),this.titleTxt=s;var l=ComponentManager.getTextField(this.nextVipCfg.localStr,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);l.width=400,l.lineSpacing=5,l.y=580,l.x=30,l.cacheAsBitmap=!0,this._slideCountainer.addChild(l),this.txt=l,a.height=500;var h=new egret.Rectangle(0,0,800,GameConfig.stageHeigth-190);if(null==this.scrollView&&(this.scrollView=ComponentManager.getScrollView(this._slideCountainer,h),this.scrollView.x=150,this.scrollView.y=-30,this.addChild(this.scrollView)),Api.vipVoApi.getVipCfgByLevel(this.newCurrIndex).reward)this.showItemList();else{this._receiveItemBtn=BaseBitmap.create("rechargevie_btn"),this._receiveItemBtn.addTouchTap(this.itemHandler,this),this._slideCountainer.addChild(this._receiveItemBtn),this._receiveItemBtn.setPosition(385,410);new egret.Point(this._receiveItemBtn.x,this._receiveItemBtn.y)}if(this.showBtn(),Api.acVoApi.getActivityVoByAidAndCode("discount","1")&&Api.acVoApi.getActivityVoByAidAndCode("discount","1").isStart){var d=BaseBitmap.create("recharge_discount_right");d.x=414,d.y=526,this._slideCountainer.addChild(d);var g=new egret.Shape;g.graphics.lineStyle(2,16711680,1),g.graphics.moveTo(0,0),g.graphics.lineTo(255,0),g.graphics.endFill(),g.x=this.txt.x,g.y=this.txt.y+10,this._slideCountainer.addChild(g),this._openDialogDiscountEnabled=!0}else this._openDialogDiscountEnabled=!1},e.prototype.showItemList=function(){this.clearIconArr(),0==this._vip1Boo&&1==this.newCurrIndex&&(this.nextVipCfg.reward="");var t=GameData.getRewardItemIcons(this.nextVipCfg.reward,!0,!0);if(t&&t.length>0){for(var e,i=10,a=421,n=t.length,o=0;n>o;o++){var s=t[o];s.scaleX=.78,s.scaleY=.78,s.setPosition(i+o*(s.width*s.scaleX+12),a),this._slideCountainer.addChild(s),this.groupArr.push(s),e=s}if(this._receiveItemBtn=BaseBitmap.create("rechargevie_btn"),this._receiveItemBtn.addTouchTap(this.itemHandler,this),this._receiveItemBtn.anchorOffsetX=this._receiveItemBtn.width/2,this._receiveItemBtn.anchorOffsetY=this._receiveItemBtn.height/2,this._slideCountainer.addChild(this._receiveItemBtn),this._receiveItemBtn.visible=!1,this._receiveItemBtn.setPosition(385,410),null==this.rechargevie_effects){this.rechargevie_effects=BaseBitmap.create("rechargevie_effects"),this.rechargevie_effects.addTouchTap(this.itemHandler,this),this._slideCountainer.addChild(this.rechargevie_effects),this.rechargevie_effects.anchorOffsetX=this.rechargevie_effects.width/2,this.rechargevie_effects.anchorOffsetY=this.rechargevie_effects.height/2,this.rechargevie_effects.setPosition(440,460);var r=this._slideCountainer.getChildIndex(this._receiveItemBtn);this._slideCountainer.setChildIndex(this.rechargevie_effects,r),this.rechargevie_effects.touchEnabled=!1,this.rechargevie_effects.visible=!1}this.receiveImg=BaseBitmap.create("rechargevie_receiveImg"),this._slideCountainer.addChild(this.receiveImg),this.receiveImg.x=400,this.receiveImg.y=480,this.receiveImg.touchEnabled=!1,this.receiveImg.visible=!1,this.showReceive()
}else if(null==this._receiveItemBtn){this._receiveItemBtnType=0,this._receiveItemBtn=BaseBitmap.create("rechargevie_btn"),this._receiveItemBtn.addTouchTap(this.itemHandler,this),this._slideCountainer.addChild(this._receiveItemBtn),this._receiveItemBtn.setPosition(390,410);new egret.Point(this._receiveItemBtn.x,this._receiveItemBtn.y)}},e.prototype.clearIconArr=function(){for(var t=this.groupArr.length-1;t>=0;t--){var e=this.groupArr[t];e&&e.parent&&(e instanceof BaseDisplayObjectContainer?e.dispose():BaseBitmap.release(e),this.groupArr.pop())}this.rechargevie_effects&&(egret.Tween.removeTweens(this.rechargevie_effects),BaseBitmap.release(this.rechargevie_effects),this.rechargevie_effects=null),this.receiveImg&&(BaseBitmap.release(this.receiveImg),this.receiveImg=null),this._receiveItemBtn&&(BaseBitmap.release(this._receiveItemBtn),this._receiveItemBtn=null)},e.prototype.showBtn=function(){this._vipBtnList=[];for(var t=Api.vipVoApi.getMaxbtnNum(),i=0;t>i;i++)this._vipBtnList.push(i);var a=egret.Rectangle.create();if(a.setTo(0,0,180,GameConfig.stageHeigth-200),this._scrollList=ComponentManager.getScrollList(VipBtnScrollItem,this._vipBtnList,a),this.addChild(this._scrollList),this._scrollList.setPosition(0,-30),this._scrollList.addTouchTap(this.clickItemHandler,this),-1!=e.currNum){var n=this._scrollList.getItemByIndex(e.currNum);n.setType()}else if(0==this.currLevel){var n=this._scrollList.getItemByIndex(this.currLevel);n.setType()}else{e.currNum=this.currLevel-1;var n=this._scrollList.getItemByIndex(this.currLevel-1);n.setType()}},e.prototype.clickItemHandler=function(t){this.scrollView.setScrollTop(-30);var i=e.currNum;if(e.currNum=t.data,this.newCurrIndex=t.data+1,-1!=e.currNum)if(-1!=i){var a=this._scrollList.getItemByIndex(i);a.removeBitmap()}else{var a=this._scrollList.getItemByIndex(0);a.removeBitmap()}var a=this._scrollList.getItemByIndex(t.data);a.setType(),this._vip1Boo&&1==this.newCurrIndex?this.upBg.setload("vip_details_"+this._vipNum):this.upBg.setload("vip_details_"+this.newCurrIndex),this.refresh(),this.refreshView()},e.prototype.refreshView=function(){0==this.newCurrIndex&&(this.newCurrIndex+=1),this.nextVipCfg=Api.vipVoApi.getVipCfgByLevel(this.newCurrIndex),this.titleTxt&&(this.titleTxt.text=LanguageManager.getlocal("wifeUnlock_3",[this.newCurrIndex+""])),this.txt&&(this.txt.text=this.nextVipCfg.localStr),this.showItemList()},e.prototype.itemHandler=function(){-1!=e.currNum&&1==this._receiveItemBtnType?Api.playerVoApi.getPlayerVipLevel()>=this.newCurrIndex&&(App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_VIP_VIPWELFARE),this.useVipCallback,this),NetManager.request(NetRequestConst.REQUEST_VIP_VIPWELFARE,{vip:this.newCurrIndex+""})):0==this._receiveItemBtnType&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_RECHARFGE_RE)},e.prototype.useVipCallback=function(t){if(t.data.ret){if(this._scrollList){var e=this._scrollList.getItemByIndex(this.newCurrIndex-1);e.setRedhot()}var i=new egret.Point(GameConfig.stageWidth/2,GameConfig.stageHeigth/2+100);if(App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.data.rewards),i),this.showReceive(),Api.switchVoApi.checkVip1Privilege()){var a=Api.itemVoApi.getTitleInfoVoById(4001),n=Api.itemVoApi.getTitleInfoVoById(4004);(a&&a.num>0||n&&n.num>0)&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_REFRESH_SPECIAL_AVATAR)}}},e.prototype.removeLightEffect=function(){if(this._light){if(this._light.mask){var t=this._light.mask;t&&BaseBitmap.release(t)}BaseBitmap.release(this._light),this._light=null}},e.prototype.showReceive=function(){if(Api.shopVoApi.getVipRewardInfo(this.newCurrIndex))this._receiveItemBtn.visible=!1,egret.Tween.removeTweens(this._receiveItemBtn),this._receiveItemBtnType=2,this.receiveImg.visible=!1,this._alreadyReceived=BaseBitmap.create("rechargevie_received"),this._slideCountainer.addChild(this._alreadyReceived),this._alreadyReceived.setPosition(390,413),this.groupArr.push(this._alreadyReceived),this.rechargevie_effects&&(egret.Tween.removeTweens(this.rechargevie_effects),this.rechargevie_effects.visible=!1);else{if(!Api.vipVoApi.getVipCfgByLevel(this.newCurrIndex).reward)return void this.rechargeState();Api.playerVoApi.getPlayerVipLevel()>=this.newCurrIndex?(this.removeLightEffect(),this._receiveItemBtn.texture=ResourceManager.getRes("rechargevie_receivebtn"),this._receiveItemBtn.x=440,this._receiveItemBtn.y=470,this._receiveItemBtn.visible=!0,this._receiveItemBtnType=1,this.receiveImg.visible=!0,this.rechargevie_effects&&(this.rechargevie_effects.visible=!0,egret.Tween.get(this.rechargevie_effects,{loop:!0}).to({rotation:this.rechargevie_effects.rotation+360},1e4)),egret.Tween.get(this._receiveItemBtn,{loop:!0}).to({rotation:10},50).to({rotation:-10},100).to({rotation:10},100).to({rotation:0},50).wait(500)):this.rechargeState()}},e.prototype.rechargeState=function(){this._receiveItemBtn.texture=ResourceManager.getRes("rechargevie_btn"),this._receiveItemBtn.setPosition(440,460),this._receiveItemBtn.visible=!0;new egret.Point(385,410);this._receiveItemBtnType=0,this.receiveImg.visible=!1,egret.Tween.removeTweens(this._receiveItemBtn),this.rechargevie_effects&&(egret.Tween.removeTweens(this.rechargevie_effects),this.rechargevie_effects.visible=!1)},e.prototype.getShowVipLevel=function(){return this._curShowVipLevel<0&&(this._curShowVipLevel=Api.vipVoApi.getShowVipLevel(),this._curShowVipLevel>=Config.VipCfg.getMaxLevel()&&(this._curShowVipLevel=Config.VipCfg.getMaxLevel())),this._curShowVipLevel},e.prototype.getNextShowVipLevel=function(){var t=Math.min(Math.max(0,this.getShowVipLevel()+1),Config.VipCfg.getMaxLevel());return t},e.prototype.rechargeHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.tick=function(){var t=!1;Api.acVoApi.getActivityVoByAidAndCode("discount","1")&&Api.acVoApi.getActivityVoByAidAndCode("discount","1").isStart?this._openDialogDiscountEnabled||(t=!0):this._openDialogDiscountEnabled&&(App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEndViewRefreshed")),t=!0),t&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_RECHARGE_VIEW)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_VIP_VIPWELFARE),this.useVipCallback,this),this._receiveItemBtn=null,this._alreadyReceived=null,this._curShowVipLevel=-1,this._vipBtnList=[],this._scrollList=null,e.currNum=-1,this.newCurrIndex=-1,this.txt=null,this.titleTxt=null,this.downBg=null,this.currLevel=-1,this.nextVipCfg=null,this.upBg=null,e.lastVipLevel=0,this.boo=!1,this._receiveItemBtnType=0,this.receiveImg=null,this._slideCountainer=null,this.scrollView=null,t.prototype.dispose.call(this)},e.currNum=-1,e.lastVipLevel=0,e}(CommonViewTab);__reflect(RechargeVipViewTab2.prototype,"RechargeVipViewTab2");var VipBtnScrollItem=function(t){function e(){var e=t.call(this)||this;return e._currLevel=0,e.rechargevie_down=null,e.newIndex=0,e.leftBg=null,e.discountIcon=null,e.public_dot2=null,e.vipImg=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){this._currLevel=Api.playerVoApi.getPlayerVipLevel(),this.newIndex=t+=1,this._currLevel>=this.newIndex?this.leftBg=BaseBitmap.create("rechargevie_open"):this.leftBg=BaseBitmap.create("rechargevie_close"),this.leftBg.x=0,this.leftBg.y=0,this.addChild(this.leftBg);var i=BaseLoadBitmap.create(Api.vipVoApi.getVipCfgByLevel(this.newIndex).icon);if(this.addChild(i),i.x=this.leftBg.width/2-40,i.y=this.leftBg.height/2-12,this.vipImg=i,this.public_dot2=BaseBitmap.create("public_dot2"),Api.shopVoApi.getVipRewardInfo(this.newIndex))this.public_dot2.visible=!1;else if(Api.vipVoApi.getVipCfgByLevel(t).reward)if(Api.playerVoApi.getPlayerVipLevel()>=this.newIndex){var a=Api.switchVoApi.checkVip1Privilege();this.public_dot2.visible=!0,1==this.newIndex&&0==a&&(this.public_dot2.visible=!1)}else this.public_dot2.visible=!1;else this.public_dot2.visible=!1;this.addChild(this.public_dot2),this.public_dot2.x=110,this.public_dot2.y=25,Api.acVoApi.getActivityVoByAidAndCode("discount","1")&&Api.acVoApi.getActivityVoByAidAndCode("discount","1").isStart&&(this.discountIcon=BaseBitmap.create("recharge_discount_left"),this.discountIcon.x=0,this.discountIcon.y=0,this.addChild(this.discountIcon))},e.prototype.setRedhot=function(){this.public_dot2.visible=!1},e.prototype.setType=function(){this.rechargevie_down=BaseBitmap.create("rechargevie_down"),this.rechargevie_down.x=this.leftBg.x,this.rechargevie_down.y=this.leftBg.y,this.addChild(this.rechargevie_down),this.setChildIndex(this.rechargevie_down,this.getChildIndex(this.vipImg))},e.prototype.removeBitmap=function(){this.rechargevie_down&&(BaseBitmap.release(this.rechargevie_down),this.rechargevie_down=null)},e.prototype.getSpaceY=function(){return 1},e.prototype.dispose=function(){this.newIndex=0,this.rechargevie_down=null,this._currLevel=0,this.leftBg=null,this.public_dot2=null,this.vipImg=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(VipBtnScrollItem.prototype,"VipBtnScrollItem");var SearchBuildPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["searchbinfowifebg","progress3","progress3_bg"])},e.prototype.initView=function(){var t=Api.searchVoApi.getPersonListByBuildId(this.getBuildId()),e=egret.Rectangle.create();e.setTo(0,0,520,800);var i=ComponentManager.getScrollList(SearchBuildScrollItem,t,e);this.addChildToContainer(i),i.setPosition((this.viewBg.width-i.width)/2,15)},e.prototype.getBuildId=function(){return this.param.data},e.prototype.getTitleStr=function(){return"searchBuild"+this.getBuildId()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(PopupView);__reflect(SearchBuildPopupView.prototype,"SearchBuildPopupView");var SearchBuildScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){var i=e,a=Config.SearchCfg.getPersonItemCfgByPersonId(i.personId),n=BaseBitmap.create("public_9_bg4");n.width=520,n.height=300,this.addChild(n),this.height=n.height+this.getSpaceY(),this.width=n.width;var o=BaseBitmap.create("public_9_probiginnerbg");o.width=254,i.isShowProgress?o.height=248:o.height=248,o.setPosition(n.x+n.width-o.width-8,n.y+25),this.addChild(o);var s=o.width-10,r=BaseBitmap.create("searchbinfowifebg");r.setPosition(n.x+(o.x-n.x-r.width)/2,n.y+(n.height-r.height)/2),this.addChild(r);var l=BaseLoadBitmap.create(a.personFullIcon),h=a.fullIconSize;l.width=h.width,l.height=h.height,l.setScale(210/l.width),l.setPosition(20,n.y+n.height-l.height*l.scaleY-10),this.addChild(l),1==i.type&&(l.setScale(245/l.width),l.setPosition(15,n.y+n.height-l.height*l.scaleY-10));var d=ComponentManager.getTextField(a.name,TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_WARN_YELLOW);d.width=s,d.setPosition(o.x+8,o.y+8),this.addChild(d);var g=ComponentManager.getTextField(a.shortDesc,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_YELLOW);g.width=s,g.setPosition(d.x,d.y+d.height+5),this.addChild(g);var c=ComponentManager.getTextField(a.desc,TextFieldConst.FONTSIZE_CONTENT_SMALL);c.width=s,c.setPosition(g.x,g.y+g.height+20),this.addChild(c);var p=ComponentManager.getTextField(i.eventDesc,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN);p.width=s,p.setPosition(c.x,o.y+o.height-p.height-10),this.addChild(p);var _=BaseBitmap.create("public_searchmask");_.width=255,_.setPosition(10,n.y+n.height-_.height-5),this.addChild(_)},e.prototype.getSpaceX=function(){return 0},e.prototype.getSpaceY=function(){return 10},e}(ScrollListItem);__reflect(SearchBuildScrollItem.prototype,"SearchBuildScrollItem");var SearchLuckPopupView=function(t){function e(){var e=t.call(this)||this;return e._itemList=[],e._lastDonateIndex=-1,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["progress3"])},e.prototype.initView=function(){for(var t=[ItemEnums.gold,ItemEnums.food,ItemEnums.gem],e=0;3>e;e++){var i=ComponentManager.getResBar(t[e],!0,175);i.setPosition(20+e*(i.width+5),5),this.addChildToContainer(i)}var a=BaseBitmap.create("public_9_probiginnerbg");a.width=this.viewBg.width-40,a.height=151,a.setPosition((this.viewBg.width-a.width)/2,55),this.addChildToContainer(a);var n=BaseBitmap.create("searchluckicon");n.setPosition(a.x+5,a.y+(a.height-n.height)/2),this.addChildToContainer(n);var o=BaseBitmap.create("searchluckiconbg");o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,egret.Tween.get(o,{loop:!0}).to({rotation:360},8e3),o.setPosition(n.x+n.width/2-.5,n.y+n.height/2-3),this.addChildToContainer(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("searchLuckcurNum")+Api.searchVoApi.getCurLuckNum(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);s.setPosition(n.x+n.width+10,n.y+20),this.addChildToContainer(s),this._curTxt=s;var r=ComponentManager.getProgressBar("progress3","progress3_bg",300);r.setPosition(s.x,s.y+s.height+10),this.addChildToContainer(r);var l=Api.searchVoApi.getCurLuckNum()/Api.searchVoApi.getMaxLuckNum();r.setPercentage(l),this._luckProgress=r;var h=ComponentManager.getTextField(LanguageManager.getlocal("searchLuckDesc"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN);h.setPosition(s.x,r.y+r.height+20),this.addChildToContainer(h);var d=BaseBitmap.create("public_9_probiginnerbg");d.width=a.width,d.height=105,d.setPosition(a.x,a.y+a.height+5),this.addChildToContainer(d);var g=ComponentManager.getTextField(LanguageManager.getlocal("searchLuckAutoDonate"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);g.lineSpacing=2,g.width=TextFieldConst.FONTSIZE_CONTENT_SMALL+4,g.setPosition(d.x+15,d.y+(d.height-g.height)/2),this.addChildToContainer(g);var c=ComponentManager.getTextField(LanguageManager.getlocal("searchLuckSetNumDesc"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),p=BaseBitmap.create("public_9_bg5");p.width=100,p.setPosition(120,d.y+d.height-p.height-20),this.addChildToContainer(p),this._curShowNum||(this._curShowNum=Api.searchVoApi.getAutosetValue());var _=ComponentManager.getTextField(String(this._curShowNum),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_WHITE);_.textAlign=egret.HorizontalAlign.CENTER,_.setPosition(p.x+(p.width-_.width)/2,p.y+(p.height-_.height)/2),_.name="numTxt",this.addChildToContainer(_),this._numTxt=_,c.setPosition(p.x+(p.width-c.width)/2,p.y-c.height-5),this.addChildToContainer(c);var u=ComponentManager.getButton("button_del1","",this.checkNumBtnHandler,this,[-1]);u.setPosition(p.x-u.width-8,p.y+(p.height-u.height)/2),this.addChildToContainer(u);var C=ComponentManager.getButton("button_add1","",this.checkNumBtnHandler,this,[1]);C.setPosition(p.x+p.width+8,u.y),this.addChildToContainer(C);var f=ComponentManager.getCheckBox();f.setPosition(C.x+C.width+40,d.y+10),this.addChildToContainer(f),f.setSelected(Boolean(Api.searchVoApi.getGoldOpen())),this._goldCheckBox=f;var m=ComponentManager.getTextField(LanguageManager.getlocal("searchLuckAutoDonateFood"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);m.setPosition(f.x+f.width+5,f.y+(f.height-m.height)/2),this.addChildToContainer(m);var T=ComponentManager.getCheckBox();T.setPosition(f.x,f.y+f.height+10),this.addChildToContainer(T),T.setSelected(Boolean(Api.searchVoApi.getFoodOpen())),this._foodCheckBox=T;var y=ComponentManager.getTextField(LanguageManager.getlocal("searchLuckAutoDonateGold"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);y.setPosition(m.x,T.y+(T.height-y.height)/2),this.addChildToContainer(y);var v=Config.VipCfg.getVipCfgByLevel(Api.playerVoApi.getPlayerVipLevel()).searchLuckFreeLocalStr,A=ComponentManager.getTextField(v,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);A.setPosition(d.x+d.width-A.width,d.y+d.height+5),this.addChildToContainer(A);var w=BaseBitmap.create("public_9_probiginnerbg");w.width=a.width,w.height=406,w.setPosition(a.x,A.y+A.height+5),this.addChildToContainer(w);for(var x=Api.searchVoApi.getDonateTypes(),I=x.length,L=0,e=0;I>e;e++){var E=new SearchLuckDonateItem(e,this.donateHandler,this);E.setPosition(w.x+(w.width-E.width)/2,w.y+5+(E.height+3)*e),this.addChildToContainer(E),L+=E.height+3,this._itemList.push(E)}w.height=5+L+5},e.prototype.donateHandler=function(t){this._lastDonateIndex=t,this.request(NetRequestConst.REQUEST_SEARCH_BUY,{useflag:t+1})},e.prototype.receiveData=function(t){if(t.ret&&NetRequestConst.REQUEST_SEARCH_BUY){if(this._itemList){for(var e=this._itemList.length,i=0;e>i;i++)this._itemList[i].refresh();this._lastDonateIndex>-1&&this._itemList[this._lastDonateIndex].showRewardTip()}this._curTxt.text=LanguageManager.getlocal("searchLuckcurNum")+Api.searchVoApi.getCurLuckNum(),egret.Tween.removeTweens(this._luckProgress);var a=Api.searchVoApi.getCurLuckNum()/Api.searchVoApi.getMaxLuckNum();egret.Tween.get(this._luckProgress).to({percent:a},200)}},e.prototype.checkNumBtnHandler=function(t){if(this._numTxt){var e=Number(this._numTxt.text);e+=t,e>Config.SearchbaseCfg.resAddMax&&App.CommonUtil.showTip(LanguageManager.getlocal("searchLuckAutoMaxNumDesc",[Config.SearchbaseCfg.resAddMax.toString()])),e=Math.max(1,Math.min(Config.SearchbaseCfg.resAddMax,e)),this._numTxt.text=String(e),this._curShowNum=e}},e.prototype.getTitleStr=function(){return"searchLuck"},e.prototype.dispose=function(){if(this._curShowNum){var e=!1;Api.searchVoApi.getAutosetValue()!=this._curShowNum&&(e=!0);var i=this._foodCheckBox.checkSelected()?1:0;i!=Api.searchVoApi.getFoodOpen()&&(e=!0);var a=this._goldCheckBox.checkSelected()?1:0;a!=Api.searchVoApi.getGoldOpen()&&(e=!0),e&&this.request(NetRequestConst.REQUEST_SEARCH_SET,{luckynum:this._curShowNum,foodopen:i,goldopen:a})}this._curShowNum=0/0,this._luckProgress=null,this._itemList.length=0,this._goldCheckBox=null,this._foodCheckBox=null,this._curTxt=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(SearchLuckPopupView.prototype,"SearchLuckPopupView");var SearchLuckDonateItem=function(t){function e(e,i,a){var n=t.call(this)||this;return n._index=e,n._donateHandler=i,n._donateThisObj=a,n.init(),n}return __extends(e,t),e.prototype.init=function(){var t=BaseBitmap.create("public_9_bg14");t.width=520,t.height=128,this.addChild(t);var e=Api.searchVoApi.getDonateTypes()[this._index],i=GameData.getRewardItemIconByIdAndType(ItemEnums[e]);i.setPosition(20,t.y+(t.height-i.height)/2),this.addChild(i);var a=i.bindData,n=10,o=ComponentManager.getTextField(LanguageManager.getlocal("searchLuckDonateTypeDesc",[a.name]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);o.setPosition(i.x+i.width+5,i.y+n),this.addChild(o);var s=ComponentManager.getTextField(this.getDonateNumDesc(e),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);s.setPosition(o.x,o.y+o.height+n),this.addChild(s),this._donateNumTxt=s;var r=Config.SearchbaseCfg.resAddLuck;"gem"==e&&(r=Config.SearchbaseCfg.gemAddLuck);var l=ComponentManager.getTextField(LanguageManager.getlocal("searchLuckEffectDesc",[LanguageManager.getlocal("searchLuck")+"+"+r]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);l.setPosition(s.x,s.y+s.height+n),this.addChild(l);var h=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"searchLuckDonateBtn",this.donateHandler,this);h.setPosition(t.x+t.width-h.width-20,t.y+(t.height-h.height)/2),this.addChild(h),this._donateBtn=h},e.prototype.getDonateNumDesc=function(t){var e,i=TextFieldConst.COLOR_BLACK;t==ItemEnums[RewardItemConst.TYPE_GEM]&&Api.searchVoApi.getSearchLuckFreeNum()>0?e=LanguageManager.getlocal("sysFreeDesc"):(Api.searchVoApi.checkCostEnough(t)||(i=TextFieldConst.COLOR_WARN_RED2),e=App.StringUtil.formatStringColor(Api.searchVoApi.getDonateCost(t).toString(),i));var a=[Config.RewardCfg.getNameByTypeAndId(t),e];return LanguageManager.getlocal("searchLuckDonateNumDesc",a)},e.prototype.refresh=function(){var t=Api.searchVoApi.getDonateTypes()[this._index];this._donateNumTxt&&(this._donateNumTxt.text=this.getDonateNumDesc(t)),this._donateBtn&&t==ItemEnums[RewardItemConst.TYPE_GEM]&&this._donateBtn.setText("searchLuckDonateBtn")},e.prototype.showRewardTip=function(){var t=Api.searchVoApi.getDonateTypes()[this._index],e=Config.SearchbaseCfg.resAddLuck;"gem"==t&&(e=Config.SearchbaseCfg.gemAddLuck);var i=this.localToGlobal(this.width/2,this.height/2);App.CommonUtil.playRewardFlyAction([{tipMessage:LanguageManager.getlocal("searchLuck")+"+"+e}],i)},e.prototype.donateHandler=function(){var t=Api.searchVoApi.getDonateTypes()[this._index],e=Config.SearchbaseCfg.resAddLuck;if("gem"==t&&(e=Config.SearchbaseCfg.gemAddLuck),Api.searchVoApi.getCurLuckNum()>=Api.searchVoApi.getMaxLuckByType(t)){var i=void 0;i="gem"==t?LanguageManager.getlocal("searchLuckGemMaxDesc"):LanguageManager.getlocal("searchLuckResMaxDesc"),App.CommonUtil.showTip(i)}else if(t==ItemEnums[RewardItemConst.TYPE_GEM]&&Api.searchVoApi.getSearchLuckFreeNum()>0)this.confirmDonateHandler();else if(Api.searchVoApi.checkCostEnough(t,!0))if(t==ItemEnums[RewardItemConst.TYPE_GEM]){var a=Api.playerVoApi.getPlayerGem(),n=Api.searchVoApi.getDonateCost(t),o=LanguageManager.getlocal("useItemGemConfirmDesc",[App.StringUtil.toString(n)+Config.RewardCfg.getNameByTypeAndId(t)]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{useNum:n,confirmCallback:this.confirmDonateHandler,handler:this,icon:Config.RewardCfg.getIconByTypeAndId(t),iconBg:"itembg_1",num:a,msg:o,id:1})}else this.confirmDonateHandler()},e.prototype.confirmDonateHandler=function(){this._donateHandler&&this._donateHandler.call(this._donateThisObj,this._index)},e.prototype.dispose=function(){this._donateHandler=null,this._donateThisObj=null,this._donateNumTxt=null,this._index=0/0,this._donateBtn=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(SearchLuckDonateItem.prototype,"SearchLuckDonateItem");var SearchResultPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getResourceList=function(){var e=["progress3","progress3_bg"],i=Config.SearchCfg.getPersonItemCfgByPersonId(this.getPersonId()).build;return e.push("searchnpcbg"+i),t.prototype.getResourceList.call(this).concat(e)},e.prototype.initView=function(){var t=this.checkSpaceBuild(),e=Config.SearchCfg.getPersonItemCfgByPersonId(this.getPersonId()),i=e.build,a=BaseBitmap.create("searchnpcbg"+i);if(this.addChildToContainer(a),a.setPosition(App.CommonUtil.getCenterX(this.viewBg,a,!0),0),!t){var n=e.personFullIcon,o=BaseLoadBitmap.create(n),s=e.fullIconSize;e.wifeId?(o.setScale(340/s.width),o.setPosition((this.viewBg.width-330)/2,a.y+a.height-s.height*o.scaleY),this.checkDro(e.wifeId,o)):(o.setScale(390/s.width),o.setPosition((this.viewBg.width-360)/2,a.y+a.height-s.height*o.scaleY)),2==e.type,this.addChildToContainer(o);var r=BaseBitmap.create("public_infobg2");r.setPosition(100,30),this.addChildToContainer(r);var l=30,h=ComponentManager.getTextField(e.name,l);h.width=l+2;var d=App.CommonUtil.getCenterPos(r,h,!1);h.setPosition(d.x+4,d.y-3),this.addChildToContainer(h)}var g=BaseBitmap.create("public_9_bg20");g.width=a.width,g.height=78,g.setPosition(a.x,a.y+a.height-g.height),this.addChildToContainer(g);var c;c=t?LanguageManager.getlocal("searchBuildTalk"+t):LanguageManager.getlocal("searchPersonTalk"+this.getPersonId());var p=ComponentManager.getTextField(c,TextFieldConst.FONTSIZE_CONTENT_SMALL);if(p.width=g.width-20,p.setPosition(App.CommonUtil.getCenterX(g,p,!1),App.CommonUtil.getCenterY(g,p,!1)),this.addChildToContainer(p),e.wifeId&&e.value){for(var _=void 0,u=0;2>u;u++)_=BaseBitmap.create("public_9_bg20"),_.width=a.width,_.height=30,_.setPosition(g.x,g.y+g.height),this.addChildToContainer(_);if(!this.checkGetWife()){var C=Math.max(0,Api.searchVoApi.getWifeValueById(this.getPersonId())-1);C/e.value}}this.showRewards(),this.addTouchTap(this.removeTween,this),this.container.alpha=0;var f=this;egret.Tween.get(this.container).to({alpha:1},500).call(function(){f.removeTouchTap(),f.addTouchTap(f.hide,f)})},e.prototype.checkDro=function(t,e){var i,a=Config.WifeCfg.getWifeCfgById(t),n=this.container.getChildIndex(e);if(Api.wifeSkinVoApi.isHaveSkin(e)){var o=Api.wifeSkinVoApi.getWifeskinInfoVoById(e);if(o&&""!=o.equip){var s=Config.WifeskinCfg.getWifeCfgById(o.equip);Api.wifeVoApi.isHaveBone(s.bone+"_ske")&&(i=App.DragonBonesUtil.getLoadDragonBones(s.bone),this.container.addChildAt(i,n),e.visible=!1)}else Api.wifeVoApi.isHaveBone(a.bone+"_ske")&&(i=App.DragonBonesUtil.getLoadDragonBones(a.bone),this.container.addChildAt(i,n))}else Api.wifeVoApi.isHaveBone(a.bone+"_ske")&&(i=App.DragonBonesUtil.getLoadDragonBones(a.bone),this.container.addChildAt(i,n),e.visible=!1);i?(i.setScale(.7),i.x=e.x+180,i.y=e.y+532-120):e.visible=!0},e.prototype.removeTween=function(){this.container&&(egret.Tween.removeTweens(this.container),this.container.alpha=1),this.removeTouchTap(),this.addTouchTap(this.hide,this)},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this);var e=Api.searchVoApi.getPersonValueLocalStr(this.getPersonId()),i=this.getRewards();if(i)for(var a=i.length,n=a-1;n>=0;n--)if(!i[n].num){Config.SearchCfg.getPersonItemCfgByPersonId(this.getPersonId());e=null;break}if(e&&!this.checkGetWife()){if(Api.wifeVoApi.getWifeInfoVoById(this.getPersonId()))return;var o=new BaseDisplayObjectContainer;this.addChild(o);var s=BaseBitmap.create("public_searchdescbg");o.addChild(s);var r=ComponentManager.getTextField(e,TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_WARN_YELLOW);r.x=s.width/2-r.width/2,r.y=s.y+s.height/2-r.height/2,o.addChild(r),o.x=GameConfig.stageWidth/2-o.width/2,o.y=this.viewBg.y+this.viewBg.height+30,o.alpha=0,egret.Tween.get(o,{loop:!1}).wait(1e3).to({alpha:1},500)}},e.prototype.checkSpaceBuild=function(){var t=null,e=this.getRewards();if(e)for(var i=e.length,a=i-1;a>=0;a--)if(!e[a].num){var n=Config.SearchCfg.getPersonItemCfgByPersonId(this.getPersonId());t=n.build;break}return t},e.prototype.checkGetWife=function(){var t=this.getRewards();if(!t){var e=Config.SearchCfg.getPersonItemCfgByPersonId(this.getPersonId());if(2==e.type&&Api.searchVoApi.getWifeValueById(this.getPersonId())>=e.value&&e.wifeId)return e.wifeId}return null},e.prototype.hide=function(){var e=Api.wifeVoApi.getWaitShowWife();e&&ViewController.getInstance().openView(ViewConst.BASE.WIFEGETVIEW,{wifeIdList:e.unlockWife,servantId:e.unlockServant}),t.prototype.hide.call(this)},e.prototype.showRewards=function(){var t=this,e=t.getRewards();if(e){for(var i=e.length,a=i-1;a>=0;a--)e[a].num||e.splice(a,1);var n=egret.setTimeout(function(){e&&e.length>0&&App.CommonUtil.playRewardFlyAction(e),n&&(egret.clearTimeout(n),n=0/0)},this,300)}},e.prototype.getBgExtraHeight=function(){return 0},e.prototype.getPersonId=function(){return this.param.data.personId},e.prototype.getRewards=function(){return this.param.data.rewards?GameData.formatRewardItem(this.param.data.rewards):null},e.prototype.getTitleStr=function(){var t=Config.SearchCfg.getPersonItemCfgByPersonId(this.getPersonId()).build;return"searchBuild"+t},e.prototype.getCloseBtnName=function(){return null},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(PopupView);__reflect(SearchResultPopupView.prototype,"SearchResultPopupView");var SearchView=function(t){function e(){var e=t.call(this)||this;return e._npcList=[],e._isbgResLoaded=!1,e._isCfgInit=!1,e.buildBgCfg={},e.cheCfg=[],e.posCfg={},e.namePosCfg={},e._oneKeySearchStatus=!1,e._tipTipTimeOut=-1,e}return __extends(e,t),e.prototype.initCfg=function(){if(0==this._isCfgInit){var t=Config.SceneCfg.getSceneCfgBySceneName("searchScene");this._isCfgInit=!0,t&&(t.posCfg&&(this.posCfg=t.posCfg),t.namePosCfg&&(this.namePosCfg=t.namePosCfg),t.cheCfg&&(this.cheCfg=t.cheCfg),t.buildBgCfg&&(this.buildBgCfg=t.buildBgCfg))}},e.prototype.initView=function(){this.initCfg(),Api.rookieVoApi.checkNextStep(),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_SEARCH,this.refreshByModel,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT,this.doGuide,this),this.container.y=0;var t=105;this._sceneLayer=new BaseDisplayObjectContainer,this.addChildToContainer(this._sceneLayer);var e=new MainUITop({showName:!1});e.y=this.getTitleButtomY(),this.addChildToContainer(e);var i=BaseBitmap.create("common_buttombigbg");i.touchEnabled=!0,i.setPosition(0,GameConfig.stageHeigth-this.container.y-i.height),this.addChildToContainer(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("searchLuck")+LanguageManager.getlocal("syscolonDesc"),TextFieldConst.FONTSIZE_CONTENT_SMALL);a.setPosition(20,i.y+25),this.addChildToContainer(a);var n=ComponentManager.getProgressBar("progress3","progress3_bg",300);n.setPosition(a.x+a.width,a.y+(a.height-n.height)/2),this.addChildToContainer(n);var o=Api.searchVoApi.getCurLuckNum()/Api.searchVoApi.getMaxLuckNum();n.setPercentage(o,Api.searchVoApi.getCurLuckNum()+"/"+Api.searchVoApi.getMaxLuckNum()),this._luckProgress=n;var s=ComponentManager.getButton("button_add1","",this.openLuckView,this);s.setPosition(n.x+n.width+5,n.y+(n.height-s.height)/2),this.addChildToContainer(s);var r=ComponentManager.getTextField(Api.searchVoApi.getSearchNumLocalStr(),TextFieldConst.FONTSIZE_CONTENT_SMALL);if(r.setPosition(a.x,i.y+i.height-r.height-25),this.addChildToContainer(r),this._leftText=r,Api.searchVoApi.checkOneKey()){var l=ComponentManager.getCheckBox(LanguageManager.getlocal("searchOneKeyDesc"));l.setPosition(n.x+n.width/2+60,r.y+(r.height-l.height)/2),l.name="onekeyCheckBox",this.addChildToContainer(l),l.setSelected(this._oneKeySearchStatus),this._checkBox=l}else{var h=ComponentManager.getTextField(LanguageManager.getlocal("searchLuckUnlockDesc",[Api.searchVoApi.getOneKeyNeedVipLevel().toString()]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_GREEN);h.setPosition(n.x+n.width/2,r.y),h.name="onekeyTxt",this.addChildToContainer(h),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.checkOnekeySearchHandler,this)}var d=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,this.getTitleStr(),this.lookforHandler,this);d.setPosition(GameConfig.stageWidth-d.width-30,App.CommonUtil.getCenterY(i,d,!1)),this.addChildToContainer(d),this._searchBtn=d;var g=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"recoverLeftBtn",this.recoverLeftHandler,this);g.setPosition(d.x,d.y),this.addChildToContainer(g),this._buyBtn=g,Api.searchVoApi.getSearchNum()>0?(d.visible=!0,g.visible=!1):(d.visible=!1,g.visible=!0);var c=i.height;this._sceneLayer||(this._sceneLayer=new BaseDisplayObjectContainer);var p=egret.Rectangle.create();if(p.setTo(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-this.container.y-t-c),!this._mapLayer){this._mapLayer=BaseBitmap.create("searchbg1");var _=GameConfig.stageHeigth-this._mapLayer.height+50;_=Math.min(0,_),this._mapLayer.setPosition(0,_),this._sceneLayer.addChild(this._mapLayer)}this.initNPC(),this._sceneLayer.addTouch(this.onNPCTouchHandler,this,null,!0),this._bgResGroupName=ResourceManager.loadResources(["search_che","searchbuildbg1","searchbuildbg2","searchbuildbg3"],[],this.cheLoadCompleteHandler,null,this)},e.prototype.refreshByModel=function(){if(this._luckProgress){var t=Api.searchVoApi.getCurLuckNum()/Api.searchVoApi.getMaxLuckNum();this._luckProgress.setPercentage(t,Api.searchVoApi.getCurLuckNum()+"/"+Api.searchVoApi.getMaxLuckNum())}},e.prototype.checkOnekeySearchHandler=function(){if(Api.searchVoApi.checkOneKey()&&this.container){var t=this.container.getChildByName("onekeyTxt");if(t&&t.dispose(),!this._checkBox){var e=ComponentManager.getCheckBox(LanguageManager.getlocal("searchOneKeyDesc"));e.setPosition(this._luckProgress.x+this._luckProgress.width/2+60,this._leftText.y+(this._leftText.height-e.height)/2),e.name="onekeyCheckBox",this.addChildToContainer(e),e.setSelected(this._oneKeySearchStatus),this._checkBox=e
}App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.checkOnekeySearchHandler,this)}},e.prototype.cheLoadCompleteHandler=function(){this._isbgResLoaded=!0;var t=ComponentManager.getCustomMovieClip("search_che",6,100);this._sceneLayer.addChildAt(t,this._sceneLayer.getChildIndex(this._mapLayer)+1),t.setPosition(this._mapLayer.x+this.cheCfg[0].x,this._mapLayer.y+this.cheCfg[0].y);var e=9e3;egret.Tween.get(t,{loop:!0}).call(function(t){t.scaleX=1},this,[t]).to({x:this._mapLayer.x+this.cheCfg[1].x,y:this._mapLayer.y+this.cheCfg[1].y},e).call(function(t){t.scaleX=-1},this,[t]).to({x:this._mapLayer.x+this.cheCfg[2].x,y:this._mapLayer.y+this.cheCfg[2].y},e).wait(1e3),t.texture=ResourceManager.getRes("search_che1"),t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.play();var i=this._sceneLayer.getChildIndex(t)+1;for(var a in this.buildBgCfg){var n=BaseLoadBitmap.create("searchbuildbg"+a);n.setPosition(this._mapLayer.x+this.buildBgCfg[a].x,this._mapLayer.y+this.buildBgCfg[a].y),this._sceneLayer.addChildAt(n,i)}},e.prototype.initNPC=function(){var t=this;for(var e in this.posCfg){var i=this.posCfg[e],a=i.x,n=i.y,o=i.scale,s=(i.close,i.alpha);this._npcList.push(e);var r=void 0;r=BaseLoadBitmap.create("searchnpc"+e),r.name=e,isNaN(o)||r.setScale(o),isNaN(s)||(r.alpha=s),r.setPosition(this._mapLayer.x+a,this._mapLayer.y+n),this._sceneLayer.addChild(r)}var l=function(){var i=h.namePosCfg[e],a=i.x,n=i.y,o=i.scale,s=i.close;h._npcList.push(e);var r=void 0;if(r=BaseLoadBitmap.create("searchnpcname"+e),r.name=e+"name",r.setPosition(h._mapLayer.x+a,h._mapLayer.y+n),o&&r.setScale(o),h._sceneLayer.addChild(r),s)App.DisplayUtil.changeToGray(r);else{var l=r.y,d=function(){egret.Tween.get(r).to({y:l+5},1e3).to({y:l-5},1e3).call(d,t)};d()}},h=this;for(var e in this.namePosCfg)l()},e.prototype.recoverLeftHandler=function(){var t=Api.searchVoApi.getNeedItem(),e=Api.itemVoApi.getItemNumInfoVoById(Number(t)),i=1,a=e,n=Config.ItemCfg.getItemCfgById(Number(t)),o=LanguageManager.getlocal("useItemMsg",[n.name+"x"+i,LanguageManager.getlocal("sysStrengDesc")]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{confirmCallback:this.usePropHandler,handler:this,icon:n.icon,iconBg:n.iconBg,num:a,useNum:i,msg:o,id:Number(t)})},e.prototype.usePropHandler=function(t){var e=Api.searchVoApi.getNeedItem(),i=Api.itemVoApi.getItemNumInfoVoById(Number(e));i>0&&this.request(NetRequestConst.REQUEST_SEARCH_PILL,{})},e.prototype.onNPCTouchHandler=function(t){if(t.type==egret.TouchEvent.TOUCH_BEGIN||t.type==egret.TouchEvent.TOUCH_CANCEL||t.type==egret.TouchEvent.TOUCH_END){if(t.type==egret.TouchEvent.TOUCH_BEGIN){var e=null;for(var i in this._npcList){var a=this._sceneLayer.getChildByName(this._npcList[i]),n=(this._sceneLayer.globalToLocal(t.stageX,t.stageY),-9999);a.hitTestPoint(Math.floor(t.localX),Math.floor(t.localY),!0)&&a.y>n&&(n=a.y,e=this._npcList[i])}e&&(e.indexOf("name")>-1&&(e=e.substring(0,e.indexOf("name"))),this._clickNpc=this._sceneLayer.getChildByName(e))}if(t.type==egret.TouchEvent.TOUCH_BEGIN?this._clickNpc&&(this.posCfg[this._clickNpc.name].touchDown===!1||(this._clickNpc.alpha=.3)):t.type==egret.TouchEvent.TOUCH_CANCEL&&this._clickNpc&&(this.posCfg[this._clickNpc.name].touchDown===!1||(this._clickNpc.alpha=0),this._clickNpc=null),t.type==egret.TouchEvent.TOUCH_END&&this._clickNpc){this._clickNpc&&(this.posCfg[this._clickNpc.name].touchDown===!1||(this._clickNpc.alpha=0));var e=this._clickNpc.name;e&&(this.posCfg[e].close?App.CommonUtil.showTip(LanguageManager.getlocal("sysWaitOpen")):ViewController.getInstance().openView(ViewConst.POPUP.SEARCHBUILDPOPUPVIEW,e)),this._clickNpc=null}}},e.prototype.lookforHandler=function(){this._checkBox&&(this._oneKeySearchStatus=this._checkBox.checkSelected()),this.request(NetRequestConst.REQUEST_SEARCH_PLAY,{isbatch:this._oneKeySearchStatus?1:0})},e.prototype.receiveData=function(t){var e=t.data;if(0!=t.ret){if(e.cmd==NetRequestConst.REQUEST_SEARCH_PLAY){var i=e.data.personId;if(i.length>1){this._rewards=e.data.rewards;var a=this._rewards?this._rewards.split("|"):[];if(a.length<1)for(var n=0;n<i.length;n++)a.push("");for(var o=a.length,s=[],r=0;o>r;r++)if(""==a[r]){var l=Api.searchVoApi.getPersonValueLocalStr(i[r]);l&&s.push(App.StringUtil.formatStringColor(l,TextFieldConst.COLOR_WARN_YELLOW))}else if(0==a[r].indexOf(RewardItemConst.TYPE_INTIMACY.toString())){var h=Config.SearchCfg.getPersonItemCfgByPersonId(i[r]);h&&h.wifeId&&s.push(App.StringUtil.formatStringColor(Config.WifeCfg.getWifeCfgById(h.wifeId).name+GameData.formatRewardItem(a[r])[0].message,TextFieldConst.COLOR_WARN_GREEN))}else{var d=GameData.formatRewardItem(a[r])[0];if(d.num)s.push(d.message);else{var h=Config.SearchCfg.getPersonItemCfgByPersonId(i[r]);s.push(LanguageManager.getlocal("searchBuildTalk"+h.build))}}this.playRewardTip(s)}else{this._personId=e.data.personId[0],this._rewards=e.data.rewards,this.container.touchChildren=!1;var g=Config.SearchCfg.getPersonItemCfgByPersonId(this._personId).build;this._sceneLayer.getChildByName(String(g));this.moveCompleteHandler()}}else e.cmd==NetRequestConst.REQUEST_SEARCH_PILL&&App.CommonUtil.showTip(LanguageManager.getlocal("recoverLeftSuccess"));this.refresh()}},e.prototype.playRewardTip=function(t){this._tipMask||(this._tipMask=BaseBitmap.create("public_9_bg8"),this._tipMask.width=GameConfig.stageWidth,this._tipMask.height=GameConfig.stageHeigth,this._tipMask.touchEnabled=!0,LayerManager.msgLayer.addChild(this._tipMask));var e=t,i=200,a=new BaseDisplayObjectContainer,n=BaseBitmap.create("public_itemtipbg2");a.addChild(n);var o=ComponentManager.getTextField(e.shift(),TextFieldConst.FONTSIZE_CONTENT_COMMON);n.width=n.width+o.width,o.setPosition((n.width-o.width)/2,(n.height-o.height)/2),a.addChild(o),a.setPosition((GameConfig.stageWidth-a.width)/2,(GameConfig.stageHeigth-a.height)/2+i),LayerManager.msgLayer.addChild(a),null==this._tipMask.count&&(this._tipMask.count=0),this._tipMask.count++;var s=this;egret.Tween.get(a).to({y:a.y-2*i},3e3).call(function(t){if(t&&t.dispose(),s._tipMask&&(s._tipMask.count--,!s._tipMask.count)){BaseBitmap.release(s._tipMask),s._tipMask=null;var e=Api.wifeVoApi.getWaitShowWife();e&&ViewController.getInstance().openView(ViewConst.BASE.WIFEGETVIEW,{wifeIdList:e.unlockWife,servantId:e.unlockServant})}},this,[a]),this._tipTipTimeOut<0&&(this._tipTipTimeOut=egret.setInterval(this.playRewardTip,this,300,e)),e.length<1&&this._tipTipTimeOut>-1&&(egret.clearInterval(this._tipTipTimeOut),this._tipTipTimeOut=-1)},e.prototype.moveCompleteHandler=function(){var t=Config.SearchCfg.getPersonItemCfgByPersonId(this._personId).build,e=this._sceneLayer.getChildByName(String(t));e&&egret.Tween.get(e).to({alpha:.3},100).to({alpha:0},200).to({alpha:.3},100).to({alpha:0},200).call(this.showResult,this,[this._personId])},e.prototype.showResult=function(t){this.container.touchChildren=!0,ViewController.getInstance().openView(ViewConst.POPUP.SEARCHRESULTPOPUPVIEW,{personId:t,rewards:this._rewards})},e.prototype.refresh=function(){this._leftText&&(this._leftText.text=Api.searchVoApi.getSearchNumLocalStr(),Api.searchVoApi.getSearchNum()>0?(this._searchBtn.visible=!0,this._buyBtn.visible=!1):(this._searchBtn.visible=!1,this._buyBtn.visible=!0)),this.refreshByModel()},e.prototype.doGuide=function(){this.openLuckView()},e.prototype.openLuckView=function(){ViewController.getInstance().openView(ViewConst.POPUP.SEARCHLUCKPOPUPVIEW)},e.prototype.tick=function(){if(Api.searchVoApi.getSearchNum()<Api.searchVoApi.getMaxSearchNum()&&this.refresh(),this._luckProgress){var t=Api.searchVoApi.getCurLuckNum()/Api.searchVoApi.getMaxLuckNum();this._luckProgress.setPercentage(t,Api.searchVoApi.getCurLuckNum()+"/"+Api.searchVoApi.getMaxLuckNum())}},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["searchbg1","progress3","common_buttombigbg"])},e.prototype.getButtomLineBg=function(){return null},e.prototype.getRuleInfo=function(){return"searchViewRuleInfo"},e.prototype.dispose=function(){this._checkBox&&(this._oneKeySearchStatus=this._checkBox.checkSelected()),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_SEARCH,this.refreshByModel,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.checkOnekeySearchHandler,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT,this.doGuide,this),this.container.touchChildren=!0,this._sceneLayer=null,this._mapLayer=null,this._npcList.length=0,this._leftText=null,this._searchBtn=null,this._buyBtn=null,this._personId=null,this._rewards=null,this._clickNpc=null,this._luckProgress=null,this._checkBox=null,this._isCfgInit=!1,this._isbgResLoaded&&(this._bgResGroupName&&(ResourceManager.destroyRes(this._bgResGroupName),this._bgResGroupName=null),this._isbgResLoaded=!1),t.prototype.dispose.call(this)},e}(CommonView);__reflect(SearchView.prototype,"SearchView");var NetManager;!function(t){var e;!function(t){function e(){l||(l=new Http)}function i(t,e,i,a,o){n(t,e,egret.HttpMethod.POST,i,a,o)}function a(t,e,i,a,o){n(t,e,egret.HttpMethod.GET,i,a,o)}function n(i,a,n,r,g,c){e(),d.push({host:i,data:a,method:n,callback:r,errorCallback:g,callbackTarget:c}),0==h&&(h=!0,l.request(i,a,n,s,o,t))}function o(){var t=d.shift(),e=t.errorCallback;d.length<1&&h&&(h=!1),e&&e.call(t.callbackTarget)}function s(e){var i=void 0;if(i="string"==typeof e?JSON.parse(e):e,App.LogUtil.warn("http接收",i),d.length>0){var a=d.shift();if(d.length>0){var n=d[0].host,r=d[0].data,g=d[0].method;l.request(n,r,g,s,o,t)}else h=!1;var c=a.callback;c&&c.call(a.callbackTarget,i)}else if(d.length>0){var n=d[0].host,p=d[0].data,g=d[0].method;l.request(n,p,g,s,o,t)}else h=!1}function r(){l&&l.abort(),d.length>0&&(d.length=0),h=!1}var l,h=!1,d=[];t.post=i,t.get=a,t.dispose=r}(e=t.http||(t.http={}));var i;!function(e){function i(){_||(_=n())}function a(){var t=!1;return _&&(t=_.isConnected()),t}function n(){App.LogUtil.log("checkWeiduan"+PlatformManager.checkIsWeiduan());var t;return t=PlatformManager.checkUseRSDKSocket()?new ClientSocket:new Socket,t.addEventListener(SocketStateConst.SOCKET_START_RECONNECT,s,e),t.addEventListener(SocketStateConst.SOCKET_RECONNECTED,r,e),t.addEventListener(SocketStateConst.SOCKET_NOCONNECT,l,e),t.addEventListener(SocketStateConst.SOCKET_DATA,g,e),t}function o(t,a,n,o){i(),_.once(SocketStateConst.SOCKET_CONNECTED,function(){n&&(App.LogUtil.log("gamesocket首次连接成功"),n.apply(o))},e),_.connect(t,a)}function s(t){c(),y||(NetLoading.show(),y=!0)}function r(t){y=!1,LoginManager.reLoginGame()}function l(t){App.LogUtil.log("断网了"),c(),y&&(NetLoading.hide(),y=!1),LoginManager.hideLoginLoading(),ViewController.getInstance().openView(ViewConst.POPUP.NETERRORPOPUPVIEW)}function h(){_.isNoConnect()&&_.resetAndReconnect(!0)}function d(t,i,a){_.isConnected()&&(C.push({data:t,callback:i,callbackTarget:a}),0==f&&(u?u.showMask():u=NetLoadingWait.showMask(500),0>T&&(T=egret.setTimeout(function(){_.close(!0)},e,m)),f=!0,App.LogUtil.log("socket发送",C[0].data),_.send(C[0].data)))}function g(e){var i=e.data;if(App.LogUtil.warn("socket接收",i),0==String(i.cmd).indexOf("push."))t.formatPushData(i);else if(C.length>0){var a=C.shift();C.length>0?(App.LogUtil.log("socket发送",C[0].data),_.send(C[0].data)):(f=!1,u&&u.hideMask(),T>-1&&(egret.clearTimeout(T),T=-1));var n=a.callback;n&&n.call(a.callbackTarget,i)}else C.length>0?(App.LogUtil.log("socket发送",C[0].data),_.send(C[0].data)):(f=!1,u&&u.hideMask(),T>-1&&(egret.clearTimeout(T),T=-1))}function c(){f=!1,C.length>0&&(C.length=0),u&&u.hideMask(),T>-1&&(egret.clearTimeout(T),T=-1)}function p(){_&&_.close(),c()}var _,u,C=[],f=!1,m=2e4,T=-1;e.isConnected=a,e.connect=o;var y=!1;e.checkAndReConnect=h,e.send=d,e.dispose=p}(i=t.socket||(t.socket={}));var a;!function(e){function a(){u||(u=o())}function n(){var t=!1;return u&&(t=u.isConnected()),t}function o(){App.LogUtil.log("checkWeiduan"+PlatformManager.checkIsWeiduan());var t;return t=PlatformManager.checkUseRSDKSocket()?new ClientSocket:new Socket,t.addEventListener(SocketStateConst.SOCKET_START_RECONNECT,r,i),t.addEventListener(SocketStateConst.SOCKET_RECONNECTED,l,i),t.addEventListener(SocketStateConst.SOCKET_NOCONNECT,h,i),t.addEventListener(SocketStateConst.SOCKET_DATA,c,i),t}function s(t,e,n,o){a(),u.once(SocketStateConst.SOCKET_CONNECTED,function(){n&&n.apply(o)},i),u.connect(t,e)}function r(t){f=!1,C.length=0}function l(t){LoginManager.reLoginChat()}function h(t){}function d(){u&&u.isNoConnect()&&u.resetAndReconnect(!0)}function g(t,e,i){u.isConnected()&&(C.push({data:t,callback:e,callbackTarget:i}),0==f&&(f=!0,u.send(C[0].data)))}function c(e){var i=e.data;if(App.LogUtil.warn("chatSocket接收",i),C.length>0){var a=C.shift();C.length>0?u.send(C[0].data):f=!1;var n=a.callback;n?n.call(a.callbackTarget,i):t.formatReceiveChat(i)}else f=!1,t.formatReceiveChat(i)}function p(){C.length>0&&(C.length=0),f=!1}function _(){u&&u.close(),p()}var u,C=[],f=!1;e.isConnected=n,e.connect=s,e.checkAndReConnect=d,e.send=g,e.dispose=_}(a=t.chat||(t.chat={}))}(NetManager||(NetManager={}));var DropToggleGroup=function(t){function e(e,i,a){var n=t.call(this)||this;return n._lastDropIdx=1,n._btnNameArray=e,n._btnCallback=i,n._callbackHandler=a,n.initBtnList(),n}return __extends(e,t),e.prototype.initBtnList=function(){this._nodeContainer=new BaseDisplayObjectContainer,this.addChild(this._nodeContainer),this._dropBtnList=[],this._dropDownBtn=ComponentManager.getButton("servant_dropBtn","",this.dropDownBtnClickHandler,this,[0]),this._dropDownBtn.x=0,this._dropDownBtn.y=0,this._dropDownBtn.setColor(e.DROPBTN_COLOR1),this._nodeContainer.addChild(this._dropDownBtn),this._dropDownBtn.setText(this._btnNameArray[0]),this._dropBtnList.push(this._dropDownBtn),this._dropDownFlag=BaseBitmap.create("servant_dropIcon"),this._dropDownFlag.anchorOffsetY=this._dropDownFlag.height/2,this._dropDownFlag.x=this._dropDownBtn.x+this._dropDownBtn.width-this._dropDownFlag.width-3,this._dropDownFlag.y=this._dropDownBtn.y+this._dropDownBtn.height-this._dropDownFlag.height/2-10,this._nodeContainer.addChild(this._dropDownFlag),this._dropDownContainer=new BaseDisplayObjectContainer,this._dropDownContainer.visible=!1,this._dropDownContainer.x=this._dropDownBtn.x,this._dropDownContainer.y=this._dropDownBtn.y+this._dropDownBtn.height,this._nodeContainer.addChild(this._dropDownContainer);for(var t=1;4>=t;t++){var i=ComponentManager.getButton("servant_dropBtn","",this.dropDownBtnClickHandler,this,[t]);this._dropBtnList.push(i),1==t?i.setColor(e.DROPBTN_COLOR1):i.setColor(e.DROPBTN_COLOR2),i.y=i.height*(t-1),this._dropDownContainer.addChild(i),i.setText(this._btnNameArray[t-1])}},e.prototype.dropDownBtnClickHandler=function(t){var i=this._lastDropIdx;this._dropBtnList[1].setColor(e.DROPBTN_COLOR2),this._dropBtnList[2].setColor(e.DROPBTN_COLOR2),this._dropBtnList[3].setColor(e.DROPBTN_COLOR2),this._dropBtnList[4].setColor(e.DROPBTN_COLOR2),this._dropBtnList[this._lastDropIdx].setColor(e.DROPBTN_COLOR1),this._dropDownContainer.visible?(this._dropDownFlag.scaleY=1,this._dropDownContainer.visible=!1):(this._dropDownFlag.scaleY=-1,this._dropDownContainer.visible=!0),t>0&&(this._dropDownBtn.setText(this._btnNameArray[t-1]),this._lastDropIdx=t),i!=this._lastDropIdx&&this._btnCallback&&this._btnCallback.apply(this._callbackHandler,[t])},e.prototype.dispose=function(){this._nodeContainer=null,this._dropDownContainer=null,this._dropDownBtn=null,this._dropDownFlag=null,this._dropBtnList=null,this._lastDropIdx=1,t.prototype.dispose.call(this)},e.DROPBTN_COLOR1=16776408,e.DROPBTN_COLOR2=10068916,e}(BaseDisplayObjectContainer);__reflect(DropToggleGroup.prototype,"DropToggleGroup");var ServantAdvancePopupView=function(t){function e(){var e=t.call(this)||this;return e._tipStr="",e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_CHANGE),this.clvBtntHandlerCallback,this),this._servantId=this.param.data;var t=Api.servantVoApi.getServantObj(this._servantId),e=GameConfig.config.servantbaseCfg.servantLvList;this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var i=BaseBitmap.create("public_9_bg4");i.width=520,i.height=478,i.x=this.viewBg.x+this.viewBg.width/2-i.width/2,i.y=9,this._nodeContainer.addChild(i);var a=BaseBitmap.create("public_9_probiginnerbg");a.width=236,a.height=268,a.x=i.x+21,a.y=i.y+15,this._nodeContainer.addChild(a);var n=BaseBitmap.create("public_9_probiginnerbg");n.width=a.width,n.height=a.height,n.x=a.x+242,n.y=a.y,this._nodeContainer.addChild(n);var o=BaseBitmap.create("public_9_probiginnerbg");o.width=496,o.height=168,o.x=i.x+12,o.y=a.y+a.height+10,this._nodeContainer.addChild(o);var s=BaseLoadBitmap.create("servant_arrow");s.width=34,s.height=22,s.x=this.viewBg.width/2-s.width/2,s.y=n.y+n.height/2-s.height/2,this._nodeContainer.addChild(s);for(var r=1;2>=r;r++){var l=t.clv+r-1,h=e[String(l)],d=a;2==r&&(d=n);var g=BaseLoadBitmap.create("servant_cardbg_"+l);g.width=194,g.height=192,g.x=d.x+d.width/2-g.width/2,g.y=d.y+15,this._nodeContainer.addChild(g);var c=BaseLoadBitmap.create(t.halfImgPath);if(c.width=180,c.height=177,c.x=g.x+g.width/2-c.width/2,c.y=g.y+g.height-c.height-10,this._nodeContainer.addChild(c),l>0){var p=BaseLoadBitmap.create("servant_adv_icon"+l);p.x=g.x,p.y=g.y,this._nodeContainer.addChild(p)}var _=ComponentManager.getTextField("",20),u=LanguageManager.getlocal("servant_clvStr"+l),C=LanguageManager.getlocal("servant_clvColorTxt"+l,[u]);_.text=LanguageManager.getlocal("servant_clvTxt1",[C]),_.x=g.x+g.width/2-_.width/2,_.y=g.y+g.height+5,this._nodeContainer.addChild(_);var f=ComponentManager.getTextField("",20),m=LanguageManager.getlocal("servant_clvColorTxt"+l,[String(h.upLv)]);f.text=LanguageManager.getlocal("servant_clvTxt2",[m]),f.x=_.x,f.y=_.y+_.height+5,this._nodeContainer.addChild(f)}var T=e[String(t.clv+1)].needItem;if(T){var y=1;for(var v in T){var A=Config.ItemCfg.getItemCfgById(Number(v)),w=BaseBitmap.create(A.iconBg);w.width=108,w.height=106,w.x=this.viewBg.x+this.viewBg.width/2-w.width/2+150*(y-2),w.y=o.y+10,this._nodeContainer.addChild(w);var x=BaseLoadBitmap.create(A.icon);x.width=x.height=100,x.x=w.x+w.width/2-x.width/2,x.y=w.y+w.height/2-x.height/2,this._nodeContainer.addChild(x);var I=BaseBitmap.create("public_numbg");I.width=136,I.height=41,I.x=w.x+w.width/2-I.width/2,I.y=w.y+w.height+5,this._nodeContainer.addChild(I);var L=ComponentManager.getTextField("",20),E=Api.itemVoApi.getItemNumInfoVoById(Number(v));E>=T[v]?L.textColor=TextFieldConst.COLOR_QUALITY_GREEN:L.textColor=TextFieldConst.COLOR_WARN_RED2,L.text=E+"/"+T[v],L.x=I.x+I.width/2-L.width/2,L.y=I.y+I.height/2-L.height/2,this._nodeContainer.addChild(L),""==this._tipStr&&E<T[v]&&(this._tipStr=LanguageManager.getlocal("servant_clvTipStr")),y++}}var B=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"servant_clvUpBtn",this.clvBtntHandler,this);B.x=i.x+i.width/2-B.width/2,B.y=i.y+i.height+20,this._nodeContainer.addChild(B)},e.prototype.clvBtntHandlerCallback=function(t){var e=t.data.data;0==e.ret?(ViewController.getInstance().openView(ViewConst.BASE.SERVANTADVANCEVIEW,this._servantId),this.hide()):App.CommonUtil.showTip(LanguageManager.getlocal("servant_advfailedTip"))},e.prototype.clvBtntHandler=function(){return""!=this._tipStr?void App.CommonUtil.showTip(this._tipStr):void NetManager.request(NetRequestConst.REQUEST_SERVANT_CHANGE,{servantId:this._servantId})},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_CHANGE),this.clvBtntHandlerCallback,this),this._nodeContainer=null,this._servantId=null,this._tipStr="",t.prototype.dispose.call(this)},e}(PopupView);__reflect(ServantAdvancePopupView.prototype,"ServantAdvancePopupView");var ServantAdvanceView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this._nodeContainer=new BaseDisplayObjectContainer,this.addChild(this._nodeContainer);var t=this.param.data,e=(GameConfig.config.servantCfg[t],Api.servantVoApi.getServantObj(t)),i=GameConfig.config.servantbaseCfg.servantLvList,a=i[String(e.clv)];this.addTouchTap(this.clickHandler,this);var n=BaseBitmap.create("servant_advance_word");n.x=GameConfig.stageWidth/2-n.width/2,n.y=70,this._nodeContainer.addChild(n);var o=BaseLoadBitmap.create("servant_adv_icon"+e.clv);o.x=50,o.y=180,this._nodeContainer.addChild(o);var s=BaseBitmap.create("public_9_wordbg");s.height=166,s.y=GameConfig.stageHeigth-s.height-100,this._nodeContainer.addChild(s);var r=ComponentManager.getTextField("",30,TextFieldConst.COLOR_LIGHT_YELLOW);r.text=LanguageManager.getlocal("servant_name"+t),r.x=s.x+s.width/2-r.width/2,r.y=s.y+30,this._nodeContainer.addChild(r);var l=ComponentManager.getTextField("",22,TextFieldConst.COLOR_WARN_GREEN);l.text=LanguageManager.getlocal("servant_clvTxt1",[LanguageManager.getlocal("servant_clvStr"+e.clv)]),l.x=70,l.y=s.y+80,this._nodeContainer.addChild(l);var h=ComponentManager.getTextField("",22,TextFieldConst.COLOR_WARN_GREEN);h.text=LanguageManager.getlocal("servant_advtxt2",[a.abilityLv]),h.x=330,h.y=l.y,this._nodeContainer.addChild(h);var d=ComponentManager.getTextField("",22,TextFieldConst.COLOR_WARN_GREEN);d.text=LanguageManager.getlocal("servant_advtxt3",[a.upLv]),d.x=l.x,d.y=l.y+30,this._nodeContainer.addChild(d);var g=ComponentManager.getTextField("",22,TextFieldConst.COLOR_WARN_GREEN);g.text=LanguageManager.getlocal("servant_advtxt4",[String(a.reward)]),g.x=h.x,g.y=d.y,this._nodeContainer.addChild(g);var c=BaseLoadBitmap.create(Api.servantVoApi.getFullImgPathWithId(t));c.width=405,c.height=467,c.x=GameConfig.stageWidth/2-c.width/2,c.y=s.y-c.height,this._nodeContainer.addChildAt(c,0);var p=BaseBitmap.create("public_rotatelight");p.anchorOffsetX=p.width/2,p.anchorOffsetY=p.height/2,p.x=GameConfig.stageWidth/2,p.y=c.y+c.height/2-20,p.setScale(2),this._nodeContainer.addChildAt(p,0),egret.Tween.get(p,{loop:!0}).to({rotation:360},15e3)},e.prototype.clickHandler=function(){t.prototype.hide.call(this)},e.prototype.getStars=function(t){for(var e=new BaseDisplayObjectContainer,i=1;t>=i;i++){var a=BaseBitmap.create("servant_star");a.setScale(.5),a.x=(i-1)*a.width*.5,a.y=0,e.addChild(a)}return e},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["servant_advance_word","servant_star","servant_infoPro1","servant_infoPro2","servant_infoPro3","servant_infoPro4"])},e.prototype.dispose=function(){this._nodeContainer=null,t.prototype.dispose.call(this)},e}(BaseView);__reflect(ServantAdvanceView.prototype,"ServantAdvanceView");var ServantBookLevelupPopupView=function(t){function e(){var e=t.call(this)||this;return e._aindex=0,e._changeTxtList=[],e._upTipStr1="",e._upTipStr2="",e._isAtTopLv=!1,e._curBlv=0,e._proChangeValue=0,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPABILITY),this.collectHandlerCallBack,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT,this.doGuide,this);var t=this.param.data.aid;this._bookId=String(t);var e=this.param.data.servantId;this._servantId=e,this._aindex=this.param.data.index;var i=Api.servantVoApi.getServantObj(this._servantId).ability[this._aindex];this._curBlv=i;var a=GameConfig.config.abilityCfg[t],n=GameConfig.config.abilitybaseCfg,o=n.typeList,s=n.numList[String(a.num)].ratio,r=o[a.type];this._itemId=r;Api.servantVoApi.getServantObj(e).ability;this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var l=BaseBitmap.create("public_9_bg4");l.width=520,l.height=530,l.x=this.viewBg.x+this.viewBg.width/2-l.width/2,l.y=9,this._nodeContainer.addChild(l);var h=BaseBitmap.create("itembg_1");h.width=108,h.height=106,h.x=this.viewBg.width/2-h.width/2,h.y=20,this._nodeContainer.addChild(h);var d=BaseBitmap.create("servant_infoPro"+a.type);d.width=80,d.height=83,d.x=h.x+h.width/2-d.width/2,d.y=h.y+h.height/2-d.height/2,d.name="bookIcon",this._nodeContainer.addChild(d);var g=this.getStars(a.num);g.x=d.x+d.width/2-g.width/2,g.y=d.y+65,this._nodeContainer.addChild(g);var c=BaseBitmap.create("public_numbg");c.x=h.x+h.width/2-c.width/2,c.y=h.y+h.height+8,this._nodeContainer.addChild(c);var p=ComponentManager.getTextField(LanguageManager.getlocal("servant_attrNameTxt"+t),20);p.x=c.x+c.width/2-p.width/2,p.y=c.y+c.height/2-p.height/2,this._nodeContainer.addChild(p);var _=BaseBitmap.create("public_line1");_.x=this.viewBg.width/2-_.width/2,_.y=c.y+c.height+10,this._nodeContainer.addChild(_);var u=ComponentManager.getTextField(LanguageManager.getlocal("servantBookRLv"),20,TextFieldConst.COLOR_BROWN);u.x=100,u.y=_.y+15,this._nodeContainer.addChild(u);var C=BaseBitmap.create("public_9_bg40");C.width=270,C.height=30,C.x=u.x+90,C.y=u.y+u.height/2-C.height/2,this._nodeContainer.addChild(C);var f=ComponentManager.getTextField("",20,TextFieldConst.COLOR_BROWN);f.text=LanguageManager.getlocal("servantInfo_attrTxt"+a.type),f.x=u.x,f.y=u.y+35,this._nodeContainer.addChild(f);var m=BaseBitmap.create("public_9_bg40");m.width=270,m.height=30,m.x=C.x,m.y=f.y+f.height/2-m.height/2,this._nodeContainer.addChild(m);var T=BaseLoadBitmap.create("servant_arrow");T.x=C.x+100,T.y=C.y+5,this._nodeContainer.addChild(T);var y=BaseLoadBitmap.create("servant_arrow");y.x=T.x,y.y=m.y+5,this._nodeContainer.addChild(y);var v=ComponentManager.getTextField(i,20);v.name="LvValueTxt",v.x=C.x+20,v.y=u.y,this._nodeContainer.addChild(v),this._changeTxtList.push(v);var A=ComponentManager.getTextField(String(i+1),20,TextFieldConst.COLOR_WARN_GREEN);A.x=v.x+150,A.name="LvValueTxt2",A.y=v.y,this._nodeContainer.addChild(A),this._changeTxtList.push(A);var w=ComponentManager.getTextField("",20);w.x=v.x,w.y=f.y,w.name="proValueTxt",this._nodeContainer.addChild(w),this._changeTxtList.push(w);var x=ComponentManager.getTextField("",20,TextFieldConst.COLOR_WARN_GREEN);x.x=A.x,x.y=w.y,x.name="proValueTxt2",this._nodeContainer.addChild(x),this._changeTxtList.push(x);var I=BaseBitmap.create("public_9_bg39");I.width=498,I.height=118,I.x=this.viewBg.width/2-I.width/2,I.y=m.y+45,this._nodeContainer.addChild(I);var L="6_"+r+"_1",E=GameData.formatRewardItem(L),B=GameData.getItemIcon(E[0]);B.getChildByName("numLb").visible=!1,B.x=I.x+10,B.y=I.y+I.height/2-B.height/2,this._nodeContainer.addChild(B);var S=ComponentManager.getTextField("",22);S.x=B.x+B.width+10,S.y=B.y+15,S.name="itemNameTxt",this._nodeContainer.addChild(S);var N=ComponentManager.getTextField("",S.size,TextFieldConst.COLOR_LIGHT_YELLOW);N.text=LanguageManager.getlocal("servantBookRate",[(100*s).toFixed(0)+"%"]),N.x=S.x,N.y=S.y+35,N.name="rateTxt",this._nodeContainer.addChild(N),this._changeTxtList.push(N);var M=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"servantInfoLevelup",this.collectHandler,this,[1]);M.x=I.x+I.width-140,M.y=I.y+I.height/2-M.height/2,this._nodeContainer.addChild(M);var b=BaseBitmap.create("public_9_bg39");b.width=I.width,b.height=I.height,b.x=I.x,b.y=I.y+I.height+5,this._nodeContainer.addChild(b);var O=L,V=(GameData.formatRewardItem(O),BaseBitmap.create("servant_bookexp_icon"));V.x=b.x+10,V.y=b.y+b.height/2-V.height/2,this._nodeContainer.addChild(V);var R=ComponentManager.getTextField("",22);R.text=LanguageManager.getlocal("itemName_1020"),R.name="itemNameTxt2",R.x=S.x,R.y=V.y+15,this._nodeContainer.addChild(R);var k=ComponentManager.getTextField("",S.size,TextFieldConst.COLOR_LIGHT_YELLOW);k.text=LanguageManager.getlocal("servantBookRate",["100%"]),k.x=R.x,k.y=R.y+35,this._nodeContainer.addChild(k),this._changeTxtList.push(k);var P=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"servantInfoLevelup",this.collectHandler,this,[2]);P.x=M.x,P.y=b.y+b.height/2-P.height/2,this._nodeContainer.addChild(P),this.refreshUI()},e.prototype.refreshUI=function(){var t=GameConfig.config.abilityCfg[this._bookId],e=Api.servantVoApi.getServantObj(this._servantId),i=e.ability[this._aindex],a=GameConfig.config.servantbaseCfg.servantLvList[String(e.clv)],n=GameConfig.config.abilitybaseCfg,o=(n.typeList,n.numList),s=o[String(t.num)];this._proChangeValue=s.abilityExp,this._changeTxtList[0].text=String(i),this._changeTxtList[2].text=t.num*i;var r=1,l=1,h=e.abilityExp;i>=a.abilityLv?(r=0,l=0,this._isAtTopLv=!0,this._changeTxtList[1].text="MAX",this._changeTxtList[3].text="MAX"):(l=s.abilityExp,this._changeTxtList[1].text=String(i+1),this._changeTxtList[3].text=String(t.num*(i+1)));var d=this._nodeContainer.getChildByName("itemNameTxt"),g=this._nodeContainer.getChildByName("itemNameTxt2");this._upTipStr1="",this._upTipStr2="";var c=Api.itemVoApi.getItemNumInfoVoById(Number(this._itemId));c>=r?d.textColor=TextFieldConst.COLOR_QUALITY_GREEN:(d.textColor=16711680,this._upTipStr1=LanguageManager.getlocal("servant_bookUpTip1")),d.text=LanguageManager.getlocal("itemName_"+this._itemId)+" : "+c+"/"+r,h>=l?g.textColor=TextFieldConst.COLOR_QUALITY_GREEN:(g.textColor=16711680,this._upTipStr2=LanguageManager.getlocal("servant_bookUpTip2")),g.text=LanguageManager.getlocal("servant_bookExp",[String(h),String(l)])},e.prototype.collectHandlerCallBack=function(t){var e=t.data.data,i=Api.servantVoApi.getServantObj(this._servantId).ability[this._aindex];if(i>this._curBlv){var a=GameConfig.config.abilityCfg[this._bookId],n=LanguageManager.getlocal("servantInfo_speciality"+a.type)+"+"+e.data.upAttrValue,o=[{tipMessage:n}];App.CommonUtil.playRewardFlyAction(o),this._curBlv=i;var s=this._nodeContainer.getChildByName("bookIcon"),r=ComponentManager.getCustomMovieClip("servant_book_lvup",7,100);r.x=s.x-75;var l=s.y-165;r.y=l,this._nodeContainer.addChild(r),r.playWithTime(1);var h=this._nodeContainer;egret.Tween.get(r,{loop:!1}).wait(700).to({y:l},500).call(function(){h.removeChild(r),r=null},this);var d=BaseBitmap.create("servant_book_lvup8");d.anchorOffsetX=d.width/2,d.anchorOffsetY=d.height/2,d.x=s.x+s.width/2;var g=s.y+s.height/2;d.y=g,d.setScale(.3),this._nodeContainer.addChild(d),egret.Tween.get(d,{loop:!1}).to({scaleX:1,scaleY:1},160).wait(800).to({y:g,alpha:0},500).call(function(){h.removeChild(d),d=null},this);var c=BaseBitmap.create("servant_book_lvup_light");c.anchorOffsetX=c.width/2,c.anchorOffsetY=c.height/2,c.x=s.x+s.width/2,c.y=s.y+s.height/2,this._nodeContainer.addChild(c),c.setScale(0),egret.Tween.get(c,{loop:!1}).to({scaleX:.3,scaleY:.3},40).to({scaleX:1,scaleY:1},40).to({scaleX:1.4,scaleY:.75,alpha:0},40).call(function(){h.removeChild(c),c=null},this)}else{var s=this._nodeContainer.getChildByName("bookIcon"),p=BaseBitmap.create("servant_book_lvup_failed");p.x=s.x+s.width/2-p.width/2,p.y=s.y+s.height/2-p.height/2,this._nodeContainer.addChild(p);var _=this._nodeContainer;egret.Tween.get(p,{loop:!1}).to({y:p.y+30},500).call(function(){_.removeChild(p),p=null})}this.refreshUI()},e.prototype.collectHandler=function(t){return this._isAtTopLv?void App.CommonUtil.showTip(LanguageManager.getlocal("servant_bookUpTip3")):1==t&&""!=this._upTipStr1?void App.CommonUtil.showTip(this._upTipStr1):2==t&&""!=this._upTipStr2?void App.CommonUtil.showTip(this._upTipStr2):void NetManager.request(NetRequestConst.REQUEST_SERVANT_UPABILITY,{servantId:this._servantId,upType:t,pos:this._aindex})},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["servant_book_lvup","servant_book_lvup_failed","servant_bookexp_icon","servant_book_lvup_light","servant_book_lvup8"])},e.prototype.getStars=function(t){for(var e=new BaseDisplayObjectContainer,i=1;t>=i;i++){var a=BaseBitmap.create("servant_star");a.setScale(.5),a.x=(i-1)*a.width*.5,a.y=0,e.addChild(a)}return e},e.prototype.doGuide=function(){this.hide()},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPABILITY),this.collectHandlerCallBack,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT,this.doGuide,this),this._nodeContainer=null,this._aindex=null,this._servantId=null,this._bookId=null,this._changeTxtList=[],this._itemId=null,this._isAtTopLv=!1,this._upTipStr1=null,this._upTipStr2=null,t.prototype.dispose.call(this)
},e}(PopupView);__reflect(ServantBookLevelupPopupView.prototype,"ServantBookLevelupPopupView");var ServantGetView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this._personId=this.param.data.shift(),this.targetType="1",this.initCallbackFunc(this.createView),t.prototype.startView.call(this)},e.prototype.createView=function(){console.log("create view-----"),this._nodeContainer=new BaseDisplayObjectContainer,this.addChild(this._nodeContainer),"string"==typeof this.param.data&&(this.param.data=[this.param.data]);var t=this._personId,e=GameConfig.config.servantCfg[t],i=e.ability,a=Api.servantVoApi.getServantObj(t);SoundManager.playEffect(a.sound),this.addTouchTap(this.clickHandler,this);var n=BaseBitmap.create("servant_get_word");n.x=GameConfig.stageWidth/2-n.width/2,n.y=20,this._nodeContainer.addChild(n);var o=BaseBitmap.create("public_get_namebg");o.x=50,o.y=180,this._nodeContainer.addChild(o);var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_COMMON);s.multiline=!0,s.width=26,s.textColor=ServantScrollItem.QUALITYCFG[e.quality],s.text=LanguageManager.getlocal("servant_name"+t),s.x=o.x+o.width/2-s.width/2,s.y=o.y+80-s.height/2,this._nodeContainer.addChild(s);var r=BaseBitmap.create("public_9_wordbg");r.touchEnabled=!0,r.height=325,r.y=GameConfig.stageHeigth-r.height-15,this._nodeContainer.addChild(r);var l=BaseLoadBitmap.create(Api.servantVoApi.getFullImgPathWithId(t));l.width=405,l.height=467,l.x=GameConfig.stageWidth/2-l.width/2,l.y=r.y-l.height,this._nodeContainer.addChildAt(l,0);var h=BaseBitmap.create("public_rotatelight");h.anchorOffsetX=h.width/2,h.anchorOffsetY=h.height/2,h.x=GameConfig.stageWidth/2,h.y=l.y+l.height/2-20,h.setScale(2),this._nodeContainer.addChildAt(h,0),egret.Tween.get(h,{loop:!0}).to({rotation:360},15e3);var d=0,g=50,c=r.y+30;c=0;for(var p=new BaseDisplayObjectContainer,_=0;_<i.length;_++){var u=i[_],C=GameConfig.config.abilityCfg[u];g=_%2==1?GameConfig.stageWidth/2+4:50;var f=BaseBitmap.create("servant_infoPro"+C.type);f.x=g+15,f.y=c,p.addChild(f);var m=this.getStars(C.num);m.x=f.x+f.width/2-m.width/2,m.y=f.y+65,p.addChild(m);var T=ComponentManager.getTextField(LanguageManager.getlocal("servant_attrNameTxt"+u),20,TextFieldConst.COLOR_WHITE);T.x=f.x+77,T.y=c+20,p.addChild(T);var y=ComponentManager.getTextField(LanguageManager.getlocal("servantInfo_attrTxt"+C.type),18,TextFieldConst.COLOR_WHITE);y.x=T.x+13,y.y=T.y+35,p.addChild(y);var v=ComponentManager.getTextField(C.num.toString(),18,TextFieldConst.COLOR_WHITE);v.x=y.x+y.width+5,v.y=y.y,p.addChild(v),d+=C.num,_%2==1&&(c+=95)}var A=new egret.Rectangle(0,0,r.width,r.height-40),w=ComponentManager.getScrollView(p,A);w.y=r.y+30,this._nodeContainer.addChild(w);var x=LanguageManager.getlocal("servantInfo_title",[a.getTotalBookValue()]),I=ComponentManager.getTextField(x,TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);I.x=GameConfig.stageWidth-I.width-20,I.y=r.y-30,this._nodeContainer.addChild(I),this._nodeContainer.alpha=0,egret.Tween.get(this._nodeContainer,{loop:!1}).to({alpha:1},800)},e.prototype.clickHandler=function(){console.log("servant get view---click handler"),t.prototype.hide.call(this);var e=this.param.data;e&&e[0]&&ViewController.getInstance().openView(ViewConst.BASE.SERVANTGETVIEW,e)},e.prototype.getStars=function(t){for(var e=new BaseDisplayObjectContainer,i=1;t>=i;i++){var a=BaseBitmap.create("servant_star");a.setScale(.5),a.x=(i-1)*a.width*.5,a.y=0,e.addChild(a)}return e},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["servant_get_word","servant_star","servant_infoPro1","servant_infoPro2","servant_infoPro3","servant_infoPro4"])},e.prototype.getParent=function(){var t=ViewController.getInstance().getView("PlayerView");return t?PlayerBottomUI.getInstance().parent:LayerManager.panelLayer},e.prototype.dispose=function(){this._nodeContainer=null,t.prototype.dispose.call(this)},e}(DialogueGetBaseView);__reflect(ServantGetView.prototype,"ServantGetView");var ServantInfoBookItems=function(t){function e(){var e=t.call(this)||this;return e._servantId=null,e._bookNameTxtList=[],e._servantInfoObj=null,e._redPList=[],e._isPractice=!1,e}return __extends(e,t),e.prototype.init=function(t,e,i){void 0===i&&(i=!1),i?App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_UNLOCK),this.practiceLevelupCallBackHandler,this):(App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPABILITY),this.refreshBookLevelup,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_CHANGE),this.checkRedPoints,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_UPGRADE),this.practiceLevelupCallBackHandler,this)),this._isPractice=i,this._servantId=t;var a=[];if(0==this._isPractice){var n=GameConfig.config.servantCfg[this._servantId];this._servantInfoObj=Api.servantVoApi.getServantObj(this._servantId);this._servantInfoObj.attrVo;a=n.ability}else a=this.getcfgWhenPractice();var o=(Math.ceil(a.length/2),null),s=null;if(s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK),s.name="titleTxt",s.x=160,s.y=90,this.addChild(s),0==this._isPractice){var r=ComponentManager.getTextField(LanguageManager.getlocal("servantInfo_title2"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);r.x=360,r.y=90,this.addChild(r);var l=BaseBitmap.create("servant_star");l.x=r.x+r.width+10,l.y=r.y+r.height/2-l.height/2-3,this.addChild(l),o=ComponentManager.getTextField("100",s.size,s.textColor),o.x=l.x+l.width+2,o.y=r.y,this.addChild(o)}else s.y=80,s.x=GameConfig.stageWidth/2;var h=25,d=0,g=0,c=0,p=new BaseDisplayObjectContainer;this.addChild(p),p.y=10;for(var _=0;_<a.length;_++){0==_&&App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT,this.doGuide,this);var u=a[_];h=_%2==1?GameConfig.stageWidth/2+4:23;var C="public_9_managebg";this._isPractice&&(C="public_9_bg44");var f=BaseBitmap.create(C);f.width=280,f.height=71,f.x=h+10,f.y=d,p.addChild(f);var m=void 0,T=0;0==this._isPractice?(m=GameConfig.config.abilityCfg[u],T=this._servantInfoObj.ability[String(_)]):(m=a[_],T=1),f.addTouchTap(this.showBookLvup,this,[{aid:u,servantId:this._servantId,aLv:T,index:_}]);var y=BaseBitmap.create("servant_infoPro"+m.type);y.x=h-3,y.y=d+f.height/2-y.height/2,p.addChild(y);var v=TextFieldConst.COLOR_LIGHT_YELLOW;if(0==this._isPractice){v=TextFieldConst.COLOR_BLACK;var l=this.getStars(m.num);l.x=y.x+y.width/2-l.width/2,l.y=y.y+65,p.addChild(l);var A=ComponentManager.getTextField("",20,TextFieldConst.COLOR_BLACK);A.text=LanguageManager.getlocal("servant_attrNameTxt"+u)+"Lv"+String(T),A.x=y.x+77,A.y=d+10,p.addChild(A),this._bookNameTxtList.push(A)}var w=ComponentManager.getTextField(LanguageManager.getlocal("servantInfo_attrTxt"+m.type),18,v);w.x=y.x+90,w.y=f.y+f.height/2-w.height/2,0==this._isPractice&&(w.y=d+40),p.addChild(w);var x=ComponentManager.getTextField((T*m.num).toString(),18,v);x.x=w.x+w.width+5,x.y=w.y,p.addChild(x),this._bookNameTxtList.push(x),g+=m.num,_%2==1&&(d+=92),c+=T*m.num;var I=BaseBitmap.create("public_dot2");I.x=f.x+f.width-15,I.y=f.y-5,I.name="redP"+_,p.addChild(I),this._redPList.push(I)}s.text=LanguageManager.getlocal("servantInfo_title",[c.toString()]),this._isPractice&&(s.anchorOffsetX=s.width/2),o&&(o.text=g.toString());var L=110,E=new egret.Rectangle(0,0,GameConfig.stageWidth,e-L-10),B=ComponentManager.getScrollView(p,E);B.y=L,this.addChild(B),this.checkRedPoints()},e.prototype.checkRedPoints=function(){var t=void 0;t=this._isPractice?Api.practiceVoApi.practiceAttrRedList():this._servantInfoObj.isBookLvUpEnable();for(var e=0;e<this._redPList.length;e++){var i=!1;i=this._isPractice?t[String(e+1)]:null!=t[String(e)],this._redPList[e].visible=i}},e.prototype.getStars=function(t){for(var e=new BaseDisplayObjectContainer,i=1;t>=i;i++){var a=BaseBitmap.create("servant_star");a.setScale(.5),a.x=(i-1)*a.width*.5,a.y=0,e.addChild(a)}return e},e.prototype.showBookLvup=function(t,e){if(this._isPractice){var i=e.index;ViewController.getInstance().openView(ViewConst.COMMON.PRACTICEABILITYVIEW,{type:i})}else ViewController.getInstance().openView(ViewConst.POPUP.SERVANTBOOKLEVELUPPOPUPVIEW,e)},e.prototype.doGuide=function(){ViewController.getInstance().openView(ViewConst.POPUP.SERVANTBOOKLEVELUPPOPUPVIEW,{aid:"201",servantId:this._servantId,aLv:1,index:0})},e.prototype.getcfgWhenPractice=function(){var t=Api.practiceVoApi.geAttrValues(),e=[{type:1,num:t[0]},{type:2,num:t[1]},{type:3,num:t[2]},{type:4,num:t[3]}];return e},e.prototype.refreshBookLevelup=function(){var t=void 0;if(this._isPractice)t=this.getcfgWhenPractice();else{var e=GameConfig.config.servantCfg[this._servantId];t=e.ability}for(var i=0,a=0;a<t.length;a++){var n=void 0,o=0,s=t[a];0==this._isPractice?(n=GameConfig.config.abilityCfg[s],o=this._servantInfoObj.ability[String(a)]):(n=t[a],o=1);var r=a,l=this._bookNameTxtList[r];if(0==this._isPractice){r=2*a;var h=this._bookNameTxtList[r];l=this._bookNameTxtList[r+1],h.text=LanguageManager.getlocal("servant_attrNameTxt"+s)+"Lv"+String(o)}l.text=String(o*n.num),i+=o*n.num}var d=this.getChildByName("titleTxt");d.text=LanguageManager.getlocal("servantInfo_title",[i.toString()]),this._isPractice?d.anchorOffsetX=d.width/2:this.checkRedPoints()},e.prototype.practiceLevelupCallBackHandler=function(t){var e=t.data.data;0==e.ret&&this._isPractice&&(this.refreshBookLevelup(),this.checkRedPoints())},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPABILITY),this.refreshBookLevelup,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_NEXT,this.doGuide,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_CHANGE),this.checkRedPoints,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_UPGRADE),this.practiceLevelupCallBackHandler,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_REQUEST_UNLOCK),this.practiceLevelupCallBackHandler,this),this._bookNameTxtList=[],this._servantInfoObj=null,this._redPList=null,this._isPractice=!1,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(ServantInfoBookItems.prototype,"ServantInfoBookItems");var ServantInfoFourItems=function(t){function e(){var e=t.call(this)||this;return e._servantId=null,e._scrollView=null,e}return __extends(e,t),e.prototype.init=function(t,e){this._servantId=t;var i=Config.ServantCfg.getServantItemById(this._servantId),a=i.aura,n=Object.keys(a),o=new egret.Rectangle(0,0,GameConfig.stageWidth,e-120);ServantInfoFourItemScrollItem.servantId=this._servantId;var s=ComponentManager.getScrollList(ServantInfoFourItemScrollItem,n,o);s.y=90,s.x=24,this._scrollView=s,this.addChild(s)},e.prototype.servantWifeLevelupHandler=function(){},e.prototype.dispose=function(){this._scrollView=null,this._servantId=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(ServantInfoFourItems.prototype,"ServantInfoFourItems");var ServantInfoFourItemScrollItem=function(t){function e(){var e=t.call(this)||this;return e._auarKey="",e._levelupTipStr="",e._itemList=[],e}return __extends(e,t),e.prototype.initItem=function(t,i){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPAURA),this.refreshAfterLv,this);var a=i;this._auarKey=a;var n=BaseBitmap.create("public_9_managebg");n.width=592,n.height=126,n.y=0,this.addChild(n);var o=Config.ServantCfg.getServantItemById(e.servantId).aura,s=BaseLoadBitmap.create("servant_aura_Icon"+o[this._auarKey].auraIcon);s.x=s.y=10,s.width=s.height=108,this.addChild(s);var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);r.textColor=TextFieldConst.COLOR_QUALITY_YELLOW,r.x=s.x+s.width+10,r.y=s.y+3,r.name="skillName",this.addChild(r);var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);l.x=r.x,l.y=r.y+25,this.addChild(l),l.name="curValueTxt";var h=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);h.x=r.x,h.y=l.y+25,this.addChild(h),h.name="nextValueTxt";var d=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);d.x=r.x,d.y=h.y+25,this.addChild(d),d.name="upNeedTxt";var g=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"servantFour_goBtn",this.goBtnHandler,this);g.x=n.x+n.width-140,g.y=n.y+n.height/2-g.height/2,g.visible=!1,this.addChild(g),g.name="goBtn";var c=ComponentManager.getTextField(LanguageManager.getlocal("wifeSkillMaxShow"),TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_WARN_RED);c.x=g.x+g.width/2-c.width/2,c.y=g.y+g.height/2-c.height/2,c.visible=!1,c.name="topLvTxt",this.addChild(c),this.refreshAfterLv()},e.prototype.refreshAfterLv=function(t){if(t&&0==t.data.data.ret){App.CommonUtil.showTip(LanguageManager.getlocal("wifeSkillUpdSuccess"));var i=Api.servantVoApi.getServantObj(e.servantId);i&&i.isShowRedForaura()&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_SERVANT_ITEMLIST)}var a=e.servantId,n=Config.ServantCfg.getServantItemById(a),o=n.aura,s=(Object.keys(o),o[this._auarKey]),r=Api.servantVoApi.getServantObj(a),l=this.getChildByName("skillName"),h=this.getChildByName("curValueTxt"),d=this.getChildByName("nextValueTxt"),g=this.getChildByName("upNeedTxt"),c=this.getChildByName("goBtn"),p=this.getChildByName("topLvTxt"),_="",u="",C="",f="";if(4==s.att.length)f=LanguageManager.getlocal("wifeSkillAllAttAdd");else{for(var m=0;m<s.att.length;m++){var T=s.att[m];f=0==m?LanguageManager.getlocal("servantInfo_speciality"+T):f+"、"+LanguageManager.getlocal("servantInfo_speciality"+T)}f+=LanguageManager.getlocal("wifeSkillAttAdd")}var y="",v="",A="",w=1;s.growAtt<1?(v=100*s.growAtt*r.aura[this._auarKey]+"%",A=100*s.growAtt*(r.aura[this._auarKey]+w)+"%"):(v=(s.growAtt*r.aura[this._auarKey]).toString(),A=(s.growAtt*(r.aura[this._auarKey]+w)).toString()),y=v,_=LanguageManager.getlocal("servant_fourlevelupTxt1",[f+v]),u=LanguageManager.getlocal("servant_fourlevelupTxt2",[f+A]);var x=!1,I=!1;if(s.growNeed1&&s.growNeed1.length>0)if(x=!1,r.aura[this._auarKey]>=s.maxLv)I=!0,w=0,C="",u=LanguageManager.getlocal("servant_fourlevelupTxt2",[LanguageManager.getlocal("servant_fourlevelupTxt5")]);else{var L=(s.growNeed1[r.aura[this._auarKey]],r.aura[this._auarKey]),E=LanguageManager.getlocal("servant_fourPeopleaura"+s.auraIcon),B=LanguageManager.getlocal("servantWife_fourUpCost2",[L+1,L,L+1,E]);C=LanguageManager.getlocal("servant_fourlevelupTxt7",[B])}else if(this._levelupTipStr="",x=!0,r.aura[this._auarKey]>=s.maxLv)I=!0,C="",this._levelupTipStr=LanguageManager.getlocal("servant_skilllevelupTip2"),u=LanguageManager.getlocal("servant_fourlevelupTxt2",[LanguageManager.getlocal("servant_fourlevelupTxt5")]);else{var S=GameData.formatRewardItem(s.growNeed2);this._itemList=S;var N=this._itemList[0],M=Api.itemVoApi.getItemNumInfoVoById(N.id);C+=N.name+"("+M+"/"+N.num+")  ",M<N.num&&""==this._levelupTipStr?(this._levelupTipStr=LanguageManager.getlocal("servant_bookUpTip1"),C=LanguageManager.getlocal("servant_fourlevelupTxt3",[C])):C=LanguageManager.getlocal("servant_fourlevelupTxt6",[C])}var b=LanguageManager.getlocal("servant_fourPeopleaura"+s.auraIcon)+" Lv : "+r.aura[this._auarKey];l.text=b,h.text=_,d.text=u,g.text=C,I?(p.visible=!0,c.visible=!1):(p.visible=!1,x?c.visible=!0:c.visible=!1)},e.prototype.doRequest=function(){var t=e.servantId,i=this._auarKey;NetManager.request(NetRequestConst.REQUEST_SERVANT_UPAURA,{auraId:i,servantId:t})},e.prototype.goBtnHandler=function(){if(""!=this._levelupTipStr)return void App.CommonUtil.showTip(this._levelupTipStr);var t=this._itemList[0],e=Config.ItemCfg.getItemCfgById(t.id),i=t.name+"*"+t.num+" ",a=LanguageManager.getlocal("servant_fourlevelupTxt4",[i]),n={confirmCallback:this.doRequest,handler:this,icon:e.icon,iconBg:e.iconBg,num:Api.itemVoApi.getItemNumInfoVoById(t.id),msg:a,id:t.id,useNum:t.num};ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,n)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPAURA),this.refreshAfterLv,this),this._auarKey=null,t.prototype.dispose.call(this)},e.servantId="",e}(ScrollListItem);__reflect(ServantInfoFourItemScrollItem.prototype,"ServantInfoFourItemScrollItem");var ServantInfoItems=function(t){function e(){var e=t.call(this)||this;return e._servantId=null,e._totalNum=0,e}return __extends(e,t),e.prototype.init=function(t,e){App.MessageHelper.addEventListener(MessageConst.MESSAGE_REFRESH_SERVANT_ITEMLIST,this.refreshListView,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_REFRSH_SERVANT_ITEM_USE,this.refreshItemTipFromDispatch,this),this._servantId=t;var i=(Config.ServantCfg.getServantItemById(this._servantId),BaseBitmap.create("public_line3"));i.width=480,i.x=GameConfig.stageWidth/2-i.width/2,i.y=90,this.addChild(i);var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);a.textColor=TextFieldConst.COLOR_BROWN,a.y=90,this.addChild(a),this._itemTip=a;for(var n=[],o=GameConfig.config.servantbaseCfg.attItem,s=0;s<o.length;s++){var r=o[s],l=Api.itemVoApi.getItemInfoVoById(r);l&&l.num>0&&n.push(l)}this._emptyTip=ComponentManager.getTextField(LanguageManager.getlocal("servantInfoItemsEmpty"),TextFieldConst.FONTSIZE_CONTENT_SMALL),this._emptyTip.x=GameConfig.stageWidth/2-this._emptyTip.width/2,this._emptyTip.y=e/2,this._emptyTip.visible=!1,this.addChild(this._emptyTip),0==n.length&&(this._emptyTip.visible=!0);for(var h in n)this._totalNum+=n[h].num;var d=new egret.Rectangle(0,0,GameConfig.stageWidth,e-150);ServantInfoItemsScrollItem.servantId=this._servantId;var g=ComponentManager.getScrollList(ServantInfoItemsScrollItem,n,d);g.y=120,g.x=24,this._scrollView=g,this.addChild(g),this.refreshItemTip()},e.prototype.refreshItemTipFromDispatch=function(t){var e=t.data;this.refreshItemTip(e)},e.prototype.refreshItemTip=function(t){t&&(this._totalNum-=t),this._itemTip.text=LanguageManager.getlocal("servant_itemip",[String(this._totalNum)]),this._itemTip.x=GameConfig.stageWidth/2-this._itemTip.width/2},e.prototype.refreshListView=function(){var t=[],e=GameConfig.config.servantbaseCfg.attItem;this._totalNum=0;for(var i=0;i<e.length;i++){var a=e[i],n=Api.itemVoApi.getItemInfoVoById(a);n&&n.num>0&&(this._totalNum+=n.num,t.push(n))}0==t.length&&(this._emptyTip.visible=!0),this.refreshItemTip(),this._scrollView.refreshData(t)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_REFRESH_SERVANT_ITEMLIST,this.refreshListView,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_REFRSH_SERVANT_ITEM_USE,this.refreshItemTipFromDispatch,this),this._servantId=null,this._scrollView=null,this._itemTip=null,this._totalNum=0,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(ServantInfoItems.prototype,"ServantInfoItems");var ServantInfoItemsScrollItem=function(t){function e(){var e=t.call(this)||this;return e._lastUseNum=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USE_ITEM),this.useBtnHandlerCallBaclk,this);var i=e;this._itemId=i.id;var a=BaseBitmap.create("public_9_managebg");a.width=592,a.height=84,this.addChild(a);var n=.85,o=BaseBitmap.create(i.iconBg);o.x=0,o.y=0,this.addChild(o),o.scaleX=n,o.scaleY=n;var s=BaseLoadBitmap.create(i.icon);s.x=o.x+o.width/2-50,s.y=o.y+o.height/2-50,this.addChild(s),s.scaleX=n,s.scaleY=n,this._numTF=ComponentManager.getTextField(String(i.num),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this._numTF.x=o.x+o.width-this._numTF.width-25,this._numTF.y=o.y+o.height-this._numTF.height-25,this.addChild(this._numTF);var r=BaseBitmap.create("public_numbg");r.x=o.x+o.width+5,r.y=o.y+5,this.addChild(r),r.visible=!1;var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);l.textColor=TextFieldConst.COLOR_BLACK,l.text=LanguageManager.getlocal("itemName_"+i.id),l.x=r.x+r.width/2-l.width/2,l.y=r.y+r.height/2-l.height/2,this.addChild(l);var h=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);h.multiline=!0,h.width=315,h.text=LanguageManager.getlocal("servant_itemEffect",[LanguageManager.getlocal("itemDesc_"+i.id)]),h.x=r.x+10,h.textColor=TextFieldConst.COLOR_BLACK,h.y=r.y+r.height+10,this.addChild(h);var d=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"useBtn",this.useBtnHandler,this);d.x=a.x+a.width-140,d.y=a.y+a.height/2-d.height/2,this.addChild(d)},e.prototype.showTipAfterUse=function(t){var e="",i=App.StringUtil.splitString(t,"_");e="7"==i[0]?LanguageManager.getlocal("servantInfo_speciality"+i[1])+"+"+i[2]:LanguageManager.getlocal("servantRewardType"+i[0],[i[2]]),App.CommonUtil.showTip(e)},e.prototype.useBtnHandlerCallBaclk=function(t){if(0!=t.data.data.ret)return void App.CommonUtil.showTip(LanguageManager.getlocal("servantinfo_itemuseFailed"));var e=t.data.data.data,i=GameData.formatRewardItem(e.rewards);App.CommonUtil.playRewardFlyAction(i),this._lastUseNum>0&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRSH_SERVANT_ITEM_USE,this._lastUseNum);var a=0;this._itemId&&(a=Api.itemVoApi.getItemNumInfoVoById(this._itemId)),a>0?this._numTF.text=a.toString():(this._itemId=null,App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_SERVANT_ITEMLIST))},e.prototype.doUseRequest=function(t){this._lastUseNum=t;var i=e.servantId;NetManager.request(NetRequestConst.REQUEST_USE_ITEM,{itemId:this._itemId,itemNum:t,servantId:i})},e.prototype.useBtnHandler=function(){var t=Api.itemVoApi.getItemNumInfoVoById(this._itemId);return t>=5?void ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSEPOPUPVIEW,{itemId:this._itemId,callback:this.doUseRequest,handler:this}):void this.doUseRequest(1)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USE_ITEM),this.useBtnHandlerCallBaclk,this),this._lastUseNum=0,this._numTF=null,this._itemId=null,t.prototype.dispose.call(this)},e.servantId="",e}(ScrollListItem);__reflect(ServantInfoItemsScrollItem.prototype,"ServantInfoItemsScrollItem");var ServantInfoSkillsItem=function(t){function e(){var e=t.call(this)||this;return e._servantId=null,e._txtList=[],e._upTipStr="",e._lv1TipStr="",e._lv2TipStr="",e}return __extends(e,t),e.prototype.init=function(t,e){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPSKILL),this.refreshUIInfo,this),this._servantId=t,this._nodeContainer=new BaseDisplayObjectContainer;var i=BaseBitmap.create("public_line3");i.width=460,i.x=GameConfig.stageWidth/2-i.width/2,i.y=90,this.addChild(i),this._skillExpTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL),this._skillExpTxt.textColor=TextFieldConst.COLOR_BROWN,this._skillExpTxt.y=i.y,this.addChild(this._skillExpTxt);for(var a=0,n=0;2>n;n++){var o=BaseBitmap.create("public_9_managebg");o.width=592,o.height=138,o.x=24,o.y=a,this._nodeContainer.addChild(o);var s=BaseLoadBitmap.create("servant_skill_icon"+(n+1));s.width=108,s.height=109,s.x=o.x+10,s.y=o.y+o.height/2-s.height/2,this._nodeContainer.addChild(s);var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);r.textColor=TextFieldConst.COLOR_QUALITY_ORANGE,r.text=LanguageManager.getlocal("servant_skillname"+(n+1)),r.x=s.x+s.width+10,r.y=s.y+5,r.textColor=TextFieldConst.COLOR_BLACK,this._nodeContainer.addChild(r),this._txtList.push(r);var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);l.text=LanguageManager.getlocal("servant_skilllevelupTxt1",["100"]),l.x=r.x,l.y=r.y+25,l.textColor=TextFieldConst.COLOR_BLACK,this._nodeContainer.addChild(l),this._txtList.push(l);var h=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);h.text=LanguageManager.getlocal("servant_skilllevelupTxt2",["100"]),h.x=r.x,h.y=l.y+25,h.textColor=TextFieldConst.COLOR_BLACK,this._nodeContainer.addChild(h),this._txtList.push(h);var d=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);d.text=LanguageManager.getlocal("servant_skilllevelupTxt3",["100"]),d.x=r.x,d.y=h.y+25,d.textColor=TextFieldConst.COLOR_BLACK,this._nodeContainer.addChild(d),this._txtList.push(d);var g=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"servantInfoLevelup",this.servantSkillLevelupHandler,this,[n]);g.x=o.x+o.width-140,g.y=o.y+o.height/2-g.height/2,this._nodeContainer.addChild(g),g.name="upgradeBtn"+(n+1),a+=o.height+5;var c=ComponentManager.getTextField(LanguageManager.getlocal("wifeSkillMaxShow"),TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_WARN_RED);c.x=g.x+g.width/2-c.width/2,c.y=g.y+g.height/2-c.height/2,c.visible=!1,c.name="topLvTxt"+(n+1),this._nodeContainer.addChild(c)}var p=new egret.Rectangle(0,0,GameConfig.stageWidth,e-150),_=ComponentManager.getScrollView(this._nodeContainer,p);_.y=120,this.addChild(_),this.refreshUIInfo()},e.prototype.refreshUIInfo=function(t){t&&0==t.data.data.ret&&App.CommonUtil.showTip(LanguageManager.getlocal("wifeSkillUpdSuccess"));var e=this._nodeContainer.getChildByName("upgradeBtn1"),i=this._nodeContainer.getChildByName("upgradeBtn2");App.DisplayUtil.changeToNormal(e),App.DisplayUtil.changeToNormal(i),this._upTipStr="",this._lv1TipStr="",this._lv2TipStr="";var a=Api.servantVoApi.getServantObj(this._servantId),n=GameConfig.config.servantbaseCfg,o=n.skillUpgradeExp,s=n.skillLvLimit;this._skillExpTxt.text=LanguageManager.getlocal("servant_skilllExp",[String(a.skillExp)]),this._skillExpTxt.x=GameConfig.stageWidth/2-this._skillExpTxt.width/2;var r=LanguageManager.getlocal("servant_skilllevelupTxt4"),l=LanguageManager.getlocal("servant_skilllevelupTxt5"),h=Api.servantVoApi.getServantObj(this._servantId).skill,d=h[0],g=h[1],c=100*GameConfig.config.servantbaseCfg.skillValue1,p=100*GameConfig.config.servantbaseCfg.skillValue2;d==s?(e.visible=!1,this._nodeContainer.getChildByName("topLvTxt1").visible=!0,App.DisplayUtil.changeToGray(e),this._lv1TipStr=LanguageManager.getlocal("servant_skilllevelupTip2"),this._txtList[3].visible=!1,this._txtList[2].text=LanguageManager.getlocal("servant_skilllevelupTxt2",[LanguageManager.getlocal("servant_skilllLvTop"),""])):(this._txtList[3].text=LanguageManager.getlocal("servant_skilllevelupTxt3",[String(o[d-1]),r]),this._txtList[2].text=LanguageManager.getlocal("servant_skilllevelupTxt2",[(c*(d+1)).toFixed(2)+"%",r])),g==s?(i.visible=!1,this._nodeContainer.getChildByName("topLvTxt2").visible=!0,App.DisplayUtil.changeToGray(i),this._lv2TipStr=LanguageManager.getlocal("servant_skilllevelupTip2"),this._txtList[7].visible=!1,this._txtList[6].text=LanguageManager.getlocal("servant_skilllevelupTxt2",[LanguageManager.getlocal("servant_skilllLvTop"),""])):(this._txtList[7].text=LanguageManager.getlocal("servant_skilllevelupTxt3",[String(o[g-1]),l]),this._txtList[6].text=LanguageManager.getlocal("servant_skilllevelupTxt2",[(p*(g+1)+100).toFixed(0)+"%",l])),this._txtList[0].text=LanguageManager.getlocal("servant_skillname1")+" Lv: "+String(d),this._txtList[1].text=LanguageManager.getlocal("servant_skilllevelupTxt1",[(c*d).toFixed(2)+"%",r]),this._txtList[4].text=LanguageManager.getlocal("servant_skillname2")+" Lv: "+String(g),this._txtList[5].text=LanguageManager.getlocal("servant_skilllevelupTxt1",[(p*g+100).toFixed(0)+"%",l]);var _=a.skillExp;_<o[d-1]&&""==this._lv1TipStr&&(App.DisplayUtil.changeToGray(e),this._lv1TipStr=LanguageManager.getlocal("servant_skilllevelupTip1")),_<o[g-1]&&""==this._lv2TipStr&&(App.DisplayUtil.changeToGray(i),this._lv2TipStr=LanguageManager.getlocal("servant_skilllevelupTip1"))},e.prototype.servantSkillLevelupHandler=function(t){return""!=this._lv1TipStr&&0==t?void App.CommonUtil.showTip(this._lv1TipStr):""!=this._lv2TipStr&&1==t?void App.CommonUtil.showTip(this._lv2TipStr):void NetManager.request(NetRequestConst.REQUEST_SERVANT_UPSKILL,{servantId:this._servantId,pos:t})},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPSKILL),this.refreshUIInfo,this),this._txtList=[],this._servantId=null,this._upTipStr="",t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(ServantInfoSkillsItem.prototype,"ServantInfoSkillsItem");var ServantInfoView=function(t){function e(){var e=t.call(this)||this;return e._servantId=null,e._servantInfoObj=null,e._proTxtList=null,e._servantProCfg=null,e._curLvNeedGold=0,e._lastUseTime=0,e._bottomNodeList=[],e}return __extends(e,t),e.prototype.initView=function(){Api.rookieVoApi.checkNextStep(),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_UPGRADE_SERVANT),this.refreshInfoAfterUpdate,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_UPGRADE_SERVANT_TEN),this.refreshInfoAfterUpdate,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USE_ITEM),this.refreshServantProTxt,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_CHANGE),this.refreshInfoAfterUpdate,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPABILITY),this.refreshServantProTxt,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPSKILL),this.refreshServantProTxt,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_SHOWHAND,this.showHand,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPAURA),this.refreshServantProTxt,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_REFRESH_SERVANT_ITEMLIST,this.checkRedPoints,this),this._proTxtList=[],this._servantId=this.param.data;var t=Api.servantVoApi.getServantObj(this._servantId);this._servantInfoObj=t,this._curLvNeedGold=GameConfig.config.servantbaseCfg.upgradeNeed[this._servantInfoObj.level-1],this.playEffect(t.sound,!0);var i=GameConfig.config.servantCfg[this._servantId];this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer),this._bottomnodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._bottomnodeContainer);var a=BaseBitmap.create("servant_topresbg");a.width=120,a.x=20+(App.DeviceUtil.isWXgame()?50:0),a.y=this.container.y-a.height-20+(App.DeviceUtil.isWXgame()?50:0),this.addChild(a);var n=BaseBitmap.create("public_icon2");n.x=a.x-n.width/2+15,n.y=a.y+a.height/2-n.height/2-5,this.addChild(n),this._goldNumTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._goldNumTxt.text=Api.playerVoApi.getPlayerGoldStr(),this._goldNumTxt.x=n.x+n.width,this._goldNumTxt.y=a.y+a.height/2-this._goldNumTxt.height/2-3,this.addChild(this._goldNumTxt);var o=BaseBitmap.create("servant_infobg");o.y=-20,this._nodeContainer.addChild(o);var s=BaseLoadBitmap.create(t.fullImgPath);s.width=405,s.height=467,s.anchorOffsetY=s.height,s.x=120,s.y=o.y+o.height-50,this._nodeContainer.addChild(s);var r=BaseBitmap.create("servant_alv_namebg");r.x=20,r.y=20,this._nodeContainer.addChild(r),this._alvImg=BaseLoadBitmap.create("servant_alv_1"),this._alvImg.width=91,this._alvImg.height=81,this._alvImg.x=r.x+r.width/2-this._alvImg.width/2+5,this._alvImg.y=r.y-20,this._alvImg.visible=!1,t.clv>0&&(this._alvImg.setload("servant_alv_"+t.clv),this._alvImg.visible=!0),this._nodeContainer.addChild(this._alvImg);var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_COMMON);this._nameTxt=l,l.multiline=!0,l.width=26,this._nameTxt.textColor=ServantScrollItem.getQualityColor(this._servantInfoObj.clv),l.text=LanguageManager.getlocal("servant_name"+this._servantId),l.x=r.x+r.width/2-l.width/2,this._alvImg.visible?l.y=this._alvImg.y+90:l.y=this._alvImg.y+60,l.name="nameTxt",this._nodeContainer.addChild(l);
var h=BaseBitmap.create("servant_mask");h.width=o.width,h.x=GameConfig.stageWidth/2-h.width/2,h.y=o.y+o.height-h.height,this._nodeContainer.addChild(h);var d=BaseBitmap.create("servant_attributemap");d.x=180,d.y=380,this._nodeContainer.addChild(d);var g=BaseBitmap.create("servant_downbg");g.x=0,g.y=445,this._nodeContainer.addChild(g);var c=BaseBitmap.create("servant_levebg");c.x=5,c.y=445,this._nodeContainer.addChild(c);var p=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);p.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,p.text=LanguageManager.getlocal("servant_infoLv"),p.x=22,p.y=455,this._nodeContainer.addChild(p);for(var _=0;4>_;_++){var u=BaseBitmap.create("servant_attribute"+(_+1)),C=_%2;u.x=90+180*C,u.y=460+32*Math.floor(_/2),this._nodeContainer.addChild(u)}this._progressBar=ComponentManager.getProgressBar("progress3","progress3_bg",460),this._progressBar.x=10,this._progressBar.y=530,this._progressBar.setTextSize(18),this._progressBar.setPercentage(this._servantInfoObj.hasexp/this._curLvNeedGold),this._nodeContainer.addChild(this._progressBar);var f=BaseBitmap.create("hold_dinner_box");f.x=480,f.y=465,this._nodeContainer.addChild(f);var m=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);m.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,m.text=LanguageManager.getlocal("servantInfo_tenTips"),m.x=525,m.y=470,m.size=24,this._nodeContainer.addChild(m),this._checkFlag=BaseLoadBitmap.create("hold_dinner_check"),this._checkFlag.width=this._checkFlag.height=38,this._checkFlag.x=480,this._checkFlag.y=m.y-10,this._checkFlag.alpha=e.CALPHA,this._nodeContainer.addChild(this._checkFlag),this._checkFlag.addTouchTap(this.changeCheckFlagStatus,this),this.changeProgressText();for(var T=i.speciality,y="",v=0;v<T.length;v++){var A=T[v];y+=LanguageManager.getlocal("servantInfo_speciality"+A),v<T.length-1&&(y+=" , ");var w=BaseBitmap.create("servant_speciality"+A);w.x=520+50*v,w.y=40,this._nodeContainer.addChild(w)}this._servantProCfg=[{txt:this.getProStringWithProId(1),txtcolor:TextFieldConst.COLOR_QUALITY_ORANGE,txtId:1},{txt:LanguageManager.getlocal("servant_infoSpecialty")+y,txtcolor:TextFieldConst.COLOR_QUALITY_ORANGE,txtId:2},{txt:this.getProStringWithProId(3),txtcolor:TextFieldConst.COLOR_QUALITY_ORANGE,txtId:3},{txt:this.getProStringWithProId(4),txtcolor:14538183,txtId:4},{txt:this.getProStringWithProId(5),txtcolor:14538183,txtId:5},{txt:this.getProStringWithProId(6),txtcolor:14538183,txtId:6},{txt:this.getProStringWithProId(7),txtcolor:14538183,txtId:7}];var x=f.x+30,I=f.y+35,L=ComponentManager.getButton("servant_detailBtn","",this.detailClickHandler,this);L.x=400,L.y=380,this._nodeContainer.addChild(L);for(var v=0;v<this._servantProCfg.length;v++){var A=this._servantProCfg[v],E=ComponentManager.getTextField("",22,A.txtcolor);1==v?E.text=A.txt:E.text=this.getProStringWithProId(A.txtId),E.x=x,E.y=I,1==A.txtId&&(E.x=5,E.y=475,E.width=80,E.textAlign="center",E.size=42,E.textColor=TextFieldConst.COLOR_LIGHT_YELLOW),2==A.txtId&&(E.visible=!1),3==A.txtId&&(E.x=210,E.y=392,E.width=190,E.size=26,E.textAlign="center",E.textColor=TextFieldConst.COLOR_LIGHT_YELLOW),4==A.txtId&&(E.x=160,E.y=465,E.size=24,E.textColor=TextFieldConst.COLOR_WHITE),5==A.txtId&&(E.x=340,E.y=465,E.size=24,E.textColor=TextFieldConst.COLOR_WHITE),6==A.txtId&&(E.x=160,E.y=495,E.size=24,E.textColor=TextFieldConst.COLOR_WHITE),7==A.txtId&&(E.x=340,E.y=495,E.size=24,E.textColor=TextFieldConst.COLOR_WHITE),this._nodeContainer.addChild(E),I+=28,this._proTxtList.push(E)}var B=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"",this.levelupBtnClickHandler,this);this._servantInfoObj.isLvEnableForAdvance()?B.setText("servant_clvUpBtn"):B.setText("servantInfoLevelup"),B.x=480,B.y=505,B.setColor(TextFieldConst.COLOR_BLACK),this._nodeContainer.addChild(B),this._levelupBtn=B,this.changeLvBtnStatus();var S=o.y+o.height;if(S+this.container.y+406>GameConfig.stageHeigth){var N=554-o.height-this.container.y;N=N>=0?0:N,o.y=N+50,o.mask=new egret.Rectangle(0,this.container.y-50,GameConfig.stageWidth,o.height),this._bottomnodeContainer.y=565,s.y=o.y+o.height-50}else this._bottomnodeContainer.y=565;this._progressBar.y=530;var M=0,b=BaseBitmap.create("servant_bottombg");b.x=0,b.y=M;var O=(Math.ceil(i.ability.length/2),GameConfig.stageHeigth-this._bottomnodeContainer.y-this.container.y);b.height=O,this._bottomnodeContainer.addChild(b),this._bottomBg=b;var V=["servant_info_tab1","servant_info_tab2","servant_info_tab3"];i.wifeId&&V.push("servant_info_tab5"),i.aura&&V.push("servant_info_tab4");var R=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,V,this.tabBtnClickHandler,this);R.setSpace(2),R.x=30,R.y=24,this._bottomnodeContainer.addChild(R);for(var v=0;v<V.length;v++){var k=new BaseDisplayObjectContainer;this._bottomNodeList.push(k),this._bottomnodeContainer.addChild(k)}var P=GameConfig.stageHeigth-this._bottomnodeContainer.y-this.container.y;this.initBookInfo(this._bottomNodeList[0],P),this.iniSkillInfo(this._bottomNodeList[1],P),this.initItemsInfo(this._bottomNodeList[2],P),i.wifeId&&this.initWifeInfo(this._bottomNodeList[3],P),i.aura&&this.initFourInfo(this._bottomNodeList[3],P),this.tabBtnClickHandler({index:0}),this.checkRedPoints()},e.prototype.initBookInfo=function(t,e){var i=new ServantInfoBookItems;if(i.init(this._servantId,e),t.addChild(i),Api.rookieVoApi.isInGuiding){var a=i.localToGlobal(i.y,20);Api.rookieVoApi.waitingPosY=a.y+90}},e.prototype.initWifeInfo=function(t,e){var i=new ServantInfoWifeItem;i.init(this._servantId,e),t.addChild(i)},e.prototype.iniSkillInfo=function(t,e){var i=new ServantInfoSkillsItem;i.init(this._servantId,e),t.addChild(i)},e.prototype.initFourInfo=function(t,e){var i=new ServantInfoFourItems;i.init(this._servantId,e),t.addChild(i)},e.prototype.initItemsInfo=function(t,e){var i=new ServantInfoItems;i.init(this._servantId,e),t.addChild(i)},e.prototype.checkRedPoints=function(){this._servantInfoObj=Api.servantVoApi.getServantObj(this._servantId);var t=this._bottomnodeContainer.getChildByName("skillRedP");t||(t=BaseBitmap.create("public_dot2"),t.x=298,t.y=24,t.name="skillRedP",this._bottomnodeContainer.addChild(t)),t.visible=this._servantInfoObj.isSkillLvUpEnable();var e=this._bottomnodeContainer.getChildByName("bookRedP");e||(e=BaseBitmap.create("public_dot2"),e.x=150,e.y=24,e.name="bookRedP",this._bottomnodeContainer.addChild(e)),e.visible=this._servantInfoObj.isBookLvUpEnable();var i=this._nodeContainer.getChildByName("advRedP");i||(i=BaseBitmap.create("public_dot2"),i.x=this._levelupBtn.x+this._levelupBtn.width-15,i.y=this._levelupBtn.y-5,i.name="advRedP",this._nodeContainer.addChild(i)),i.visible=this._servantInfoObj.isAdvanceEnable();var a=this._bottomnodeContainer.getChildByName("itemRedP");a||(a=BaseBitmap.create("public_dot2"),a.x=450,a.y=24,a.name="itemRedP",this._bottomnodeContainer.addChild(a)),a.visible=Api.servantVoApi.isShowRedForItem();var n=GameConfig.config.servantCfg[this._servantId];if(n.aura){var o=this._bottomnodeContainer.getChildByName("auraRedP");o||(o=BaseBitmap.create("public_dot2"),o.x=600,o.y=24,o.name="auraRedP",this._bottomnodeContainer.addChild(o)),o.visible=this._servantInfoObj.isShowRedForaura()}},e.prototype.changeCheckFlagStatus=function(){this._checkFlag.alpha=(this._checkFlag.alpha+1)%2,e.CALPHA=this._checkFlag.alpha,1==this._checkFlag.alpha&&App.CommonUtil.showTip(LanguageManager.getlocal("servantInfo_tenTips2")),this.changeProgressText()},e.prototype.changeProgressText=function(){var t=this._curLvNeedGold-this._servantInfoObj.hasexp,e="servantInfo_levelupNeed";if(1==this._checkFlag.alpha){e="servantInfo_levelupNeed2";for(var i=this._servantInfoObj.level,a=i;i+9>a;a++){var n=GameConfig.config.servantbaseCfg.upgradeNeed[a];if(!n)break;t+=n}}this._progressBar.setText(LanguageManager.getlocal(e)+t+LanguageManager.getlocal("servantInfo_levelupNeedGold"))},e.prototype.tabBtnClickHandler=function(t){for(var e=0;e<this._bottomNodeList.length;e++)this._bottomNodeList[e].visible=!1;this._bottomNodeList[t.index].visible=!0},e.prototype.getProStringWithProId=function(t){return this._servantInfoObj?1==t?App.StringUtil.changeIntToText(this._servantInfoObj.level):3==t?LanguageManager.getlocal("servant_infoAttr")+App.StringUtil.changeIntToText(this._servantInfoObj.total):4==t?App.StringUtil.changeIntToText(this._servantInfoObj.attrVo.forceTotal):5==t?App.StringUtil.changeIntToText(this._servantInfoObj.attrVo.brainsTotal):6==t?App.StringUtil.changeIntToText(this._servantInfoObj.attrVo.politicsTotal):7==t?App.StringUtil.changeIntToText(this._servantInfoObj.attrVo.charmTotal):"":void 0},e.prototype.refreshInfoAfterUpdate=function(t){Api.rookieVoApi.checkNextStep(),this._servantInfoObj.isLvEnableForAdvance()?this._levelupBtn.setText("servant_clvUpBtn"):this._levelupBtn.setText("servantInfoLevelup");var e=this._nodeContainer.getChildByName("nameTxt");this._nodeContainer.addChild(e),this._servantInfoObj.clv>0?(this._alvImg.setload("servant_alv_"+this._servantInfoObj.clv),this._alvImg.visible=!0,e.y=this._alvImg.y+90):(this._alvImg.visible=!1,e.y=this._alvImg.y+60),this._nameTxt.textColor=ServantScrollItem.getQualityColor(this._servantInfoObj.clv),this._goldNumTxt.text=Api.playerVoApi.getPlayerGoldStr(),this._servantInfoObj=Api.servantVoApi.getServantObj(this._servantId),this._curLvNeedGold=GameConfig.config.servantbaseCfg.upgradeNeed[this._servantInfoObj.level-1],this.changeProgressText();var i=this._servantInfoObj.hasexp/this._curLvNeedGold,a=this._progressBar.getPercent(),n=500;if(this._oldLv<this._servantInfoObj.level){var o=this._servantInfoObj.level-this._oldLv;egret.Tween.get(this._progressBar,{loop:!1}).to({percent:1},(1-a)*n).set({percent:0},0).to({percent:i},n*i),1==t.data.ret&&t.data.data.data.lucky&&App.CommonUtil.showGodbless("servantLv"),this.showUpgradeEffect(o)}else egret.Tween.get(this._progressBar,{loop:!1}).to({percent:i},(i-a)*n);this.changeLvBtnStatus(),this.checkRedPoints(),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_FUNCTION_TXT)},e.prototype.changeLvBtnStatus=function(){this._servantInfoObj.isAdvanceEnable()?App.DisplayUtil.changeToNormal(this._levelupBtn):this._curLvNeedGold-this._servantInfoObj.hasexp>Api.playerVoApi.getPlayerGold()||this._servantInfoObj.isAtTopLv()?App.DisplayUtil.changeToGray(this._levelupBtn):App.DisplayUtil.changeToNormal(this._levelupBtn)},e.prototype.refreshServantProTxt=function(){for(var t=0;t<this._servantProCfg.length;t++){var e=this._servantProCfg[t],i=this._proTxtList[t];1==t?i.text=e.txt:i.text=this.getProStringWithProId(e.txtId)}this.checkRedPoints()},e.prototype.showUpgradeEffect=function(t){SoundManager.playEffect(SoundConst.EFFECT_UPD);var e=ComponentManager.getBitmapText(LanguageManager.getlocal("servant_xLv",[String(t)]),TextFieldConst.FONTNAME_BOSS_SCORE);e.x=240,e.y=200;var i=ComponentManager.getCustomMovieClip("servant_upgrade_frame",5,100);i.setScale(2),i.x=110,i.y=20,this._nodeContainer.addChild(i),i.playWithTime(1),this._nodeContainer.addChild(e),egret.Tween.get(e,{loop:!1}).to({y:150},800).to({alpha:0},100);var a=this;egret.Tween.get(this,{loop:!1}).wait(500).call(function(){a._goldNumTxt.text=Api.playerVoApi.getPlayerGoldStr(),a.refreshServantProTxt(),a._nodeContainer.removeChild(i),i=null,a._nodeContainer.removeChild(e),e=null})},e.prototype.detailClickHandler=function(){Api.rookieVoApi.getIsGuiding()||ViewController.getInstance().openView(ViewConst.POPUP.SERVANTATTRDETAILPOPUPVIEW,this._servantId)},e.prototype.levelupBtnClickHandler=function(){if(this._servantInfoObj.isLvEnableForAdvance())return void ViewController.getInstance().openView(ViewConst.POPUP.SERVANTADVANCEPOPUPVIEW,this._servantId);var t=egret.getTimer();if(!(t-this._lastUseTime<800)){if(this._lastUseTime=t,this._servantInfoObj.isAtTopLv())return void App.CommonUtil.showTip(LanguageManager.getlocal("servantInfo_levelupTip1"));if(0==Api.playerVoApi.getPlayerGold())return void App.CommonUtil.showTip(LanguageManager.getlocal("servantInfo_levelupTip3"));this._oldLv=this._servantInfoObj.level,0==this._checkFlag.alpha?NetManager.request(NetRequestConst.REQUEST_UPGRADE_SERVANT,{servantId:this._servantId}):NetManager.request(NetRequestConst.REQUEST_UPGRADE_SERVANT_TEN,{servantId:this._servantId})}},e.prototype.hide=function(){Api.rookieVoApi.isInGuiding&&(Api.rookieVoApi.checkWaitingGuide(),ViewController.getInstance().getView(ViewConst.COMMON.SERVANTVIEW).hide()),t.prototype.hide.call(this)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["servant_topresbg","servant_probigbg","servant_detailBtn","servant_bottombg","progress3","progress3_bg","servant_namebg","servant_infobg","servant_infoPro1","servant_infoPro2","servant_infoPro3","servant_infoPro4","servant_infoTabbg","servant_upgrade_frame","levelup_lizi","levelup_lizi_json","servant_mask","servant_probigbg2","servant_alv_namebg","guide_hand","servant_downbg","servant_attribute1","servant_attribute2","servant_attribute3","servant_attribute4","servant_attributemap","servant_levebg","servant_speciality1","servant_speciality2","servant_speciality3","servant_speciality4","servant_speciality5","servant_speciality6","hold_dinner_box"])},e.prototype.showHand=function(){this._clickHand=BaseBitmap.create("guide_hand"),this._clickHand.skewY=180,this._clickHand.x=620,this._clickHand.y=50,this.addChild(this._clickHand),egret.Tween.get(this._clickHand,{loop:!0}).to({scaleX:.9,scaleY:.9},500).to({scaleX:1,scaleY:1},500)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_UPGRADE_SERVANT),this.refreshInfoAfterUpdate,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_UPGRADE_SERVANT_TEN),this.refreshInfoAfterUpdate,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USE_ITEM),this.refreshServantProTxt,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_CHANGE),this.refreshInfoAfterUpdate,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPABILITY),this.refreshServantProTxt,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPSKILL),this.refreshServantProTxt,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_GUIDE_SHOWHAND,this.showHand,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPAURA),this.refreshServantProTxt,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_REFRESH_SERVANT_ITEMLIST,this.checkRedPoints,this),this._nodeContainer=null,this._goldNumTxt=null,this._servantId="",this.param=null,this._leveupNeedTxt=null,this._servantInfoObj=null,this._proTxtList=null,this._servantProCfg=null,this._progressBar=null,this._checkFlag=null,this._bottomNodeList=[],this._bottomBg=null,this._levelupBtn=null,this._nameTxt=null,this._alvImg=null,this._oldLv=null,this._bottomnodeContainer=null,this._curLvNeedGold=null,this._lastUseTime=null,this._clickHand=null,this._clickHand&&(egret.Tween.removeTweens(this._clickHand),this._clickHand=null),t.prototype.dispose.call(this)},e.CALPHA=0,e}(CommonView);__reflect(ServantInfoView.prototype,"ServantInfoView");var ServantInfoWifeItem=function(t){function e(){var e=t.call(this)||this;return e._servantId=null,e._wifeId=null,e._scrollView=null,e}return __extends(e,t),e.prototype.init=function(t,e){this._servantId=t;var i=Config.ServantCfg.getServantItemById(this._servantId);this._wifeId=i.wifeId;var a=Config.WifeCfg.getWifeCfgById(this._wifeId),n=(a.wifeSkill,BaseBitmap.create("public_line3"));n.width=520,n.x=GameConfig.stageWidth/2-n.width/2,n.y=90,this.addChild(n);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);o.textColor=TextFieldConst.COLOR_BROWN;var s="";s=Api.wifeVoApi.getWifeInfoVoById(this._wifeId)?LanguageManager.getlocal("servant_wife_own"):LanguageManager.getlocal("servant_wife_not_own"),o.text=LanguageManager.getlocal("servant_wifeTip",[a.name,s]),o.x=GameConfig.stageWidth/2-o.width/2,o.y=n.y+n.height/2-o.height/2,this.addChild(o);var r=(Api.wifeVoApi.getWifeInfoVoById(this._wifeId),Config.WifeCfg.getWifeCfgById(this._wifeId).wifeSkill),l=new egret.Rectangle(0,0,GameConfig.stageWidth,e-150);ServantInfoWifeItemScrollItem.servantId=this._servantId;var h=ComponentManager.getScrollList(ServantInfoWifeItemScrollItem,r,l);h.y=120,h.x=24,this._scrollView=h,this.addChild(h)},e.prototype.servantWifeLevelupHandler=function(){},e.prototype.dispose=function(){this._scrollView=null,this._servantId=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(ServantInfoWifeItem.prototype,"ServantInfoWifeItem");var ServantInfoWifeItemScrollItem=function(t){function e(){var e=t.call(this)||this;return e._wifeindex=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_UPGRADESKILL),this.refreshAfterLv,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_LOVE),this.refreshAfterLv,this),this._wifeindex=t;var i=(Config.WifeCfg.getWifeCfgById(this._wifeId),BaseBitmap.create("public_9_managebg"));i.width=592,i.height=84,i.y=0,this.addChild(i);var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);a.textColor=TextFieldConst.COLOR_QUALITY_ORANGE,a.x=i.x+20,a.y=i.y+10,a.name="skillName",this.addChild(a);var n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);n.x=a.x,n.y=a.y+25,n.name="curValueTxt",this.addChild(n);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);o.x=a.x,o.y=n.y+25,o.name="nextValueTxt",this.addChild(o);var s=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"servantWife_goBtn",this.goBtnHandler,this);s.x=i.x+i.width-140,s.y=i.y+i.height/2-s.height/2,s.name="goBtn",s.visible=!1,this.addChild(s),this._topLvTxt=ComponentManager.getTextField(LanguageManager.getlocal("wifeSkillMaxShow"),TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_WARN_RED),this._topLvTxt.x=s.x+s.width/2-this._topLvTxt.width/2,this._topLvTxt.y=s.y+s.height/2-this._topLvTxt.height/2,this._topLvTxt.visible=!1,this.addChild(this._topLvTxt),this.refreshAfterLv()},e.prototype.refreshAfterLv=function(){var t=e.servantId,i=Config.ServantCfg.getServantItemById(t);this._wifeId=i.wifeId;var a=Api.wifeVoApi.getWifeInfoVoById(this._wifeId),n=1;a&&(n=a.skill[this._wifeindex]);var o=Config.WifeCfg.getWifeCfgById(this._wifeId).wifeSkill,s=o[this._wifeindex],r="",l="",h="";if(4==s.att.length)h=i.name+LanguageManager.getlocal("wifeSkillAllAttAdd");else{for(var d=0;d<s.att.length;d++){var g=s.att[d];h=0==d?LanguageManager.getlocal("servantInfo_speciality"+g):h+"、"+LanguageManager.getlocal("servantInfo_speciality"+g)}h=i.name+h+LanguageManager.getlocal("wifeSkillAttAdd")}var c=11645361,p=TextFieldConst.COLOR_WARN_GREEN,_="",u=!1,C="",f=!1;if(a&&s.condition<=a.intimacy){u=!0,c=TextFieldConst.COLOR_WHITE;var m="",T="",y=this._wifeindex+1,v=1;n>=Config.WifebaseCfg.wifeSkillMax&&(y=this._wifeindex,v=0,f=!0),s.growAtt<1?(m=100*s.growAtt*n+"%",T=100*s.growAtt*(n+v)+"%"):(m=(s.growAtt*n).toString(),T=(s.growAtt*(n+v)).toString());var A=Config.WifebaseCfg["wifeSkill"+(this._wifeindex+1)][n-1];A<=a.exp&&(C=LanguageManager.getlocal("servantWife_goBtnEnable")),_=m,r=LanguageManager.getlocal("wifeSkillCur")+h+m,l=LanguageManager.getlocal("wifeSkillNext")+h+T}else{u=!1;var m="";m=s.growAtt<1?100*s.growAtt*n+"%":(s.growAtt*n).toString(),p=11645361,r=LanguageManager.getlocal("wifeSkillLock")+h+m,l=LanguageManager.getlocal("wifeSkillUnLockNeed")+s.condition}var w=this.getChildByName("goBtn"),x=this.getChildByName("skillName"),I=this.getChildByName("curValueTxt"),L=this.getChildByName("nextValueTxt"),E=LanguageManager.getlocal("wifeSkill_"+this._wifeId+"_"+(this._wifeindex+1));x.text=LanguageManager.getlocal("servant_wifeSkillName",[String(this._wifeindex+1),E,String(n),C]),I.text=r,L.text=l,u?(w.visible=!0,x.textColor=TextFieldConst.COLOR_QUALITY_YELLOW,I.textColor=c,L.textColor=c,f?(this._topLvTxt.visible=!0,w.visible=!1):(this._topLvTxt.visible=!1,w.visible=!0)):(w.visible=!1,x.textColor=TextFieldConst.COLOR_BLACK,I.textColor=TextFieldConst.COLOR_BLACK,L.textColor=TextFieldConst.COLOR_BLACK)},e.prototype.goBtnHandler=function(){var t=this._wifeId;ViewController.getInstance().openView(ViewConst.COMMON.WIFEOPTVIEW,{id:t,handler:this})},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_UPGRADESKILL),this.refreshAfterLv,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_LOVE),this.refreshAfterLv,this),this._wifeindex=0,this._wifeId=null,t.prototype.dispose.call(this)},e.servantId="",e}(ScrollListItem);__reflect(ServantInfoWifeItemScrollItem.prototype,"ServantInfoWifeItemScrollItem");var ServantScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,i){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_UPGRADE_SERVANT),this.refreshInfoAfterUpdate,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_UPGRADE_SERVANT_TEN),this.refreshInfoAfterUpdate,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_CHANGE),this.refreshInfoAfterAdvance,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPABILITY),this.refreshRedPoints,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPSKILL),this.refreshRedPoints,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_REFRESH_SERVANT_ITEMLIST,this.refreshRedPoints,this),this._servantId=i;var a=Api.servantVoApi.getServantObj(this._servantId);GameConfig.config.servantCfg[this._servantId];this._nodeContainer=new BaseDisplayObjectContainer,this._nodeContainer.x=11,this.addChild(this._nodeContainer);var n=BaseLoadBitmap.create(a.qualityBoxImgPath);n.width=194,n.height=192,n.name="cardbg",this._nodeContainer.addChild(n),n.touchEnabled=!0,this._selectedBox=BaseBitmap.create("servant_cardbg_selected"),this._selectedBox.x=n.width/2-this._selectedBox.width/2,this._selectedBox.y=n.height/2-this._selectedBox.height/2,this._selectedBox.visible=!1,this._nodeContainer.addChild(this._selectedBox),this._cardbg=n,this.addTouch(this.eventHandler,this,null,!0);var o=BaseLoadBitmap.create(a.halfImgPath);o.width=180,o.height=177,o.x=n.x+n.width/2-o.width/2,o.y=n.y+n.height/2-o.height/2-2,this._nodeContainer.addChild(o);var s=BaseBitmap.create("servant_namebg");s.x=n.x+n.width/2-s.width/2,s.y=n.y+n.height-s.height-7,this._nodeContainer.addChild(s);var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);r.textColor=e.getQualityColor(a.clv),r.text=LanguageManager.getlocal("servant_name"+this._servantId),r.x=n.x+n.width/2-r.width/2,r.y=s.y+s.height-r.height/2-15,this._nodeContainer.addChild(r),this._nameTxt=r;var l=BaseBitmap.create("servant_lvbg");l.x=5,l.y=5,this._nodeContainer.addChild(l),this._lvTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL),this._lvTxt.text=LanguageManager.getlocal("servant_lv",[String(a.level)]),this._lvTxt.x=17,this._lvTxt.y=l.y+l.height/2-this._lvTxt.height/2,this._nodeContainer.addChild(this._lvTxt);var h=BaseBitmap.create("servant_starbg");h.x=n.x+n.width/2-h.width/2,h.y=s.y-h.height-2,this._nodeContainer.addChild(h);var d=BaseBitmap.create("servant_star");d.x=n.x+n.width/2-d.width/2-15,d.y=h.y+h.height/2-d.height/2,this._nodeContainer.addChild(d);var g=Api.servantVoApi.getServantStarsNumWithId(this._servantId),c=ComponentManager.getTextField(g.toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL);c.x=d.x+d.width+2,c.y=h.y+h.height/2-c.height/2,this._nodeContainer.addChild(c);var p=BaseBitmap.create("public_dot2");p.x=n.x+n.width-p.width,p.y=n.y,p.name="redP",p.visible=!1,this._nodeContainer.addChild(p),this.refreshRedPoints()},e.prototype.refreshRedPoints=function(){var t=Api.servantVoApi.getServantObj(this._servantId);this._nodeContainer.getChildByName("redP").visible=t.isShowRedInServantList()},e.prototype.refreshInfoAfterUpdate=function(){var t=Api.servantVoApi.getServantObj(this._servantId);this._lvTxt.text=t.level.toString(),this.refreshRedPoints()},e.prototype.refreshInfoAfterAdvance=function(){var t=Api.servantVoApi.getServantObj(this._servantId),i=this._nodeContainer.getChildByName("cardbg");i.setload(t.qualityBoxImgPath),this._nameTxt.textColor=e.getQualityColor(t.clv),this.refreshRedPoints()},e.prototype.eventHandler=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._selectedBox.visible=!0;break;case egret.TouchEvent.TOUCH_CANCEL:this._selectedBox.visible=!1;break;case egret.TouchEvent.TOUCH_END:this._selectedBox.visible=!1,ViewController.getInstance().openView(ViewConst.COMMON.SERVANTINFOVIEW,this._servantId)}},e.prototype.getSpaceX=function(){return 10},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_UPGRADE_SERVANT),this.refreshInfoAfterUpdate,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_UPGRADE_SERVANT_TEN),this.refreshInfoAfterUpdate,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_CHANGE),this.refreshInfoAfterAdvance,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPABILITY),this.refreshRedPoints,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SERVANT_UPSKILL),this.refreshRedPoints,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_REFRESH_SERVANT_ITEMLIST,this.refreshRedPoints,this),this._nodeContainer=null,this._cardbg=null,this._lvTxt=null,this._servantId=null,this._selectedBox=null,this._nameTxt=null,t.prototype.dispose.call(this)},e.getQualityColor=function(t){var e=TextFieldConst.COLOR_QUALITY_WHITE;switch(t){case 1:e=TextFieldConst.COLOR_QUALITY_GREEN;break;case 2:e=TextFieldConst.COLOR_QUALITY_BLUE;break;case 3:e=TextFieldConst.COLOR_QUALITY_PURPLE;break;case 4:e=TextFieldConst.COLOR_QUALITY_RED;break;case 5:e=TextFieldConst.COLOR_QUALITY_ORANGE;break;case 6:e=TextFieldConst.COLOR_QUALITY_YELLOW;break;default:e=TextFieldConst.COLOR_QUALITY_GRAY}return e},e.QUALITYCFG=[TextFieldConst.COLOR_QUALITY_WHITE,16766581,13266170],e}(ScrollListItem);__reflect(ServantScrollItem.prototype,"ServantScrollItem");var ResourceManager;!function(t){function e(t,e,i,a,n){App.ResourceUtil.loadGroup(t,e,i,a,n)}function i(t,e,i){App.ResourceUtil.loadItem(t,e,i)}function a(t,e,i,a){App.ResourceUtil.loadItemByUrl(t,e,i,a)}function n(t,e,i,a,n,o){return App.ResourceUtil.loadResource(t,e,i,a,n,o)}function o(t){var e=RES.getRes(t);if(e){var i=Scale9gridCfg.getScale9gridCfg(t);if(i&&!e.scale9Grid){var a=egret.Rectangle.create(),n=i.split(",");a.setTo(Number(n[0]),Number(n[1]),Number(n[2]),Number(n[3])),e.scale9Grid=a}}return RES.getRes(t)}function s(t){return RES.getRes(t)?!0:!1}function r(t){RES.destroyRes(t,!1)}function l(){}function h(){}t.loadGroup=e,t.loadItem=i,t.loadItemByUrl=a,t.loadResources=n,t.getRes=o,t.isItemLoaded=s,t.destroyRes=r,t.dispose=l,t.autoLoadRes=h}(ResourceManager||(ResourceManager={}));var ServantView=function(t){function e(){var e=t.call(this)||this;return e._lastDropIdx=1,e._scrollList=null,e}return __extends(e,t),e.prototype.initView=function(){this._dropBtnList=[],this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer),this._lastDropIdx=Api.otherInfoVoApi.getServantSortId();var t=BaseBitmap.create("public_bg6");t.y=-20,this._nodeContainer.addChild(t);var i=t.height-t.y,a=BaseBitmap.create("public_9_bg24");a.width=GameConfig.stageWidth-10,a.height=GameConfig.stageHeigth-i-80,a.x=5,a.y=i-35,this._nodeContainer.addChild(a);var n=BaseBitmap.create("servant_topnumbg");n.x=20,n.y=t.y+t.height/2-n.height/2,this._nodeContainer.addChild(n);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);o.textColor=TextFieldConst.COLOR_WHITE,o.size=24,o.text=LanguageManager.getlocal("servant_count")+Api.servantVoApi.getServantCount(),o.x=n.x+n.width/2-o.width/2,o.y=t.y+t.height/2-o.height/2,this._nodeContainer.addChild(o),this._dropDownBtn=ComponentManager.getButton("servant_dropBtn","",this.dropDownBtnClickHandler,this,[0]),this._dropDownBtn.x=GameConfig.stageWidth-this._dropDownBtn.width-20,this._dropDownBtn.y=o.y+o.height/2-this._dropDownBtn.height/2,this._dropDownBtn.setColor(e.DROPBTN_COLOR1),this._nodeContainer.addChild(this._dropDownBtn),this._dropDownBtn.setText("servant_dropTxt"+this._lastDropIdx),this._dropBtnList.push(this._dropDownBtn),this._dropDownFlag=BaseBitmap.create("servant_dropIcon"),this._dropDownFlag.anchorOffsetY=this._dropDownFlag.height/2,this._dropDownFlag.x=this._dropDownBtn.x+this._dropDownBtn.width-this._dropDownFlag.width-3,this._dropDownFlag.y=this._dropDownBtn.y+this._dropDownBtn.height-this._dropDownFlag.height/2-10,this._nodeContainer.addChild(this._dropDownFlag),this._dropDownContainer=new BaseDisplayObjectContainer,this._dropDownContainer.visible=!1,this._dropDownContainer.x=this._dropDownBtn.x,this._dropDownContainer.y=this._dropDownBtn.y+this._dropDownBtn.height;for(var s=["servant_dropTxt1","servant_dropTxt2","servant_dropTxt3","servant_dropTxt4"],r=1;r<=s.length;r++){var l=ComponentManager.getButton("servant_dropBtn","",this.dropDownBtnClickHandler,this,[r]);this._dropBtnList.push(l),l.setColor(e.DROPBTN_COLOR1),l.y=l.height*(r-1),this._dropDownContainer.addChild(l),l.setText(s[r-1])}var h=new egret.Rectangle(0,0,GameConfig.stageWidth,GameConfig.stageHeigth-i-100),d=Api.servantVoApi.getServantInfoIdListWithSort(this._lastDropIdx);this._scrollList=ComponentManager.getScrollList(ServantScrollItem,d,h),this._scrollList.y=i-25,this._nodeContainer.addChild(this._scrollList),this._nodeContainer.addChild(this._dropDownContainer),Api.rookieVoApi.checkNextStep()},e.prototype.dropDownBtnClickHandler=function(t){for(var e=this._lastDropIdx,i=1;i<this._dropBtnList.length;i++)this._dropBtnList[i].updateButtonImage(BaseButton.BTN_STATE1);if(this._dropBtnList[this._lastDropIdx].updateButtonImage(BaseButton.BTN_STATE2),this._dropDownContainer.visible?(this._dropDownFlag.scaleY=1,this._dropDownContainer.visible=!1):(this._dropDownFlag.scaleY=-1,this._dropDownContainer.visible=!0),t>0&&(this._dropDownBtn.setText("servant_dropTxt"+t),this._lastDropIdx=t),e!=this._lastDropIdx){var a=Api.servantVoApi.getServantInfoIdListWithSort(t);this._scrollList.refreshData(a)}},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["servant_namebg","servant_dropBtn","servant_dropBtn_down","servant_dropIcon","servant_namebg","servant_star","servant_cardbg_selected","servant_topnumbg","servant_lvbg","servant_starbg"])},e.prototype.hide=function(){this._lastDropIdx!=Api.otherInfoVoApi.getServantSortId()&&NetManager.request(NetRequestConst.REQUEST_OTHER_RECORDSERVANTSORT,{sortId:this._lastDropIdx}),t.prototype.hide.call(this)},e.prototype.getRuleInfo=function(){return"servant_description"},e.prototype.dispose=function(){this._nodeContainer=null,this._dropDownContainer=null,this._scrollList=null,this._dropDownBtn=null,this._dropDownFlag=null,this._dropBtnList=null,this._lastDropIdx=1,t.prototype.dispose.call(this)},e.DROPBTN_COLOR1=16776408,e.DROPBTN_COLOR2=10068916,e}(CommonView);__reflect(ServantView.prototype,"ServantView");var ServerListMyScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=410,this.height=46+this.getSpaceY();var i=TextFieldConst.COLOR_WARN_RED3,a=LanguageManager.getlocal("serverListOld");
1==e.flag&&(a=LanguageManager.getlocal("serverListNew"),i=TextFieldConst.COLOR_WARN_GREEN);var n=BaseBitmap.create("public_9_probiginnerbg");n.width=this.width,n.height=46,n.x=this.width/2-n.width/2,n.y=this.height/2-n.height/2,this.addChild(n);var o="【"+e.zid+LanguageManager.getlocal("serverListServer")+"】",s=ComponentManager.getTextField(o,TextFieldConst.FONTSIZE_TITLE_SMALL);s.textColor=i,s.x=30,s.y=this.height/2-s.height/2,this.addChild(s);var r=ComponentManager.getTextField(e.sname,TextFieldConst.FONTSIZE_TITLE_SMALL);r.textColor=i,r.x=this.width/2-r.width/2,r.y=this.height/2-r.height/2,this.addChild(r);var l=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_TITLE_SMALL);l.textColor=i,l.x=310,l.y=this.height/2-l.height/2,this.addChild(l)},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._serverInfo=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ServerListMyScrollItem.prototype,"ServerListMyScrollItem");var ServerListPopupView=function(t){function e(){var e=t.call(this)||this;return e._tabIndex=-1,e._allServerList=[],e}return __extends(e,t),e.prototype.preInit=function(){var e=this,i=this,a={t:"getserverlist",pid:LoginManager.getLocalUserName()};ServerCfg.checkServerDebug()&&(a.debug=1);var n=PlatformManager.getAppVersion(),o=PlatformManager.getAppid();n&&(a.version=n),o&&(a.channel=o),PlatformManager.checkIsIOSShenheSp()&&(a.isShenhe="1"),NetManager.http.get(ServerCfg.svrCfgUrl,a,function(i){ServerCfg.myserver=i.myserver,ServerCfg.serverlist=i.serverlist,t.prototype.preInit.call(e)},function(){i.preInit()},this)},e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg3");t.width=250,t.x=this.viewBg.x+this.viewBg.width/2-t.width/2,t.y=20,this.addChildToContainer(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("serverListLastLogin"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);e.x=t.x+t.width/2-e.width/2,e.y=t.y+t.height/2-e.height/2,this.addChildToContainer(e);var i=BaseBitmap.create("public_9_bg4");i.width=518,i.height=140,i.x=this.viewBg.x+this.viewBg.width/2-i.width/2,i.y=75,this.addChildToContainer(i);var a=egret.Rectangle.create(),n=ServerCfg.myserver;a.setTo(0,0,410,i.height-20);var o=ComponentManager.getScrollList(ServerListMyScrollItem,n,a);this.addChildToContainer(o),o.x=i.x+i.width/2-o.width/2,o.y=i.y+i.height/2-o.height/2,o.addTouchTap(this.clickItemHandler3,this);var s=BaseBitmap.create("public_9_bg3");s.width=250,s.x=this.viewBg.x+this.viewBg.width/2-s.width/2,s.y=i.y+i.height+10,this.addChildToContainer(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("serverList"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);r.x=s.x+s.width/2-r.width/2,r.y=s.y+s.height/2-r.height/2,this.addChildToContainer(r);var l=BaseBitmap.create("public_9_bg4");l.width=518,l.height=386,l.x=this.viewBg.x+this.viewBg.width/2-l.width/2,l.y=275,this.addChildToContainer(l);var h=BaseBitmap.create("serverlist_line");h.x=203,h.y=l.y+l.height/2-h.height/2,this.addChildToContainer(h);var d=egret.Rectangle.create(),g=ServerCfg.serverlist,c=this.getTabList(g);d.setTo(0,0,160,l.height-20),this._tabScrollList=ComponentManager.getScrollList(ServerListTabScrollItem,c,d),this.addChildToContainer(this._tabScrollList),this._tabScrollList.x=l.x+10,this._tabScrollList.y=l.y+l.height/2-this._tabScrollList.height/2,this._tabScrollList.addTouchTap(this.clickItemHandler,this),this.setSelect(0);var p=egret.Rectangle.create(),_=this.getServerListByIndex(0);p.setTo(0,0,320,l.height-20),this._serverScrollList=ComponentManager.getScrollList(ServerListServerScrollItem,_,p),this.addChildToContainer(this._serverScrollList),this._serverScrollList.x=214,this._serverScrollList.y=l.y+l.height/2-this._tabScrollList.height/2,this._serverScrollList.addTouchTap(this.clickItemHandler2,this)},e.prototype.clickItemHandler=function(t){var e=Number(t.data);this.setSelect(e);var i=this.getServerListByIndex(e);this._serverScrollList.setScrollTop(0),this._serverScrollList.refreshData(i)},e.prototype.clickItemHandler2=function(t){var e=Number(t.data);ServerCfg.setSelectServer(this._curServerList[e].zid),this.hide()},e.prototype.clickItemHandler3=function(t){var e=Number(t.data),i=ServerCfg.myserver;ServerCfg.setSelectServer(i[e].zid),this.hide()},e.prototype.getTabList=function(t){t.sort(function(t,e){return Number(e.zid)-Number(t.zid)});var e=[],i=0,a=t.length,n=0,o=-1;for(i;a>i;i++){var s=Number(t[i].zid);0==i?(o=s%10==0?s:10*Math.ceil(s/10),null==this._allServerList[n]&&(this._allServerList[n]=[t[i]]),i==a-1&&e.push(String(o-9)+"-"+o+LanguageManager.getlocal("serverListServer"))):o-10>=s?(e.push(String(o-9)+"-"+o+LanguageManager.getlocal("serverListServer")),o=s%10==0?s:10*Math.ceil(s/10),n++,null==this._allServerList[n]&&(this._allServerList[n]=[t[i]]),i==a-1&&e.push(String(o-9)+"-"+o+LanguageManager.getlocal("serverListServer"))):i==a-1?(e.push(String(o-9)+"-"+o+LanguageManager.getlocal("serverListServer")),this._allServerList[n]&&this._allServerList[n].push(t[i])):this._allServerList[n]&&this._allServerList[n].push(t[i])}return e},e.prototype.getServerListByIndex=function(t){return this._curServerList=this._allServerList[t],this._curServerList},e.prototype.setSelect=function(t){if(this._tabIndex!=t){if(this._tabIndex=t,this._tabScrollItem&&this._tabScrollItem.getChildByName("itemBg")){var e=this._tabScrollItem.getChildByName("itemBg");e.texture=ResourceManager.getRes("serverbtn_tab")}this._tabScrollItem=this._tabScrollList.getItemByIndex(t);var i=this._tabScrollItem.getChildByName("itemBg");i.texture=ResourceManager.getRes("serverbtn_tab_down")}},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["serverlist_line","serverlist_usericon","public_9_bg3","public_9_bg4","serverbtn_tab","serverbtn_tab_down","public_9_probiginnerbg"])},e.prototype.dispose=function(){this._tabIndex=-1,this._tabScrollList=null,this._serverScrollList=null,this._tabScrollItem=null,this._allServerList.length=0,t.prototype.dispose.call(this)},e}(PopupView);__reflect(ServerListPopupView.prototype,"ServerListPopupView");var ServerListServerScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=320,this.height=46+this.getSpaceY();var i=TextFieldConst.COLOR_WARN_RED3,a=LanguageManager.getlocal("serverListOld");1==e.flag&&(a=LanguageManager.getlocal("serverListNew"),i=TextFieldConst.COLOR_WARN_GREEN);var n=BaseBitmap.create("public_9_probiginnerbg");n.width=this.width,n.height=46,n.x=this.width/2-n.width/2,n.y=this.height/2-n.height/2,this.addChild(n);var o="【"+e.zid+LanguageManager.getlocal("serverListServer")+"】",s=ComponentManager.getTextField(o,TextFieldConst.FONTSIZE_CONTENT_COMMON);s.textColor=i,s.x=20,s.y=this.height/2-s.height/2,this.addChild(s);var r=ComponentManager.getTextField(e.sname,TextFieldConst.FONTSIZE_CONTENT_COMMON);r.textColor=i,r.x=this.width/2-r.width/2,r.y=this.height/2-r.height/2,this.addChild(r);var l=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_COMMON);if(l.textColor=i,l.x=220,l.y=this.height/2-l.height/2,this.addChild(l),1==e.inserver){var h=BaseBitmap.create("serverlist_usericon");h.x=280,h.y=this.height/2-h.height/2,this.addChild(h)}},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){this._serverInfo=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ServerListServerScrollItem.prototype,"ServerListServerScrollItem");var ServerListTabScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=158,this.height=60+this.getSpaceY();var i=BaseBitmap.create("serverbtn_tab");i.x=this.width/2-i.width/2,i.y=this.height/2-i.height/2,i.name="itemBg",this.addChild(i);var a=ComponentManager.getTextField(e,TextFieldConst.FONTSIZE_TITLE_SMALL);a.textColor=TextFieldConst.COLOR_BLACK,a.x=this.width/2-a.width/2,a.y=this.height/2-a.height/2,this.addChild(a)},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(ServerListTabScrollItem.prototype,"ServerListTabScrollItem");var SettingCDKPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,400,45,"public_9_bg5",LanguageManager.getlocal("settingCDKTip"),11645361);t.x=this.viewBg.x+this.viewBg.width/2-t.width/2,t.y=30,this.addChildToContainer(t),this._inputTextField=t.getChildByName("textField");var e=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"settingCDKget",this.sentBtnClick,this);e.x=t.x+t.width/2-e.width/2,e.y=t.y+t.height+20,e.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(e)},e.prototype.sentBtnClick=function(){this._inputTextField.text.length<=0||this.request(NetRequestConst.REQUEST_USER_EXCHANGECARD,{id:this._inputTextField.text})},e.prototype.receiveData=function(t){return 1==t.data.data.flag?void App.CommonUtil.showTip(LanguageManager.getlocal("settingCDKgetMsg1")):2==t.data.data.flag?void App.CommonUtil.showTip(LanguageManager.getlocal("settingCDKgetMsg2")):3==t.data.data.flag?void App.CommonUtil.showTip(LanguageManager.getlocal("settingCDKgetMsg3")):4==t.data.data.flag?void App.CommonUtil.showTip(LanguageManager.getlocal("settingCDKgetMsg4")):void ViewController.getInstance().openView(ViewConst.POPUP.COMMONREWARDPOPUPVIEW,t.data.data.rewards)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(PopupView);__reflect(SettingCDKPopupView.prototype,"SettingCDKPopupView");var SettingContactPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){console.log("QAZ type "+this.param.data.type),2==this.param.data.type&&(this._conMsg="",this.param.data.info.tel&&(this._conMsg=LanguageManager.getlocal("settingContactTF",[this.param.data.info.tel])),this.param.data.info.qq&&(""!=this._conMsg&&(this._conMsg+="\n"),this._conMsg+=LanguageManager.getlocal("welfareViewQQGroup1",[this.param.data.info.qq])),this.param.data.info.qq_group&&(""!=this._conMsg&&(this._conMsg+="\n"),this._conMsg+=LanguageManager.getlocal("welfareViewQQGroup1",[this.param.data.info.qq_group])));var t=ComponentManager.getTextField(this._conMsg,TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_BLACK);t.multiline=!0,t.lineSpacing=5,t.width=500,t.verticalAlign=egret.VerticalAlign.MIDDLE,t.x=50,t.y=40,this.addChildToContainer(t)},e.prototype.getRequestData=function(){return 0==this.param.data.type?{requestType:NetRequestConst.REQUEST_USER_GETKFMSG,requestData:{}}:null},e.prototype.receiveData=function(t){t.data.ret<0||t.data.cmd==NetRequestConst.REQUEST_USER_GETKFMSG&&(this._conMsg=t.data.data.msg)},e.prototype.getShowHeight=function(){return 350},e.prototype.dispose=function(){this._conMsg="",t.prototype.dispose.call(this)},e}(PopupView);__reflect(SettingContactPopupView.prototype,"SettingContactPopupView");var SettingPopopView=function(t){function e(){var e=t.call(this)||this;return e._type="",e._serviceType=0,e}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_probiginnerbg");t.width=520,t.height=230,t.x=this.viewBg.x+this.viewBg.width/2-t.width/2,t.y=25,this.addChildToContainer(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("settingAcountInfo"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);e.x=50,e.y=t.y+20,this.addChildToContainer(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("settingUserName"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);i.x=e.x,i.y=e.y+i.height+15,this.addChildToContainer(i);var a=ComponentManager.getTextField(Api.playerVoApi.getPlayerName(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);if(a.x=i.x+i.width,a.y=i.y,this.addChildToContainer(a),PlatformManager.checkIs3KSubSp()&&0==Api.switchVoApi.checkOpenShenhe()){var n=ComponentManager.getTextField(LanguageManager.getlocal("settingUserGUID"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);n.textFlow=new Array({text:LanguageManager.getlocal("settingUserGUID"),style:{underline:!0}}),n.x=300,n.y=i.y,n.addTouchTap(this.idTouchHandler,this,null),this.addChildToContainer(n)}var o=ComponentManager.getTextField(LanguageManager.getlocal("settingID"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);o.x=e.x,o.y=i.y+o.height+15,this.addChildToContainer(o);var s=ComponentManager.getTextField(Api.playerVoApi.getPlayerID().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);s.x=o.x+o.width,s.y=o.y,this.addChildToContainer(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("settingZone"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);r.x=e.x,r.y=s.y+r.height+15,this.addChildToContainer(r);var l=ComponentManager.getTextField(GameData.curZoneID.toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);l.x=r.x+r.width,l.y=r.y,this.addChildToContainer(l),this._soundText=ComponentManager.getTextField(LanguageManager.getlocal("settingSound"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._soundText.x=e.x,this._soundText.y=l.y+this._soundText.height+30,this.addChildToContainer(this._soundText),this._soundBB=BaseBitmap.create("btn_swicth"),this._soundBB.x=this._soundText.x+this._soundText.width+10,this._soundBB.y=this._soundText.y+this._soundText.height/2-this._soundBB.height/2,this.addChildToContainer(this._soundBB),this._soundBB.addTouchTap(this.sonndHander,this),this._soundState=ComponentManager.getTextField("ON",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._soundState.x=this._soundBB.x+15,this._soundState.y=this._soundBB.y+this._soundBB.height/2-this._soundState.height/2,this.addChildToContainer(this._soundState),this._type=LocalStorageManager.get(LocalStorageConst.LOCAL_SOUND_SWITCH);var h=TextFieldConst.COLOR_WARN_GREEN;""==this._type&&(this._type="ON"),"ON"!=this._type&&(this._soundBB.skewY=180,this._soundBB.x=this._soundBB.x+this._soundBB.width,this._soundState.x=this._soundBB.x-50,h=11645361),this._soundState.text=this._type,this._soundState.textColor=h;var d=0,g=t.x+5,c=t.y+t.height+15,p=function(t){t.x=g+d%3*(t.width+30),t.y=c+70*Math.floor(d/3),d++},_=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"settingChangeAchount",this.changeHandler,this);if(p(_),_.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(_),0==Api.switchVoApi.checkOpenShenhe()&&0==Api.switchVoApi.checkTWShenhe()){var u=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"settingCDK",this.cdkHander,this);p(u),u.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(u)}var C=PlatformManager.getContact();if(this._serviceType=PlatformManager.getCustomerServiceType(),console.log("QAZ fkcw getCustomerServiceType "+this._serviceType),this._serviceType>0||(C&&C.length>0||PlatformManager.checkIsTWBSp()||PlatformManager.checkIs3KSubSp())&&0==Api.switchVoApi.checkOpenShenhe()){var f=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"settingContact",this.contackHander,this);p(f),f.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(f)}if(1==PlatformManager.checkIsTWBSp()&&1==PlatformManager.checkIsWeiduan()){var f=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"settingUserCenter",this.openUserCenter,this);p(f),f.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(f)}var m=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"chatblockViewTitle",this.blockHander,this);if(p(m),m.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(m),PlatformManager.checkIsTWBSp()){var T=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"",this.jumpFacebook,this);T.setText("FB粉絲頁",!1),p(T),T.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(T)}if(PlatformManager.checkIsKRSp()){var y=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"",this.jumpKR1,this);if(y.setText("고객센터",!1),p(y),y.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(y),App.DeviceUtil.isIOS()&&Api.switchVoApi.checkOpenShenhe());else{var v=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"",this.jumpKR2,this);v.setText("역천 카페",!1),p(v),v.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(v)}}},e.prototype.jumpFacebook=function(){App.DeviceUtil.IsHtml5()&&window.open("https://www.facebook.com/com.heyyogame.gd/")},e.prototype.jumpKR1=function(){App.DeviceUtil.IsHtml5()&&window.open("https://yccs.mayngames.co.kr/support")},e.prototype.jumpKR2=function(){App.DeviceUtil.IsHtml5()&&window.open("https://cafe.naver.com/yeokcheon")},e.prototype.idTouchHandler=function(){PlatformManager.client.getGUID()},e.prototype.openUserCenter=function(){PlatformManager.openUserCenter()},e.prototype.changeHandler=function(t){LoginManager.changeServer()},e.prototype.contackHander=function(){0==this._serviceType?ViewController.getInstance().openView(ViewConst.POPUP.SETTINGCONTACTPOPUPVIEW,{type:0}):1==this._serviceType?PlatformManager.client.openServiceCenter():RSDKHelper.getCustomerService(function(t){console.log("QAZ fkcw getCustomerService 结果"+t),t&&ViewController.getInstance().openView(ViewConst.POPUP.SETTINGCONTACTPOPUPVIEW,{type:2,info:t})})},e.prototype.blockHander=function(){ViewController.getInstance().openView(ViewConst.COMMON.CHATBLOCKVIEW,{})},e.prototype.cdkHander=function(){ViewController.getInstance().openView(ViewConst.POPUP.SettingCDKPopupView,{})},e.prototype.sonndHander=function(t){var e=TextFieldConst.COLOR_WARN_GREEN;""==this._type||"ON"==this._type?this._type="OFF":this._type="ON",LocalStorageManager.set(LocalStorageConst.LOCAL_SOUND_SWITCH,this._type),"ON"!=this._type?(this._soundBB.skewY=180,this._soundBB.x=this._soundBB.x+this._soundBB.width,this._soundState.x=this._soundBB.x-50,e=11645361,SoundManager.pauseBg()):(this._soundBB.skewY=0,this._soundBB.x=this._soundText.x+this._soundText.width+10,this._soundState.x=this._soundBB.x+15,SoundManager.resumeBg()),this._soundState.text=this._type,this._soundState.textColor=e},e.prototype.dispose=function(){this._type=null,this._soundBB=null,this._soundState=null,this._type="",this._serviceType=0,t.prototype.dispose.call(this)},e}(PopupView);__reflect(SettingPopopView.prototype,"SettingPopopView");var Shop3ScrollItem=function(t){function e(){var e=t.call(this)||this;return e._shopid=0,e._selectedIndex=0,e._isRequesting=!1,e.itemList=[],e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SHOP_BUY_ITEM),this.buyHandlerCallback,this);var i=600,a=178;this._shopid=e.id,this._selectedIndex=t;var n=Api.shopVoApi.getShopItemCfgById(this._shopid);this._shopItemCfg=n;var o=n.contentList,s=(n.buyCost,""),r=Api.shopVoApi.getCanBuyNumById(n.id);r>=0&&(s=LanguageManager.getlocal("shopLimitBuy2",[r.toString()]));var l=BaseBitmap.create("public_9_bg14");l.width=i,l.height=a,this.addChild(l);var h=BaseBitmap.create("common_titlebg");if(h.y=5,this.addChild(h),n.needVip>0){var d=BaseBitmap.create("public_9_probiginnerbg");d.width=140,d.x=l.x+l.width-d.width-10,d.y=l.y+10,this.addChild(d);var g=BaseBitmap.create("vipLimit_img");g.x=d.x+d.width-g.width-10,g.y=d.y+d.height/2-g.height/2,this.addChild(g);var c=BaseLoadBitmap.create(Api.vipVoApi.getVipCfgByLevel(n.needVip).icon);c.width=77,c.height=29,c.x=g.x-c.width+2,c.y=g.y,this.addChild(c)}var p=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);p.text=n.name,p.x=h.x+20,p.name=n.name,p.y=h.y+10,this.addChild(p);var _=BaseBitmap.create("public_9_managebg");_.width=425,_.height=107,_.x=l.x+15,_.y=h.y+h.height+5,this.addChild(_);for(var u=_.y+5,C=_.x+8,f=.88,t=0;t<o.length;t++){var m=o[t];m.id>=1801&&m.id<=1804&&(m.id+=4);var T=GameData.getItemIcon(m,!0);T.setScale(f),T.x=C,T.y=u,C+=T.width*f+7,C>_.x+_.width-5&&(C=_.x+8,u+=T.height*f+5,T.x=C,T.y=u,C+=T.width*f+7),this.addChild(T),this.itemList.push(T)}u+=100,_.height=u-_.y+2,_.width-=5,l.height=_.y+_.height+23;var y=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"acPunishBuyItemBuy",this.buyHandler,this);y.setText(n.buyCost.toString(),!1),y.addTextIcon("public_icon1"),y.x=l.x+l.width-y.width-20,y.y=_.y+_.height-y.height-30,y.name="buyBtn",this.addChild(y),""!=s&&(this._limitNumTF=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_RED),this.update(),this._limitNumTF.x=y.x+y.width/2-this._limitNumTF.width/2,this._limitNumTF.y=_.y+_.height-this._limitNumTF.height,this.addChild(this._limitNumTF));var v=ComponentManager.getTextField(LanguageManager.getlocal("originalPriceTitle")+":",18,TextFieldConst.COLOR_BLACK);v.x=y.x,v.y=y.y-25,this.addChild(v);var A=BaseBitmap.create("public_icon1");A.scaleX=30/A.width,A.scaleY=30/A.height,A.x=v.x+v.width,A.y=y.y-30,this.addChild(A);var w=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);w.text=String(n.preCost),w.x=A.x+35,w.y=v.y,this.addChild(w);var x=BaseBitmap.create("shopview_line");x.x=v.x,x.y=w.y+7,this.addChild(x)},e.prototype.update=function(){if(this._limitNumTF){var t=Api.shopVoApi.getCanBuyNumById(this._shopItemCfg.id);this._limitNumTF.text=LanguageManager.getlocal("shopLimitBuy",[t.toString()])}},e.prototype.playSuccessAction=function(){if(this._shopItemCfg)for(var t=this._shopItemCfg.contentList,e=(t.length,t.length-1);e>=0;e--){var i=t[e],a=GameData.getItemIcon(i,!0),n=this.itemList[e];a.setScale(n.scaleX);var o=n.localToGlobal();o.x,o.y;a.x=o.x,a.y=o.y;var s=GameConfig.stageWidth/2+a.width/2,r=GameConfig.stageHeigth-10;GameConfig.stage.addChild(a),egret.Tween.get(a).wait(200*e).to({x:s,y:r},500).call(this.onComplete,this,[a])}},e.prototype.onComplete=function(t){t&&t.dispose()},e.prototype.buyHandlerCallback=function(t){if(0!=this._isRequesting){this._isRequesting=!1;var e=t.data.data;0==e.ret?(this.update(),this.playSuccessAction()):App.CommonUtil.showTip(LanguageManager.getlocal("shopBuyFailure"))}},e.prototype.confirmCallbackHandler=function(){return this._shopItemCfg.buyCost>Api.playerVoApi.getPlayerGem()?void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough")):(this._isRequesting=!0,void NetManager.request(NetRequestConst.REQUEST_SHOP_BUY_ITEM,{shopId:this._shopid,version:Api.shopVoApi.getVersion(),dtype:"2"}))},e.prototype.checkNeedWarnPopup=function(){var t=this._shopItemCfg.buyCost;if(t>=Config.ShopCfg.buyItemCheckVal){var e=LanguageManager.getlocal("shopBuyUseGem",[t.toString(),this._shopItemCfg.name]),i=Api.playerVoApi.getPlayerGem();ViewController.getInstance().openView(ViewConst.POPUP.COSTGEMBUYITEMPOPUPVIEW,{useNum:t,confirmCallback:this.confirmCallbackHandler,handler:this,num:i,msg:e,id:1})}else this.confirmCallbackHandler()},e.prototype.buyHandler=function(t){if(this._shopItemCfg.needVip>Api.playerVoApi.getPlayerVipLevel())return void App.CommonUtil.showTip(LanguageManager.getlocal("vipLvNotEnough"));var e=Api.shopVoApi.getCanBuyNumById(this._shopItemCfg.id);return 0==e?void App.CommonUtil.showTip(LanguageManager.getlocal("shopNumNotEnough")):void this.checkNeedWarnPopup()},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SHOP_BUY_ITEM),this.buyHandlerCallback,this),this._shopid=0,this._limitNumTF=null,this._buyBtn=null,this._limitDescTF=null,this._selectedIndex=0,this._shopItemCfg=null,this.itemList=[],this._isRequesting=!1,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(Shop3ScrollItem.prototype,"Shop3ScrollItem");var ShopScrollItem=function(t){function e(){var e=t.call(this)||this;return e._shopid=0,e._selectedIndex=0,e.itemList=[],e._isRequesting=!1,e._data=null,e._buyNum=0,e._nextNum2=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SHOP_BUY_ITEM),this.buyHandlerCallback,this);var i=600,a=148;this.width=i,this.height=a,this._shopid=e.sortId,this._selectedIndex=t,this._data=e;var n=Config.ShopnewCfg.getnewShopItemCfgById(this._shopid);this._shopItemCfg=n;var o=GameData.formatRewardItem(e.content),s=(n.buyCost,""),r=Api.playerVoApi.getPlayerVipLevel(),l=Api.playerVoApi.getPlayerNextVipLevel(),h="";if(1==e.isLimit)if(r>=e.needVip&&0!=r){var d=this.getVipNum();if(s=LanguageManager.getlocal("shopvipDes1",[""+r,d+""]),this._buyNum=d,r!=Api.playerVoApi.getPlayerMaxVip()){var g=this.getNextVipNum(l);if(g==this.getVipNum()){var c=this.lookupNextVipNum(g);if(null!=c){var p=c,_=e.buyNum[c]-this.getIdBynum();this._nextNum2=p,h=LanguageManager.getlocal("shopvipDes1",[""+p,_+""])}}else h=LanguageManager.getlocal("shopvipDes1",[""+l,g+""]),this._nextNum2=l}}else if(0==r&&0==e.needVip){var d=this.getVipNum();s=LanguageManager.getlocal("shopvipDes1",[""+r,d+""]),this._buyNum=d}else{var u=this._data.buyNum[e.needVip];s=LanguageManager.getlocal("shopvipDes1",[""+e.needVip,u+""]),this._buyNum=d}var C=(n.name,this.needVipDesc),f=BaseBitmap.create("public_9_bg14");if(f.width=i,f.height=148,this.addChild(f),o.length>1);else for(var m=0;m<o.length;m++){var T=o[m],y=GameData.getItemIcon(T,!0);y.x=15,y.y=24,this.addChild(y),this.itemList.push(y);var v=BaseBitmap.create("public_9_bg15");v.x=y.x+115,v.y=y.y,v.width=180,this.addChild(v);var A=ComponentManager.getTextField(T.name,TextFieldConst.FONTSIZE_TITLE_SMALL,T.nameColor);A.x=v.x+v.width/2-A.width/2,A.y=v.y+v.height/2-A.height/2,this.addChild(A);var w=ComponentManager.getTextField(T.desc,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);w.x=v.x,w.y=v.y+v.height+7,w.width=280,this.addChild(w),this._buyBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"nothing",this.buyHandler,this);var x="";if(x=this.getBuyCost().toString(),this._buyBtn.setText(x,!1),this._buyBtn.addTextIcon("public_icon1",1),this._buyBtn.x=this.width-this._buyBtn.width-20,this._buyBtn.y=this.height/2-this._buyBtn.height/2,this.addChild(this._buyBtn),""!=C){var I=ComponentManager.getTextField(C,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_RED2);I.x=v.x,I.y=w.y+w.height+7,this.addChild(I)}if(""!=s&&(this._limitNumTF=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_SMALL),this._limitNumTF.x=this._buyBtn.x+this._buyBtn.width/2-this._limitNumTF.width/2,this._limitNumTF.y=this._buyBtn.y+this._buyBtn.height+7,this._buyNum>0?this._limitNumTF.textColor=TextFieldConst.COLOR_WARN_GREEN2:this._limitNumTF.textColor=TextFieldConst.COLOR_WARN_RED,this.addChild(this._limitNumTF)),""!=h&&(this._nextViptxt=ComponentManager.getTextField(h,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_RED),this._nextViptxt.x=this._buyBtn.x+this._buyBtn.width/2-this._nextViptxt.width/2,this._nextViptxt.y=this._buyBtn.y-27,this.addChild(this._nextViptxt)),n.discount>0){var L=BaseBitmap.create("shopview_corner");L.x=3,L.y=1,this.addChild(L);var E=ComponentManager.getTextField(n.discountDesc,18,TextFieldConst.COLOR_LIGHT_YELLOW);E.x=9,E.y=25,E.rotation=-40,this.addChild(E);var B=30,S=ComponentManager.getTextField(LanguageManager.getlocal("originalPriceTitle")+":",18,TextFieldConst.COLOR_BLACK);S.y=this._buyBtn.y-S.height/2-13,this.addChild(S);var N=BaseBitmap.create("public_icon1");N.scaleX=B/N.width,N.scaleY=B/N.height,N.y=this._buyBtn.y-B/2-13,this.addChild(N);var M=ComponentManager.getTextField(n.preCost.toString(),18,TextFieldConst.COLOR_BLACK);M.x=v.x,M.y=S.y,this.addChild(M);var b=S.width+B+M.width;S.x=this._buyBtn.x+this._buyBtn.width/2-b/2,N.x=S.x+S.width,M.x=N.x+B;var O=BaseBitmap.create("shopview_line");O.x=this._buyBtn.x+this._buyBtn.width/2-O.width/2,O.y=this._buyBtn.y-O.height/2-13,this.addChild(O)}}},e.prototype.update=function(){Api.playerVoApi.getPlayerNextVipLevel();if(this._limitNumTF){var t=this.getVipNum(),e=Api.playerVoApi.getPlayerVipLevel();this._limitNumTF.text=LanguageManager.getlocal("shopvipDes1",[e+"",t.toString()]),0==t&&(this._limitNumTF.textColor=TextFieldConst.COLOR_WARN_RED2)}if(1==this._data.isLimit){if(this._nextViptxt){var i=this.getNextVipNum(this._nextNum2);this._nextViptxt.text=LanguageManager.getlocal("shopvipDes1",[""+this._nextNum2,i+""])}var a=this.getNextVipNum(this._nextNum2);if(this._nextViptxt&&this.getVipNum()==a){var n=this.lookupNextVipNum(a)+1,i=this._data.buyNum[n-1]-this.getIdBynum();this._nextViptxt.text=LanguageManager.getlocal("shopvipDes1",[""+n,i+""])}}if(this._buyBtn){var o=this.getBuyCost().toString();this._buyBtn.setText(o,!1),this._buyBtn.removeTextIcon(),this._buyBtn.addTextIcon("public_icon1",1)}},e.prototype.lookupNextVipNum=function(t){void 0===t&&(t=0);for(var e=Api.playerVoApi.getPlayerVipLevel(),i=0;i<this._data.buyNum.length;i++){var a=this._data.buyNum[i],n=a-Api.shopVoApi.getNewShopBuyNumById(this._data.sortId);if(n>t&&i>=e)return i}return null},e.prototype.playSuccessAction=function(){if(this._shopItemCfg){var t=GameData.getItemIcon(GameData.formatRewardItem(this._shopItemCfg.content)[0],!0),e=this.itemList[0];t.setScale(e.scaleX);var i=e.localToGlobal();i.x,i.y;t.x=i.x,t.y=i.y;var a=GameConfig.stageWidth/2+t.width/2,n=GameConfig.stageHeigth-10;GameConfig.stage.addChild(t),egret.Tween.get(t).wait(200).to({x:a,y:n},500).call(this.onComplete,this,[t])}},e.prototype.onComplete=function(t){t&&t.dispose()},e.prototype.buyHandlerCallback=function(t){if(0!=this._isRequesting){this._isRequesting=!1;var e=t.data.data;0==e.ret?(this.update(),this.playSuccessAction()):App.CommonUtil.showTip(LanguageManager.getlocal("shopBuyFailure"))}},e.prototype.confirmCallbackHandler=function(){return this.getBuyCost()>Api.playerVoApi.getPlayerGem()?void App.CommonUtil.showTip(LanguageManager.getlocal("gemNotEnough")):(this._isRequesting=!0,void NetManager.request(NetRequestConst.REQUEST_SHOP_BUY_ITEM,{shopId:this._shopid,version:Api.shopVoApi.getVersion(),dtype:"1"}))},e.prototype.checkNeedWarnPopup=function(){var t=this.getBuyCost();if(t>=Config.ShopCfg.buyItemCheckVal){var e=GameData.formatRewardItem(this._data.content),i=e[0],a=LanguageManager.getlocal("shopBuyUseGem",[t.toString(),i.name]),n=Api.playerVoApi.getPlayerGem();ViewController.getInstance().openView(ViewConst.POPUP.COSTGEMBUYITEMPOPUPVIEW,{useNum:i.num,confirmCallback:this.confirmCallbackHandler,handler:this,num:n,msg:a,id:1})}else this.confirmCallbackHandler()},e.prototype.buyHandler=function(t){if(this._shopItemCfg.needVip>Api.playerVoApi.getPlayerVipLevel())return void App.CommonUtil.showTip(LanguageManager.getlocal("vipLvNotEnough"));var e=this.getVipNum();return 0==e?void App.CommonUtil.showTip(LanguageManager.getlocal("newshopNumNotEnough")):void this.checkNeedWarnPopup()},e.prototype.getBuyCost=function(){var t=Api.shopVoApi.getNewShopBuyNumById(this._data.sortId),e=0;if(t&&1==this._data.isLimit){if(t>=this._data.buyCost.length)return e=this._data.buyCost[this._data.buyCost.length-1];e=this._data.buyCost[t]}else e=this._data.buyCost[0];return e},e.prototype.getVipNum=function(){if(1==this._data.isLimit){var t=Api.playerVoApi.getPlayerVipLevel(),e=this._data.buyNum[t],i=e-Api.shopVoApi.getNewShopBuyNumById(this._data.sortId);return i}},e.prototype.getNextVipNum=function(t){if(void 0===t&&(t=0),1==this._data.isLimit){var e=this._data.buyNum[t],i=e-Api.shopVoApi.getNewShopBuyNumById(this._data.sortId);return i}},e.prototype.getIdBynum=function(){return Api.shopVoApi.getNewShopBuyNumById(this._data.sortId)},Object.defineProperty(e.prototype,"needVipDesc",{get:function(){return this._shopItemCfg.needVip&&this._shopItemCfg.needVip>0?LanguageManager.getlocal("shopVipLimit",[this._shopItemCfg.needVip.toString()]):""},enumerable:!0,configurable:!0}),e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SHOP_BUY_ITEM),this.buyHandlerCallback,this),this._shopid=0,this._limitNumTF=null,this._buyBtn=null,this._limitDescTF=null,this._selectedIndex=0,this._shopItemCfg=null,this.itemList=[],this._isRequesting=!1,this._buyNum=0,t.prototype.dispose.call(this)
},e}(ScrollListItem);__reflect(ShopScrollItem.prototype,"ShopScrollItem");var ShopView=function(t){function e(){var e=t.call(this)||this;return e.gemTF=null,e._cdTxt=null,e}return __extends(e,t),e.prototype.initView=function(){var t=38;App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SHOP_BUY_ITEM),this.useCallback,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.useCallback,this);var e=BaseBitmap.create("public_icon1");e.scaleX=t/e.width,e.scaleY=t/e.height,e.x=5,e.y=44,this.addChild(e),this.gemTF=ComponentManager.getTextField(Api.playerVoApi.getPlayerGem().toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON),this.gemTF.x=e.x+t+5,this.gemTF.y=53,this.addChild(this.gemTF);var i=ComponentManager.getButton("mainui_btn1","",this.goToRechargeHandler,this);i.setScale(.85),i.x=123,i.y=48,this.addChild(i),Api.switchVoApi.checkClosePay()&&(i.visible=!1);var a=BaseBitmap.create("shopview_bg");if(a.x=0,a.y=-10,this.addChildToContainer(a),Api.shopVoApi.getet()>=GameData.serverTime){var n=BaseBitmap.create("public_resnumbg");n.setScale(1.5),n.x=a.x+a.width-1.5*n.width-5,n.y=a.y+a.height-40,n.name="cdbg",this.addChildToContainer(n);var o=App.DateUtil.getFormatBySecond(Api.shopVoApi.getet()-GameData.serverTime,3);this._cdTxt=ComponentManager.getTextField("",20),this._cdTxt.textColor=65280,this._cdTxt.text=LanguageManager.getlocal("shop_cdTxt",[o]),this._cdTxt.x=n.x+40,this._cdTxt.y=n.y+13,this.addChildToContainer(this._cdTxt)}var s=BaseBitmap.create("servant_bottombg");s.x=0,s.y=a.y+a.height,s.height=GameConfig.stageHeigth-s.y-this.container.y,this.addChildToContainer(s);var r=BaseBitmap.create("public_9_bg32");r.width=GameConfig.stageWidth-30,r.height=s.height-100,r.x=15,r.y=s.y+80,this.addChildToContainer(r)},e.prototype.clickTabbarHandler=function(t){var e=Number(t.index);return 0==this.checkTabCondition(e)?void(this.tabbarGroup.selectedIndex=this.selectedTabIndex):(this.lastSelectedTabIndex=this.selectedTabIndex,this.selectedTabIndex=e,this.changeTab(),void(0==t.index&&Api.shopVoApi.getInterday()&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_SHOP_NEXTDAY)))},e.prototype.useCallback=function(){this.gemTF.text=Api.playerVoApi.getPlayerGem().toString()},e.prototype.goToRechargeHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["shopview_bg","shopview_corner","shopview_line","servant_bottombg","common_titlebg","vipLimit_img"])},e.prototype.getContainerY=function(){return 260},e.prototype.getTitleButtomY=function(){var t;return this.titleBg?t=this.titleBg.y+this.titleBg.height:this.titleTF&&(t=this.titleTF.y+this.titleTF.height),t},e.prototype.getTabbarGroupY=function(){return 225},e.prototype.tick=function(){if(Api.shopVoApi.getet()>=GameData.serverTime){var t=App.DateUtil.getFormatBySecond(Api.shopVoApi.getet()-GameData.serverTime,3);return this._cdTxt.text=LanguageManager.getlocal("shop_cdTxt",[t]),this._cdTxt.visible=!0,!0}return this._cdTxt&&(this._cdTxt.visible=!1),!1},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_SHOP_GETSHOPCFG,requestData:{}}},e.prototype.getTabbarTextArr=function(){return["shopViewTab1","shopViewTab3"]},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.useCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SHOP_BUY_ITEM),this.useCallback,this),this.gemTF=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(ShopView.prototype,"ShopView");var BaseBitmapText=function(t){function e(){var e=t.call(this)||this;return e.bindData=null,e._touchTapHelper=null,e._touchHelper=null,e}return __extends(e,t),e.prototype.addTouchTap=function(t,e,i){null==this._touchTapHelper&&(this._touchTapHelper=TouchHelper.addTouchTap(this,t,i,e))},e.prototype.removeTouchTap=function(){this._touchTapHelper&&(this._touchTapHelper.removeTouchTap(),this._touchTapHelper=null)},e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.stopAllActions=function(){egret.Tween.removeTweens(this)},e.prototype.setVisible=function(t){this.visible=t},e.prototype.setScale=function(t){this.scaleX=this.scaleY=t},e.prototype.dispose=function(){this.stopAllActions(),this.removeTouchTap(),this.bindData=null},e}(egret.BitmapText);__reflect(BaseBitmapText.prototype,"BaseBitmapText",["base.Iinteractive","base.Ibase"]);var ShopViewTab2=function(t){function e(){var e=t.call(this)||this;return e._index=0,e._shopid=0,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this._shopInfoVoList=Api.shopVoApi.getShopInfoListByType(3);var t=egret.Rectangle.create();t.setTo(0,0,600,GameConfig.stageHeigth-420),this._scrollList=ComponentManager.getScrollList(Shop3ScrollItem,this._shopInfoVoList,t),this.addChild(this._scrollList),this._scrollList.setPosition(20,70)},e.prototype.getSheepType=function(){return 3},e.prototype.dispose=function(){this._scrollList=null,this._shopInfoVoList=null,this._index=0,this._shopid=0,t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(ShopViewTab2.prototype,"ShopViewTab2");var ShopViewTab3=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getSheepType=function(){return 2},e}(ShopViewTab1);__reflect(ShopViewTab3.prototype,"ShopViewTab3");var StudyatkBattleResultView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e._type=1,e}return __extends(e,t),e.prototype.getResourceList=function(){var t=[];return t=2==this.param.data.type?["battle_fail_word"]:["battle_win_word"],t.concat([])},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getBgName=function(){return"public_9_bg8"},e.prototype.initView=function(){this.addTouchTap(this.touchTap,this,null),this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f),this.param.data&&this.param.data.type&&(this._type=this.param.data.type);var t=BaseBitmap.create("public_9_wordbg");t.width=GameConfig.stageWidth,t.height=168,t.setPosition(GameConfig.stageWidth/2-t.width/2,GameConfig.stageHeigth/2-t.height/2),this.addChildToContainer(t);var e;2==this._type?(App.DisplayUtil.changeToGray(t),e="battle_fail_word"):e="battle_win_word";var i=BaseBitmap.create(e);i.setPosition(GameConfig.stageWidth/2-i.width/2,t.y-i.height/2),this.addChildToContainer(i);var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);this.addChildToContainer(a),2==this._type?(a.text=LanguageManager.getlocal("studyatkBattle_lost"),a.setPosition(t.width/2-a.width/2,t.y+69),a.textColor=TextFieldConst.COLOR_QUALITY_RED):(a.text=LanguageManager.getlocal("studyatkBattle_win"),a.setPosition(t.width/2-a.width/2,t.y+69),a.textColor=TextFieldConst.COLOR_QUALITY_GREEN);var n;n=3==this._type?LanguageManager.getlocal("studyatk_battle_result1"):LanguageManager.getlocal("studyatk_battle_result2");var o=ComponentManager.getTextField(n,TextFieldConst.FONTSIZE_CONTENT_COMMON);o.setPosition(t.width/2-o.width/2,a.y+45),this.addChildToContainer(o)},e.prototype.touchTap=function(){this._obj&&this._callbackF&&this._callbackF.apply(this._obj),this.hide()},e.prototype.dispose=function(){this._callbackF=null,this._obj=null,this._type=1,t.prototype.dispose.call(this)},e}(BaseView);__reflect(StudyatkBattleResultView.prototype,"StudyatkBattleResultView");var StudyatkBattleView=function(t){function e(){var e=t.call(this)||this;return e._winCode=0,e._myInfo=null,e._playerTab=[],e._dialogTab=[],e._curRound=0,e._oldPosTab=[],e._rattleText=null,e._rattleContainer=null,e._dialogType=0,e._beAttackClip=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["atkrace_battle_info","arena_bg","battle_attack_anim"])},e.prototype.getBgName=function(){return"arena_bg"},e.prototype.initView=function(){this._winCode=this.param.data.wcode,this._myInfo=this.param.data.info;var t=this.getPlayerContainer(0);t.y=GameConfig.stageHeigth-520,this.addChildToContainer(t),this._oldPosTab[0]=egret.Point.create(t.x,t.y);var e=this.getPlayerContainer(1);e.y=30,this.addChildToContainer(e),this._oldPosTab[1]=egret.Point.create(e.x,e.y),this._playerTab=[t,e],this._beAttackClip=ComponentManager.getCustomMovieClip("atk_anim_",7,70),this._beAttackClip.setEndCallBack(this.clipEndCallback,this),this.initDialog(),this.initDialogBg(),this.showRound()},e.prototype.showRound=function(){if(this._curRound>=this._dialogTab.length)return void this.showEnd();var t,e,i,a;this._curRound%2==0?(t=this._playerTab[0],e=this._playerTab[1],i=this._oldPosTab[0],a=egret.Point.create(this._oldPosTab[1].x+.1*e.width,this._oldPosTab[1].y+.1*e.height)):(t=this._playerTab[1],e=this._playerTab[0],i=this._oldPosTab[1],a=egret.Point.create(this._oldPosTab[0].x+.1*e.width,this._oldPosTab[0].y+.1*e.height)),t.alpha=1,e.alpha=.8,egret.Tween.removeTweens(t),egret.Tween.removeTweens(e),egret.Tween.get(t).to({scaleX:1,scaleY:1,x:i.x,y:i.y},300),egret.Tween.get(e).to({scaleX:.8,scaleY:.8,x:a.x,y:a.y},300).call(this.showDialog,this)},e.prototype.showDialog=function(){this._curRound%2==0?this._rattleContainer.y=this._playerTab[0].y:this._rattleContainer.y=this._playerTab[1].y,this._rattleText.text=this._dialogTab[this._curRound],this.addChildToContainer(this._rattleContainer),this._curRound++,egret.Tween.get(this._rattleContainer).wait(2e3).call(this.resetContainer,this)},e.prototype.resetContainer=function(){this.removeChildFromContainer(this._rattleContainer),this.showRound()},e.prototype.showEnd=function(){var t,e,i=[],a=.4;1==this._winCode?(i=this._playerTab,t=i[1].y+100,e=50):(i=[this._playerTab[1],this._playerTab[0]],t=i[1].y-100+360*(1-a),e=-50),this.container.getChildIndex(i[0])<this.container.getChildIndex(i[1])&&this.container.swapChildren(i[0],i[1]);var n=120,o=300,s=egret.Point.create(i[0].x+(1-a)*i[0].width/2,t);egret.Tween.get(i[0]).to({y:i[0].y+e},150).to({x:s.x,y:s.y,scaleX:a,scaleY:a},n).to({x:i[0].x,y:i[0].y,scaleX:1,scaleY:1},o),TimerManager.doTimer(n+150,1,this.showBeAttackAnim,this)},e.prototype.showBeAttackAnim=function(){var t,e;1==this._winCode?(e=this._playerTab[1],t=-30):(e=this._playerTab[0],t=30),egret.Tween.get(e).to({y:e.y+t},100).to({y:e.y},120).to({alpha:0},800).call(this.showBattleRsult,this);var i=BaseBitmap.create("atk_anim_1");this._beAttackClip.setPosition(GameConfig.stageWidth/2-i.width/2,e.y+180-i.height/2),this.addChildToContainer(this._beAttackClip),this._beAttackClip.goToAndPlay(0),this._beAttackClip.playWithTime(1)},e.prototype.clipEndCallback=function(){this._beAttackClip&&this.removeChildFromContainer(this._beAttackClip)},e.prototype.showBattleRsult=function(){ViewController.getInstance().openView(ViewConst.BASE.STUDYATKBATTLERESULEVIEW,{f:this.hide,o:this,type:this._dialogType})},e.prototype.initDialogBg=function(){this._rattleContainer=new BaseDisplayObjectContainer;var t=BaseBitmap.create("public_9_bg25");this._rattleContainer.addChild(t),t.width=270,t.height=80;var e=BaseBitmap.create("public_9_bg25_tail");e.x=40,e.y=t.y+t.height-3,this._rattleContainer.addChild(e),this._rattleText=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL),this._rattleText.width=t.width-26,this._rattleText.textColor=TextFieldConst.COLOR_BLACK,this._rattleText.lineSpacing=5,this._rattleText.setPosition(t.width/2-this._rattleText.width/2,18),this._rattleContainer.addChild(this._rattleText),this._rattleContainer.x=GameConfig.stageWidth/2+40},e.prototype.initDialog=function(){var t;t=this._myInfo[0].level>this._myInfo[1].level?3:1==this._winCode?1:2,this._dialogType=t;var e=App.MathUtil.getRandom()>50?2:1,i=LanguageManager.getlocal("officialTitle"+this._myInfo[0].level),a=LanguageManager.getlocal("officialTitle"+this._myInfo[1].level),n=this._myInfo[0].exp,o=this._myInfo[1].exp;1==t&&1==e?(this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_win1_1",[a])),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_win1_2",[a,o.toString()])),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_win1_3",[n.toString()])),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_win1_4")),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_win1_5"))):1==t&&2==e?(this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_win2_1")),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_win2_2",[i])),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_win2_3",[i])),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_win2_4",[o.toString()])),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_win2_5",[n.toString()]))):2==t&&1==e?(this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_lost1_1",[i])),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_lost1_2",[i])),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_lost1_3")),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_lost1_4",[o.toString()])),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_lost1_5")),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_lost1_6"))):2==t&&2==e?(this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_lost2_1",[a])),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_lost2_2",[a])),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_lost2_3",[n.toString()])),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_lost2_4",[o.toString()])),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_lost2_5")),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_lost2_6"))):3==t&&1==e?(this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_difflv1_1",[a])),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_difflv1_2")),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_difflv1_3"))):3==t&&2==e&&(this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_difflv2_1")),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_difflv2_2")),this._dialogTab.push(LanguageManager.getlocal("studyAtk_fight_difflv2_3")))},e.prototype.getPlayerContainer=function(t){var e=new BaseDisplayObjectContainer,i=BaseBitmap.create("public_9_downbg");i.width=270,i.height=80;var a=this._myInfo[t],n=Api.playerVoApi.getPlayerPortrait(a.level,a.pic),o=new egret.Rectangle;o.setTo(0,0,n.width,320),n.mask=o,n.x=i.width/2-150,e.addChild(n),i.y=288,e.addChild(i);var s=ComponentManager.getTextField(a.name,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_YELLOW);s.setPosition(28,i.y+15),e.addChild(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("mainui_officer")+": "+LanguageManager.getlocal("officialTitle"+a.level),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);return r.setPosition(s.x,s.y+s.height+8),e.addChild(r),e.x=GameConfig.stageWidth/2-e.width/2,e},e.prototype.dispose=function(){for(var e in this._playerTab)this._playerTab[e].filters=null;this._winCode=0,this._myInfo=null,this._playerTab.length=0,this._dialogTab.length=0,this._curRound=0,this._oldPosTab.length=0,this._rattleText=null,this._rattleContainer=null,this._dialogType=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(StudyatkBattleView.prototype,"StudyatkBattleView");var StudyAtkBookLvupSuccessView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=this.param.data[0],e=this.param.data[1],i=GameConfig.config.abilityCfg[t];this._nodeContainer=new BaseDisplayObjectContainer,this.addChild(this._nodeContainer);var a=BaseBitmap.create("public_9_wordbg");a.height=GameConfig.stageHeigth-200,a.y=GameConfig.stageHeigth-a.height-2,this._nodeContainer.addChild(a);var n=ComponentManager.getButton("popupview_closebtn1","",this.hide,this);n.x=this.viewBg.width-n.width+20,n.y=a.y-n.height/2,this._nodeContainer.addChild(n);var o=BaseBitmap.create("studyatk_servant_title");o.x=a.x+a.width/2-o.width/2,o.y=a.y-o.height/2-15,this._nodeContainer.addChild(o);var s=ComponentManager.getTextField("",20);s.text=LanguageManager.getlocal("studyatkBook_upgradeTip2",[String(Object.keys(e).length)]),s.x=a.x+a.width/2-s.width/2,s.y=a.y+45,this._nodeContainer.addChild(s);var r=a.height-100,l=new egret.Rectangle(0,0,GameConfig.stageWidth,r),h=new BaseDisplayObjectContainer,d=20,g=50,c=0;for(var p in e){var _=BaseBitmap.create("studyatk_servant_bg");_.y=d,c%2==0?_.x=g:(_.x=GameConfig.stageWidth-g-_.width,d+=230),h.addChild(_);var u=BaseBitmap.create("studyatk_booklv_circle");u.anchorOffsetX=u.width/2,u.anchorOffsetY=u.height/2,u.setScale(.5),u.x=_.x+_.width/2,u.y=_.y+_.height/2;var C=BaseBitmap.create("studyatk_booklv_light1");C.anchorOffsetX=C.width/2,C.anchorOffsetY=C.height/2,C.x=_.x+_.width/2,C.y=_.y+_.height/2,C.setScale(1.18),h.addChild(C);var f=BaseBitmap.create("studyatk_booklv_light2");f.anchorOffsetX=f.width/2,f.anchorOffsetY=f.height/2,f.x=C.x,f.y=C.y,f.setScale(C.scaleX),h.addChild(f),h.addChild(u),egret.Tween.get(u,{loop:!0}).to({scaleX:1.25,scaleY:1.25},1e3).to({scaleX:2,scaleY:2,alpha:0},1e3).set({scaleX:.5,scaleY:.5,alpha:1}),egret.Tween.get(C,{loop:!0}).to({rotation:360},15e3),egret.Tween.get(f,{loop:!0}).to({rotation:-360},15e3);var m=BaseLoadBitmap.create("servant_full_"+p),T=egret.Rectangle.create();m.width=405,m.height=467,T.setTo(0,0,405,400),m.mask=T,m.anchorOffsetX=m.width/2,m.anchorOffsetY=m.height/2,m.setScale(.4),m.x=_.x+_.width/2,m.y=_.y+_.height/2-10,h.addChild(m);var y=BaseBitmap.create("bookroom_cdbg");y.scaleY=1.5,y.x=_.x+_.width/2-y.width/2,y.y=_.y+_.height-95,h.addChild(y);var v=ComponentManager.getTextField("",20,TextFieldConst.COLOR_QUALITY_GREEN);v.text=LanguageManager.getlocal("servant_attrNameTxt"+t)+"+1",v.x=y.x+y.width/2-v.width/2,v.y=y.y+10,h.addChild(v);var A=e[p],w=ComponentManager.getTextField("",v.size,v.textColor);w.text=LanguageManager.getlocal("servantInfo_speciality"+i.type)+"+"+A,w.x=y.x+y.width/2-w.width/2,w.y=v.y+v.height+2,h.addChild(w),c++}var x=ComponentManager.getScrollView(h,l);x.y=a.y+80,x.bounces=!1,this._nodeContainer.addChild(x)},e.prototype.clickHandler=function(){t.prototype.hide.call(this)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["studyatk_servant_bg","studyatk_servant_title","bookroom_cdbg","popupview_closebtn1","studyatk_booklv_circle","studyatk_booklv_light1","studyatk_booklv_light2"])},e.prototype.dispose=function(){this._nodeContainer=null,t.prototype.dispose.call(this)},e}(BaseView);__reflect(StudyAtkBookLvupSuccessView.prototype,"StudyAtkBookLvupSuccessView");var StudyatkBookPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_UPGRADE),this.upgradeCallback,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer),this._tipTxt=ComponentManager.getTextField("",22,TextFieldConst.COLOR_BROWN),this._tipTxt.text=LanguageManager.getlocal("studyatkBook_tipTxt",[Api.studyatkVoApi.getStudySkillInfoTotalExp()]),this._tipTxt.x=this.viewBg.width/2-this._tipTxt.width/2,this._tipTxt.y=20,this._nodeContainer.addChild(this._tipTxt);var t=BaseBitmap.create("public_9_bg39");t.width=520,t.height=522,t.name="bottomBg",t.x=this.viewBg.width/2-t.width/2,t.y=50,this._nodeContainer.addChild(t);var e=Config.StudyatkCfg.getStudyatkList(),i=egret.Rectangle.create();i.setTo(0,0,t.width,t.height-10);var a=ComponentManager.getScrollList(StudyatkBookScrollItem,Object.keys(e),i);a.y=t.y+5,a.x=t.x,this._scrollList=a,this._nodeContainer.addChild(a),this.scrollPos(),this.upgradeCallback()},e.prototype.scrollPos=function(){var t=Api.studyatkVoApi.getStudySkillInfoLv();this._scrollList.setScrollTopByIndex(t)},e.prototype.upgradeCallback=function(){this._tipTxt.text=LanguageManager.getlocal("studyatkBook_tipTxt",[Api.studyatkVoApi.getStudySkillInfoTotalExp()])},e.prototype.getShowHeight=function(){return 660},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_UPGRADE),this.upgradeCallback,this),this._nodeContainer=null,this._scrollList=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(StudyatkBookPopupView.prototype,"StudyatkBookPopupView");var StudyatkBookScrollItem=function(t){function e(){var e=t.call(this)||this;return e._idx=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_UPGRADE),this.upgradeCallback,this),this._idx=t;var i=Config.StudyatkCfg.getStudyatkCfgById(e),a=GameConfig.config.abilityCfg[i.ability],n=BaseBitmap.create("public_9_bg14");n.width=510,n.height=120,n.x=5,this.addChild(n);var o=BaseLoadBitmap.create("servant_infoPro"+a.type);o.width=80,o.height=83,o.x=n.x+15,o.y=n.y+n.height/2-o.height/2,this.addChild(o);for(var s=LanguageManager.getlocal("servant_attrNameTxt"+i.ability),r=[{txt:LanguageManager.getlocal("studyatkBook_txt1",[i.id])},{txt:LanguageManager.getlocal("studyatkBook_txt2",[s,i.upLv])},{txt:LanguageManager.getlocal("studyatkBook_txt3",[i.needExp])}],l=115,h=20,t=0;3>t;t++){var d=ComponentManager.getTextField("",20,TextFieldConst.COLOR_BROWN);d.text=r[t].txt,d.x=l,d.y=h,d.name="bookTxt"+t,this.addChild(d),h+=28}var g=Api.studyatkVoApi.getStudySkillInfoLv();if(g<=this._idx){var c=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"studyatkBook_studyOver",this.btnHandler,this);c.x=n.x+n.width-c.width-10,c.y=n.y+n.height/2-c.height/2,c.visible=!1,c.name="btn",this.addChild(c),this._btn=c}var p=BaseBitmap.create("public_grasp");if(p.width=131,p.height=86,p.x=n.x+n.width-p.width-10,p.y=n.y+n.height/2-p.height/2,this.addChild(p),this._flagImg=p,g<this._idx){var _=BaseBitmap.create("public_9_viewmask");_.width=n.width,_.height=n.height,_.x=n.x,_.y=n.y,_.alpha=.7,_.name="mask",this.addChild(_),p.texture=ResourceManager.getRes("public_unlock"),this._mask=_}this.refreshUI()},e.prototype.refreshUI=function(){var t=Api.studyatkVoApi.getStudySkillInfoLv();t==this._idx?(this._btn.visible=!0,this._flagImg.visible=!1,this.getChildByName("bookTxt2").visible=!0,this._mask&&(this._mask.visible=!1)):t>this._idx?(this._btn&&(this._btn.visible=!1),this._mask&&(this._mask.visible=!1),this._flagImg.texture=ResourceManager.getRes("public_grasp"),this._flagImg.visible=!0,this.getChildByName("bookTxt2").visible=!0):t<this._idx&&(this._mask&&(this._mask.visible=!0),this._btn.visible=!1,this._flagImg.texture=ResourceManager.getRes("public_unlock"),this._flagImg.visible=!0,this.getChildByName("bookTxt2").visible=!1)},e.prototype.btnHandler=function(){var t=Api.studyatkVoApi.getStudySkillInfoTotalExp(),i=Config.StudyatkCfg.getStudyatkCfgById(String(this._idx+1));return t<i.needExp?void App.CommonUtil.showTip(LanguageManager.getlocal("studyatkBook_upgradeTip")):(e.lastUpgradeBookId=i.ability,e.lastUpgradeIdx=this._idx,void NetManager.request(NetRequestConst.REQUEST_STUDYATK_UPGRADE,{}))},e.prototype.getStars=function(t){for(var e=new BaseDisplayObjectContainer,i=1;t>=i;i++){var a=BaseBitmap.create("servant_star");a.setScale(.5),a.x=(i-1)*a.width*.5,a.y=0,e.addChild(a)}return e},e.prototype.upgradeCallback=function(t){var i=t.data.data;if(0==i.ret&&""!=e.lastUpgradeBookId){if(0==this._idx){var a=i.data.upservants,n=e.lastUpgradeBookId;ViewController.getInstance().openView(ViewConst.BASE.STUDYATKBOOLLVUPSUCCESSVIEW,[n,a])}if(this._idx==e.lastUpgradeIdx&&this.refreshUI(),this._idx==e.lastUpgradeIdx+1){var o=this;egret.Tween.get(this,{loop:!1}).wait(500).call(function(){o.refreshUI()},this),e.lastUpgradeBookId="",e.lastUpgradeIdx=-1}}},e.prototype.getSpaceX=function(){return 0},e.prototype.getSpaceY=function(){return 0},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_UPGRADE),this.upgradeCallback,this),this._idx=null,this._flagImg=null,this._btn=null,this._mask=null,t.prototype.dispose.call(this)},e.lastUpgradeBookId="",e.lastUpgradeIdx=-1,e}(ScrollListItem);__reflect(StudyatkBookScrollItem.prototype,"StudyatkBookScrollItem");var StudyatkCreatePopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_CREATE),this.studyBtnHandlerCallback,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var t=GameConfig.config.studyatkbaseCfg.addExp,i=ComponentManager.getTextField("",22,TextFieldConst.COLOR_BROWN);i.multiline=!0,i.width=500,i.lineSpacing=5,i.text=LanguageManager.getlocal("studyatk_createTipTxt",[String(t+1)]),i.x=this.viewBg.width/2-i.width/2,i.y=20,this._nodeContainer.addChild(i);var a=BaseBitmap.create("public_9_probiginnerbg");a.width=520,a.height=154,a.x=this.viewBg.width/2-a.width/2,a.y=i.y+i.height+15,this._nodeContainer.addChild(a);var n=ComponentManager.getTextField("",22,TextFieldConst.COLOR_LIGHT_YELLOW);n.text=LanguageManager.getlocal("studyatk_createTxt1",[Api.playerVoApi.getPlayerOffice()]),n.x=a.x+30,n.y=a.y+30,this._nodeContainer.addChild(n);var o=GameConfig.config.studyatkbaseCfg,s=o.levelList[String(Api.playerVoApi.getPlayerLevel())],r=ComponentManager.getTextField("",22,TextFieldConst.COLOR_LIGHT_YELLOW);r.text=LanguageManager.getlocal("studyatk_createTxt2",[s]),r.x=n.x+250,r.y=n.y,this._nodeContainer.addChild(r);var l=Api.itemVoApi.getItemNumInfoVoById(e.itemId),h=ComponentManager.getTextField("",22,TextFieldConst.COLOR_LIGHT_YELLOW);l>=1?h.text=LanguageManager.getlocal("studyatk_createTxt3",[String(l)]):h.text=LanguageManager.getlocal("studyatk_createTxt4"),h.x=n.x,h.y=n.y+50,this._nodeContainer.addChild(h);var d=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"cancelBtn",this.cancelHandler,this);d.x=80,d.y=a.y+a.height+20,this._nodeContainer.addChild(d);var g=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"studyatkCreatePopupViewTitle",this.confirmHandler,this);g.x=this.viewBg.width-g.width-d.x,g.y=d.y,this._nodeContainer.addChild(g)},e.prototype.studyBtnHandlerCallback=function(t){var e=t.data.data;0==e.ret&&App.CommonUtil.showTip(LanguageManager.getlocal("study_createTip2")),this.hide()},e.prototype.confirmHandler=function(){var t=Api.itemVoApi.getItemNumInfoVoById(e.itemId);t>0?NetManager.request(NetRequestConst.REQUEST_STUDYATK_CREATE,{}):App.CommonUtil.showTip(LanguageManager.getlocal("study_createTip1"))},e.prototype.cancelHandler=function(){this.hide()},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_CREATE),this.studyBtnHandlerCallback,this),this._nodeContainer=null,t.prototype.dispose.call(this)},e.itemId="1751",e}(PopupView);__reflect(StudyatkCreatePopupView.prototype,"StudyatkCreatePopupView");var StudyatkDetailRoleInfoItem=function(t){function e(){var e=t.call(this)||this;return e._pro_et=0,e._oldInfo=[],e}return __extends(e,t),e.prototype.init=function(t,e,i){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_JOIN),this.joinBtnHandlerCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_GOAWAY),this.pkBtnHandlerCallBack,this),this._posIdx=e,this._fuid=i.uid,this._detailData=i;var a=BaseBitmap.create("studyatk_frame_light"),n=2;a.name="lighMask",a.setScale(n),a.x=-a.width/2*n,a.y=-a.height*n,this.addChild(a),a.addTouchTap(this.joinBtnHandler,this),t?this.initRoleImgStatus(t,i):this.initIdle()},e.prototype.initRoleImgStatus=function(t,e){if(this._joinBtn&&(this._joinBtn.visible=!1),this._detailData=e,this._uiData=t,this._uiData){var i=this.getChildByName("roleImg");i&&(this.removeChild(i),i=null);var a=t.level;""!=t.title&&(a=t.title),i=Api.playerVoApi.getPlayerPortrait(a,t.pic),BaseLoadBitmap.create("palace_role_empty"),i.name="roleImg";var n=.4;"2"!=this._posIdx&&(n=.35),i.setScale(n),i.x=-i.width/2*n,i.y=-i.height*n-10,this.addChildAt(i,0),this._joinMv||(this._joinMv=ComponentManager.getCustomMovieClip("studyatk_frame",8,100),this._joinMv.setScale(2),this._joinMv.x=-98,this._joinMv.y=-388,"2"==this._posIdx&&(this._joinMv.y-=20),this.addChild(this._joinMv),this._joinMv.playWithTime(0),this._joinMv.addTouchTap(this.joinBtnHandler,this));var o=this.getChildByName("txtBg");o||(o=BaseBitmap.create("atkrace_name_bg"),o.width=190,o.height=90,o.name="txtBg",o.x=-o.width/2,o.y=20-o.height,this.addChild(o));var s=this.getChildByName("nameTxt");s||(s=ComponentManager.getTextField("",20,TextFieldConst.COLOR_LIGHT_YELLOW),s.x=o.x+30,s.y=o.y+10,s.name="nameTxt",this.addChild(s)),s.text=t.name;var r=this.getChildByName("officerTxt");r||(r=ComponentManager.getTextField("",20),r.name="officerTxt",r.x=o.x+30,r.y=s.y+25,this.addChild(r));var l=LanguageManager.getlocal("officialTitle"+t.level);r.text=l,this._getTxt||(this._getTxt=ComponentManager.getTextField("",20),this._getTxt.x=r.x,this._getTxt.y=r.y+25,this.addChild(this._getTxt));var h=this._detailData.skillrate*Math.floor((GameData.serverTime-this._uiData.join_st)/60);if(this._getTxt.text=LanguageManager.getlocal("study_table_get",[String(h)]),!this.isInHome()){Api.playerVoApi.getPlayerID();if(Api.playerVoApi.getPlayerLevel()>=t.level){if(this._pro_et=this._uiData.pro_et,this._pkBtn||(this._pkBtn=ComponentManager.getButton("studyatk_pkBtn","",this.pkBtnHandler,this),this._pkBtn.x=-this._pkBtn.width/2,this._pkBtn.y=i.y-70,this._pkBtn.name="pkBtn",this._pkBtn.visible=!1,this.addChild(this._pkBtn)),!this._pkTxtNode){this._pkTxtNode=new BaseDisplayObjectContainer,this.addChild(this._pkTxtNode);var d=BaseBitmap.create("atkrace_name_bg");d.width=170,d.height=40,d.x=o.x,d.y=this._pkBtn.y-d.height/2+50,this._pkTxtNode.addChild(d),this._idleTxt=ComponentManager.getTextField("",20,16711680),this._idleTxt.y=d.y+d.height/2,this._pkTxtNode.addChild(this._idleTxt)}if(this._uiData.pro_et>GameData.serverTime){this._inproTxt||(this._inproTxt=ComponentManager.getTextField("",20),this._inproTxt.textColor=6725881,this._inproTxt.x=r.x+r.width+10,this._inproTxt.y=r.y,this.addChild(this._inproTxt)),this._inproTxt.text=LanguageManager.getlocal("studyatk_inprotection"),this._pkTxtNode.visible=!0;var g=App.DateUtil.getFormatBySecond(this._uiData.pro_et-GameData.serverTime,3);this._idleTxt.text=LanguageManager.getlocal("studyatk_pkBtncdTxt",[g]),this._idleTxt.anchorOffsetX=this._idleTxt.width/2,this._idleTxt.anchorOffsetY=this._idleTxt.height/2,TickManager.removeTick(this.tick,this),TickManager.addTick(this.tick,this),this._pkTxtNode.visible=!0}else if(this.getNextPkTime(this._uiData.name)>0){this._pro_et=this.getNextPkTime(this._uiData.name);var g=App.DateUtil.getFormatBySecond(this._pro_et-GameData.serverTime,3);this._idleTxt.text=LanguageManager.getlocal("studyatk_pkBtncdTxt",[g]),this._idleTxt.anchorOffsetX=this._idleTxt.width/2,this._idleTxt.anchorOffsetY=this._idleTxt.height/2,TickManager.removeTick(this.tick,this),TickManager.addTick(this.tick,this),this._pkTxtNode.visible=!0}else this._pkTxtNode.visible=!1,this._pkBtn.visible=!0}else this._pro_et=this._uiData.pro_et,TickManager.removeTick(this.tick,this),TickManager.addTick(this.tick,this)}}},e.prototype.initIdle=function(){if(this._joinBtn)return void(this._joinBtn.visible=!0);var t=BaseBitmap.create("studyatk_arrow");t.addTouchTap(this.joinBtnHandler,this),t.x=-t.width/2;var e=-270;"2"==this._posIdx&&(e=-234),t.y=e,egret.Tween.get(t,{loop:!0}).to({y:e-50},1e3).wait(200).to({y:e},1e3),this.addChild(t),this._joinBtn=t},e.prototype.joinBtnHandlerCallback=function(t){var e=t.data.data;if(0==e.ret){var i=e.data.joincode;1!=i?App.CommonUtil.showTip(LanguageManager.getlocal("studyatk_joincode"+i)):App.CommonUtil.showTip(LanguageManager.getlocal("studyatk_join_success_tip"));
var a=e.data.getatkdetail,n=a.minfo;n[this._posIdx]&&!this._uiData?this.initRoleImgStatus(n[this._posIdx],a):this._detailData=a}},e.prototype.getNextPkTime=function(t){var e=this._detailData.atkinfo;for(var i in e)if(3==e[i].dtype){var a=e[i].st+GameConfig.config.studyatkbaseCfg.interval;if(e[i].name1==Api.playerVoApi.getPlayerName()&&e[i].name2&&e[i].name2==t&&a>=GameData.serverTime)return a}return 0},e.prototype.joinBtnHandler=function(){return this.getChildByName("roleImg")?void 0:this._fuid==Api.playerVoApi.getPlayerID()?void App.CommonUtil.showTip(LanguageManager.getlocal("studyatk_join_failed4")):this.isInHome()?void App.CommonUtil.showTip(LanguageManager.getlocal("studyatk_join_Tip1")):void NetManager.request(NetRequestConst.REQUEST_STUDYATK_JOIN,{fuid:this._fuid,pos:this._posIdx})},e.prototype.isInHome=function(){for(var t in this._detailData.minfo){var e=this._detailData.minfo[t];if(e.uid==Api.playerVoApi.getPlayerID())return!0}return!1},e.prototype.pkBtnHandlerCallBack=function(t){var e=t.data.data;if(0==e.ret){var i=e.data.goawaycode,a=e.data.pos,n=e.data.getatkdetail,o=n.minfo;if(this._detailData=n,1==i)App.CommonUtil.showTip(LanguageManager.getlocal("studyatk_pk_win")),this.initRoleImgStatus(o[this._posIdx],n);else{if(-1!=i)return a==this._posIdx&&o[a]&&this.initRoleImgStatus(o[a],n),void App.CommonUtil.showTip(LanguageManager.getlocal("studyatk_pk_goawaycode"+i));a==this._posIdx&&o[a]&&this.initRoleImgStatus(o[a],n),App.CommonUtil.showTip(LanguageManager.getlocal("studyatk_pk_goawaycode-1"))}a==this._posIdx&&this._oldInfo.length>0&&this.showBattle(i)}},e.prototype.showBattle=function(t){ViewController.getInstance().openView(ViewConst.COMMON.STUDYBATTLEVIEW,{f:this.showBattle,o:this,info:this._oldInfo,wcode:t})},e.prototype.pkBtnHandler=function(t){if(this.isInHome())return void App.CommonUtil.showTip(LanguageManager.getlocal("studyatk_pk_NotEnable2"));if(this._uiData.pro_et>GameData.serverTime)return void App.CommonUtil.showTip(LanguageManager.getlocal("studyatk_pk_inprotection"));var e=this._detailData.minfo;if(this._oldInfo.length=0,e&&e[this._posIdx]){var i=e[this._posIdx];this._oldInfo[0]={level:Api.playerVoApi.getPlayerLevel(),name:Api.playerVoApi.getPlayerName(),pic:Api.playerVoApi.getPlayePicId(),exp:Api.playerVoApi.getPlayerExp()},this._oldInfo[1]={level:i.level,name:i.name,pic:i.pic,exp:i.exp}}NetManager.request(NetRequestConst.REQUEST_STUDYATK_GOAWAY,{pos:this._posIdx,fuid:this._fuid,puid:this._uiData.uid})},e.prototype.idleBtnHandler=function(t){App.CommonUtil.showTip(LanguageManager.getlocal("studyatk_pk_inprotection"))},e.prototype.tick=function(){var t=this._detailData.skillrate*Math.floor((GameData.serverTime-this._uiData.join_st)/60);if(this._getTxt.text=LanguageManager.getlocal("study_table_get",[String(t)]),this._pro_et>=GameData.serverTime&&!this.isInHome()){if(this._inproTxt&&(this._inproTxt.visible=!0),this._pkTxtNode){this._pkTxtNode.visible=!0;var e=App.DateUtil.getFormatBySecond(this._pro_et-GameData.serverTime,3);this._idleTxt.text=LanguageManager.getlocal("studyatk_pkBtncdTxt",[e]),this._idleTxt.anchorOffsetX=this._idleTxt.width/2,this._idleTxt.anchorOffsetY=this._idleTxt.height/2}return!0}return this._pkBtn&&!this.isInHome()&&(this._pkBtn.visible=!0),this._pkTxtNode&&(this._pkTxtNode.visible=!1),this._inproTxt&&(this._inproTxt.visible=!1),!1},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_JOIN),this.joinBtnHandlerCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_GOAWAY),this.pkBtnHandlerCallBack,this),TickManager.removeTick(this.tick,this),this._posIdx=null,this._fuid=null,this._detailData=null,this._uiData=null,this._pro_et=null,this._pkTxtNode=null,this._pkBtn=null,this._joinBtn=null,this._inproTxt=null,this._joinMv=null,this._oldInfo.length=0,this._getTxt=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(StudyatkDetailRoleInfoItem.prototype,"StudyatkDetailRoleInfoItem");var StudyatkDetailView=function(t){function e(){var e=t.call(this)||this;return e._atkData=void 0,e._detailData=void 0,e._lastLogPosY=0,e._logNum=0,e._willGetRate=0,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_GOAWAY),this.pkBtnHandlerCallBack,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_GETATKDETAIL),this.refreshUiAfrerEnter,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_JOIN),this.pkBtnHandlerCallBack,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_INDEX),this.finishCallback,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_STUDYATK_FINISH,this.finishCloseCallback,this);var t=this.param.data.uid;NetManager.request(NetRequestConst.REQUEST_STUDYATK_GETATKDETAIL,{fuid:t}),this._nodeContainer=new BaseDisplayObjectContainer,this._nodeContainer.y=-15,this.addChildToContainer(this._nodeContainer);var e=BaseBitmap.create("studyatk_bg2");e.y=GameConfig.stageHeigth-this._nodeContainer.y-this.container.y-e.height,this._nodeContainer.addChild(e);var i=BaseBitmap.create("public_9_viewmask");i.width=GameConfig.stageWidth,i.height=70,this._nodeContainer.addChild(i);var a=BaseBitmap.create("public_9_wordbg");a.width=GameConfig.stageWidth,a.height=150,a.y=GameConfig.stageHeigth-this.container.y-a.height-this._nodeContainer.y,this._logBg=a},e.prototype.refreshUiAfrerEnter=function(t){var e=t.data.data;if(0==e.ret){this._detailData=e.data.getatkdetail;var i=GameConfig.config.studyatkbaseCfg;this._cdEndSec=this._detailData.create_time+i.lastTime;var a=this._detailData.skillrate;if(Api.playerVoApi.getPlayerID()==this._detailData.uid){var n=GameConfig.config.studyatkbaseCfg.addExp;a*=1+n}var o=a*Math.floor((GameData.serverTime-this._detailData.create_time)/60);this._willGetRate=a;var s=ComponentManager.getTextField("",22,TextFieldConst.COLOR_LIGHT_YELLOW);this._studyAddTxt=s,this._studyAddTxt.text=LanguageManager.getlocal("study_table_willGet",[String(Math.floor(this._willGetRate))]),s.x=10,s.y=10,this._nodeContainer.addChild(s),this._cdTxt=ComponentManager.getTextField("",22,TextFieldConst.COLOR_LIGHT_YELLOW);var r=this._cdEndSec-GameData.serverTime;this._cdTxt.text=LanguageManager.getlocal("study_table_lastt",[App.DateUtil.getFormatBySecond(r,3)]),this._cdTxt.x=s.x,this._cdTxt.y=s.y+30,this._nodeContainer.addChild(this._cdTxt);for(var l=(L={},L[1]={x:120,y:GameConfig.stageHeigth-560},L[2]={x:320,y:GameConfig.stageHeigth-520},L[3]={x:520,y:GameConfig.stageHeigth-560},L),h=this._detailData.minfo,d=1;3>=d;d++){var g=String(d),c=new StudyatkDetailRoleInfoItem;c.init(h[g],g,this._detailData),c.x=l[g].x,c.y=l[g].y,this._nodeContainer.addChild(c)}var p=this._detailData.level;""!=this._detailData.title&&(p=this._detailData.title);var _=Api.playerVoApi.getPlayerPortrait(p,this._detailData.pic),u=1;_.setScale(u),_.x=-10,_.y=this._logBg.y-_.height/2*u+45,this._nodeContainer.addChild(_);var C=BaseBitmap.create("studyatk_master_bg");C.width=250,C.height=60,C.x=0,C.y=this._logBg.y-C.height,this._nodeContainer.addChild(C);var f=BaseBitmap.create("studyatk_master");f.x=C.x+7,f.y=C.y+C.height/2-f.height/2,this._nodeContainer.addChild(f);var m=ComponentManager.getTextField(this._detailData.name,20,TextFieldConst.COLOR_LIGHT_YELLOW);m.x=C.x+40,m.y=C.y+8,this._nodeContainer.addChild(m);var T=ComponentManager.getTextField("",20);T.text=LanguageManager.getlocal("officialTitle"+this._detailData.level),T.x=m.x+m.width+20,T.y=m.y,this._nodeContainer.addChild(T);var y=ComponentManager.getTextField("",20);this._getTxt=y,this._getTxt.text=LanguageManager.getlocal("study_table_get",[String(Math.floor(o))]),y.x=m.x,y.y=T.y+25,this._nodeContainer.addChild(y),this._nodeContainer.addChild(this._logBg);var v=this._detailData.atkinfo,A=new egret.Rectangle(0,0,this._logBg.width,this._logBg.height-20),w=new BaseDisplayObjectContainer;this._logTmpNode=w,this._lastLogPosY=5;var x=ComponentManager.getScrollView(w,A);x.x=this._logBg.x,x.y=this._logBg.y+15,this._nodeContainer.addChild(x);for(var d=0;d<v.length;d++){var I=v[d];this.updateLog(I)}}var L},e.prototype.updateLog=function(t){this._logNum++;var e=ComponentManager.getTextField("",20),i=App.DateUtil.getFormatBySecond(t.st-App.DateUtil.getWeeTs(t.st),1);if(3==t.dtype){Api.playerVoApi.getPlayerName();1==t.ret?e.text=LanguageManager.getlocal("studyatk_logtxt4",[t.name2]):e.text=LanguageManager.getlocal("studyatk_logtxt3",[t.name2])}else e.text=LanguageManager.getlocal("studyatk_logtxt"+t.dtype);e.multiline=!0,e.lineSpacing=5,e.width=300;var a=ComponentManager.getTextField("【"+t.name1+"】",20);a.x=30,a.y=this._lastLogPosY,this._logTmpNode.addChild(a),e.x=180,e.y=a.y;var n=ComponentManager.getTextField(i,20);n.x=510,n.y=e.y,this._logTmpNode.addChild(n),this._lastLogPosY+=e.height+5,this._logTmpNode.addChild(e),this._logTmpNode.height=this._lastLogPosY+30},e.prototype.pkBtnHandlerCallBack=function(t){var e=t.data.data;if(0==e.ret){if(e.cmd==NetRequestConst.REQUEST_STUDYATK_JOIN){var i=e.data.joincode;if(-2==i){var a=this;egret.setTimeout(function(){a.hide()},this,1e3)}}var n=e.data.getatkdetail.atkinfo,o=n.length;if(o==this._logNum)return;for(var s=this._logNum;o>s;s++)this.updateLog(n[s])}},e.prototype.finishCallback=function(t){var e=t.data.data;if(0==e.ret){var i=e.data.finishinfo;if(i){var a=i.ret;1==a?ViewController.getInstance().openView(ViewConst.BASE.STUDYATKSUCCESSVIEW,i):-1==a&&ViewController.getInstance().openView(ViewConst.POPUP.STUDYATKFAILEDPOPUPVIEW,i)}}},e.prototype.finishCloseCallback=function(){this.isInHome()&&(ViewController.getInstance().openView(ViewConst.COMMON.STUDYATKVIEW,{}),this.hide())},e.prototype.isInHome=function(){if(Api.playerVoApi.getPlayerID()==this._detailData.uid)return!0;for(var t in this._detailData.minfo){var e=this._detailData.minfo[t];if(e.uid==Api.playerVoApi.getPlayerID())return!0}return!1},e.prototype.tick=function(){var t=this._cdEndSec-GameData.serverTime;if(t>=0){GameConfig.config.studyatkbaseCfg;this._cdTxt.text=LanguageManager.getlocal("study_table_lastt",[App.DateUtil.getFormatBySecond(t,3)]);var e=this._willGetRate*Math.floor((GameData.serverTime-this._detailData.create_time)/60);return this._getTxt.text=LanguageManager.getlocal("study_table_get",[String(Math.floor(e))]),0==t&&this.isInHome()&&NetManager.request(NetRequestConst.REQUEST_STUDYATK_INDEX,{}),!0}return!1},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["studyatk_table","studyatk_bg2","studyatk_master_bg","studyatk_master","studyatk_frame","studyatk_arrow","studyatk_frame_light","atkrace_name_bg"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_GETATKDETAIL),this.refreshUiAfrerEnter,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_GOAWAY),this.pkBtnHandlerCallBack,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_JOIN),this.pkBtnHandlerCallBack,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_INDEX),this.finishCallback,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_STUDYATK_FINISH,this.finishCloseCallback,this),this._nodeContainer=null,this._cdTxt=null,this._cdEndSec=null,this._atkData=null,this._detailData=null,this._logBg=null,this._lastLogPosY=null,this._logTmpNode=null,this._studyAddTxt=null,this._getTxt=null,this._logNum=0,t.prototype.dispose.call(this)},e}(CommonView);__reflect(StudyatkDetailView.prototype,"StudyatkDetailView");var StudyatkFailedPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer);var t=BaseBitmap.create("public_9_bg39");t.width=520,t.height=190,t.name="bottomBg",t.x=this.viewBg.width/2-t.width/2,t.y=20,this._nodeContainer.addChild(t);var e=this.param.data,i=ComponentManager.getTextField("",22);i.multiline=!0,i.width=450,i.lineSpacing=20,i.text=LanguageManager.getlocal("studyatk_failedTxt",[e.uname,Math.floor(e.studytime/60),e.getskill]),i.x=this.viewBg.width/2-i.width/2,i.y=t.y+t.height/2-i.height/2,this._nodeContainer.addChild(i);var a=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"sysConfirm",this.confirmHandler,this);a.x=this.viewBg.width/2-a.width/2,a.y=t.y+ +t.height+15,this._nodeContainer.addChild(a)},e.prototype.confirmHandler=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_STUDYATK_FINISH),this.hide()},e.prototype.getBgExtraHeight=function(){return 40},e.prototype.dispose=function(){this._nodeContainer=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(StudyatkFailedPopupView.prototype,"StudyatkFailedPopupView");var StudyatkFindPopupView=function(t){function e(){var e=t.call(this)||this;return e._inputTextField=null,e._findInfo=null,e._gotoBtn=null,e}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=518,t.height=500,t.setPosition(this.viewBg.width/2-t.width/2,12),this.addChildToContainer(t),this._findTxtNodeControler=new BaseDisplayObjectContainer;var e=ComponentManager.getTextField(LanguageManager.getlocal("playerIdFind"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);e.setPosition(52,27+t.y),this.addChildToContainer(e);var i=ComponentManager.getInputTextField(TextFieldConst.COLOR_WHITE,TextFieldConst.FONTSIZE_TITLE_SMALL,466,44,"public_chatinputbg",LanguageManager.getlocal("inputPlayerId"),10785151);i.x=this.viewBg.width/2-i.width/2,i.y=t.y+55,this.addChildToContainer(i),this._inputTextField=i.getChildByName("textField"),this._inputTextField.restrict="0-9",this._inputTextField.maxChars=40;var a=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"find",this.findHandle,this);a.setPosition(this.viewBg.width-a.width-55,i.y+i.height+12),this.addChildToContainer(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("studyatk_find_teamInfo"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);n.setPosition(e.x,155+t.y),this.addChildToContainer(n);var o=BaseBitmap.create("public_9_probiginnerbg");o.width=500,o.height=228,this._rankBg=o,o.setPosition(this.viewBg.width/2-o.width/2,n.y+n.height+8),this.addChildToContainer(o),this._gotoBtn=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskGoBtn",this.gotoHandle,this),this._gotoBtn.setPosition(a.x,o.y+o.height+12),this.addChildToContainer(this._gotoBtn),this._gotoBtn.visible=!1,this.addChildToContainer(this._findTxtNodeControler)},e.prototype.findHandle=function(){return this._inputTextField.text.length<5||this._inputTextField.text==LanguageManager.getlocal("inputPlayerId")?void App.CommonUtil.showTip(LanguageManager.getlocal("playerIdError")):Number(this._inputTextField.text)==Api.playerVoApi.getPlayerID()?void App.CommonUtil.showTip(LanguageManager.getlocal("dinnerCannotSelf")):void this.request(NetRequestConst.REQUEST_STUDYATK_GETATK,{fuid:Number(this._inputTextField.text)})},e.prototype.gotoHandle=function(){var t=GameConfig.config.studyatkbaseCfg.lastTime;if(this._findInfo.create_time+t<GameData.serverTime)return void App.CommonUtil.showTip(LanguageManager.getlocal("studyatk_joincode-2"));var e=this._findInfo;ViewController.getInstance().openView(ViewConst.COMMON.STUDYATKDETAILVIEW,e),this.hide()},e.prototype.receiveData=function(t){if(1==t.ret){if(t.data.data.dinnerinfo&&!t.data.data.dinnerinfo.dtype)return void App.CommonUtil.showTip(LanguageManager.getlocal("playerIdIsNoDinner"));if(1==t.data.data.proflag)return void App.CommonUtil.showTip(LanguageManager.getlocal("adultMarryRequestTip2"));this._gotoBtn.visible=!0,this._findInfo=t.data.data.getatk,this.showFindInfo()}},e.prototype.showFindInfo=function(){this._findTxtNodeControler.removeChildren();var t=void 0;if(this._findInfo.create_time){var e=GameConfig.config.studyatkbaseCfg,i=e.levelList[String(this._findInfo.level)],a=this._findInfo.create_time+e.lastTime-GameData.serverTime,n=App.DateUtil.getFormatBySecond(a,3),o=String(Object.keys(this._findInfo.minfo).length);t=1==this._findInfo.dtype?[LanguageManager.getlocal("studyatk_find_txt1",[this._findInfo.name]),LanguageManager.getlocal("studyatk_find_txt2",[LanguageManager.getlocal("officialTitle"+this._findInfo.level)]),LanguageManager.getlocal("studyatk_find_txt3",[o]),LanguageManager.getlocal("studyatk_find_txt4",[i]),LanguageManager.getlocal("studyatk_find_txt5",[n])]:[LanguageManager.getlocal("studyatk_find_txt6"),LanguageManager.getlocal("studyatk_find_txt3",[o]),LanguageManager.getlocal("studyatk_find_txt5",[n])]}else this._gotoBtn.visible=!1,t=[LanguageManager.getlocal("studyatk_find_txt7")];for(var s=this._rankBg.y+15,r=0;r<t.length;r++){var l=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON);l.text=t[r],l.setPosition(this._rankBg.x+20,s),s+=l.height+10,this._findTxtNodeControler.addChild(l)}},e.prototype.dispose=function(){this._inputTextField=null,this._findInfo=null,this._gotoBtn=null,this._rankBg=null,this._findTxtNodeControler=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(StudyatkFindPopupView.prototype,"StudyatkFindPopupView");var StudyatkSuccessView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){},e.prototype.getResourceList=function(){var e=t.prototype.getResourceList.call(this);return e.concat(["public_rule_bg","studyatk_sucess"])},e.prototype.getBgName=function(){return"public_9_bg8"},e.prototype.init=function(){t.prototype.init.call(this),this.addTouchTap(this.touchTap,this,null);var e=BaseBitmap.create("public_rule_bg");e.setPosition(GameConfig.stageWidth/2-e.width,GameConfig.stageHeigth/2-e.height/2),this.addChildToContainer(e);var i=BaseBitmap.create("public_rule_bg");i.scaleX=-1,i.setPosition(GameConfig.stageWidth/2+i.width-1,GameConfig.stageHeigth/2-i.height/2),this.addChildToContainer(i);var a=BaseBitmap.create("studyatk_sucess");a.x=GameConfig.stageWidth/2-a.width/2,a.y=e.y-8,this.addChildToContainer(a);var n=BaseBitmap.create("public_9_bg1");n.width=500,n.height=140,n.setPosition(GameConfig.stageWidth/2-n.width/2,GameConfig.stageHeigth/2-n.height/2-30),this.addChildToContainer(n);var o=this.param.data,s=ComponentManager.getTextField("",22);s.multiline=!0,s.width=450,s.lineSpacing=20,s.text=LanguageManager.getlocal("studyatk_successTxt",[Math.floor(o.studytime/60),o.getskill]),s.x=n.x+n.width/2-s.width/2,s.y=n.y+n.height/2-s.height/2,this.addChildToContainer(s);var r=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"sysConfirm",this.confirmHandler,this);r.x=n.x+n.width/2-r.width/2,r.y=n.y+n.height+15,this.addChildToContainer(r)},e.prototype.confirmHandler=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_STUDYATK_FINISH),this.hide()},e.prototype.touchTap=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_STUDYATK_FINISH),this.hide()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseView);__reflect(StudyatkSuccessView.prototype,"StudyatkSuccessView");var StudyatkTableItem=function(t){function e(){var e=t.call(this)||this;return e._atkData=void 0,e._npcList=[],e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=BaseBitmap.create("studyatk_table");this.addChild(t);var e=BaseBitmap.create("studyatk_master_bg");e.width=205,e.height=60,e.x=t.x+t.width/2-e.width/2-5,e.y=t.y+t.height/2-e.height/2-25,this.addChild(e);var i=BaseBitmap.create("studyatk_master");i.x=e.x+10,i.y=e.y+e.height/2-i.height/2,this.addChild(i),this._cdTxt=ComponentManager.getTextField("",20),this._cdTxt.x=50,this._cdTxt.y=e.y+7,this.addChild(this._cdTxt);var a=ComponentManager.getTextField("",20);a.x=this._cdTxt.x,a.y=this._cdTxt.y+25,this.addChild(a),this._nameTxt=a,this.addTouchTap(this.enterAtkDetail,this),TickManager.addTick(this.tick,this)},e.prototype.refreshUI=function(t){this._atkData=t;var e=GameConfig.config.studyatkbaseCfg;this._cdEndSec=this._atkData.create_time+e.lastTime;var i=[{x:15,y:-10},{x:190,y:-10},{x:15,y:105},{x:190,y:105}];for(var a in this._npcList)this._npcList[a].visible=!1;for(var n=Object.keys(this._atkData.minfo).length+1,o=0;n>o;o++){var s=this._npcList[o];s||(s=BaseBitmap.create("studyatk_table_npc"),s.x=i[o].x,s.y=i[o].y,this.addChild(s),this._npcList.push(s),o%2==1&&(s.scaleX=-1)),s.visible=!0}this._nameTxt.text=this._atkData.name;var r=LanguageManager.getlocal("officialTitle"+this._atkData.level),l=this._cdEndSec-GameData.serverTime;this._cdTxt.text=LanguageManager.getlocal("studyatk_itemCdTxt",[r,App.DateUtil.getFormatBySecond(l,3)]),TickManager.removeTick(this.tick,this),TickManager.addTick(this.tick,this)},e.prototype.enterAtkDetail=function(){ViewController.getInstance().openView(ViewConst.COMMON.STUDYATKDETAILVIEW,this._atkData)},e.prototype.tick=function(){var t=this._cdEndSec-GameData.serverTime;if(t>=0){var e=(GameConfig.config.studyatkbaseCfg,LanguageManager.getlocal("officialTitle"+this._atkData.level));return this._cdTxt.text=LanguageManager.getlocal("studyatk_itemCdTxt",[e,App.DateUtil.getFormatBySecond(t,3)]),0==t&&NetManager.request(NetRequestConst.REQUEST_STUDYATK_INDEX,{}),!0}return!1},e.prototype.dispose=function(){TickManager.removeTick(this.tick,this),this._nodeContainer=null,this._atkData=null,this._cdTxt=null,this._cdEndSec=null,this._nameTxt=null,t.prototype.dispose.call(this)},e}(BaseDisplayObjectContainer);__reflect(StudyatkTableItem.prototype,"StudyatkTableItem");var StudyatkView=function(t){function e(){var e=t.call(this)||this;return e._studyTableIdx=0,e._studyTableList=[],e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_INDEX),this.refreshUiAfrerEnter,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_CREATE),this.studyBtnHandlerCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_JOIN),this.joinBtnHandlerCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_GOAWAY),this.GoAwayHandler,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_UPGRADE),this.refreshBookRed,this),NetManager.request(NetRequestConst.REQUEST_STUDYATK_INDEX,{}),this._nodeContainer=new BaseDisplayObjectContainer,this._nodeContainer.y=-15,this.addChildToContainer(this._nodeContainer);var t=BaseBitmap.create("studyatk_bg1"),e=new egret.Rectangle(0,0,t.width,GameConfig.stageHeigth-80);this._tableNodeContainer=new BaseDisplayObjectContainer,this._tableNodeContainer.height=t.height+100,this._tableNodeContainer.addChild(t);var i=ComponentManager.getScrollView(this._tableNodeContainer,e);i.bounces=!1,this._nodeContainer.addChild(i);var a=BaseBitmap.create("wifeview_bottombg");a.y=GameConfig.stageHeigth-this.container.y-a.height-this._nodeContainer.y,this._nodeContainer.addChild(a);var n=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"studyBtn_txt",this.studyBtnHandler,this);n.x=100,n.y=a.y+a.height/2-n.height/2+5,this._nodeContainer.addChild(n);var o=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"study_joinBtn_txt",this.joinBtnHandler,this);o.x=GameConfig.stageWidth-n.width-n.x,o.y=n.y,this._nodeContainer.addChild(o);var s=BaseBitmap.create("forpeople_bottom");s.x=5,s.y=5,this._nodeContainer.addChild(s);var r=BaseBitmap.create("studyatk_book");r.x=5,r.y=5,r.addTouchTap(this.bookBtnHandler,this),this._nodeContainer.addChild(r);var l=BaseBitmap.create("studyatk_book_name");l.x=r.x+r.width/2-l.width/2,l.y=r.y+r.height-l.height,this._nodeContainer.addChild(l),this._bookBtnRed=BaseBitmap.create("public_dot2"),this._bookBtnRed.x=r.x+r.width-this._bookBtnRed.width,this._bookBtnRed.y=r.y,this._bookBtnRed.name="reddot",this._nodeContainer.addChild(this._bookBtnRed),this._nextEntime=Api.studyatkVoApi.getNextEnterTime(),this._nextEntime>=GameData.serverTime&&(this._nextEnBg=BaseBitmap.create("public_numbg"),this._nextEnBg.width=250,this._nextEnBg.x=GameConfig.stageWidth/2-this._nextEnBg.width/2,this._nextEnBg.y=100,this._nodeContainer.addChild(this._nextEnBg),this._nextEnTxt=ComponentManager.getTextField("0",20,TextFieldConst.COLOR_WARN_YELLOW),this._nextEnTxt.y=this._nextEnBg.y+this._nextEnBg.height/2-this._nextEnTxt.height/2,this._nodeContainer.addChild(this._nextEnTxt))},e.prototype.tick=function(){if(!this._nextEnBg)return!0;if(this._nextEntime>=GameData.serverTime){var t=App.DateUtil.getFormatBySecond(this._nextEntime-GameData.serverTime,1);return this._nextEnTxt.text=LanguageManager.getlocal("studyatkCdTxt1",[t]),this._nextEnTxt.x=this._nextEnBg.x+this._nextEnBg.width/2-this._nextEnTxt.width/2,this._nextEnTxt.visible=!0,this._nextEnBg.visible=!0,!0}return this._nextEnTxt.visible=!1,this._nextEnBg.visible=!1,!1},e.prototype.createTableItem=function(t){var e=this._studyTableIdx,i=this._studyTableList[e];i||(i=new StudyatkTableItem,this._studyTableList.push(i),this._tableNodeContainer.addChild(i)),i.refreshUI(t),i.visible=!0;var a=20+e%2*395,n=200+240*Math.floor(e/2);i.x=a,i.y=n,this._studyTableIdx++},e.prototype.studyBtnHandlerCallback=function(t){var e=t.data.data;if(0==e.ret){App.CommonUtil.showTip(LanguageManager.getlocal("studyatk_createSuccess"));var i=e.data.studyroom;this.createTableItem(i),ViewController.getInstance().openView(ViewConst.COMMON.STUDYATKDETAILVIEW,i),this.hide()}else App.CommonUtil.showTip(LanguageManager.getlocal("studyatk_createFailed"))},e.prototype.GoAwayHandler=function(t){var e=t.data.data;0==e.ret&&1==e.data.goawaycode&&this.hide()},e.prototype.bookBtnHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.STUDYATKBOOKPOPUPVIEW)},e.prototype.joinBtnHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.STUDYATKFINDPOPUPVIEW)},e.prototype.studyBtnHandler=function(){ViewController.getInstance().openView(ViewConst.POPUP.STUDYATKCREATEPOPUPVIEW)},e.prototype.showNoTableNpc=function(t){if(!this._npcNodeContainer){this._npcNodeContainer=new BaseDisplayObjectContainer,this._npcNodeContainer.y=GameConfig.stageHeigth-this.container.y,this._nodeContainer.addChildAt(this._npcNodeContainer,1);var e=BaseLoadBitmap.create("story_npc_7");e.width=405,e.height=467,e.anchorOffsetY=e.height,e.y=-70;var i=.7;e.setScale(i),this._npcNodeContainer.addChild(e);var a=BaseBitmap.create("public_9_bg25");a.width=260,a.height=78,a.setPosition(e.x+e.width*i-90,e.y-e.height*i),this._npcNodeContainer.addChild(a);var n=BaseBitmap.create("public_9_bg25_tail");n.x=a.x+20,n.y=a.y+a.height-3,this._npcNodeContainer.addChild(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("studyatk_listemptyTip"),20,TextFieldConst.COLOR_BROWN);o.multiline=!0,o.width=a.width-30,o.x=a.x+15,o.y=a.y+a.height/2-o.height/2,this._npcNodeContainer.addChild(o)}this._npcNodeContainer.visible=t},e.prototype.refreshUiAfrerEnter=function(t){var e=t.data.data;if(0==e.ret){this._studyTableIdx=0;for(var i=e.data.atklist,a=0;a<this._studyTableList.length;a++)this._studyTableList[a].visible=!1;for(var a=0;a<i.length;a++)this.createTableItem(i[a]);this.showNoTableNpc(0==Object.keys(i).length);var n=e.data.finishinfo;if(n&&!this.param){var o=n.ret;1==o?ViewController.getInstance().openView(ViewConst.BASE.STUDYATKSUCCESSVIEW,n):-1==o&&ViewController.getInstance().openView(ViewConst.POPUP.STUDYATKFAILEDPOPUPVIEW,n)}}this.refreshBookRed()},e.prototype.refreshBookRed=function(){Api.studyatkVoApi.checkNpcMessage()?this._bookBtnRed.visible=!0:this._bookBtnRed.visible=!1},e.prototype.joinBtnHandlerCallback=function(){this.hide()},e.prototype.getRuleInfo=function(){return"studyatk_description"},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["studyatk_table","studyatk_bg1","wifeview_bottombg","studyatk_book","forpeople_bottom","studyatk_master_bg","studyatk_master","studyatk_pkBtn","studyatk_pkBtn_down","studyatk_table_npc","studyatk_book_name"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_INDEX),this.refreshUiAfrerEnter,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_CREATE),this.studyBtnHandlerCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_JOIN),this.joinBtnHandlerCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_GOAWAY),this.GoAwayHandler,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_STUDYATK_UPGRADE),this.refreshBookRed,this),this._studyTableIdx=0,this._studyTableList=[],this._nodeContainer=null,this._npcNodeContainer=null,this._nextEnTxt=null,this._nextEnBg=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(StudyatkView.prototype,"StudyatkView");var ThanksgivingView=function(t){function e(){var e=t.call(this)||this;return e.bottomBg=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["thanksgivingview_bg","thanksgivingview_top","thanksgivingview_bg_font","common_9_bg","recharge2_fnt"])},e.prototype.initView=function(){var t=new BaseDisplayObjectContainer;this.addChildToContainer(t),t.y=-10;var e=BaseBitmap.create("thanksgivingview_bg");t.addChild(e),this.bottomBg=BaseBitmap.create("common_9_bg"),this.bottomBg.y=e.height,this.bottomBg.height=GameConfig.stageHeigth-89-e.height,this.bottomBg.width=640,t.addChild(this.bottomBg);var i=BaseBitmap.create("thanksgivingview_bg_font");i.x=25,i.y=this.bottomBg.y+20,t.addChild(i);var a=new BaseDisplayObjectContainer;this.addChildToContainer(a),t.addChild(a);for(var n=Config.RechargeCfg.getNormalRechargeCfg(),o=[],s=0;s<n.length;s++){var r=n[s].id,l=Config.FirstchargeCfg.getneedRecharge(r);l&&o.push(n[s])}o=o.reverse();for(var s=0;s<o.length;s++){var h=BaseBitmap.create("public_9_managebg");h.width=141,h.height=277,h.x=(h.width+10)*s,h.y=this.bottomBg.y+70,a.addChild(h);var d=BaseBitmap.create("thanksgivingview_top");d.width=h.width,d.height=40,d.x=h.x,d.y=h.y,a.addChild(d);var g=LanguageManager.getlocal("thanksgivingRecharge1",[o[s].cost+""]),c=ComponentManager.getTextField(g,TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);c.x=d.x,c.y=d.y+8,c.width=d.width,c.textAlign="center",a.addChild(c);var p=LanguageManager.getlocal("rechargegivedes"),_=ComponentManager.getBitmapText(p,"recharge2_fnt");_.x=c.x+50,_.y=c.y+45,a.addChild(_);var u=3,C=o[s].gemCost*u,f=LanguageManager.getlocal("thanksgivingAcer",[C+""]),m=ComponentManager.getTextField(f,TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_BROWN);m.x=c.x,m.y=_.y+60,m.width=c.width,m.textAlign="center",a.addChild(m);var T=BaseLoadBitmap.create("recharge_new_itemicon"+o[s].sortId);a.addChild(T),T.x=h.x+13,T.y=h.y+150}a.setPosition((this.bottomBg.width-a.width)/2,a.y);var y=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"gotocharge",this.clickBtnHandler,this);y.x=230,y.y=GameConfig.stageHeigth-80,this.addChild(y)},e.prototype.clickBtnHandler=function(t){ViewController.getInstance().hideView(ViewConst.COMMON.THANKSGIVINGVIEW),ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.dispose=function(){this.bottomBg=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(ThanksgivingView.prototype,"ThanksgivingView");var TradeFightView=function(t){function e(){var e=t.call(this)||this;return e._dialogueBg=null,e._dialogueBg2=null,e.dialogueContainer=null,e.dialogueDesTxt=null,e.mysilverTxt=null,e.othersSilverTxt=null,e.animationTime=0,e.tradeGoldNum=0,e.txtScalse=0,e
}return __extends(e,t),e.prototype.initView=function(){this.animationTime=100,this.tradeGoldNum=0,this.txtScalse=1.2;var t=BaseBitmap.create("trade_bg2");this.addChild(t),this.dialogueContainer=new BaseDisplayObjectContainer,this.addChild(this.dialogueContainer),this.showDialogue();var e=BaseBitmap.create("trade_pb_bottombg");this.addChild(e),e.setPosition(0,GameConfig.stageHeigth-230);var i=BaseBitmap.create("atkrace_name_bg");this.addChild(i),i.width=200,i.height=40,i.setPosition(30,GameConfig.stageHeigth-200);var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);a.text=Api.playerVoApi.getPlayerName(),a.setPosition(i.x+60,i.y+10),this.addChild(a);var n=BaseBitmap.create("public_9_resbg");n.scaleX=-1,this.addChild(n),n.setPosition(200,GameConfig.stageHeigth-150);var o=BaseBitmap.create("public_icon2");this.addChild(o),o.setPosition(155,n.y);var s=0;this.param.data&&this.param.data.consumeGold&&(s=this.param.data.consumeGold+Api.playerVoApi.getPlayerGold());var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);r.text=s+"",r.setPosition(70,GameConfig.stageHeigth-138),r.x=-250,r.width=400,r.textAlign="right",this.addChild(r),this.mysilverTxt=r;var l=BaseBitmap.create("public_9_resbg");l.scaleX=-1,this.addChild(l),l.setPosition(200,GameConfig.stageHeigth-100);var h=BaseBitmap.create("servant_infoPro2");this.addChild(h),h.scaleX=.5,h.scaleY=.5,h.setPosition(158,GameConfig.stageHeigth-98);var d=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);d.text=Api.playerVoApi.getInte()+"",d.setPosition(150,h.y+10),this.addChild(d),d.anchorOffsetX=d.width,this.showOpponentInfo()},e.prototype.showOpponentInfo=function(){var t=Number(Api.tradeVoApi.getCurrentCid());1==this.param.data.rdata.data.fightflag&&(t-=1);var e=Config.TradeCfg.getTradeCfgById(t.toString());if(e){var i=BaseBitmap.create("atkrace_name_bg");this.addChild(i),i.width=200,i.height=40,i.setPosition(410,GameConfig.stageHeigth-200);var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);a.text=this.param.data.tradeName,a.setPosition(i.x+60,i.y+10),this.addChild(a);var n=BaseBitmap.create("public_9_resbg");this.addChild(n),n.setPosition(430,GameConfig.stageHeigth-150);var o=BaseBitmap.create("public_icon2");this.addChild(o),o.setPosition(n.x-5,n.y);var s=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);s.text=App.StringUtil.changeIntToText(this.param.data.tradeGold),s.setPosition(480,n.y+12),s.width=300,s.textAlign="left",this.addChild(s),this.othersSilverTxt=s,this.tradeGoldNum=e.tradeGold;var r=BaseBitmap.create("public_9_resbg");this.addChild(r),r.setPosition(430,GameConfig.stageHeigth-100);var l=BaseBitmap.create("servant_infoPro2");this.addChild(l),l.scaleX=.5,l.scaleY=.5,l.setPosition(430,GameConfig.stageHeigth-98);var h=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);h.text=this.param.data.tradeInte+"",h.setPosition(480,l.y+10),this.addChild(h)}},e.prototype.showDialogue=function(){var t=this;this._dialogueBg=BaseBitmap.create("public_9_bg42"),this.dialogueContainer.addChild(this._dialogueBg),this._dialogueBg.width=220,this._dialogueBg.height=83,this._dialogueBg.x=50,this._dialogueBg.y=300,this._dialogueBg2=BaseBitmap.create("public_9_bg42_tail"),this.dialogueContainer.addChild(this._dialogueBg2),this._dialogueBg2.scaleX=-1,this._dialogueBg2.x=this._dialogueBg.x+this._dialogueBg.width,this._dialogueBg2.y=this._dialogueBg.y+this._dialogueBg.height-5,this.dialogueDesTxt=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN),this.dialogueDesTxt.text=LanguageManager.getlocal("dialogueDes"),this.dialogueDesTxt.width=this._dialogueBg.width-15,this.dialogueDesTxt.setPosition(this._dialogueBg.x+10,this._dialogueBg.y+15),this.dialogueContainer.addChild(this.dialogueDesTxt),this.closeBtn.touchEnabled=!1,App.DisplayUtil.changeToGray(this.closeBtn);var e=this,i=egret.setTimeout(function(){return e.isInit()?(t.dialogueContainer.visible=!1,void t.playSilver()):void egret.clearTimeout(i)},e,800,1)},e.prototype.playSilver=function(){var t=this,e=this,i=(Api.tradeVoApi.getCurrentTradeCfg(),this.param.data.consumeGold+Api.playerVoApi.getPlayerGold()),a=Api.playerVoApi.getPlayerGold(),n=this.param.data.tradeGold,o=Api.tradeVoApi.getBattleResult(Api.playerVoApi.getInte(),i,this.param.data.tradeInte,this.param.data.tradeGold).left2,s=egret.getTimer(),r=s+2e3,l=egret.setInterval(function(){var h=egret.getTimer(),d=(h-s)/(r-s);if(!e.isInit())return void egret.clearInterval(l);var g=i-d*(i-a);t.mysilverTxt&&(t.mysilverTxt.text=Math.floor(g)+"",t.mysilverTxt.scaleX=t.txtScalse,t.mysilverTxt.scaleY=t.txtScalse,t.mysilverTxt.x=-330);var c=n-d*(n-o);return t.othersSilverTxt&&(t.othersSilverTxt.text=Math.floor(c)+"",t.othersSilverTxt.scaleX=t.txtScalse,t.othersSilverTxt.scaleY=t.txtScalse),h>=r?(egret.clearInterval(l),t.othersSilverTxt&&(t.othersSilverTxt.scaleX=1,t.othersSilverTxt.scaleY=1),t.mysilverTxt.scaleX=1,t.mysilverTxt.scaleY=1,t.mysilverTxt.x=-250,t.closeBtn.touchEnabled=!0,App.DisplayUtil.changeToNormal(t.closeBtn),0==t.param.data.rdata.data.fightflag?(t.mysilverTxt.text="0",t.mysilverTxt.textColor=TextFieldConst.COLOR_WARN_RED2,t.othersSilverTxt&&(t.othersSilverTxt.text=App.StringUtil.changeIntToText(o)),void t.isWin()):(t.mysilverTxt.text=Api.playerVoApi.getPlayerGoldStr(),t.othersSilverTxt&&(t.othersSilverTxt.text="0",t.othersSilverTxt.textColor=TextFieldConst.COLOR_WARN_RED2),void t.isWin())):void 0},e,10,1)},e.prototype.isWin=function(){var t=this,e=this,i=egret.setTimeout(function(){return e.isInit()?void t.openIsWin():void egret.clearTimeout(i)},e,2e3,1)},e.prototype.openIsWin=function(){var t=this.param.data;t&&(1==t.rdata.data.fightflag?ViewController.getInstance().openView(ViewConst.COMMON.TRADEINFOPOPUPVIEW,t):0==t.rdata.data.fightflag&&ViewController.getInstance().openView(ViewConst.BASE.PROMPTVIEW,{type:5,f:this.endCallBack,o:this}),ViewController.getInstance().hideView(ViewConst.COMMON.TRADEFIGHTVIEW))},e.prototype.endCallBack=function(){ViewController.getInstance().hideView(ViewConst.COMMON.TRADEFIGHTVIEW)},e.prototype.dispose=function(){this.tradeGoldNum=0,this.txtScalse=0,this.dialogueContainer=null,this.mysilverTxt=null,this.othersSilverTxt=null,this.animationTime=0,this._dialogueBg=null,this._dialogueBg2=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(TradeFightView.prototype,"TradeFightView");var TradeInfoPopupView=function(t){function e(){var e=t.call(this)||this;return e.scrollView=null,e._moveCountainer=null,e.rewardArrList=[],e._strArr=[],e._iconArr=[],e._itemStringContainer=null,e._itemContainer=null,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["battle_win_word","fire_flake_json","battle_win_light","fire_flake"])},e.prototype.isShowMask=function(){return!0},e.prototype.getTitleStr=function(){return null},e.prototype.initView=function(){this._itemStringContainer=new BaseDisplayObjectContainer,this._itemContainer=new BaseDisplayObjectContainer,this.viewBg.visible=!1;var t=BaseBitmap.create("public_9_wordbg2");t.setPosition(-35,20),t.width=640,t.height=700,this.addChildToContainer(t);var e=BaseBitmap.create("battle_win_light");e.scaleY=.5,e.setPosition(50,-10),this.addChildToContainer(e),e.alpha=0,egret.Tween.get(e).wait(100).to({alpha:1},100).wait(90).to({alpha:0},10);var i=BaseBitmap.create("battle_win_word");i.setPosition(0,-100),this.addChildToContainer(i),i.scaleX=2.5,i.scaleY=2.5,egret.Tween.get(i).to({x:160,y:-40,scaleX:.9,scaleY:.9},120).to({x:160,y:-40,scaleX:1,scaleY:1},50),this._fire_lizi=App.ParticleUtil.getParticle("fire_flake"),this._fire_lizi.y=-150,this.addChildToContainer(this._fire_lizi),this.showAnim();var a=this.param.data;if(a){var n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_WHITE);n.text=LanguageManager.getlocal("tradeWindes",[a.consumeGold,a.tradeName]),n.setPosition(45,80),n.width=480,n.textAlign="center",this.addChildToContainer(n)}this._moveCountainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._moveCountainer);var o=new egret.Rectangle(0,0,640,540);null==this.scrollView&&(this.scrollView=ComponentManager.getScrollView(this._moveCountainer,o),this.scrollView.x=10,this.scrollView.y=140,this.addChildToContainer(this.scrollView));var s=this.param.data.rdata;if(s&&s.data.trade.info&&s.data.trade.info.rewards)var r=this.param.data.rewards||s.data.rewards;else r="";this.rewardArrList=[],r&&(this.rewardArrList=GameData.formatRewardItem(r),this.rewardArrList.sort(function(t,e){return t.type>e.type?1:t.type==e.type?0:-1}));var l=this.rewardArrList.length;if(this._strArr=[],this._iconArr=[],s&&s.data.batchpoint){var h=LanguageManager.getlocal("tradepointdes",[s.data.batchpoint+""]);this._strArr.push(h)}for(var d=0;l>d;d++){var g=this.rewardArrList[d].type;if(6==g||1==g)this._iconArr.push(this.rewardArrList[d]);else if(12==g){var c=Config.WifeCfg.getWifeCfgById(this.rewardArrList[d].id);this._strArr.push(c.name+this.rewardArrList[d].tipMessage)}else if(14==g||15==g){var p=Config.ServantCfg.getServantItemById(this.rewardArrList[d].id);this._strArr.push(p.name+this.rewardArrList[d].message)}else this._strArr.push(this.rewardArrList[d].name+this.rewardArrList[d].tipMessage)}this.showItemIcon(),this.showTxt()},e.prototype.showItemIcon=function(){var t=.88,e=0;this._iconArr.sort(function(t,e){return t.id>e.id?1:t.id==e.id?0:-1});for(var i=0;i<this._iconArr.length;i++){var a=GameData.getItemIcon(this._iconArr[i],!0),n=i%4;a.setPosition((a.width+5)*n,(a.height+20)*Math.floor(i/4)),a.scaleX=t,a.scaleY=t,this._itemContainer.addChild(a),e=(a.height+20)*Math.floor(i/5)}this._itemContainer.setPosition(80,this._itemStringContainer.y+50+this._itemStringContainer.height),this._moveCountainer.addChild(this._itemContainer)},e.prototype.showTxt=function(){for(var t=0;t<this._strArr.length;t++){var e=ComponentManager.getTextField("0",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_GREEN);e.text=this._strArr[t];var i=t%2;e.setPosition(90+260*i,(e.height+20)*Math.floor(t/2)),this._itemStringContainer.addChild(e)}this._itemStringContainer.setPosition(0,10),this._moveCountainer.addChild(this._itemStringContainer)},e.prototype.showAnim=function(){this._fire_lizi.start();var t=this;egret.Tween.get(this._fire_lizi,{loop:!1}).wait(500).to({alpha:0},200).call(function(){this._fire_lizi&&(t.removeChildFromContainer(this._fire_lizi),this._fire_lizi=null)})},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this),this.closeBtn.y=this.viewBg.y,this.closeBtn.x=this.viewBg.x+this.viewBg.width-80},e.prototype.hide=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_TRADE_AFTER_FIGHT),t.prototype.hide.call(this)},e.prototype.dispose=function(){this._moveCountainer=null,this.rewardArrList=[],this.scrollView=null,this._strArr=[],this._iconArr=[],this._fire_lizi=null,this._itemStringContainer=null,this._itemContainer=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(TradeInfoPopupView.prototype,"TradeInfoPopupView");var TradeOneKeyPopupView=function(t){function e(){var e=t.call(this)||this;return e._useNum=1,e._maxNum=0,e._currId="",e}return __extends(e,t),e.prototype.initView=function(){this._useCallback=this.param.data.callback,this._handler=this.param.data.handler,this._currId=Api.tradeVoApi.getCurrentCid();var t=Api.tradeVoApi.getAttNum(Number(this._currId));this._maxNum=t,this._maxNum>200&&(this._maxNum=200);var e=BaseBitmap.create("public_9_resbg");e.setPosition(35,20),this.addChildToContainer(e);var i=BaseBitmap.create("public_icon2");i.setPosition(e.x-i.width/2+20,e.y-2),this.addChildToContainer(i);var a=App.StringUtil.changeIntToText(Api.playerVoApi.getPlayerGold()),n=ComponentManager.getTextField(a,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);n.setPosition(85,e.y+e.height/2-n.height/2),this.addChildToContainer(n);var o=(LanguageManager.getlocal("effectTitle"),BaseBitmap.create("public_9_bg4"));o.width=520,o.height=220,o.x=this.viewBg.x+this.viewBg.width/2-o.width/2,o.y=70,this.addChildToContainer(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("conquestChooseAtt"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);s.setPosition(50,o.y+15),this.addChildToContainer(s);var r=BaseBitmap.create("public_9_probiginnerbg");r.width=500,r.height=150,r.x=this.viewBg.x+this.viewBg.width/2-r.width/2,r.y=o.y+50,this.addChildToContainer(r);var l=this._currId,h=Number(this._currId)+Api.tradeVoApi.getAttNum(Number(this._currId))-1,d=LanguageManager.getlocal("conquestChooseNum",[l.toString(),h.toString()]);this._carNumTF=ComponentManager.getTextField(d,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._carNumTF.setPosition(50,r.y+15),this.addChildToContainer(this._carNumTF);var g=ComponentManager.getDragProgressBar("progress2","progress2_bg",this._maxNum,this.dragCallback,this);g.x=140,g.y=170,this.addChildToContainer(g);var c=App.StringUtil.changeIntToText(Api.tradeVoApi.getAttCostNum(Number(this._currId),1)),p=App.StringUtil.changeIntToText(Api.playerVoApi.getPlayerGold()),_=LanguageManager.getlocal("tradeCostNum",[c.toString(),p.toString()]);this._costNumTF=ComponentManager.getTextField(_,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._costNumTF.setPosition(this.viewBg.width/2-this._costNumTF.width/2,g.y+g.height+10),this.addChildToContainer(this._costNumTF);var u=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"useBtn",this.useHandler,this);u.x=o.x+o.width/2-u.width/2,u.y=o.y+o.height+15,u.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(u)},e.prototype.dragCallback=function(t){this._useNum=t;var e=Number(Api.tradeVoApi.getCurrentCid()),i=e-1+t,a=e-1+Api.tradeVoApi.getAttNum(e),n=LanguageManager.getlocal("conquestChooseNum",[i.toString(),a.toString()]);this._carNumTF.text=n;var o=App.StringUtil.changeIntToText(Api.tradeVoApi.getAttCostNum(e,t)),s=App.StringUtil.changeIntToText(Api.playerVoApi.getPlayerGold()),r=LanguageManager.getlocal("tradeCostNum",[o.toString(),s.toString()]);this._costNumTF.text=r},e.prototype.getTitleStr=function(){return"tradeBatchBtn"},e.prototype.useHandler=function(t){this._useCallback.apply(this._handler,[this._useNum-1]),this.hide()},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["progress2_bg","progress2"])},e.prototype.dispose=function(){this._useCallback=null,this._useNum=1,this._carNumTF=null,this._costNumTF=null,this._maxNum=0,this._handler=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(TradeOneKeyPopupView.prototype,"TradeOneKeyPopupView");var TradeRankItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=502,this.height=52;var i=TextFieldConst.COLOR_WHITE;if(e.uid==Api.playerVoApi.getPlayerID()&&(i=TextFieldConst.COLOR_WARN_YELLOW),3>t){var a=BaseBitmap.create("rankinglist_rank"+String(t+1));a.x=62-a.width/2,a.y=this.height/2-a.height/2,this.addChild(a)}else{var a=BaseBitmap.create("rankinglist_rankbg");a.x=62-a.width/2,a.y=this.height/2-a.height/2,this.addChild(a);var n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,i);n.text=String(t+1),n.x=62-n.width/2,n.y=this.height/2-n.height/2,this.addChild(n)}var o=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_CONTENT_COMMON,i);o.x=220-o.width/2,o.y=this.height/2-o.height/2,this.addChild(o);var s=ComponentManager.getTextField(e.point,TextFieldConst.FONTSIZE_CONTENT_COMMON,i);s.x=404-s.width/2,s.y=this.height/2-o.height/2,this.addChild(s);var r=BaseBitmap.create("dinner_line");r.x=260-r.width/2,r.y=this.height,this.addChild(r)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(TradeRankItem.prototype,"TradeRankItem");var TradeRankListView=function(t){function e(){var e=t.call(this)||this;return e._infoList=null,e._merank=0,e._mepoint=0,e.atkracedes5=null,e.isShowTextBoo=!1,e}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["rankinglist_line","rankinglist_rankbg","rankinglist_rank1","rankinglist_rank2","rankinglist_rank3"])},e.prototype.initView=function(){var t=["tradeRank"],e=ComponentManager.getTabBarGroup(ButtonConst.BTN_TAB,t,null,null);e.x=40,e.y=10,this.addChildToContainer(e);var i=BaseBitmap.create("public_9_probiginnerbg");i.width=520,i.height=526,i.setPosition(this.viewBg.width/2-i.width/2,e.y+e.height),this.addChildToContainer(i);var a=BaseBitmap.create("dinner_rank_titlebg");a.width=i.width,a.height=36,a.setPosition(i.x,i.y),this.addChildToContainer(a),this._scroRect=new egret.Rectangle(a.x,a.y+a.height,a.width,i.height-a.height-8),this._scrollList=ComponentManager.getScrollList(TradeRankItem,this._infoList,this._scroRect),this._scrollList.x=a.x,this._scrollList.y=a.y+a.height,this.addChildToContainer(this._scrollList);var n=BaseBitmap.create("public_9_probiginnerbg");n.width=516,n.height=84,n.setPosition(this.viewBg.width/2-n.width/2,i.y+i.height+8),this.addChildToContainer(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("rankorder"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);o.setPosition(65,a.y+a.height/2-o.height/2),this.addChildToContainer(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("ranknickName"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);s.setPosition(200,o.y),this.addChildToContainer(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("tradeScore"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);r.setPosition(387,o.y),this.addChildToContainer(r);var l=ComponentManager.getTextField(LanguageManager.getlocal("ranknickName")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);l.setPosition(o.x,n.y+n.height/2-5-l.height),this.addChildToContainer(l);var h=ComponentManager.getTextField(LanguageManager.getlocal("rankorder")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);h.setPosition(o.x,n.y+n.height/2+5),this.addChildToContainer(h);var d=ComponentManager.getTextField(Api.playerVoApi.getPlayerName(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);d.setPosition(l.x+l.width+12,l.y),this.addChildToContainer(d);var g=ComponentManager.getTextField(LanguageManager.getlocal("atkracedes5"),20);g.x=250,g.y=GameConfig.stageHeigth-530,this.addChild(g),g.visible=this.isShowTextBoo;var c;c=this._merank?this._merank>300?"10000+":this._merank.toString():LanguageManager.getlocal("atkracedes4");var p=ComponentManager.getTextField(c,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_GREEN);p.setPosition(h.x+h.width+12,h.y),this.addChildToContainer(p);var _="";_=this._mepoint?this._mepoint+"":"0";var u=ComponentManager.getTextField(_,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_QUALITY_GREEN);u.setPosition(n.x+n.width-20-u.width,h.y),this.addChildToContainer(u);var C=ComponentManager.getTextField(LanguageManager.getlocal("tradeScore")+":",TextFieldConst.FONTSIZE_CONTENT_COMMON);C.setPosition(u.x-20-C.width,h.y),this.addChildToContainer(C)},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_TRADE_RANK,requestData:{}}},e.prototype.receiveData=function(t){t.ret&&t.data.data.conrank[0]?(this._infoList=t.data.data.conrank,this._merank=t.data.data.merank,this._mepoint=t.data.data.mepoint,this.isShowTextBoo=!1):this.isShowTextBoo=!0},e.prototype.dispose=function(){this._scrollList=null,this._infoList=null,this._merank=0,t.prototype.dispose.call(this)},e}(PopupView);__reflect(TradeRankListView.prototype,"TradeRankListView");var TradeView=function(t){function e(){var e=t.call(this)||this;return e._preCid=0,e._lastNameCid=0,e._bgH=1274,e._lastTradeName="",e._lastTradeGold=0,e._lastTradeInte=0,e._laseIdStr="",e._btomY=0,e._shipMoving=!1,e.shipCfg=[{id:0,shipid:2,portid:1,portPosx:96,portPosy:0,shipPosX:219,shipPosY:144},{id:1,shipid:2,portid:4,portPosx:101,portPosy:144,shipPosX:198,shipPosY:289},{id:2,shipid:3,portid:2,portPosx:467,portPosy:292,shipPosX:521,shipPosY:450},{id:3,shipid:2,portid:3,portPosx:36,portPosy:482,shipPosX:113,shipPosY:654},{id:4,shipid:3,portid:5,portPosx:391,portPosy:664,shipPosX:409,shipPosY:803},{id:5,shipid:2,portid:1,portPosx:0,portPosy:787,shipPosX:130,shipPosY:942},{id:6,shipid:3,portid:2,portPosx:427,portPosy:959,shipPosX:401,shipPosY:1078},{id:7,shipid:2,portid:3,portPosx:32,portPosy:1054,shipPosX:111,shipPosY:1223},{id:8,shipid:3,portid:3,portPosx:449,portPosy:1255,shipPosX:494,shipPosY:1416}],e.shipNumPerPage=e.shipCfg.length-1,e.lastGoldNum=0,e._flag=0,e._batchBtn=null,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_TRADE_INDEX),this.indexInterfaceCallBack,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_TRADE_FIGHT),this.refreshAfterTrade,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_TRADE_BATCHFIGHT),this.refreshAfterTrade,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_REFRESH_TRADE_AFTER_FIGHT,this.refreshTradeInfoAfterFight,this),this._nodeContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._nodeContainer),this._nodeContainer2=new BaseDisplayObjectContainer;var t=BaseBitmap.create("trade_bg"),e=BaseBitmap.create("trade_bg");this._bg1=new BaseDisplayObjectContainer,this._bg1.addChild(t),this._bg2=new BaseDisplayObjectContainer,this._bg2.y=t.height,this._bg2.addChild(e),this._bgH=t.height,this._curTopBg=this._bg1,this._nextTopBg=this._bg2,this._nodeContainer.addChild(this._bg2),this._nodeContainer.addChild(this._bg1),this._tradeArrow=BaseBitmap.create("trade_arrow"),this._tradeArrow.anchorOffsetY=this._tradeArrow.height,this._tradeArrow.anchorOffsetX=this._tradeArrow.width/2,this._nodeContainer.addChild(this._tradeArrow);for(var i=0;i<2*this.shipNumPerPage;i++){var a=i%this.shipNumPerPage+1,n=this.shipCfg[a],o=BaseBitmap.create("trade_port"+n.portid);if(o.x=n.portPosx,o.y=n.portPosy,0==i){var s=BaseBitmap.create("trade_ship"+n.shipid);s.x=n.shipPosX,s.y=n.shipPosY,this._shipImg=s,this._shipImg.visible=!1,this._nodeContainer.addChild(s)}o.name="portImg"+a;var r=BaseBitmap.create("trade_namebg_red");r.x=o.x+20,r.name="namebg"+a,r.y=o.y+o.height/2-r.height/2;var l=ComponentManager.getTextField("",20);l.width=21,l.multiline=!0,l.x=r.x+r.width/2,l.y=r.y+r.height/2,l.name="nameTxt"+a,i<this.shipNumPerPage?(this._bg1.addChild(o),this._bg1.addChild(r),this._bg1.addChild(l)):(this._bg2.addChild(o),this._bg2.addChild(r),this._bg2.addChild(l))}Api.switchVoApi.checkOpenShenhe()||this.makeRankBtn();var h=BaseBitmap.create("trade_bottombg");h.y=GameConfig.stageHeigth-this._nodeContainer.y-h.height-this.container.y,this._nodeContainer2.addChild(h),this._btomY=h.y;var d=BaseBitmap.create("trade_bottomnumbg");d.x=30,d.y=h.y+55,this._nodeContainer2.addChild(d),this._curTradeNameTxt=ComponentManager.getTextField("",24,TextFieldConst.COLOR_LIGHT_YELLOW),this._curTradeNameTxt.x=d.x+25,this._curTradeNameTxt.y=d.y+d.height/2-12,this._nodeContainer2.addChild(this._curTradeNameTxt);var g=ComponentManager.getTextField(LanguageManager.getlocal("conquestGetItem"),20,TextFieldConst.COLOR_BROWN);g.x=40,g.y=d.y+48,this._nodeContainer2.addChild(g),this._rewardNodeContainer=new BaseDisplayObjectContainer,this._rewardNodeContainer.x=h.x,this._rewardNodeContainer.y=h.y,this._nodeContainer2.addChild(this._rewardNodeContainer);var c=Api.tradeVoApi.isBatchEnable();if(!c){var p=ComponentManager.getTextField(LanguageManager.getlocal("tradeBatchTip"),20,TextFieldConst.COLOR_BROWN);p.x=50,p.y=h.y+h.height-60,p.name="tipTxt",this._nodeContainer2.addChild(p)}var _=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"tradeBatchBtn",this.batchHandler,this);_.x=GameConfig.stageWidth/2-_.width-50,_.y=h.y+h.height-80,this._batchBtn=_,_.visible=c,this._nodeContainer2.addChild(_);var u=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"tradeBtn",this.tradeBtnHandler,this);u.x=GameConfig.stageWidth/2+50,u.y=_.y,this._nodeContainer2.addChild(u);for(var C=[{icon:"public_icon9",posx:150,posy:-5,num:Api.playerVoApi.getInte()},{icon:"public_icon2",posx:360,posy:-5,num:Api.playerVoApi.getPlayerGoldStr()},{icon:"public_icon9",posx:290,posy:d.y-5,num:""},{icon:"public_icon2",posx:450,posy:d.y-5,num:""}],f=0;f<C.length;f++){var m=C[f],T=BaseBitmap.create("public_9_resbg");T.x=m.posx,T.y=m.posy,this._nodeContainer2.addChild(T);var y=BaseBitmap.create(m.icon);y.x=T.x-2,y.y=T.y,this._nodeContainer2.addChild(y);var v=ComponentManager.getTextField(String(m.num),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);v.setPosition(y.x+50,y.y+12),this._nodeContainer2.addChild(v),v.name="numTxt"+f,f>1&&(v.setPosition(y.x+y.width,y.y+15),T.visible=!1,v.textColor=TextFieldConst.COLOR_BLACK)}var A=BaseBitmap.create("public_9_viewmask");A.width=GameConfig.stageWidth,A.height=56,A.y=-15,this.addChildToContainer(A),this.addChildToContainer(this._nodeContainer2),this.lastGoldNum=Api.playerVoApi.getPlayerGold(),this.setBatchInfo(!0),this.refreshTradeInfo(),this.refreshBaseInfo()},e.prototype.makeRankBtn=function(){var t=BaseBitmap.create("forpeople_bottom");t.x=5,t.y=50,this._nodeContainer2.addChild(t);var e=ComponentManager.getButton("trade_tanlBtn","",this.rankBtnHandler,this);e.x=t.x+t.width/2-e.width/2+8,e.y=t.y+t.height/2-e.height/2,this._nodeContainer2.addChild(e)},e.prototype.setBatchInfo=function(t){var e=Number(Api.tradeVoApi.getCurrentCid());if(t||e-this._preCid>1){this._bg1.y=0,this._bg2.y=this._bgH,this._curTopBg=this._bg1,this._nextTopBg=this._bg2,this._nodeContainer.y=0,this._tradeArrow.y=0,this._shipImg.y=0;var i=(e-1)%this.shipNumPerPage+1,a=Config.TradeCfg.getMaxTradeIndex();e>a&&(e=a),this._lastNameCid=Math.floor((e-i)/this.shipNumPerPage)*this.shipNumPerPage}},e.prototype.refreshTradeInfo=function(){this.setBatchInfo();var t=Number(Api.tradeVoApi.getCurrentCid()),e=Config.TradeCfg.getMaxTradeIndex();t-1==e&&(t=e);var i=Config.TradeCfg.getTradeCfgById(String(t));if(null!=i){var a=this._nodeContainer2.getChildByName("numTxt2"),n=this._nodeContainer2.getChildByName("numTxt3");a.text=App.StringUtil.changeIntToText(i.tradeInte),n.text=App.StringUtil.changeIntToText(i.tradeGold),this._curTradeNameTxt.text=t+" . "+i.tradeName,this._lastTradeName=i.tradeName,this._lastTradeGold=i.tradeGold,this._lastTradeInte=i.tradeInte,this._rewardNodeContainer.removeChildren();var o=Api.tradeVoApi.getCurrentRewards();if(o.length>0)for(var s=o.join("|"),r=GameData.getRewardItemIcons(s,!0),l=.8,h=0;h<r.length;h++){var d=r[h];d.setScale(l),d.x=25+(d.width*l+10)*h,d.y=127,this._rewardNodeContainer.addChild(d)}var g=!0,c=(t-2)%this.shipNumPerPage+1,p=(t-1)%this.shipNumPerPage+1;(0==this._preCid||t-this._preCid>1)&&(g=!1,this._preCid=t,1==p&&t>1&&(this._curTopBg=this._bg2,this._nextTopBg=this._bg1));var _=this.shipCfg[p],u=this.shipCfg[c],C=0,f=GameConfig.stageHeigth/2-100;if(this._curTopBg.y+_.shipPosY>f&&(C=_.shipPosY+this._curTopBg.y-f),this._shipImg.texture=ResourceManager.getRes("trade_ship"+_.shipid),!g)return egret.Tween.removeTweens(this._tradeArrow),this._tradeArrow.x=this._curTopBg.x+_.portPosx+104,this._tradeArrow.y=this._curTopBg.y+_.portPosy+30,egret.Tween.get(this._tradeArrow,{loop:!0}).to({y:this._tradeArrow.y+30},1e3).to({y:this._tradeArrow.y},1e3),this._shipImg.y=this._curTopBg.y+_.shipPosY,this._shipImg.x=_.shipPosX,this._shipImg.visible=!0,this._nodeContainer.y-=C,this.refreshNameTxt(!0),this.refreshnameBg(p),void(this._preCid=t);var m=!1;C=_.shipPosY-u.shipPosY,0>C&&(C+=this._bgH,m=!0);var T=this._nodeContainer.y-C;this._shipImg.x=u.shipPosX,T>0&&(T=0);var y=!1,v=void 0;this._preCid=t,this._curTopBg.y<this._nextTopBg.y?this._curTopBg.y+this._bgH+T<=this.container.y-15&&(y=!0,v=this._curTopBg.getChildByName("portImg"+p)):this._nextTopBg.y+this._bgH+T<=this.container.y-15&&(y=!0,v=this._nextTopBg.getChildByName("portImg"+p)),y||(this.refreshnameBg(p,m),egret.Tween.removeTweens(this._tradeArrow),m?(this._tradeArrow.x=this._nextTopBg.x+_.portPosx+104,this._tradeArrow.y=this._nextTopBg.y+_.portPosy+30):(this._tradeArrow.x=this._curTopBg.x+_.portPosx+104,this._tradeArrow.y=this._curTopBg.y+_.portPosy+30),this._nodeContainer.setChildIndex(this._tradeArrow,3),egret.Tween.get(this._tradeArrow,{loop:!0}).to({y:this._tradeArrow.y+30},1e3).to({y:this._tradeArrow.y},1e3));var A=this,w=1e4*Math.abs(C)/this._bgH,x=w;this._shipImg.texture=ResourceManager.getRes("trade_ship"+_.shipid),this._shipMoving=!0,egret.Tween.get(this._shipImg,{loop:!1}).to({x:_.shipPosX,y:this._shipImg.y+C},x).call(function(){A._shipMoving=!1},this),egret.Tween.get(this._nodeContainer,{loop:!1}).to({y:T},w).call(function(){y&&(A._bg1.y<A._bg2.y?(A._bg1.y+=2*A._bgH,A._curTopBg=A._bg2,A._nextTopBg=A._bg1):(A._bg2.y+=2*A._bgH,A._curTopBg=A._bg1,A._nextTopBg=A._bg2),A._nodeContainer.swapChildren(A._curTopBg,A._nextTopBg),egret.Tween.removeTweens(A._tradeArrow),A._tradeArrow.x=A._curTopBg.x+_.portPosx+104,A._tradeArrow.y=A._curTopBg.y+_.portPosy+30,egret.Tween.get(A._tradeArrow,{loop:!0}).to({y:A._tradeArrow.y+30},1e3).to({y:A._tradeArrow.y},1e3),A.refreshNameTxt(),A.refreshnameBg(p))},this)}},e.prototype.refreshnameBg=function(t,e){for(var i="trade_namebg_gray",a="trade_namebg_red",n=(Number(Api.tradeVoApi.getCurrentCid()),1);n<=this.shipNumPerPage;n++){var o=this._curTopBg.getChildByName("namebg"+n),s=this._nextTopBg.getChildByName("namebg"+n);e?(o.texture=ResourceManager.getRes(a),n>t?s.texture=ResourceManager.getRes(i):s.texture=ResourceManager.getRes(a)):(this._curTopBg.y<this._nextTopBg.y?s.texture=ResourceManager.getRes(i):s.texture=ResourceManager.getRes(a),n>t?o.texture=ResourceManager.getRes(i):o.texture=ResourceManager.getRes(a))}},e.prototype.refreshNameTxt=function(t){for(var e=this.shipNumPerPage,i=1;i<=this.shipNumPerPage;i++){var a=this._nextTopBg.getChildByName("nameTxt"+i),n=this._nextTopBg.getChildByName("namebg"+i),o=this._nextTopBg.getChildByName("portImg"+i);if(t){var s=this._curTopBg.getChildByName("portImg"+i),r=this._curTopBg.getChildByName("namebg"+i),l=this._curTopBg.getChildByName("nameTxt"+i);this.dealTradeName(l,r,s,this._lastNameCid+i),this.dealTradeName(a,n,o,this._lastNameCid+i+e)}else this.dealTradeName(a,n,o,this._lastNameCid+i)}t?this._lastNameCid+=2*this.shipNumPerPage:this._lastNameCid+=this.shipNumPerPage},e.prototype.dealTradeName=function(t,e,i,a){var n=Config.TradeCfg.getMaxTradeIndex();a>n&&(t.visible=!1,e.visible=!1,i.visible=!1),t.text=LanguageManager.getlocal("tradeName"+a),t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2},e.prototype.refreshBaseInfo=function(){var t=this._nodeContainer2.getChildByName("numTxt0"),e=this._nodeContainer2.getChildByName("numTxt1");t.text=App.StringUtil.changeIntToText(Api.playerVoApi.getInte()),e.text=Api.playerVoApi.getPlayerGoldStr()},e.prototype.indexInterfaceCallBack=function(t){var e=t.data.data;if(0==e.ret){e.data.trade._flag&&(this._flag=e.data.trade._flag);var i=Api.tradeVoApi.isBatchEnable(),a=this._nodeContainer2.getChildByName("tipTxt");a&&(a.visible=!i),this._batchBtn.visible=i}},e.prototype.refreshTradeInfoAfterFight=function(){var t=Number(Api.tradeVoApi.getCurrentCid()),e=Config.TradeCfg.getMaxTradeIndex();(e>=t||t>e&&t-this._preCid>1)&&this.refreshTradeInfo()},e.prototype.refreshAfterTrade=function(t){var e=t.data.data;if(0==e.ret){this.refreshBaseInfo(),(t.type==NetManager.getMessageName(NetRequestConst.REQUEST_TRADE_BATCHFIGHT)||Api.tradeVoApi.getCurrentTradeCfg())&&NetManager.request(NetRequestConst.REQUEST_TRADE_INDEX,{});var i={};if(i.consumeGold=e.data.fightusegold,i.rdata=e,t.type==NetManager.getMessageName(NetRequestConst.REQUEST_TRADE_BATCHFIGHT)){var a=Number(Api.tradeVoApi.getCurrentCid())-1,n=LanguageManager.getlocal("tradeName"+a);
i.tradeName=n,ViewController.getInstance().openView(ViewConst.COMMON.TRADEINFOPOPUPVIEW,i)}else i.rewards=e.rewards,i.tradeName=this._lastTradeName,i.tradeGold=this._lastTradeGold,i.tradeInte=this._lastTradeInte,ViewController.getInstance().openView(ViewConst.COMMON.TRADEFIGHTVIEW,i)}},e.prototype.getRuleInfo=function(){return"tradeViewDesc"},e.prototype.rankBtnHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.TRADERANKLISTVIEW)},e.prototype.batchHandler=function(){if(!this._shipMoving&&0!=Api.tradeVoApi.isBatchEnable()){var t=Api.tradeVoApi.getCurrentTradeCfg();return null==t?void App.CommonUtil.showTip(LanguageManager.getlocal("tradeMaxIdxTip")):Api.playerVoApi.getPlayerGold()<=0?void App.CommonUtil.showTip(LanguageManager.getlocal("tradeGoldTip1")):Api.tradeVoApi.getAttNum(Number(Api.tradeVoApi.getCurrentCid()))<=0?void App.CommonUtil.showTip(LanguageManager.getlocal("tradeGoldTip2")):void ViewController.getInstance().openView(ViewConst.POPUP.TRADEONEKEYPOPUPVIEW,{callback:this.callbackHandler,handler:this})}},e.prototype.callbackHandler=function(t){var e=Number(Api.tradeVoApi.getCurrentCid()),i=e+t;NetManager.request(NetRequestConst.REQUEST_TRADE_BATCHFIGHT,{cid:i})},e.prototype.tradeBtnHandler=function(){if(!this._shipMoving){if(Api.playerVoApi.getPlayerGold()<=0)return void App.CommonUtil.showTip(LanguageManager.getlocal("tradeGoldTip1"));var t=Api.tradeVoApi.getCurrentTradeCfg();return null==t?void App.CommonUtil.showTip(LanguageManager.getlocal("tradeMaxIdxTip")):void NetManager.request(NetRequestConst.REQUEST_TRADE_FIGHT,{})}},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["trade_bg","forpeople_bottom","trade_tanlBtn","trade_tanlBtn_down","studyatk_master_bg","trade_ship1","trade_ship2","trade_ship3","trade_pb_bottombg","trade_port1","trade_port2","trade_port3","trade_port4","trade_port5","servant_infoPro2","trade_arrow","trade_bottombg","trade_bottomnumbg","trade_namebg_gray","trade_namebg_red","trade_bg2"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_TRADE_INDEX),this.indexInterfaceCallBack,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_TRADE_FIGHT),this.refreshAfterTrade,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_TRADE_BATCHFIGHT),this.refreshAfterTrade,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_REFRESH_TRADE_AFTER_FIGHT,this.refreshTradeInfoAfterFight,this),this._curTradeNameTxt=null,this._nodeContainer=null,this._nodeContainer2=null,this._rewardNodeContainer=null,this._bg1=null,this._bg2=null,this._curTopBg=null,this._nextTopBg=null,this._shipImg=null,this._preCid=0,this._lastNameCid=0,this.lastGoldNum=0,this._lastTradeName=null,this._lastTradeGold=null,this._lastTradeInte=null,this._tradeArrow=null,this._shipMoving=!1,t.prototype.dispose.call(this)},e}(CommonView);__reflect(TradeView.prototype,"TradeView");var BuyGiftPopupView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e}return __extends(e,t),e.prototype.getResourceList=function(){var e=[];return this._titleResName="reward_success",e.push(this._titleResName),t.prototype.getResourceList.call(this).concat(e)},e.prototype.initView=function(){if(this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f),this.param.data&&"0"==this.param.data.code){var t=this._titleResName,e=BaseBitmap.create(t);e.setPosition((this.viewBg.width-e.width)/2,-25),this.addChildToContainer(e);var i=LanguageManager.getlocal("wanbaRewardTitle"),a=ComponentManager.getTextField(i,TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);a.setPosition((this.viewBg.width-a.width)/2,32),this.addChildToContainer(a);var n=LanguageManager.getlocal("wanbaRewardGetDesc",["100"]);"502"==PlatformManager.getGiftId()&&(n=LanguageManager.getlocal("wanbaRewardGetDesc",["200"]));var o=ComponentManager.getTextField(n,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);o.setPosition((this.viewBg.width-o.width)/2,a.y+a.height+10),this.addChildToContainer(o);for(var s=GameData.formatRewardItem(this.param.data.rewards),r=new BaseDisplayObjectContainer,l=s.length,h=.88,d=0,g=0;l>g;g++){var c=GameData.getItemIcon(s[g],!0),p=g%5;c.setPosition((c.width+20)*p,(c.height+20)*Math.floor(g/5)),c.setScale(h),r.addChild(c),d=(c.height+20)*Math.floor(g/5)}r.setPosition(this.viewBg.x+(this.viewBg.width-r.width)/2,100),this.addChildToContainer(r),GameData.wbrewards=null,GameData.wbrewardsFlag=!1}else{var i=this.getErrorTitle(this.param.data.code),a=ComponentManager.getTextField(i,TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_WARN_RED);a.setPosition((this.viewBg.width-a.width)/2,32),this.addChildToContainer(a);var n=this.getErrorMsg(this.param.data.code),o=ComponentManager.getTextField(n,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);o.setPosition((this.viewBg.width-o.width)/2,a.y+a.height+20),this.addChildToContainer(o)}},e.prototype.getErrorTitle=function(t){var e={2000:"系统繁忙",2001:"参数错误",2002:"拉取礼包数据出错",2003:"礼包兑换达到上限",2004:"非积分兑换礼包及VIP礼包，无需校验",2005:"积分不足，无法兑换积分礼包",2006:"用户非VIP，无法兑换VIP礼包",2007:"用户VIP等级与VIP礼包等级不符，无法兑换",2008:"礼包已过期",2009:"单用户兑换礼包次数限制"};return e[t]?e[t]:""},e.prototype.getErrorMsg=function(t){var e={2000:"请您稍后重试",2001:"请核实再尝试",2002:"请重新尝试",2003:"礼包每日仅可兑换一次\n请明天再来哦~！",2004:"祝您游戏愉快~！",2005:"请获得积分后，再来尝试",2006:"请升级VIP后再来尝试",2007:"请升级VIP后再来尝试",2008:"无法领取",2009:"超出兑换礼包次数上限"};return e[t]?e[t]:""},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this),this.closeBtn.y=this.closeBtn.y-15},e.prototype.getTitleStr=function(){return null},e.prototype.isTouchMaskClose=function(){return!0},e.prototype.getBgExtraHeight=function(){return 10},e.prototype.getBgName=function(){return"public_9_wordbg"},e.prototype.hide=function(){this._obj&&this._callbackF&&this._callbackF.apply(this._obj),t.prototype.hide.call(this)},e.prototype.dispose=function(){this._callbackF=null,this._obj=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(BuyGiftPopupView.prototype,"BuyGiftPopupView");var CoverView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this._canCheckCount=0,this._checking=!1,App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_OTHERINFO_SETCOVER,this.setCoverCallback,this),App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_OTHERINFO_GETCOVERREWARD,this.rewardCallback,this);var t=BaseBitmap.create("coverBg");t.y=-10,t.height=GameConfig.stageHeigth,this.addChildToContainer(t);var e="";e=0===Api.otherInfoVoApi.getCoverState()?"cover_goSetting":"taskCollect";var i=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,e,this.setOrGetRewardButtonHandler,this);i.x=GameConfig.stageWidth/2-i.width/2,i.y=810-i.height/2,i.name="setOrGetRewardBtn",this.addChildToContainer(i),this._oneBtn=i;var a=GameData.formatRewardItem(Config.GameprojectCfg.rewardWB5),n=egret.Rectangle.create();n.setTo(0,0,400,200),this._scrollList=ComponentManager.getScrollList(MailRewardScrollItem,a,n),this._scrollList.x=GameConfig.stageWidth/2-Math.min(4,a.length)/2*100,this._scrollList.y=545,this.addChildToContainer(this._scrollList);var o=ComponentManager.getTextField(LanguageManager.getlocal("cover_desc1"),TextFieldConst.FONTSIZE_CONTENT_COMMON);o.textAlign=TextFieldConst.ALIGH_LEFT,o.x=37,o.y=455-o.height/2,o.lineSpacing=10,this.addChildToContainer(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("cover_desc2"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_YELLOW);s.textAlign=TextFieldConst.ALIGH_CENTER,s.x=GameConfig.stageWidth/2-s.width/2,s.y=505-s.height/2,s.lineSpacing=10,this.addChildToContainer(s)},e.prototype.setCoverCallback=function(t){console.log("setCoverCallback");var e=t.data,i=e.ret;e.data;i&&this._oneBtn.setText("taskCollect")},e.prototype.rewardCallback=function(t){console.log("rewardCallback");var e=t.data,i=e.ret;e.data;i&&(App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.data.rewards)),this.hide())},e.prototype.setOrGetRewardButtonHandler=function(){console.log("setOrGetRewardButtonHandler"),0===Api.otherInfoVoApi.getCoverState()?(console.log("callBackDrop"),RSDKHelper.callBackDrop(),this._canCheckCount=3):1===Api.otherInfoVoApi.getCoverState()?this.request(NetRequestConst.REQUEST_OTHERINFO_GETCOVERREWARD,{}):console.log("已领取了奖励,为什么还要点按钮")},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["coverBg"])},e.prototype.tick=function(){var t=this;!this._checking&&this._canCheckCount>0&&(this._checking=!0,RSDKHelper.checkBackDrop(function(e){console.log("checkBackDrop检测结果"+e),t._checking=!1,e?(t._canCheckCount=0,t.request(NetRequestConst.REQUEST_OTHERINFO_SETCOVER,{})):t._canCheckCount--}))},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_OTHERINFO_SETCOVER,this.setCoverCallback,this),App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_OTHERINFO_GETCOVERREWARD,this.rewardCallback,this),this._scrollList=null,this._oneBtn=null,this._canCheckCount=0,this._checking=!1,t.prototype.dispose.call(this)},e}(CommonView);__reflect(CoverView.prototype,"CoverView");var DesktopPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=BaseBitmap.create("public_9_bg4");t.width=520,t.height=214,t.setPosition((this.viewBg.width-t.width)/2,10),this.addChildToContainer(t);var e=BaseBitmap.create("public_9_bg3");e.width=380,e.setPosition(t.x+(t.width-e.width)/2,t.y+8),this.addChildToContainer(e);var i=ComponentManager.getTextField(LanguageManager.getlocal("desktopConfirmDesc"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);i.setPosition(e.x+(e.width-i.width)/2,e.y+(e.height-i.height)/2),this.addChildToContainer(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("desktopSuccessDesc"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);a.setPosition(t.x+10,e.y+e.height+15),this.addChildToContainer(a);for(var n=GameData.getRewardItemIcons(Config.GameprojectCfg.rewardWB1,!0),o=n?n.length:0,s=0;o>s;s++){var r=n[s];r.setPosition(t.x+10+(r.width+10)*s,a.y+a.height+5),this.addChildToContainer(r)}var l=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"sysConfirm",this.confirmHandler,this);l.setPosition(t.x+(t.width-l.width)/2,t.y+t.height+10),this.addChildToContainer(l)},e.prototype.confirmHandler=function(){PlatformManager.checkIsTWBSp()?App.DeviceUtil.IsMobile()||this.showHand():(PlatformManager.sendToDesktop(this.sendCallback,this),this.request(NetRequestConst.REQUEST_OTHERINFO_GETWBSENDREWARD,{}))},e.prototype.sendCallback=function(t){this.showHand()},e.prototype.showHand=function(){if(this._handContainer)this._handContainer.visible=!0;else{this._handContainer=new BaseDisplayObjectContainer,this.addChild(this._handContainer);var t=BaseBitmap.create("public_9_viewmask");t.width=GameConfig.stageWidth,t.height=GameConfig.stageHeigth,t.touchEnabled=!0,this._handContainer.addChild(t),t.addTouchTap(this.hideMask,this);var e=BaseBitmap.create("twsshareDesc");e.x=GameConfig.stageWidth/2-e.width/2,e.y=GameConfig.stageHeigth/2-e.height/2,this._handContainer.addChild(e)}},e.prototype.showHand2=function(){if(this._handContainer)this._handContainer.visible=!0;else{this._handContainer=new BaseDisplayObjectContainer,this.addChild(this._handContainer);var t=BaseBitmap.create("public_9_viewmask");t.width=GameConfig.stageWidth,t.height=GameConfig.stageHeigth,this._handContainer.addChild(t);var e=BaseBitmap.create("public_9_viewmask");e.width=GameConfig.stageWidth,e.height=GameConfig.stageHeigth,e.touchEnabled=!0,this._handContainer.addChild(e),e.addTouchTap(this.hideMask,this);var i=BaseBitmap.create("twshareicon");i.x=GameConfig.stageWidth/2-i.width/2,i.y=170,this._handContainer.addChild(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("twShareName"),TextFieldConst.FONTSIZE_TITLE_COMMON);a.textAlign=TextFieldConst.ALIGH_CENTER,a.x=GameConfig.stageWidth/2-a.width/2,a.y=i.y+i.height+10,a.lineSpacing=10,this._handContainer.addChild(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("twShareMsg1"),TextFieldConst.FONTSIZE_TITLE_COMMON);n.x=GameConfig.stageWidth/2-n.width/2,n.y=a.y+a.height+100,this._handContainer.addChild(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("twShareMsg2"),TextFieldConst.FONTSIZE_TITLE_COMMON);o.x=GameConfig.stageWidth/2-o.width/2-30,o.y=n.y+n.height+30,this._handContainer.addChild(o);var s=BaseBitmap.create("twsshareDescicon");s.x=o.x+o.width+20,s.y=o.y-10,this._handContainer.addChild(s);var r=ComponentManager.getTextField(LanguageManager.getlocal("twShareMsg3"),TextFieldConst.FONTSIZE_TITLE_COMMON);r.x=GameConfig.stageWidth/2-r.width/2,r.y=o.y+o.height+30,this._handContainer.addChild(r);var l=BaseBitmap.create("studyatk_arrow");l.x=300,l.y=GameConfig.stageHeigth-l.height-30,this._handContainer.addChild(l),egret.Tween.get(l,{loop:!0}).to({y:GameConfig.stageHeigth-l.height-70},500).to({y:GameConfig.stageHeigth-l.height-30},500)}},e.prototype.hideMask=function(){this._handContainer&&(this._handContainer.visible=!1),this.request(NetRequestConst.REQUEST_OTHERINFO_GETWBSENDREWARD,{})},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["twsshareDesc","twsshareDescicon","studyatk_arrow","twshareicon"])},e.prototype.dispose=function(){this._handContainer=null,t.prototype.dispose.call(this)},e.prototype.receiveData=function(t){t.ret&&t.data.cmd==NetRequestConst.REQUEST_OTHERINFO_GETWBSENDREWARD&&t.data.data.rewards&&(ViewController.getInstance().openView(ViewConst.POPUP.COMMONREWARDPOPUPVIEW,t.data.data.rewards),this.hide())},e}(PopupView);__reflect(DesktopPopupView.prototype,"DesktopPopupView");var DownloadView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t="";t=PlatformManager.checkIsWanbaSp()?"downloadRewordBg3":App.DeviceUtil.IsMobile()?"downloadRewordBg2":"downloadRewordBg";var e=BaseBitmap.create(t);if(e.x=10,this.addChildToContainer(e),PlatformManager.checkIsWanbaSp()&&App.DeviceUtil.isAndroid()&&!App.DeviceUtil.wanbaIsDownloadApp||PlatformManager.checkIsTWBSp()&&App.DeviceUtil.IsMobile()){var i=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"downloadPackage",this.downloadButtonHandler,this);i.x=400-i.width/2,i.y=222-i.height/2,i.name="goDownloadBtn",this.addChildToContainer(i)}else if(PlatformManager.checkIsWanbaSp()&&App.DeviceUtil.isAndroid()&&App.DeviceUtil.wanbaIsDownloadApp){var a=BaseBitmap.create("weiduanreward_getlabel");a.x=400-a.width/2,a.y=222-a.height/2,this.addChildToContainer(a)}var n="";PlatformManager.checkIsTWBSp()?n=Config.GameprojectCfg.rewardGT:PlatformManager.checkIsWanbaSp()&&(n=Config.GameprojectCfg.rewardWB4);var o=GameData.formatRewardItem(n),s=egret.Rectangle.create();s.setTo(0,0,500,110),this._scrollList=ComponentManager.getScrollList(MailRewardScrollItem,o,s),this._scrollList.x=284-Math.min(5,o.length)/2*100,this._scrollList.y=320,this.addChildToContainer(this._scrollList)},e.prototype.downloadButtonHandler=function(){PlatformManager.checkIsWanbaSp()&&App.DeviceUtil.isAndroid()?qqwanbaplugin.downloadApp():PlatformManager.checkIsTWBSp()&&window.open("https://go.onelink.me/FcNW?pid=H5")},e.prototype.getShowHeight=function(){return 500},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["downloadRewordBg","downloadRewordBg2","downloadRewordBg3","weiduanreward_getlabel"])},e.prototype.getTitleStr=function(){return PlatformManager.checkIsTWBSp()?"downloadViewTitle":PlatformManager.checkIsWanbaSp()?App.DeviceUtil.wanbaIsDownloadApp?"downloadViewTitle2":"downloadViewTitle1":"downloadViewTitle"},e.prototype.dispose=function(){this._scrollList=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(DownloadView.prototype,"DownloadView");var GetGiftPopupView=function(t){function e(){var e=t.call(this)||this;return e._callbackF=null,e._obj=null,e}return __extends(e,t),e.prototype.getResourceList=function(){var e=[];return GameData.wbrewardsFlag?this._titleResName="reward_success":this._titleResName="",e.push(this._titleResName),t.prototype.getResourceList.call(this).concat(e)},e.prototype.initView=function(){this.param.data&&this.param.data.f&&this.param.data.o&&(this._obj=this.param.data.o,this._callbackF=this.param.data.f);var t=this._titleResName,e=BaseBitmap.create(t);e.setPosition((this.viewBg.width-e.width)/2,-25),this.addChildToContainer(e);var i=GameData.wbrewardsFlag?LanguageManager.getlocal("getRewardTitle"):LanguageManager.getlocal("hasGetRewardTodayTitle"),a=ComponentManager.getTextField(i,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);a.setPosition((this.viewBg.width-a.width)/2,28),this.addChildToContainer(a);for(var n=GameData.formatRewardItem(this.param.data.rewards),o=new BaseDisplayObjectContainer,s=n.length,r=.88,l=0,h=0;s>h;h++){var d=GameData.getItemIcon(n[h],!0),g=h%5;d.setPosition((d.width+20)*g,(d.height+20)*Math.floor(h/5)),d.setScale(r),o.addChild(d),l=(d.height+20)*Math.floor(h/5)}o.setPosition(this.viewBg.x+(this.viewBg.width-o.width)/2,65),this.addChildToContainer(o);var c=ComponentManager.getTextField(LanguageManager.getlocal("getRewardDesc"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_QUALITY_GREEN);c.setPosition((this.viewBg.width-c.width)/2,l+178),c.visible=!1,this.addChildToContainer(c),GameData.wbrewards=null,GameData.wbrewardsFlag=!1},e.prototype.resetBgSize=function(){t.prototype.resetBgSize.call(this),this.closeBtn.y=this.closeBtn.y-15},e.prototype.getTitleStr=function(){return null},e.prototype.isTouchMaskClose=function(){return!0},e.prototype.getBgExtraHeight=function(){return 10},e.prototype.getBgName=function(){return"public_9_wordbg"},e.prototype.hide=function(){this._obj&&this._callbackF&&this._callbackF.apply(this._obj),t.prototype.hide.call(this)},e.prototype.dispose=function(){this._callbackF=null,this._obj=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(GetGiftPopupView.prototype,"GetGiftPopupView");var SharePopupView=function(t){function e(){var e=t.call(this)||this;return e._shareType=0,e}return __extends(e,t),e.prototype.initView=function(){this._shareType=PlatformManager.checkShare(),2==this._shareType?this.showFkylcInfo():this.showWanbaInfo()},e.prototype.showFkylcInfo=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_WANBA_SHARE_SUCCESS,this.sendShareSuccess,this);var t=ComponentManager.getTextField(LanguageManager.getlocal(PlatformManager.checkIsAiweiyouSp()?"fkylcShareTip_aiweiyou":"fkylcShareTip"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);t.x=this.viewBg.width/2-t.width/2,t.y=20,this.addChildToContainer(t);var e=BaseBitmap.create("public_9_probiginnerbg");e.width=528,e.height=614,e.x=this.viewBg.x+this.viewBg.width/2-e.width/2,e.y=50,this.addChildToContainer(e),this.refreshView();var i=LanguageManager.getlocal("fkylcGetCD",["00:00:00"]);this._timeLabel=ComponentManager.getTextField(i,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK),this._timeLabel.setPosition(this.viewBg.width/2-this._timeLabel.width/2,690),this.addChildToContainer(this._timeLabel);var a=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,this.getTitleStr(),this.showHand,this);a.setPosition(this.viewBg.width/2-a.width/2,this._timeLabel.y+this._timeLabel.height+20),this.addChildToContainer(a),this.tick()},e.prototype.getFKYLCItem=function(t,e,i){var a=Api.otherInfoVoApi.getFkShareInfo(),n=new BaseDisplayObjectContainer,o=t,s=GameData.getRewardItemIcons(o,!0),r=BaseBitmap.create("public_9_bg14");r.width=514,r.height=190,n.addChild(r);for(var l=0;l<s.length;l++)s[l].setPosition(r.x+20+(s[l].width+10)*l,r.y+15),n.addChild(s[l]);var h=BaseBitmap.create("public_line1");h.x=n.width/2-h.width/2,h.y=127,n.addChild(h);var d=LanguageManager.getlocal(PlatformManager.checkIsAiweiyouSp()?"fkylcShareNum_aiweiyou":"fkylcShareNum",[i]),g=ComponentManager.getTextField(d,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);g.x=30,g.y=145,n.addChild(g);var c=0;a&&(c=a.n);var p,_=TextFieldConst.COLOR_WARN_RED;p="("+c+"/"+i+")",c>=Number(i)&&(_=TextFieldConst.COLOR_WARN_GREEN2);var u=ComponentManager.getTextField(p,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);u.x=165,u.y=145,u.textColor=_,n.addChild(u);var C=1;if(C=a&&c>=Number(i)?1==a.get[i]?2:1:3,1==C){var f=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskCollect",this.getBtnCilck,this,[i]);f.x=350,f.y=134,n.addChild(f),f.setColor(TextFieldConst.COLOR_BLACK),f.bindData=e}else if(3==C){var f=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskCollect",this.getBtnCilck,this,[i]);f.x=350,f.y=134,n.addChild(f),f.setColor(TextFieldConst.COLOR_BLACK),f.bindData=e,f.setEnable(!1)}else{var m=BaseBitmap.create("achievement_state3");m.x=378,m.y=124,m.setScale(.7),n.addChild(m)}return n},e.prototype.getBtnCilck=function(t){this.request(NetRequestConst.REQUEST_OTHERINFO_GETFKSHAREREWARD,{key:t})},e.prototype.showHand=function(){if(this._handContainer)this._handContainer.visible=!0;else{this._handContainer=new BaseDisplayObjectContainer,this.addChild(this._handContainer);var t=BaseBitmap.create("public_9_viewmask");t.width=GameConfig.stageWidth,t.height=GameConfig.stageHeigth,t.touchEnabled=!0,this._handContainer.addChild(t),t.addTouchTap(this.hideMask,this);var e=BaseBitmap.create("guide_hand");e.skewY=180,e.x=590,e.y=10,this._handContainer.addChild(e),egret.Tween.get(e,{loop:!0}).to({y:60},500).to({y:10},500);var i=ComponentManager.getTextField(LanguageManager.getlocal("fkylcGetMsgTip"),TextFieldConst.FONTSIZE_TITLE_COMMON);i.textAlign=TextFieldConst.ALIGH_CENTER,i.x=GameConfig.stageWidth/2-i.width/2,i.y=GameConfig.stageHeigth/2-i.height/2,i.lineSpacing=10,this._handContainer.addChild(i)}},e.prototype.hideMask=function(){this._handContainer&&(this._handContainer.visible=!1)},e.prototype.tick=function(){var t=Api.otherInfoVoApi.getFkShareInfo();if(t&&t.et&&t.et>GameData.serverTime){var e=App.DateUtil.getFormatBySecond(t.et-GameData.serverTime,1),i=LanguageManager.getlocal("fkylcGetCD",[e]);this._timeLabel.text=i,this._timeLabel.visible=!0}else this._timeLabel&&(this._timeLabel.visible=!1)},e.prototype.refreshView=function(){this._itemContainer&&(this.removeChildFromContainer(this._itemContainer),this._itemContainer=null),this._itemContainer=new BaseDisplayObjectContainer,this.addChildToContainer(this._itemContainer);var t=Config.GameprojectCfg.rewardFKYLC2,e=Object.keys(t);e.sort(function(t,e){return Number(t)-Number(e)});for(var i=e.length,a=0;i>a;a++){var n=this.getFKYLCItem(t[e[a]],a,e[a]);this._itemContainer.addChild(n),n.x=30,n.y=60+(n.height+10)*a}},e.prototype.showWanbaInfo=function(){var t=BaseBitmap.create("public_9_bg4");t.width=520,t.height=184,t.setPosition((this.viewBg.width-t.width)/2,10),this.addChildToContainer(t);var e=ComponentManager.getTextField(LanguageManager.getlocal("shareSuccessRewardDesc"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);e.setPosition(t.x+10,t.y+25),this.addChildToContainer(e);for(var i=GameData.getRewardItemIcons(Config.GameprojectCfg.rewardWB2,!0),a=i?i.length:0,n=0;a>n;n++){var o=i[n];o.setPosition(t.x+10+(o.width+10)*n,e.y+e.height+5),this.addChildToContainer(o)}var s=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"sharePopupViewTitle",this.confirmHandler,this);s.setPosition(t.x+(t.width-s.width)/2,t.y+t.height+10),this.addChildToContainer(s)},e.prototype.confirmHandler=function(){PlatformManager.share(this.requestReward,this)},e.prototype.sendShareSuccess=function(){this.hideMask(),this.request(NetRequestConst.REQUEST_OTHERINFO_FKSHARE,{})},e.prototype.getTitleStr=function(){return 1==PlatformManager.checkIsAiweiyouSp()?"sharePopupViewTitle_aiweiyou":"sharePopupViewTitle"},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["achievement_state3","guide_hand"])},e.prototype.requestReward=function(){this.request(NetRequestConst.REQUEST_OTHERINFO_GETWBDAILYSHAREREWARD,{})},e.prototype.receiveData=function(t){t.ret&&(t.data.cmd==NetRequestConst.REQUEST_OTHERINFO_GETWBDAILYSHAREREWARD&&t.data.data.rewards&&(ViewController.getInstance().openView(ViewConst.POPUP.COMMONREWARDPOPUPVIEW,t.data.data.rewards),this.hide()),t.data.cmd==NetRequestConst.REQUEST_OTHERINFO_GETFKSHAREREWARD&&(t.data.data.rewards&&ViewController.getInstance().openView(ViewConst.POPUP.COMMONREWARDPOPUPVIEW,t.data.data.rewards),this.refreshView()),t.data.cmd==NetRequestConst.REQUEST_OTHERINFO_FKSHARE&&this.refreshView())},e.prototype.dispose=function(){this._itemContainer=null,this._handContainer=null,this._timeLabel=null,this._shareType=0,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_WANBA_SHARE_SUCCESS,this.sendShareSuccess,this),t.prototype.dispose.call(this)},e}(PopupView);__reflect(SharePopupView.prototype,"SharePopupView"),window.rsdkShareCallback=function(t){if(0==Number(t)){var e=ViewController.getInstance().getView(ViewConst.POPUP.SHAREPOPUPVIEW);e.isInit()?App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_WANBA_SHARE_SUCCESS):NetManager.request(NetRequestConst.REQUEST_OTHERINFO_FKSHARE,null)}};var WelfareView=function(t){function e(){var e=t.call(this)||this;return e._functionConfig=["RechargeBox","Signin","FirstRecharge","MonthCard","YearCard","GodBless","Binding","OfficialWeChat","Realname","FunctionPreview","Qgroup","Rebate"],e._tabbarList=[],e._leftBg=null,e._tabbarTextList=[],e._lastFirstRechargeflag=null,e._lastSigninShowRedDot=null,e}return __extends(e,t),e.prototype.show=function(e){if(this._functionConfig=Api.arrivalVoApi.getFunctionCfgList(),PlatformManager.checkIsShenHeYiWan()||Api.switchVoApi.checkTWShenhe())for(var i=["YearCard","MonthCard"],a=0,n=i;a<n.length;a++){var o=n[a],s=this._functionConfig.indexOf(o);s>-1&&this._functionConfig.splice(s,1)}e&&e.tab&&(this.selectedTabIndex=this._functionConfig.indexOf(e.tab));for(var r=0;r<this._functionConfig.length;r++){var l=this._functionConfig[r].toLowerCase();this._tabbarList.push(l+"_btn"),this._tabbarTextList.push("")}this.tabViewData={},t.prototype.show.call(this,e)},e.prototype.initView=function(){if(PlatformManager.checkIsShenHeYiWan()||Api.switchVoApi.checkTWShenhe())for(var t=["YearCard","MonthCard"],e=0,i=t;e<i.length;e++){var a=i[e],n=this._functionConfig.indexOf(a);n>-1&&this._functionConfig.splice(n,1)}App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_SHOP,this.checkTabbarGroupState,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_ARRIVAL,this.checkTabbarGroupState,this),App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_OTHERINFO_GETAUTHOR3KREWARD,this.checkTabbarGroupState,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_RECHARFGE_BOX_TIMEOUT,this.hide,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_REFRESH_YEARCARD_VIEW,this.hideAndShowYearCard,this),App.MessageHelper.addNetMessage(NetRequestConst.REQUEST_OTHERINFO_GETUNLOCKLISTREWARD,this.refreshFunctionRed,this);var o=BaseBitmap.create("common_left_bg");o.x=0,o.y=0,o.height=GameConfig.stageHeigth-this.container.y,this.addChildToContainer(o),this._leftBg=o},e.prototype.hideAndShowYearCard=function(){this.hide(),ViewController.getInstance().openView(ViewConst.COMMON.WELFAREVIEWYEARCARD)},e.prototype.changeTab=function(){var t=egret.getDefinitionByName(this.getClassName()+this._functionConfig[this.selectedTabIndex]);if(t){if(this.tabViewData[this.selectedTabIndex])this.addChildToContainer(this.tabViewData[this.selectedTabIndex]);else{var e=new t;e.show(),e.setPosition(149,0),this.tabViewData[this.selectedTabIndex]=e,this.addChildToContainer(e)}null!=this.lastSelectedTabIndex&&this.tabViewData[this.lastSelectedTabIndex]&&this.removeChildFromContainer(this.tabViewData[this.lastSelectedTabIndex])}},e.prototype.initTabbarGroup=function(){var t=new BaseDisplayObjectContainer,e=GameConfig.stageHeigth-this.container.y+10,i=new egret.Rectangle(0,0,GameConfig.stageWidth,e),a=ComponentManager.getScrollView(t,i);a.y=90,a.bounces=!1,this.addChild(a);var n=this.getTabbarTextArr();if(n&&n.length>0){this.tabbarGroup=ComponentManager.getTabBarGroup(this.getTabbarName(),n,this.clickTabbarHandler,this);t.addChild(this.tabbarGroup),this.container.y=this.getTitleButtomY(),this.tabbarGroup.selectedIndex=this._selectedTabIndex}this.tabbarGroup.setAligh(TabBarGroup.ALIGN_VERTICAL),this.tabbarGroup.x=0,this.tabbarGroup.y=0,this.container.y=89,this.tabbarGroup.setSpace(6),this.tabbarGroup.addLine("welfare_line"),this.tabbarGroup.selectedIndex=this.selectedTabIndex,this.checkTabbarGroupState(),this.refreshFunctionRed()},e.prototype.checkTabbarGroupState=function(){var t=Api.shopVoApi.getPayFlag(),e=this._functionConfig.indexOf("FirstRecharge");(null==this._lastFirstRechargeflag||this._lastFirstRechargeflag!=t)&&(this._lastFirstRechargeflag=t,1==t?this.tabbarGroup.showStatusIcon(e,"public_dot2"):this.tabbarGroup.removeStatusIcon(e));var i=Api.arrivalVoApi.isShowRedDot,a=this._functionConfig.indexOf("Signin");(null==this._lastSigninShowRedDot||this._lastSigninShowRedDot!=i)&&(this._lastSigninShowRedDot=i,1==i?this.tabbarGroup.showStatusIcon(a,"public_dot2"):this.tabbarGroup.removeStatusIcon(a));var n=this._functionConfig.indexOf("Realname");Api.otherInfoVoApi.checkrealnamerewards()&&PlatformManager.client.checkPerson()?this.tabbarGroup.showStatusIcon(n,"public_dot2"):this.tabbarGroup.removeStatusIcon(n)},e.prototype.refreshFunctionRed=function(){var t=this._functionConfig.indexOf("FunctionPreview");1==Api.otherInfoVoApi.getFunctionRedhot()?this.tabbarGroup.showStatusIcon(t,"public_dot2"):this.tabbarGroup.removeStatusIcon(t)},e.prototype.getTabbarTextArr=function(){return this._tabbarTextList},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(this._tabbarList).concat(["firstrecharge_bottom","firstrecharge2_bg","firstrecharge_font","firstrechargemask_bg","common_9_bg","common_left_bg","welfare_line","signin_had_get","welfare_hasbuy","itemeffect","monthcard_bigicon","yearcard_bigicon","godbless_bookRoom","godbless_child","godbless_manage","godbless_rank","godbless_servantLv","godbless_wife","signin2_bg","signin3_bg","rechargebox_bg1","rechargebox_bg2","rechargebox_bg","dinner_gems_1","unlock_challenge_skip","unlock_practice"])},e.prototype.getTabbarName=function(){return this._tabbarList},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.tick=function(){this.getSelectedTab()&&this.getSelectedTab().tick&&this.getSelectedTab().tick.call(this.getSelectedTab())},e.prototype.dispose=function(){if(App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_SHOP,this.checkTabbarGroupState,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_ARRIVAL,this.checkTabbarGroupState,this),App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_OTHERINFO_GETAUTHOR3KREWARD,this.checkTabbarGroupState,this),App.MessageHelper.removeNetMessage(NetRequestConst.REQUEST_OTHERINFO_GETUNLOCKLISTREWARD,this.refreshFunctionRed,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_RECHARFGE_BOX_TIMEOUT,this.hide,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_REFRESH_YEARCARD_VIEW,this.hideAndShowYearCard,this),this.tabViewData){for(var e in this.tabViewData){var i=this.tabViewData[e];i&&(this.container.contains(i)&&this.removeChildFromContainer(i),i.dispose(),i=null)}this.tabViewData=null}this._tabbarList=[],this._leftBg=null,this._tabbarTextList=[],this._lastFirstRechargeflag=null,this._lastSigninShowRedDot=null,this.tabbarGroup&&(this.tabbarGroup=null),t.prototype.dispose.call(this)},e}(CommonView);__reflect(WelfareView.prototype,"WelfareView");var WelfareViewBinding=function(t){function e(){return t.call(this)||this
}return __extends(e,t),e.prototype.init=function(){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_OTHERINFO_GETBINDREWARD),this.useCallback,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_IOS_BINDPHONE,this.bindCallBackIos,this),t.prototype.init.call(this);var e=491,i=this.bottomBg.height+this.bottomBg.y,a=Api.gameinfoVoApi.getRegdt(),n=App.DateUtil.getFormatBySecond(a,9),o=App.DateUtil.getFormatBySecond(a+86400*Config.GameprojectCfg.reward3KlastTime,9),s=Math.ceil(30-(GameData.serverTime-a)/86400),r=LanguageManager.getlocal("getBindingTime",[n,o,s.toString()]),l=ComponentManager.getTextField(r,TextFieldConst.FONTSIZE_CONTENT_COMMON);l.x=10,l.y=this.bottomBg.y-26,this.addChild(l);var h=ComponentManager.getTextField(LanguageManager.getlocal("bindRewardTitle"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);h.width=this.width-50,h.setPosition(30,this.bottomBg.y+25),this.addChild(h);var d=BaseBitmap.create("public_9_managebg");d.width=e-40,d.height=330,d.x=e/2-d.width/2,d.y=h.y+h.height+10,this.addChild(d);var g=ComponentManager.getTextField(LanguageManager.getlocal("bindRewardDesc"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);g.width=this.width-50,g.lineSpacing=10,g.setPosition(30,d.y+15),this.addChild(g);var c=BaseBitmap.create("public_line3");c.width=e-100,c.x=e/2-c.width/2,c.y=d.y+d.height+20,this.addChild(c);var p=ComponentManager.getTextField(LanguageManager.getlocal("bindReward"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);p.x=c.x+c.width/2-p.width/2,p.y=c.y+c.height/2-p.height/2,this.addChild(p);var _=BaseBitmap.create("public_9_bg21");_.width=e-40,_.height=100,_.x=e/2-_.width/2,_.y=c.y+35,this.addChild(_);for(var u=.8,C=15,f=GameData.formatRewardItem(Config.GameprojectCfg.reward3K),m=f.length,T=0;T<f.length;T++){var y=GameData.getItemIcon(f[T],!0,!0);y.scaleX=y.scaleY=u,y.x=_.x+_.width/2+y.width*u*(T-m/2)+C*(T-(m-1)/2),y.y=_.y+7,this.addChild(y)}var v=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"bindPhone",this.bindBtnHandler,this);v.x=e/4*1-v.width/2,v.y=_.y+_.height+48-v.height/2,this.addChild(v),this._bindBtn=v,PlatformManager.isSupportBindPhone()&&(PlatformManager.client.checkBindPhone()||"1"==GameData.kkkIsBindIos)&&(v.setEnable(!1),v.setText("bindPhone2"));var A=Api.otherInfoVoApi.isGetBindingReward();if(A){var w=BaseBitmap.create("signin_had_get");w.x=4*e/4-w.width/2,w.y=i-w.height-35,w.y=_.y+_.height+48-w.height/2,this.addChild(w)}else{var x=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"taskCollect",this.getBtnHandler,this);x.x=e/4*3-x.width/2,x.y=_.y+_.height+48-x.height/2,this.addChild(x),this._getBtn=x,this._getBtn.setEnable(!1),(PlatformManager.client.checkBindPhone()||"1"==GameData.kkkIsBindIos)&&this._getBtn.setEnable(!0)}},e.prototype.bindBtnHandler=function(){PlatformManager.client.showBindPhoneView(this.bindCallBack,this)},e.prototype.bindCallBack=function(t){"true"==t?(GameData.kkkIsBindIos="1",this._bindBtn.setEnable(!1),this._bindBtn.setText("bindPhone2"),this._getBtn.setEnable(!0)):App.CommonUtil.showTip(LanguageManager.getlocal("bindPhoneFailTip"))},e.prototype.bindCallBackIos=function(t){var e=t.data;"1"==e.result?(this._bindBtn.setEnable(!1),this._bindBtn.setText("bindPhone2"),this._getBtn.setEnable(!0)):App.CommonUtil.showTip(LanguageManager.getlocal("bindPhoneFailTip"))},e.prototype.getBtnHandler=function(){NetManager.request(NetRequestConst.REQUEST_OTHERINFO_GETBINDREWARD,null)},e.prototype.useCallback=function(t){void 0===t&&(t=null);Api.shopVoApi.getPayFlag();if(this._getBtn){this._getBtn.visible=!1;var e=BaseBitmap.create("signin_had_get");e.x=this._getBtn.x+this._getBtn.width/2-e.width/2,e.y=this._getBtn.y+this._getBtn.height/2-e.height/2,this.addChild(e);var i=GameData.formatRewardItem(Config.GameprojectCfg.reward3K);if(i){var a=this.localToGlobal(this._getBtn.x,this._getBtn.y-40),n=new egret.Point(a.x+55,a.y-30);App.CommonUtil.playRewardFlyAction(i,n)}}},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_PAYMENT,this.useCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_OTHERINFO_GETBINDREWARD),this.useCallback,this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_IOS_BINDPHONE,this.bindCallBackIos,this),this._getBtn=null,t.prototype.dispose.call(this)},e}(WelfareViewTab);__reflect(WelfareViewBinding.prototype,"WelfareViewBinding");var WelfareViewFirstRecharge=function(t){function e(){var e=t.call(this)||this;return e._goToRechargeBtn=null,e.isWanba=!1,e._container=null,e.getBtnY=0,e}return __extends(e,t),e.prototype.init=function(){if(App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SHOP_FIRSTCHARGEREWARD),this.useCallback,this),this.isWanba=Api.switchVoApi.checknewRecharge(),t.prototype.init.call(this),this.isWanba)return void this.showWanbaPanel();var e=491,i=(this.bottomBg.height+this.bottomBg.y,BaseBitmap.create("public_line3"));i.width=e-100,i.x=e/2-i.width/2,i.y=this.bottomBg.y+25,this.addChild(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("firstRecharge"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);a.x=i.x+i.width/2-a.width/2,a.y=i.y+i.height/2-a.height/2,this.addChild(a);var n=null;n=BaseBitmap.create("public_9_bg21"),n.width=e-40,n.height=100,n.x=e/2-n.width/2,n.y=i.y+35,this.addChild(n),this.showReward(n,n.y+7);var o=Api.shopVoApi.getPayFlag();if(0==o){App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_PAYMENT,this.useCallback,this);var s=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"gotocharge",this.clickBtnHandler,this);s.x=e/2-s.width/2,s.y=n.y+n.height+48-s.height/2,this.addChild(s),this._getBtn=s}else if(1==o){var r=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskCollect",this.clickBtnHandler,this);r.x=e/2-r.width/2,r.y=n.y+n.height+48-r.height/2,this.addChild(r),this._getBtn=r}else{var l=BaseBitmap.create("signin_had_get");l.x=e/2-l.width/2,l.y=n.y+n.height+48-l.height/2,this.addChild(l)}},e.prototype.showReward=function(t,e){void 0===t&&(t=null),void 0===e&&(e=0);for(var i=.8,a=15,n=Config.FirstchargeCfg.getRewardItemVoList(),o=n.length,s=0;s<n.length;s++){var r=GameData.getItemIcon(n[s],!0,!0);r.scaleX=r.scaleY=i,r.x=t.x+t.width/2+r.width*i*(s-o/2)+a*(s-(o-1)/2),r.y=e,this.addChild(r)}},e.prototype.clickBtnHandler=function(){var t=Api.shopVoApi.getPayFlag();1==t?NetManager.request(NetRequestConst.REQUEST_SHOP_FIRSTCHARGEREWARD,null):ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.showWanbaPanel=function(){for(var t=[],e=Config.RechargeCfg.getNormalRechargeCfg(),i=0;i<e.length;i++){var a=e[i].id,n=Config.FirstchargeCfg.getneedRecharge(a);n&&t.push(e[i].cost)}t=t.reverse();var o=BaseBitmap.create("firstrecharge_bottom");this.addChild(o),o.y=GameConfig.stageHeigth-o.height-90;var s=ComponentManager.getTextField(LanguageManager.getlocal("firstRecharge"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_YELLOW);s.x=o.x+200,s.y=o.y+13,this.addChild(s),this.getBtnY=o.y+180,this.showReward(o,o.y+50),this.bottomBg.visible=!1;var r=BaseBitmap.create("firstrechargemask_bg");r.x=o.x,r.y=o.y-70,r.width=o.width,this.addChild(r);var l=BaseBitmap.create("firstrecharge_font");l.x=o.x+110,l.y=o.y-120,this.addChild(l);var h=60,d=o.y+160,g=Api.shopVoApi.getPayFlag();this._container=new BaseDisplayObjectContainer,this.addChild(this._container);var c=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskCollect",this.clickBtnHandler,this);if(c.x=o.x+180,c.y=o.y+200,this.addChild(c),this._getBtn=c,c.visible=!1,0==g){App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_PAYMENT,this.useCallback2,this);for(var i=0;i<t.length;i++){var p=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"",this.clickGetBtnHandler,this),_=i%2;p.setPosition(h+(p.width+40)*_,(p.height+40)*Math.floor(i/2)+d);var u=LanguageManager.getlocal("firstRecharge"+(i+1),[t[i]+""]);p.setText(u,!1),this._container.addChild(p);var C=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);C.text=LanguageManager.getlocal("firstRechargeDes1",[40*t[i]+""]),C.x=p.x+20,C.y=p.y+p.height+5,this._container.addChild(C)}var f=ComponentManager.getTextField(LanguageManager.getlocal("firstRechargeDes"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_YELLOW);f.x=o.x+40,f.y=o.y+o.height-30,this._container.addChild(f)}else if(1==g)c.visible=!0;else{var m=BaseBitmap.create("signin_had_get");m.x=o.x+180,m.y=o.y+200,this.addChild(m)}},e.prototype.useCallback2=function(t){var e=Api.shopVoApi.getPayFlag();1==e&&(this._container&&(this._container.visible=!1),this._getBtn&&(this._getBtn.visible=!0))},e.prototype.clickGetBtnHandler=function(){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEW)},e.prototype.useCallback=function(t){void 0===t&&(t=null);var e=Api.shopVoApi.getPayFlag();if(2==e&&this._getBtn){this._getBtn.visible=!1;var i=BaseBitmap.create("signin_had_get");i.x=this._getBtn.x+this._getBtn.width/2-i.width/2,i.y=this._getBtn.y+this._getBtn.height/2-i.height/2,this.addChild(i);var a=Config.FirstchargeCfg.getRewardItemVoList();if(a){var n=this.localToGlobal(this._getBtn.x,this._getBtn.y-40),o=new egret.Point(n.x+55,n.y-30);App.CommonUtil.playRewardFlyAction(a,o)}App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_PAYMENT,this.useCallback,this)}else 1==e&&this._getBtn&&this._getBtn.setText("taskCollect")},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["itemeffect"])},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_PAYMENT,this.useCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_SHOP_FIRSTCHARGEREWARD),this.useCallback,this),this._getBtn=null,this._container=null,t.prototype.dispose.call(this)},e}(WelfareViewTab);__reflect(WelfareViewFirstRecharge.prototype,"WelfareViewFirstRecharge");var WelfareViewFunctionPreview=function(t){function e(){var e=t.call(this)||this;return e.arr2=[],e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USER_UPGRADE),this.refreshText,this),this.refreshDataList();var e=egret.Rectangle.create();e.setTo(0,0,492,GameConfig.stageHeigth-90),this._scrollList=ComponentManager.getScrollList(WelfareViewFunctionScrollltem,this.arr2,e),this.addChild(this._scrollList)},e.prototype.refreshText=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_FUNCTION_TXT)},e.prototype.refreshDataList=function(){this.arr2=[];var t=Api.otherInfoVoApi.getUnlockList(),e=[];e=Config.UnlocklistCfg.getUnlockItemCfgList();for(var i=[],a=[],n=[],o=0;o<e.length;o++)if(t&&1==t[e[o].key])i.push(e[o]);else if(Api[e[o].gameName+"VoApi"]&&Api[e[o].gameName+"VoApi"].isShowNpc){var s=Api[e[o].gameName+"VoApi"].isShowNpc();s?a.push(e[o]):n.push(e[o])}i.sort(function(t,e){return t.sortId>e.sortId?1:t.sortId==e.sortId?0:-1}),a.sort(function(t,e){return t.sortId>e.sortId?1:t.sortId==e.sortId?0:-1}),n.sort(function(t,e){return t.sortId>e.sortId?1:t.sortId==e.sortId?0:-1}),e=a.concat(n).concat(i),this.arr2=e},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["funtionbottom"])},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USER_UPGRADE),this.refreshText,this),this._scrollList=null,this.arr2=[],t.prototype.dispose.call(this)},e}(WelfareViewTab);__reflect(WelfareViewFunctionPreview.prototype,"WelfareViewFunctionPreview");var WelfareViewFunctionScrollltem=function(t){function e(){var e=t.call(this)||this;return e._getBtn=null,e._unlockKey=null,e}return __extends(e,t),e.prototype.initItem=function(t,e){var i=null;i="prison"==e.gameName&&Api.switchVoApi.checkOpenNewPrison()?BaseLoadBitmap.create("functionPreview"+e.sortId+"_2"):BaseLoadBitmap.create("functionPreview"+e.sortId),i.x=0,i.y=0,this.addChild(i),this._unlockKey=e.key;var a=BaseBitmap.create("funtionbottom");a.x=0,a.y=193,this.addChild(a);var n=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);n.width=480,n.x=10,n.y=a.y+5,n.text=LanguageManager.getlocal("funciontDes"+e.sortId),this.addChild(n);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);o.width=450,o.x=10,o.y=a.y+35;var s=LanguageManager.getlocal("unlockDes"+e.sortId);o.text=s,this.addChild(o);var r=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);r.x=10,r.y=a.y+60;var l=LanguageManager.getlocal("functionCurrDes");r.text=l+" ",this.addChild(r);var h=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);h.width=450,h.x=r.x+r.width+2,h.y=a.y+60;var d=this.getStr(e.sortId);h.text=d,this.addChild(h);var g=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskCollect",this.clickGetBtnHandler,this);this._getBtn=g,this._getBtn.setPosition(350,290),this.addChild(this._getBtn);var c=GameData.getRewardItemIcons(e.reward,!0,!1);if(c&&c.length>0)for(var p,_=20,u=280,C=c.length,f=0;C>f;f++){var m=c[f];m.scaleX=.74,m.scaleY=.74,m.setPosition(_+f*(m.width*m.scaleX+12),u),this.addChild(m),p=m}var T=e.gameName;if(Api[T+"VoApi"]&&Api[T+"VoApi"].isShowNpc){var y=Api[T+"VoApi"].isShowNpc();if(1==y){var v=Api.otherInfoVoApi.getUnlockList();if(1==v[Number(e.key)]){var A=BaseBitmap.create("signin_had_get");A.x=this._getBtn.x,A.y=this._getBtn.y,this.addChild(A),this._getBtn.visible=!1}else this._getBtn.visible=!0;var w=LanguageManager.getlocal("functionCurrDes2");h.text=w,h.textColor=TextFieldConst.COLOR_WARN_GREEN}else this._getBtn.touchEnabled=!1,App.DisplayUtil.changeToGray(this._getBtn),h.textColor=TextFieldConst.COLOR_WARN_RED}},e.prototype.refreshBtnState=function(){if(this._getBtn){var t=BaseBitmap.create("signin_had_get");t.x=this._getBtn.x,t.y=this._getBtn.y,this.addChild(t),this._getBtn.visible=!1}},e.prototype.clickGetBtnHandler=function(t){App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_OTHERINFO_GETUNLOCKLISTREWARD),this.useCallback,this),NetManager.request(NetRequestConst.REQUEST_OTHERINFO_GETUNLOCKLISTREWARD,{unlockKey:this._unlockKey})},e.prototype.useCallback=function(t){t.data.ret&&(App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.data.rewards)),this.refreshBtnState())},e.prototype.getStr=function(t){var e="";if(1==t){var i=Api.playerVoApi.getPlayerLevel(),a=LanguageManager.getlocal("officialTitle"+i);return e=LanguageManager.getlocal("functionCurrentDes"+t,[""+a])}if(3==t){var n=Api.challengeVoApi.getCurBigChannelId();return e=LanguageManager.getlocal("functionCurrentDes"+t,[""+n])}if(2==t){var o=Api.childVoApi.getCnum();return e=LanguageManager.getlocal("functionCurrentDes"+t,[""+o])}if(4==t){var s=Api.adultVoApi.getAdultMarryNum();return e=LanguageManager.getlocal("functionCurrentDes"+t,[""+s])}if(5==t){var i=Api.playerVoApi.getPlayerLevel(),a=LanguageManager.getlocal("officialTitle"+i);return e=LanguageManager.getlocal("functionCurrentDes"+t,[""+a])}if(6==t){var r=Api.servantVoApi.getServantCount(),l=Api.servantVoApi.getServantCountLevel60Plus();return e=LanguageManager.getlocal("functionCurrentDes"+t,[""+r,l+""])}if(7==t){var i=Api.playerVoApi.getPlayerLevel(),a=LanguageManager.getlocal("officialTitle"+i);return e=LanguageManager.getlocal("functionCurrentDes"+t,[""+a])}if(8==t){var i=Api.playerVoApi.getPlayerLevel(),a=LanguageManager.getlocal("officialTitle"+i);return e=LanguageManager.getlocal("functionCurrentDes"+t,[""+a])}if(9==t){var i=Api.playerVoApi.getPlayerLevel(),a=LanguageManager.getlocal("officialTitle"+i);return e=LanguageManager.getlocal("functionCurrentDes"+t,[""+a])}if(10==t){var n=Api.challengeVoApi.getCurBigChannelId();return e=LanguageManager.getlocal("functionCurrentDes"+t,[""+n])}if(11==t){var i=Api.playerVoApi.getPlayerLevel(),a=LanguageManager.getlocal("officialTitle"+i);return e=LanguageManager.getlocal("functionCurrentDes"+t,[""+a])}return e},e.prototype.getSpaceY=function(){return 1},e.prototype.getSpaceX=function(){return 0},e.prototype.dispose=function(){this._getBtn=null,this._unlockKey=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(WelfareViewFunctionScrollltem.prototype,"WelfareViewFunctionScrollltem");var WelfareViewGodBless=function(t){function e(){var e=t.call(this)||this;return e._scrollList=null,e._vipLevel=0,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.refresh,this),this._vipLevel=Api.playerVoApi.getPlayerVipLevel();var e=Config.DailyluckCfg.getLuckIdList(),i=egret.Rectangle.create();i.setTo(0,0,492,GameConfig.stageHeigth-304),this._scrollList=ComponentManager.getScrollList(WelfareViewGoldblessScrollItem,e,i),this.addChild(this._scrollList),this._scrollList.setPosition(0,195);var a=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"lookVIP",this.lookVip,this);a.setPosition(383,136),a.setScale(.8),this.addChild(a)},e.prototype.refresh=function(){if(this._vipLevel!=Api.playerVoApi.getPlayerVipLevel()){this._vipLevel=Api.playerVoApi.getPlayerVipLevel();var t=Config.DailyluckCfg.getLuckIdList();this._scrollList.refreshData(t)}},e.prototype.lookVip=function(){ViewController.getInstance().openView(ViewConst.COMMON.RECHARGEVIPVIEWTAB2)},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_USERINFO,this.refresh,this),this._scrollList=null,this._vipLevel=0,t.prototype.dispose.call(this)},e}(WelfareViewTab);__reflect(WelfareViewGodBless.prototype,"WelfareViewGodBless");var WelfareViewGoldblessScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){var i=491,a=BaseBitmap.create("public_line3");a.width=i-50,a.x=i/2-a.width/2,a.y=14,this.addChild(a);var n=BaseBitmap.create("public_9_managebg");n.width=i-40,n.height=75,n.x=i/2-n.width/2,n.y=a.y+27,this.addChild(n);var o=BaseBitmap.create("godbless_"+e.name);o.setScale(.7),o.setPosition(i/2-o.width/2*o.scaleX,2),this.addChild(o);var s=Api.vipVoApi.getDailyLuckNum(),r=ComponentManager.getTextField(LanguageManager.getlocal("godBlessTimes",[s.toString()]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);r.setPosition(30,55),this.addChild(r);var l=e.times,h=100*e.rate,d=ComponentManager.getTextField(LanguageManager.getlocal("godBlessEffect")+LanguageManager.getlocal("godbless_"+e.name,[h.toString(),l.toString()]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);d.setPosition(r.x,r.y+29),this.addChild(d)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(WelfareViewGoldblessScrollItem.prototype,"WelfareViewGoldblessScrollItem");var WelfareViewMonthCard=function(t){function e(){var e=t.call(this)||this;return e._scrollContiner=void 0,e._offsetY=0,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this._offsetY=this.bottomBg.y+20,this._scrollContiner=new BaseDisplayObjectContainer;var e=egret.Rectangle.create();e.setTo(0,this.bottomBg.y+20,this.bottomBg.width,this.bottomBg.height-40);var i=ComponentManager.getScrollView(this._scrollContiner,e);this.addChild(i);var a=BaseBitmap.create("public_line3");a.width=this.bottomBg.width-100,a.x=this.bottomBg.width/2-a.width/2,a.y=this.bottomBg.y+45-this._offsetY,this._scrollContiner.addChild(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("monthCard"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);n.x=a.x+a.width/2-n.width/2,n.y=a.y+a.height/2-n.height/2,this._scrollContiner.addChild(n);var o=BaseBitmap.create("monthcard_bigicon");o.x=this.bottomBg.width/2-o.width/2,o.y=this.bottomBg.y+90-this._offsetY,this._scrollContiner.addChild(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("carddescription"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);s.x=o.x-34,s.y=o.y-109+this._offsetY,this.addChild(s);var r=BaseBitmap.create("monthcard_desc");if(r.x=this.bottomBg.width/2-r.width/2,r.y=o.y+o.height+10,this._scrollContiner.addChild(r),Api.switchVoApi.checkJumpBattle()){r.y=o.y+o.height;var l=BaseBitmap.create("unlock_challenge_skip");l.x=this.bottomBg.width/2-l.width/2,l.y=r.y+r.height,this._scrollContiner.addChild(l)}if(Api.practiceVoApi.isPracticeOPen()){var h=BaseBitmap.create("unlock_practice");h.x=this.bottomBg.width/2-h.width/2,h.y=r.y+r.height+30,this._scrollContiner.addChild(h)}var d=Api.shopVoApi.ifBuyMonthCard();if(1==d){var g=BaseBitmap.create("welfare_hasbuy");g.x=this.bottomBg.width/2-g.width/2,g.y=r.y+r.height+45-g.height/2,this._scrollContiner.addChild(g),Api.practiceVoApi.isPracticeOPen()&&(g.y=r.y+r.height+75-g.height/2),this.showText()}else{var c=Config.RechargeCfg.getRechargeItemCfgByKey("g7");if(c){App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_PAYMENT,this.useCallback,this);var p=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"anyMoney",this.goToRechargeHandler,this);p.x=this.bottomBg.width/2-p.width/2,p.y=r.y+r.height+45-p.height/2,Api.switchVoApi.checkJumpBattle()&&(p.y=r.y+r.height+65-p.height/2),Api.practiceVoApi.isPracticeOPen()&&(p.y=r.y+r.height+95-p.height/2),p.setText(App.CommonUtil.getMoneyString(c.cost),!1),this._scrollContiner.addChild(p),this._goToRechargeBtn=p}}if(1==PlatformManager.checkIsTWMCSp()){var _=ComponentManager.getTextField(LanguageManager.getlocal("twBuyCardExplain"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);_.width=360,_.height=250,_.x=this.bottomBg.width/2-_.width/2,_.y=r.y+220,_.lineSpacing=5,this._scrollContiner.addChild(_)}},e.prototype.showText=function(){var t=App.DateUtil.getFormatBySecond(Api.shopVoApi.getMonthcardet(),6),e=ComponentManager.getTextField(LanguageManager.getlocal("cardTimedes",[t]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);e.x=240,e.y=830-this._offsetY,this._scrollContiner.addChild(e)},e.prototype.useCallback=function(t){void 0===t&&(t=null);var e=Api.shopVoApi.ifBuyMonthCard();if(e){this.showText(),this._goToRechargeBtn.visible=!1;var i=BaseBitmap.create("welfare_hasbuy");i.x=this._goToRechargeBtn.x+this._goToRechargeBtn.width/2-i.width/2,i.y=this._goToRechargeBtn.y+this._goToRechargeBtn.height/2-i.height/2,this._scrollContiner.addChild(i),App.CommonUtil.showTip(LanguageManager.getlocal("sysBuySuccessDesc",[LanguageManager.getlocal("monthCard")])),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_PAYMENT,this.useCallback,this)}},e.prototype.goToRechargeHandler=function(){PlatformManager.pay("g7")},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_PAYMENT,this.useCallback,this),this._goToRechargeBtn=null,this._scrollContiner=void 0,this._offsetY=0,t.prototype.dispose.call(this)},e}(WelfareViewTab);__reflect(WelfareViewMonthCard.prototype,"WelfareViewMonthCard");var WelfareViewOfficialWeChat=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=491,i=(this.bottomBg.height+this.bottomBg.y,BaseBitmap.create("public_9_bg21"));i.width=e-40,i.height=40,i.x=e/2-i.width/2,i.y=this.bottomBg.y+30,this.addChild(i);var a=ComponentManager.getTextField(LanguageManager.getlocal("wechatdes1"),TextFieldConst.FONTSIZE_TITLE_SMALL,TextFieldConst.COLOR_BROWN);a.x=i.x+i.width/2-a.width/2,a.y=i.y+i.height/2-a.height/2,this.addChild(a);var n=BaseBitmap.create("public_line3");n.width=e-100,n.x=e/2-n.width/2,n.y=this.bottomBg.y+90,this.addChild(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("officialWeChat"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);o.x=n.x+n.width/2-o.width/2,o.y=n.y+n.height/2-o.height/2,this.addChild(o);var s=BaseBitmap.create("public_9_bg21");s.width=e-40,s.height=100,s.x=e/2-s.width/2,s.y=n.y+35,this.addChild(s);var r=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"copyDes",this.copyBtnHandler,this);r.setPosition(s.x+150,s.y+130),this.addChild(r);var l=ComponentManager.getTextField(LanguageManager.getlocal("wechatdes"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);l.x=i.x+55,l.width=491,l.y=GameConfig.stageHeigth-150,this.addChild(l);for(var h=.8,d=15,g=GameData.formatRewardItem(Config.GameprojectCfg.reward3K),c=g.length,p=0;p<g.length;p++){var _=GameData.getItemIcon(g[p],!0,!0);_.scaleX=_.scaleY=h,_.x=s.x+s.width/2+_.width*h*(p-c/2)+d*(p-(c-1)/2),_.y=s.y+7,this.addChild(_)}},e.prototype.copyBtnHandler=function(){if(App.DeviceUtil.IsHtml5()){var t=LanguageManager.getlocal("officialWeChatcontentdes"),e=document.createElement("input");e.value=t,document.body.appendChild(e),e.select(),e.setSelectionRange(0,e.value.length),document.execCommand("Copy"),document.body.removeChild(e),App.CommonUtil.showTip(LanguageManager.getlocal("followSuccessdes"))}},e}(WelfareViewTab);__reflect(WelfareViewOfficialWeChat.prototype,"WelfareViewOfficialWeChat");var WelfareViewQgroup=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.bottomBg.visible=!1;var e=BaseBitmap.create("firstrecharge_bottom");e.x=0,e.y=GameConfig.stageHeigth-e.height-80,this.addChild(e);var i=BaseBitmap.create("qgroup_font");i.anchorOffsetY=i.height,i.x=this.bottomBg.x+this.bottomBg.width/2-i.width/2,i.y=e.y,this.addChild(i);var a=245,n=ComponentManager.getTextField(LanguageManager.getlocal("welfareViewQQGroup1",[this._qqNo]),20);n.x=a-n.width/2,n.y=i.y-33,this.addChild(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("welfareViewQQGroup2"),20,TextFieldConst.COLOR_LIGHT_YELLOW);o.x=a-o.width/2,o.y=e.y+11,this.addChild(o);for(var s=.8,r=15,l=Config.GameprojectCfg.shareShowZJ,h=GameData.getRewardItemIcons(l,!0,!0),d=h.length,g=0;d>g;g++){var c=h[g];c.scaleX=c.scaleY=s,c.x=e.x+e.width/2+c.width*s*(g-d/2)+r*(g-(d-1)/2),c.y=e.y+50,this.addChild(c)}var p=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"welfareViewQQGroup3",this.copyBtnHandler,this);p.x=a-p.width/2,p.y=e.y+200,this.addChild(p);var _=ComponentManager.getTextField(LanguageManager.getlocal("welfareViewQQGroup4"),18,TextFieldConst.COLOR_WARN_YELLOW2);_.width=GameConfig.stageWidth-220,_.multiline=!0,_.lineSpacing=5,_.x=a-_.width/2,_.y=p.y+80,this.addChild(_)},e.prototype.copyBtnHandler=function(){var t=document.createElement("input");t.value=this._qqNo,document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("Copy"),document.body.removeChild(t),App.CommonUtil.showTip(LanguageManager.getlocal("welfareViewQQGroup5"))},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["qgroup_font"])},e.prototype.getRequestData=function(){return{requestType:NetRequestConst.REQUEST_USER_GETKFCARDMSG,requestData:{}}},e.prototype.receiveData=function(t){if(t.data.cmd==NetRequestConst.REQUEST_USER_GETKFCARDMSG){var e=t.data.data;this._qqNo=e.msg}},e.prototype.dispose=function(){this._qqNo=null,t.prototype.dispose.call(this)},e}(WelfareViewTab);__reflect(WelfareViewQgroup.prototype,"WelfareViewQgroup");var WelfareViewRealname=function(t){function e(){var e=t.call(this)||this;return e.authenticationState=0,e.authenticationStateText=null,e.authenticationBtn=null,e.receiveBtn=null,e.hasGetSp=null,e._isReceive=!1,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.authenticationState=PlatformManager.client.checkPerson()?1:0,App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_OTHERINFO_GETAUTHOR3KREWARD),this.useCallback,this);var e=491,i="";i=1==this.authenticationState?"realnamedes7":"realnamedes1";var a=ComponentManager.getTextField(LanguageManager.getlocal(i),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);a.x=10,a.y=180,this.addChild(a),this.authenticationStateText=a;var n=ComponentManager.getTextField(LanguageManager.getlocal("realnamedes2"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);n.x=30,n.y=230,n.width=440,this.addChild(n);var o=BaseBitmap.create("public_9_bg21");o.width=450,o.height=300,o.x=20,o.y=280,this.addChild(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("realnamedes3"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);s.x=30,s.width=430,s.y=300,s.lineSpacing=5,this.addChild(s);var r=BaseBitmap.create("public_line3");r.width=e-10,r.x=e/2-r.width/2,r.y=o.y+o.height+20,this.addChild(r);var l=ComponentManager.getTextField(LanguageManager.getlocal("realnamedes4"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);l.x=r.x+r.width/2-l.width/2,l.y=r.y,this.addChild(l);var h=.8,d=15,g=GameData.formatRewardItem(Config.GameprojectCfg.rewardID3K),c=g.length,p=BaseBitmap.create("public_9_bg21");p.width=450,p.x=20,p.y=r.y+30,this.addChild(p);for(var _=0,u=0;u<g.length;u++){var C=GameData.getItemIcon(g[u],!0,!0);C.scaleX=C.scaleY=h,C.x=o.x+o.width/2+C.width*h*(u-c/2)+d*(u-(c-1)/2),C.y=r.y+50,this.addChild(C),_=C.height}p.height=_+20;var f="";f=1==this.authenticationState?"realnamedes8":"realnamedes5";var m=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,f,this.authenticationBtnHandler,this);m.setPosition(70,p.y+p.height+30),this.addChild(m),this.authenticationBtn=m;var T=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"realnamedes6",this.receiveBtnHandler,this);T.setPosition(280,p.y+p.height+30),this.addChild(T),this.receiveBtn=T,this.receiveBtn.visible=!1;var y=BaseBitmap.create("signin_had_get");y.x=T.x,y.y=T.y+5,this.addChild(y),this.hasGetSp=y,this.hasGetSp.visible=!1,this.isReceive()},e.prototype.isReceive=function(){this._isReceive=Api.otherInfoVoApi.checkrealnamerewards(),1==this._isReceive?(this.receiveBtn.visible=!0,1==this.authenticationState?(this.receiveBtn.touchEnabled=!0,App.DisplayUtil.changeToNormal(this.receiveBtn)):(this.receiveBtn.touchEnabled=!1,App.DisplayUtil.changeToGray(this.receiveBtn))):(this.receiveBtn.visible=!1,this.hasGetSp.visible=!0)},e.prototype.is3kuseCallback=function(t){void 0===t&&(t=null)},e.prototype.useCallback=function(t){if(void 0===t&&(t=null),t.data.data.data.rewards){var e=new egret.Point(GameConfig.stage.width/2,GameConfig.stageHeigth/2+100);App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(t.data.data.data.rewards),e),this.isReceive()}},e.prototype.rest=function(){this.isReceive(),this.restStr()},e.prototype.restStr=function(){var t="";if(t=1==this.authenticationState?"realnamedes1":"realnamedes7",this.authenticationBtn&&1==this.authenticationState){var e="realnamedes8";this.authenticationBtn.touchEnabled=!1,this.authenticationBtn.setText(e)}this.authenticationStateText&&(this.authenticationStateText.text=LanguageManager.getlocal(t))},e.prototype.authenticationBtnHandler=function(t){var e=this;1!=this.authenticationState&&PlatformManager.client.showPersonView(function(){console.log("认证结果"),e.rest()})},e.prototype.receiveBtnHandler=function(t){NetManager.request(NetRequestConst.REQUEST_OTHERINFO_GETAUTHOR3KREWARD,null)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_OTHERINFO_GETAUTHOR3KREWARD),this.useCallback,this),this.authenticationState=0,this.authenticationStateText=null,this.authenticationBtn=null,this.receiveBtn=null,this.hasGetSp=null,this._isReceive=!1,t.prototype.dispose.call(this)},e}(WelfareViewTab);__reflect(WelfareViewRealname.prototype,"WelfareViewRealname");var WelfareViewRebate=function(t){function e(){var e=t.call(this)||this;return e._scrollList=null,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=[0,1,2,3],i=e,a=egret.Rectangle.create();a.setTo(0,0,492,GameConfig.stageHeigth-304),this._scrollList=ComponentManager.getScrollList(WelfareViewRebateScrollItem,i,a),this.addChild(this._scrollList),this._scrollList.setPosition(0,195)
},e.prototype.dispose=function(){this._scrollList=null,t.prototype.dispose.call(this)},e}(WelfareViewTab);__reflect(WelfareViewRebate.prototype,"WelfareViewRebate");var WelfareViewRebateScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){var i=491,a=BaseBitmap.create("public_line3");a.width=i-100,a.x=i/2-a.width/2,a.y=10,this.addChild(a);var n=BaseBitmap.create("public_9_managebg");if(n.width=i-40,n.height=75,n.x=i/2-n.width/2,n.y=a.y+27,this.addChild(n),0!=t){var o=ComponentManager.getTextField(LanguageManager.getlocal("rebateTitle"+t),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);o.setPosition(i/2-o.width/2*o.scaleX,a.y),this.addChild(o)}var s=ComponentManager.getTextField(LanguageManager.getlocal("rebateDes"+t),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);s.setPosition(30,n.y+8),s.width=n.width-15,this.addChild(s),s.lineSpacing=3,s.textHeight>n.height&&(n.height=s.textHeight+30),0==t&&(a.visible=!1,s.y=5,s.lineSpacing=5,this.removeChild(n))},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(WelfareViewRebateScrollItem.prototype,"WelfareViewRebateScrollItem");var WelfareViewRechargeBox=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_PAYMENT,this.useCallback,this);var e=Api.shopVoApi.getPayInfoById2("g9"),i=Config.RechargeCfg.getRechargeItemCfgByKey("g9"),a=e.st+i.lastTime-GameData.serverTime,n=LanguageManager.getlocal("limitTime",[App.DateUtil.getFormatBySecond(a,1)]);this._timeTF=ComponentManager.getTextField(n,TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_WARN_YELLOW),this._timeTF.x=300,this._timeTF.y=130,this.addChild(this._timeTF);var o=.83,s=BaseBitmap.create("rechargebox_bg1");s.x=this.bottomBg.width/2-s.width/2,s.y=this.bottomBg.y+20,this.addChild(s);for(var r=Config.RechargeCfg.rewardList1(),l=(r.length,0);l<r.length;l++){var h=GameData.getItemIcon(r[l],!0,!0);h.scaleX=h.scaleY=o,h.x=45+(h.width*o+15)*l,h.y=s.y+150,this.addChild(h)}var d=Api.shopVoApi.getPayInfo1();if(1==d){var g=BaseBitmap.create("welfare_hasbuy");g.x=this.bottomBg.width/2-g.width/2,g.y=s.y+s.height-42-g.height/2,this.addChild(g)}else{var c=Config.RechargeCfg.getRechargeItemCfgByKey("g9");if(c){var p=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"anyMoney",this.goToRechargeHandler,this);p.x=this.bottomBg.width/2-p.width/2,p.y=s.y+s.height-42-p.height/2,p.setText(LanguageManager.getlocal("anyMoney",[c.cost.toString()]),!1),this.addChild(p),this._goToRechargeBtn=p}}var _=BaseBitmap.create("rechargebox_bg2");_.x=this.bottomBg.width/2-_.width/2,_.y=s.y+s.height+10,this.addChild(_);for(var u=Config.RechargeCfg.rewardList2(),l=(u.length,0);l<u.length;l++){var h=GameData.getItemIcon(u[l],!0,!0);h.scaleX=h.scaleY=o,h.x=45+(h.width*o+15)*l,h.y=_.y+150,this.addChild(h)}var C=Api.shopVoApi.getPayInfo2();if(1==C){var g=BaseBitmap.create("welfare_hasbuy");g.x=this.bottomBg.width/2-g.width/2,g.y=_.y+_.height-45-g.height/2,this.addChild(g)}else{var f=Config.RechargeCfg.getRechargeItemCfgByKey("g10");if(f){var p=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"anyMoney",this.goToRechargeHandler2,this);p.x=this.bottomBg.width/2-p.width/2,p.y=_.y+_.height-45-p.height/2,p.setText(LanguageManager.getlocal("anyMoney",[f.cost.toString()]),!1),this.addChild(p),this._goToRechargeBtn2=p}}},e.prototype.useCallback=function(t){void 0===t&&(t=null);var e=Api.shopVoApi.getPayInfo1();if(e){this._goToRechargeBtn.visible=!1;var i=BaseBitmap.create("welfare_hasbuy");i.x=this._goToRechargeBtn.x+this._goToRechargeBtn.width/2-i.width/2,i.y=this._goToRechargeBtn.y+this._goToRechargeBtn.height/2-i.height/2,this.addChild(i);var a=Config.RechargeCfg.getRechargeItemCfgByKey("g9"),n="1_0_"+a.gemCost+"|"+a.getReward,o=this._goToRechargeBtn.localToGlobal(this._goToRechargeBtn.width/2,-50);App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(n),o)}var s=Api.shopVoApi.getPayInfo2();if(1==s){this._goToRechargeBtn2.visible=!1;var i=BaseBitmap.create("welfare_hasbuy");i.x=this._goToRechargeBtn2.x+this._goToRechargeBtn2.width/2-i.width/2,i.y=this._goToRechargeBtn2.y+this._goToRechargeBtn2.height/2-i.height/2,this.addChild(i);var a=Config.RechargeCfg.getRechargeItemCfgByKey("g10"),n="1_0_"+a.gemCost+"|"+a.getReward,o=this._goToRechargeBtn2.localToGlobal(this._goToRechargeBtn2.width/2,-50);App.CommonUtil.playRewardFlyAction(GameData.formatRewardItem(n),o)}},e.prototype.tick=function(){if(this._timeTF){var t=Api.shopVoApi.getPayInfoById2("g9"),e=Config.RechargeCfg.getRechargeItemCfgByKey("g9"),i=t.st+e.lastTime-GameData.serverTime,a=LanguageManager.getlocal("limitTime",[App.DateUtil.getFormatBySecond(i,1)]);this._timeTF.text=a,0>=i&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_RECHARFGE_BOX_TIMEOUT)}},e.prototype.goToRechargeHandler=function(){PlatformManager.pay("g9")},e.prototype.goToRechargeHandler2=function(){PlatformManager.pay("g10")},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_PAYMENT,this.useCallback,this),this._goToRechargeBtn=null,this._goToRechargeBtn2=null,t.prototype.dispose.call(this)},e}(WelfareViewTab);__reflect(WelfareViewRechargeBox.prototype,"WelfareViewRechargeBox");var WelfareViewSignin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=Api.arrivalVoApi.getTotalSignDay();App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_WELFARE_SIGNIN,this.clickItemHandler,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USER_ARRIVAL),this.useCallback,this);var i=ComponentManager.getTextField(e+"",TextFieldConst.FONTSIZE_TITLE_SMALL);i.x=105-i.width/2,i.y=205-i.height/2,this.addChild(i),PlatformManager.checkIsKRSp()&&(i.x=130-i.width/2),this._signRewardList=Api.arrivalVoApi.getSignRewardList();var a=egret.Rectangle.create();a.setTo(0,0,492,GameConfig.stageHeigth-312-40),this._scrollList=ComponentManager.getScrollList(WelfareViewSignScrollItem,this._signRewardList,a),this.addChild(this._scrollList),this._scrollList.setPosition(0,243);var n=Api.arrivalVoApi.getIndexByCurday();n=n>2?n-1:1,this._scrollList.setScrollTopByIndex(n)},e.prototype.useCallback=function(t){var e=this._scrollList.getItemByIndex(this._index);e&&e.updateButtonState()},e.prototype.clickItemHandler=function(t){this._index=Number(t.data.index),NetManager.request(NetRequestConst.REQUEST_USER_ARRIVAL,null)},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_WELFARE_SIGNIN,this.clickItemHandler,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_USER_ARRIVAL),this.useCallback,this),t.prototype.dispose.call(this)},e}(WelfareViewTab);__reflect(WelfareViewSignin.prototype,"WelfareViewSignin");var WelfareViewSignScrollItem=function(t){function e(){var e=t.call(this)||this;return e._getBtn=null,e._curDay=0,e._selectedIndex=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){this._selectedIndex=t,this._curDay=e.index,this._rewardList=e.rewardList;var i=491,a=BaseBitmap.create("public_line3");a.width=i-50,a.x=i/2-a.width/2,a.y=14,this.addChild(a);var n=BaseBitmap.create("public_9_bg21");n.width=i-40,n.height=100,n.x=i/2-n.width/2,n.y=a.y+22,this.addChild(n);var o=ComponentManager.getTextField(LanguageManager.getlocal("signinDay",[String(this._curDay)]),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BROWN);o.x=a.x+a.width/2-o.width/2,o.y=a.y+a.height/2-o.height/2,this.addChild(o);for(var s=0,r=.8,l=0;l<e.rewardList.length;l++){var h=GameData.getItemIcon(e.rewardList[l],!0,!0);h.x=20+7*(l+1)+h.width*r*l,h.y=n.y+7,h.scaleX=h.scaleY=r,this.addChild(h),s=h.x+h.width}if(1==e.flag){var d=BaseBitmap.create("signin_had_get");d.x=i-100-d.width/2,d.y=n.y+n.height/2-d.height/2,this.addChild(d)}else{var g=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"taskCollect",this.clickGetBtnHandler,this);g.x=i-100-g.width/2,g.y=n.y+n.height/2-g.height/2,this.addChild(g),this._getBtn=g,2==e.flag&&g.setEnable(!1)}},e.prototype.updateButtonState=function(){var t=Api.arrivalVoApi.checkFlagByIndex(this._curDay);if(1==t&&this._getBtn){this._getBtn.visible=!1;var e=BaseBitmap.create("signin_had_get");e.x=this._getBtn.x+this._getBtn.width/2-e.width/2,e.y=this._getBtn.y+this._getBtn.height/2-e.height/2,this.addChild(e)}if(this._rewardList){var i=this.localToGlobal(this._getBtn.x,this._getBtn.y-40),a=new egret.Point(i.x+55,i.y-30);App.CommonUtil.playRewardFlyAction(this._rewardList,a)}},e.prototype.clickGetBtnHandler=function(t){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_WELFARE_SIGNIN,{day:this._curDay,index:this._selectedIndex})},e.prototype.dispose=function(){this._getBtn=null,this._curDay=0,this._rewardList=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(WelfareViewSignScrollItem.prototype,"WelfareViewSignScrollItem");var BaseLoadDragonBones=function(t){function e(e){var i=t.call(this)||this;return i._isLoaded=!1,i._isInit=!1,i._isStop=!1,i._dragonBonesName=e,i.init(),i}return __extends(e,t),e.prototype.init=function(){this._isInit=!0,this.loadRes()},e.prototype.getBonesResArr=function(){return[this._dragonBonesName+"_ske",this._dragonBonesName+"_tex_json",this._dragonBonesName+"_tex_png"]},e.prototype.loadRes=function(){this._groupName=ResourceManager.loadResources(this.getBonesResArr(),null,this.loadComplete,null,this)},e.prototype.loadComplete=function(){this._isInit?(this._isLoaded=!0,this._dragonBones=App.DragonBonesUtil.getDragonBones(this._dragonBonesName),e.cacheDic[this._dragonBonesName]?e.cacheDic[this._dragonBonesName]++:e.cacheDic[this._dragonBonesName]=1,this.addChild(this._dragonBones),0==this._isStop&&this._dragonBones.animation.play("idle",0)):this._groupName&&(ResourceManager.destroyRes(this._groupName),this._groupName=null)},e.prototype.stop=function(){this._isInit&&(this._isStop=!0,this._dragonBones&&this._dragonBones.animation.isPlaying&&this._dragonBones.animation.stop("idle"))},e.prototype.resume=function(){this._isInit&&(this._isStop=!1,this._dragonBones&&!this._dragonBones.animation.isPlaying&&this._dragonBones.animation.play("idle",0))},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.dispose=function(){this._isInit=!1,this._isStop=!1,e.cacheDic[this._dragonBonesName]&&e.cacheDic[this._dragonBonesName]--,this._dragonBonesName&&this._isLoaded&&!e.cacheDic[this._dragonBonesName]&&App.DragonBonesUtil.removeDragonBones(this._dragonBonesName),this._dragonBonesName=null,this._groupName&&this._isLoaded&&(ResourceManager.destroyRes(this._groupName),this._groupName=null),this._dragonBones=null,this._isLoaded=!1,t.prototype.dispose.call(this)},e.cacheDic={},e}(BaseDisplayObjectContainer);__reflect(BaseLoadDragonBones.prototype,"BaseLoadDragonBones");var WelfareViewYearCard=function(t){function e(){var e=t.call(this)||this;return e._scrollContiner=void 0,e._openDialogDiscountEnabled=!1,e._offsetY=0,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this._offsetY=this.bottomBg.y+20,this._scrollContiner=new BaseDisplayObjectContainer;var e=egret.Rectangle.create();e.setTo(0,this.bottomBg.y+20,this.bottomBg.width,this.bottomBg.height-40);var i=ComponentManager.getScrollView(this._scrollContiner,e);this.addChild(i);var a=BaseBitmap.create("public_line3");a.width=this.bottomBg.width-100,a.x=this.bottomBg.width/2-a.width/2,a.y=this.bottomBg.y+45-this._offsetY,this._scrollContiner.addChild(a);var n=ComponentManager.getTextField(LanguageManager.getlocal("yearCard"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BROWN);n.x=a.x+a.width/2-n.width/2,n.y=a.y+a.height/2-n.height/2,this._scrollContiner.addChild(n);var o=BaseBitmap.create("yearcard_bigicon");o.x=this.bottomBg.width/2-o.width/2,o.y=this.bottomBg.y+90-this._offsetY,this._scrollContiner.addChild(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("lifecarddes"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);s.x=o.x-34,s.y=o.y-109+this._offsetY,this.addChild(s);var r="yearcard_desc";(Api.acVoApi.getActivityVoByAidAndCode("discount","2")&&Api.acVoApi.getActivityVoByAidAndCode("discount","2").isStart||PlatformManager.checkIsSfSp())&&(r="yearcard_desc2");var l=BaseBitmap.create(r);if(l.x=this.bottomBg.width/2-l.width/2,l.y=o.y+o.height+10,this._scrollContiner.addChild(l),Api.switchVoApi.checkJumpBattle()){l.y=o.y+o.height;var h=BaseBitmap.create("unlock_challenge_skip");h.x=this.bottomBg.width/2-h.width/2,h.y=l.y+l.height,this._scrollContiner.addChild(h)}if(Api.practiceVoApi.isPracticeOPen()){var d=BaseBitmap.create("unlock_practice");d.x=this.bottomBg.width/2-d.width/2,d.y=l.y+l.height+30,this._scrollContiner.addChild(d)}var g=Api.shopVoApi.ifBuyYearCard();if(1==g){var c=BaseBitmap.create("welfare_hasbuy");c.x=this.bottomBg.width/2-c.width/2,c.y=l.y+l.height+45-c.height/2,this._scrollContiner.addChild(c),Api.practiceVoApi.isPracticeOPen()&&(c.y=l.y+l.height+75-c.height/2),this.showText()}else{var p=Config.RechargeCfg.getRechargeItemCfgByKey("g8");if(p){App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_PAYMENT,this.useCallback,this);var _=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"anyMoney",this.goToRechargeHandler,this);if(_.x=this.bottomBg.width/2-_.width/2,_.y=l.y+l.height+45-_.height/2,Api.switchVoApi.checkJumpBattle()&&(_.y=l.y+l.height+65-_.height/2),_.setText(App.CommonUtil.getMoneyString(p.cost),!1),this._scrollContiner.addChild(_),this._goToRechargeBtn=_,Api.practiceVoApi.isPracticeOPen()&&(_.y=l.y+l.height+95-_.height/2),Api.acVoApi.getActivityVoByAidAndCode("discount","2")&&Api.acVoApi.getActivityVoByAidAndCode("discount","2").isStart){var u=ComponentManager.getTextField(LanguageManager.getlocal("acDiscount_oldPrice",[LanguageManager.getlocal("anyMoney",[p.cost.toString()])]),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);u.x=_.x-130,u.y=_.y+_.height/2-u.height/2,this._scrollContiner.addChild(u);var C=new egret.Shape;C.graphics.lineStyle(2,16711680,1),C.graphics.moveTo(0,0),C.graphics.lineTo(u.width,0),C.graphics.endFill(),C.x=u.x,C.y=u.y+10,this._scrollContiner.addChild(C);var f=Config.RechargeCfg.getRechargeItemCfgByKey("g11");f&&_.setText(LanguageManager.getlocal("anyMoney",[f.cost.toString()]),!1)}}}if(Api.acVoApi.getActivityVoByAidAndCode("discount","2")&&Api.acVoApi.getActivityVoByAidAndCode("discount","2").isStart?this._openDialogDiscountEnabled=!0:this._openDialogDiscountEnabled=!1,1==PlatformManager.checkIsTWMCSp()){var m=ComponentManager.getTextField(LanguageManager.getlocal("twBuyCardExplain"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE);m.width=360,m.height=250,m.x=this.bottomBg.width/2-m.width/2,m.y=l.y+220,m.lineSpacing=5,this._scrollContiner.addChild(m)}},e.prototype.tick=function(){var t=!1;Api.acVoApi.getActivityVoByAidAndCode("discount","2")&&Api.acVoApi.getActivityVoByAidAndCode("discount","2").isStart?this._openDialogDiscountEnabled||(t=!0):this._openDialogDiscountEnabled&&(App.CommonUtil.showTip(LanguageManager.getlocal("acPunishEndViewRefreshed")),t=!0),t&&App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_YEARCARD_VIEW)},e.prototype.showText=function(){var t=ComponentManager.getTextField(LanguageManager.getlocal("lifecarTimeddes"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);t.x=250,t.y=830-this._offsetY,this._scrollContiner.addChild(t)},e.prototype.useCallback=function(t){void 0===t&&(t=null);var e=Api.shopVoApi.ifBuyYearCard();if(e){this.showText(),this._goToRechargeBtn.visible=!1;var i=BaseBitmap.create("welfare_hasbuy");i.x=this._goToRechargeBtn.x+this._goToRechargeBtn.width/2-i.width/2,i.y=this._goToRechargeBtn.y+this._goToRechargeBtn.height/2-i.height/2,this._scrollContiner.addChild(i),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_PAYMENT,this.useCallback,this),App.CommonUtil.showTip(LanguageManager.getlocal("sysBuySuccessDesc",[LanguageManager.getlocal("yearCard")]))}},e.prototype.goToRechargeHandler=function(){this._openDialogDiscountEnabled?PlatformManager.pay("g11"):PlatformManager.pay("g8")},e.prototype.getResourceList=function(){return Api.acVoApi.getActivityVoByAidAndCode("discount","2")&&Api.acVoApi.getActivityVoByAidAndCode("discount","2").isStart||PlatformManager.checkIsSfSp()?t.prototype.getResourceList.call(this).concat(["yearcard_desc2"]):t.prototype.getResourceList.call(this)},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_PAYMENT,this.useCallback,this),this._goToRechargeBtn=null,this._offsetY=0,t.prototype.dispose.call(this)},e}(WelfareViewTab);__reflect(WelfareViewYearCard.prototype,"WelfareViewYearCard");var WifeCallBatchSuccessView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){var t=this.param.data[0];this._nodeContainer=new BaseDisplayObjectContainer,this.addChild(this._nodeContainer);var e=BaseBitmap.create("public_9_wordbg");e.height=GameConfig.stageHeigth-200,e.y=GameConfig.stageHeigth-e.height-2,this._nodeContainer.addChild(e);var i=ComponentManager.getButton("popupview_closebtn1","",this.hide,this);i.x=this.viewBg.width-i.width+20,i.y=e.y-i.height/2,this._nodeContainer.addChild(i);var a=BaseBitmap.create("wifeview_batch_get");a.x=e.x+e.width/2-a.width/2,a.y=e.y-a.height/2-15,this._nodeContainer.addChild(a);var n=ComponentManager.getTextField("",20);n.text=LanguageManager.getlocal("wifeBatchCallTip"),n.x=e.x+e.width/2-n.width/2,n.y=e.y+45,this._nodeContainer.addChild(n);for(var o=e.height-100,s=new egret.Rectangle(0,0,GameConfig.stageWidth,o),r=new BaseDisplayObjectContainer,l=20,h=50,d=t.length,g=0;d>g;g++){var c=t[g],p=BaseBitmap.create("studyatk_servant_bg");p.y=l,g%2==0?p.x=h:(p.x=GameConfig.stageWidth-h-p.width,l+=270),r.addChild(p);var _=BaseBitmap.create("studyatk_booklv_circle");_.anchorOffsetX=_.width/2,_.anchorOffsetY=_.height/2,_.setScale(.5),_.x=p.x+p.width/2,_.y=p.y+p.height/2;var u=BaseBitmap.create("studyatk_booklv_light1");u.anchorOffsetX=u.width/2,u.anchorOffsetY=u.height/2,u.x=p.x+p.width/2,u.y=p.y+p.height/2,u.setScale(1.18),r.addChild(u);var C=BaseBitmap.create("studyatk_booklv_light2");C.anchorOffsetX=C.width/2,C.anchorOffsetY=C.height/2,C.x=u.x,C.y=u.y,C.setScale(u.scaleX),r.addChild(C),r.addChild(_),egret.Tween.get(_,{loop:!0}).to({scaleX:1.25,scaleY:1.25},1e3).to({scaleX:2,scaleY:2,alpha:0},1e3).set({scaleX:.5,scaleY:.5,alpha:1}),egret.Tween.get(u,{loop:!0}).to({rotation:360},15e3),egret.Tween.get(C,{loop:!0}).to({rotation:-360},15e3);var f=c[0],m=BaseLoadBitmap.create("wife_full_"+f),T=egret.Rectangle.create();m.width=540,m.height=760,T.setTo(0,0,540,500),m.mask=T,m.anchorOffsetX=m.width/2,m.anchorOffsetY=m.height/2,m.setScale(.4),m.x=p.x+p.width/2,m.y=p.y+p.height/2-10,r.addChild(m);var y=BaseBitmap.create("bookroom_cdbg");y.scaleY=1.7,y.x=p.x+p.width/2-y.width/2,y.y=p.y+p.height-105,r.addChild(y);var v=(y.y+12,c[1]),A=ComponentManager.getTextField("",20,TextFieldConst.COLOR_QUALITY_GREEN);if(A.text=LanguageManager.getlocal("wifeExp")+v,A.x=y.x+y.width/2-A.width/2,A.y=y.y+y.height/2*y.scaleY-A.height/2,r.addChild(A),c[2]){A.y=y.y+12;var w=ComponentManager.getTextField("",20);w.text=LanguageManager.getlocal("wifeBatchExp"),w.x=y.x+y.width/2-w.width/2,w.y=y.y+y.height/2*y.scaleY-w.height/2+10,r.addChild(w)}}var x=ComponentManager.getScrollView(r,s);x.y=e.y+80,x.bounces=!1,this._nodeContainer.addChild(x)},e.prototype.clickHandler=function(){t.prototype.hide.call(this)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["studyatk_servant_bg","wifeview_batch_get","bookroom_cdbg","popupview_closebtn1","studyatk_booklv_circle","studyatk_booklv_light1","studyatk_booklv_light2"])},e.prototype.dispose=function(){this._nodeContainer=null,t.prototype.dispose.call(this)},e}(BaseView);__reflect(WifeCallBatchSuccessView.prototype,"WifeCallBatchSuccessView");var WifeGetChildView=function(t){function e(){var e=t.call(this)||this;return e._childId=null,e}return __extends(e,t),e.prototype.getResourceList=function(){var e=t.prototype.getResourceList.call(this);return this.param.data&&(this._childId=this.param.data),e.concat(["childview_baby","childview_get","childview_getboy","childview_getgirl"])},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getBgName=function(){return"public_9_bg8"},e.prototype.initView=function(){1==Api.childVoApi.getChildNum()&&0==Api.adultVoApi.getAdultNum()&&0==Api.adultVoApi.getAdultMarryNum()&&(Api.rookieVoApi.curGuideKey="child",Api.rookieVoApi.insertWaitingGuide({idx:"child_1"},!0),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_REFRESH_FUNCTION_TXT)),SoundManager.playEffect(SoundConst.EFFECT_GETCHILD);var t=this._childId,e=Api.childVoApi.getChildrenInfoVoById(t),i=e.attrVo.attTotal,a=(egret.Point.create(320,GameConfig.stageHeigth/2),new PowerFly);a.init(i),LayerManager.msgLayer.addChild(a);var n=BaseBitmap.create("public_rotatelight");n.scaleX=2,n.scaleY=2,n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.setPosition(GameConfig.stageWidth/2,GameConfig.stageHeigth/2),this.addChild(n),egret.Tween.get(n,{loop:!0}).to({rotation:360},3e3);var o="childview_getboy";2==e.sex&&(o="childview_getgirl");var s=BaseBitmap.create("childview_get");s.setPosition(170,n.y-330),this.addChild(s);var r=BaseBitmap.create(o);r.setPosition(s.x+s.width,s.y),this.addChild(r);var l=BaseBitmap.create("childview_baby");l.setPosition(GameConfig.stageWidth/2-l.width/2,r.y+r.height+30),this.addChild(l);var h=LanguageManager.getlocal("child_quality")+LanguageManager.getlocal("child_quality"+e.quality),d=ComponentManager.getTextField(h,TextFieldConst.FONTSIZE_TITLE_SMALL);d.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,d.setPosition(GameConfig.stageWidth/2-d.width/2,l.y+l.height+30),this.addChild(d);var g=BaseBitmap.create("public_9_wordbg");g.height=200,g.setPosition(GameConfig.stageWidth/2-g.width/2,d.y+d.height+30),this.addChild(g);var c=ComponentManager.getTextField(LanguageManager.getlocal("wifeLookChild"),TextFieldConst.FONTSIZE_TITLE_SMALL);c.setPosition(GameConfig.stageWidth/2-c.width/2,g.y+60),this.addChild(c);var p=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"wifeLookChildYes",this.sureBtnClick,this);p.setPosition(g.x+g.width/4*3-p.width/2,g.y+120),this.addChild(p);var _=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"wifeLookChildNo",this.noBtnClick,this);_.setColor(TextFieldConst.COLOR_BLACK),_.setPosition(g.x+g.width/4-_.width/2,g.y+120),this.addChild(_)},e.prototype.sureBtnClick=function(){return 1==Api.childVoApi.getChildNum()&&0==Api.adultVoApi.getAdultNum()&&0==Api.adultVoApi.getAdultMarryNum()?(this.hide(),void App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_CHILD_GUIDE)):(ViewController.getInstance().hideAllView(),this._childId=this.param.data,void ViewController.getInstance().openView(ViewConst.COMMON.CHILDVIEW,{childId:this._childId}))},e.prototype.noBtnClick=function(){this.hide()},e.prototype.touchTap=function(){this.hide()},e.prototype.dispose=function(){this._childId=null,t.prototype.dispose.call(this)},e}(BaseView);__reflect(WifeGetChildView.prototype,"WifeGetChildView");var WifeGetView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["wifeget_bg","wifeget","wifeget_json"])},e.prototype.getWifeid=function(){"string"==typeof this.param.data.wifeIdList&&(this.param.data.wifeIdList=[this.param.data.wifeIdList]);var t=this.param.data.wifeIdList.shift();return t},e.prototype.getWaitServantId=function(){return"object"==typeof this.param.data?this.param.data.servantId:null},e.prototype.initView=function(){this.reFreshView()},e.prototype.reFreshView=function(){this.removeTouchTap(),App.DisplayUtil.destory(this.container),this.releaseFunc(),this._personId=this.getWifeid(),this.targetType="2",this.initCallbackFunc(this.reFreshViewNext),t.prototype.startView.call(this)},e.prototype.reFreshViewNext=function(){var t=this;SoundManager.pauseBg();var e=Config.WifeCfg.getWifeCfgById(this._personId),i=e.id;"211"==i&&Api.switchVoApi.checkOpenWifeVideo()?App.VideoUtil.play("resource/other/wifeVideo/"+i+"/001001.mp4",function(){t.reFreshView2(e)}):this.reFreshView2(e)},e.prototype.reFreshView2=function(t){var e=Api.wifeVoApi.getWifeInfoVoById(Number(t.id));SoundManager.playEffect(e.sound);var i=App.CommonUtil.getContainerByLeftTopRes("wifeget_bg");i.setScale(GameConfig.stageWidth/i.width),this.addChildToContainer(i);var a=App.ParticleUtil.getParticle("wifeget");this.addChildToContainer(a),a.start();var n=egret.Rectangle.create();n.setTo(0,0,640,840);var o=BaseLoadBitmap.create(t.body,n);o.setScale(.7);var s=App.CommonUtil.getCenterPos(this.viewBg,o,!1);if(o.setPosition(s.x,s.y),this.addChildToContainer(o),Api.wifeVoApi.isHaveBone(t.bone+"_ske")){var r=App.DragonBonesUtil.getLoadDragonBones(t.bone);r.x=o.x+210,r.y=o.y+532+70,this.addChildToContainer(r),o.visible=!1}i.setPosition(App.CommonUtil.getCenterX(this.viewBg,i,!1),o.y+o.height*o.scaleY-i.height*i.scaleY),a.y=o.y-100,a.x=-350;var l=BaseBitmap.create("public_9_wordbg");l.height=200,l.setPosition(0,o.y+o.height*o.scaleY),this.addChildToContainer(l);var h=BaseBitmap.create("public_get_namebg");h.x=o.x-h.width-20,h.y=o.y,this.addChildToContainer(h);var d=ComponentManager.getTextField(t.name,TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);d.width=27,d.x=h.x+.5*(h.width-d.width),d.y=h.y+(h.height-d.height)/2-20,this.addChildToContainer(d);var g=BaseBitmap.create("public_9_bg25");g.height=200,g.x=140,g.y=o.y-g.height-10,this.addChildToContainer(g),g.width=330,g.height=90,g.x=280,g.y=o.y-120,this.addChildToContainer(g);var c=BaseBitmap.create("public_9_bg25_tail");c.x=g.x+g.width/2,c.y=o.y-120+87,this.addChildToContainer(c);var p=ComponentManager.getTextField(t.words,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_BLACK);p.width=g.width-40,p.x=g.x+20,p.y=g.y+(g.height-p.height)/2,this.addChildToContainer(p);var _=Config.SearchCfg.getPersonItemCfgByWifeId(t.id);if(_){var u=10,C=10,f=ComponentManager.getTextField(LanguageManager.getlocal("identityDesc")+LanguageManager.getlocal("syscolonDesc"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);f.setPosition(40,l.y+40),this.addChildToContainer(f);var m=ComponentManager.getTextField(_.shortDesc,TextFieldConst.FONTSIZE_CONTENT_SMALL);m.setPosition(f.x+f.width+u,f.y),this.addChildToContainer(m);var T=ComponentManager.getTextField(LanguageManager.getlocal("servantInfo_speciality4")+LanguageManager.getlocal("syscolonDesc"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);T.setPosition(f.x,f.y+f.height+C),this.addChildToContainer(T);var y=ComponentManager.getTextField(Api.wifeVoApi.getWifeInfoVoById(Number(t.id)).glamour.toString(),TextFieldConst.FONTSIZE_CONTENT_SMALL);y.setPosition(T.x+T.width+u,T.y),this.addChildToContainer(y);var v=ComponentManager.getTextField(LanguageManager.getlocal("memoirDesc")+LanguageManager.getlocal("syscolonDesc"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);v.setPosition(T.x,T.y+T.height+C),this.addChildToContainer(v);var A=ComponentManager.getTextField(_.desc,TextFieldConst.FONTSIZE_CONTENT_SMALL);A.setPosition(v.x+v.width+u,v.y),A.width=l.width-A.x-30,this.addChildToContainer(A)}this.addTouchTap(this.removeTween,this),this.container.alpha=0;var w=this;egret.Tween.get(this.container).to({alpha:1},500).call(function(){w.removeTouchTap(),w.addTouchTap(w.checkView,w)})},e.prototype.removeTween=function(){this.container&&(egret.Tween.removeTweens(this.container),this.container.alpha=1),this.removeTouchTap(),this.addTouchTap(this.checkView,this)},e.prototype.checkView=function(){this.param.data.wifeIdList.length<=0?this.hide():this.reFreshView()},e.prototype.hide=function(){var e=this.getWaitServantId();t.prototype.hide.call(this),e&&ViewController.getInstance().openView(ViewConst.BASE.SERVANTGETVIEW,e)},e.prototype.getTitleStr=function(){return null},e.prototype.getBgName=function(){return"wifeview_lovebg"},e}(DialogueGetBaseView);__reflect(WifeGetView.prototype,"WifeGetView");var WifeGivePopupView=function(t){function e(){var e=t.call(this)||this;return e._index=0,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_WIFE_GIVE,this.doGive,this),this._handler=this.param.data.handler,this._confirmCallback=this.param.data.confirmCallback;var t=this.param.data.id;this._wifeInfoVo=Api.wifeVoApi.getWifeInfoVoById(t);var e=BaseBitmap.create("public_9_resbg");e.x=100,e.y=15,this.addChildToContainer(e);var i=BaseBitmap.create("wifeview_vigoricon");i.x=e.x,i.y=e.y+e.height/2-i.height/2,this.addChildToContainer(i),this._text1=ComponentManager.getTextField(this._wifeInfoVo.intimacy.toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._text1.x=e.x+e.width/2-i.width/2,this._text1.y=i.y+i.height/2-this._text1.height/2,this.addChildToContainer(this._text1);var a=BaseBitmap.create("public_9_resbg");a.x=310,a.y=15,this.addChildToContainer(a);var n=BaseBitmap.create("wifeview_charmicon");n.x=a.x,n.y=a.y+a.height/2-n.height/2,this.addChildToContainer(n),this._text2=ComponentManager.getTextField(this._wifeInfoVo.glamour.toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WHITE),this._text2.x=a.x+a.width/2-n.width/2,this._text2.y=n.y+n.height/2-this._text2.height/2,this.addChildToContainer(this._text2);var o=BaseBitmap.create("public_9_probiginnerbg");o.width=535,o.height=535,o.x=this.viewBg.x+this.viewBg.width/2-o.width/2,o.y=75,this.addChildToContainer(o);for(var s=new Array,r=0;4>r;r++)s.push(r);var l=(Config.WifebaseCfg.wifeGift,egret.Rectangle.create());l.setTo(0,0,525,535),this._scrollList=ComponentManager.getScrollList(WifeGiveScrollItem,s,l),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(o.x+5,o.y+8)},e.prototype.doGive=function(t){var e=t.data;this._index=e.index;var i=e.num;this.request(NetRequestConst.REQUEST_WIFE_AWARD,{wifeId:this.param.data.id.toString(),key:e.key,rnum:i})},e.prototype.receiveData=function(t){if(t.data.cmd==NetRequestConst.REQUEST_WIFE_AWARD){if(t.data.data&&t.data.data.rewards){var e=GameData.formatRewardItem(t.data.data.rewards);e&&e.length>0&&App.CommonUtil.playRewardFlyAction(e)}var i=this._index,a=this._scrollList.getItemByIndex(i);a.refreshData(i);var n=this.param.data.id;this._wifeInfoVo=Api.wifeVoApi.getWifeInfoVoById(n),this._text1.text=this._wifeInfoVo.intimacy.toString(),this._text2.text=this._wifeInfoVo.glamour.toString()}},e.prototype.refreshHandler=function(){},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.dispose=function(){this._scrollList=null,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_WIFE_GIVE,this.doGive,this),this._confirmCallback=null,this._handler=null,this._wifeInfoVo=null,this._text1=null,this._text2=null,this._index=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(WifeGivePopupView.prototype,"WifeGivePopupView");var WifeGiveScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){var i=Config.WifebaseCfg.wifeGift;this._itemIndex=t,this.width=525,this.height=126+this.getSpaceY();var a=(t+1).toString(),n=BaseBitmap.create("public_9_bg14");n.width=this.width,n.height=148,n.scaleY=126/148,this.addChild(n),this._key=a,this._itemId=i[a].item;var o=Config.ItemCfg.getItemCfgById(i[a].item),s=o.getIconContainer(!0);s.setPosition(15,n.height/2*n.scaleY-s.width/2),s.name="icon",this.addChild(s);var r=ComponentManager.getTextField(o.name,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_YELLOW2);
r.setPosition(s.x+s.width+10,18),this.addChild(r);var l=Api.itemVoApi.getItemNumInfoVoById(Number(i[a].item)),h=LanguageManager.getlocal("numTitle")+l;this._numTF=ComponentManager.getTextField(h,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK),this._numTF.setPosition(r.x,r.y+r.height+10),this.addChild(this._numTF);var d="";i[a].intimacy?d=LanguageManager.getlocal("wifeGiveAdd1",[i[a].intimacy]):i[a].glamour&&(d=LanguageManager.getlocal("wifeGiveAdd2",[i[a].glamour]));var g=ComponentManager.getTextField(d,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);g.setPosition(r.x,this._numTF.y+this._numTF.height+10),this.addChild(g);var c=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"useBtn",this.chooseBtnClick,this);c.x=390,c.y=n.height/2*n.scaleY-c.height/2,this.addChild(c),c.setColor(TextFieldConst.COLOR_BLACK)},e.prototype.chooseBtnClick=function(){var t=Config.WifebaseCfg.wifeGift,e=(this._itemIndex+1).toString(),i=Api.itemVoApi.getItemNumInfoVoById(Number(t[e].item));return 0>=i?void App.CommonUtil.showTip(LanguageManager.getlocal("itemNumNotEnough")):void(5>i?App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_WIFE_GIVE,{key:this._key,index:this._itemIndex,num:1}):ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSEPOPUPVIEW,{itemId:this._itemId,maxNum:null,callback:this.useItem,handler:this}))},e.prototype.useItem=function(t,e){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_WIFE_GIVE,{key:this._key,index:this._itemIndex,num:t})},e.prototype.refreshData=function(t){var e=Config.WifebaseCfg.wifeGift,i=(t+1).toString(),a=Api.itemVoApi.getItemNumInfoVoById(Number(e[i].item)),n=LanguageManager.getlocal("numTitle")+a;this._numTF.text=n},e.prototype.getBtnClickHandler=function(){},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){this._numTF=null,this._key=null,this._itemId=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(WifeGiveScrollItem.prototype,"WifeGiveScrollItem");var WifeLoveAniView=function(t){function e(){var e=t.call(this)||this;return e._wifeId=null,e._type=null,e}return __extends(e,t),e.prototype.getResourceList=function(){var e=t.prototype.getResourceList.call(this);return this.param.data&&(this._wifeId=this.param.data.id,this._type=this.param.data.type),e.concat(["taoxin","taoxin_json","taoxinani","wifeview_lovebg","wifeview_lovewordsbg","wifeview_namebg"])},e.prototype.getTitleBgName=function(){return null},e.prototype.getTitleStr=function(){return null},e.prototype.getBgName=function(){return"wifeview_lovebg"},e.prototype.initView=function(){var t=this._wifeId;if(211==t&&Api.switchVoApi.checkOpenWifeVideo()){var e=["001003","001004","001005","001006","001007","001008"];App.VideoUtil.play("resource/other/wifeVideo/"+t+"/"+e[Math.floor(Math.random()*e.length)]+".mp4",this.initView2.bind(this))}else this.initView2()},e.prototype.initView2=function(){if(SoundManager.pauseBg(),SoundManager.playEffect(SoundConst.EFFECT_WIFE_LOVE),this._wifeMaskBmp=BaseBitmap.create("public_9_viewmask"),this._wifeMaskBmp.width=GameConfig.stageWidth,this._wifeMaskBmp.height=GameConfig.stageHeigth,this._wifeMaskBmp.touchEnabled=!0,this._wifeMaskBmp.alpha=0,this.addChild(this._wifeMaskBmp),this._wifeContainer=new BaseDisplayObjectContainer,this.addChild(this._wifeContainer),1==this._type){var t=this._wifeId;this.viewBg.visible=!1;var e=Api.wifeVoApi.getWifeInfoVoById(t),i=new WifeScrollItem1;i.initItem(t,e),this._container=new BaseDisplayObjectContainer,this.addChild(this._container),i.setPosition(-i.width/2,-i.height/2),this._container.addChild(i);var a=this.param.data.x,n=this.param.data.y,o=this.globalToLocal(a,n);this._container.setPosition(o.x+i.width/2,o.y+i.height/2),egret.Tween.get(this._container).to({scaleX:.8,scaleY:.8},500).to({scaleX:1,scaleY:1},500).wait(300).call(this.showWifeAni,this)}else this.showWifeAni()},e.prototype.showWifeAni=function(){this._container&&this.removeChild(this._container),this.viewBg.visible=!0;var t=this._wifeId,e=Api.wifeVoApi.getWifeInfoVoById(t),i=e.body;if(Api.wifeSkinVoApi.isHaveSkin(e.id)){var a=Api.wifeSkinVoApi.getWifeskinInfoVoById(e.id);if(a&&""!=a.equip){var n=Config.WifeskinCfg.getWifeCfgById(a.equip);i=n.body}}if(this._wifePic=BaseLoadBitmap.create(i),this._wifePic.setPosition(0,GameConfig.stageHeigth-760*this._wifePic.scaleY),this._wifeContainer.alpha=0,this._wifeContainer.addChild(this._wifePic),Api.wifeSkinVoApi.isHaveSkin(e.id)){var a=Api.wifeSkinVoApi.getWifeskinInfoVoById(e.id);if(a&&""!=a.equip){var n=Config.WifeskinCfg.getWifeCfgById(a.equip);if(Api.wifeVoApi.isHaveBone(n.bone+"_ske")){var o=App.DragonBonesUtil.getLoadDragonBones(n.bone);o.setScale(1.3),o.x=this._wifePic.x+340,o.y=this._wifePic.y+848-30,this._wifeContainer.addChild(o),this._wifePic.visible=!1}}else if(Api.wifeVoApi.isHaveBone(e.bone+"_ske")){var o=App.DragonBonesUtil.getLoadDragonBones(e.bone);o.setScale(1.3),o.x=this._wifePic.x+340,o.y=this._wifePic.y+848-30,this._wifeContainer.addChild(o),this._wifeContainer.visible=!0,this._wifePic.visible=!1}}else if(Api.wifeVoApi.isHaveBone(e.bone+"_ske")){var o=App.DragonBonesUtil.getLoadDragonBones(e.bone);o.setScale(1.3),o.x=this._wifePic.x+340,o.y=this._wifePic.y+848-30,this._wifeContainer.addChild(o),this._wifePic.visible=!1}egret.Tween.get(this._wifeContainer).to({alpha:1},1e3).wait(700).call(this.changePic,this),egret.Tween.get(this._wifeContainer).wait(1200).call(this.changePic2,this),egret.Tween.get(this._wifeMaskBmp).to({alpha:.8},1e3);var s=BaseBitmap.create("wifeview_namebg");s.x=25,s.y=200,this.addChild(s);var r=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_WHITE);r.width=27,r.x=s.x+s.width/2-r.width/2,r.y=s.y+95-r.height/2,this.addChild(r);var l=BaseBitmap.create("wifeview_lovewordsbg");l.x=140,l.y=this._wifePic.y-170,this.addChild(l);var h=ComponentManager.getTextField(e.words,TextFieldConst.FONTSIZE_CONTENT_SMALL);h.setColor(7153977),h.x=153,h.y=this._wifePic.y-130,h.width=320,this.addChild(h)},e.prototype.changePic2=function(){var t=ComponentManager.getCustomMovieClip("taoxinani_",13,100);t.setScale(2),t.x=0,t.y=320,this.addChild(t),t.playWithTime(1)},e.prototype.changePic=function(){if(this._wifePic){if(this.param.data.rewards){var t=GameData.formatRewardItem(this.param.data.rewards);t&&t.length>0&&App.CommonUtil.playRewardFlyAction(t)}if(!Api.switchVoApi.checkWifeAni()){var e=this._wifeId,i=Api.wifeVoApi.getWifeInfoVoById(e);if(egret.Tween.get(this._wifeContainer).to({alpha:0},2e3),Api.wifeVoApi.isHaveBone(i.bone2+"_ske")){var a=App.DragonBonesUtil.getLoadDragonBones(i.bone2);a.setScale(1.3),a.x=this._wifePic.x+340,a.y=this._wifePic.y+848-30,this.addChild(a),a.alpha=0,egret.Tween.get(a).to({alpha:1},2e3)}else{var n=BaseLoadBitmap.create(i.body2);n.setPosition(0,GameConfig.stageHeigth-760*n.scaleY),n.alpha=0,this.addChild(n),egret.Tween.get(n).to({alpha:1},2e3);var o=Api.wifeSkinVoApi.getWifeskinInfoVoById(i.id);if(o&&""!=o.equip){var s=Config.WifeskinCfg.getWifeCfgById(o.equip);if(Api.wifeVoApi.isHaveBone(s.bone2+"_ske")){var a=App.DragonBonesUtil.getLoadDragonBones(s.bone2);a.setScale(1.3),a.x=this._wifePic.x+340,a.y=this._wifePic.y+848-30,this.addChild(a),a.alpha=0,egret.Tween.get(a).to({alpha:1},2e3),n.visible=!1}else RES.hasRes(s.body2)&&n.setload(s.body2)}}}var r=App.ParticleUtil.getParticle("taoxin");r.x=-450,r.y=GameConfig.stageHeigth-860,r.start(),this.addChild(r),WifeView.isMoveing=!1,this.addTouchTap(this.touchTap,this,null)}},e.prototype.touchTap=function(){this.hide(),SoundManager.resumeBg(),this.param.data.childData&&ViewController.getInstance().openView(ViewConst.BASE.WIFEGETCHILDVIEW,this.param.data.childData),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_WIFE_LOVECOM),Api.rookieVoApi.isInGuiding&&Api.rookieVoApi.checkWaitingGuide()},e.prototype.dispose=function(){this._wifeId=null,egret.Tween.removeTweens(this._wifePic),this._container=null,this._wifeContainer=null,this._wifeId=null,this._wifePic=null,this._type=null,this._taoxinParticle=null,this._wifeMaskBmp=null,t.prototype.dispose.call(this)},e}(BaseView);__reflect(WifeLoveAniView.prototype,"WifeLoveAniView");var WifeOptView=function(t){function e(){var e=t.call(this)||this;return e._giveDotSp=null,e._skillDotSp=null,e._skinDotSp=null,e._wordsCornerBg=null,e._wordsBg=null,e._isMoving=!1,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_CHILD_GUIDE,this.doGuide,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_AWARD),this.refreshInfoAfterLove,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_UPGRADESKILL),this.refreshInfoAfterLove,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_WIFE,this.checkRedPoint,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_WIFESKIN,this.checkRedPoint,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_EQUIP),this.moveUiUp,this),App.MessageHelper.addEventListener(MessageConst.MESSAGE_WIFE_LOVECOM,this.checkDro2,this);var t=this.param.data.id;this._wifeInfoVo=Api.wifeVoApi.getWifeInfoVoById(t);var e=Api.wifeSkinVoApi.getWifeskinInfoVoById(this._wifeInfoVo.id);if(e&&""!=e.equip){var i=Config.WifeskinCfg.getWifeCfgById(e.equip);this.playEffect(i.sound,!0)}else this.playEffect(this._wifeInfoVo.sound,!0);var a=BaseBitmap.create("wifeview_optbg");a.y=-15,this.addChildToContainer(a),this._topContanier=new BaseDisplayObjectContainer,this.addChildToContainer(this._topContanier);var n=BaseBitmap.create("public_9_bg11");n.width=GameConfig.stageWidth,n.height=70,n.y=-21,this._topContanier.addChild(n);var o=ComponentManager.getTextField(this._wifeInfoVo.desc,TextFieldConst.FONTSIZE_CONTENT_SMALL);o.setColor(TextFieldConst.COLOR_WHITE),o.x=20,o.width=GameConfig.stageWidth-2*o.x,this._topContanier.addChild(o);var s=this._wifeInfoVo.body;if(Api.wifeSkinVoApi.isHaveSkin(this._wifeInfoVo.id)){var r=Api.wifeSkinVoApi.getWifeskinInfoVoById(this._wifeInfoVo.id);if(r&&""!=r.equip){var i=Config.WifeskinCfg.getWifeCfgById(r.equip);s=i.body,Api.wifeVoApi.isHaveBone(i.bone+"_ske")&&(this._droWifeIcon=App.DragonBonesUtil.getLoadDragonBones(i.bone),this.addChildToContainer(this._droWifeIcon))}else Api.wifeVoApi.isHaveBone(this._wifeInfoVo.bone+"_ske")&&(this._droWifeIcon=App.DragonBonesUtil.getLoadDragonBones(this._wifeInfoVo.bone),this.addChildToContainer(this._droWifeIcon))}else Api.wifeVoApi.isHaveBone(this._wifeInfoVo.bone+"_ske")&&(this._droWifeIcon=App.DragonBonesUtil.getLoadDragonBones(this._wifeInfoVo.bone),this.addChildToContainer(this._droWifeIcon));var l=.8;this._wifeIcon=BaseLoadBitmap.create(s),this._wifeIcon.x=80,this._wifeIcon.setScale(l),this.addChildToContainer(this._wifeIcon),this._droWifeIcon&&(this._wifeIcon.visible=!1,this._droWifeIcon2=this._droWifeIcon);var h=BaseBitmap.create("wifeview_namebg");h.x=25,h.y=200,this.addChildToContainer(h);var d=ComponentManager.getTextField(this._wifeInfoVo.name,TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_WHITE);d.width=27,d.x=h.x+h.width/2-d.width/2,d.y=h.y+95-d.height/2,this.addChildToContainer(d),this._wordsBg=BaseBitmap.create("public_9_bg25"),this._wordsBg.width=430,this._wordsBg.height=90,this._wordsBg.x=180,this.addChildToContainer(this._wordsBg),this._wordsCornerBg=BaseBitmap.create("public_9_bg25_tail"),this._wordsCornerBg.x=390,this.addChildToContainer(this._wordsCornerBg),this._wifeWordsText=ComponentManager.getTextField(this._wifeInfoVo.words,TextFieldConst.FONTSIZE_CONTENT_SMALL),this._wifeWordsText.setColor(TextFieldConst.COLOR_BLACK),this._wifeWordsText.x=200,this._wifeWordsText.width=390,this.addChildToContainer(this._wifeWordsText),this._bottomBg=BaseBitmap.create("wifeview_bottombg2"),this._bottomBg.x=0,this._bottomBg.y=GameConfig.stageHeigth-this.container.y-this._bottomBg.height,App.LogUtil.log(this._bottomBg.y),this.addChildToContainer(this._bottomBg),this._wifeIcon.y=158,this._wifeIcon.y+840*l<this._bottomBg.y+50&&(this._wifeIcon.y=this._bottomBg.y+50-840*l),this._droWifeIcon&&(this._droWifeIcon.setScale(1.1),this._droWifeIcon.x=this._wifeIcon.x+230,this._droWifeIcon.y=this._wifeIcon.y+532+140),this._wordsBg.y=this._wifeIcon.y-90,this._wifeWordsText.y=this._wordsBg.y+20,this._wordsCornerBg.y=this._wordsBg.y+87;var g=BaseBitmap.create("wifeview_vigoricon");g.x=50,g.y=this._bottomBg.y+75,this.addChildToContainer(g);var c=LanguageManager.getlocal("wifeIntimacy")+" "+this._wifeInfoVo.intimacy;this._intimateValueText=ComponentManager.getTextField(c,TextFieldConst.FONTSIZE_CONTENT_SMALL),this._intimateValueText.setColor(TextFieldConst.COLOR_WHITE),this._intimateValueText.x=g.x+g.width+5,this._intimateValueText.y=g.y+g.height/2-this._intimateValueText.height/2,this.addChildToContainer(this._intimateValueText);var p=BaseBitmap.create("wifeview_childicon");p.x=g.x,p.y=g.y+g.width,this.addChildToContainer(p);var _=LanguageManager.getlocal("wifeChildren")+" "+this._wifeInfoVo.child;this._childrenValueText=ComponentManager.getTextField(_,TextFieldConst.FONTSIZE_CONTENT_SMALL),this._childrenValueText.setColor(TextFieldConst.COLOR_WHITE),this._childrenValueText.x=this._intimateValueText.x,this._childrenValueText.y=p.y+p.height/2-this._intimateValueText.height/2,this.addChildToContainer(this._childrenValueText);var u=BaseBitmap.create("wifeview_charmicon");u.x=345,u.y=g.y,this.addChildToContainer(u);var C=LanguageManager.getlocal("wifeCharm")+" "+this._wifeInfoVo.glamour;this._charmValueText=ComponentManager.getTextField(C,TextFieldConst.FONTSIZE_CONTENT_SMALL),this._charmValueText.setColor(TextFieldConst.COLOR_WHITE),this._charmValueText.x=u.x+u.width+5,this._charmValueText.y=u.y+u.height/2-this._intimateValueText.height/2,this.addChildToContainer(this._charmValueText);var f=BaseBitmap.create("wifeview_vexpicon");f.x=u.x,f.y=p.y,this.addChildToContainer(f);var m=LanguageManager.getlocal("wifeExp")+" "+this._wifeInfoVo.exp;this._expValueText=ComponentManager.getTextField(m,TextFieldConst.FONTSIZE_CONTENT_SMALL),this._expValueText.setColor(TextFieldConst.COLOR_WHITE),this._expValueText.x=u.x+u.width+5,this._expValueText.y=this._childrenValueText.y,this.addChildToContainer(this._expValueText);var T=this._bottomBg.y-50,y=BaseBitmap.create("wifeview_btnbg");y.x=50,y.y=T,this.addChildToContainer(y);var v=BaseBitmap.create("wifeview_btnbg");v.x=180,v.y=T,this.addChildToContainer(v);var A=BaseBitmap.create("wifeview_btnbg");A.x=310,A.y=T,this.addChildToContainer(A);var w=BaseBitmap.create("wifeview_btnbg");w.x=450,w.y=T,this.addChildToContainer(w),this._loveBtn=ComponentManager.getButton("wife_love",null,this.loveHander,this,null,0),this._loveBtn.x=70,this._loveBtn.y=T,this.addChildToContainer(this._loveBtn);var x=BaseBitmap.create("wife_btnbg");x.x=this._loveBtn.x+10,x.y=this._loveBtn.y+70,this.addChildToContainer(x);var I=ComponentManager.getTextField(LanguageManager.getlocal("wifeLoveBtn"),TextFieldConst.FONTSIZE_CONTENT_SMALL);I.setColor(TextFieldConst.COLOR_LIGHT_YELLOW),I.x=x.x+x.width/2-I.width/2,I.y=x.y+x.height/2-I.height/2,this.addChildToContainer(I),this._giveBtn=ComponentManager.getButton("wife_give",null,this.giveHander,this,null,0),this._giveBtn.x=200,this._giveBtn.y=T,this.addChildToContainer(this._giveBtn);var L=BaseBitmap.create("wife_btnbg");L.x=this._giveBtn.x+10,L.y=this._giveBtn.y+70,this.addChildToContainer(L);var E=ComponentManager.getTextField(LanguageManager.getlocal("wifeGiveBtn"),TextFieldConst.FONTSIZE_CONTENT_SMALL);E.setColor(TextFieldConst.COLOR_LIGHT_YELLOW),E.x=L.x+L.width/2-E.width/2,E.y=L.y+L.height/2-E.height/2,this.addChildToContainer(E),this._skillBtn=ComponentManager.getButton("wife_skill",null,this.skillHander,this,null,0),this._skillBtn.x=333,this._skillBtn.y=T,this.addChildToContainer(this._skillBtn);var B=BaseBitmap.create("wife_btnbg");B.x=this._skillBtn.x+10,B.y=this._skillBtn.y+70,this.addChildToContainer(B);var S=ComponentManager.getTextField(LanguageManager.getlocal("wifeSkillBtn"),TextFieldConst.FONTSIZE_CONTENT_SMALL);S.setColor(TextFieldConst.COLOR_LIGHT_YELLOW),S.x=B.x+B.width/2-S.width/2,S.y=B.y+B.height/2-S.height/2,this.addChildToContainer(S),this._skinBtn=ComponentManager.getButton("wifeview_skin",null,this.skinHander,this,null,0),this._skinBtn.x=470,this._skinBtn.y=T,this.addChildToContainer(this._skinBtn);var N=BaseBitmap.create("wife_btnbg");N.x=this._skinBtn.x+10,N.y=this._skinBtn.y+70,this.addChildToContainer(N);var M=ComponentManager.getTextField(LanguageManager.getlocal("wifeskinViewTitle"),TextFieldConst.FONTSIZE_CONTENT_SMALL);M.setColor(TextFieldConst.COLOR_LIGHT_YELLOW),M.x=N.x+N.width/2-M.width/2,M.y=N.y+N.height/2-M.height/2,this.addChildToContainer(M),this.checkRedPoint()},e.prototype.checkRedPoint=function(){Api.wifeVoApi.getGiveRed()?null==this._giveDotSp?(this._giveDotSp=BaseBitmap.create("public_dot2"),this._giveDotSp.x=this._giveBtn.x+this._giveBtn.width-this._giveDotSp.width,this._giveDotSp.y=this._giveBtn.y,this.addChildToContainer(this._giveDotSp)):this._giveDotSp&&(this._giveDotSp.visible=!0):this._giveDotSp&&(this._giveDotSp.visible=!1),Api.wifeVoApi.getSkillRed(this._wifeInfoVo.id)?null==this._skillDotSp?(this._skillDotSp=BaseBitmap.create("public_dot2"),this._skillDotSp.x=this._skillBtn.x+this._skillBtn.width-this._skillDotSp.width,this._skillDotSp.y=this._skillBtn.y,this.addChildToContainer(this._skillDotSp)):this._skillDotSp&&(this._skillDotSp.visible=!0):this._skillDotSp&&(this._skillDotSp.visible=!1),Api.wifeSkinVoApi.getSkinRed(this.param.data.id)?null==this._skinDotSp?(this._skinDotSp=BaseBitmap.create("public_dot2"),this._skinDotSp.x=this._skinBtn.x+this._skinBtn.width-this._skinDotSp.width,this._skinDotSp.y=this._skinBtn.y,this.addChildToContainer(this._skinDotSp)):this._skinDotSp&&(this._skinDotSp.visible=!0):this._skinDotSp&&(this._skinDotSp.visible=!1)},e.prototype.loveHander=function(){if(!this._isMoving){var t=Api.playerVoApi.getPlayerGem(),e=Api.wifeVoApi.getLoveNeedGem(this._wifeInfoVo.intimacy),i=LanguageManager.getlocal("wifeLoveUseGem",[App.StringUtil.toString(e),this._wifeInfoVo.name]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{useNum:e,confirmCallback:this.confirmCallbackHandler,handler:this,icon:"itemicon1",iconBg:"itembg_1",num:t,msg:i,id:1})}},e.prototype.giveHander=function(){this._isMoving||ViewController.getInstance().openView(ViewConst.POPUP.WIFEGIVEPOPUPVIEW,{id:this.param.data.id,confirmCallback:this.confirmCallbackHandler,handler:this})},e.prototype.skillHander=function(){this._isMoving||ViewController.getInstance().openView(ViewConst.POPUP.WIFESKILLPOPUPVIEW,{id:this.param.data.id,confirmCallback:this.confirmCallbackHandler,handler:this})},e.prototype.skinHander=function(){if(PlatformManager.checkIsKRSp())return void App.CommonUtil.showTip(LanguageManager.getlocal("sysWaitOpen"));if(!this._isMoving){var t=this.param.data.id;if(!Api.wifeSkinVoApi.isHaveSkin(t))return void App.CommonUtil.showTip(LanguageManager.getlocal("wifeskinNoSkin"));this._droWifeIcon&&this._droWifeIcon.stop(),ViewController.getInstance().openView(ViewConst.POPUP.WIFESKINVIEW,{id:this.param.data.id,confirmCallback:this.confirmCallbackHandler,handler:this})}},e.prototype.confirmCallbackHandler=function(){var t=this.param.data.id;if(Api.playerVoApi.getPlayerGem()<Api.wifeVoApi.getLoveNeedGem(this._wifeInfoVo.intimacy))return void App.CommonUtil.showTip(LanguageManager.getlocal("wifeLoveTip1"));var e=App.StringUtil.toString(t);this.request(NetRequestConst.REQUEST_WIFE_LOVE,{wifeId:e}),this._droWifeIcon&&this._droWifeIcon.stop()},e.prototype.receiveData=function(t){if(!(t.data.ret<0)&&t.data.cmd==NetRequestConst.REQUEST_WIFE_LOVE){var e=this.param.data.id;this._wifeInfoVo=Api.wifeVoApi.getWifeInfoVoById(e);var i=LanguageManager.getlocal("wifeIntimacy")+" "+this._wifeInfoVo.intimacy;this._intimateValueText.text=i;var a=LanguageManager.getlocal("wifeChildren")+" "+this._wifeInfoVo.child;this._childrenValueText.text=a;var n=LanguageManager.getlocal("wifeCharm")+" "+this._wifeInfoVo.glamour;this._charmValueText.text=n;var o=LanguageManager.getlocal("wifeExp")+" "+this._wifeInfoVo.exp;this._expValueText.text=o;var s=null;t.data.data.childArr.length>0&&(s=t.data.data.childArr[0]),ViewController.getInstance().openView(ViewConst.BASE.WIFELOVEANIVIEW,{id:this.param.data.id,type:2,childData:s,rewards:t.data.data.rewards})}},e.prototype.refreshInfoAfterLove=function(){var t=this.param.data.id;this._wifeInfoVo=Api.wifeVoApi.getWifeInfoVoById(t);var e=LanguageManager.getlocal("wifeIntimacy")+" "+this._wifeInfoVo.intimacy;this._intimateValueText.text=e;var i=LanguageManager.getlocal("wifeChildren")+" "+this._wifeInfoVo.child;this._childrenValueText.text=i;var a=LanguageManager.getlocal("wifeCharm")+" "+this._wifeInfoVo.glamour;this._charmValueText.text=a;var n=LanguageManager.getlocal("wifeExp")+" "+this._wifeInfoVo.exp;this._expValueText.text=n},e.prototype.refreshInfoAfterSkin=function(){var t=this.param.data.id;this._wifeInfoVo=Api.wifeVoApi.getWifeInfoVoById(t);var e=Api.wifeVoApi.getWifeInfoVoById(t),i=e.body;if(Api.wifeSkinVoApi.isHaveSkin(e.id)){var a=Api.wifeSkinVoApi.getWifeskinInfoVoById(e.id);if(a&&""!=a.equip){var n=Config.WifeskinCfg.getWifeCfgById(a.equip);i=n.body}}this._wifeIcon.setload(i),this.checkDro()},e.prototype.checkDro=function(){this._droWifeIcon&&(this._droWifeIcon.dispose(),this._droWifeIcon=null);var t=this.container.getChildIndex(this._wifeIcon);if(Api.wifeSkinVoApi.isHaveSkin(this._wifeInfoVo.id)){var e=Api.wifeSkinVoApi.getWifeskinInfoVoById(this._wifeInfoVo.id);if(e&&""!=e.equip){var i=Config.WifeskinCfg.getWifeCfgById(e.equip);Api.wifeVoApi.isHaveBone(i.bone+"_ske")&&(this._droWifeIcon=App.DragonBonesUtil.getLoadDragonBones(i.bone),this.container.addChildAt(this._droWifeIcon,t),this._wifeIcon.visible=!1)}else Api.wifeVoApi.isHaveBone(this._wifeInfoVo.bone+"_ske")&&(this._droWifeIcon=App.DragonBonesUtil.getLoadDragonBones(this._wifeInfoVo.bone),this.container.addChildAt(this._droWifeIcon,t))}else Api.wifeVoApi.isHaveBone(this._wifeInfoVo.bone+"_ske")&&(this._droWifeIcon=App.DragonBonesUtil.getLoadDragonBones(this._wifeInfoVo.bone),this.container.addChildAt(this._droWifeIcon,t),this._wifeIcon.visible=!1);this._droWifeIcon?(this._droWifeIcon.setScale(1.1),this._droWifeIcon.x=this._wifeIcon.x+230,this._droWifeIcon.y=this._wifeIcon.y+532+140):this._wifeIcon.visible=!0,this._droWifeIcon2=this._droWifeIcon},e.prototype.checkDro2=function(){this._droWifeIcon?this._droWifeIcon.resume():this._wifeIcon.visible=!0},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["wifeview_namebg","wifeview_optbg","wifeview_namebg","wifeview_bottombg2","wifeview_charmicon","wifeview_childicon","wifeview_vexpicon","wifeview_vigoricon","wifeview_mask","wife_btnbg","wife_give","wife_love","wife_skill","wifeview_btnbg","wifeview_skin","wifeview_skinmask","wifeview_skingray","wifeview_skinstar"])},e.prototype.moveUiUp=function(){var t=this;this._isMoving=!0,egret.Tween.get(this.container).wait(200).call(function(){this._wordsBg.visible=!1,this._wifeWordsText.visible=!1,this._wordsCornerBg.visible=!1},this),egret.Tween.get(this._topContanier).to({y:-600},400).call(this.showSkinAni,this).wait(2700).to({y:10},500).to({y:0},100).call(function(){t._wordsBg.visible=!0,t._wifeWordsText.visible=!0,t._wordsCornerBg.visible=!0,t._isMoving=!1},this).call(this.showStar,this)},e.prototype.showStar=function(){for(var t=this,e=function(){var e=(App.MathUtil.getRandom(1,3),BaseBitmap.create("wifeview_skinstar"));e.rotation=-20,e.setScale(3);var n=new BaseDisplayObjectContainer,o=App.MathUtil.getRandom(-200,300),s=App.MathUtil.getRandom(-200,180);n.x=GameConfig.stageWidth/2-e.width/2*e.scaleX+o,n.addChild(e),n.y=i.container.height/2+s,i.container.addChildAt(n,10),e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,n.setScale(.1),egret.Tween.get(n,{loop:!1}).wait(100*a).to({scaleX:1,scaleY:1},500).call(function(){t.removeChildFromContainer(n),n=null,e=null},i)},i=this,a=0;10>a;a++)e();var n=this.param.data.id;this._wifeInfoVo=Api.wifeVoApi.getWifeInfoVoById(n);var o=Api.wifeVoApi.getWifeInfoVoById(n),s=(o.body,Api.wifeSkinVoApi.getWifeskinInfoVoById(o.id));if(s&&""!=s.equip){var r=Config.WifeskinCfg.getWifeCfgById(s.equip);this.playEffect(r.sound,!0)}else this.playEffect(this._wifeInfoVo.sound,!0)},e.prototype.showSkinAni=function(){var t=this.container.getChildIndex(this._bottomBg),e=BaseBitmap.create("wifeview_skinmask");e.x=-640,e.y=-20,this.container.addChildAt(e,t),egret.Tween.get(e).to({x:0},800).to({x:-30},100).wait(200).call(function(){},this).wait(1700).to({x:0},100).to({x:-640},600);var i=BaseBitmap.create("wifeview_skinmask");i.$setSkewY(180),i.x=2*GameConfig.stageWidth,i.y=-20,this.container.addChildAt(i,t),egret.Tween.get(i).to({x:640},800).to({x:670},100).wait(200).call(this.addMask,this).wait(1700).to({x:640},100).to({x:2*GameConfig.stageWidth},600)},e.prototype.addMask=function(){var t=BaseBitmap.create("wifeview_skingray");t.alpha=0,t.x=GameConfig.stageWidth/2-t.width/2,t.y=this._wifeIcon.y;var e=this.container.getChildIndex(this._bottomBg);this.container.addChildAt(t,e),egret.Tween.get(t).to({alpha:.4},300).wait(1e3).to({alpha:0},500).call(function(){t.dispose()},this),this.refreshInfoAfterSkin()},e.prototype.getRuleInfo=function(){return"wife_description"},e.prototype.doGuide=function(){this.hide()},e.prototype.touchTap=function(){this.hide()},e.prototype.dispose=function(){t.prototype.dispose.call(this),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_CHILD_GUIDE,this.doGuide,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_AWARD),this.refreshInfoAfterLove,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_UPGRADESKILL),this.refreshInfoAfterLove,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_WIFE,this.checkRedPoint,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_WIFESKIN,this.checkRedPoint,this),App.MessageHelper.removeNetMessage(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_EQUIP),this.moveUiUp,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_WIFE_LOVECOM,this.checkDro2,this),this._intimateValueText=null,this._childrenValueText=null,this._charmValueText=null,this._expValueText=null,this._wifeInfoVo=null,this._giveDotSp=null,this._skillDotSp=null,this._skinDotSp=null,this._loveBtn=null,this._giveBtn=null,this._skinBtn=null,this._skinBtn=null,this._topContanier=null,this._wordsCornerBg=null,this._wordsBg=null,this._wifeWordsText=null,this._isMoving=!1,this._droWifeIcon=null,this._droWifeIcon2=null},e}(CommonView);__reflect(WifeOptView.prototype,"WifeOptView");var WifeScrollItem1=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){if(!e)return this.width=622,void(0==t?this.height=100+this.getSpaceY():this.height=30+this.getSpaceY());this.width=622,this.height=500+this.getSpaceY(),this._wifeInfoVo=e;var i=BaseBitmap.create("wifehalfbg");i.x=this.width/2-i.width/2,this.addChild(i);var a=e.body;if(Api.wifeSkinVoApi.isHaveSkin(e.id)){var n=Api.wifeSkinVoApi.getWifeskinInfoVoById(e.id);if(n&&""!=n.equip){var o=Config.WifeskinCfg.getWifeCfgById(n.equip);a=o.body}}this._wifeIcon=BaseLoadBitmap.create(a),this._wifeIcon.x=i.x+60,this._wifeIcon.y=20,this._wifeIcon.setScale(.6),this.addChild(this._wifeIcon),i.addTouchTap(this.clickItemHandler,this);var s=new egret.Rectangle(0,0,640,692);this._wifeIcon.mask=s;var r=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_WHITE);r.width=27,r.x=i.x+38,r.y=i.y+223-r.height/2,this.addChild(r);var l=BaseBitmap.create("public_itemtipbg2");l.width=100,l.x=220,l.y=this.height-l.height-80,this.addChild(l);var h=BaseBitmap.create("wifeview_vigoricon");h.x=l.x-h.width/2,h.y=l.y+l.height/2-h.height/2,this.addChild(h),this._intimacyTF=ComponentManager.getTextField(e.intimacy.toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON),this._intimacyTF.x=l.x+l.width/2-h.width/2+10,this._intimacyTF.y=l.y+l.height/2-this._intimacyTF.height/2,this.addChild(this._intimacyTF);var d=BaseBitmap.create("public_itemtipbg2");d.width=l.width,d.x=l.x+130,d.y=l.y,this.addChild(d);var g=BaseBitmap.create("wifeview_charmicon");g.x=d.x-g.width/2,g.y=d.y+d.height/2-g.height/2,this.addChild(g),this._glamourTF=ComponentManager.getTextField(e.glamour.toString(),TextFieldConst.FONTSIZE_CONTENT_COMMON),this._glamourTF.x=d.x+d.width/2-h.width/2+10,this._glamourTF.y=d.y+d.height/2-this._glamourTF.height/2,this.addChild(this._glamourTF)},e.prototype.clickItemHandler=function(t){WifeView.isMoveing||(ViewController.getInstance().openView(ViewConst.COMMON.WIFEOPTVIEW,{id:this._wifeInfoVo.id,handler:this}),SoundManager.stopEffect(SoundConst.EFFECT_WIFE),WifeView.wifeId=this._wifeInfoVo.id)},e.prototype.refreshData=function(t){var e=Api.wifeVoApi.getWifeInfoVoById(t);this._intimacyTF.text=e.intimacy.toString(),this._glamourTF.text=e.glamour.toString();var i=e.body;if(Api.wifeSkinVoApi.isHaveSkin(e.id)){var a=Api.wifeSkinVoApi.getWifeskinInfoVoById(e.id);if(a&&""!=a.equip){var n=Config.WifeskinCfg.getWifeCfgById(a.equip);i=n.body}}this._wifeIcon.setload(i)},e.prototype.getSpaceY=function(){return 60},e.prototype.dispose=function(){this._intimacyTF=null,this._glamourTF=null,this._wifeInfoVo=null,this._wifeIcon=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(WifeScrollItem1.prototype,"WifeScrollItem1");var WifeScrollItem2=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=640,this.height=321+this.getSpaceY();var i=BaseBitmap.create("wifeview_itembg");i.width=this.width,this.addChild(i);var a=BaseLoadBitmap.create(e.body);a.x=60,a.y=0,this.addChild(a),a.setScale(.35);var n=BaseBitmap.create("wifeview_itembg2");n.width=this.width,this.addChild(n);var o=ComponentManager.getTextField(e.name,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE);o.width=27,o.x=29,o.y=i.y+141-o.height/2,this.addChild(o);var s=ComponentManager.getTextField(LanguageManager.getlocal("wifeUnlock_title"),TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW);s.x=350,s.y=50,this.addChild(s);var r=BaseBitmap.create("wifeview_lockbg");this.addChild(r),r.x=s.x-30,r.y=s.y+s.height+5;var l=ComponentManager.getTextField(e.wifeunlock,TextFieldConst.FONTSIZE_BUTTON_COMMON,TextFieldConst.COLOR_WARN_RED3);l.x=s.x,l.y=r.y+r.height/2-l.height/2,this.addChild(l);var h=ComponentManager.getTextField(e.desc,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);h.width=255,h.x=s.x,h.y=r.y+r.height+10,this.addChild(h)},e.prototype.getSpaceY=function(){return 10},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(WifeScrollItem2.prototype,"WifeScrollItem2");var WifeSkillPopupView=function(t){function e(){var e=t.call(this)||this;return e._index=0,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_NOTICE_WIFE_SKILLUPD,this.doGive,this),this._handler=this.param.data.handler,this._confirmCallback=this.param.data.confirmCallback;var t=this.param.data.id;this._wifeInfoVo=Api.wifeVoApi.getWifeInfoVoById(t),e.wifeId=t;var i=Config.WifeCfg.getWifeCfgById(t),a=Config.ServantCfg.getServantItemById(i.servantId),n=a.qualityBoxImgPath;if(Api.servantVoApi.getServantObj(i.servantId)){var o=Api.servantVoApi.getServantObj(i.servantId);n=o.qualityBoxImgPath}var s=108,r=BaseLoadBitmap.create(n);r.x=30,r.y=15,this.addChildToContainer(r),r.scaleX=s/194,r.scaleY=s/192;var l=BaseLoadBitmap.create(a.halfIcon);l.x=r.x+5,l.y=r.y+5,this.addChildToContainer(l),l.scaleX=(s-10)/180,l.scaleY=(s-10)/177;var h=LanguageManager.getlocal("wifeSkillServant",[a.name]),d=ComponentManager.getTextField(h,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK);
if(d.x=150,d.y=20,this.addChildToContainer(d),!Api.servantVoApi.getServantObj(i.servantId)){var g=ComponentManager.getTextField(LanguageManager.getlocal("wifeServantGet"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_WARN_RED);g.x=d.x+d.width+5,g.y=d.y,this.addChildToContainer(g);var c=BaseBitmap.create("wifeview_mask");c.x=r.x,c.y=r.y,this.addChildToContainer(c)}var p=LanguageManager.getlocal("wifeExp")+" "+this._wifeInfoVo.exp.toString();this._text1=ComponentManager.getTextField(p,TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_BLACK),this._text1.x=d.x,this._text1.y=d.y+d.height+15,this.addChildToContainer(this._text1);var _=ComponentManager.getTextField(LanguageManager.getlocal("wifeSkilTip"),TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WARN_RED);_.x=d.x,_.y=this._text1.y+this._text1.height+15,this.addChildToContainer(_);var u=BaseBitmap.create("public_9_probiginnerbg");u.width=535,u.height=535,u.x=this.viewBg.x+this.viewBg.width/2-u.width/2,u.y=135,this.addChildToContainer(u);var C=this._wifeInfoVo.cfg.wifeSkill,f=egret.Rectangle.create();f.setTo(0,0,525,535),this._scrollList=ComponentManager.getScrollList(WifeSkillScrollItem,C,f),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(u.x+5,u.y+5)},e.prototype.doGive=function(t){var e=t.data;this._index=e.index,this.request(NetRequestConst.REQUEST_WIFE_UPGRADESKILL,{wifeId:this.param.data.id.toString(),key:e.index})},e.prototype.receiveData=function(t){if(t.data.cmd==NetRequestConst.REQUEST_WIFE_UPGRADESKILL){if(t.data.data&&t.data.data.rewards){var e=GameData.formatRewardItem(t.data.data.rewards);e&&e.length>0&&App.CommonUtil.playRewardFlyAction(e)}var i=this._index,a=this._scrollList.getItemByIndex(i);a.refreshData(i);var n=this.param.data.id;this._wifeInfoVo=Api.wifeVoApi.getWifeInfoVoById(n);var o=LanguageManager.getlocal("wifeExp")+" "+this._wifeInfoVo.exp.toString();this._text1.text=o,App.CommonUtil.showTip(LanguageManager.getlocal("wifeSkillUpdSuccess"))}},e.prototype.refreshHandler=function(){},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.dispose=function(){this._scrollList=null,this._confirmCallback=null,this._handler=null,this._wifeInfoVo=null,this._text1=null,this._index=null,e.wifeId=null,App.MessageHelper.removeEventListener(MessageConst.MESSAGE_NOTICE_WIFE_SKILLUPD,this.doGive,this),t.prototype.dispose.call(this)},e.wifeId=null,e}(PopupView);__reflect(WifeSkillPopupView.prototype,"WifeSkillPopupView");var WifeSkillScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this._cfgData=e,this._itemIndex=t,this.width=525,this.height=126+this.getSpaceY();var i=((t+1).toString(),WifeSkillPopupView.wifeId);this._wifeInfoVo=Api.wifeVoApi.getWifeInfoVoById(i);var a=t+1,n=a+"."+LanguageManager.getlocal("wifeSkill_"+i+"_"+a),o=ComponentManager.getTextField(n,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW);o.setPosition(10,10),this.addChild(o);var s="(Lv."+this._wifeInfoVo.skill[t]+")";this._skillLevelTF=ComponentManager.getTextField(s,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_LIGHT_YELLOW),this._skillLevelTF.setPosition(o.x+o.width+10,o.y),this.addChild(this._skillLevelTF),WifeSkillPopupView.wifeId=i;var r=Config.WifeCfg.getWifeCfgById(i),l=Config.ServantCfg.getServantItemById(r.servantId),h="",d="",g="",c="";if(4==e.att.length)c=l.name+LanguageManager.getlocal("wifeSkillAllAttAdd");else{for(var p=0;p<e.att.length;p++){var _=e.att[p];c=0==p?LanguageManager.getlocal("servantInfo_speciality"+_):c+"、"+LanguageManager.getlocal("servantInfo_speciality"+_)}c=l.name+c+LanguageManager.getlocal("wifeSkillAttAdd")}var u=11645361,C=TextFieldConst.COLOR_WARN_GREEN,f="";if(e.condition<=this._wifeInfoVo.intimacy){u=TextFieldConst.COLOR_WHITE;var m="",T="",y=t+1,v=1;this._wifeInfoVo.skill[t]>=Config.WifebaseCfg.wifeSkillMax&&(y=t,v=0),e.growAtt<1?(m=100*e.growAtt*this._wifeInfoVo.skill[t]+"%",T=100*e.growAtt*(this._wifeInfoVo.skill[t]+v)+"%"):(m=(e.growAtt*this._wifeInfoVo.skill[t]).toString(),T=(e.growAtt*(this._wifeInfoVo.skill[t]+v)).toString());var A=Config.WifebaseCfg["wifeSkill"+(this._itemIndex+1)][this._wifeInfoVo.skill[this._itemIndex]-1];f=m,h=LanguageManager.getlocal("wifeSkillCur")+c+m,d=LanguageManager.getlocal("wifeSkillNext")+c+T,g=LanguageManager.getlocal("wifeSkillUpdNeed",[A])}else{var m="";m=e.growAtt<1?100*e.growAtt*this._wifeInfoVo.skill[t]+"%":(e.growAtt*this._wifeInfoVo.skill[t]).toString(),C=11645361,h=LanguageManager.getlocal("wifeSkillLock")+c+m,d="1",g=LanguageManager.getlocal("wifeSkillUnLockNeed")+e.condition}if(this._att1TF=ComponentManager.getTextField(h,TextFieldConst.FONTSIZE_CONTENT_SMALL,u),this._att1TF.x=o.x,this._att1TF.y=o.y+o.height+10,this.addChild(this._att1TF),this._att2TF=ComponentManager.getTextField(d,TextFieldConst.FONTSIZE_CONTENT_SMALL,u),this._att2TF.x=o.x,this._att2TF.y=this._att1TF.y+this._att1TF.height+5,this.addChild(this._att2TF),this._att3TF=ComponentManager.getTextField(g,TextFieldConst.FONTSIZE_CONTENT_SMALL,C),this._att3TF.x=o.x,this._att3TF.y=this._att2TF.y+this._att2TF.height+5,this.addChild(this._att3TF),this._wifeInfoVo.skill[t]>=Config.WifebaseCfg.wifeSkillMax){var w=ComponentManager.getTextField(LanguageManager.getlocal("wifeSkillMaxShow"),TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_WARN_RED);w.x=400,w.y=this.height/2-w.height/2,this.addChild(w)}else this._updBtn=ComponentManager.getButton(ButtonConst.BTN_SMALL_YELLOW,"servantInfoLevelup",this.updBtnClick,this),this._updBtn.x=400,this._updBtn.y=this.height/2-this._updBtn.height/2,this.addChild(this._updBtn),this._updBtn.setColor(TextFieldConst.COLOR_BLACK);e.condition>this._wifeInfoVo.intimacy&&(this._att2TF.visible=!1,this._updBtn.visible=!1,this._skillLevelTF.visible=!1),this._wifeInfoVo.skill[t]>=Config.WifebaseCfg.wifeSkillMax&&(this._att2TF.visible=!1,this._att3TF.visible=!1);var x=BaseBitmap.create("public_line1");x.x=this.width/2-x.width/2,x.y=this.height-15,this.addChild(x)},e.prototype.updBtnClick=function(){var t=Config.WifeCfg.getWifeCfgById(WifeSkillPopupView.wifeId),e=Config.ServantCfg.getServantItemById(t.servantId);if(!Api.servantVoApi.getServantObj(t.servantId))return void App.CommonUtil.showTip(LanguageManager.getlocal("wifeServantNotGet",[e.name]));if(this._wifeInfoVo.skill[this._itemIndex]>=Config.WifebaseCfg.wifeSkillMax)return void App.CommonUtil.showTip(LanguageManager.getlocal("wifeSkillMax"));var i=Config.WifebaseCfg["wifeSkill"+(this._itemIndex+1)][this._wifeInfoVo.skill[this._itemIndex]-1],a=this._wifeInfoVo.exp;return i>a?void App.CommonUtil.showTip(LanguageManager.getlocal("wifeExpNumNotEnough")):void App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_WIFE_SKILLUPD,{index:this._itemIndex})},e.prototype.refreshData=function(t){var e=WifeSkillPopupView.wifeId;this._wifeInfoVo=Api.wifeVoApi.getWifeInfoVoById(e);var i="(Lv."+this._wifeInfoVo.skill[this._itemIndex]+")";WifeSkillPopupView.wifeId=e;var a=Config.WifeCfg.getWifeCfgById(e),n=Config.ServantCfg.getServantItemById(a.servantId),o="",s="",r="",l="";if(4==this._cfgData.att.length)l=n.name+LanguageManager.getlocal("wifeSkillAllAttAdd");else{for(var h=0;h<this._cfgData.att.length;h++){var d=this._cfgData.att[h];l=0==h?LanguageManager.getlocal("servantInfo_speciality"+d):l+"、"+LanguageManager.getlocal("servantInfo_speciality"+d)}l=n.name+l+LanguageManager.getlocal("wifeSkillAttAdd")}var g=11645361,c=TextFieldConst.COLOR_WARN_GREEN,p="";if(this._cfgData.condition<=this._wifeInfoVo.intimacy){g=TextFieldConst.COLOR_WHITE;var _="",u="",C=t+1,f=1;this._wifeInfoVo.skill[t]>=Config.WifebaseCfg.wifeSkillMax&&(C=t,f=0),this._cfgData.growAtt<1?(_=100*this._cfgData.growAtt*this._wifeInfoVo.skill[t]+"%",u=100*this._cfgData.growAtt*(this._wifeInfoVo.skill[t]+f)+"%"):(_=(this._cfgData.growAtt*this._wifeInfoVo.skill[t]).toString(),u=(this._cfgData.growAtt*(this._wifeInfoVo.skill[t]+f)).toString()),p=_,o=LanguageManager.getlocal("wifeSkillCur")+l+_,s=LanguageManager.getlocal("wifeSkillNext")+l+u;var m=Config.WifebaseCfg["wifeSkill"+(this._itemIndex+1)][this._wifeInfoVo.skill[this._itemIndex]-1];r=LanguageManager.getlocal("wifeSkillUpdNeed",[m])}else{var _="";_=this._cfgData.growAtt<1?100*this._cfgData.growAtt*this._wifeInfoVo.skill[t]+"%":(this._cfgData.growAtt*this._wifeInfoVo.skill[t]).toString(),c=11645361,o=LanguageManager.getlocal("wifeSkillLock")+l+_,s="1",r=LanguageManager.getlocal("wifeSkillUnLockNeed")+this._cfgData.condition}if(this._att1TF.text=o,this._att2TF.text=s,this._att3TF.text=r,this._skillLevelTF.text=i,this._cfgData.condition>this._wifeInfoVo.intimacy&&(this._att2TF.visible=!1,this._updBtn.visible=!1,this._skillLevelTF.visible=!1),this._wifeInfoVo.skill[t]>=Config.WifebaseCfg.wifeSkillMax&&(this._att2TF.visible=!1,this._att3TF.visible=!1),this._wifeInfoVo.skill[t]>=Config.WifebaseCfg.wifeSkillMax){var T=ComponentManager.getTextField(LanguageManager.getlocal("wifeSkillMaxShow"),TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_WARN_RED);T.x=400,T.y=this.height/2-T.height/2-10,this.addChild(T),this._updBtn.visible=!1}},e.prototype.getBtnClickHandler=function(){},e.prototype.getSpaceY=function(){return 5},e.prototype.dispose=function(){this._itemIndex=null,this._key=null,this._wifeInfoVo=null,this._att1TF=null,this._att2TF=null,this._att3TF=null,this._skillLevelTF=null,this._updBtn=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(WifeSkillScrollItem.prototype,"WifeSkillScrollItem");var WifeskinScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=115+this.getSpaceX(),this.height=110;var i=BaseBitmap.create("tailor_iconBtn");i.name="bg2",this.addChild(i);var a="";if(e)a=e.icon;else{var n=Config.WifeCfg.getWifeCfgById(WifeskinView.wifeId);a=n.icon}var o=BaseLoadBitmap.create(a);o.setScale(.5);var s=new egret.Shape;s.graphics.beginFill(255),s.graphics.drawCircle(55,44,44),s.graphics.endFill(),this.addChild(s),o.mask=s,this.cacheAsBitmap=!0,this.addChild(o);var r=BaseBitmap.create("public_dot2");r.x=80,r.y=5,r.name="redsp",this.addChild(r),e?Api.wifeSkinVoApi.getSkinOneRed(WifeskinView.wifeId,e.id)||(r.visible=!1):r.visible=!1},e.prototype.getSpaceX=function(){return 10},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(WifeskinScrollItem.prototype,"WifeskinScrollItem");var WifeskinView=function(t){function e(){var e=t.call(this)||this;return e._txtList=[],e._inBB=null,e._noGetBB=null,e._textBg=null,e._titleBg=null,e._skinBg=null,e}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_CHILD_GUIDE,this.doGuide,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_AWARD),this.refreshInfoAfterLove,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_UPGRADESKILL),this.refreshInfoAfterLove,this),App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_WIFE,this.checkRedPoint,this);var t=this.param.data.id;e.wifeId=t,this._wifeInfoVo=Api.wifeVoApi.getWifeInfoVoById(t);var i=BaseBitmap.create("wifeview_optbg");i.y=-15,this.addChildToContainer(i),this._titleBg=BaseBitmap.create("wifeskin_descbg"),this._titleBg.y=-17,this.addChildToContainer(this._titleBg);var a=BaseBitmap.create("public_line3");a.width=400,a.setPosition(GameConfig.stageWidth/2-a.width/2,-5),this.addChildToContainer(a),this._skinName=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_TITLE_SMALL),this._skinName.setColor(11468882),this._skinName.x=GameConfig.stageWidth/2-this._skinName.width/2,this._skinName.y=-8,this.addChildToContainer(this._skinName),this._skinDesc=ComponentManager.getTextField(this._wifeInfoVo.desc,TextFieldConst.FONTSIZE_CONTENT_SMALL),this._skinDesc.setColor(TextFieldConst.COLOR_BROWN),this._skinDesc.x=10,this._skinDesc.y=18,this._skinDesc.width=GameConfig.stageWidth-2*this._skinDesc.x,this.addChildToContainer(this._skinDesc);var n=BaseBitmap.create("wifeview_namebg");n.x=25,n.y=200,this.addChildToContainer(n);var o=ComponentManager.getTextField(this._wifeInfoVo.name,TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_WHITE);o.width=27,o.x=n.x+n.width/2-o.width/2,o.y=n.y+95-o.height/2,this.addChildToContainer(o);var s=.55;this._skinPic=BaseLoadBitmap.create(this._wifeInfoVo.body),this._skinPic.x=130,this._skinPic.setScale(s),this.addChildToContainer(this._skinPic),this._skinBg=BaseBitmap.create("wifeskin_barbg"),this._skinBg.x=0,this._skinBg.y=GameConfig.stageHeigth-this.container.y-this._skinBg.height,this.addChildToContainer(this._skinBg);var r=BaseBitmap.create("public_9_bg22");r.height=241,r.x=0,r.y=GameConfig.stageHeigth-this.container.y-r.height,this.addChildToContainer(r);var l=BaseBitmap.create("public_9_managebg");l.width=594,l.height=138,l.x=GameConfig.stageWidth/2-l.width/2,l.y=r.y+44,this.addChildToContainer(l),this._skinBg.y=r.y-this._skinBg.height,this._skinBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"wifeskinViewTitle",this.skinHander,this,null,0),this._skinBtn.x=470,this._skinBtn.y=this._skinBg.y-60,this.addChildToContainer(this._skinBtn),this._inBB=BaseBitmap.create("wifeview_in"),this._inBB.x=490,this._inBB.y=this._skinBg.y-80,this.addChildToContainer(this._inBB),this._noGetBB=BaseBitmap.create("wifeview_noget"),this._noGetBB.x=470,this._noGetBB.y=this._skinBg.y-80,this.addChildToContainer(this._noGetBB),this._textBg=BaseBitmap.create("wifeview_skingetbg"),this._textBg.x=470,this._textBg.y=this._skinBg.y-32,this.addChildToContainer(this._textBg),this._getText=ComponentManager.getTextField(LanguageManager.getlocal("wifeskinGetDesc"),TextFieldConst.FONTSIZE_CONTENT_COMMON,TextFieldConst.COLOR_LIGHT_YELLOW),this._getText.x=GameConfig.stageWidth-this._getText.width-10,this._getText.y=this._skinBg.y-27,this.addChildToContainer(this._getText),this._textBg.width=this._getText.width+40,this._textBg.x=GameConfig.stageWidth-this._textBg.width,this._skinPic.y=58,this._skinPic.y+840*s<r.y+50&&(this._skinPic.y=r.y-50-840*s);var h=Api.wifeSkinVoApi.getWifeSkinListById(t);h.unshift(null);var d=egret.Rectangle.create();d.setTo(0,0,GameConfig.stageWidth-14,110),this._scrollList=ComponentManager.getScrollList(WifeskinScrollItem,h,d),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(7,this._skinBg.y+10),this._scrollList.addTouchTap(this.clickItemHandler,this);var g=BaseBitmap.create("public_line3");g.width=400,g.setPosition(GameConfig.stageWidth/2-g.width/2,r.y+23),this.addChildToContainer(g);var c=ComponentManager.getTextField(LanguageManager.getlocal("wifeskinAdd"),TextFieldConst.FONTSIZE_TITLE_SMALL);c.setColor(TextFieldConst.COLOR_BROWN),c.x=GameConfig.stageWidth/2-c.width/2,c.y=r.y+19,this.addChildToContainer(c);for(var p=r.y+50,_=0;9>_;_++){var u=0;_%2>0&&(u=300);var C=ComponentManager.getTextField("0",22,TextFieldConst.COLOR_BROWN);C.x=r.x+45+u,C.y=p,_%2>0&&(p=p+C.height+5),this.addChildToContainer(C),this._txtList.push(C)}this._noAddAtt=ComponentManager.getTextField(LanguageManager.getlocal("wifeskinNoAdd"),TextFieldConst.FONTSIZE_TITLE_BIG),this._noAddAtt.setColor(TextFieldConst.COLOR_BROWN),this._noAddAtt.x=GameConfig.stageWidth/2-this._noAddAtt.width/2,this._noAddAtt.y=r.y+100,this.addChildToContainer(this._noAddAtt);var f=ComponentManager.getTextField(LanguageManager.getlocal("wifeskinDesc"),22,TextFieldConst.COLOR_BROWN);f.setColor(11468882),f.x=GameConfig.stageWidth/2-f.width/2,f.y=r.y+r.height-50,this.addChildToContainer(f),this.checkRedPoint(),this.initState()},e.prototype.initState=function(){var t=Api.wifeSkinVoApi.getWifeskinInfoVoById(this.param.data.id);if(t){var e=Config.WifeskinCfg.getWifeCfgById(t.equip);if(e){var i=e.id;this.setData(i),this.setSelect(i)}else this.setData(null),this.setSelect(null)}else this.setData(null),this.setSelect(null)},e.prototype.clickItemHandler=function(t){var i=Number(t.data),a=Api.wifeSkinVoApi.getWifeSkinListById(e.wifeId);a.unshift(null);var n=a[i];if(n){var o=n.id;if(Api.wifeSkinVoApi.getSkinOneRed(e.wifeId,o)&&this.request(NetRequestConst.REQUEST_WIFE_READSKINRED,{wifeId:String(this.param.data.id),wifeSkinId:o}),this._skinId==o)return;this.setData(o),this.setSelect(o)}else{if(null==this._skinId)return;this.setData(null),this.setSelect(null)}},e.prototype.setSelect=function(t){this._skinId=t;var e;if(e=t?Api.wifeSkinVoApi.getWifeSkinIndexVoById(t)+1:0,this._childScrollItem&&this._childScrollItem.getChildByName("bg2")){var i=this._childScrollItem.getChildByName("bg2");i.texture=ResourceManager.getRes("tailor_iconBtn")}this._childScrollItem=this._scrollList.getItemByIndex(e);var a=this._childScrollItem.getChildByName("bg2");if(a.texture=ResourceManager.getRes("tailor_iconBtn_down"),this._childScrollItem.getChildByName("redsp")){var n=this._childScrollItem.getChildByName("redsp");n.visible=!1}},e.prototype.setData=function(t){if(t){var e=Config.WifeskinCfg.getWifeCfgById(t);this._skinDesc.text=e.desc,this._skinName.text=e.name,this._skinName.x=GameConfig.stageWidth/2-this._skinName.width/2,this._skinPic.setload(e.body);for(var i=this.dealAttrChangeInfo(t),a=0;a<this._txtList.length;a++){this._txtList[a].visible=!0;var n=i[a];n?this._txtList[a].text=i[a]:this._txtList[a].text=""}if(this._noAddAtt.visible=!1,this._droWifeIcon&&(this._droWifeIcon.dispose(),this._droWifeIcon=null),Api.wifeVoApi.isHaveBone(e.bone+"_ske")){var o=this.container.getChildIndex(this._skinPic);this._droWifeIcon=App.DragonBonesUtil.getLoadDragonBones(e.bone),this._droWifeIcon.setScale(.8),this._droWifeIcon.x=this._skinPic.x+190,this._droWifeIcon.y=this._titleBg.y+this._titleBg.height+480,this.container.addChildAt(this._droWifeIcon,o),this._skinPic.visible=!1,this._droWifeIcon.y}}else{this._skinDesc.text=this._wifeInfoVo.desc,this._skinName.text=this._wifeInfoVo.name,this._skinName.x=GameConfig.stageWidth/2-this._skinName.width/2,this._skinPic.setload(this._wifeInfoVo.body);for(var a=0;a<this._txtList.length;a++)this._txtList[a].visible=!1;if(this._noAddAtt.visible=!0,this._droWifeIcon&&(this._droWifeIcon.dispose(),this._droWifeIcon=null),Api.wifeVoApi.isHaveBone(this._wifeInfoVo.bone+"_ske")){var o=this.container.getChildIndex(this._skinPic);this._droWifeIcon=App.DragonBonesUtil.getLoadDragonBones(this._wifeInfoVo.bone),this._droWifeIcon.setScale(.8),this._droWifeIcon.x=this._skinPic.x+150,this._droWifeIcon.y=this._titleBg.y+this._titleBg.height+480,this.container.addChildAt(this._droWifeIcon,o),this._skinPic.visible=!1,this._droWifeIcon.y}}var s=Api.wifeSkinVoApi.getWifeskinInfoVoById(this.param.data.id),r=t;r||(r=""),s&&s.equip==r||!s&&""==r?(this._skinBtn.visible=!1,this._inBB.visible=!0,this._getText.visible=!1,this._textBg.visible=!1,this._noGetBB.visible=!1):""==r||Api.wifeSkinVoApi.isOwnSkinOfSkinId(r)?(this._skinBtn.visible=!0,this._inBB.visible=!1,this._getText.visible=!1,this._textBg.visible=!1,this._noGetBB.visible=!1):(this._skinBtn.visible=!1,this._inBB.visible=!1,this._getText.visible=!0,this._textBg.visible=!0,this._noGetBB.visible=!0,this._getText.text=LanguageManager.getlocal("skinDropDesc_"+r),this._getText.x=GameConfig.stageWidth-this._getText.width-10),this._droWifeIcon?(this._droWifeIcon.x=this._skinPic.x+150,this._droWifeIcon.y=this._skinPic.y+532-90):this._skinPic.visible=!0},e.prototype.checkDro=function(){this._droWifeIcon&&(this._droWifeIcon.dispose(),this._droWifeIcon=null);var t=this.container.getChildIndex(this._skinPic);if(Api.wifeSkinVoApi.isHaveSkin(this._wifeInfoVo.id)){var e=Api.wifeSkinVoApi.getWifeskinInfoVoById(this._wifeInfoVo.id);if(e&&""!=e.equip){var i=Config.WifeskinCfg.getWifeCfgById(e.equip);RES.hasRes(i.bone+"_ske")&&App.DeviceUtil.CheckWebglRenderMode()&&!Api.switchVoApi.checkCloseBone()&&(this._droWifeIcon=App.DragonBonesUtil.getLoadDragonBones(i.bone),this.container.addChildAt(this._droWifeIcon,t),this._skinPic.visible=!1)}else Api.wifeVoApi.isHaveBone(this._wifeInfoVo+"_ske")&&(this._droWifeIcon=App.DragonBonesUtil.getLoadDragonBones(this._wifeInfoVo.bone),this.container.addChildAt(this._droWifeIcon,t))}else Api.wifeVoApi.isHaveBone(this._wifeInfoVo+"_ske")&&(this._droWifeIcon=App.DragonBonesUtil.getLoadDragonBones(this._wifeInfoVo.bone),this.container.addChildAt(this._droWifeIcon,t),this._skinPic.visible=!1);this._droWifeIcon?(this._droWifeIcon.x=this._skinPic.x+230,this._droWifeIcon.y=this._skinPic.y+532+40):this._skinPic.visible=!0},e.prototype.dealAttrChangeInfo=function(t){var e=Config.WifeskinCfg.getWifeCfgById(t),i=[],a=e.atkAdd,n=e.inteAdd,o=e.politicsAdd,s=e.charmAdd,r=e.wifeIntimacy,l=e.wifeGlamour,h=e.childReduce,d=e.searchReduce,g=e.wifeReduce;return 1==a[0]?i.push(LanguageManager.getlocal("acTailAttrAdd1",[a[1]])):i.push(LanguageManager.getlocal("acTailAttrAdd1",[100*a[1]+"%"])),1==n[0]?i.push(LanguageManager.getlocal("acTailAttrAdd2",[n[1]])):i.push(LanguageManager.getlocal("acTailAttrAdd2",[100*n[1]+"%"])),1==o[0]?i.push(LanguageManager.getlocal("acTailAttrAdd3",[o[1]])):i.push(LanguageManager.getlocal("acTailAttrAdd3",[100*o[1]+"%"])),1==s[0]?i.push(LanguageManager.getlocal("acTailAttrAdd4",[s[1]])):i.push(LanguageManager.getlocal("acTailAttrAdd4",[100*s[1]+"%"])),r&&r>0&&i.push(LanguageManager.getlocal("acTailAttrAdd5",[r.toString()])),l&&l>0&&i.push(LanguageManager.getlocal("acTailAttrAdd6",[l.toString()])),h&&h>0&&i.push(LanguageManager.getlocal("acTailAttrAdd7",[h.toString()])),d&&d>0&&i.push(LanguageManager.getlocal("acTailAttrAdd8",[d.toString()])),g&&g>0&&i.push(LanguageManager.getlocal("acTailAttrAdd9",[g.toString()])),i},e.prototype.checkRedPoint=function(){},e.prototype.skinHander=function(){var t=this._skinId;t||(t=""),this.request(NetRequestConst.REQUEST_WIFE_EQUIP,{wifeId:String(this.param.data.id),wifeSkinId:t})},e.prototype.receiveData=function(t){t.data.ret<0||t.data.cmd==NetRequestConst.REQUEST_WIFE_EQUIP&&(this.initState(),this.hide())},e.prototype.refreshInfoAfterLove=function(){var t=this.param.data.id;this._wifeInfoVo=Api.wifeVoApi.getWifeInfoVoById(t);LanguageManager.getlocal("wifeIntimacy")+" "+this._wifeInfoVo.intimacy},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["wifeview_namebg","wifeview_optbg","wifeview_namebg","wifeview_bottombg2","wifeskin_descbg","wifeskin_barbg","wifeskin_bottombg","tailor_iconBtn","tailor_iconBtn_down","wifeview_in","wifeview_noget","wifeview_skingetbg"])},e.prototype.getRuleInfo=function(){return"wifeskin_description"},e.prototype.doGuide=function(){this.hide()},e.prototype.dispose=function(){t.prototype.dispose.call(this),App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_WIFE_LOVECOM),App.MessageHelper.removeEventListener(MessageConst.MESSAGE_CHILD_GUIDE,this.doGuide,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_AWARD),this.refreshInfoAfterLove,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_UPGRADESKILL),this.refreshInfoAfterLove,this),App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_WIFE,this.checkRedPoint,this),this._skinDesc=null,this._wifeInfoVo=null,this._skinPic=null,e.wifeId=null,this._childScrollItem=null,this._scrollList=null,this._txtList=[],this._skinId=null,this._inBB=null,this._getText=null,this._textBg=null,this._noGetBB=null,this._droWifeIcon=null,this._titleBg=null,this._skinBg=null},e}(CommonView);__reflect(WifeskinView.prototype,"WifeskinView");var WifeUnLockView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this._wifVoApi=Api.wifeVoApi;var t=this._wifVoApi.getUnlockWifeInfoVoList(),e=BaseBitmap.create("public_9_bg23");e.width=GameConfig.stageWidth,e.height=GameConfig.stageHeigth,e.x=0,e.y=-15,this.addChildToContainer(e);var i=egret.Rectangle.create();i.setTo(0,0,GameConfig.stageWidth-0,GameConfig.stageHeigth-this.container.y+20);var a=ComponentManager.getScrollList(WifeScrollItem2,t,i);a.setEmptyTip(LanguageManager.getlocal("wifeNoUnlockWife")),this.addChildToContainer(a),a.setPosition(0,-15)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(CommonView);__reflect(WifeUnLockView.prototype,"WifeUnLockView");var WifeView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addEventListener(MessageConst.MESSAGE_CHILD_GUIDE,this.doGuide,this),this.playEffect(SoundConst.EFFECT_WIFE,!0),Api.rookieVoApi.checkNextStep(),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_CALL),this.callWifeCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_RECOVERENERGY),this.recoverEnergyCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_AWARD),this.refreshItem,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_UPGRADESKILL),this.refreshItem,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_LOVE),this.refreshItem,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_EQUIP),this.refreshItem,this);var t=BaseBitmap.create("wife_listbg");t.y=-15,this.addChildToContainer(t);var e=BaseBitmap.create("arena_bottom");if(e.y=GameConfig.stageHeigth-this.container.y-e.height,this.addChildToContainer(e),this._wifVoApi=Api.wifeVoApi,this._wifeInfoVoList=this._wifVoApi.getWifeInfoVoList(),!(this._wifeInfoVoList.length<=0)){var i=egret.Rectangle.create();i.setTo(0,0,GameConfig.stageWidth-14,GameConfig.stageHeigth-170);var a=new Array;a.push(null),a=a.concat(this._wifeInfoVoList),a.push(null),this._scrollList=ComponentManager.getScrollList(WifeScrollItem1,a,i),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(7,-15);var n=ComponentManager.getTextField(LanguageManager.getlocal("vigorDesc")+":",TextFieldConst.FONTSIZE_CONTENT_SMALL);n.textColor=TextFieldConst.COLOR_WARN_YELLOW,n.x=20,n.y=this._scrollList.y+this._scrollList.height+37,this.addChildToContainer(n),this._vigorNumTF=ComponentManager.getTextField(this._wifVoApi.getEnergyNum()+"/"+this._wifVoApi.getEnergyMaxNum(),TextFieldConst.FONTSIZE_CONTENT_SMALL),this._vigorNumTF.textColor=TextFieldConst.COLOR_WARN_YELLOW,this._vigorNumTF.x=n.x+n.width+15,this._vigorNumTF.y=n.y,this.addChildToContainer(this._vigorNumTF);var o=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);o.textColor=TextFieldConst.COLOR_WARN_YELLOW,o.x=n.x+170,o.y=n.y,this.addChildToContainer(o);var s=GameConfig.config.wifebaseCfg.needVip;if(Api.playerVoApi.getPlayerVipLevel()>=s){o.text=LanguageManager.getlocal("wifeBatchTxt2");var r=ComponentManager.getCheckBox();r.x=o.x+o.width+5,r.y=o.y+o.height/2-r.height/2,this.addChildToContainer(r),this._checkBox=r,this._checkBox.addTouchTap(this.selectHandler,this)}else o.text=LanguageManager.getlocal("wifeBatchTxt",[s]);this._callBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"callBtn",this.clickCallBtn,this),this._callBtn.x=GameConfig.stageWidth-this._callBtn.width-60,this._callBtn.y=n.y-20,this.addChildToContainer(this._callBtn),this._callBtn.setColor(TextFieldConst.COLOR_BLACK),this._recoverBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"recoverVigor",this.clickCallBtn,this),this._recoverBtn.x=GameConfig.stageWidth-this._recoverBtn.width-60,this._recoverBtn.y=this._callBtn.y,this.addChildToContainer(this._recoverBtn),this._recoverBtn.setColor(TextFieldConst.COLOR_BLACK),this._recoverBtn.visible=!1,this.tick();var l=ComponentManager.getButton("wifelookbtn",null,this.unLockClick,this);l.x=15,l.y=0,l.setColor(TextFieldConst.COLOR_BLACK),this.addChildToContainer(l);var h=BaseBitmap.create("servant_mask");h.width=GameConfig.stageWidth,h.x=0,h.y=GameConfig.stageHeigth-this.container.y-e.height-140,this.addChildToContainer(h)}},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["wifeview_namebg","wifeview_charmicon","wifeview_vigoricon","wifeview_unlockmask","wife_listbg","arena_bottom","wifehalfbg","wifelookbtn_down","wifelookbtn","servant_mask","wifeview_itembg","wifeview_lockbg","wifeview_itembg2"])},e.prototype.unLockClick=function(){ViewController.getInstance().openView(ViewConst.COMMON.WIFEUNLOCKVIEW)},e.prototype.selectHandler=function(){this._checkBox.checkSelected()?this._callBtn.setText("wifeBatchTxt2"):this._callBtn.setText("callBtn")},e.prototype.clickCallBtn=function(t){if(!e.isMoveing)if(Api.rookieVoApi.checkNextStep(),this._wifVoApi.getEnergyNum()>0){var i=!1;this._checkBox&&this._checkBox.checkSelected()&&(i=!0),NetManager.request(NetRequestConst.REQUEST_WIFE_CALL,{autoFlag:i})}else{var a=Api.itemVoApi.getItemInfoVoById(Number(GameConfig.config.wifebaseCfg.needItem));if(a&&a.num>0){var n=LanguageManager.getlocal("useItemMsg",[a.name+"x1",LanguageManager.getlocal("vigorDesc")]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{confirmCallback:this.confirmCallbackHandler,handler:this,icon:a.icon,iconBg:a.iconBg,num:a.num,msg:n,id:Number(GameConfig.config.wifebaseCfg.needItem),useNum:1})}else App.CommonUtil.showTip(LanguageManager.getlocal("vigorNumNoEnoughMsg"))}},e.prototype.confirmCallbackHandler=function(){e.isMoveing||NetManager.request(NetRequestConst.REQUEST_WIFE_RECOVERENERGY,null)},e.prototype.callWifeCallback=function(t){var i=t.data.data.data;if(this._loveData=i,this.tick(),this._checkBox&&this._checkBox.checkSelected()){var a=i.autoCallWife;return void ViewController.getInstance().openView(ViewConst.BASE.WIFECALLBATCHSUCCESSVIEW,[a])}i.lucky&&TimerManager.doTimer(2e3,1,this.showLucky,this);var n=this._loveData.callWife[0];this._scrollList.addEventListener(egret.Event.COMPLETE,this.moveComplete,this),this.container.touchChildren=!1;var o=Api.wifeVoApi.getWifeIndexVoById(n);e.isMoveing=!0,this._scrollIndex=o+1,this._scrollList.setScrollTopByIndex(o+1,500);var s=this._scrollList.getItemByIndex(o+1);s.refreshData(n),i.rewards&&(this._rewardData=i.rewards)},e.prototype.refreshItem=function(t){1==t.data.ret&&t.data.data.data.lucky&&this.showLucky();var i=Api.wifeVoApi.getWifeIndexVoById(e.wifeId),a=this._scrollList.getItemByIndex(i+1);a.refreshData(e.wifeId)},e.prototype.moveComplete=function(t){this.container.touchChildren=!0,this._scrollList.removeEventListener(egret.Event.COMPLETE,this.moveComplete,this);var e=(this._scrollList.getItemByIndex(this._scrollIndex).x,this._scrollList.getItemByIndex(this._scrollIndex).y,this._scrollList.getItemByIndex(this._scrollIndex).localToGlobal(0,0)),i=Number(t.data),a=(this._wifeInfoVoList[i],this._loveData.callWife[0]),n=null;this._loveData.childArr.length>0&&(n=this._loveData.childArr[0]),ViewController.getInstance().openView(ViewConst.BASE.WIFELOVEANIVIEW,{id:a,type:1,x:e.x,y:e.y,childData:n,rewards:this._rewardData})},e.prototype.showLucky=function(){App.CommonUtil.showGodbless("wife")},e.prototype.recoverEnergyCallback=function(t){t.data.data.data;this.tick()},e.prototype.tick=function(){null!=this._vigorNumTF&&(this._wifVoApi.getEnergyNum()>0?(this._callBtn.visible=!0,this._recoverBtn.visible=!1,this._vigorNumTF.text=this._wifVoApi.getEnergyNum()+"/"+this._wifVoApi.getEnergyMaxNum()):(this._callBtn.visible=!1,this._recoverBtn.visible=!0,this._vigorNumTF.text=App.DateUtil.getFormatBySecond(this._wifVoApi.getRecoverEnergyTime(),1)))},e.prototype.doGuide=function(){this.hide()},e.prototype.getRuleInfo=function(){return"wife_description"},e.prototype.hide=function(){(!Api.rookieVoApi.isInGuiding||Api.rookieVoApi.isGuiding)&&(Api.rookieVoApi.isInGuiding&&Api.rookieVoApi.checkNextStep(),t.prototype.hide.call(this))},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_CHILD_GUIDE,this.doGuide,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_CALL),this.callWifeCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_RECOVERENERGY),this.recoverEnergyCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_AWARD),this.refreshItem,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_UPGRADESKILL),this.refreshItem,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_LOVE),this.refreshItem,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_EQUIP),this.refreshItem,this),this._scrollList&&(this._scrollList=null),this._wifeInfoVoList&&(this._wifeInfoVoList=null),this._vigorNumTF&&(this._vigorNumTF=null),this._wifVoApi&&(this._wifVoApi=null),this._loveData=null,e.wifeId=null,e.isMoveing=!1,this._rewardData=null,t.prototype.dispose.call(this)
},e.isMoveing=!1,e}(CommonView);__reflect(WifeView.prototype,"WifeView");var WifeViewTab1=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){if(App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_CALL),this.callWifeCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_RECOVERENERGY),this.recoverEnergyCallback,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_AWARD),this.refreshItem,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_UPGRADESKILL),this.refreshItem,this),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_LOVE),this.refreshItem,this),this._wifVoApi=Api.wifeVoApi,this._wifeInfoVoList=this._wifVoApi.getWifeInfoVoList(),!(this._wifeInfoVoList.length<=0)){var t=BaseBitmap.create("public_9_bg23");t.width=GameConfig.stageWidth-10,t.height=GameConfig.stageHeigth-230,t.x=5,t.y=0,this.addChild(t);var e=egret.Rectangle.create();e.setTo(0,0,GameConfig.stageWidth-14,GameConfig.stageHeigth-245),this._scrollList=ComponentManager.getScrollList(WifeScrollItem1,this._wifeInfoVoList,e),this.addChild(this._scrollList),this._scrollList.setPosition(7,7),this._scrollList.addTouchTap(this.clickItemHandler,this);var i=ComponentManager.getTextField(LanguageManager.getlocal("vigorDesc")+":",TextFieldConst.FONTSIZE_CONTENT_SMALL);i.x=20,i.y=this._scrollList.y+this._scrollList.height+37,this.addChild(i),this._vigorNumTF=ComponentManager.getTextField(this._wifVoApi.getEnergyNum()+"/"+this._wifVoApi.getEnergyMaxNum(),TextFieldConst.FONTSIZE_CONTENT_SMALL),this._vigorNumTF.x=i.x+i.width+15,this._vigorNumTF.y=i.y,this.addChild(this._vigorNumTF);var a=ComponentManager.getTextField("",TextFieldConst.FONTSIZE_CONTENT_SMALL);a.x=i.x+170,a.y=i.y,this.addChild(a);var n=GameConfig.config.wifebaseCfg.needVip;if(Api.playerVoApi.getPlayerVipLevel()>=n){a.text=LanguageManager.getlocal("wifeBatchTxt2");var o=ComponentManager.getCheckBox();o.x=a.x+a.width+5,o.y=a.y+a.height/2-o.height/2,this.addChild(o),this._checkBox=o,this._checkBox.addTouchTap(this.selectHandler,this)}else a.text=LanguageManager.getlocal("wifeBatchTxt",[n]);this._callBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"callBtn",this.clickCallBtn,this),this._callBtn.x=GameConfig.stageWidth-this._callBtn.width-60,this._callBtn.y=i.y-14,this.addChild(this._callBtn),this._callBtn.setColor(TextFieldConst.COLOR_BLACK),this._recoverBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_RED,"recoverVigor",this.clickCallBtn,this),this._recoverBtn.x=GameConfig.stageWidth-this._recoverBtn.width-60,this._recoverBtn.y=this._callBtn.y,this.addChild(this._recoverBtn),this._recoverBtn.setColor(TextFieldConst.COLOR_BLACK),this._recoverBtn.visible=!1,this.tick()}},e.prototype.selectHandler=function(){this._checkBox.checkSelected()?this._callBtn.setText("wifeBatchTxt2"):this._callBtn.setText("callBtn")},e.prototype.clickCallBtn=function(t){if(Api.rookieVoApi.checkNextStep(),this._wifVoApi.getEnergyNum()>0){var e=!1;this._checkBox&&this._checkBox.checkSelected()&&(e=!0),NetManager.request(NetRequestConst.REQUEST_WIFE_CALL,{autoFlag:e})}else{var i=Api.itemVoApi.getItemInfoVoById(Number(GameConfig.config.wifebaseCfg.needItem));if(i&&i.num>0){var a=LanguageManager.getlocal("useItemMsg",[i.name+"x1",LanguageManager.getlocal("vigorDesc")]);ViewController.getInstance().openView(ViewConst.POPUP.ITEMUSECONSTPOPUPVIEW,{confirmCallback:this.confirmCallbackHandler,handler:this,icon:i.icon,iconBg:i.iconBg,num:i.num,msg:a,id:Number(GameConfig.config.wifebaseCfg.needItem),useNum:1})}else App.CommonUtil.showTip(LanguageManager.getlocal("vigorNumNoEnoughMsg"))}},e.prototype.confirmCallbackHandler=function(){NetManager.request(NetRequestConst.REQUEST_WIFE_RECOVERENERGY,null)},e.prototype.clickItemHandler=function(t){var e=Number(t.data),i=this._wifeInfoVoList[e],a=i.id;ViewController.getInstance().openView(ViewConst.COMMON.WIFEOPTVIEW,{id:a,handler:this}),SoundManager.stopEffect(SoundConst.EFFECT_WIFE),this._selectWifeId=a},e.prototype.callWifeCallback=function(t){var e=t.data.data.data;if(this._loveData=e,this.tick(),this._checkBox&&this._checkBox.checkSelected()){var i=e.autoCallWife;return void ViewController.getInstance().openView(ViewConst.BASE.WIFECALLBATCHSUCCESSVIEW,[i])}e.lucky&&TimerManager.doTimer(2e3,1,this.showLucky,this);var a=this._loveData.callWife[0];this._scrollList.addEventListener(egret.Event.COMPLETE,this.moveComplete,this),this.touchChildren=!1;var n=Api.wifeVoApi.getWifeIndexVoById(a);this._scrollIndex=n,this._scrollList.setScrollTopByIndex(n,500);var o=this._scrollList.getItemByIndex(n);o.refreshData(a),e.rewards&&(this._rewardData=e.rewards)},e.prototype.refreshItem=function(t){1==t.data.ret&&t.data.data.data.lucky&&this.showLucky();var e=Api.wifeVoApi.getWifeIndexVoById(this._selectWifeId),i=this._scrollList.getItemByIndex(e);i.refreshData(this._selectWifeId)},e.prototype.moveComplete=function(t){this.touchChildren=!0,this._scrollList.removeEventListener(egret.Event.COMPLETE,this.moveComplete,this);var e=(this._scrollList.getItemByIndex(this._scrollIndex).x,this._scrollList.getItemByIndex(this._scrollIndex).y,this._scrollList.getItemByIndex(this._scrollIndex).localToGlobal(0,0)),i=Number(t.data),a=(this._wifeInfoVoList[i],this._loveData.callWife[0]),n=null;this._loveData.childArr.length>0&&(n=this._loveData.childArr[0]),ViewController.getInstance().openView(ViewConst.BASE.WIFELOVEANIVIEW,{id:a,type:1,x:e.x,y:e.y,childData:n,rewards:this._rewardData})},e.prototype.showLucky=function(){App.CommonUtil.showGodbless("wife")},e.prototype.recoverEnergyCallback=function(t){t.data.data.data;this.tick()},e.prototype.tick=function(){null!=this._vigorNumTF&&(this._wifVoApi.getEnergyNum()>0?(this._callBtn.visible=!0,this._recoverBtn.visible=!1,this._vigorNumTF.text=this._wifVoApi.getEnergyNum()+"/"+this._wifVoApi.getEnergyMaxNum()):(this._callBtn.visible=!1,this._recoverBtn.visible=!0,this._vigorNumTF.text=App.DateUtil.getFormatBySecond(this._wifVoApi.getRecoverEnergyTime(),1)))},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_CALL),this.callWifeCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_RECOVERENERGY),this.recoverEnergyCallback,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_AWARD),this.refreshItem,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_UPGRADESKILL),this.refreshItem,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFE_LOVE),this.refreshItem,this),this._scrollList&&(this._scrollList=null),this._wifeInfoVoList&&(this._wifeInfoVoList=null),this._vigorNumTF&&(this._vigorNumTF=null),this._wifVoApi&&(this._wifVoApi=null),this._loveData=null,this._selectWifeId=null,this._rewardData=null,t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(WifeViewTab1.prototype,"WifeViewTab1");var WifeViewTab2=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this._wifVoApi=Api.wifeVoApi;var t=this._wifVoApi.getUnlockWifeInfoVoList(),e=BaseBitmap.create("public_9_bg23");e.width=GameConfig.stageWidth-10,e.height=GameConfig.stageHeigth-170,e.x=5,e.y=0,this.addChild(e);var i=egret.Rectangle.create();i.setTo(0,0,GameConfig.stageWidth-14,GameConfig.stageHeigth-185);var a=ComponentManager.getScrollList(WifeScrollItem2,t,i);a.setEmptyTip(LanguageManager.getlocal("wifeNoUnlockWife")),this.addChild(a),a.setPosition(7,7)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(CommonViewTab);__reflect(WifeViewTab2.prototype,"WifeViewTab2");var WifestatusPopupScrollItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=520,this.height=57+this.getSpaceY();var i=e.id,a=Api.wifestatusVoApi.getWifestatusVo(),n=Api.wifeVoApi.getWifeInfoVoById(WifestatusPopupView.wifeId),o="childview_bg1";Number(i)>=Number(a.level)&&"2"!=i&&(o="childview_bg2"),(n.intimacy<e.needIntimacy||n.glamour<e.needGlamour)&&(o="childview_bg2"),WifestatusPopupView.wifeLevel==e.id&&(o="childview_bg3");var s=BaseBitmap.create(o);if(s.width=this.width,s.height=57,this.addChild(s),Number(i)>=Number(a.level)&&"2"!=i){var r=BaseBitmap.create("wifestatus_lock");r.x=450,r.y=this.height/2-r.height/2,this.addChild(r)}if(WifestatusPopupView.wifeLevel==e.id){var l=ComponentManager.getTextField(LanguageManager.getlocal("wifeStatusCurStatus"),TextFieldConst.FONTSIZE_CONTENT_SMALL);l.textColor=TextFieldConst.COLOR_BROWN,l.x=s.width-l.width-15,l.y=this.height/2-l.height/2,this.addChild(l)}var h=LanguageManager.getlocal("wifestatusTitle"+e.id)+"("+Api.wifestatusVoApi.getWifesNumByLevel(e.id)+"/"+e.maxNum+")";"1"==e.id&&(h=LanguageManager.getlocal("wifestatusTitle"+e.id)+"("+Api.wifestatusVoApi.getNoStatusWife().length+")");var d=ComponentManager.getTextField(h,TextFieldConst.FONTSIZE_CONTENT_COMMON);d.textColor=TextFieldConst.COLOR_BLACK,d.x=this.width/2-d.width/2,d.y=this.height/2-d.height/2,this.addChild(d)},e.prototype.refreshData=function(t){},e.prototype.getBtnClickHandler=function(){App.MessageHelper.dispatchEvent(MessageConst.MESSAGE_NOTICE_ACH_GETDETAILREWARD,{achIndex:this._achIndex})},e.prototype.getSpaceY=function(){return 3},e.prototype.dispose=function(){this._achIndex=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(WifestatusPopupScrollItem.prototype,"WifestatusPopupScrollItem");var WifestatusPopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){e.wifeId=this.param.data.wifeId,e.wifeLevel=this.param.data.level;var t=egret.Rectangle.create();t.setTo(0,0,522,700);var i=Config.WifestatusCfg.getWifestatusList();this._scrollList=ComponentManager.getScrollList(WifestatusPopupScrollItem,i,t),this.addChildToContainer(this._scrollList),this._scrollList.x=25,this._scrollList.y=20,this._scrollList.addTouchTap(this.clickItemHandler,this)},e.prototype.clickItemHandler=function(t){var i=Number(t.data),a=Config.WifestatusCfg.getWifestatusList()[i],n=Api.wifestatusVoApi.getWifestatusVo(),o=Api.wifeVoApi.getWifeInfoVoById(e.wifeId);return Number(a.id)>=Number(n.level)&&"2"!=a.id?void App.CommonUtil.showTip(LanguageManager.getlocal("wifeStatusError2")):o.intimacy<a.needIntimacy||o.glamour<a.needGlamour?void App.CommonUtil.showTip(LanguageManager.getlocal("wifeStatusLessPro")):void(e.wifeLevel!=a.id&&(this.request(NetRequestConst.REQUEST_WIFESTATUS_CONFER,{wifeId:String(this.param.data.wifeId),position:a.id}),WifestatusView.wifeLevel=a.id))},e.prototype.receiveData=function(t){this.hide()},e.prototype.getTitleStr=function(){return"wifestatusViewTitle"},e.prototype.doGetReward=function(t){this._achIndex=t.data.achIndex,this.request(NetRequestConst.REQUEST_ACHIEVEMENT_GETREWARDS,{aid:AchievementDetailPopupView.itemId})},e.prototype.dispose=function(){this._scrollList=null,this._achIndex=null,this._oldList=null,e.wifeId=null,e.wifeLevel=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(WifestatusPopupView.prototype,"WifestatusPopupView");var WifestatusScrollItem=function(t){function e(){var e=t.call(this)||this;return e.itemListType=!1,e.touchNum=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){this.width=616;var i=Api.wifestatusVoApi.getWifestatusVo();this._data=e;var a=e.id,n="wifestatus_itembg2";(Number(a)<Number(i.level)||"2"==a)&&(n="wifestatus_itembg"),this._bgBB=BaseBitmap.create(n),this._bgBB.height=162,this.addChild(this._bgBB);var o=BaseBitmap.create("wifestatus_title"+a);o.x=this._bgBB.width/2-o.width/2,o.y=this._bgBB.y-2,this.addChild(o),Number(a)<Number(i.level)||"2"==a?this.showIcons(t,e):(this.showUnlock(t,e),App.DisplayUtil.changeToGray(o));var s=BaseBitmap.create("public_line3");s.width=this.width-150,s.x=this.width/2-s.width/2,s.y=60,this.addChild(s);var r=LanguageManager.getlocal("wifeStatusCurWifeNum")+Api.wifestatusVoApi.getWifesNumByLevel(e.id)+"/"+e.maxNum;"1"==e.id&&(r=LanguageManager.getlocal("wifeStatusCurWifeNum")+Api.wifestatusVoApi.getNoStatusWife().length);var l=ComponentManager.getTextField(r,TextFieldConst.FONTSIZE_CONTENT_COMMON);if(l.textColor=TextFieldConst.COLOR_BLACK,l.x=this.width/2-l.width/2,l.y=60,this.addChild(l),"1"==e.id){var h=ComponentManager.getTextField(LanguageManager.getlocal("wifeStatusReward")+": "+LanguageManager.getlocal("nothing"),TextFieldConst.FONTSIZE_CONTENT_COMMON);h.textColor=TextFieldConst.COLOR_BLACK,h.x=this.width/2-h.width/2,h.y=this.height-37,this.addChild(h)}else{var d=ComponentManager.getTextField(LanguageManager.getlocal("wifeStatusNeed"),TextFieldConst.FONTSIZE_CONTENT_SMALL);d.textColor=TextFieldConst.COLOR_BLACK,d.x=18,d.y=this.height-37,this.addChild(d);var g=BaseBitmap.create("wifeview_vigoricon");g.x=d.x+d.width+5,g.y=d.y-3,g.setScale(.67),this.addChild(g);var c=ComponentManager.getTextField(e.needIntimacy,TextFieldConst.FONTSIZE_CONTENT_COMMON);c.textColor=TextFieldConst.COLOR_BLACK,c.x=g.x+.67*g.width+5,c.y=d.y,this.addChild(c);var p=BaseBitmap.create("wifeview_charmicon");p.x=c.x+c.width+5,p.y=g.y,p.setScale(.67),this.addChild(p);var _=ComponentManager.getTextField(e.needGlamour,TextFieldConst.FONTSIZE_CONTENT_COMMON);_.textColor=TextFieldConst.COLOR_BLACK,_.x=p.x+.67*p.width+5,_.y=d.y,this.addChild(_);var h=ComponentManager.getTextField(LanguageManager.getlocal("wifeStatusReward"),TextFieldConst.FONTSIZE_CONTENT_COMMON);h.textColor=TextFieldConst.COLOR_BLACK,h.x=this.width-h.width-80,h.y=d.y,this.addChild(h);var u=BaseBitmap.create("wifestatus_icon");u.x=h.x+h.width+5,u.setScale(.67),u.y=h.y-3,this.addChild(u);var C=ComponentManager.getTextField(e.getStar,TextFieldConst.FONTSIZE_CONTENT_COMMON);C.textColor=TextFieldConst.COLOR_BLACK,C.x=u.x+.67*u.width+5,C.y=d.y,this.addChild(C)}},e.prototype.showUnlock=function(t,e){var i=new BaseDisplayObjectContainer;this._bgBB.height=180;var a=ComponentManager.getTextField(LanguageManager.getlocal("wifeStatusUnlock1"),TextFieldConst.FONTSIZE_TITLE_SMALL);a.textColor=TextFieldConst.COLOR_WARN_RED2,a.x=0,i.addChild(a);var n=BaseBitmap.create("wifestatus_icon");n.x=a.x+a.width+3,n.y=0,i.addChild(n),a.y=i.height/2-a.height/2;var o=ComponentManager.getTextField(LanguageManager.getlocal("wifeStatusUnlock2",[e.needStar]),TextFieldConst.FONTSIZE_TITLE_SMALL);o.textColor=TextFieldConst.COLOR_WARN_RED2,o.x=n.x+n.width+3,o.y=a.y,i.addChild(o),this.addChild(i),i.x=this.width/2-i.width/2,i.y=90},e.prototype.showIcons=function(t,e){for(var i=new BaseDisplayObjectContainer,t=(Api.wifestatusVoApi.getWifestatusVo(),0);t<Api.wifestatusVoApi.getWifesNumByLevel(e.id);t++){var a=Api.wifestatusVoApi.getWifestatusVo().info[e.id][t],n=this.getWifestatusIcon(e,a);n.x=(n.width+20)*t;var o=t%4;n.x=10*(o+1)+n.width*o-10,n.y=(n.height+5)*Math.floor(t/4),i.addChild(n)}if("1"==e.id)for(var t=0;t<Api.wifestatusVoApi.getNoStatusWife().length;t++){var s=Api.wifestatusVoApi.getNoStatusWife()[t],n=this.getWifestatusIcon(e,s);n.x=(n.width+20)*t;var o=t%4;n.x=10*(o+1)+n.width*o-10,n.y=(n.height+5)*Math.floor(t/4),i.addChild(n)}this.addChild(i),i.x=this.width/2-i.width/2,i.y=90;var r=Api.wifestatusVoApi.getWifesNumByLevel(e.id),l=140*Math.ceil(r/4);if("1"==e.id){var h=Api.wifestatusVoApi.getNoStatusWife().length;l=140*Math.ceil(h/4)}l||(l=0),this._bgBB.height=135+l},e.prototype.getWifestatusIcon=function(t,e){var i=new BaseDisplayObjectContainer,a=BaseBitmap.create("wifestatus_headbg");a.name="bg2",i.addChild(a);var n=Api.wifeVoApi.getWifeIcon(e),o=BaseLoadBitmap.create(n);o.setPosition(0,5);var s=BaseBitmap.create("wifestatus_headmask");s.setPosition(5,5),i.addChild(s),o.mask=s,o.setScale(.6),i.cacheAsBitmap=!0,i.addChild(o),i.addTouchTap(this.clickItemHandler,this,[e]);var r=BaseBitmap.create("wifestatus_namebg");r.setPosition(i.width/2-r.width/2,105),i.addChild(r);var l=Config.WifeCfg.getWifeCfgById(e),h=ComponentManager.getTextField(l.name,TextFieldConst.FONTSIZE_CONTENT_SMALL);return h.x=r.x+r.width/2-h.width/2,h.y=r.y+r.height/2-h.height/2,i.addChild(h),i},e.prototype.clickItemHandler=function(t,e){ViewController.getInstance().openView(ViewConst.POPUP.WIFESTATUSWIFEPOPUPVIEW,{wifeId:e,level:this._data.id})},e.prototype.refreshData=function(t){},e.prototype.getSpaceY=function(){return 0},e.prototype.dispose=function(){this._achProTF=null,this._getBtn=null,this._stateIcon=null,this._data=null,t.prototype.dispose.call(this)},e}(ScrollListItem);__reflect(WifestatusScrollItem.prototype,"WifestatusScrollItem");var WifestatusView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this.playEffect(SoundConst.EFFECT_WIFE,!0),Api.rookieVoApi.checkNextStep(),App.MessageHelper.addEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFESTATUS_CONFER),this.callWifeCallback,this);var t=Api.wifestatusVoApi.getWifestatusVo(),e=BaseBitmap.create("public_9_bg23");e.width=GameConfig.stageWidth-10,e.height=GameConfig.stageHeigth-186,e.x=5,e.y=-7,this.addChildToContainer(e);var i=new BaseDisplayObjectContainer,a=ComponentManager.getTextField(LanguageManager.getlocal("wifeStatusAdd1"),TextFieldConst.FONTSIZE_CONTENT_COMMON);a.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,i.addChild(a);var n=BaseBitmap.create("wifestatus_icon");n.x=a.x+a.width+10,n.setScale(.7),i.addChild(n);var o=Config.WifestatusbaseCfg.starEffect,s=ComponentManager.getTextField(LanguageManager.getlocal("wifeStatusAdd2",[String(o)]),TextFieldConst.FONTSIZE_CONTENT_COMMON);s.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,s.x=n.x+.7*n.width+10,a.y=3,s.y=a.y,i.addChild(s),i.x=this.container.width/2-i.width/2,i.y=e.y+e.height-35,this.addChildToContainer(i);var r=BaseBitmap.create("arena_bottom");r.y=GameConfig.stageHeigth-this.container.y-r.height,this.addChildToContainer(r);var l=ComponentManager.getTextField(LanguageManager.getlocal("wifeStatusScoreTitle"),TextFieldConst.FONTSIZE_CONTENT_COMMON);l.textColor=TextFieldConst.COLOR_LIGHT_YELLOW,l.x=20,l.y=r.y+15,this.addChildToContainer(l);var h=BaseBitmap.create("wifestatus_icon");h.x=l.x+l.width+10,h.setScale(.7),h.y=l.y-3,this.addChildToContainer(h),this._scoreTF=ComponentManager.getTextField(t.star+"",TextFieldConst.FONTSIZE_CONTENT_COMMON),this._scoreTF.x=h.x+.7*h.width+10,this._scoreTF.y=l.y,this.addChildToContainer(this._scoreTF);var d=egret.Rectangle.create();d.setTo(0,0,GameConfig.stageWidth-14,GameConfig.stageHeigth-219-20);var g=Config.WifestatusCfg.getWifestatusList();this._scrollList=ComponentManager.getScrollList(WifestatusScrollItem,g,d),this.addChildToContainer(this._scrollList),this._scrollList.setPosition(e.x+3,e.y+10),g.length>0&&this._scrollList.setScrollTopByIndex(g.length-1);var c=LanguageManager.getlocal("wifeStatusProAdd",[String(t.star*o)]);this._addTF=ComponentManager.getTextField(c,TextFieldConst.FONTSIZE_CONTENT_SMALL),this._addTF.textColor=TextFieldConst.COLOR_WARN_YELLOW,this._addTF.x=20,this._addTF.y=this._scoreTF.y+this._scoreTF.height+10,this.addChildToContainer(this._addTF),this._callBtn=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"wifeStatusAll",this.clickCallBtn,this),this._callBtn.x=GameConfig.stageWidth-this._callBtn.width-37,this._callBtn.y=this._addTF.y-20,this.addChildToContainer(this._callBtn),this._callBtn.setColor(TextFieldConst.COLOR_BLACK)},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["wifestatus_child_bg","servant_topresbg","wifestatus_headbg","wifestatus_headmask","wifestatus_headnull","wifestatus_icon","wifestatus_itembg","wifestatus_itembg2","wifestatus_lock","wifestatus_namebg","wifestatus_smallbg","wifestatus_title1","wifestatus_title2","wifestatus_title3","wifestatus_title4","wifestatus_title5","wifestatus_title6","wifestatus_title7","wifestatus_title8","wifestatus_title9","wifestatus_title10","wifestatus_title11","wifeview_namebg","childview_bg1","childview_bg2","childview_bg3","wifeview_charmicon","wifeview_vigoricon","progress3","progress3_bg","arena_bottom"])},e.prototype.unLockClick=function(){ViewController.getInstance().openView(ViewConst.COMMON.WIFEUNLOCKVIEW)},e.prototype.clickCallBtn=function(t){this.request(NetRequestConst.REQUEST_WIFESTATUS_AUTOCONFER,{})},e.prototype.receiveData=function(t){var i=Config.WifestatusCfg.getWifestatusList();this._scrollList.refreshData(i);var a=Api.wifestatusVoApi.getWifeIndexVoById(e.wifeLevel);this._scrollList.setScrollTopByIndex(a);var n=Api.wifestatusVoApi.getWifestatusVo(),o=Config.WifestatusbaseCfg.starEffect,s=LanguageManager.getlocal("wifeStatusProAdd",[String(n.star*o)]);this._addTF.text=s,this._scoreTF.text=n.star+""},e.prototype.confirmCallbackHandler=function(){WifeView.isMoveing||NetManager.request(NetRequestConst.REQUEST_WIFE_RECOVERENERGY,null)},e.prototype.callWifeCallback=function(t){var i=Config.WifestatusCfg.getWifestatusList();this._scrollList.refreshData(i);var a=Api.wifestatusVoApi.getWifeIndexVoById(e.wifeLevel);this._scrollList.setScrollTopByIndex(a);var n=Api.wifestatusVoApi.getWifestatusVo(),o=Config.WifestatusbaseCfg.starEffect,s=LanguageManager.getlocal("wifeStatusProAdd",[String(n.star*o)]);this._addTF.text=s,this._scoreTF.text=n.star+""},e.prototype.refreshItem=function(t){1==t.data.ret&&t.data.data.data.lucky&&this.showLucky();var e=Api.wifeVoApi.getWifeIndexVoById(WifeView.wifeId),i=this._scrollList.getItemByIndex(e+1);i.refreshData(WifeView.wifeId)},e.prototype.moveComplete=function(t){},e.prototype.showLucky=function(){App.CommonUtil.showGodbless("wife")},e.prototype.doGuide=function(){this.hide()},e.prototype.dispose=function(){App.MessageHelper.removeEventListener(MessageConst.MESSAGE_CHILD_GUIDE,this.doGuide,this),App.MessageHelper.removeEventListener(NetManager.getMessageName(NetRequestConst.REQUEST_WIFESTATUS_CONFER),this.callWifeCallback,this),this._scrollList&&(this._scrollList=null),this._loveData=null,WifeView.wifeId=null,WifeView.isMoveing=!1,this._rewardData=null,this._addTF=null,this._scoreTF=null,t.prototype.dispose.call(this)},e.currNum=0,e.isMoveing=!1,e}(CommonView);__reflect(WifestatusView.prototype,"WifestatusView");var WifestatusWifePopupView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){App.MessageHelper.addNetMessage(MessageConst.MESSAGE_MODEL_WIFE,this.setData,this);var t=BaseBitmap.create("wifestatus_smallbg");t.x=20,t.y=10,this.addChildToContainer(t);var e=this.param.data.wifeId;WifestatusView.wifeId=e,this._wifeInfoVo=Api.wifeVoApi.getWifeInfoVoById(e);var i=this._wifeInfoVo.body;if(Api.wifeSkinVoApi.isHaveSkin(this._wifeInfoVo.id)){var a=Api.wifeSkinVoApi.getWifeskinInfoVoById(this._wifeInfoVo.id);if(a&&""!=a.equip){var n=Config.WifeskinCfg.getWifeCfgById(a.equip);i=n.body,Api.wifeVoApi.isHaveBone(n.bone+"_ske")&&(this._droWifeIcon=App.DragonBonesUtil.getLoadDragonBones(n.bone),this.addChildToContainer(this._droWifeIcon))}else Api.wifeVoApi.isHaveBone(this._wifeInfoVo.bone+"_ske")&&(this._droWifeIcon=App.DragonBonesUtil.getLoadDragonBones(this._wifeInfoVo.bone),this.addChildToContainer(this._droWifeIcon))}else Api.wifeVoApi.isHaveBone(this._wifeInfoVo.bone+"_ske")&&(this._droWifeIcon=App.DragonBonesUtil.getLoadDragonBones(this._wifeInfoVo.bone),this.addChildToContainer(this._droWifeIcon));var o=.6;if(this._wifeIcon=BaseLoadBitmap.create(i),this._wifeIcon.x=100,this._wifeIcon.setScale(o),this.addChildToContainer(this._wifeIcon),this._wifeIcon.y=12,this._droWifeIcon){var s=new BaseShape;s.graphics.beginFill(0),s.graphics.drawRect(t.x,t.y,t.width,t.height),s.graphics.endFill(),this.addChildToContainer(s),this._wifeIcon.visible=!1,this._droWifeIcon.mask=s}this._droWifeIcon&&(this._droWifeIcon.setScale(.9),this._droWifeIcon.x=this._wifeIcon.x+200,this._droWifeIcon.y=this._wifeIcon.y+504+30);var r=BaseBitmap.create("wifeview_namebg");r.x=65,r.y=100,r.setScale(.79),this.addChildToContainer(r);var l=ComponentManager.getTextField(this._wifeInfoVo.name,TextFieldConst.FONTSIZE_TITLE_COMMON,TextFieldConst.COLOR_WHITE);l.width=27,l.x=r.x+.79*r.width/2-l.width/2,l.y=r.y+75.05-l.height/2,this.addChildToContainer(l);var h=BaseBitmap.create("wifeview_vigoricon");h.x=30,h.y=t.y+t.height+5,this.addChildToContainer(h),this._progressBar1=ComponentManager.getProgressBar("progress3","progress3_bg",460),this._progressBar1.x=h.x+h.width+10,this._progressBar1.y=h.y+7,this.addChildToContainer(this._progressBar1);var d=Config.WifestatusCfg.getWifestatusCfgByID(String(Number(this.param.data.level)+1));d||(d=Config.WifestatusCfg.getWifestatusCfgByID(this.param.data.level));var g=this._wifeInfoVo.intimacy+"/"+d.needIntimacy;this._progressBar1.setPercentage(this._wifeInfoVo.intimacy/d.needIntimacy),this._levelTxt1=ComponentManager.getTextField(g,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this._levelTxt1.x=this._progressBar1.x+this._progressBar1.width/2-this._levelTxt1.width/2,this._levelTxt1.y=this._progressBar1.y+this._progressBar1.height/2-this._levelTxt1.height/2,this.addChildToContainer(this._levelTxt1);var c=BaseBitmap.create("wifeview_charmicon");c.x=h.x,c.y=h.y+h.height+3,this.addChildToContainer(c),this._progressBar2=ComponentManager.getProgressBar("progress3","progress3_bg",460),this._progressBar2.x=h.x+h.width+10,this._progressBar2.y=c.y+7,this.addChildToContainer(this._progressBar2);var p=this._wifeInfoVo.glamour+"/"+d.needGlamour;this._progressBar2.setPercentage(this._wifeInfoVo.glamour/d.needGlamour),this._levelTxt2=ComponentManager.getTextField(p,TextFieldConst.FONTSIZE_CONTENT_SMALL,TextFieldConst.COLOR_WHITE),this._levelTxt2.x=this._progressBar2.x+this._progressBar2.width/2-this._levelTxt2.width/2,this._levelTxt2.y=this._progressBar2.y+this._progressBar2.height/2-this._levelTxt2.height/2,this.addChildToContainer(this._levelTxt2);var _=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"childUpd",this.clickAddBtn,this);_.x=60,_.y=c.y+c.height+10,this.addChildToContainer(_),_.setColor(TextFieldConst.COLOR_BLACK);var u=ComponentManager.getButton(ButtonConst.BTN_NORMAL_YELLOW,"wifestatusViewTitle",this.statusBtn,this);u.x=360,u.y=_.y,this.addChildToContainer(u),u.setColor(TextFieldConst.COLOR_BLACK)},e.prototype.setData=function(){var t=Config.WifestatusCfg.getWifestatusCfgByID(String(Number(this.param.data.level)+1));t||(t=Config.WifestatusCfg.getWifestatusCfgByID(this.param.data.level));var e=this.param.data.wifeId;this._wifeInfoVo=Api.wifeVoApi.getWifeInfoVoById(e);var i=this._wifeInfoVo.intimacy+"/"+t.needIntimacy;this._progressBar1.setPercentage(this._wifeInfoVo.intimacy/t.needIntimacy);var a=this._wifeInfoVo.glamour+"/"+t.needGlamour;this._progressBar2.setPercentage(this._wifeInfoVo.glamour/t.needGlamour),this._levelTxt1.text=i,this._levelTxt2.text=a},e.prototype.clickAddBtn=function(){ViewController.getInstance().openView(ViewConst.COMMON.WIFEOPTVIEW,{id:this.param.data.wifeId})},e.prototype.statusBtn=function(){var t=Config.WifestatusCfg.getWifestatusCfgByID(String(Number(this.param.data.level)+1));t||(t=Config.WifestatusCfg.getWifestatusCfgByID(this.param.data.level)),ViewController.getInstance().openView(ViewConst.POPUP.WIFESTATUSPOPUPVIEW,{wifeId:this.param.data.wifeId,level:this.param.data.level}),this.hide()},e.prototype.checkDro2=function(){this._droWifeIcon?this._droWifeIcon.resume():this._wifeIcon.visible=!0},e.prototype.clickItemHandler=function(t){var e=Number(t.data),i=Config.WifestatusCfg.getWifestatusList()[e];this.request(NetRequestConst.REQUEST_WIFESTATUS_CONFER,{wifeId:String(this.param.data.wifeId),position:i.id})},e.prototype.receiveData=function(t){this.hide()},e.prototype.getTitleStr=function(){return"wifestatusTitle"+this.param.data.level},e.prototype.doGetReward=function(t){this._achIndex=t.data.achIndex,this.request(NetRequestConst.REQUEST_ACHIEVEMENT_GETREWARDS,{aid:AchievementDetailPopupView.itemId})},e.prototype.dispose=function(){App.MessageHelper.removeNetMessage(MessageConst.MESSAGE_MODEL_WIFE,this.setData,this),this._wifeInfoVo=null,this._wifeIcon=null,this._droWifeIcon=null,this._achIndex=null,this._oldList=null,t.prototype.dispose.call(this)},e}(PopupView);__reflect(WifestatusWifePopupView.prototype,"WifestatusWifePopupView");var ZhubowanghongView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){console.log("ZhubowanghongView.initView");var t=BaseBitmap.create("zhubowanghong_bg");t.y=-13,this.addChildToContainer(t);var e=BaseBitmap.create("wifeskin_barbg");e.x=0,e.y=GameConfig.stageHeigth-this.container.y-e.height,this.addChildToContainer(e);var i=ComponentManager.getButton(ButtonConst.BTN_BIG_YELLOW,"zhubowanghong_goXunfang",this.xunfangButtonHandler,this);i.x=e.width/2-i.width/2,i.y=e.y+e.height/2-i.height/2,i.name="goXunfangBtn",this.addChildToContainer(i),console.log("ZhubowanghongView.initView over")},e.prototype.xunfangButtonHandler=function(){Api.searchVoApi.isShowNpc()?ViewController.getInstance().openView(ViewConst.COMMON.SEARCHVIEW):App.CommonUtil.showTip(Api.searchVoApi.getLockedString())},e.prototype.getResourceList=function(){return t.prototype.getResourceList.call(this).concat(["zhubowanghong_bg","wifeskin_barbg"])},e.prototype.dispose=function(){this._handContainer=null,t.prototype.dispose.call(this)},e}(CommonView);__reflect(ZhubowanghongView.prototype,"ZhubowanghongView");